"use strict";var qE=Object.defineProperty,YE=Object.defineProperties,ZE=Object.getOwnPropertyDescriptors,lE=Object.getOwnPropertySymbols,KE=Object.prototype.hasOwnProperty,JE=Object.prototype.propertyIsEnumerable,dM=(Zt,Ve,ne)=>Ve in Zt?qE(Zt,Ve,{enumerable:!0,configurable:!0,writable:!0,value:ne}):Zt[Ve]=ne,qs=(Zt,Ve)=>{for(var ne in Ve||(Ve={}))KE.call(Ve,ne)&&dM(Zt,ne,Ve[ne]);if(lE)for(var ne of lE(Ve))JE.call(Ve,ne)&&dM(Zt,ne,Ve[ne]);return Zt},wf=(Zt,Ve)=>YE(Zt,ZE(Ve)),cE=(Zt,Ve,ne)=>(dM(Zt,"symbol"!=typeof Ve?Ve+"":Ve,ne),ne);(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[179],{2296:(Zt,Ve,ne)=>{ne.r(Ve),ne.d(Ve,{ShaderModule:()=>zx});var k=ne(9808),F=ne(1223);let Ye={async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,hooks:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1};const It=/[&<>"']/,xt=new RegExp(It.source,"g"),kt=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,Ot=new RegExp(kt.source,"g"),it={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ve=l=>it[l];function rt(l,e){if(e){if(It.test(l))return l.replace(xt,ve)}else if(kt.test(l))return l.replace(Ot,ve);return l}const nn=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function Ne(l){return l.replace(nn,(e,t)=>"colon"===(t=t.toLowerCase())?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):"")}const Gn=/(^|[^\[])\^/g;function Ge(l,e){l="string"==typeof l?l:l.source,e=e||"";const t={replace:(r,s)=>(s=(s=s.source||s).replace(Gn,"$1"),l=l.replace(r,s),t),getRegex:()=>new RegExp(l,e)};return t}const fn=/[^\w:]/g,Wn=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function $n(l,e,t){if(l){let r;try{r=decodeURIComponent(Ne(t)).replace(fn,"").toLowerCase()}catch(s){return null}if(0===r.indexOf("javascript:")||0===r.indexOf("vbscript:")||0===r.indexOf("data:"))return null}e&&!Wn.test(t)&&(t=function jn(l,e){gt[" "+l]||(gt[" "+l]=Et.test(l)?l+"/":yn(l,"/",!0));const t=-1===(l=gt[" "+l]).indexOf(":");return"//"===e.substring(0,2)?t?e:l.replace(lt,"$1")+e:"/"===e.charAt(0)?t?e:l.replace(ut,"$1")+e:l+e}(e,t));try{t=encodeURI(t).replace(/%25/g,"%")}catch(r){return null}return t}const gt={},Et=/^[^:]+:\/*[^/]*$/,lt=/^([^:]+:)[\s\S]*$/,ut=/^([^:]+:\/*[^/]*)[\s\S]*$/,We={exec:function(){}};function Mt(l,e){const r=l.replace(/\|/g,(a,u,d)=>{let p=!1,m=u;for(;--m>=0&&"\\"===d[m];)p=!p;return p?"|":" |"}).split(/ \|/);let s=0;if(r[0].trim()||r.shift(),r.length>0&&!r[r.length-1].trim()&&r.pop(),r.length>e)r.splice(e);else for(;r.length<e;)r.push("");for(;s<r.length;s++)r[s]=r[s].trim().replace(/\\\|/g,"|");return r}function yn(l,e,t){const r=l.length;if(0===r)return"";let s=0;for(;s<r;){const a=l.charAt(r-s-1);if(a!==e||t){if(a===e||!t)break;s++}else s++}return l.slice(0,r-s)}function sn(l,e){if(e<1)return"";let t="";for(;e>1;)1&e&&(t+=l),e>>=1,l+=l;return t+l}function mn(l,e,t,r){const s=e.href,a=e.title?rt(e.title):null,u=l[1].replace(/\\([\[\]])/g,"$1");if("!"!==l[0].charAt(0)){r.state.inLink=!0;const d={type:"link",raw:t,href:s,title:a,text:u,tokens:r.inlineTokens(u)};return r.state.inLink=!1,d}return{type:"image",raw:t,href:s,title:a,text:rt(u)}}class Vr{constructor(e){this.options=e||Ye}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const r=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?r:yn(r,"\n")}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const r=t[0],s=function $t(l,e){const t=l.match(/^(\s+)(?:```)/);if(null===t)return e;const r=t[1];return e.split("\n").map(s=>{const a=s.match(/^\s+/);if(null===a)return s;const[u]=a;return u.length>=r.length?s.slice(r.length):s}).join("\n")}(r,t[3]||"");return{type:"code",raw:r,lang:t[2]?t[2].trim().replace(this.rules.inline._escapes,"$1"):t[2],text:s}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let r=t[2].trim();if(/#$/.test(r)){const s=yn(r,"#");(this.options.pedantic||!s||/ $/.test(s))&&(r=s.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){const r=t[0].replace(/^ *>[ \t]?/gm,""),s=this.lexer.state.top;this.lexer.state.top=!0;const a=this.lexer.blockTokens(r);return this.lexer.state.top=s,{type:"blockquote",raw:t[0],tokens:a,text:r}}}list(e){let t=this.rules.block.list.exec(e);if(t){let r,s,a,u,d,p,m,y,x,M,E,A,L=t[1].trim();const D=L.length>1,S={type:"list",raw:"",ordered:D,start:D?+L.slice(0,-1):"",loose:!1,items:[]};L=D?`\\d{1,9}\\${L.slice(-1)}`:`\\${L}`,this.options.pedantic&&(L=D?L:"[*+-]");const U=new RegExp(`^( {0,3}${L})((?:[\t ][^\\n]*)?(?:\\n|$))`);for(;e&&(A=!1,(t=U.exec(e))&&!this.rules.block.hr.test(e));){if(r=t[0],e=e.substring(r.length),y=t[2].split("\n",1)[0].replace(/^\t+/,V=>" ".repeat(3*V.length)),x=e.split("\n",1)[0],this.options.pedantic?(u=2,E=y.trimLeft()):(u=t[2].search(/[^ ]/),u=u>4?1:u,E=y.slice(u),u+=t[1].length),p=!1,!y&&/^ *$/.test(x)&&(r+=x+"\n",e=e.substring(x.length+1),A=!0),!A){const V=new RegExp(`^ {0,${Math.min(3,u-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ \t][^\\n]*)?(?:\\n|$))`),j=new RegExp(`^ {0,${Math.min(3,u-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),q=new RegExp(`^ {0,${Math.min(3,u-1)}}(?:\`\`\`|~~~)`),Q=new RegExp(`^ {0,${Math.min(3,u-1)}}#`);for(;e&&(M=e.split("\n",1)[0],x=M,this.options.pedantic&&(x=x.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!(q.test(x)||Q.test(x)||V.test(x)||j.test(e)));){if(x.search(/[^ ]/)>=u||!x.trim())E+="\n"+x.slice(u);else{if(p||y.search(/[^ ]/)>=4||q.test(y)||Q.test(y)||j.test(y))break;E+="\n"+x}!p&&!x.trim()&&(p=!0),r+=M+"\n",e=e.substring(M.length+1),y=x.slice(u)}}S.loose||(m?S.loose=!0:/\n *\n *$/.test(r)&&(m=!0)),this.options.gfm&&(s=/^\[[ xX]\] /.exec(E),s&&(a="[ ] "!==s[0],E=E.replace(/^\[[ xX]\] +/,""))),S.items.push({type:"list_item",raw:r,task:!!s,checked:a,loose:!1,text:E}),S.raw+=r}S.items[S.items.length-1].raw=r.trimRight(),S.items[S.items.length-1].text=E.trimRight(),S.raw=S.raw.trimRight();const N=S.items.length;for(d=0;d<N;d++)if(this.lexer.state.top=!1,S.items[d].tokens=this.lexer.blockTokens(S.items[d].text,[]),!S.loose){const V=S.items[d].tokens.filter(q=>"space"===q.type),j=V.length>0&&V.some(q=>/\n.*\n/.test(q.raw));S.loose=j}if(S.loose)for(d=0;d<N;d++)S.items[d].loose=!0;return S}}html(e){const t=this.rules.block.html.exec(e);if(t){const r={type:"html",raw:t[0],pre:!this.options.sanitizer&&("pre"===t[1]||"script"===t[1]||"style"===t[1]),text:t[0]};if(this.options.sanitize){const s=this.options.sanitizer?this.options.sanitizer(t[0]):rt(t[0]);r.type="paragraph",r.text=s,r.tokens=this.lexer.inline(s)}return r}}def(e){const t=this.rules.block.def.exec(e);if(t){const r=t[1].toLowerCase().replace(/\s+/g," "),s=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline._escapes,"$1"):"",a=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline._escapes,"$1"):t[3];return{type:"def",tag:r,raw:t[0],href:s,title:a}}}table(e){const t=this.rules.block.table.exec(e);if(t){const r={type:"table",header:Mt(t[1]).map(s=>({text:s})),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split("\n"):[]};if(r.header.length===r.align.length){r.raw=t[0];let a,u,d,p,s=r.align.length;for(a=0;a<s;a++)r.align[a]=/^ *-+: *$/.test(r.align[a])?"right":/^ *:-+: *$/.test(r.align[a])?"center":/^ *:-+ *$/.test(r.align[a])?"left":null;for(s=r.rows.length,a=0;a<s;a++)r.rows[a]=Mt(r.rows[a],r.header.length).map(m=>({text:m}));for(s=r.header.length,u=0;u<s;u++)r.header[u].tokens=this.lexer.inline(r.header[u].text);for(s=r.rows.length,u=0;u<s;u++)for(p=r.rows[u],d=0;d<p.length;d++)p[d].tokens=this.lexer.inline(p[d].text);return r}}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:"="===t[2].charAt(0)?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const r="\n"===t[1].charAt(t[1].length-1)?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:r,tokens:this.lexer.inline(r)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:rt(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(t[0]):rt(t[0]):t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const r=t[2].trim();if(!this.options.pedantic&&/^</.test(r)){if(!/>$/.test(r))return;const u=yn(r.slice(0,-1),"\\");if((r.length-u.length)%2==0)return}else{const u=function en(l,e){if(-1===l.indexOf(e[1]))return-1;const t=l.length;let r=0,s=0;for(;s<t;s++)if("\\"===l[s])s++;else if(l[s]===e[0])r++;else if(l[s]===e[1]&&(r--,r<0))return s;return-1}(t[2],"()");if(u>-1){const p=(0===t[0].indexOf("!")?5:4)+t[1].length+u;t[2]=t[2].substring(0,u),t[0]=t[0].substring(0,p).trim(),t[3]=""}}let s=t[2],a="";if(this.options.pedantic){const u=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(s);u&&(s=u[1],a=u[3])}else a=t[3]?t[3].slice(1,-1):"";return s=s.trim(),/^</.test(s)&&(s=this.options.pedantic&&!/>$/.test(r)?s.slice(1):s.slice(1,-1)),mn(t,{href:s&&s.replace(this.rules.inline._escapes,"$1"),title:a&&a.replace(this.rules.inline._escapes,"$1")},t[0],this.lexer)}}reflink(e,t){let r;if((r=this.rules.inline.reflink.exec(e))||(r=this.rules.inline.nolink.exec(e))){let s=(r[2]||r[1]).replace(/\s+/g," ");if(s=t[s.toLowerCase()],!s){const a=r[0].charAt(0);return{type:"text",raw:a,text:a}}return mn(r,s,r[0],this.lexer)}}emStrong(e,t,r=""){let s=this.rules.inline.emStrong.lDelim.exec(e);if(!s||s[3]&&r.match(/[\p{L}\p{N}]/u))return;const a=s[1]||s[2]||"";if(!a||a&&(""===r||this.rules.inline.punctuation.exec(r))){const u=s[0].length-1;let d,p,m=u,y=0;const x="*"===s[0][0]?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(x.lastIndex=0,t=t.slice(-1*e.length+u);null!=(s=x.exec(t));){if(d=s[1]||s[2]||s[3]||s[4]||s[5]||s[6],!d)continue;if(p=d.length,s[3]||s[4]){m+=p;continue}if((s[5]||s[6])&&u%3&&!((u+p)%3)){y+=p;continue}if(m-=p,m>0)continue;p=Math.min(p,p+m+y);const M=e.slice(0,u+s.index+(s[0].length-d.length)+p);if(Math.min(u,p)%2){const A=M.slice(1,-1);return{type:"em",raw:M,text:A,tokens:this.lexer.inlineTokens(A)}}const E=M.slice(2,-2);return{type:"strong",raw:M,text:E,tokens:this.lexer.inlineTokens(E)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let r=t[2].replace(/\n/g," ");const s=/[^ ]/.test(r),a=/^ /.test(r)&&/ $/.test(r);return s&&a&&(r=r.substring(1,r.length-1)),r=rt(r,!0),{type:"codespan",raw:t[0],text:r}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e,t){const r=this.rules.inline.autolink.exec(e);if(r){let s,a;return"@"===r[2]?(s=rt(this.options.mangle?t(r[1]):r[1]),a="mailto:"+s):(s=rt(r[1]),a=s),{type:"link",raw:r[0],text:s,href:a,tokens:[{type:"text",raw:s,text:s}]}}}url(e,t){let r;if(r=this.rules.inline.url.exec(e)){let s,a;if("@"===r[2])s=rt(this.options.mangle?t(r[0]):r[0]),a="mailto:"+s;else{let u;do{u=r[0],r[0]=this.rules.inline._backpedal.exec(r[0])[0]}while(u!==r[0]);s=rt(r[0]),a="www."===r[1]?"http://"+r[0]:r[0]}return{type:"link",raw:r[0],text:s,href:a,tokens:[{type:"text",raw:s,text:s}]}}}inlineText(e,t){const r=this.rules.inline.text.exec(e);if(r){let s;return s=this.lexer.state.inRawBlock?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(r[0]):rt(r[0]):r[0]:rt(this.options.smartypants?t(r[0]):r[0]),{type:"text",raw:r[0],text:s}}}}const jt={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:We,lheading:/^((?:.|\n(?!\n))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/,_label:/(?!\s*\])(?:\\.|[^\[\]\\])+/,_title:/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/};jt.def=Ge(jt.def).replace("label",jt._label).replace("title",jt._title).getRegex(),jt.bullet=/(?:[*+-]|\d{1,9}[.)])/,jt.listItemStart=Ge(/^( *)(bull) */).replace("bull",jt.bullet).getRegex(),jt.list=Ge(jt.list).replace(/bull/g,jt.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+jt.def.source+")").getRegex(),jt._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",jt._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,jt.html=Ge(jt.html,"i").replace("comment",jt._comment).replace("tag",jt._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),jt.paragraph=Ge(jt._paragraph).replace("hr",jt.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",jt._tag).getRegex(),jt.blockquote=Ge(jt.blockquote).replace("paragraph",jt.paragraph).getRegex(),jt.normal=qs({},jt),jt.gfm=wf(qs({},jt.normal),{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),jt.gfm.table=Ge(jt.gfm.table).replace("hr",jt.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",jt._tag).getRegex(),jt.gfm.paragraph=Ge(jt._paragraph).replace("hr",jt.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",jt.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",jt._tag).getRegex(),jt.pedantic=wf(qs({},jt.normal),{html:Ge("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",jt._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:We,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Ge(jt.normal._paragraph).replace("hr",jt.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",jt.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});const ot={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:We,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^(?:[^_*\\]|\\.)*?\_\_(?:[^_*\\]|\\.)*?\*(?:[^_*\\]|\\.)*?(?=\_\_)|(?:[^*\\]|\\.)+(?=[^*])|[punct_](\*+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|(?:[^punct*_\s\\]|\\.)(\*+)(?=[^punct*_\s])/,rDelimUnd:/^(?:[^_*\\]|\\.)*?\*\*(?:[^_*\\]|\\.)*?\_(?:[^_*\\]|\\.)*?(?=\*\*)|(?:[^_\\]|\\.)+(?=[^_])|[punct*](\_+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:We,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};function _e(l){return l.replace(/---/g,"\u2014").replace(/--/g,"\u2013").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1\u2018").replace(/'/g,"\u2019").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1\u201c").replace(/"/g,"\u201d").replace(/\.{3}/g,"\u2026")}function Ee(l){let t,r,e="";const s=l.length;for(t=0;t<s;t++)r=l.charCodeAt(t),Math.random()>.5&&(r="x"+r.toString(16)),e+="&#"+r+";";return e}ot._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~",ot.punctuation=Ge(ot.punctuation).replace(/punctuation/g,ot._punctuation).getRegex(),ot.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,ot.escapedEmSt=/(?:^|[^\\])(?:\\\\)*\\[*_]/g,ot._comment=Ge(jt._comment).replace("(?:--\x3e|$)","--\x3e").getRegex(),ot.emStrong.lDelim=Ge(ot.emStrong.lDelim).replace(/punct/g,ot._punctuation).getRegex(),ot.emStrong.rDelimAst=Ge(ot.emStrong.rDelimAst,"g").replace(/punct/g,ot._punctuation).getRegex(),ot.emStrong.rDelimUnd=Ge(ot.emStrong.rDelimUnd,"g").replace(/punct/g,ot._punctuation).getRegex(),ot._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,ot._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,ot._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,ot.autolink=Ge(ot.autolink).replace("scheme",ot._scheme).replace("email",ot._email).getRegex(),ot._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,ot.tag=Ge(ot.tag).replace("comment",ot._comment).replace("attribute",ot._attribute).getRegex(),ot._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,ot._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,ot._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,ot.link=Ge(ot.link).replace("label",ot._label).replace("href",ot._href).replace("title",ot._title).getRegex(),ot.reflink=Ge(ot.reflink).replace("label",ot._label).replace("ref",jt._label).getRegex(),ot.nolink=Ge(ot.nolink).replace("ref",jt._label).getRegex(),ot.reflinkSearch=Ge(ot.reflinkSearch,"g").replace("reflink",ot.reflink).replace("nolink",ot.nolink).getRegex(),ot.normal=qs({},ot),ot.pedantic=wf(qs({},ot.normal),{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:Ge(/^!?\[(label)\]\((.*?)\)/).replace("label",ot._label).getRegex(),reflink:Ge(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",ot._label).getRegex()}),ot.gfm=wf(qs({},ot.normal),{escape:Ge(ot.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),ot.gfm.url=Ge(ot.gfm.url,"i").replace("email",ot.gfm._extended_email).getRegex(),ot.breaks=wf(qs({},ot.gfm),{br:Ge(ot.br).replace("{2,}","*").getRegex(),text:Ge(ot.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});class Ae{constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Ye,this.options.tokenizer=this.options.tokenizer||new Vr,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:jt.normal,inline:ot.normal};this.options.pedantic?(t.block=jt.pedantic,t.inline=ot.pedantic):this.options.gfm&&(t.block=jt.gfm,t.inline=this.options.breaks?ot.breaks:ot.gfm),this.tokenizer.rules=t}static get rules(){return{block:jt,inline:ot}}static lex(e,t){return new Ae(t).lex(e)}static lexInline(e,t){return new Ae(t).inlineTokens(e)}lex(e){let t;for(e=e.replace(/\r\n|\r/g,"\n"),this.blockTokens(e,this.tokens);t=this.inlineQueue.shift();)this.inlineTokens(t.src,t.tokens);return this.tokens}blockTokens(e,t=[]){let r,s,a,u;for(e=this.options.pedantic?e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e.replace(/^( *)(\t+)/gm,(d,p,m)=>p+"    ".repeat(m.length));e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(d=>!!(r=d.call({lexer:this},e,t))&&(e=e.substring(r.raw.length),t.push(r),!0)))){if(r=this.tokenizer.space(e)){e=e.substring(r.raw.length),1===r.raw.length&&t.length>0?t[t.length-1].raw+="\n":t.push(r);continue}if(r=this.tokenizer.code(e)){e=e.substring(r.raw.length),s=t[t.length-1],!s||"paragraph"!==s.type&&"text"!==s.type?t.push(r):(s.raw+="\n"+r.raw,s.text+="\n"+r.text,this.inlineQueue[this.inlineQueue.length-1].src=s.text);continue}if(r=this.tokenizer.fences(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.heading(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.hr(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.blockquote(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.list(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.html(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.def(e)){e=e.substring(r.raw.length),s=t[t.length-1],!s||"paragraph"!==s.type&&"text"!==s.type?this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title}):(s.raw+="\n"+r.raw,s.text+="\n"+r.raw,this.inlineQueue[this.inlineQueue.length-1].src=s.text);continue}if(r=this.tokenizer.table(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.lheading(e)){e=e.substring(r.raw.length),t.push(r);continue}if(a=e,this.options.extensions&&this.options.extensions.startBlock){let d=1/0;const p=e.slice(1);let m;this.options.extensions.startBlock.forEach(function(y){m=y.call({lexer:this},p),"number"==typeof m&&m>=0&&(d=Math.min(d,m))}),d<1/0&&d>=0&&(a=e.substring(0,d+1))}if(this.state.top&&(r=this.tokenizer.paragraph(a))){s=t[t.length-1],u&&"paragraph"===s.type?(s.raw+="\n"+r.raw,s.text+="\n"+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=s.text):t.push(r),u=a.length!==e.length,e=e.substring(r.raw.length);continue}if(r=this.tokenizer.text(e)){e=e.substring(r.raw.length),s=t[t.length-1],s&&"text"===s.type?(s.raw+="\n"+r.raw,s.text+="\n"+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=s.text):t.push(r);continue}if(e){const d="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(d);break}throw new Error(d)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let r,s,a,d,p,m,u=e;if(this.tokens.links){const y=Object.keys(this.tokens.links);if(y.length>0)for(;null!=(d=this.tokenizer.rules.inline.reflinkSearch.exec(u));)y.includes(d[0].slice(d[0].lastIndexOf("[")+1,-1))&&(u=u.slice(0,d.index)+"["+sn("a",d[0].length-2)+"]"+u.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(d=this.tokenizer.rules.inline.blockSkip.exec(u));)u=u.slice(0,d.index)+"["+sn("a",d[0].length-2)+"]"+u.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(d=this.tokenizer.rules.inline.escapedEmSt.exec(u));)u=u.slice(0,d.index+d[0].length-2)+"++"+u.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex),this.tokenizer.rules.inline.escapedEmSt.lastIndex--;for(;e;)if(p||(m=""),p=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(y=>!!(r=y.call({lexer:this},e,t))&&(e=e.substring(r.raw.length),t.push(r),!0)))){if(r=this.tokenizer.escape(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.tag(e)){e=e.substring(r.raw.length),s=t[t.length-1],s&&"text"===r.type&&"text"===s.type?(s.raw+=r.raw,s.text+=r.text):t.push(r);continue}if(r=this.tokenizer.link(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(r.raw.length),s=t[t.length-1],s&&"text"===r.type&&"text"===s.type?(s.raw+=r.raw,s.text+=r.text):t.push(r);continue}if(r=this.tokenizer.emStrong(e,u,m)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.codespan(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.br(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.del(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.autolink(e,Ee)){e=e.substring(r.raw.length),t.push(r);continue}if(!this.state.inLink&&(r=this.tokenizer.url(e,Ee))){e=e.substring(r.raw.length),t.push(r);continue}if(a=e,this.options.extensions&&this.options.extensions.startInline){let y=1/0;const x=e.slice(1);let M;this.options.extensions.startInline.forEach(function(E){M=E.call({lexer:this},x),"number"==typeof M&&M>=0&&(y=Math.min(y,M))}),y<1/0&&y>=0&&(a=e.substring(0,y+1))}if(r=this.tokenizer.inlineText(a,_e)){e=e.substring(r.raw.length),"_"!==r.raw.slice(-1)&&(m=r.raw.slice(-1)),p=!0,s=t[t.length-1],s&&"text"===s.type?(s.raw+=r.raw,s.text+=r.text):t.push(r);continue}if(e){const y="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(y);break}throw new Error(y)}}return t}}class Le{constructor(e){this.options=e||Ye}code(e,t,r){const s=(t||"").match(/\S*/)[0];if(this.options.highlight){const a=this.options.highlight(e,s);null!=a&&a!==e&&(r=!0,e=a)}return e=e.replace(/\n$/,"")+"\n",s?'<pre><code class="'+this.options.langPrefix+rt(s)+'">'+(r?e:rt(e,!0))+"</code></pre>\n":"<pre><code>"+(r?e:rt(e,!0))+"</code></pre>\n"}blockquote(e){return`<blockquote>\n${e}</blockquote>\n`}html(e){return e}heading(e,t,r,s){return this.options.headerIds?`<h${t} id="${this.options.headerPrefix+s.slug(r)}">${e}</h${t}>\n`:`<h${t}>${e}</h${t}>\n`}hr(){return this.options.xhtml?"<hr/>\n":"<hr>\n"}list(e,t,r){const s=t?"ol":"ul";return"<"+s+(t&&1!==r?' start="'+r+'"':"")+">\n"+e+"</"+s+">\n"}listitem(e){return`<li>${e}</li>\n`}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(e){return`<p>${e}</p>\n`}table(e,t){return t&&(t=`<tbody>${t}</tbody>`),"<table>\n<thead>\n"+e+"</thead>\n"+t+"</table>\n"}tablerow(e){return`<tr>\n${e}</tr>\n`}tablecell(e,t){const r=t.header?"th":"td";return(t.align?`<${r} align="${t.align}">`:`<${r}>`)+e+`</${r}>\n`}strong(e){return`<strong>${e}</strong>`}em(e){return`<em>${e}</em>`}codespan(e){return`<code>${e}</code>`}br(){return this.options.xhtml?"<br/>":"<br>"}del(e){return`<del>${e}</del>`}link(e,t,r){if(null===(e=$n(this.options.sanitize,this.options.baseUrl,e)))return r;let s='<a href="'+e+'"';return t&&(s+=' title="'+t+'"'),s+=">"+r+"</a>",s}image(e,t,r){if(null===(e=$n(this.options.sanitize,this.options.baseUrl,e)))return r;let s=`<img src="${e}" alt="${r}"`;return t&&(s+=` title="${t}"`),s+=this.options.xhtml?"/>":">",s}text(e){return e}}class ft{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,t,r){return""+r}image(e,t,r){return""+r}br(){return""}}class et{constructor(){this.seen={}}serialize(e){return e.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(e,t){let r=e,s=0;if(this.seen.hasOwnProperty(r)){s=this.seen[e];do{s++,r=e+"-"+s}while(this.seen.hasOwnProperty(r))}return t||(this.seen[e]=s,this.seen[r]=0),r}slug(e,t={}){const r=this.serialize(e);return this.getNextSafeSlug(r,t.dryrun)}}class Ht{constructor(e){this.options=e||Ye,this.options.renderer=this.options.renderer||new Le,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new ft,this.slugger=new et}static parse(e,t){return new Ht(t).parse(e)}static parseInline(e,t){return new Ht(t).parseInline(e)}parse(e,t=!0){let s,a,u,d,p,m,y,x,M,E,A,L,D,S,U,N,V,j,q,r="";const Q=e.length;for(s=0;s<Q;s++)if(E=e[s],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[E.type]&&(q=this.options.extensions.renderers[E.type].call({parser:this},E),!1!==q||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(E.type)))r+=q||"";else switch(E.type){case"space":continue;case"hr":r+=this.renderer.hr();continue;case"heading":r+=this.renderer.heading(this.parseInline(E.tokens),E.depth,Ne(this.parseInline(E.tokens,this.textRenderer)),this.slugger);continue;case"code":r+=this.renderer.code(E.text,E.lang,E.escaped);continue;case"table":for(x="",y="",d=E.header.length,a=0;a<d;a++)y+=this.renderer.tablecell(this.parseInline(E.header[a].tokens),{header:!0,align:E.align[a]});for(x+=this.renderer.tablerow(y),M="",d=E.rows.length,a=0;a<d;a++){for(m=E.rows[a],y="",p=m.length,u=0;u<p;u++)y+=this.renderer.tablecell(this.parseInline(m[u].tokens),{header:!1,align:E.align[u]});M+=this.renderer.tablerow(y)}r+=this.renderer.table(x,M);continue;case"blockquote":M=this.parse(E.tokens),r+=this.renderer.blockquote(M);continue;case"list":for(A=E.ordered,L=E.start,D=E.loose,d=E.items.length,M="",a=0;a<d;a++)U=E.items[a],N=U.checked,V=U.task,S="",U.task&&(j=this.renderer.checkbox(N),D?U.tokens.length>0&&"paragraph"===U.tokens[0].type?(U.tokens[0].text=j+" "+U.tokens[0].text,U.tokens[0].tokens&&U.tokens[0].tokens.length>0&&"text"===U.tokens[0].tokens[0].type&&(U.tokens[0].tokens[0].text=j+" "+U.tokens[0].tokens[0].text)):U.tokens.unshift({type:"text",text:j}):S+=j),S+=this.parse(U.tokens,D),M+=this.renderer.listitem(S,V,N);r+=this.renderer.list(M,A,L);continue;case"html":r+=this.renderer.html(E.text);continue;case"paragraph":r+=this.renderer.paragraph(this.parseInline(E.tokens));continue;case"text":for(M=E.tokens?this.parseInline(E.tokens):E.text;s+1<Q&&"text"===e[s+1].type;)E=e[++s],M+="\n"+(E.tokens?this.parseInline(E.tokens):E.text);r+=t?this.renderer.paragraph(M):M;continue;default:{const ae='Token with "'+E.type+'" type was not found.';if(this.options.silent)return void console.error(ae);throw new Error(ae)}}return r}parseInline(e,t){t=t||this.renderer;let s,a,u,r="";const d=e.length;for(s=0;s<d;s++)if(a=e[s],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[a.type]&&(u=this.options.extensions.renderers[a.type].call({parser:this},a),!1!==u||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(a.type)))r+=u||"";else switch(a.type){case"escape":case"text":r+=t.text(a.text);break;case"html":r+=t.html(a.text);break;case"link":r+=t.link(a.href,a.title,this.parseInline(a.tokens,t));break;case"image":r+=t.image(a.href,a.title,a.text);break;case"strong":r+=t.strong(this.parseInline(a.tokens,t));break;case"em":r+=t.em(this.parseInline(a.tokens,t));break;case"codespan":r+=t.codespan(a.text);break;case"br":r+=t.br();break;case"del":r+=t.del(this.parseInline(a.tokens,t));break;default:{const p='Token with "'+a.type+'" type was not found.';if(this.options.silent)return void console.error(p);throw new Error(p)}}return r}}class Tn{constructor(e){this.options=e||Ye}preprocess(e){return e}postprocess(e){return e}}function ht(l,e){return(t,r,s)=>{"function"==typeof r&&(s=r,r=null);const a=qs({},r),u=function gn(l,e,t){return r=>{if(r.message+="\nPlease report this to https://github.com/markedjs/marked.",l){const s="<p>An error occurred:</p><pre>"+rt(r.message+"",!0)+"</pre>";return e?Promise.resolve(s):t?void t(null,s):s}if(e)return Promise.reject(r);if(!t)throw r;t(r)}}((r=qs(qs({},bt.defaults),a)).silent,r.async,s);if(null==t)return u(new Error("marked(): input parameter is undefined or null"));if("string"!=typeof t)return u(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));if(function kn(l){l&&l.sanitize&&!l.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}(r),r.hooks&&(r.hooks.options=r),s){const d=r.highlight;let p;try{r.hooks&&(t=r.hooks.preprocess(t)),p=l(t,r)}catch(x){return u(x)}const m=function(x){let M;if(!x)try{r.walkTokens&&bt.walkTokens(p,r.walkTokens),M=e(p,r),r.hooks&&(M=r.hooks.postprocess(M))}catch(E){x=E}return r.highlight=d,x?u(x):s(null,M)};if(!d||d.length<3||(delete r.highlight,!p.length))return m();let y=0;return bt.walkTokens(p,function(x){"code"===x.type&&(y++,setTimeout(()=>{d(x.text,x.lang,function(M,E){if(M)return m(M);null!=E&&E!==x.text&&(x.text=E,x.escaped=!0),y--,0===y&&m()})},0))}),void(0===y&&m())}if(r.async)return Promise.resolve(r.hooks?r.hooks.preprocess(t):t).then(d=>l(d,r)).then(d=>r.walkTokens?Promise.all(bt.walkTokens(d,r.walkTokens)).then(()=>d):d).then(d=>e(d,r)).then(d=>r.hooks?r.hooks.postprocess(d):d).catch(u);try{r.hooks&&(t=r.hooks.preprocess(t));const d=l(t,r);r.walkTokens&&bt.walkTokens(d,r.walkTokens);let p=e(d,r);return r.hooks&&(p=r.hooks.postprocess(p)),p}catch(d){return u(d)}}}function bt(l,e,t){return ht(Ae.lex,Ht.parse)(l,e,t)}cE(Tn,"passThroughHooks",new Set(["preprocess","postprocess"])),bt.options=bt.setOptions=function(l){return function Ue(l){Ye=l}(bt.defaults=qs(qs({},bt.defaults),l)),bt},bt.getDefaults=function be(){return{async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,hooks:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}},bt.defaults=Ye,bt.use=function(...l){const e=bt.defaults.extensions||{renderers:{},childTokens:{}};l.forEach(t=>{const r=qs({},t);if(r.async=bt.defaults.async||r.async||!1,t.extensions&&(t.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if(s.renderer){const a=e.renderers[s.name];e.renderers[s.name]=a?function(...u){let d=s.renderer.apply(this,u);return!1===d&&(d=a.apply(this,u)),d}:s.renderer}if(s.tokenizer){if(!s.level||"block"!==s.level&&"inline"!==s.level)throw new Error("extension level must be 'block' or 'inline'");e[s.level]?e[s.level].unshift(s.tokenizer):e[s.level]=[s.tokenizer],s.start&&("block"===s.level?e.startBlock?e.startBlock.push(s.start):e.startBlock=[s.start]:"inline"===s.level&&(e.startInline?e.startInline.push(s.start):e.startInline=[s.start]))}s.childTokens&&(e.childTokens[s.name]=s.childTokens)}),r.extensions=e),t.renderer){const s=bt.defaults.renderer||new Le;for(const a in t.renderer){const u=s[a];s[a]=(...d)=>{let p=t.renderer[a].apply(s,d);return!1===p&&(p=u.apply(s,d)),p}}r.renderer=s}if(t.tokenizer){const s=bt.defaults.tokenizer||new Vr;for(const a in t.tokenizer){const u=s[a];s[a]=(...d)=>{let p=t.tokenizer[a].apply(s,d);return!1===p&&(p=u.apply(s,d)),p}}r.tokenizer=s}if(t.hooks){const s=bt.defaults.hooks||new Tn;for(const a in t.hooks){const u=s[a];s[a]=Tn.passThroughHooks.has(a)?d=>{if(bt.defaults.async)return Promise.resolve(t.hooks[a].call(s,d)).then(m=>u.call(s,m));const p=t.hooks[a].call(s,d);return u.call(s,p)}:(...d)=>{let p=t.hooks[a].apply(s,d);return!1===p&&(p=u.apply(s,d)),p}}r.hooks=s}if(t.walkTokens){const s=bt.defaults.walkTokens;r.walkTokens=function(a){let u=[];return u.push(t.walkTokens.call(this,a)),s&&(u=u.concat(s.call(this,a))),u}}bt.setOptions(r)})},bt.walkTokens=function(l,e){let t=[];for(const r of l)switch(t=t.concat(e.call(bt,r)),r.type){case"table":for(const s of r.header)t=t.concat(bt.walkTokens(s.tokens,e));for(const s of r.rows)for(const a of s)t=t.concat(bt.walkTokens(a.tokens,e));break;case"list":t=t.concat(bt.walkTokens(r.items,e));break;default:bt.defaults.extensions&&bt.defaults.extensions.childTokens&&bt.defaults.extensions.childTokens[r.type]?bt.defaults.extensions.childTokens[r.type].forEach(function(s){t=t.concat(bt.walkTokens(r[s],e))}):r.tokens&&(t=t.concat(bt.walkTokens(r.tokens,e)))}return t},bt.parseInline=ht(Ae.lexInline,Ht.parseInline),bt.Parser=Ht,bt.parser=Ht.parse,bt.Renderer=Le,bt.TextRenderer=ft,bt.Lexer=Ae,bt.lexer=Ae.lex,bt.Tokenizer=Vr,bt.Slugger=et,bt.Hooks=Tn,bt.parse=bt;var fi=ne(4004),Jr=(ne(590),ne(9646)),xo=ne(8306),za=ne(4351),jl=ne(9300);class tn{}class xr{}class ii{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(t=>{const r=t.indexOf(":");if(r>0){const s=t.slice(0,r),a=s.toLowerCase(),u=t.slice(r+1).trim();this.maybeSetNormalizedName(s,a),this.headers.has(a)?this.headers.get(a).push(u):this.headers.set(a,[u])}})}:()=>{this.headers=new Map,Object.keys(e).forEach(t=>{let r=e[t];const s=t.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(this.headers.set(s,r),this.maybeSetNormalizedName(t,s))})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof ii?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new ii;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof ii?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if("string"==typeof r&&(r=[r]),0===r.length)return;this.maybeSetNormalizedName(e.name,t);const s=("a"===e.op?this.headers.get(t):void 0)||[];s.push(...r),this.headers.set(t,s);break;case"d":const a=e.value;if(a){let u=this.headers.get(t);if(!u)return;u=u.filter(d=>-1===a.indexOf(d)),0===u.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,u)}else this.headers.delete(t),this.normalizedNames.delete(t)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class Gt{encodeKey(e){return Ci(e)}encodeValue(e){return Ci(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const _a=/%(\d[a-f0-9])/gi,Ir={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function Ci(l){return encodeURIComponent(l).replace(_a,(e,t)=>{var r;return null!==(r=Ir[t])&&void 0!==r?r:e})}function zo(l){return`${l}`}class ki{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new Gt,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function pn(l,e){const t=new Map;return l.length>0&&l.replace(/^\?/,"").split("&").forEach(s=>{const a=s.indexOf("="),[u,d]=-1==a?[e.decodeKey(s),""]:[e.decodeKey(s.slice(0,a)),e.decodeValue(s.slice(a+1))],p=t.get(u)||[];p.push(d),t.set(u,p)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const r=e.fromObject[t];this.map.set(t,Array.isArray(r)?r:[r])})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(r=>{const s=e[r];Array.isArray(s)?s.forEach(a=>{t.push({param:r,value:a,op:"a"})}):t.push({param:r,value:s,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(r=>t+"="+this.encoder.encodeValue(r)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new ki({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(zo(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let r=this.map.get(e.param)||[];const s=r.indexOf(zo(e.value));-1!==s&&r.splice(s,1),r.length>0?this.map.set(e.param,r):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class zt{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function Xn(l){return"undefined"!=typeof ArrayBuffer&&l instanceof ArrayBuffer}function Va(l){return"undefined"!=typeof Blob&&l instanceof Blob}function ni(l){return"undefined"!=typeof FormData&&l instanceof FormData}class Is{constructor(e,t,r,s){let a;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function Xl(l){switch(l){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||s?(this.body=void 0!==r?r:null,a=s):a=r,a&&(this.reportProgress=!!a.reportProgress,this.withCredentials=!!a.withCredentials,a.responseType&&(this.responseType=a.responseType),a.headers&&(this.headers=a.headers),a.context&&(this.context=a.context),a.params&&(this.params=a.params)),this.headers||(this.headers=new ii),this.context||(this.context=new zt),this.params){const u=this.params.toString();if(0===u.length)this.urlWithParams=t;else{const d=t.indexOf("?");this.urlWithParams=t+(-1===d?"?":d<t.length-1?"&":"")+u}}else this.params=new ki,this.urlWithParams=t}serializeBody(){return null===this.body?null:Xn(this.body)||Va(this.body)||ni(this.body)||function su(l){return"undefined"!=typeof URLSearchParams&&l instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof ki?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||ni(this.body)?null:Va(this.body)?this.body.type||null:Xn(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof ki?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){var t;const r=e.method||this.method,s=e.url||this.url,a=e.responseType||this.responseType,u=void 0!==e.body?e.body:this.body,d=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,p=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let m=e.headers||this.headers,y=e.params||this.params;const x=null!==(t=e.context)&&void 0!==t?t:this.context;return void 0!==e.setHeaders&&(m=Object.keys(e.setHeaders).reduce((M,E)=>M.set(E,e.setHeaders[E]),m)),e.setParams&&(y=Object.keys(e.setParams).reduce((M,E)=>M.set(E,e.setParams[E]),y)),new Is(r,s,u,{params:y,headers:m,context:x,reportProgress:p,responseType:a,withCredentials:d})}}var hi=(()=>((hi=hi||{})[hi.Sent=0]="Sent",hi[hi.UploadProgress=1]="UploadProgress",hi[hi.ResponseHeader=2]="ResponseHeader",hi[hi.DownloadProgress=3]="DownloadProgress",hi[hi.Response=4]="Response",hi[hi.User=5]="User",hi))();class An{constructor(e,t=200,r="OK"){this.headers=e.headers||new ii,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||r,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class es extends An{constructor(e={}){super(e),this.type=hi.ResponseHeader}clone(e={}){return new es({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class Gr extends An{constructor(e={}){super(e),this.type=hi.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new Gr({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class ts extends An{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function Vo(l,e){return{body:e,headers:l.headers,context:l.context,observe:l.observe,params:l.params,reportProgress:l.reportProgress,responseType:l.responseType,withCredentials:l.withCredentials}}let Qn=(()=>{class l{constructor(t){this.handler=t}request(t,r,s={}){let a;if(t instanceof Is)a=t;else{let p,m;p=s.headers instanceof ii?s.headers:new ii(s.headers),s.params&&(m=s.params instanceof ki?s.params:new ki({fromObject:s.params})),a=new Is(t,r,void 0!==s.body?s.body:null,{headers:p,context:s.context,params:m,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials})}const u=(0,Jr.of)(a).pipe((0,za.b)(p=>this.handler.handle(p)));if(t instanceof Is||"events"===s.observe)return u;const d=u.pipe((0,jl.h)(p=>p instanceof Gr));switch(s.observe||"body"){case"body":switch(a.responseType){case"arraybuffer":return d.pipe((0,fi.U)(p=>{if(null!==p.body&&!(p.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return p.body}));case"blob":return d.pipe((0,fi.U)(p=>{if(null!==p.body&&!(p.body instanceof Blob))throw new Error("Response is not a Blob.");return p.body}));case"text":return d.pipe((0,fi.U)(p=>{if(null!==p.body&&"string"!=typeof p.body)throw new Error("Response is not a string.");return p.body}));default:return d.pipe((0,fi.U)(p=>p.body))}case"response":return d;default:throw new Error(`Unreachable: unhandled observe type ${s.observe}}`)}}delete(t,r={}){return this.request("DELETE",t,r)}get(t,r={}){return this.request("GET",t,r)}head(t,r={}){return this.request("HEAD",t,r)}jsonp(t,r){return this.request("JSONP",t,{params:(new ki).append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,r={}){return this.request("OPTIONS",t,r)}patch(t,r,s={}){return this.request("PATCH",t,Vo(s,r))}post(t,r,s={}){return this.request("POST",t,Vo(s,r))}put(t,r,s={}){return this.request("PUT",t,Vo(s,r))}}return l.\u0275fac=function(t){return new(t||l)(F.LFG(tn))},l.\u0275prov=F.Yz7({token:l,factory:l.\u0275fac}),l})();class sr{constructor(e,t){this.next=e,this.interceptor=t}handle(e){return this.interceptor.intercept(e,this.next)}}const fe=new F.OlP("HTTP_INTERCEPTORS");let le=(()=>{class l{intercept(t,r){return r.handle(t)}}return l.\u0275fac=function(t){return new(t||l)},l.\u0275prov=F.Yz7({token:l,factory:l.\u0275fac}),l})();const ns=/^\)\]\}',?\n/;let Mr=(()=>{class l{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new xo.y(r=>{const s=this.xhrFactory.build();if(s.open(t.method,t.urlWithParams),t.withCredentials&&(s.withCredentials=!0),t.headers.forEach((E,A)=>s.setRequestHeader(E,A.join(","))),t.headers.has("Accept")||s.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const E=t.detectContentTypeHeader();null!==E&&s.setRequestHeader("Content-Type",E)}if(t.responseType){const E=t.responseType.toLowerCase();s.responseType="json"!==E?E:"text"}const a=t.serializeBody();let u=null;const d=()=>{if(null!==u)return u;const E=s.statusText||"OK",A=new ii(s.getAllResponseHeaders()),L=function Kt(l){return"responseURL"in l&&l.responseURL?l.responseURL:/^X-Request-URL:/m.test(l.getAllResponseHeaders())?l.getResponseHeader("X-Request-URL"):null}(s)||t.url;return u=new es({headers:A,status:s.status,statusText:E,url:L}),u},p=()=>{let{headers:E,status:A,statusText:L,url:D}=d(),S=null;204!==A&&(S=void 0===s.response?s.responseText:s.response),0===A&&(A=S?200:0);let U=A>=200&&A<300;if("json"===t.responseType&&"string"==typeof S){const N=S;S=S.replace(ns,"");try{S=""!==S?JSON.parse(S):null}catch(V){S=N,U&&(U=!1,S={error:V,text:S})}}U?(r.next(new Gr({body:S,headers:E,status:A,statusText:L,url:D||void 0})),r.complete()):r.error(new ts({error:S,headers:E,status:A,statusText:L,url:D||void 0}))},m=E=>{const{url:A}=d(),L=new ts({error:E,status:s.status||0,statusText:s.statusText||"Unknown Error",url:A||void 0});r.error(L)};let y=!1;const x=E=>{y||(r.next(d()),y=!0);let A={type:hi.DownloadProgress,loaded:E.loaded};E.lengthComputable&&(A.total=E.total),"text"===t.responseType&&!!s.responseText&&(A.partialText=s.responseText),r.next(A)},M=E=>{let A={type:hi.UploadProgress,loaded:E.loaded};E.lengthComputable&&(A.total=E.total),r.next(A)};return s.addEventListener("load",p),s.addEventListener("error",m),s.addEventListener("timeout",m),s.addEventListener("abort",m),t.reportProgress&&(s.addEventListener("progress",x),null!==a&&s.upload&&s.upload.addEventListener("progress",M)),s.send(a),r.next({type:hi.Sent}),()=>{s.removeEventListener("error",m),s.removeEventListener("abort",m),s.removeEventListener("load",p),s.removeEventListener("timeout",m),t.reportProgress&&(s.removeEventListener("progress",x),null!==a&&s.upload&&s.upload.removeEventListener("progress",M)),s.readyState!==s.DONE&&s.abort()}})}}return l.\u0275fac=function(t){return new(t||l)(F.LFG(k.JF))},l.\u0275prov=F.Yz7({token:l,factory:l.\u0275fac}),l})();const Wr=new F.OlP("XSRF_COOKIE_NAME"),Ni=new F.OlP("XSRF_HEADER_NAME");class Go{}let xa=(()=>{class l{constructor(t,r,s){this.doc=t,this.platform=r,this.cookieName=s,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=(0,k.Mx)(t,this.cookieName),this.lastCookieString=t),this.lastToken}}return l.\u0275fac=function(t){return new(t||l)(F.LFG(k.K0),F.LFG(F.Lbi),F.LFG(Wr))},l.\u0275prov=F.Yz7({token:l,factory:l.\u0275fac}),l})(),is=(()=>{class l{constructor(t,r){this.tokenService=t,this.headerName=r}intercept(t,r){const s=t.url.toLowerCase();if("GET"===t.method||"HEAD"===t.method||s.startsWith("http://")||s.startsWith("https://"))return r.handle(t);const a=this.tokenService.getToken();return null!==a&&!t.headers.has(this.headerName)&&(t=t.clone({headers:t.headers.set(this.headerName,a)})),r.handle(t)}}return l.\u0275fac=function(t){return new(t||l)(F.LFG(Go),F.LFG(Ni))},l.\u0275prov=F.Yz7({token:l,factory:l.\u0275fac}),l})(),Ma=(()=>{class l{constructor(t,r){this.backend=t,this.injector=r,this.chain=null}handle(t){if(null===this.chain){const r=this.injector.get(fe,[]);this.chain=r.reduceRight((s,a)=>new sr(s,a),this.backend)}return this.chain.handle(t)}}return l.\u0275fac=function(t){return new(t||l)(F.LFG(xr),F.LFG(F.zs3))},l.\u0275prov=F.Yz7({token:l,factory:l.\u0275fac}),l})(),ba=(()=>{class l{static disable(){return{ngModule:l,providers:[{provide:is,useClass:le}]}}static withOptions(t={}){return{ngModule:l,providers:[t.cookieName?{provide:Wr,useValue:t.cookieName}:[],t.headerName?{provide:Ni,useValue:t.headerName}:[]]}}}return l.\u0275fac=function(t){return new(t||l)},l.\u0275mod=F.oAB({type:l}),l.\u0275inj=F.cJS({providers:[is,{provide:fe,useExisting:is,multi:!0},{provide:Go,useClass:xa},{provide:Wr,useValue:"XSRF-TOKEN"},{provide:Ni,useValue:"X-XSRF-TOKEN"}]}),l})(),Zi=(()=>{class l{}return l.\u0275fac=function(t){return new(t||l)},l.\u0275mod=F.oAB({type:l}),l.\u0275inj=F.cJS({providers:[Qn,{provide:tn,useClass:Ma},Mr,{provide:xr,useExisting:Mr}],imports:[[ba.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),l})();var ci=ne(2313);const yr=["*"];let zi=(()=>{class l{transform(t,r){return null==t&&(t=""),null==r&&(r=""),"string"!=typeof t?(console.error(`LanguagePipe has been invoked with an invalid value type [${typeof t}]`),t):"string"!=typeof r?(console.error(`LanguagePipe has been invoked with an invalid parameter [${typeof r}]`),t):"```"+r+"\n"+t+"\n```"}}return l.\u0275fac=function(t){return new(t||l)},l.\u0275pipe=F.Yjl({name:"language",type:l,pure:!0}),l})();var $r=(()=>{return(l=$r||($r={})).CommandLine="command-line",l.LineHighlight="line-highlight",l.LineNumbers="line-numbers",$r;var l})();class Ei{}const $o=new F.OlP("SECURITY_CONTEXT");let rs=(()=>{class l{constructor(t,r,s,a,u){this.platform=t,this.securityContext=r,this.http=s,this.sanitizer=u,this.initialMarkedOptions={renderer:new Le},this.options=a}get options(){return this._options}set options(t){this._options=Object.assign(Object.assign({},this.initialMarkedOptions),t)}get renderer(){return this.options.renderer}set renderer(t){this.options.renderer=t}compile(t,r=!1,s=!1,a=this.options){const u=this.trimIndentation(t),d=r?this.decodeHtml(u):u,m=bt(s?this.renderEmoji(d):d,a);return this.sanitizer.sanitize(this.securityContext,m)||""}getSource(t){if(!this.http)throw new Error("[ngx-markdown] When using the `src` attribute you *have to* pass the `HttpClient` as a parameter of the `forRoot` method. See README for more information");return this.http.get(t,{responseType:"text"}).pipe((0,fi.U)(r=>this.handleExtension(t,r)))}highlight(t){if((0,k.NF)(this.platform)&&"undefined"!=typeof Prism){t||(t=document);const r=t.querySelectorAll('pre code:not([class*="language-"])');Array.prototype.forEach.call(r,s=>s.classList.add("language-none")),Prism.highlightAllUnder(t)}}renderKatex(t,r){if(!(0,k.NF)(this.platform))return t;if("undefined"==typeof katex||void 0===katex.renderToString)throw new Error("[ngx-markdown] When using the `katex` attribute you *have to* include KaTeX files to `angular.json` or use imports. See README for more information");return t.replace(/\$([^\s][^$]*?[^\s])\$/gm,(s,a)=>katex.renderToString(a,r))}decodeHtml(t){if(!(0,k.NF)(this.platform))return t;const r=document.createElement("textarea");return r.innerHTML=t,r.value}handleExtension(t,r){const s=t?t.split("?")[0].split(".").splice(-1).join():"";return"md"!==s?"```"+s+"\n"+r+"\n```":r}renderEmoji(t){if(!(0,k.NF)(this.platform))return t;if("undefined"==typeof joypixels||void 0===joypixels.shortnameToUnicode)throw new Error("[ngx-markdown] When using the `emoji` attribute you *have to* include Emoji-Toolkit files to `angular.json` or use imports. See README for more information");return joypixels.shortnameToUnicode(t)}trimIndentation(t){if(!t)return"";let r;return t.split("\n").map(s=>{let a=r;return s.length>0&&(a=isNaN(a)?s.search(/\S|$/):Math.min(s.search(/\S|$/),a)),isNaN(r)&&(r=a),a?s.substring(a):s}).join("\n")}}return l.\u0275fac=function(t){return new(t||l)(F.LFG(F.Lbi),F.LFG($o),F.LFG(Qn,8),F.LFG(Ei,8),F.LFG(ci.H7))},l.\u0275prov=F.Yz7({token:l,factory:l.\u0275fac}),l})(),Mo=(()=>{class l{constructor(t,r){this.element=t,this.markdownService=r,this.error=new F.vpe,this.load=new F.vpe,this.ready=new F.vpe,this._commandLine=!1,this._emoji=!1,this._katex=!1,this._lineHighlight=!1,this._lineNumbers=!1}get emoji(){return this._emoji}set emoji(t){this._emoji=this.coerceBooleanProperty(t)}get katex(){return this._katex}set katex(t){this._katex=this.coerceBooleanProperty(t)}get lineHighlight(){return this._lineHighlight}set lineHighlight(t){this._lineHighlight=this.coerceBooleanProperty(t)}get lineNumbers(){return this._lineNumbers}set lineNumbers(t){this._lineNumbers=this.coerceBooleanProperty(t)}get commandLine(){return this._commandLine}set commandLine(t){this._commandLine=this.coerceBooleanProperty(t)}ngOnChanges(){null==this.data?null==this.src||this.handleSrc():this.handleData()}ngAfterViewInit(){!this.data&&!this.src&&this.handleTransclusion()}render(t,r=!1){let s=this.markdownService.compile(t,r,this.emoji);s=this.katex?this.markdownService.renderKatex(s,this.katexOptions):s,this.element.nativeElement.innerHTML=s,this.handlePlugins(),this.markdownService.highlight(this.element.nativeElement),this.ready.emit()}coerceBooleanProperty(t){return null!=t&&"false"!=`${String(t)}`}handleData(){this.render(this.data)}handleSrc(){this.markdownService.getSource(this.src).subscribe(t=>{this.render(t),this.load.emit(t)},t=>this.error.emit(t))}handleTransclusion(){this.render(this.element.nativeElement.innerHTML,!0)}handlePlugins(){this.commandLine&&(this.setPluginClass(this.element.nativeElement,$r.CommandLine),this.setPluginOptions(this.element.nativeElement,{dataFilterOutput:this.filterOutput,dataHost:this.host,dataPrompt:this.prompt,dataOutput:this.output,dataUser:this.user})),this.lineHighlight&&this.setPluginOptions(this.element.nativeElement,{dataLine:this.line,dataLineOffset:this.lineOffset}),this.lineNumbers&&(this.setPluginClass(this.element.nativeElement,$r.LineNumbers),this.setPluginOptions(this.element.nativeElement,{dataStart:this.start}))}setPluginClass(t,r){const s=t.querySelectorAll("pre");for(let a=0;a<s.length;a++){const u=r instanceof Array?r:[r];s.item(a).classList.add(...u)}}setPluginOptions(t,r){const s=t.querySelectorAll("pre");for(let a=0;a<s.length;a++)Object.keys(r).forEach(u=>{const d=r[u];if(d){const p=this.toLispCase(u);s.item(a).setAttribute(p,d.toString())}})}toLispCase(t){const r=t.match(/([A-Z])/g);if(!r)return t;let s=t.toString();for(let a=0,u=r.length;a<u;a++)s=s.replace(new RegExp(r[a]),"-"+r[a].toLowerCase());return"-"===s.slice(0,1)&&(s=s.slice(1)),s}}return l.\u0275fac=function(t){return new(t||l)(F.Y36(F.SBq),F.Y36(rs))},l.\u0275cmp=F.Xpm({type:l,selectors:[["markdown"],["","markdown",""]],inputs:{data:"data",src:"src",emoji:"emoji",katex:"katex",katexOptions:"katexOptions",lineHighlight:"lineHighlight",line:"line",lineOffset:"lineOffset",lineNumbers:"lineNumbers",start:"start",commandLine:"commandLine",filterOutput:"filterOutput",host:"host",prompt:"prompt",output:"output",user:"user"},outputs:{error:"error",load:"load",ready:"ready"},features:[F.TTD],ngContentSelectors:yr,decls:1,vars:0,template:function(t,r){1&t&&(F.F$t(),F.Hsn(0))},encapsulation:2}),l})(),Ks=(()=>{class l{static forRoot(t){return{ngModule:l,providers:[rs,t&&t.loader||[],t&&t.markedOptions||[],{provide:$o,useValue:t&&null!=t.sanitize?t.sanitize:F.q3G.HTML}]}}static forChild(){return{ngModule:l}}}return l.\u0275fac=function(t){return new(t||l)},l.\u0275mod=F.oAB({type:l}),l.\u0275inj=F.cJS({}),l})();var ar=ne(6035);let Ki=(()=>{class l{constructor(){}ngOnInit(){}}return l.\u0275fac=function(t){return new(t||l)},l.\u0275cmp=F.Xpm({type:l,selectors:[["app-shader"]],decls:8,vars:0,consts:[[1,"content",2,"margin","0px"],[1,"card-container"],["rel","noopener","routerLink","/shader/star",1,"card"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24",1,"material-icons"],["d","M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"]],template:function(t,r){1&t&&(F.TgZ(0,"div",0)(1,"div",1)(2,"a",2)(3,"span"),F._uU(4,"star"),F.qZA(),F.O4$(),F.TgZ(5,"svg",3),F._UZ(6,"path",4),F.qZA()()()(),F.kcU(),F._UZ(7,"router-outlet"))},directives:[ar.yS,ar.lC],styles:[""]}),l})();function si(l,e,t,r,s,a,u){try{var d=l[a](u),p=d.value}catch(m){return void t(m)}d.done?e(p):Promise.resolve(p).then(r,s)}const Mi=1001,mi=1003,yi=1006,wa=1008,wo=1009,Fe=1014,Dn=1015,Ja=1016,wr=1020,Fr=1023,Yo=1026,Qa=1027,Jo=3001,Ln="srgb",Sr="srgb-linear",mc="display-p3",Qo=2e3;class Tu{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const r=this._listeners;void 0===r[e]&&(r[e]=[]),-1===r[e].indexOf(t)&&r[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const r=this._listeners;return void 0!==r[e]&&-1!==r[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const s=this._listeners[e];if(void 0!==s){const a=s.indexOf(t);-1!==a&&s.splice(a,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const r=this._listeners[e.type];if(void 0!==r){e.target=this;const s=r.slice(0);for(let a=0,u=s.length;a<u;a++)s[a].call(this,e);e.target=null}}}const qr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],_c=Math.PI/180,Au=180/Math.PI;function Tr(){const l=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(qr[255&l]+qr[l>>8&255]+qr[l>>16&255]+qr[l>>24&255]+"-"+qr[255&e]+qr[e>>8&255]+"-"+qr[e>>16&15|64]+qr[e>>24&255]+"-"+qr[63&t|128]+qr[t>>8&255]+"-"+qr[t>>16&255]+qr[t>>24&255]+qr[255&r]+qr[r>>8&255]+qr[r>>16&255]+qr[r>>24&255]).toLowerCase()}function Ji(l,e,t){return Math.max(e,Math.min(t,l))}function Jh(l,e,t){return(1-t)*l+t*e}function Vm(l){return 0==(l&l-1)&&0!==l}function kr(l){return Math.pow(2,Math.floor(Math.log(l)/Math.LN2))}function dr(l,e){switch(e.constructor){case Float32Array:return l;case Uint32Array:return l/4294967295;case Uint16Array:return l/65535;case Uint8Array:return l/255;case Int32Array:return Math.max(l/2147483647,-1);case Int16Array:return Math.max(l/32767,-1);case Int8Array:return Math.max(l/127,-1);default:throw new Error("Invalid component type.")}}function Fn(l,e){switch(e.constructor){case Float32Array:return l;case Uint32Array:return Math.round(4294967295*l);case Uint16Array:return Math.round(65535*l);case Uint8Array:return Math.round(255*l);case Int32Array:return Math.round(2147483647*l);case Int16Array:return Math.round(32767*l);case Int8Array:return Math.round(127*l);default:throw new Error("Invalid component type.")}}class je{constructor(e=0,t=0){je.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,r=this.y,s=e.elements;return this.x=s[0]*t+s[3]*r+s[6],this.y=s[1]*t+s[4]*r+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(Ji(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const r=Math.cos(t),s=Math.sin(t),a=this.x-e.x,u=this.y-e.y;return this.x=a*r-u*s+e.x,this.y=a*s+u*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Bn{constructor(e,t,r,s,a,u,d,p,m){Bn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,r,s,a,u,d,p,m)}set(e,t,r,s,a,u,d,p,m){const y=this.elements;return y[0]=e,y[1]=s,y[2]=d,y[3]=t,y[4]=a,y[5]=p,y[6]=r,y[7]=u,y[8]=m,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,s=t.elements,a=this.elements,u=r[0],d=r[3],p=r[6],m=r[1],y=r[4],x=r[7],M=r[2],E=r[5],A=r[8],L=s[0],D=s[3],S=s[6],U=s[1],N=s[4],V=s[7],j=s[2],q=s[5],Q=s[8];return a[0]=u*L+d*U+p*j,a[3]=u*D+d*N+p*q,a[6]=u*S+d*V+p*Q,a[1]=m*L+y*U+x*j,a[4]=m*D+y*N+x*q,a[7]=m*S+y*V+x*Q,a[2]=M*L+E*U+A*j,a[5]=M*D+E*N+A*q,a[8]=M*S+E*V+A*Q,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[1],s=e[2],a=e[3],u=e[4],d=e[5],p=e[6],m=e[7],y=e[8];return t*u*y-t*d*m-r*a*y+r*d*p+s*a*m-s*u*p}invert(){const e=this.elements,t=e[0],r=e[1],s=e[2],a=e[3],u=e[4],d=e[5],p=e[6],m=e[7],y=e[8],x=y*u-d*m,M=d*p-y*a,E=m*a-u*p,A=t*x+r*M+s*E;if(0===A)return this.set(0,0,0,0,0,0,0,0,0);const L=1/A;return e[0]=x*L,e[1]=(s*m-y*r)*L,e[2]=(d*r-s*u)*L,e[3]=M*L,e[4]=(y*t-s*p)*L,e[5]=(s*a-d*t)*L,e[6]=E*L,e[7]=(r*p-m*t)*L,e[8]=(u*t-r*a)*L,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,s,a,u,d){const p=Math.cos(a),m=Math.sin(a);return this.set(r*p,r*m,-r*(p*u+m*d)+u+e,-s*m,s*p,-s*(-m*u+p*d)+d+t,0,0,1),this}scale(e,t){return this.premultiply(Ff.makeScale(e,t)),this}rotate(e){return this.premultiply(Ff.makeRotation(-e)),this}translate(e,t){return this.premultiply(Ff.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,r=e.elements;for(let s=0;s<9;s++)if(t[s]!==r[s])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const Ff=new Bn;function Gm(l){for(let e=l.length-1;e>=0;--e)if(l[e]>=65535)return!0;return!1}function ol(l){return document.createElementNS("http://www.w3.org/1999/xhtml",l)}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const Ru={};function ed(l){l in Ru||(Ru[l]=!0,console.warn(l))}function Do(l){return l<.04045?.0773993808*l:Math.pow(.9478672986*l+.0521327014,2.4)}function Iu(l){return l<.0031308?12.92*l:1.055*Math.pow(l,.41666)-.055}const td=(new Bn).fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),U0=(new Bn).fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]),Wm={[Sr]:l=>l,[Ln]:l=>l.convertSRGBToLinear(),[mc]:function k0(l){return l.convertSRGBToLinear().applyMatrix3(U0)}},H0={[Sr]:l=>l,[Ln]:l=>l.convertLinearToSRGB(),[mc]:function B0(l){return l.applyMatrix3(td).convertLinearToSRGB()}},Yr={enabled:!0,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(l){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!l},get workingColorSpace(){return Sr},set workingColorSpace(l){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(l,e,t){if(!1===this.enabled||e===t||!e||!t)return l;const r=Wm[e],s=H0[t];if(void 0===r||void 0===s)throw new Error(`Unsupported color space conversion, "${e}" to "${t}".`);return s(r(l))},fromWorkingColorSpace:function(l,e){return this.convert(l,this.workingColorSpace,e)},toWorkingColorSpace:function(l,e){return this.convert(l,e,this.workingColorSpace)}};let al;class $m{static getDataURL(e){if(/^data:/i.test(e.src)||"undefined"==typeof HTMLCanvasElement)return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===al&&(al=ol("canvas")),al.width=e.width,al.height=e.height;const r=al.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=al}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const t=ol("canvas");t.width=e.width,t.height=e.height;const r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const s=r.getImageData(0,0,e.width,e.height),a=s.data;for(let u=0;u<a.length;u++)a[u]=255*Do(a[u]/255);return r.putImageData(s,0,0),t}if(e.data){const t=e.data.slice(0);for(let r=0;r<t.length;r++)t[r]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*Do(t[r]/255)):Do(t[r]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let Ar=0;class ll{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:Ar++}),this.uuid=Tr(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const r={uuid:this.uuid,url:""},s=this.data;if(null!==s){let a;if(Array.isArray(s)){a=[];for(let u=0,d=s.length;u<d;u++)a.push(Uf(s[u].isDataTexture?s[u].image:s[u]))}else a=Uf(s);r.url=a}return t||(e.images[this.uuid]=r),r}}function Uf(l){return"undefined"!=typeof HTMLImageElement&&l instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&l instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&l instanceof ImageBitmap?$m.getDataURL(l):l.data?{data:Array.from(l.data),width:l.width,height:l.height,type:l.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let kf=0,ks=(()=>{class l extends Tu{constructor(t=l.DEFAULT_IMAGE,r=l.DEFAULT_MAPPING,s=Mi,a=Mi,u=yi,d=wa,p=Fr,m=wo,y=l.DEFAULT_ANISOTROPY,x=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:kf++}),this.uuid=Tr(),this.name="",this.source=new ll(t),this.mipmaps=[],this.mapping=r,this.channel=0,this.wrapS=s,this.wrapT=a,this.magFilter=u,this.minFilter=d,this.anisotropy=y,this.format=p,this.internalFormat=null,this.type=m,this.offset=new je(0,0),this.repeat=new je(1,1),this.center=new je(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Bn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,"string"==typeof x?this.colorSpace=x:(ed("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=x===Jo?Ln:""),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const r=void 0===t||"string"==typeof t;if(!r&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const s={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(s.userData=this.userData),r||(t.textures[this.uuid]=s),s}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case 1e3:t.x=t.x-Math.floor(t.x);break;case Mi:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case 1e3:t.y=t.y-Math.floor(t.y);break;case Mi:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return ed("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===Ln?Jo:3e3}set encoding(t){ed("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=t===Jo?Ln:""}}return l.DEFAULT_IMAGE=null,l.DEFAULT_MAPPING=300,l.DEFAULT_ANISOTROPY=1,l})();class vi{constructor(e=0,t=0,r=0,s=1){vi.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,s){return this.x=e,this.y=t,this.z=r,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,r=this.y,s=this.z,a=this.w,u=e.elements;return this.x=u[0]*t+u[4]*r+u[8]*s+u[12]*a,this.y=u[1]*t+u[5]*r+u[9]*s+u[13]*a,this.z=u[2]*t+u[6]*r+u[10]*s+u[14]*a,this.w=u[3]*t+u[7]*r+u[11]*s+u[15]*a,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,s,a;const p=e.elements,m=p[0],y=p[4],x=p[8],M=p[1],E=p[5],A=p[9],L=p[2],D=p[6],S=p[10];if(Math.abs(y-M)<.01&&Math.abs(x-L)<.01&&Math.abs(A-D)<.01){if(Math.abs(y+M)<.1&&Math.abs(x+L)<.1&&Math.abs(A+D)<.1&&Math.abs(m+E+S-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const N=(m+1)/2,V=(E+1)/2,j=(S+1)/2,q=(y+M)/4,Q=(x+L)/4,ae=(A+D)/4;return N>V&&N>j?N<.01?(r=0,s=.707106781,a=.707106781):(r=Math.sqrt(N),s=q/r,a=Q/r):V>j?V<.01?(r=.707106781,s=0,a=.707106781):(s=Math.sqrt(V),r=q/s,a=ae/s):j<.01?(r=.707106781,s=.707106781,a=0):(a=Math.sqrt(j),r=Q/a,s=ae/a),this.set(r,s,a,t),this}let U=Math.sqrt((D-A)*(D-A)+(x-L)*(x-L)+(M-y)*(M-y));return Math.abs(U)<.001&&(U=1),this.x=(D-A)/U,this.y=(x-L)/U,this.z=(M-y)/U,this.w=Math.acos((m+E+S-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class z0 extends Tu{constructor(e=1,t=1,r={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new vi(0,0,e,t),this.scissorTest=!1,this.viewport=new vi(0,0,e,t);const s={width:e,height:t,depth:1};void 0!==r.encoding&&(ed("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),r.colorSpace=r.encoding===Jo?Ln:""),this.texture=new ks(s,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==r.generateMipmaps&&r.generateMipmaps,this.texture.internalFormat=void 0!==r.internalFormat?r.internalFormat:null,this.texture.minFilter=void 0!==r.minFilter?r.minFilter:yi,this.depthBuffer=void 0===r.depthBuffer||r.depthBuffer,this.stencilBuffer=void 0!==r.stencilBuffer&&r.stencilBuffer,this.depthTexture=void 0!==r.depthTexture?r.depthTexture:null,this.samples=void 0!==r.samples?r.samples:0}setSize(e,t,r=1){(this.width!==e||this.height!==t||this.depth!==r)&&(this.width=e,this.height=t,this.depth=r,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new ll(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class cl extends z0{constructor(e=1,t=1,r={}){super(e,t,r),this.isWebGLRenderTarget=!0}}class xc extends ks{constructor(e=null,t=1,r=1,s=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:s},this.magFilter=mi,this.minFilter=mi,this.wrapR=Mi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Bf extends ks{constructor(e=null,t=1,r=1,s=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:s},this.magFilter=mi,this.minFilter=mi,this.wrapR=Mi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class ls{constructor(e=0,t=0,r=0,s=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=s}static slerpFlat(e,t,r,s,a,u,d){let p=r[s+0],m=r[s+1],y=r[s+2],x=r[s+3];const M=a[u+0],E=a[u+1],A=a[u+2],L=a[u+3];if(0===d)return e[t+0]=p,e[t+1]=m,e[t+2]=y,void(e[t+3]=x);if(1===d)return e[t+0]=M,e[t+1]=E,e[t+2]=A,void(e[t+3]=L);if(x!==L||p!==M||m!==E||y!==A){let D=1-d;const S=p*M+m*E+y*A+x*L,U=S>=0?1:-1,N=1-S*S;if(N>Number.EPSILON){const j=Math.sqrt(N),q=Math.atan2(j,S*U);D=Math.sin(D*q)/j,d=Math.sin(d*q)/j}const V=d*U;if(p=p*D+M*V,m=m*D+E*V,y=y*D+A*V,x=x*D+L*V,D===1-d){const j=1/Math.sqrt(p*p+m*m+y*y+x*x);p*=j,m*=j,y*=j,x*=j}}e[t]=p,e[t+1]=m,e[t+2]=y,e[t+3]=x}static multiplyQuaternionsFlat(e,t,r,s,a,u){const d=r[s],p=r[s+1],m=r[s+2],y=r[s+3],x=a[u],M=a[u+1],E=a[u+2],A=a[u+3];return e[t]=d*A+y*x+p*E-m*M,e[t+1]=p*A+y*M+m*x-d*E,e[t+2]=m*A+y*E+d*M-p*x,e[t+3]=y*A-d*x-p*M-m*E,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,s){return this._x=e,this._y=t,this._z=r,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const r=e._x,s=e._y,a=e._z,u=e._order,d=Math.cos,p=Math.sin,m=d(r/2),y=d(s/2),x=d(a/2),M=p(r/2),E=p(s/2),A=p(a/2);switch(u){case"XYZ":this._x=M*y*x+m*E*A,this._y=m*E*x-M*y*A,this._z=m*y*A+M*E*x,this._w=m*y*x-M*E*A;break;case"YXZ":this._x=M*y*x+m*E*A,this._y=m*E*x-M*y*A,this._z=m*y*A-M*E*x,this._w=m*y*x+M*E*A;break;case"ZXY":this._x=M*y*x-m*E*A,this._y=m*E*x+M*y*A,this._z=m*y*A+M*E*x,this._w=m*y*x-M*E*A;break;case"ZYX":this._x=M*y*x-m*E*A,this._y=m*E*x+M*y*A,this._z=m*y*A-M*E*x,this._w=m*y*x+M*E*A;break;case"YZX":this._x=M*y*x+m*E*A,this._y=m*E*x+M*y*A,this._z=m*y*A-M*E*x,this._w=m*y*x-M*E*A;break;case"XZY":this._x=M*y*x-m*E*A,this._y=m*E*x-M*y*A,this._z=m*y*A+M*E*x,this._w=m*y*x+M*E*A;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+u)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const r=t/2,s=Math.sin(r);return this._x=e.x*s,this._y=e.y*s,this._z=e.z*s,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,r=t[0],s=t[4],a=t[8],u=t[1],d=t[5],p=t[9],m=t[2],y=t[6],x=t[10],M=r+d+x;if(M>0){const E=.5/Math.sqrt(M+1);this._w=.25/E,this._x=(y-p)*E,this._y=(a-m)*E,this._z=(u-s)*E}else if(r>d&&r>x){const E=2*Math.sqrt(1+r-d-x);this._w=(y-p)/E,this._x=.25*E,this._y=(s+u)/E,this._z=(a+m)/E}else if(d>x){const E=2*Math.sqrt(1+d-r-x);this._w=(a-m)/E,this._x=(s+u)/E,this._y=.25*E,this._z=(p+y)/E}else{const E=2*Math.sqrt(1+x-r-d);this._w=(u-s)/E,this._x=(a+m)/E,this._y=(p+y)/E,this._z=.25*E}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Ji(this.dot(e),-1,1)))}rotateTowards(e,t){const r=this.angleTo(e);if(0===r)return this;const s=Math.min(1,t/r);return this.slerp(e,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const r=e._x,s=e._y,a=e._z,u=e._w,d=t._x,p=t._y,m=t._z,y=t._w;return this._x=r*y+u*d+s*m-a*p,this._y=s*y+u*p+a*d-r*m,this._z=a*y+u*m+r*p-s*d,this._w=u*y-r*d-s*p-a*m,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const r=this._x,s=this._y,a=this._z,u=this._w;let d=u*e._w+r*e._x+s*e._y+a*e._z;if(d<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,d=-d):this.copy(e),d>=1)return this._w=u,this._x=r,this._y=s,this._z=a,this;const p=1-d*d;if(p<=Number.EPSILON){const E=1-t;return this._w=E*u+t*this._w,this._x=E*r+t*this._x,this._y=E*s+t*this._y,this._z=E*a+t*this._z,this.normalize(),this._onChangeCallback(),this}const m=Math.sqrt(p),y=Math.atan2(m,d),x=Math.sin((1-t)*y)/m,M=Math.sin(t*y)/m;return this._w=u*x+this._w*M,this._x=r*x+this._x*M,this._y=s*x+this._y*M,this._z=a*x+this._z*M,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){const e=Math.random(),t=Math.sqrt(1-e),r=Math.sqrt(e),s=2*Math.PI*Math.random(),a=2*Math.PI*Math.random();return this.set(t*Math.cos(s),r*Math.sin(a),r*Math.cos(a),t*Math.sin(s))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class J{constructor(e=0,t=0,r=0){J.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return void 0===r&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(Hf.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Hf.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,r=this.y,s=this.z,a=e.elements;return this.x=a[0]*t+a[3]*r+a[6]*s,this.y=a[1]*t+a[4]*r+a[7]*s,this.z=a[2]*t+a[5]*r+a[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,r=this.y,s=this.z,a=e.elements,u=1/(a[3]*t+a[7]*r+a[11]*s+a[15]);return this.x=(a[0]*t+a[4]*r+a[8]*s+a[12])*u,this.y=(a[1]*t+a[5]*r+a[9]*s+a[13])*u,this.z=(a[2]*t+a[6]*r+a[10]*s+a[14])*u,this}applyQuaternion(e){const t=this.x,r=this.y,s=this.z,a=e.x,u=e.y,d=e.z,p=e.w,m=p*t+u*s-d*r,y=p*r+d*t-a*s,x=p*s+a*r-u*t,M=-a*t-u*r-d*s;return this.x=m*p+M*-a+y*-d-x*-u,this.y=y*p+M*-u+x*-a-m*-d,this.z=x*p+M*-d+m*-u-y*-a,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,r=this.y,s=this.z,a=e.elements;return this.x=a[0]*t+a[4]*r+a[8]*s,this.y=a[1]*t+a[5]*r+a[9]*s,this.z=a[2]*t+a[6]*r+a[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const r=e.x,s=e.y,a=e.z,u=t.x,d=t.y,p=t.z;return this.x=s*p-a*d,this.y=a*u-r*p,this.z=r*d-s*u,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return Mc.copy(this).projectOnVector(e),this.sub(Mc)}reflect(e){return this.sub(Mc.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(Ji(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y,s=this.z-e.z;return t*t+r*r+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){const s=Math.sin(t)*e;return this.x=s*Math.sin(r),this.y=Math.cos(t)*e,this.z=s*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=s,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,r=Math.sqrt(1-e**2);return this.x=r*Math.cos(t),this.y=r*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Mc=new J,Hf=new ls;class ea{constructor(e=new J(1/0,1/0,1/0),t=new J(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t+=3)this.expandByPoint(cs.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,r=e.count;t<r;t++)this.expandByPoint(cs.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=cs.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){if(e.updateWorldMatrix(!1,!1),void 0!==e.boundingBox)null===e.boundingBox&&e.computeBoundingBox(),Ro.copy(e.boundingBox),Ro.applyMatrix4(e.matrixWorld),this.union(Ro);else{const s=e.geometry;if(void 0!==s)if(t&&void 0!==s.attributes&&void 0!==s.attributes.position){const a=s.attributes.position;for(let u=0,d=a.count;u<d;u++)cs.fromBufferAttribute(a,u).applyMatrix4(e.matrixWorld),this.expandByPoint(cs)}else null===s.boundingBox&&s.computeBoundingBox(),Ro.copy(s.boundingBox),Ro.applyMatrix4(e.matrixWorld),this.union(Ro)}const r=e.children;for(let s=0,a=r.length;s<a;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,cs),cs.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Lu),rd.subVectors(this.max,Lu),bc.subVectors(e.a,Lu),Pu.subVectors(e.b,Lu),ul.subVectors(e.c,Lu),Ca.subVectors(Pu,bc),hl.subVectors(ul,Pu),dl.subVectors(bc,ul);let t=[0,-Ca.z,Ca.y,0,-hl.z,hl.y,0,-dl.z,dl.y,Ca.z,0,-Ca.x,hl.z,0,-hl.x,dl.z,0,-dl.x,-Ca.y,Ca.x,0,-hl.y,hl.x,0,-dl.y,dl.x,0];return!(!Bs(t,bc,Pu,ul,rd)||(t=[1,0,0,0,1,0,0,0,1],!Bs(t,bc,Pu,ul,rd)))&&(sd.crossVectors(Ca,hl),t=[sd.x,sd.y,sd.z],Bs(t,bc,Pu,ul,rd))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,cs).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(cs).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(ta[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),ta[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),ta[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),ta[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),ta[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),ta[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),ta[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),ta[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(ta)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const ta=[new J,new J,new J,new J,new J,new J,new J,new J],cs=new J,Ro=new ea,bc=new J,Pu=new J,ul=new J,Ca=new J,hl=new J,dl=new J,Lu=new J,rd=new J,sd=new J,Ec=new J;function Bs(l,e,t,r,s){for(let a=0,u=l.length-3;a<=u;a+=3){Ec.fromArray(l,a);const d=s.x*Math.abs(Ec.x)+s.y*Math.abs(Ec.y)+s.z*Math.abs(Ec.z),p=e.dot(Ec),m=t.dot(Ec),y=r.dot(Ec);if(Math.max(-Math.max(p,m,y),Math.min(p,m,y))>d)return!1}return!0}const V0=new ea,Nu=new J,zf=new J;class oo{constructor(e=new J,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const r=this.center;void 0!==t?r.copy(t):V0.setFromPoints(e).getCenter(r);let s=0;for(let a=0,u=e.length;a<u;a++)s=Math.max(s,r.distanceToSquared(e[a]));return this.radius=Math.sqrt(s),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Nu.subVectors(e,this.center);const t=Nu.lengthSq();if(t>this.radius*this.radius){const r=Math.sqrt(t),s=.5*(r-this.radius);this.center.addScaledVector(Nu,s/r),this.radius+=s}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(zf.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Nu.copy(e.center).add(zf)),this.expandByPoint(Nu.copy(e.center).sub(zf))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Vi=new J,Ou=new J,Fu=new J,na=new J,_r=new J,Da=new J,Uu=new J;class ku{constructor(e=new J,t=new J(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Vi)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Vi.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Vi.copy(this.origin).addScaledVector(this.direction,t),Vi.distanceToSquared(e))}distanceSqToSegment(e,t,r,s){Ou.copy(e).add(t).multiplyScalar(.5),Fu.copy(t).sub(e).normalize(),na.copy(this.origin).sub(Ou);const a=.5*e.distanceTo(t),u=-this.direction.dot(Fu),d=na.dot(this.direction),p=-na.dot(Fu),m=na.lengthSq(),y=Math.abs(1-u*u);let x,M,E,A;if(y>0)if(x=u*p-d,M=u*d-p,A=a*y,x>=0)if(M>=-A)if(M<=A){const L=1/y;x*=L,M*=L,E=x*(x+u*M+2*d)+M*(u*x+M+2*p)+m}else M=a,x=Math.max(0,-(u*M+d)),E=-x*x+M*(M+2*p)+m;else M=-a,x=Math.max(0,-(u*M+d)),E=-x*x+M*(M+2*p)+m;else M<=-A?(x=Math.max(0,-(-u*a+d)),M=x>0?-a:Math.min(Math.max(-a,-p),a),E=-x*x+M*(M+2*p)+m):M<=A?(x=0,M=Math.min(Math.max(-a,-p),a),E=M*(M+2*p)+m):(x=Math.max(0,-(u*a+d)),M=x>0?a:Math.min(Math.max(-a,-p),a),E=-x*x+M*(M+2*p)+m);else M=u>0?-a:a,x=Math.max(0,-(u*M+d)),E=-x*x+M*(M+2*p)+m;return r&&r.copy(this.origin).addScaledVector(this.direction,x),s&&s.copy(Ou).addScaledVector(Fu,M),E}intersectSphere(e,t){Vi.subVectors(e.center,this.origin);const r=Vi.dot(this.direction),s=Vi.dot(Vi)-r*r,a=e.radius*e.radius;if(s>a)return null;const u=Math.sqrt(a-s),d=r-u,p=r+u;return p<0?null:this.at(d<0?p:d,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){const r=this.distanceToPlane(e);return null===r?null:this.at(r,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,s,a,u,d,p;const m=1/this.direction.x,y=1/this.direction.y,x=1/this.direction.z,M=this.origin;return m>=0?(r=(e.min.x-M.x)*m,s=(e.max.x-M.x)*m):(r=(e.max.x-M.x)*m,s=(e.min.x-M.x)*m),y>=0?(a=(e.min.y-M.y)*y,u=(e.max.y-M.y)*y):(a=(e.max.y-M.y)*y,u=(e.min.y-M.y)*y),r>u||a>s||((a>r||isNaN(r))&&(r=a),(u<s||isNaN(s))&&(s=u),x>=0?(d=(e.min.z-M.z)*x,p=(e.max.z-M.z)*x):(d=(e.max.z-M.z)*x,p=(e.min.z-M.z)*x),r>p||d>s)||((d>r||r!=r)&&(r=d),(p<s||s!=s)&&(s=p),s<0)?null:this.at(r>=0?r:s,t)}intersectsBox(e){return null!==this.intersectBox(e,Vi)}intersectTriangle(e,t,r,s,a){_r.subVectors(t,e),Da.subVectors(r,e),Uu.crossVectors(_r,Da);let d,u=this.direction.dot(Uu);if(u>0){if(s)return null;d=1}else{if(!(u<0))return null;d=-1,u=-u}na.subVectors(this.origin,e);const p=d*this.direction.dot(Da.crossVectors(na,Da));if(p<0)return null;const m=d*this.direction.dot(_r.cross(na));if(m<0||p+m>u)return null;const y=-d*na.dot(Uu);return y<0?null:this.at(y/u,a)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Nn{constructor(e,t,r,s,a,u,d,p,m,y,x,M,E,A,L,D){Nn.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,r,s,a,u,d,p,m,y,x,M,E,A,L,D)}set(e,t,r,s,a,u,d,p,m,y,x,M,E,A,L,D){const S=this.elements;return S[0]=e,S[4]=t,S[8]=r,S[12]=s,S[1]=a,S[5]=u,S[9]=d,S[13]=p,S[2]=m,S[6]=y,S[10]=x,S[14]=M,S[3]=E,S[7]=A,S[11]=L,S[15]=D,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Nn).fromArray(this.elements)}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){const t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,r=e.elements,s=1/fl.setFromMatrixColumn(e,0).length(),a=1/fl.setFromMatrixColumn(e,1).length(),u=1/fl.setFromMatrixColumn(e,2).length();return t[0]=r[0]*s,t[1]=r[1]*s,t[2]=r[2]*s,t[3]=0,t[4]=r[4]*a,t[5]=r[5]*a,t[6]=r[6]*a,t[7]=0,t[8]=r[8]*u,t[9]=r[9]*u,t[10]=r[10]*u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,r=e.x,s=e.y,a=e.z,u=Math.cos(r),d=Math.sin(r),p=Math.cos(s),m=Math.sin(s),y=Math.cos(a),x=Math.sin(a);if("XYZ"===e.order){const M=u*y,E=u*x,A=d*y,L=d*x;t[0]=p*y,t[4]=-p*x,t[8]=m,t[1]=E+A*m,t[5]=M-L*m,t[9]=-d*p,t[2]=L-M*m,t[6]=A+E*m,t[10]=u*p}else if("YXZ"===e.order){const M=p*y,E=p*x,A=m*y,L=m*x;t[0]=M+L*d,t[4]=A*d-E,t[8]=u*m,t[1]=u*x,t[5]=u*y,t[9]=-d,t[2]=E*d-A,t[6]=L+M*d,t[10]=u*p}else if("ZXY"===e.order){const M=p*y,E=p*x,A=m*y,L=m*x;t[0]=M-L*d,t[4]=-u*x,t[8]=A+E*d,t[1]=E+A*d,t[5]=u*y,t[9]=L-M*d,t[2]=-u*m,t[6]=d,t[10]=u*p}else if("ZYX"===e.order){const M=u*y,E=u*x,A=d*y,L=d*x;t[0]=p*y,t[4]=A*m-E,t[8]=M*m+L,t[1]=p*x,t[5]=L*m+M,t[9]=E*m-A,t[2]=-m,t[6]=d*p,t[10]=u*p}else if("YZX"===e.order){const M=u*p,E=u*m,A=d*p,L=d*m;t[0]=p*y,t[4]=L-M*x,t[8]=A*x+E,t[1]=x,t[5]=u*y,t[9]=-d*y,t[2]=-m*y,t[6]=E*x+A,t[10]=M-L*x}else if("XZY"===e.order){const M=u*p,E=u*m,A=d*p,L=d*m;t[0]=p*y,t[4]=-x,t[8]=m*y,t[1]=M*x+L,t[5]=u*y,t[9]=E*x-A,t[2]=A*x-E,t[6]=d*y,t[10]=L*x+M}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(jm,e,G0)}lookAt(e,t,r){const s=this.elements;return Ss.subVectors(e,t),0===Ss.lengthSq()&&(Ss.z=1),Ss.normalize(),ia.crossVectors(r,Ss),0===ia.lengthSq()&&(1===Math.abs(r.z)?Ss.x+=1e-4:Ss.z+=1e-4,Ss.normalize(),ia.crossVectors(r,Ss)),ia.normalize(),od.crossVectors(Ss,ia),s[0]=ia.x,s[4]=od.x,s[8]=Ss.x,s[1]=ia.y,s[5]=od.y,s[9]=Ss.y,s[2]=ia.z,s[6]=od.z,s[10]=Ss.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,s=t.elements,a=this.elements,u=r[0],d=r[4],p=r[8],m=r[12],y=r[1],x=r[5],M=r[9],E=r[13],A=r[2],L=r[6],D=r[10],S=r[14],U=r[3],N=r[7],V=r[11],j=r[15],q=s[0],Q=s[4],ae=s[8],W=s[12],Y=s[1],Ce=s[5],qe=s[9],ye=s[13],xe=s[2],Se=s[6],Xe=s[10],Oe=s[14],ze=s[3],Je=s[7],Qe=s[11],me=s[15];return a[0]=u*q+d*Y+p*xe+m*ze,a[4]=u*Q+d*Ce+p*Se+m*Je,a[8]=u*ae+d*qe+p*Xe+m*Qe,a[12]=u*W+d*ye+p*Oe+m*me,a[1]=y*q+x*Y+M*xe+E*ze,a[5]=y*Q+x*Ce+M*Se+E*Je,a[9]=y*ae+x*qe+M*Xe+E*Qe,a[13]=y*W+x*ye+M*Oe+E*me,a[2]=A*q+L*Y+D*xe+S*ze,a[6]=A*Q+L*Ce+D*Se+S*Je,a[10]=A*ae+L*qe+D*Xe+S*Qe,a[14]=A*W+L*ye+D*Oe+S*me,a[3]=U*q+N*Y+V*xe+j*ze,a[7]=U*Q+N*Ce+V*Se+j*Je,a[11]=U*ae+N*qe+V*Xe+j*Qe,a[15]=U*W+N*ye+V*Oe+j*me,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[4],s=e[8],a=e[12],u=e[1],d=e[5],p=e[9],m=e[13],y=e[2],x=e[6],M=e[10],E=e[14];return e[3]*(+a*p*x-s*m*x-a*d*M+r*m*M+s*d*E-r*p*E)+e[7]*(+t*p*E-t*m*M+a*u*M-s*u*E+s*m*y-a*p*y)+e[11]*(+t*m*x-t*d*E-a*u*x+r*u*E+a*d*y-r*m*y)+e[15]*(-s*d*y-t*p*x+t*d*M+s*u*x-r*u*M+r*p*y)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){const s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=t,s[14]=r),this}invert(){const e=this.elements,t=e[0],r=e[1],s=e[2],a=e[3],u=e[4],d=e[5],p=e[6],m=e[7],y=e[8],x=e[9],M=e[10],E=e[11],A=e[12],L=e[13],D=e[14],S=e[15],U=x*D*m-L*M*m+L*p*E-d*D*E-x*p*S+d*M*S,N=A*M*m-y*D*m-A*p*E+u*D*E+y*p*S-u*M*S,V=y*L*m-A*x*m+A*d*E-u*L*E-y*d*S+u*x*S,j=A*x*p-y*L*p-A*d*M+u*L*M+y*d*D-u*x*D,q=t*U+r*N+s*V+a*j;if(0===q)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const Q=1/q;return e[0]=U*Q,e[1]=(L*M*a-x*D*a-L*s*E+r*D*E+x*s*S-r*M*S)*Q,e[2]=(d*D*a-L*p*a+L*s*m-r*D*m-d*s*S+r*p*S)*Q,e[3]=(x*p*a-d*M*a-x*s*m+r*M*m+d*s*E-r*p*E)*Q,e[4]=N*Q,e[5]=(y*D*a-A*M*a+A*s*E-t*D*E-y*s*S+t*M*S)*Q,e[6]=(A*p*a-u*D*a-A*s*m+t*D*m+u*s*S-t*p*S)*Q,e[7]=(u*M*a-y*p*a+y*s*m-t*M*m-u*s*E+t*p*E)*Q,e[8]=V*Q,e[9]=(A*x*a-y*L*a-A*r*E+t*L*E+y*r*S-t*x*S)*Q,e[10]=(u*L*a-A*d*a+A*r*m-t*L*m-u*r*S+t*d*S)*Q,e[11]=(y*d*a-u*x*a-y*r*m+t*x*m+u*r*E-t*d*E)*Q,e[12]=j*Q,e[13]=(y*L*s-A*x*s+A*r*M-t*L*M-y*r*D+t*x*D)*Q,e[14]=(A*d*s-u*L*s-A*r*p+t*L*p+u*r*D-t*d*D)*Q,e[15]=(u*x*s-y*d*s+y*r*p-t*x*p-u*r*M+t*d*M)*Q,this}scale(e){const t=this.elements,r=e.x,s=e.y,a=e.z;return t[0]*=r,t[4]*=s,t[8]*=a,t[1]*=r,t[5]*=s,t[9]*=a,t[2]*=r,t[6]*=s,t[10]*=a,t[3]*=r,t[7]*=s,t[11]*=a,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const r=Math.cos(t),s=Math.sin(t),a=1-r,u=e.x,d=e.y,p=e.z,m=a*u,y=a*d;return this.set(m*u+r,m*d-s*p,m*p+s*d,0,m*d+s*p,y*d+r,y*p-s*u,0,m*p-s*d,y*p+s*u,a*p*p+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,s,a,u){return this.set(1,r,a,0,e,1,u,0,t,s,1,0,0,0,0,1),this}compose(e,t,r){const s=this.elements,a=t._x,u=t._y,d=t._z,p=t._w,m=a+a,y=u+u,x=d+d,M=a*m,E=a*y,A=a*x,L=u*y,D=u*x,S=d*x,U=p*m,N=p*y,V=p*x,j=r.x,q=r.y,Q=r.z;return s[0]=(1-(L+S))*j,s[1]=(E+V)*j,s[2]=(A-N)*j,s[3]=0,s[4]=(E-V)*q,s[5]=(1-(M+S))*q,s[6]=(D+U)*q,s[7]=0,s[8]=(A+N)*Q,s[9]=(D-U)*Q,s[10]=(1-(M+L))*Q,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,t,r){const s=this.elements;let a=fl.set(s[0],s[1],s[2]).length();const u=fl.set(s[4],s[5],s[6]).length(),d=fl.set(s[8],s[9],s[10]).length();this.determinant()<0&&(a=-a),e.x=s[12],e.y=s[13],e.z=s[14],ao.copy(this);const m=1/a,y=1/u,x=1/d;return ao.elements[0]*=m,ao.elements[1]*=m,ao.elements[2]*=m,ao.elements[4]*=y,ao.elements[5]*=y,ao.elements[6]*=y,ao.elements[8]*=x,ao.elements[9]*=x,ao.elements[10]*=x,t.setFromRotationMatrix(ao),r.x=a,r.y=u,r.z=d,this}makePerspective(e,t,r,s,a,u,d=Qo){const p=this.elements,m=2*a/(t-e),y=2*a/(r-s),x=(t+e)/(t-e),M=(r+s)/(r-s);let E,A;if(d===Qo)E=-(u+a)/(u-a),A=-2*u*a/(u-a);else{if(2001!==d)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+d);E=-u/(u-a),A=-u*a/(u-a)}return p[0]=m,p[4]=0,p[8]=x,p[12]=0,p[1]=0,p[5]=y,p[9]=M,p[13]=0,p[2]=0,p[6]=0,p[10]=E,p[14]=A,p[3]=0,p[7]=0,p[11]=-1,p[15]=0,this}makeOrthographic(e,t,r,s,a,u,d=Qo){const p=this.elements,m=1/(t-e),y=1/(r-s),x=1/(u-a),M=(t+e)*m,E=(r+s)*y;let A,L;if(d===Qo)A=(u+a)*x,L=-2*x;else{if(2001!==d)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+d);A=a*x,L=-1*x}return p[0]=2*m,p[4]=0,p[8]=0,p[12]=-M,p[1]=0,p[5]=2*y,p[9]=0,p[13]=-E,p[2]=0,p[6]=0,p[10]=L,p[14]=-A,p[3]=0,p[7]=0,p[11]=0,p[15]=1,this}equals(e){const t=this.elements,r=e.elements;for(let s=0;s<16;s++)if(t[s]!==r[s])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}const fl=new J,ao=new Nn,jm=new J(0,0,0),G0=new J(1,1,1),ia=new J,od=new J,Ss=new J,ad=new Nn,ld=new ls;let W0=(()=>{class l{constructor(t=0,r=0,s=0,a=l.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=r,this._z=s,this._order=a}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,r,s,a=this._order){return this._x=t,this._y=r,this._z=s,this._order=a,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,r=this._order,s=!0){const a=t.elements,u=a[0],d=a[4],p=a[8],m=a[1],y=a[5],x=a[9],M=a[2],E=a[6],A=a[10];switch(r){case"XYZ":this._y=Math.asin(Ji(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(-x,A),this._z=Math.atan2(-d,u)):(this._x=Math.atan2(E,y),this._z=0);break;case"YXZ":this._x=Math.asin(-Ji(x,-1,1)),Math.abs(x)<.9999999?(this._y=Math.atan2(p,A),this._z=Math.atan2(m,y)):(this._y=Math.atan2(-M,u),this._z=0);break;case"ZXY":this._x=Math.asin(Ji(E,-1,1)),Math.abs(E)<.9999999?(this._y=Math.atan2(-M,A),this._z=Math.atan2(-d,y)):(this._y=0,this._z=Math.atan2(m,u));break;case"ZYX":this._y=Math.asin(-Ji(M,-1,1)),Math.abs(M)<.9999999?(this._x=Math.atan2(E,A),this._z=Math.atan2(m,u)):(this._x=0,this._z=Math.atan2(-d,y));break;case"YZX":this._z=Math.asin(Ji(m,-1,1)),Math.abs(m)<.9999999?(this._x=Math.atan2(-x,y),this._y=Math.atan2(-M,u)):(this._x=0,this._y=Math.atan2(p,A));break;case"XZY":this._z=Math.asin(-Ji(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(E,y),this._y=Math.atan2(p,u)):(this._x=Math.atan2(-x,A),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+r)}return this._order=r,!0===s&&this._onChangeCallback(),this}setFromQuaternion(t,r,s){return ad.makeRotationFromQuaternion(t),this.setFromRotationMatrix(ad,r,s)}setFromVector3(t,r=this._order){return this.set(t.x,t.y,t.z,r)}reorder(t){return ld.setFromEuler(this),this.setFromQuaternion(ld,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],r=0){return t[r]=this._x,t[r+1]=this._y,t[r+2]=this._z,t[r+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return l.DEFAULT_ORDER="XYZ",l})();class cd{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let Bu=0;const Vf=new J,pl=new ls,lo=new Nn,wc=new J,Sc=new J,mM=new J,Tc=new ls,ud=new J(1,0,0),Gf=new J(0,1,0),Xm=new J(0,0,1),Wf={type:"added"},qm={type:"removed"};let Hs=(()=>{class l extends Tu{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Bu++}),this.uuid=Tr(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=l.DEFAULT_UP.clone();const t=new J,r=new W0,s=new ls,a=new J(1,1,1);r._onChange(function u(){s.setFromEuler(r,!1)}),s._onChange(function d(){r.setFromQuaternion(s,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:r},quaternion:{configurable:!0,enumerable:!0,value:s},scale:{configurable:!0,enumerable:!0,value:a},modelViewMatrix:{value:new Nn},normalMatrix:{value:new Bn}}),this.matrix=new Nn,this.matrixWorld=new Nn,this.matrixAutoUpdate=l.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=l.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new cd,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,r){this.quaternion.setFromAxisAngle(t,r)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,r){return pl.setFromAxisAngle(t,r),this.quaternion.multiply(pl),this}rotateOnWorldAxis(t,r){return pl.setFromAxisAngle(t,r),this.quaternion.premultiply(pl),this}rotateX(t){return this.rotateOnAxis(ud,t)}rotateY(t){return this.rotateOnAxis(Gf,t)}rotateZ(t){return this.rotateOnAxis(Xm,t)}translateOnAxis(t,r){return Vf.copy(t).applyQuaternion(this.quaternion),this.position.add(Vf.multiplyScalar(r)),this}translateX(t){return this.translateOnAxis(ud,t)}translateY(t){return this.translateOnAxis(Gf,t)}translateZ(t){return this.translateOnAxis(Xm,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(lo.copy(this.matrixWorld).invert())}lookAt(t,r,s){t.isVector3?wc.copy(t):wc.set(t,r,s);const a=this.parent;this.updateWorldMatrix(!0,!1),Sc.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?lo.lookAt(Sc,wc,this.up):lo.lookAt(wc,Sc,this.up),this.quaternion.setFromRotationMatrix(lo),a&&(lo.extractRotation(a.matrixWorld),pl.setFromRotationMatrix(lo),this.quaternion.premultiply(pl.invert()))}add(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.add(arguments[r]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(Wf)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let s=0;s<arguments.length;s++)this.remove(arguments[s]);return this}const r=this.children.indexOf(t);return-1!==r&&(t.parent=null,this.children.splice(r,1),t.dispatchEvent(qm)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const r=this.children[t];r.parent=null,r.dispatchEvent(qm)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),lo.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),lo.multiply(t.parent.matrixWorld)),t.applyMatrix4(lo),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,r){if(this[t]===r)return this;for(let s=0,a=this.children.length;s<a;s++){const d=this.children[s].getObjectByProperty(t,r);if(void 0!==d)return d}}getObjectsByProperty(t,r){let s=[];this[t]===r&&s.push(this);for(let a=0,u=this.children.length;a<u;a++){const d=this.children[a].getObjectsByProperty(t,r);d.length>0&&(s=s.concat(d))}return s}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Sc,t,mM),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Sc,Tc,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const r=this.matrixWorld.elements;return t.set(r[8],r[9],r[10]).normalize()}raycast(){}traverse(t){t(this);const r=this.children;for(let s=0,a=r.length;s<a;s++)r[s].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const r=this.children;for(let s=0,a=r.length;s<a;s++)r[s].traverseVisible(t)}traverseAncestors(t){const r=this.parent;null!==r&&(t(r),r.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const r=this.children;for(let s=0,a=r.length;s<a;s++){const u=r[s];(!0===u.matrixWorldAutoUpdate||!0===t)&&u.updateMatrixWorld(t)}}updateWorldMatrix(t,r){const s=this.parent;if(!0===t&&null!==s&&!0===s.matrixWorldAutoUpdate&&s.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===r){const a=this.children;for(let u=0,d=a.length;u<d;u++){const p=a[u];!0===p.matrixWorldAutoUpdate&&p.updateWorldMatrix(!1,!0)}}}toJSON(t){const r=void 0===t||"string"==typeof t,s={};r&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},s.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const a={};function u(p,m){return void 0===p[m.uuid]&&(p[m.uuid]=m.toJSON(t)),m.uuid}if(a.uuid=this.uuid,a.type=this.type,""!==this.name&&(a.name=this.name),!0===this.castShadow&&(a.castShadow=!0),!0===this.receiveShadow&&(a.receiveShadow=!0),!1===this.visible&&(a.visible=!1),!1===this.frustumCulled&&(a.frustumCulled=!1),0!==this.renderOrder&&(a.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(a.userData=this.userData),a.layers=this.layers.mask,a.matrix=this.matrix.toArray(),a.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(a.matrixAutoUpdate=!1),this.isInstancedMesh&&(a.type="InstancedMesh",a.count=this.count,a.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(a.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?a.background=this.background.toJSON():this.background.isTexture&&(a.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(a.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){a.geometry=u(t.geometries,this.geometry);const p=this.geometry.parameters;if(void 0!==p&&void 0!==p.shapes){const m=p.shapes;if(Array.isArray(m))for(let y=0,x=m.length;y<x;y++)u(t.shapes,m[y]);else u(t.shapes,m)}}if(this.isSkinnedMesh&&(a.bindMode=this.bindMode,a.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(u(t.skeletons,this.skeleton),a.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const p=[];for(let m=0,y=this.material.length;m<y;m++)p.push(u(t.materials,this.material[m]));a.material=p}else a.material=u(t.materials,this.material);if(this.children.length>0){a.children=[];for(let p=0;p<this.children.length;p++)a.children.push(this.children[p].toJSON(t).object)}if(this.animations.length>0){a.animations=[];for(let p=0;p<this.animations.length;p++)a.animations.push(u(t.animations,this.animations[p]))}if(r){const p=d(t.geometries),m=d(t.materials),y=d(t.textures),x=d(t.images),M=d(t.shapes),E=d(t.skeletons),A=d(t.animations),L=d(t.nodes);p.length>0&&(s.geometries=p),m.length>0&&(s.materials=m),y.length>0&&(s.textures=y),x.length>0&&(s.images=x),M.length>0&&(s.shapes=M),E.length>0&&(s.skeletons=E),A.length>0&&(s.animations=A),L.length>0&&(s.nodes=L)}return s.object=a,s;function d(p){const m=[];for(const y in p){const x=p[y];delete x.metadata,m.push(x)}return m}}clone(t){return(new this.constructor).copy(this,t)}copy(t,r=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),!0===r)for(let s=0;s<t.children.length;s++)this.add(t.children[s].clone());return this}}return l.DEFAULT_UP=new J(0,1,0),l.DEFAULT_MATRIX_AUTO_UPDATE=!0,l.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,l})();const co=new J,ra=new J,$f=new J,sa=new J,ml=new J,Ra=new J,jf=new J,Hu=new J,Xf=new J,qf=new J;let zu=!1;class us{constructor(e=new J,t=new J,r=new J){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,s){s.subVectors(r,t),co.subVectors(e,t),s.cross(co);const a=s.lengthSq();return a>0?s.multiplyScalar(1/Math.sqrt(a)):s.set(0,0,0)}static getBarycoord(e,t,r,s,a){co.subVectors(s,t),ra.subVectors(r,t),$f.subVectors(e,t);const u=co.dot(co),d=co.dot(ra),p=co.dot($f),m=ra.dot(ra),y=ra.dot($f),x=u*m-d*d;if(0===x)return a.set(-2,-1,-1);const M=1/x,E=(m*p-d*y)*M,A=(u*y-d*p)*M;return a.set(1-E-A,A,E)}static containsPoint(e,t,r,s){return this.getBarycoord(e,t,r,s,sa),sa.x>=0&&sa.y>=0&&sa.x+sa.y<=1}static getUV(e,t,r,s,a,u,d,p){return!1===zu&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),zu=!0),this.getInterpolation(e,t,r,s,a,u,d,p)}static getInterpolation(e,t,r,s,a,u,d,p){return this.getBarycoord(e,t,r,s,sa),p.setScalar(0),p.addScaledVector(a,sa.x),p.addScaledVector(u,sa.y),p.addScaledVector(d,sa.z),p}static isFrontFacing(e,t,r,s){return co.subVectors(r,t),ra.subVectors(e,t),co.cross(ra).dot(s)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,s){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,t,r,s){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,s),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return co.subVectors(this.c,this.b),ra.subVectors(this.a,this.b),.5*co.cross(ra).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return us.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return us.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,r,s,a){return!1===zu&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),zu=!0),us.getInterpolation(e,this.a,this.b,this.c,t,r,s,a)}getInterpolation(e,t,r,s,a){return us.getInterpolation(e,this.a,this.b,this.c,t,r,s,a)}containsPoint(e){return us.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return us.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const r=this.a,s=this.b,a=this.c;let u,d;ml.subVectors(s,r),Ra.subVectors(a,r),Hu.subVectors(e,r);const p=ml.dot(Hu),m=Ra.dot(Hu);if(p<=0&&m<=0)return t.copy(r);Xf.subVectors(e,s);const y=ml.dot(Xf),x=Ra.dot(Xf);if(y>=0&&x<=y)return t.copy(s);const M=p*x-y*m;if(M<=0&&p>=0&&y<=0)return u=p/(p-y),t.copy(r).addScaledVector(ml,u);qf.subVectors(e,a);const E=ml.dot(qf),A=Ra.dot(qf);if(A>=0&&E<=A)return t.copy(a);const L=E*m-p*A;if(L<=0&&m>=0&&A<=0)return d=m/(m-A),t.copy(r).addScaledVector(Ra,d);const D=y*A-E*x;if(D<=0&&x-y>=0&&E-A>=0)return jf.subVectors(a,s),d=(x-y)/(x-y+(E-A)),t.copy(s).addScaledVector(jf,d);const S=1/(D+L+M);return u=L*S,d=M*S,t.copy(r).addScaledVector(ml,u).addScaledVector(Ra,d)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let gl=0;class Ac extends Tu{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:gl++}),this.uuid=Tr(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const r=e[t];if(void 0===r){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const s=this[t];void 0!==s?s&&s.isColor?s.set(r):s&&s.isVector3&&r&&r.isVector3?s.copy(r):this[t]=r:console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const r={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function s(a){const u=[];for(const d in a){const p=a[d];delete p.metadata,u.push(p)}return u}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),void 0!==this.sheen&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearcoat&&(r.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(r.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(r.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(r.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(r.combine=this.combine)),void 0!==this.envMapIntensity&&(r.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(r.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(r.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(r.size=this.size),null!==this.shadowSide&&(r.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(r.blending=this.blending),0!==this.side&&(r.side=this.side),this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,r.colorWrite=this.colorWrite,r.stencilWrite=this.stencilWrite,r.stencilWriteMask=this.stencilWriteMask,r.stencilFunc=this.stencilFunc,r.stencilRef=this.stencilRef,r.stencilFuncMask=this.stencilFuncMask,r.stencilFail=this.stencilFail,r.stencilZFail=this.stencilZFail,r.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(r.rotation=this.rotation),!0===this.polygonOffset&&(r.polygonOffset=!0),0!==this.polygonOffsetFactor&&(r.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(r.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(r.linewidth=this.linewidth),void 0!==this.dashSize&&(r.dashSize=this.dashSize),void 0!==this.gapSize&&(r.gapSize=this.gapSize),void 0!==this.scale&&(r.scale=this.scale),!0===this.dithering&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),!0===this.alphaHash&&(r.alphaHash=this.alphaHash),!0===this.alphaToCoverage&&(r.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=this.premultipliedAlpha),!0===this.forceSinglePass&&(r.forceSinglePass=this.forceSinglePass),!0===this.wireframe&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(r.flatShading=this.flatShading),!1===this.visible&&(r.visible=!1),!1===this.toneMapped&&(r.toneMapped=!1),!1===this.fog&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData),t){const a=s(e.textures),u=s(e.images);a.length>0&&(r.textures=a),u.length>0&&(r.images=u)}return r}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let r=null;if(null!==t){const s=t.length;r=new Array(s);for(let a=0;a!==s;++a)r[a]=t[a].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}const Yf={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},uo={h:0,s:0,l:0},yl={h:0,s:0,l:0};function Zf(l,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?l+6*(e-l)*t:t<.5?e:t<2/3?l+6*(e-l)*(2/3-t):l}class Pt{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,r)}set(e,t,r){if(void 0===t&&void 0===r){const s=e;s&&s.isColor?this.copy(s):"number"==typeof s?this.setHex(s):"string"==typeof s&&this.setStyle(s)}else this.setRGB(e,t,r);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Ln){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,Yr.toWorkingColorSpace(this,t),this}setRGB(e,t,r,s=Yr.workingColorSpace){return this.r=e,this.g=t,this.b=r,Yr.toWorkingColorSpace(this,s),this}setHSL(e,t,r,s=Yr.workingColorSpace){if(e=function Qi(l,e){return(l%e+e)%e}(e,1),t=Ji(t,0,1),r=Ji(r,0,1),0===t)this.r=this.g=this.b=r;else{const a=r<=.5?r*(1+t):r+t-r*t,u=2*r-a;this.r=Zf(u,a,e+1/3),this.g=Zf(u,a,e),this.b=Zf(u,a,e-1/3)}return Yr.toWorkingColorSpace(this,s),this}setStyle(e,t=Ln){function r(a){void 0!==a&&parseFloat(a)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let s;if(s=/^(\w+)\(([^\)]*)\)/.exec(e)){let a;const d=s[2];switch(s[1]){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(d))return r(a[4]),this.setRGB(Math.min(255,parseInt(a[1],10))/255,Math.min(255,parseInt(a[2],10))/255,Math.min(255,parseInt(a[3],10))/255,t);if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(d))return r(a[4]),this.setRGB(Math.min(100,parseInt(a[1],10))/100,Math.min(100,parseInt(a[2],10))/100,Math.min(100,parseInt(a[3],10))/100,t);break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(d))return r(a[4]),this.setHSL(parseFloat(a[1])/360,parseFloat(a[2])/100,parseFloat(a[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(e)){const a=s[1],u=a.length;if(3===u)return this.setRGB(parseInt(a.charAt(0),16)/15,parseInt(a.charAt(1),16)/15,parseInt(a.charAt(2),16)/15,t);if(6===u)return this.setHex(parseInt(a,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Ln){const r=Yf[e.toLowerCase()];return void 0!==r?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Do(e.r),this.g=Do(e.g),this.b=Do(e.b),this}copyLinearToSRGB(e){return this.r=Iu(e.r),this.g=Iu(e.g),this.b=Iu(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Ln){return Yr.fromWorkingColorSpace(Cr.copy(this),e),65536*Math.round(Ji(255*Cr.r,0,255))+256*Math.round(Ji(255*Cr.g,0,255))+Math.round(Ji(255*Cr.b,0,255))}getHexString(e=Ln){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Yr.workingColorSpace){Yr.fromWorkingColorSpace(Cr.copy(this),t);const r=Cr.r,s=Cr.g,a=Cr.b,u=Math.max(r,s,a),d=Math.min(r,s,a);let p,m;const y=(d+u)/2;if(d===u)p=0,m=0;else{const x=u-d;switch(m=y<=.5?x/(u+d):x/(2-u-d),u){case r:p=(s-a)/x+(s<a?6:0);break;case s:p=(a-r)/x+2;break;case a:p=(r-s)/x+4}p/=6}return e.h=p,e.s=m,e.l=y,e}getRGB(e,t=Yr.workingColorSpace){return Yr.fromWorkingColorSpace(Cr.copy(this),t),e.r=Cr.r,e.g=Cr.g,e.b=Cr.b,e}getStyle(e=Ln){Yr.fromWorkingColorSpace(Cr.copy(this),e);const t=Cr.r,r=Cr.g,s=Cr.b;return e!==Ln?`color(${e} ${t.toFixed(3)} ${r.toFixed(3)} ${s.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*r)},${Math.round(255*s)})`}offsetHSL(e,t,r){return this.getHSL(uo),uo.h+=e,uo.s+=t,uo.l+=r,this.setHSL(uo.h,uo.s,uo.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(uo),e.getHSL(yl);const r=Jh(uo.h,yl.h,t),s=Jh(uo.s,yl.s,t),a=Jh(uo.l,yl.l,t);return this.setHSL(r,s,a),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,r=this.g,s=this.b,a=e.elements;return this.r=a[0]*t+a[3]*r+a[6]*s,this.g=a[1]*t+a[4]*r+a[7]*s,this.b=a[2]*t+a[5]*r+a[8]*s,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Cr=new Pt;Pt.NAMES=Yf;class Ia extends Ac{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Pt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Wi=new J,Cc=new je;class cr{constructor(e,t,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=r,this.usage=35044,this.updateRange={offset:0,count:-1},this.gpuType=Dn,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let s=0,a=this.itemSize;s<a;s++)this.array[e+s]=t.array[r+s];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,r=this.count;t<r;t++)Cc.fromBufferAttribute(this,t),Cc.applyMatrix3(e),this.setXY(t,Cc.x,Cc.y);else if(3===this.itemSize)for(let t=0,r=this.count;t<r;t++)Wi.fromBufferAttribute(this,t),Wi.applyMatrix3(e),this.setXYZ(t,Wi.x,Wi.y,Wi.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)Wi.fromBufferAttribute(this,t),Wi.applyMatrix4(e),this.setXYZ(t,Wi.x,Wi.y,Wi.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Wi.fromBufferAttribute(this,t),Wi.applyNormalMatrix(e),this.setXYZ(t,Wi.x,Wi.y,Wi.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Wi.fromBufferAttribute(this,t),Wi.transformDirection(e),this.setXYZ(t,Wi.x,Wi.y,Wi.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let r=this.array[e*this.itemSize+t];return this.normalized&&(r=dr(r,this.array)),r}setComponent(e,t,r){return this.normalized&&(r=Fn(r,this.array)),this.array[e*this.itemSize+t]=r,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=dr(t,this.array)),t}setX(e,t){return this.normalized&&(t=Fn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=dr(t,this.array)),t}setY(e,t){return this.normalized&&(t=Fn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=dr(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Fn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=dr(t,this.array)),t}setW(e,t){return this.normalized&&(t=Fn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=Fn(t,this.array),r=Fn(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,s){return e*=this.itemSize,this.normalized&&(t=Fn(t,this.array),r=Fn(r,this.array),s=Fn(s,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=s,this}setXYZW(e,t,r,s,a){return e*=this.itemSize,this.normalized&&(t=Fn(t,this.array),r=Fn(r,this.array),s=Fn(s,this.array),a=Fn(a,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=s,this.array[e+3]=a,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}}class Zm extends cr{constructor(e,t,r){super(new Uint16Array(e),t,r)}}class dd extends cr{constructor(e,t,r){super(new Uint32Array(e),t,r)}}class Wt extends cr{constructor(e,t,r){super(new Float32Array(e),t,r)}}let q0=0;const zs=new Nn,Km=new Hs,Rc=new J,Br=new ea,vl=new ea,fr=new J;class zn extends Tu{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:q0++}),this.uuid=Tr(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(Gm(e)?dd:Zm)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const r=this.attributes.normal;if(void 0!==r){const a=(new Bn).getNormalMatrix(e);r.applyNormalMatrix(a),r.needsUpdate=!0}const s=this.attributes.tangent;return void 0!==s&&(s.transformDirection(e),s.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return zs.makeRotationFromQuaternion(e),this.applyMatrix4(zs),this}rotateX(e){return zs.makeRotationX(e),this.applyMatrix4(zs),this}rotateY(e){return zs.makeRotationY(e),this.applyMatrix4(zs),this}rotateZ(e){return zs.makeRotationZ(e),this.applyMatrix4(zs),this}translate(e,t,r){return zs.makeTranslation(e,t,r),this.applyMatrix4(zs),this}scale(e,t,r){return zs.makeScale(e,t,r),this.applyMatrix4(zs),this}lookAt(e){return Km.lookAt(e),Km.updateMatrix(),this.applyMatrix4(Km.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Rc).negate(),this.translate(Rc.x,Rc.y,Rc.z),this}setFromPoints(e){const t=[];for(let r=0,s=e.length;r<s;r++){const a=e[r];t.push(a.x,a.y,a.z||0)}return this.setAttribute("position",new Wt(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new ea);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new J(-1/0,-1/0,-1/0),new J(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,s=t.length;r<s;r++)Br.setFromBufferAttribute(t[r]),this.morphTargetsRelative?(fr.addVectors(this.boundingBox.min,Br.min),this.boundingBox.expandByPoint(fr),fr.addVectors(this.boundingBox.max,Br.max),this.boundingBox.expandByPoint(fr)):(this.boundingBox.expandByPoint(Br.min),this.boundingBox.expandByPoint(Br.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new oo);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new J,1/0);if(e){const r=this.boundingSphere.center;if(Br.setFromBufferAttribute(e),t)for(let a=0,u=t.length;a<u;a++)vl.setFromBufferAttribute(t[a]),this.morphTargetsRelative?(fr.addVectors(Br.min,vl.min),Br.expandByPoint(fr),fr.addVectors(Br.max,vl.max),Br.expandByPoint(fr)):(Br.expandByPoint(vl.min),Br.expandByPoint(vl.max));Br.getCenter(r);let s=0;for(let a=0,u=e.count;a<u;a++)fr.fromBufferAttribute(e,a),s=Math.max(s,r.distanceToSquared(fr));if(t)for(let a=0,u=t.length;a<u;a++){const d=t[a],p=this.morphTargetsRelative;for(let m=0,y=d.count;m<y;m++)fr.fromBufferAttribute(d,m),p&&(Rc.fromBufferAttribute(e,m),fr.add(Rc)),s=Math.max(s,r.distanceToSquared(fr))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const r=e.array,s=t.position.array,a=t.normal.array,u=t.uv.array,d=s.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new cr(new Float32Array(4*d),4));const p=this.getAttribute("tangent").array,m=[],y=[];for(let Y=0;Y<d;Y++)m[Y]=new J,y[Y]=new J;const x=new J,M=new J,E=new J,A=new je,L=new je,D=new je,S=new J,U=new J;function N(Y,Ce,qe){x.fromArray(s,3*Y),M.fromArray(s,3*Ce),E.fromArray(s,3*qe),A.fromArray(u,2*Y),L.fromArray(u,2*Ce),D.fromArray(u,2*qe),M.sub(x),E.sub(x),L.sub(A),D.sub(A);const ye=1/(L.x*D.y-D.x*L.y);!isFinite(ye)||(S.copy(M).multiplyScalar(D.y).addScaledVector(E,-L.y).multiplyScalar(ye),U.copy(E).multiplyScalar(L.x).addScaledVector(M,-D.x).multiplyScalar(ye),m[Y].add(S),m[Ce].add(S),m[qe].add(S),y[Y].add(U),y[Ce].add(U),y[qe].add(U))}let V=this.groups;0===V.length&&(V=[{start:0,count:r.length}]);for(let Y=0,Ce=V.length;Y<Ce;++Y){const qe=V[Y],ye=qe.start;for(let Se=ye,Xe=ye+qe.count;Se<Xe;Se+=3)N(r[Se+0],r[Se+1],r[Se+2])}const j=new J,q=new J,Q=new J,ae=new J;function W(Y){Q.fromArray(a,3*Y),ae.copy(Q);const Ce=m[Y];j.copy(Ce),j.sub(Q.multiplyScalar(Q.dot(Ce))).normalize(),q.crossVectors(ae,Ce);const ye=q.dot(y[Y])<0?-1:1;p[4*Y]=j.x,p[4*Y+1]=j.y,p[4*Y+2]=j.z,p[4*Y+3]=ye}for(let Y=0,Ce=V.length;Y<Ce;++Y){const qe=V[Y],ye=qe.start;for(let Se=ye,Xe=ye+qe.count;Se<Xe;Se+=3)W(r[Se+0]),W(r[Se+1]),W(r[Se+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let r=this.getAttribute("normal");if(void 0===r)r=new cr(new Float32Array(3*t.count),3),this.setAttribute("normal",r);else for(let M=0,E=r.count;M<E;M++)r.setXYZ(M,0,0,0);const s=new J,a=new J,u=new J,d=new J,p=new J,m=new J,y=new J,x=new J;if(e)for(let M=0,E=e.count;M<E;M+=3){const A=e.getX(M+0),L=e.getX(M+1),D=e.getX(M+2);s.fromBufferAttribute(t,A),a.fromBufferAttribute(t,L),u.fromBufferAttribute(t,D),y.subVectors(u,a),x.subVectors(s,a),y.cross(x),d.fromBufferAttribute(r,A),p.fromBufferAttribute(r,L),m.fromBufferAttribute(r,D),d.add(y),p.add(y),m.add(y),r.setXYZ(A,d.x,d.y,d.z),r.setXYZ(L,p.x,p.y,p.z),r.setXYZ(D,m.x,m.y,m.z)}else for(let M=0,E=t.count;M<E;M+=3)s.fromBufferAttribute(t,M+0),a.fromBufferAttribute(t,M+1),u.fromBufferAttribute(t,M+2),y.subVectors(u,a),x.subVectors(s,a),y.cross(x),r.setXYZ(M+0,y.x,y.y,y.z),r.setXYZ(M+1,y.x,y.y,y.z),r.setXYZ(M+2,y.x,y.y,y.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)fr.fromBufferAttribute(e,t),fr.normalize(),e.setXYZ(t,fr.x,fr.y,fr.z)}toNonIndexed(){function e(d,p){const m=d.array,y=d.itemSize,x=d.normalized,M=new m.constructor(p.length*y);let E=0,A=0;for(let L=0,D=p.length;L<D;L++){E=d.isInterleavedBufferAttribute?p[L]*d.data.stride+d.offset:p[L]*y;for(let S=0;S<y;S++)M[A++]=m[E++]}return new cr(M,y,x)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new zn,r=this.index.array,s=this.attributes;for(const d in s){const m=e(s[d],r);t.setAttribute(d,m)}const a=this.morphAttributes;for(const d in a){const p=[],m=a[d];for(let y=0,x=m.length;y<x;y++){const E=e(m[y],r);p.push(E)}t.morphAttributes[d]=p}t.morphTargetsRelative=this.morphTargetsRelative;const u=this.groups;for(let d=0,p=u.length;d<p;d++){const m=u[d];t.addGroup(m.start,m.count,m.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const p=this.parameters;for(const m in p)void 0!==p[m]&&(e[m]=p[m]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const r=this.attributes;for(const p in r)e.data.attributes[p]=r[p].toJSON(e.data);const s={};let a=!1;for(const p in this.morphAttributes){const m=this.morphAttributes[p],y=[];for(let x=0,M=m.length;x<M;x++)y.push(m[x].toJSON(e.data));y.length>0&&(s[p]=y,a=!0)}a&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);const u=this.groups;u.length>0&&(e.data.groups=JSON.parse(JSON.stringify(u)));const d=this.boundingSphere;return null!==d&&(e.data.boundingSphere={center:d.center.toArray(),radius:d.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const r=e.index;null!==r&&this.setIndex(r.clone(t));const s=e.attributes;for(const m in s)this.setAttribute(m,s[m].clone(t));const a=e.morphAttributes;for(const m in a){const y=[],x=a[m];for(let M=0,E=x.length;M<E;M++)y.push(x[M].clone(t));this.morphAttributes[m]=y}this.morphTargetsRelative=e.morphTargetsRelative;const u=e.groups;for(let m=0,y=u.length;m<y;m++){const x=u[m];this.addGroup(x.start,x.count,x.materialIndex)}const d=e.boundingBox;null!==d&&(this.boundingBox=d.clone());const p=e.boundingSphere;return null!==p&&(this.boundingSphere=p.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const Jf=new Nn,Ts=new ku,fd=new oo,Jm=new J,Ic=new J,Pc=new J,Lc=new J,fo=new J,oa=new J,Vu=new je,pd=new je,md=new je,Qm=new J,eg=new J,tg=new J,Gu=new J,gd=new J;class hs extends Hs{constructor(e=new zn,t=new Ia){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const s=t[r[0]];if(void 0!==s){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,u=s.length;a<u;a++){const d=s[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[d]=a}}}}getVertexPosition(e,t){const r=this.geometry,a=r.morphAttributes.position,u=r.morphTargetsRelative;t.fromBufferAttribute(r.attributes.position,e);const d=this.morphTargetInfluences;if(a&&d){oa.set(0,0,0);for(let p=0,m=a.length;p<m;p++){const y=d[p],x=a[p];0!==y&&(fo.fromBufferAttribute(x,e),oa.addScaledVector(u?fo:fo.sub(t),y))}t.add(oa)}return t}raycast(e,t){const r=this.geometry,a=this.matrixWorld;void 0!==this.material&&(null===r.boundingSphere&&r.computeBoundingSphere(),fd.copy(r.boundingSphere),fd.applyMatrix4(a),Ts.copy(e.ray).recast(e.near),(!1!==fd.containsPoint(Ts.origin)||!(null===Ts.intersectSphere(fd,Jm)||Ts.origin.distanceToSquared(Jm)>(e.far-e.near)**2))&&(Jf.copy(a).invert(),Ts.copy(e.ray).applyMatrix4(Jf),(null===r.boundingBox||!1!==Ts.intersectsBox(r.boundingBox))&&this._computeIntersections(e,t,Ts)))}_computeIntersections(e,t,r){let s;const a=this.geometry,u=this.material,d=a.index,p=a.attributes.position,m=a.attributes.uv,y=a.attributes.uv1,x=a.attributes.normal,M=a.groups,E=a.drawRange;if(null!==d)if(Array.isArray(u))for(let A=0,L=M.length;A<L;A++){const D=M[A],S=u[D.materialIndex];for(let V=Math.max(D.start,E.start),j=Math.min(d.count,Math.min(D.start+D.count,E.start+E.count));V<j;V+=3)s=yd(this,S,e,r,m,y,x,d.getX(V),d.getX(V+1),d.getX(V+2)),s&&(s.faceIndex=Math.floor(V/3),s.face.materialIndex=D.materialIndex,t.push(s))}else for(let D=Math.max(0,E.start),S=Math.min(d.count,E.start+E.count);D<S;D+=3)s=yd(this,u,e,r,m,y,x,d.getX(D),d.getX(D+1),d.getX(D+2)),s&&(s.faceIndex=Math.floor(D/3),t.push(s));else if(void 0!==p)if(Array.isArray(u))for(let A=0,L=M.length;A<L;A++){const D=M[A],S=u[D.materialIndex];for(let V=Math.max(D.start,E.start),j=Math.min(p.count,Math.min(D.start+D.count,E.start+E.count));V<j;V+=3)s=yd(this,S,e,r,m,y,x,V,V+1,V+2),s&&(s.faceIndex=Math.floor(V/3),s.face.materialIndex=D.materialIndex,t.push(s))}else for(let D=Math.max(0,E.start),S=Math.min(p.count,E.start+E.count);D<S;D+=3)s=yd(this,u,e,r,m,y,x,D,D+1,D+2),s&&(s.faceIndex=Math.floor(D/3),t.push(s))}}function yd(l,e,t,r,s,a,u,d,p,m){l.getVertexPosition(d,Ic),l.getVertexPosition(p,Pc),l.getVertexPosition(m,Lc);const y=function Y0(l,e,t,r,s,a,u,d){let p;if(p=1===e.side?r.intersectTriangle(u,a,s,!0,d):r.intersectTriangle(s,a,u,0===e.side,d),null===p)return null;gd.copy(d),gd.applyMatrix4(l.matrixWorld);const m=t.ray.origin.distanceTo(gd);return m<t.near||m>t.far?null:{distance:m,point:gd.clone(),object:l}}(l,e,t,r,Ic,Pc,Lc,Gu);if(y){s&&(Vu.fromBufferAttribute(s,d),pd.fromBufferAttribute(s,p),md.fromBufferAttribute(s,m),y.uv=us.getInterpolation(Gu,Ic,Pc,Lc,Vu,pd,md,new je)),a&&(Vu.fromBufferAttribute(a,d),pd.fromBufferAttribute(a,p),md.fromBufferAttribute(a,m),y.uv1=us.getInterpolation(Gu,Ic,Pc,Lc,Vu,pd,md,new je),y.uv2=y.uv1),u&&(Qm.fromBufferAttribute(u,d),eg.fromBufferAttribute(u,p),tg.fromBufferAttribute(u,m),y.normal=us.getInterpolation(Gu,Ic,Pc,Lc,Qm,eg,tg,new J),y.normal.dot(r.direction)>0&&y.normal.multiplyScalar(-1));const x={a:d,b:p,c:m,normal:new J,materialIndex:0};us.getNormal(Ic,Pc,Lc,x.normal),y.face=x}return y}class Wu extends zn{constructor(e=1,t=1,r=1,s=1,a=1,u=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:s,heightSegments:a,depthSegments:u};const d=this;s=Math.floor(s),a=Math.floor(a),u=Math.floor(u);const p=[],m=[],y=[],x=[];let M=0,E=0;function A(L,D,S,U,N,V,j,q,Q,ae,W){const Y=V/Q,Ce=j/ae,qe=V/2,ye=j/2,xe=q/2,Se=Q+1,Xe=ae+1;let Oe=0,ze=0;const Je=new J;for(let Qe=0;Qe<Xe;Qe++){const me=Qe*Ce-ye;for(let Be=0;Be<Se;Be++)Je[L]=(Be*Y-qe)*U,Je[D]=me*N,Je[S]=xe,m.push(Je.x,Je.y,Je.z),Je[L]=0,Je[D]=0,Je[S]=q>0?1:-1,y.push(Je.x,Je.y,Je.z),x.push(Be/Q),x.push(1-Qe/ae),Oe+=1}for(let Qe=0;Qe<ae;Qe++)for(let me=0;me<Q;me++){const Tt=M+me+Se*(Qe+1),Ct=M+(me+1)+Se*(Qe+1),Rt=M+(me+1)+Se*Qe;p.push(M+me+Se*Qe,Tt,Rt),p.push(Tt,Ct,Rt),ze+=6}d.addGroup(E,ze,W),E+=ze,M+=Oe}A("z","y","x",-1,-1,r,t,e,u,a,0),A("z","y","x",1,-1,r,t,-e,u,a,1),A("x","z","y",1,1,e,r,t,s,u,2),A("x","z","y",1,-1,e,r,-t,s,u,3),A("x","y","z",1,-1,e,t,r,s,a,4),A("x","y","z",-1,-1,e,t,-r,s,a,5),this.setIndex(p),this.setAttribute("position",new Wt(m,3)),this.setAttribute("normal",new Wt(y,3)),this.setAttribute("uv",new Wt(x,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Wu(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Nc(l){const e={};for(const t in l){e[t]={};for(const r in l[t]){const s=l[t][r];s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?s.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][r]=null):e[t][r]=s.clone():e[t][r]=Array.isArray(s)?s.slice():s}}return e}function pr(l){const e={};for(let t=0;t<l.length;t++){const r=Nc(l[t]);for(const s in r)e[s]=r[s]}return e}function po(l){return null===l.getRenderTarget()?l.outputColorSpace:Sr}const $u={clone:Nc,merge:pr};class Io extends Ac{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Nc(e.uniforms),this.uniformsGroups=function ng(l){const e=[];for(let t=0;t<l.length;t++)e.push(l[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const s in this.uniforms){const u=this.uniforms[s].value;t.uniforms[s]=u&&u.isTexture?{type:"t",value:u.toJSON(e).uuid}:u&&u.isColor?{type:"c",value:u.getHex()}:u&&u.isVector2?{type:"v2",value:u.toArray()}:u&&u.isVector3?{type:"v3",value:u.toArray()}:u&&u.isVector4?{type:"v4",value:u.toArray()}:u&&u.isMatrix3?{type:"m3",value:u.toArray()}:u&&u.isMatrix4?{type:"m4",value:u.toArray()}:{value:u}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const r={};for(const s in this.extensions)!0===this.extensions[s]&&(r[s]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}}class sg extends Hs{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Nn,this.projectionMatrix=new Nn,this.projectionMatrixInverse=new Nn,this.coordinateSystem=Qo}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class Hr extends sg{constructor(e=50,t=1,r=.1,s=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=s,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*Au*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*_c*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Au*Math.atan(Math.tan(.5*_c*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,r,s,a,u){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=s,this.view.width=a,this.view.height=u,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*_c*this.fov)/this.zoom,r=2*t,s=this.aspect*r,a=-.5*s;const u=this.view;if(null!==this.view&&this.view.enabled){const p=u.fullWidth,m=u.fullHeight;a+=u.offsetX*s/p,t-=u.offsetY*r/m,s*=u.width/p,r*=u.height/m}const d=this.filmOffset;0!==d&&(a+=e*d/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+s,t,t-r,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class Qf extends Hs{constructor(e,t,r){super(),this.type="CubeCamera",this.renderTarget=r,this.coordinateSystem=null;const s=new Hr(-90,1,e,t);s.layers=this.layers,this.add(s);const a=new Hr(-90,1,e,t);a.layers=this.layers,this.add(a);const u=new Hr(-90,1,e,t);u.layers=this.layers,this.add(u);const d=new Hr(-90,1,e,t);d.layers=this.layers,this.add(d);const p=new Hr(-90,1,e,t);p.layers=this.layers,this.add(p);const m=new Hr(-90,1,e,t);m.layers=this.layers,this.add(m)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[r,s,a,u,d,p]=t;for(const m of t)this.remove(m);if(e===Qo)r.up.set(0,1,0),r.lookAt(1,0,0),s.up.set(0,1,0),s.lookAt(-1,0,0),a.up.set(0,0,-1),a.lookAt(0,1,0),u.up.set(0,0,1),u.lookAt(0,-1,0),d.up.set(0,1,0),d.lookAt(0,0,1),p.up.set(0,1,0),p.lookAt(0,0,-1);else{if(2001!==e)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);r.up.set(0,-1,0),r.lookAt(-1,0,0),s.up.set(0,-1,0),s.lookAt(1,0,0),a.up.set(0,0,1),a.lookAt(0,1,0),u.up.set(0,0,-1),u.lookAt(0,-1,0),d.up.set(0,-1,0),d.lookAt(0,0,1),p.up.set(0,-1,0),p.lookAt(0,0,-1)}for(const m of t)this.add(m),m.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const r=this.renderTarget;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,a,u,d,p,m]=this.children,y=e.getRenderTarget(),x=e.xr.enabled;e.xr.enabled=!1;const M=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0),e.render(t,s),e.setRenderTarget(r,1),e.render(t,a),e.setRenderTarget(r,2),e.render(t,u),e.setRenderTarget(r,3),e.render(t,d),e.setRenderTarget(r,4),e.render(t,p),r.texture.generateMipmaps=M,e.setRenderTarget(r,5),e.render(t,m),e.setRenderTarget(y),e.xr.enabled=x,r.texture.needsPMREMUpdate=!0}}class Oc extends ks{constructor(e,t,r,s,a,u,d,p,m,y){super(e=void 0!==e?e:[],t=void 0!==t?t:301,r,s,a,u,d,p,m,y),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class vM extends cl{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const r={width:e,height:e,depth:1},s=[r,r,r,r,r,r];void 0!==t.encoding&&(ed("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===Jo?Ln:""),this.texture=new Oc(s,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:yi}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const r_uniforms={tEquirect:{value:null}},r_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",r_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",s=new Wu(5,5,5),a=new Io({name:"CubemapFromEquirect",uniforms:Nc(r_uniforms),vertexShader:r_vertexShader,fragmentShader:r_fragmentShader,side:1,blending:0});a.uniforms.tEquirect.value=t;const u=new hs(s,a),d=t.minFilter;return t.minFilter===wa&&(t.minFilter=yi),new Qf(1,10,this).update(e,u),t.minFilter=d,u.geometry.dispose(),u.material.dispose(),this}clear(e,t,r,s){const a=e.getRenderTarget();for(let u=0;u<6;u++)e.setRenderTarget(this,u),e.clear(t,r,s);e.setRenderTarget(a)}}const og=new J,ag=new J,Z0=new Bn;class _l{constructor(e=new J(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,s){return this.normal.set(e,t,r),this.constant=s,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){const s=og.subVectors(r,t).cross(ag.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(s,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const r=e.delta(og),s=this.normal.dot(r);if(0===s)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const a=-(e.start.dot(this.normal)+this.constant)/s;return a<0||a>1?null:t.copy(e.start).addScaledVector(r,a)}intersectsLine(e){const t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const r=t||Z0.getNormalMatrix(e),s=this.coplanarPoint(og).applyMatrix4(e),a=this.normal.applyMatrix3(r).normalize();return this.constant=-s.dot(a),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const xl=new oo,vd=new J;class _d{constructor(e=new _l,t=new _l,r=new _l,s=new _l,a=new _l,u=new _l){this.planes=[e,t,r,s,a,u]}set(e,t,r,s,a,u){const d=this.planes;return d[0].copy(e),d[1].copy(t),d[2].copy(r),d[3].copy(s),d[4].copy(a),d[5].copy(u),this}copy(e){const t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e,t=Qo){const r=this.planes,s=e.elements,a=s[0],u=s[1],d=s[2],p=s[3],m=s[4],y=s[5],x=s[6],M=s[7],E=s[8],A=s[9],L=s[10],D=s[11],S=s[12],U=s[13],N=s[14],V=s[15];if(r[0].setComponents(p-a,M-m,D-E,V-S).normalize(),r[1].setComponents(p+a,M+m,D+E,V+S).normalize(),r[2].setComponents(p+u,M+y,D+A,V+U).normalize(),r[3].setComponents(p-u,M-y,D-A,V-U).normalize(),r[4].setComponents(p-d,M-x,D-L,V-N).normalize(),t===Qo)r[5].setComponents(p+d,M+x,D+L,V+N).normalize();else{if(2001!==t)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);r[5].setComponents(d,x,L,N).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),xl.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),xl.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(xl)}intersectsSprite(e){return xl.center.set(0,0,0),xl.radius=.7071067811865476,xl.applyMatrix4(e.matrixWorld),this.intersectsSphere(xl)}intersectsSphere(e){const t=this.planes,r=e.center,s=-e.radius;for(let a=0;a<6;a++)if(t[a].distanceToPoint(r)<s)return!1;return!0}intersectsBox(e){const t=this.planes;for(let r=0;r<6;r++){const s=t[r];if(vd.x=s.normal.x>0?e.max.x:e.min.x,vd.y=s.normal.y>0?e.max.y:e.min.y,vd.z=s.normal.z>0?e.max.z:e.min.z,s.distanceToPoint(vd)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function Xu(){let l=null,e=!1,t=null,r=null;function s(a,u){t(a,u),r=l.requestAnimationFrame(s)}return{start:function(){!0!==e&&null!==t&&(r=l.requestAnimationFrame(s),e=!0)},stop:function(){l.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(a){t=a},setContext:function(a){l=a}}}function lg(l,e){const t=e.isWebGL2,r=new WeakMap;return{get:function u(m){return m.isInterleavedBufferAttribute&&(m=m.data),r.get(m)},remove:function d(m){m.isInterleavedBufferAttribute&&(m=m.data);const y=r.get(m);y&&(l.deleteBuffer(y.buffer),r.delete(m))},update:function p(m,y){if(m.isGLBufferAttribute){const M=r.get(m);return void((!M||M.version<m.version)&&r.set(m,{buffer:m.buffer,type:m.type,bytesPerElement:m.elementSize,version:m.version}))}m.isInterleavedBufferAttribute&&(m=m.data);const x=r.get(m);void 0===x?r.set(m,function s(m,y){const x=m.array,M=m.usage,E=l.createBuffer();let A;if(l.bindBuffer(y,E),l.bufferData(y,x,M),m.onUploadCallback(),x instanceof Float32Array)A=l.FLOAT;else if(x instanceof Uint16Array)if(m.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");A=l.HALF_FLOAT}else A=l.UNSIGNED_SHORT;else if(x instanceof Int16Array)A=l.SHORT;else if(x instanceof Uint32Array)A=l.UNSIGNED_INT;else if(x instanceof Int32Array)A=l.INT;else if(x instanceof Int8Array)A=l.BYTE;else if(x instanceof Uint8Array)A=l.UNSIGNED_BYTE;else{if(!(x instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+x);A=l.UNSIGNED_BYTE}return{buffer:E,type:A,bytesPerElement:x.BYTES_PER_ELEMENT,version:m.version}}(m,y)):x.version<m.version&&(function a(m,y,x){const M=y.array,E=y.updateRange;l.bindBuffer(x,m),-1===E.count?l.bufferSubData(x,0,M):(t?l.bufferSubData(x,E.offset*M.BYTES_PER_ELEMENT,M,E.offset,E.count):l.bufferSubData(x,E.offset*M.BYTES_PER_ELEMENT,M.subarray(E.offset,E.offset+E.count)),E.count=-1),y.onUploadCallback()}(x.buffer,m,y),x.version=m.version)}}}class Ml extends zn{constructor(e=1,t=1,r=1,s=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:s};const a=e/2,u=t/2,d=Math.floor(r),p=Math.floor(s),m=d+1,y=p+1,x=e/d,M=t/p,E=[],A=[],L=[],D=[];for(let S=0;S<y;S++){const U=S*M-u;for(let N=0;N<m;N++)A.push(N*x-a,-U,0),L.push(0,0,1),D.push(N/d),D.push(1-S/p)}for(let S=0;S<p;S++)for(let U=0;U<d;U++){const V=U+m*(S+1),j=U+1+m*(S+1),q=U+1+m*S;E.push(U+m*S,V,q),E.push(V,j,q)}this.setIndex(E),this.setAttribute("position",new Wt(A,3)),this.setAttribute("normal",new Wt(L,3)),this.setAttribute("uv",new Wt(D,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ml(e.width,e.height,e.widthSegments,e.heightSegments)}}const Un={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tanisotropyV /= material.anisotropy;\n\tmaterial.anisotropy = saturate( material.anisotropy );\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometry.viewDir, geometry.normal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, vMapUv );\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},St={common:{diffuse:{value:new Pt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Bn},alphaMap:{value:null},alphaMapTransform:{value:new Bn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Bn}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Bn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Bn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Bn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Bn},normalScale:{value:new je(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Bn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Bn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Bn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Bn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Pt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Pt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Bn},alphaTest:{value:0},uvTransform:{value:new Bn}},sprite:{diffuse:{value:new Pt(16777215)},opacity:{value:1},center:{value:new je(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Bn},alphaMap:{value:null},alphaMapTransform:{value:new Bn},alphaTest:{value:0}}},la={basic:{uniforms:pr([St.common,St.specularmap,St.envmap,St.aomap,St.lightmap,St.fog]),vertexShader:Un.meshbasic_vert,fragmentShader:Un.meshbasic_frag},lambert:{uniforms:pr([St.common,St.specularmap,St.envmap,St.aomap,St.lightmap,St.emissivemap,St.bumpmap,St.normalmap,St.displacementmap,St.fog,St.lights,{emissive:{value:new Pt(0)}}]),vertexShader:Un.meshlambert_vert,fragmentShader:Un.meshlambert_frag},phong:{uniforms:pr([St.common,St.specularmap,St.envmap,St.aomap,St.lightmap,St.emissivemap,St.bumpmap,St.normalmap,St.displacementmap,St.fog,St.lights,{emissive:{value:new Pt(0)},specular:{value:new Pt(1118481)},shininess:{value:30}}]),vertexShader:Un.meshphong_vert,fragmentShader:Un.meshphong_frag},standard:{uniforms:pr([St.common,St.envmap,St.aomap,St.lightmap,St.emissivemap,St.bumpmap,St.normalmap,St.displacementmap,St.roughnessmap,St.metalnessmap,St.fog,St.lights,{emissive:{value:new Pt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Un.meshphysical_vert,fragmentShader:Un.meshphysical_frag},toon:{uniforms:pr([St.common,St.aomap,St.lightmap,St.emissivemap,St.bumpmap,St.normalmap,St.displacementmap,St.gradientmap,St.fog,St.lights,{emissive:{value:new Pt(0)}}]),vertexShader:Un.meshtoon_vert,fragmentShader:Un.meshtoon_frag},matcap:{uniforms:pr([St.common,St.bumpmap,St.normalmap,St.displacementmap,St.fog,{matcap:{value:null}}]),vertexShader:Un.meshmatcap_vert,fragmentShader:Un.meshmatcap_frag},points:{uniforms:pr([St.points,St.fog]),vertexShader:Un.points_vert,fragmentShader:Un.points_frag},dashed:{uniforms:pr([St.common,St.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Un.linedashed_vert,fragmentShader:Un.linedashed_frag},depth:{uniforms:pr([St.common,St.displacementmap]),vertexShader:Un.depth_vert,fragmentShader:Un.depth_frag},normal:{uniforms:pr([St.common,St.bumpmap,St.normalmap,St.displacementmap,{opacity:{value:1}}]),vertexShader:Un.meshnormal_vert,fragmentShader:Un.meshnormal_frag},sprite:{uniforms:pr([St.sprite,St.fog]),vertexShader:Un.sprite_vert,fragmentShader:Un.sprite_frag},background:{uniforms:{uvTransform:{value:new Bn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Un.background_vert,fragmentShader:Un.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Un.backgroundCube_vert,fragmentShader:Un.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Un.cube_vert,fragmentShader:Un.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Un.equirect_vert,fragmentShader:Un.equirect_frag},distanceRGBA:{uniforms:pr([St.common,St.displacementmap,{referencePosition:{value:new J},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Un.distanceRGBA_vert,fragmentShader:Un.distanceRGBA_frag},shadow:{uniforms:pr([St.lights,St.fog,{color:{value:new Pt(0)},opacity:{value:1}}]),vertexShader:Un.shadow_vert,fragmentShader:Un.shadow_frag}};la.physical={uniforms:pr([la.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Bn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Bn},clearcoatNormalScale:{value:new je(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Bn},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Bn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Bn},sheen:{value:0},sheenColor:{value:new Pt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Bn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Bn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Bn},transmissionSamplerSize:{value:new je},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Bn},attenuationDistance:{value:0},attenuationColor:{value:new Pt(0)},specularColor:{value:new Pt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Bn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Bn},anisotropyVector:{value:new je},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Bn}}]),vertexShader:Un.meshphysical_vert,fragmentShader:Un.meshphysical_frag};const Ju={r:0,b:0,g:0};function KM(l,e,t,r,s,a,u){const d=new Pt(0);let m,y,p=!0===a?0:1,x=null,M=0,E=null;function L(D,S){D.getRGB(Ju,po(l)),r.buffers.color.setClear(Ju.r,Ju.g,Ju.b,S,u)}return{getClearColor:function(){return d},setClearColor:function(D,S=1){d.set(D),p=S,L(d,p)},getClearAlpha:function(){return p},setClearAlpha:function(D){p=D,L(d,p)},render:function A(D,S){let U=!1,N=!0===S.isScene?S.background:null;switch(N&&N.isTexture&&(N=(S.backgroundBlurriness>0?t:e).get(N)),null===N?L(d,p):N&&N.isColor&&(L(N,1),U=!0),l.xr.getEnvironmentBlendMode()){case"opaque":U=!0;break;case"additive":r.buffers.color.setClear(0,0,0,1,u),U=!0;break;case"alpha-blend":r.buffers.color.setClear(0,0,0,0,u),U=!0}(l.autoClear||U)&&l.clear(l.autoClearColor,l.autoClearDepth,l.autoClearStencil),N&&(N.isCubeTexture||306===N.mapping)?(void 0===y&&(y=new hs(new Wu(1,1,1),new Io({name:"BackgroundCubeMaterial",uniforms:Nc(la.backgroundCube.uniforms),vertexShader:la.backgroundCube.vertexShader,fragmentShader:la.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),y.geometry.deleteAttribute("normal"),y.geometry.deleteAttribute("uv"),y.onBeforeRender=function(q,Q,ae){this.matrixWorld.copyPosition(ae.matrixWorld)},Object.defineProperty(y.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),s.update(y)),y.material.uniforms.envMap.value=N,y.material.uniforms.flipEnvMap.value=N.isCubeTexture&&!1===N.isRenderTargetTexture?-1:1,y.material.uniforms.backgroundBlurriness.value=S.backgroundBlurriness,y.material.uniforms.backgroundIntensity.value=S.backgroundIntensity,y.material.toneMapped=N.colorSpace!==Ln,(x!==N||M!==N.version||E!==l.toneMapping)&&(y.material.needsUpdate=!0,x=N,M=N.version,E=l.toneMapping),y.layers.enableAll(),D.unshift(y,y.geometry,y.material,0,0,null)):N&&N.isTexture&&(void 0===m&&(m=new hs(new Ml(2,2),new Io({name:"BackgroundMaterial",uniforms:Nc(la.background.uniforms),vertexShader:la.background.vertexShader,fragmentShader:la.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),m.geometry.deleteAttribute("normal"),Object.defineProperty(m.material,"map",{get:function(){return this.uniforms.t2D.value}}),s.update(m)),m.material.uniforms.t2D.value=N,m.material.uniforms.backgroundIntensity.value=S.backgroundIntensity,m.material.toneMapped=N.colorSpace!==Ln,!0===N.matrixAutoUpdate&&N.updateMatrix(),m.material.uniforms.uvTransform.value.copy(N.matrix),(x!==N||M!==N.version||E!==l.toneMapping)&&(m.material.needsUpdate=!0,x=N,M=N.version,E=l.toneMapping),m.layers.enableAll(),D.unshift(m,m.geometry,m.material,0,0,null))}}}function Xv(l,e,t,r){const s=l.getParameter(l.MAX_VERTEX_ATTRIBS),a=r.isWebGL2?null:e.get("OES_vertex_array_object"),u=r.isWebGL2||null!==a,d={},p=D(null);let m=p,y=!1;function E(xe){return r.isWebGL2?l.bindVertexArray(xe):a.bindVertexArrayOES(xe)}function A(xe){return r.isWebGL2?l.deleteVertexArray(xe):a.deleteVertexArrayOES(xe)}function D(xe){const Se=[],Xe=[],Oe=[];for(let ze=0;ze<s;ze++)Se[ze]=0,Xe[ze]=0,Oe[ze]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Se,enabledAttributes:Xe,attributeDivisors:Oe,object:xe,attributes:{},index:null}}function N(){const xe=m.newAttributes;for(let Se=0,Xe=xe.length;Se<Xe;Se++)xe[Se]=0}function V(xe){j(xe,0)}function j(xe,Se){const Oe=m.enabledAttributes,ze=m.attributeDivisors;m.newAttributes[xe]=1,0===Oe[xe]&&(l.enableVertexAttribArray(xe),Oe[xe]=1),ze[xe]!==Se&&((r.isWebGL2?l:e.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](xe,Se),ze[xe]=Se)}function q(){const xe=m.newAttributes,Se=m.enabledAttributes;for(let Xe=0,Oe=Se.length;Xe<Oe;Xe++)Se[Xe]!==xe[Xe]&&(l.disableVertexAttribArray(Xe),Se[Xe]=0)}function Q(xe,Se,Xe,Oe,ze,Je,Qe){!0===Qe?l.vertexAttribIPointer(xe,Se,Xe,ze,Je):l.vertexAttribPointer(xe,Se,Xe,Oe,ze,Je)}function qe(){ye(),y=!0,m!==p&&(m=p,E(m.object))}function ye(){p.geometry=null,p.program=null,p.wireframe=!1}return{setup:function x(xe,Se,Xe,Oe,ze){let Je=!1;if(u){const Qe=function L(xe,Se,Xe){const Oe=!0===Xe.wireframe;let ze=d[xe.id];void 0===ze&&(ze={},d[xe.id]=ze);let Je=ze[Se.id];void 0===Je&&(Je={},ze[Se.id]=Je);let Qe=Je[Oe];return void 0===Qe&&(Qe=D(function M(){return r.isWebGL2?l.createVertexArray():a.createVertexArrayOES()}()),Je[Oe]=Qe),Qe}(Oe,Xe,Se);m!==Qe&&(m=Qe,E(m.object)),Je=function S(xe,Se,Xe,Oe){const ze=m.attributes,Je=Se.attributes;let Qe=0;const me=Xe.getAttributes();for(const Be in me)if(me[Be].location>=0){const Ct=ze[Be];let Rt=Je[Be];if(void 0===Rt&&("instanceMatrix"===Be&&xe.instanceMatrix&&(Rt=xe.instanceMatrix),"instanceColor"===Be&&xe.instanceColor&&(Rt=xe.instanceColor)),void 0===Ct||Ct.attribute!==Rt||Rt&&Ct.data!==Rt.data)return!0;Qe++}return m.attributesNum!==Qe||m.index!==Oe}(xe,Oe,Xe,ze),Je&&function U(xe,Se,Xe,Oe){const ze={},Je=Se.attributes;let Qe=0;const me=Xe.getAttributes();for(const Be in me)if(me[Be].location>=0){let Ct=Je[Be];void 0===Ct&&("instanceMatrix"===Be&&xe.instanceMatrix&&(Ct=xe.instanceMatrix),"instanceColor"===Be&&xe.instanceColor&&(Ct=xe.instanceColor));const Rt={};Rt.attribute=Ct,Ct&&Ct.data&&(Rt.data=Ct.data),ze[Be]=Rt,Qe++}m.attributes=ze,m.attributesNum=Qe,m.index=Oe}(xe,Oe,Xe,ze)}else{const Qe=!0===Se.wireframe;(m.geometry!==Oe.id||m.program!==Xe.id||m.wireframe!==Qe)&&(m.geometry=Oe.id,m.program=Xe.id,m.wireframe=Qe,Je=!0)}null!==ze&&t.update(ze,l.ELEMENT_ARRAY_BUFFER),(Je||y)&&(y=!1,function ae(xe,Se,Xe,Oe){if(!1===r.isWebGL2&&(xe.isInstancedMesh||Oe.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;N();const ze=Oe.attributes,Je=Xe.getAttributes(),Qe=Se.defaultAttributeValues;for(const me in Je){const Be=Je[me];if(Be.location>=0){let Tt=ze[me];if(void 0===Tt&&("instanceMatrix"===me&&xe.instanceMatrix&&(Tt=xe.instanceMatrix),"instanceColor"===me&&xe.instanceColor&&(Tt=xe.instanceColor)),void 0!==Tt){const Ct=Tt.normalized,Rt=Tt.itemSize,un=t.get(Tt);if(void 0===un)continue;const Nt=un.buffer,Jt=un.type,ui=un.bytesPerElement,Fi=!0===r.isWebGL2&&(Jt===l.INT||Jt===l.UNSIGNED_INT||1013===Tt.gpuType);if(Tt.isInterleavedBufferAttribute){const Mn=Tt.data,oe=Mn.stride,yt=Tt.offset;if(Mn.isInstancedInterleavedBuffer){for(let He=0;He<Be.locationSize;He++)j(Be.location+He,Mn.meshPerAttribute);!0!==xe.isInstancedMesh&&void 0===Oe._maxInstanceCount&&(Oe._maxInstanceCount=Mn.meshPerAttribute*Mn.count)}else for(let He=0;He<Be.locationSize;He++)V(Be.location+He);l.bindBuffer(l.ARRAY_BUFFER,Nt);for(let He=0;He<Be.locationSize;He++)Q(Be.location+He,Rt/Be.locationSize,Jt,Ct,oe*ui,(yt+Rt/Be.locationSize*He)*ui,Fi)}else{if(Tt.isInstancedBufferAttribute){for(let Mn=0;Mn<Be.locationSize;Mn++)j(Be.location+Mn,Tt.meshPerAttribute);!0!==xe.isInstancedMesh&&void 0===Oe._maxInstanceCount&&(Oe._maxInstanceCount=Tt.meshPerAttribute*Tt.count)}else for(let Mn=0;Mn<Be.locationSize;Mn++)V(Be.location+Mn);l.bindBuffer(l.ARRAY_BUFFER,Nt);for(let Mn=0;Mn<Be.locationSize;Mn++)Q(Be.location+Mn,Rt/Be.locationSize,Jt,Ct,Rt*ui,Rt/Be.locationSize*Mn*ui,Fi)}}else if(void 0!==Qe){const Ct=Qe[me];if(void 0!==Ct)switch(Ct.length){case 2:l.vertexAttrib2fv(Be.location,Ct);break;case 3:l.vertexAttrib3fv(Be.location,Ct);break;case 4:l.vertexAttrib4fv(Be.location,Ct);break;default:l.vertexAttrib1fv(Be.location,Ct)}}}}q()}(xe,Se,Xe,Oe),null!==ze&&l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,t.get(ze).buffer))},reset:qe,resetDefaultState:ye,dispose:function W(){qe();for(const xe in d){const Se=d[xe];for(const Xe in Se){const Oe=Se[Xe];for(const ze in Oe)A(Oe[ze].object),delete Oe[ze];delete Se[Xe]}delete d[xe]}},releaseStatesOfGeometry:function Y(xe){if(void 0===d[xe.id])return;const Se=d[xe.id];for(const Xe in Se){const Oe=Se[Xe];for(const ze in Oe)A(Oe[ze].object),delete Oe[ze];delete Se[Xe]}delete d[xe.id]},releaseStatesOfProgram:function Ce(xe){for(const Se in d){const Xe=d[Se];if(void 0===Xe[xe.id])continue;const Oe=Xe[xe.id];for(const ze in Oe)A(Oe[ze].object),delete Oe[ze];delete Xe[xe.id]}},initAttributes:N,enableAttribute:V,disableUnusedAttributes:q}}function fp(l,e,t,r){const s=r.isWebGL2;let a;this.setMode=function u(m){a=m},this.render=function d(m,y){l.drawArrays(a,m,y),t.update(y,a,1)},this.renderInstances=function p(m,y,x){if(0===x)return;let M,E;if(s)M=l,E="drawArraysInstanced";else if(M=e.get("ANGLE_instanced_arrays"),E="drawArraysInstancedANGLE",null===M)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");M[E](a,m,y,x),t.update(y,a,x)}}function Pg(l,e,t){let r;function a(Q){if("highp"===Q){if(l.getShaderPrecisionFormat(l.VERTEX_SHADER,l.HIGH_FLOAT).precision>0&&l.getShaderPrecisionFormat(l.FRAGMENT_SHADER,l.HIGH_FLOAT).precision>0)return"highp";Q="mediump"}return"mediump"===Q&&l.getShaderPrecisionFormat(l.VERTEX_SHADER,l.MEDIUM_FLOAT).precision>0&&l.getShaderPrecisionFormat(l.FRAGMENT_SHADER,l.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const u="undefined"!=typeof WebGL2RenderingContext&&"WebGL2RenderingContext"===l.constructor.name;let d=void 0!==t.precision?t.precision:"highp";const p=a(d);p!==d&&(console.warn("THREE.WebGLRenderer:",d,"not supported, using",p,"instead."),d=p);const m=u||e.has("WEBGL_draw_buffers"),y=!0===t.logarithmicDepthBuffer,x=l.getParameter(l.MAX_TEXTURE_IMAGE_UNITS),M=l.getParameter(l.MAX_VERTEX_TEXTURE_IMAGE_UNITS),E=l.getParameter(l.MAX_TEXTURE_SIZE),A=l.getParameter(l.MAX_CUBE_MAP_TEXTURE_SIZE),L=l.getParameter(l.MAX_VERTEX_ATTRIBS),D=l.getParameter(l.MAX_VERTEX_UNIFORM_VECTORS),S=l.getParameter(l.MAX_VARYING_VECTORS),U=l.getParameter(l.MAX_FRAGMENT_UNIFORM_VECTORS),N=M>0,V=u||e.has("OES_texture_float");return{isWebGL2:u,drawBuffers:m,getMaxAnisotropy:function s(){if(void 0!==r)return r;if(!0===e.has("EXT_texture_filter_anisotropic")){const Q=e.get("EXT_texture_filter_anisotropic");r=l.getParameter(Q.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r},getMaxPrecision:a,precision:d,logarithmicDepthBuffer:y,maxTextures:x,maxVertexTextures:M,maxTextureSize:E,maxCubemapSize:A,maxAttributes:L,maxVertexUniforms:D,maxVaryings:S,maxFragmentUniforms:U,vertexTextures:N,floatFragmentTextures:V,floatVertexTextures:N&&V,maxSamples:u?l.getParameter(l.MAX_SAMPLES):0}}function qv(l){const e=this;let t=null,r=0,s=!1,a=!1;const u=new _l,d=new Bn,p={value:null,needsUpdate:!1};function y(x,M,E,A){const L=null!==x?x.length:0;let D=null;if(0!==L){if(D=p.value,!0!==A||null===D){const S=E+4*L,U=M.matrixWorldInverse;d.getNormalMatrix(U),(null===D||D.length<S)&&(D=new Float32Array(S));for(let N=0,V=E;N!==L;++N,V+=4)u.copy(x[N]).applyMatrix4(U,d),u.normal.toArray(D,V),D[V+3]=u.constant}p.value=D,p.needsUpdate=!0}return e.numPlanes=L,e.numIntersection=0,D}this.uniform=p,this.numPlanes=0,this.numIntersection=0,this.init=function(x,M){const E=0!==x.length||M||0!==r||s;return s=M,r=x.length,E},this.beginShadows=function(){a=!0,y(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(x,M){t=y(x,M,0)},this.setState=function(x,M,E){const A=x.clippingPlanes,L=x.clipIntersection,D=x.clipShadows,S=l.get(x);if(!s||null===A||0===A.length||a&&!D)a?y(null):function m(){p.value!==t&&(p.value=t,p.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}();else{const U=a?0:r,N=4*U;let V=S.clippingState||null;p.value=V,V=y(A,M,N,E);for(let j=0;j!==N;++j)V[j]=t[j];S.clippingState=V,this.numIntersection=L?this.numPlanes:0,this.numPlanes+=U}}}function Yv(l){let e=new WeakMap;function t(u,d){return 303===d?u.mapping=301:304===d&&(u.mapping=302),u}function s(u){const d=u.target;d.removeEventListener("dispose",s);const p=e.get(d);void 0!==p&&(e.delete(d),p.dispose())}return{get:function r(u){if(u&&u.isTexture&&!1===u.isRenderTargetTexture){const d=u.mapping;if(303===d||304===d){if(e.has(u))return t(e.get(u).texture,u.mapping);{const p=u.image;if(p&&p.height>0){const m=new vM(p.height/2);return m.fromEquirectangularTexture(l,u),e.set(u,m),u.addEventListener("dispose",s),t(m.texture,u.mapping)}return null}}}return u},dispose:function a(){e=new WeakMap}}}class pp extends sg{constructor(e=-1,t=1,r=1,s=-1,a=.1,u=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=s,this.near=a,this.far=u,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,r,s,a,u){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=s,this.view.width=a,this.view.height=u,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,s=(this.top+this.bottom)/2;let a=r-e,u=r+e,d=s+t,p=s-t;if(null!==this.view&&this.view.enabled){const m=(this.right-this.left)/this.view.fullWidth/this.zoom,y=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a+=m*this.view.offsetX,u=a+m*this.view.width,d-=y*this.view.offsetY,p=d-y*this.view.height}this.projectionMatrix.makeOrthographic(a,u,d,p,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const Lg=[.125,.215,.35,.446,.526,.582],mp=new pp,Ng=new Pt;let Td=null;const Fa=(1+Math.sqrt(5))/2,Uc=1/Fa,yo=[new J(1,1,1),new J(-1,1,1),new J(1,1,-1),new J(-1,1,-1),new J(0,Fa,Uc),new J(0,Fa,-Uc),new J(Uc,0,Fa),new J(-Uc,0,Fa),new J(Fa,Uc,0),new J(-Fa,Uc,0)];class Ad{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,s=100){Td=this._renderer.getRenderTarget(),this._setSize(256);const a=this._allocateTargets();return a.depthBuffer=!0,this._sceneToCubeUV(e,r,s,a),t>0&&this._blur(a,0,0,t),this._applyPMREM(a),this._cleanup(a),a}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=kg(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=Ug(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Td),e.scissorTest=!1,gp(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(301===e.mapping||302===e.mapping?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),Td=this._renderer.getRenderTarget();const r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:yi,minFilter:yi,generateMipmaps:!1,type:Ja,format:Fr,colorSpace:Sr,depthBuffer:!1},s=Og(e,t,r);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=Og(e,t,r);const{_lodMax:a}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function Zv(l){const e=[],t=[],r=[];let s=l;const a=l-4+1+Lg.length;for(let u=0;u<a;u++){const d=Math.pow(2,s);t.push(d);let p=1/d;u>l-4?p=Lg[u-l+4-1]:0===u&&(p=0),r.push(p);const m=1/(d-2),y=-m,x=1+m,M=[y,y,x,y,x,x,y,y,x,x,y,x],E=6,A=6,L=3,D=2,S=1,U=new Float32Array(L*A*E),N=new Float32Array(D*A*E),V=new Float32Array(S*A*E);for(let q=0;q<E;q++){const Q=q%3*2/3-1,ae=q>2?0:-1;U.set([Q,ae,0,Q+2/3,ae,0,Q+2/3,ae+1,0,Q,ae,0,Q+2/3,ae+1,0,Q,ae+1,0],L*A*q),N.set(M,D*A*q),V.set([q,q,q,q,q,q],S*A*q)}const j=new zn;j.setAttribute("position",new cr(U,L)),j.setAttribute("uv",new cr(N,D)),j.setAttribute("faceIndex",new cr(V,S)),e.push(j),s>4&&s--}return{lodPlanes:e,sizeLods:t,sigmas:r}}(a)),this._blurMaterial=function Fg(l,e,t){const r=new Float32Array(20),s=new J(0,1,0);return new Io({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${l}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:s}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(a,e,t)}return s}_compileMaterial(e){const t=new hs(this._lodPlanes[0],e);this._renderer.compile(t,mp)}_sceneToCubeUV(e,t,r,s){const d=new Hr(90,1,t,r),p=[1,-1,1,1,1,1],m=[1,1,1,-1,-1,-1],y=this._renderer,x=y.autoClear,M=y.toneMapping;y.getClearColor(Ng),y.toneMapping=0,y.autoClear=!1;const E=new Ia({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),A=new hs(new Wu,E);let L=!1;const D=e.background;D?D.isColor&&(E.color.copy(D),e.background=null,L=!0):(E.color.copy(Ng),L=!0);for(let S=0;S<6;S++){const U=S%3;0===U?(d.up.set(0,p[S],0),d.lookAt(m[S],0,0)):1===U?(d.up.set(0,0,p[S]),d.lookAt(0,m[S],0)):(d.up.set(0,p[S],0),d.lookAt(0,0,m[S]));const N=this._cubeSize;gp(s,U*N,S>2?N:0,N,N),y.setRenderTarget(s),L&&y.render(A,d),y.render(e,d)}A.geometry.dispose(),A.material.dispose(),y.toneMapping=M,y.autoClear=x,e.background=D}_textureToCubeUV(e,t){const r=this._renderer,s=301===e.mapping||302===e.mapping;s?(null===this._cubemapMaterial&&(this._cubemapMaterial=kg()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=Ug());const a=s?this._cubemapMaterial:this._equirectMaterial,u=new hs(this._lodPlanes[0],a);a.uniforms.envMap.value=e;const p=this._cubeSize;gp(t,0,0,3*p,2*p),r.setRenderTarget(t),r.render(u,mp)}_applyPMREM(e){const t=this._renderer,r=t.autoClear;t.autoClear=!1;for(let s=1;s<this._lodPlanes.length;s++){const a=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]);this._blur(e,s-1,s,a,yo[(s-1)%yo.length])}t.autoClear=r}_blur(e,t,r,s,a){const u=this._pingPongRenderTarget;this._halfBlur(e,u,t,r,s,"latitudinal",a),this._halfBlur(u,e,r,r,s,"longitudinal",a)}_halfBlur(e,t,r,s,a,u,d){const p=this._renderer,m=this._blurMaterial;"latitudinal"!==u&&"longitudinal"!==u&&console.error("blur direction must be either latitudinal or longitudinal!");const x=new hs(this._lodPlanes[s],m),M=m.uniforms,E=this._sizeLods[r]-1,A=isFinite(a)?Math.PI/(2*E):2*Math.PI/39,L=a/A,D=isFinite(a)?1+Math.floor(3*L):20;D>20&&console.warn(`sigmaRadians, ${a}, is too large and will clip, as it requested ${D} samples when the maximum is set to 20`);const S=[];let U=0;for(let Q=0;Q<20;++Q){const ae=Q/L,W=Math.exp(-ae*ae/2);S.push(W),0===Q?U+=W:Q<D&&(U+=2*W)}for(let Q=0;Q<S.length;Q++)S[Q]=S[Q]/U;M.envMap.value=e.texture,M.samples.value=D,M.weights.value=S,M.latitudinal.value="latitudinal"===u,d&&(M.poleAxis.value=d);const{_lodMax:N}=this;M.dTheta.value=A,M.mipInt.value=N-r;const V=this._sizeLods[s];gp(t,3*V*(s>N-4?s-N+4:0),4*(this._cubeSize-V),3*V,2*V),p.setRenderTarget(t),p.render(x,mp)}}function Og(l,e,t){const r=new cl(l,e,t);return r.texture.mapping=306,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function gp(l,e,t,r,s){l.viewport.set(e,t,r,s),l.scissor.set(e,t,r,s)}function Ug(){return new Io({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function kg(){return new Io({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function vp(l){let e=new WeakMap,t=null;function a(d){const p=d.target;p.removeEventListener("dispose",a);const m=e.get(p);void 0!==m&&(e.delete(p),m.dispose())}return{get:function r(d){if(d&&d.isTexture){const p=d.mapping,m=303===p||304===p,y=301===p||302===p;if(m||y){if(d.isRenderTargetTexture&&!0===d.needsPMREMUpdate){d.needsPMREMUpdate=!1;let x=e.get(d);return null===t&&(t=new Ad(l)),x=m?t.fromEquirectangular(d,x):t.fromCubemap(d,x),e.set(d,x),x.texture}if(e.has(d))return e.get(d).texture;{const x=d.image;if(m&&x&&x.height>0||y&&x&&function s(d){let p=0;for(let y=0;y<6;y++)void 0!==d[y]&&p++;return 6===p}(x)){null===t&&(t=new Ad(l));const M=m?t.fromEquirectangular(d):t.fromCubemap(d);return e.set(d,M),d.addEventListener("dispose",a),M.texture}return null}}}return d},dispose:function u(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function Kv(l){const e={};function t(r){if(void 0!==e[r])return e[r];let s;switch(r){case"WEBGL_depth_texture":s=l.getExtension("WEBGL_depth_texture")||l.getExtension("MOZ_WEBGL_depth_texture")||l.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":s=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":s=l.getExtension("WEBGL_compressed_texture_s3tc")||l.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||l.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":s=l.getExtension("WEBGL_compressed_texture_pvrtc")||l.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:s=l.getExtension(r)}return e[r]=s,s}return{has:function(r){return null!==t(r)},init:function(r){r.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(r){const s=t(r);return null===s&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),s}}}function Jv(l,e,t,r){const s={},a=new WeakMap;function u(x){const M=x.target;null!==M.index&&e.remove(M.index);for(const A in M.attributes)e.remove(M.attributes[A]);for(const A in M.morphAttributes){const L=M.morphAttributes[A];for(let D=0,S=L.length;D<S;D++)e.remove(L[D])}M.removeEventListener("dispose",u),delete s[M.id];const E=a.get(M);E&&(e.remove(E),a.delete(M)),r.releaseStatesOfGeometry(M),!0===M.isInstancedBufferGeometry&&delete M._maxInstanceCount,t.memory.geometries--}function m(x){const M=[],E=x.index,A=x.attributes.position;let L=0;if(null!==E){const U=E.array;L=E.version;for(let N=0,V=U.length;N<V;N+=3){const j=U[N+0],q=U[N+1],Q=U[N+2];M.push(j,q,q,Q,Q,j)}}else{if(void 0===A)return;L=A.version;for(let N=0,V=A.array.length/3-1;N<V;N+=3){const j=N+0,q=N+1,Q=N+2;M.push(j,q,q,Q,Q,j)}}const D=new(Gm(M)?dd:Zm)(M,1);D.version=L;const S=a.get(x);S&&e.remove(S),a.set(x,D)}return{get:function d(x,M){return!0===s[M.id]||(M.addEventListener("dispose",u),s[M.id]=!0,t.memory.geometries++),M},update:function p(x){const M=x.attributes;for(const A in M)e.update(M[A],l.ARRAY_BUFFER);const E=x.morphAttributes;for(const A in E){const L=E[A];for(let D=0,S=L.length;D<S;D++)e.update(L[D],l.ARRAY_BUFFER)}},getWireframeAttribute:function y(x){const M=a.get(x);if(M){const E=x.index;null!==E&&M.version<E.version&&m(x)}else m(x);return a.get(x)}}}function Cd(l,e,t,r){const s=r.isWebGL2;let a,d,p;this.setMode=function u(M){a=M},this.setIndex=function m(M){d=M.type,p=M.bytesPerElement},this.render=function y(M,E){l.drawElements(a,E,d,M*p),t.update(E,a,1)},this.renderInstances=function x(M,E,A){if(0===A)return;let L,D;if(s)L=l,D="drawElementsInstanced";else if(L=e.get("ANGLE_instanced_arrays"),D="drawElementsInstancedANGLE",null===L)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");L[D](a,E,d,M*p,A),t.update(E,a,A)}}function _p(l){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function s(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function r(a,u,d){switch(t.calls++,u){case l.TRIANGLES:t.triangles+=d*(a/3);break;case l.LINES:t.lines+=d*(a/2);break;case l.LINE_STRIP:t.lines+=d*(a-1);break;case l.LINE_LOOP:t.lines+=d*a;break;case l.POINTS:t.points+=d*a;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",u)}}}}function Qv(l,e){return l[0]-e[0]}function xp(l,e){return Math.abs(e[1])-Math.abs(l[1])}function Mp(l,e,t){const r={},s=new Float32Array(8),a=new WeakMap,u=new vi,d=[];for(let m=0;m<8;m++)d[m]=[m,0];return{update:function p(m,y,x){const M=m.morphTargetInfluences;if(!0===e.isWebGL2){const E=y.morphAttributes.position||y.morphAttributes.normal||y.morphAttributes.color,A=void 0!==E?E.length:0;let L=a.get(y);if(void 0===L||L.count!==A){let xe=function(){qe.dispose(),a.delete(y),y.removeEventListener("dispose",xe)};void 0!==L&&L.texture.dispose();const U=void 0!==y.morphAttributes.position,N=void 0!==y.morphAttributes.normal,V=void 0!==y.morphAttributes.color,j=y.morphAttributes.position||[],q=y.morphAttributes.normal||[],Q=y.morphAttributes.color||[];let ae=0;!0===U&&(ae=1),!0===N&&(ae=2),!0===V&&(ae=3);let W=y.attributes.position.count*ae,Y=1;W>e.maxTextureSize&&(Y=Math.ceil(W/e.maxTextureSize),W=e.maxTextureSize);const Ce=new Float32Array(W*Y*4*A),qe=new xc(Ce,W,Y,A);qe.type=Dn,qe.needsUpdate=!0;const ye=4*ae;for(let Se=0;Se<A;Se++){const Xe=j[Se],Oe=q[Se],ze=Q[Se],Je=W*Y*4*Se;for(let Qe=0;Qe<Xe.count;Qe++){const me=Qe*ye;!0===U&&(u.fromBufferAttribute(Xe,Qe),Ce[Je+me+0]=u.x,Ce[Je+me+1]=u.y,Ce[Je+me+2]=u.z,Ce[Je+me+3]=0),!0===N&&(u.fromBufferAttribute(Oe,Qe),Ce[Je+me+4]=u.x,Ce[Je+me+5]=u.y,Ce[Je+me+6]=u.z,Ce[Je+me+7]=0),!0===V&&(u.fromBufferAttribute(ze,Qe),Ce[Je+me+8]=u.x,Ce[Je+me+9]=u.y,Ce[Je+me+10]=u.z,Ce[Je+me+11]=4===ze.itemSize?u.w:1)}}L={count:A,texture:qe,size:new je(W,Y)},a.set(y,L),y.addEventListener("dispose",xe)}let D=0;for(let U=0;U<M.length;U++)D+=M[U];const S=y.morphTargetsRelative?1:1-D;x.getUniforms().setValue(l,"morphTargetBaseInfluence",S),x.getUniforms().setValue(l,"morphTargetInfluences",M),x.getUniforms().setValue(l,"morphTargetsTexture",L.texture,t),x.getUniforms().setValue(l,"morphTargetsTextureSize",L.size)}else{const E=void 0===M?0:M.length;let A=r[y.id];if(void 0===A||A.length!==E){A=[];for(let N=0;N<E;N++)A[N]=[N,0];r[y.id]=A}for(let N=0;N<E;N++){const V=A[N];V[0]=N,V[1]=M[N]}A.sort(xp);for(let N=0;N<8;N++)N<E&&A[N][1]?(d[N][0]=A[N][0],d[N][1]=A[N][1]):(d[N][0]=Number.MAX_SAFE_INTEGER,d[N][1]=0);d.sort(Qv);const L=y.morphAttributes.position,D=y.morphAttributes.normal;let S=0;for(let N=0;N<8;N++){const V=d[N],j=V[0],q=V[1];j!==Number.MAX_SAFE_INTEGER&&q?(L&&y.getAttribute("morphTarget"+N)!==L[j]&&y.setAttribute("morphTarget"+N,L[j]),D&&y.getAttribute("morphNormal"+N)!==D[j]&&y.setAttribute("morphNormal"+N,D[j]),s[N]=q,S+=q):(L&&!0===y.hasAttribute("morphTarget"+N)&&y.deleteAttribute("morphTarget"+N),D&&!0===y.hasAttribute("morphNormal"+N)&&y.deleteAttribute("morphNormal"+N),s[N]=0)}const U=y.morphTargetsRelative?1:1-S;x.getUniforms().setValue(l,"morphTargetBaseInfluence",U),x.getUniforms().setValue(l,"morphTargetInfluences",s)}}}}function Bg(l,e,t,r){let s=new WeakMap;function d(p){const m=p.target;m.removeEventListener("dispose",d),t.remove(m.instanceMatrix),null!==m.instanceColor&&t.remove(m.instanceColor)}return{update:function a(p){const m=r.render.frame,x=e.get(p,p.geometry);if(s.get(x)!==m&&(e.update(x),s.set(x,m)),p.isInstancedMesh&&(!1===p.hasEventListener("dispose",d)&&p.addEventListener("dispose",d),s.get(p)!==m&&(t.update(p.instanceMatrix,l.ARRAY_BUFFER),null!==p.instanceColor&&t.update(p.instanceColor,l.ARRAY_BUFFER),s.set(p,m))),p.isSkinnedMesh){const M=p.skeleton;s.get(M)!==m&&(M.update(),s.set(M,m))}return x},dispose:function u(){s=new WeakMap}}}const e_=new ks,t_=new xc,Dd=new Bf,n_=new Oc,Hg=[],bp=[],Ep=new Float32Array(16),wp=new Float32Array(9),Sp=new Float32Array(4);function wl(l,e,t){const r=l[0];if(r<=0||r>0)return l;const s=e*t;let a=Hg[s];if(void 0===a&&(a=new Float32Array(s),Hg[s]=a),0!==e){r.toArray(a,0);for(let u=1,d=0;u!==e;++u)d+=t,l[u].toArray(a,d)}return a}function bi(l,e){if(l.length!==e.length)return!1;for(let t=0,r=l.length;t<r;t++)if(l[t]!==e[t])return!1;return!0}function $i(l,e){for(let t=0,r=e.length;t<r;t++)l[t]=e[t]}function Rd(l,e){let t=bp[e];void 0===t&&(t=new Int32Array(e),bp[e]=t);for(let r=0;r!==e;++r)t[r]=l.allocateTextureUnit();return t}function i_(l,e){const t=this.cache;t[0]!==e&&(l.uniform1f(this.addr,e),t[0]=e)}function JM(l,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(l.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(bi(t,e))return;l.uniform2fv(this.addr,e),$i(t,e)}}function Tp(l,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(l.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(l.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(bi(t,e))return;l.uniform3fv(this.addr,e),$i(t,e)}}function zg(l,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(l.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(bi(t,e))return;l.uniform4fv(this.addr,e),$i(t,e)}}function Ap(l,e){const t=this.cache,r=e.elements;if(void 0===r){if(bi(t,e))return;l.uniformMatrix2fv(this.addr,!1,e),$i(t,e)}else{if(bi(t,r))return;Sp.set(r),l.uniformMatrix2fv(this.addr,!1,Sp),$i(t,r)}}function Qu(l,e){const t=this.cache,r=e.elements;if(void 0===r){if(bi(t,e))return;l.uniformMatrix3fv(this.addr,!1,e),$i(t,e)}else{if(bi(t,r))return;wp.set(r),l.uniformMatrix3fv(this.addr,!1,wp),$i(t,r)}}function r_(l,e){const t=this.cache,r=e.elements;if(void 0===r){if(bi(t,e))return;l.uniformMatrix4fv(this.addr,!1,e),$i(t,e)}else{if(bi(t,r))return;Ep.set(r),l.uniformMatrix4fv(this.addr,!1,Ep),$i(t,r)}}function Cp(l,e){const t=this.cache;t[0]!==e&&(l.uniform1i(this.addr,e),t[0]=e)}function Vg(l,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(l.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(bi(t,e))return;l.uniform2iv(this.addr,e),$i(t,e)}}function Gg(l,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(l.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(bi(t,e))return;l.uniform3iv(this.addr,e),$i(t,e)}}function Wg(l,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(l.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(bi(t,e))return;l.uniform4iv(this.addr,e),$i(t,e)}}function s_(l,e){const t=this.cache;t[0]!==e&&(l.uniform1ui(this.addr,e),t[0]=e)}function Dp(l,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(l.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(bi(t,e))return;l.uniform2uiv(this.addr,e),$i(t,e)}}function o_(l,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(l.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(bi(t,e))return;l.uniform3uiv(this.addr,e),$i(t,e)}}function a_(l,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(l.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(bi(t,e))return;l.uniform4uiv(this.addr,e),$i(t,e)}}function $g(l,e,t){const r=this.cache,s=t.allocateTextureUnit();r[0]!==s&&(l.uniform1i(this.addr,s),r[0]=s),t.setTexture2D(e||e_,s)}function kc(l,e,t){const r=this.cache,s=t.allocateTextureUnit();r[0]!==s&&(l.uniform1i(this.addr,s),r[0]=s),t.setTexture3D(e||Dd,s)}function jg(l,e,t){const r=this.cache,s=t.allocateTextureUnit();r[0]!==s&&(l.uniform1i(this.addr,s),r[0]=s),t.setTextureCube(e||n_,s)}function l_(l,e,t){const r=this.cache,s=t.allocateTextureUnit();r[0]!==s&&(l.uniform1i(this.addr,s),r[0]=s),t.setTexture2DArray(e||t_,s)}function Bc(l,e){l.uniform1fv(this.addr,e)}function u_(l,e){const t=wl(e,this.size,2);l.uniform2fv(this.addr,t)}function h_(l,e){const t=wl(e,this.size,3);l.uniform3fv(this.addr,t)}function d_(l,e){const t=wl(e,this.size,4);l.uniform4fv(this.addr,t)}function f_(l,e){const t=wl(e,this.size,4);l.uniformMatrix2fv(this.addr,!1,t)}function Lo(l,e){const t=wl(e,this.size,9);l.uniformMatrix3fv(this.addr,!1,t)}function Rp(l,e){const t=wl(e,this.size,16);l.uniformMatrix4fv(this.addr,!1,t)}function Xg(l,e){l.uniform1iv(this.addr,e)}function qg(l,e){l.uniform2iv(this.addr,e)}function Yg(l,e){l.uniform3iv(this.addr,e)}function Zg(l,e){l.uniform4iv(this.addr,e)}function p_(l,e){l.uniform1uiv(this.addr,e)}function m_(l,e){l.uniform2uiv(this.addr,e)}function g_(l,e){l.uniform3uiv(this.addr,e)}function y_(l,e){l.uniform4uiv(this.addr,e)}function Kg(l,e,t){const r=this.cache,s=e.length,a=Rd(t,s);bi(r,a)||(l.uniform1iv(this.addr,a),$i(r,a));for(let u=0;u!==s;++u)t.setTexture2D(e[u]||e_,a[u])}function QM(l,e,t){const r=this.cache,s=e.length,a=Rd(t,s);bi(r,a)||(l.uniform1iv(this.addr,a),$i(r,a));for(let u=0;u!==s;++u)t.setTexture3D(e[u]||Dd,a[u])}function Jg(l,e,t){const r=this.cache,s=e.length,a=Rd(t,s);bi(r,a)||(l.uniform1iv(this.addr,a),$i(r,a));for(let u=0;u!==s;++u)t.setTextureCube(e[u]||n_,a[u])}function v_(l,e,t){const r=this.cache,s=e.length,a=Rd(t,s);bi(r,a)||(l.uniform1iv(this.addr,a),$i(r,a));for(let u=0;u!==s;++u)t.setTexture2DArray(e[u]||t_,a[u])}class eb{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.setValue=function c_(l){switch(l){case 5126:return i_;case 35664:return JM;case 35665:return Tp;case 35666:return zg;case 35674:return Ap;case 35675:return Qu;case 35676:return r_;case 5124:case 35670:return Cp;case 35667:case 35671:return Vg;case 35668:case 35672:return Gg;case 35669:case 35673:return Wg;case 5125:return s_;case 36294:return Dp;case 36295:return o_;case 36296:return a_;case 35678:case 36198:case 36298:case 36306:case 35682:return $g;case 35679:case 36299:case 36307:return kc;case 35680:case 36300:case 36308:case 36293:return jg;case 36289:case 36303:case 36311:case 36292:return l_}}(t.type)}}class tb{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.size=t.size,this.setValue=function __(l){switch(l){case 5126:return Bc;case 35664:return u_;case 35665:return h_;case 35666:return d_;case 35674:return f_;case 35675:return Lo;case 35676:return Rp;case 5124:case 35670:return Xg;case 35667:case 35671:return qg;case 35668:case 35672:return Yg;case 35669:case 35673:return Zg;case 5125:return p_;case 36294:return m_;case 36295:return g_;case 36296:return y_;case 35678:case 36198:case 36298:case 36306:case 35682:return Kg;case 35679:case 36299:case 36307:return QM;case 35680:case 36300:case 36308:case 36293:return Jg;case 36289:case 36303:case 36311:case 36292:return v_}}(t.type)}}class Ip{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){const s=this.seq;for(let a=0,u=s.length;a!==u;++a){const d=s[a];d.setValue(e,t[d.id],r)}}}const Pp=/(\w+)(\])?(\[|\.)?/g;function Lp(l,e){l.seq.push(e),l.map[e.id]=e}function Qg(l,e,t){const r=l.name,s=r.length;for(Pp.lastIndex=0;;){const a=Pp.exec(r),u=Pp.lastIndex;let d=a[1];const m=a[3];if("]"===a[2]&&(d|=0),void 0===m||"["===m&&u+2===s){Lp(t,void 0===m?new eb(d,l,e):new tb(d,l,e));break}{let x=t.map[d];void 0===x&&(x=new Ip(d),Lp(t,x)),t=x}}}class Np{constructor(e,t){this.seq=[],this.map={};const r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let s=0;s<r;++s){const a=e.getActiveUniform(t,s);Qg(a,e.getUniformLocation(t,a.name),this)}}setValue(e,t,r,s){const a=this.map[t];void 0!==a&&a.setValue(e,r,s)}setOptional(e,t,r){const s=t[r];void 0!==s&&this.setValue(e,r,s)}static upload(e,t,r,s){for(let a=0,u=t.length;a!==u;++a){const d=t[a],p=r[d.id];!1!==p.needsUpdate&&d.setValue(e,p.value,s)}}static seqWithValue(e,t){const r=[];for(let s=0,a=e.length;s!==a;++s){const u=e[s];u.id in t&&r.push(u)}return r}}function Gs(l,e,t){const r=l.createShader(e);return l.shaderSource(r,t),l.compileShader(r),r}let nb=0;function Op(l,e,t){const r=l.getShaderParameter(e,l.COMPILE_STATUS),s=l.getShaderInfoLog(e).trim();if(r&&""===s)return"";const a=/ERROR: 0:(\d+)/.exec(s);if(a){const u=parseInt(a[1]);return t.toUpperCase()+"\n\n"+s+"\n\n"+function ib(l,e){const t=l.split("\n"),r=[],s=Math.max(e-6,0),a=Math.min(e+6,t.length);for(let u=s;u<a;u++){const d=u+1;r.push(`${d===e?">":" "} ${d}: ${t[u]}`)}return r.join("\n")}(l.getShaderSource(e),u)}return s}function ty(l,e){const t=function ey(l){switch(l){case Sr:return["Linear","( value )"];case Ln:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",l),["Linear","( value )"]}}(e);return"vec4 "+l+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function x_(l,e){let t;switch(e){case 1:t="Linear";break;case 2:t="Reinhard";break;case 3:t="OptimizedCineon";break;case 4:t="ACESFilmic";break;case 5:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+l+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function eh(l){return""!==l}function Id(l,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return l.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function ry(l,e){return l.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const M_=/^[ \t]*#include +<([\w\d./]+)>/gm;function Fp(l){return l.replace(M_,E_)}const b_=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function E_(l,e){let t=Un[e];if(void 0===t){const r=b_.get(e);if(void 0===r)throw new Error("Can not resolve #include <"+e+">");t=Un[r],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,r)}return Fp(t)}const w_=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function th(l){return l.replace(w_,Hc)}function Hc(l,e,t,r){let s="";for(let a=parseInt(e);a<parseInt(t);a++)s+=r.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return s}function sy(l){let e="precision "+l.precision+" float;\nprecision "+l.precision+" int;";return"highp"===l.precision?e+="\n#define HIGH_PRECISION":"mediump"===l.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===l.precision&&(e+="\n#define LOW_PRECISION"),e}function ih(l,e,t,r){const s=l.getContext(),a=t.defines;let u=t.vertexShader,d=t.fragmentShader;const p=function nh(l){let e="SHADOWMAP_TYPE_BASIC";return 1===l.shadowMapType?e="SHADOWMAP_TYPE_PCF":2===l.shadowMapType?e="SHADOWMAP_TYPE_PCF_SOFT":3===l.shadowMapType&&(e="SHADOWMAP_TYPE_VSM"),e}(t),m=function S_(l){let e="ENVMAP_TYPE_CUBE";if(l.envMap)switch(l.envMapMode){case 301:case 302:e="ENVMAP_TYPE_CUBE";break;case 306:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),y=function T_(l){let e="ENVMAP_MODE_REFLECTION";return l.envMap&&302===l.envMapMode&&(e="ENVMAP_MODE_REFRACTION"),e}(t),x=function Up(l){let e="ENVMAP_BLENDING_NONE";if(l.envMap)switch(l.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD"}return e}(t),M=function No(l){const e=l.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:r,maxMip:t}}(t),E=t.isWebGL2?"":function rb(l){return[l.extensionDerivatives||l.envMapCubeUVHeight||l.bumpMap||l.normalMapTangentSpace||l.clearcoatNormalMap||l.flatShading||"physical"===l.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(l.extensionFragDepth||l.logarithmicDepthBuffer)&&l.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",l.extensionDrawBuffers&&l.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(l.extensionShaderTextureLOD||l.envMap||l.transmission)&&l.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(eh).join("\n")}(t),A=function ny(l){const e=[];for(const t in l){const r=l[t];!1!==r&&e.push("#define "+t+" "+r)}return e.join("\n")}(a),L=s.createProgram();let D,S,U=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(D=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,A].filter(eh).join("\n"),D.length>0&&(D+="\n"),S=[E,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,A].filter(eh).join("\n"),S.length>0&&(S+="\n")):(D=[sy(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,A,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+y:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+p:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(eh).join("\n"),S=[E,sy(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,A,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+m:"",t.envMap?"#define "+y:"",t.envMap?"#define "+x:"",M?"#define CUBEUV_TEXEL_WIDTH "+M.texelWidth:"",M?"#define CUBEUV_TEXEL_HEIGHT "+M.texelHeight:"",M?"#define CUBEUV_MAX_MIP "+M.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+p:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==t.toneMapping?"#define TONE_MAPPING":"",0!==t.toneMapping?Un.tonemapping_pars_fragment:"",0!==t.toneMapping?x_("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Un.colorspace_pars_fragment,ty("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(eh).join("\n")),u=Fp(u),u=Id(u,t),u=ry(u,t),d=Fp(d),d=Id(d,t),d=ry(d,t),u=th(u),d=th(d),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(U="#version 300 es\n",D=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+D,S=["#define varying in","300 es"===t.glslVersion?"":"layout(location = 0) out highp vec4 pc_fragColor;","300 es"===t.glslVersion?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+S);const V=U+S+d,j=Gs(s,s.VERTEX_SHADER,U+D+u),q=Gs(s,s.FRAGMENT_SHADER,V);if(s.attachShader(L,j),s.attachShader(L,q),void 0!==t.index0AttributeName?s.bindAttribLocation(L,0,t.index0AttributeName):!0===t.morphTargets&&s.bindAttribLocation(L,0,"position"),s.linkProgram(L),l.debug.checkShaderErrors){const W=s.getProgramInfoLog(L).trim(),Y=s.getShaderInfoLog(j).trim(),Ce=s.getShaderInfoLog(q).trim();let qe=!0,ye=!0;if(!1===s.getProgramParameter(L,s.LINK_STATUS))if(qe=!1,"function"==typeof l.debug.onShaderError)l.debug.onShaderError(s,L,j,q);else{const xe=Op(s,j,"vertex"),Se=Op(s,q,"fragment");console.error("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(L,s.VALIDATE_STATUS)+"\n\nProgram Info Log: "+W+"\n"+xe+"\n"+Se)}else""!==W?console.warn("THREE.WebGLProgram: Program Info Log:",W):(""===Y||""===Ce)&&(ye=!1);ye&&(this.diagnostics={runnable:qe,programLog:W,vertexShader:{log:Y,prefix:D},fragmentShader:{log:Ce,prefix:S}})}let Q,ae;return s.deleteShader(j),s.deleteShader(q),this.getUniforms=function(){return void 0===Q&&(Q=new Np(s,L)),Q},this.getAttributes=function(){return void 0===ae&&(ae=function iy(l,e){const t={},r=l.getProgramParameter(e,l.ACTIVE_ATTRIBUTES);for(let s=0;s<r;s++){const a=l.getActiveAttrib(e,s),u=a.name;let d=1;a.type===l.FLOAT_MAT2&&(d=2),a.type===l.FLOAT_MAT3&&(d=3),a.type===l.FLOAT_MAT4&&(d=4),t[u]={type:a.type,location:l.getAttribLocation(e,u),locationSize:d}}return t}(s,L)),ae},this.destroy=function(){r.releaseStatesOfProgram(this),s.deleteProgram(L),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=nb++,this.cacheKey=e,this.usedTimes=1,this.program=L,this.vertexShader=j,this.fragmentShader=q,this}let zr=0;class Sl{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const r=e.fragmentShader,s=this._getShaderStage(e.vertexShader),a=this._getShaderStage(r),u=this._getShaderCacheForMaterial(e);return!1===u.has(s)&&(u.add(s),s.usedTimes++),!1===u.has(a)&&(u.add(a),a.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const r of t)r.usedTimes--,0===r.usedTimes&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let r=t.get(e);return void 0===r&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){const t=this.shaderCache;let r=t.get(e);return void 0===r&&(r=new Pd(e),t.set(e,r)),r}}class Pd{constructor(e){this.id=zr++,this.code=e,this.usedTimes=0}}function Ws(l,e,t,r,s,a,u){const d=new cd,p=new Sl,m=[],y=s.isWebGL2,x=s.logarithmicDepthBuffer,M=s.vertexTextures;let E=s.precision;const A={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function L(W){return 0===W?"uv":`uv${W}`}return{getParameters:function D(W,Y,Ce,qe,ye){const xe=qe.fog,Se=ye.geometry,Oe=(W.isMeshStandardMaterial?t:e).get(W.envMap||(W.isMeshStandardMaterial?qe.environment:null)),ze=Oe&&306===Oe.mapping?Oe.image.height:null,Je=A[W.type];null!==W.precision&&(E=s.getMaxPrecision(W.precision),E!==W.precision&&console.warn("THREE.WebGLProgram.getParameters:",W.precision,"not supported, using",E,"instead."));const Qe=Se.morphAttributes.position||Se.morphAttributes.normal||Se.morphAttributes.color,me=void 0!==Qe?Qe.length:0;let Tt,Ct,Rt,un,Be=0;if(void 0!==Se.morphAttributes.position&&(Be=1),void 0!==Se.morphAttributes.normal&&(Be=2),void 0!==Se.morphAttributes.color&&(Be=3),Je){const Ai=la[Je];Tt=Ai.vertexShader,Ct=Ai.fragmentShader}else Tt=W.vertexShader,Ct=W.fragmentShader,p.update(W),Rt=p.getVertexShaderID(W),un=p.getFragmentShaderID(W);const Nt=l.getRenderTarget(),Jt=!0===ye.isInstancedMesh,ui=!!W.map,Mn=!!Oe,oe=!!W.aoMap,yt=!!W.lightMap,He=!!W.bumpMap,dt=!!W.normalMap,Ze=!!W.displacementMap,rn=!!W.emissiveMap,Ut=!!W.metalnessMap,Vt=!!W.roughnessMap,In=W.anisotropy>0,Jn=W.clearcoat>0,Pi=W.iridescence>0,te=W.sheen>0,$=W.transmission>0,Me=In&&!!W.anisotropyMap,ct=Jn&&!!W.clearcoatMap,tt=Jn&&!!W.clearcoatNormalMap,at=Jn&&!!W.clearcoatRoughnessMap,Qt=Pi&&!!W.iridescenceMap,mt=Pi&&!!W.iridescenceThicknessMap,we=te&&!!W.sheenColorMap,ln=te&&!!W.sheenRoughnessMap,hn=!!W.specularMap,dn=!!W.specularColorMap,Yt=!!W.specularIntensityMap,Xt=$&&!!W.transmissionMap,Vn=$&&!!W.thicknessMap,ce=!!W.alphaMap,vt=!!W.extensions,Dt=!!Se.attributes.uv1,ai=!!Se.attributes.uv2,Ui=!!Se.attributes.uv3;let ir=0;return W.toneMapped&&(null===Nt||!0===Nt.isXRRenderTarget)&&(ir=l.toneMapping),{isWebGL2:y,shaderID:Je,shaderType:W.type,shaderName:W.name,vertexShader:Tt,fragmentShader:Ct,defines:W.defines,customVertexShaderID:Rt,customFragmentShaderID:un,isRawShaderMaterial:!0===W.isRawShaderMaterial,glslVersion:W.glslVersion,precision:E,instancing:Jt,instancingColor:Jt&&null!==ye.instanceColor,supportsVertexTextures:M,outputColorSpace:null===Nt?l.outputColorSpace:!0===Nt.isXRRenderTarget?Nt.texture.colorSpace:Sr,map:ui,matcap:!!W.matcap,envMap:Mn,envMapMode:Mn&&Oe.mapping,envMapCubeUVHeight:ze,aoMap:oe,lightMap:yt,bumpMap:He,normalMap:dt,displacementMap:M&&Ze,emissiveMap:rn,normalMapObjectSpace:dt&&1===W.normalMapType,normalMapTangentSpace:dt&&0===W.normalMapType,metalnessMap:Ut,roughnessMap:Vt,anisotropy:In,anisotropyMap:Me,clearcoat:Jn,clearcoatMap:ct,clearcoatNormalMap:tt,clearcoatRoughnessMap:at,iridescence:Pi,iridescenceMap:Qt,iridescenceThicknessMap:mt,sheen:te,sheenColorMap:we,sheenRoughnessMap:ln,specularMap:hn,specularColorMap:dn,specularIntensityMap:Yt,transmission:$,transmissionMap:Xt,thicknessMap:Vn,gradientMap:!!W.gradientMap,opaque:!1===W.transparent&&1===W.blending,alphaMap:ce,alphaTest:W.alphaTest>0,alphaHash:!!W.alphaHash,combine:W.combine,mapUv:ui&&L(W.map.channel),aoMapUv:oe&&L(W.aoMap.channel),lightMapUv:yt&&L(W.lightMap.channel),bumpMapUv:He&&L(W.bumpMap.channel),normalMapUv:dt&&L(W.normalMap.channel),displacementMapUv:Ze&&L(W.displacementMap.channel),emissiveMapUv:rn&&L(W.emissiveMap.channel),metalnessMapUv:Ut&&L(W.metalnessMap.channel),roughnessMapUv:Vt&&L(W.roughnessMap.channel),anisotropyMapUv:Me&&L(W.anisotropyMap.channel),clearcoatMapUv:ct&&L(W.clearcoatMap.channel),clearcoatNormalMapUv:tt&&L(W.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:at&&L(W.clearcoatRoughnessMap.channel),iridescenceMapUv:Qt&&L(W.iridescenceMap.channel),iridescenceThicknessMapUv:mt&&L(W.iridescenceThicknessMap.channel),sheenColorMapUv:we&&L(W.sheenColorMap.channel),sheenRoughnessMapUv:ln&&L(W.sheenRoughnessMap.channel),specularMapUv:hn&&L(W.specularMap.channel),specularColorMapUv:dn&&L(W.specularColorMap.channel),specularIntensityMapUv:Yt&&L(W.specularIntensityMap.channel),transmissionMapUv:Xt&&L(W.transmissionMap.channel),thicknessMapUv:Vn&&L(W.thicknessMap.channel),alphaMapUv:ce&&L(W.alphaMap.channel),vertexTangents:!!Se.attributes.tangent&&(dt||In),vertexColors:W.vertexColors,vertexAlphas:!0===W.vertexColors&&!!Se.attributes.color&&4===Se.attributes.color.itemSize,vertexUv1s:Dt,vertexUv2s:ai,vertexUv3s:Ui,pointsUvs:!0===ye.isPoints&&!!Se.attributes.uv&&(ui||ce),fog:!!xe,useFog:!0===W.fog,fogExp2:xe&&xe.isFogExp2,flatShading:!0===W.flatShading,sizeAttenuation:!0===W.sizeAttenuation,logarithmicDepthBuffer:x,skinning:!0===ye.isSkinnedMesh,morphTargets:void 0!==Se.morphAttributes.position,morphNormals:void 0!==Se.morphAttributes.normal,morphColors:void 0!==Se.morphAttributes.color,morphTargetsCount:me,morphTextureStride:Be,numDirLights:Y.directional.length,numPointLights:Y.point.length,numSpotLights:Y.spot.length,numSpotLightMaps:Y.spotLightMap.length,numRectAreaLights:Y.rectArea.length,numHemiLights:Y.hemi.length,numDirLightShadows:Y.directionalShadowMap.length,numPointLightShadows:Y.pointShadowMap.length,numSpotLightShadows:Y.spotShadowMap.length,numSpotLightShadowsWithMaps:Y.numSpotLightShadowsWithMaps,numClippingPlanes:u.numPlanes,numClipIntersection:u.numIntersection,dithering:W.dithering,shadowMapEnabled:l.shadowMap.enabled&&Ce.length>0,shadowMapType:l.shadowMap.type,toneMapping:ir,useLegacyLights:l._useLegacyLights,premultipliedAlpha:W.premultipliedAlpha,doubleSided:2===W.side,flipSided:1===W.side,useDepthPacking:W.depthPacking>=0,depthPacking:W.depthPacking||0,index0AttributeName:W.index0AttributeName,extensionDerivatives:vt&&!0===W.extensions.derivatives,extensionFragDepth:vt&&!0===W.extensions.fragDepth,extensionDrawBuffers:vt&&!0===W.extensions.drawBuffers,extensionShaderTextureLOD:vt&&!0===W.extensions.shaderTextureLOD,rendererExtensionFragDepth:y||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:y||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:y||r.has("EXT_shader_texture_lod"),customProgramCacheKey:W.customProgramCacheKey()}},getProgramCacheKey:function S(W){const Y=[];if(W.shaderID?Y.push(W.shaderID):(Y.push(W.customVertexShaderID),Y.push(W.customFragmentShaderID)),void 0!==W.defines)for(const Ce in W.defines)Y.push(Ce),Y.push(W.defines[Ce]);return!1===W.isRawShaderMaterial&&(function U(W,Y){W.push(Y.precision),W.push(Y.outputColorSpace),W.push(Y.envMapMode),W.push(Y.envMapCubeUVHeight),W.push(Y.mapUv),W.push(Y.alphaMapUv),W.push(Y.lightMapUv),W.push(Y.aoMapUv),W.push(Y.bumpMapUv),W.push(Y.normalMapUv),W.push(Y.displacementMapUv),W.push(Y.emissiveMapUv),W.push(Y.metalnessMapUv),W.push(Y.roughnessMapUv),W.push(Y.anisotropyMapUv),W.push(Y.clearcoatMapUv),W.push(Y.clearcoatNormalMapUv),W.push(Y.clearcoatRoughnessMapUv),W.push(Y.iridescenceMapUv),W.push(Y.iridescenceThicknessMapUv),W.push(Y.sheenColorMapUv),W.push(Y.sheenRoughnessMapUv),W.push(Y.specularMapUv),W.push(Y.specularColorMapUv),W.push(Y.specularIntensityMapUv),W.push(Y.transmissionMapUv),W.push(Y.thicknessMapUv),W.push(Y.combine),W.push(Y.fogExp2),W.push(Y.sizeAttenuation),W.push(Y.morphTargetsCount),W.push(Y.morphAttributeCount),W.push(Y.numDirLights),W.push(Y.numPointLights),W.push(Y.numSpotLights),W.push(Y.numSpotLightMaps),W.push(Y.numHemiLights),W.push(Y.numRectAreaLights),W.push(Y.numDirLightShadows),W.push(Y.numPointLightShadows),W.push(Y.numSpotLightShadows),W.push(Y.numSpotLightShadowsWithMaps),W.push(Y.shadowMapType),W.push(Y.toneMapping),W.push(Y.numClippingPlanes),W.push(Y.numClipIntersection),W.push(Y.depthPacking)}(Y,W),function N(W,Y){d.disableAll(),Y.isWebGL2&&d.enable(0),Y.supportsVertexTextures&&d.enable(1),Y.instancing&&d.enable(2),Y.instancingColor&&d.enable(3),Y.matcap&&d.enable(4),Y.envMap&&d.enable(5),Y.normalMapObjectSpace&&d.enable(6),Y.normalMapTangentSpace&&d.enable(7),Y.clearcoat&&d.enable(8),Y.iridescence&&d.enable(9),Y.alphaTest&&d.enable(10),Y.vertexColors&&d.enable(11),Y.vertexAlphas&&d.enable(12),Y.vertexUv1s&&d.enable(13),Y.vertexUv2s&&d.enable(14),Y.vertexUv3s&&d.enable(15),Y.vertexTangents&&d.enable(16),Y.anisotropy&&d.enable(17),W.push(d.mask),d.disableAll(),Y.fog&&d.enable(0),Y.useFog&&d.enable(1),Y.flatShading&&d.enable(2),Y.logarithmicDepthBuffer&&d.enable(3),Y.skinning&&d.enable(4),Y.morphTargets&&d.enable(5),Y.morphNormals&&d.enable(6),Y.morphColors&&d.enable(7),Y.premultipliedAlpha&&d.enable(8),Y.shadowMapEnabled&&d.enable(9),Y.useLegacyLights&&d.enable(10),Y.doubleSided&&d.enable(11),Y.flipSided&&d.enable(12),Y.useDepthPacking&&d.enable(13),Y.dithering&&d.enable(14),Y.transmission&&d.enable(15),Y.sheen&&d.enable(16),Y.opaque&&d.enable(17),Y.pointsUvs&&d.enable(18),W.push(d.mask)}(Y,W),Y.push(l.outputColorSpace)),Y.push(W.customProgramCacheKey),Y.join()},getUniforms:function V(W){const Y=A[W.type];let Ce;return Ce=Y?$u.clone(la[Y].uniforms):W.uniforms,Ce},acquireProgram:function j(W,Y){let Ce;for(let qe=0,ye=m.length;qe<ye;qe++){const xe=m[qe];if(xe.cacheKey===Y){Ce=xe,++Ce.usedTimes;break}}return void 0===Ce&&(Ce=new ih(l,Y,W,a),m.push(Ce)),Ce},releaseProgram:function q(W){if(0==--W.usedTimes){const Y=m.indexOf(W);m[Y]=m[m.length-1],m.pop(),W.destroy()}},releaseShaderCache:function Q(W){p.remove(W)},programs:m,dispose:function ae(){p.dispose()}}}function kp(){let l=new WeakMap;return{get:function e(a){let u=l.get(a);return void 0===u&&(u={},l.set(a,u)),u},remove:function t(a){l.delete(a)},update:function r(a,u,d){l.get(a)[u]=d},dispose:function s(){l=new WeakMap}}}function zc(l,e){return l.groupOrder!==e.groupOrder?l.groupOrder-e.groupOrder:l.renderOrder!==e.renderOrder?l.renderOrder-e.renderOrder:l.material.id!==e.material.id?l.material.id-e.material.id:l.z!==e.z?l.z-e.z:l.id-e.id}function Tl(l,e){return l.groupOrder!==e.groupOrder?l.groupOrder-e.groupOrder:l.renderOrder!==e.renderOrder?l.renderOrder-e.renderOrder:l.z!==e.z?e.z-l.z:l.id-e.id}function Al(){const l=[];let e=0;const t=[],r=[],s=[];function u(x,M,E,A,L,D){let S=l[e];return void 0===S?(S={id:x.id,object:x,geometry:M,material:E,groupOrder:A,renderOrder:x.renderOrder,z:L,group:D},l[e]=S):(S.id=x.id,S.object=x,S.geometry=M,S.material=E,S.groupOrder=A,S.renderOrder=x.renderOrder,S.z=L,S.group=D),e++,S}return{opaque:t,transmissive:r,transparent:s,init:function a(){e=0,t.length=0,r.length=0,s.length=0},push:function d(x,M,E,A,L,D){const S=u(x,M,E,A,L,D);E.transmission>0?r.push(S):!0===E.transparent?s.push(S):t.push(S)},unshift:function p(x,M,E,A,L,D){const S=u(x,M,E,A,L,D);E.transmission>0?r.unshift(S):!0===E.transparent?s.unshift(S):t.unshift(S)},finish:function y(){for(let x=e,M=l.length;x<M;x++){const E=l[x];if(null===E.id)break;E.id=null,E.object=null,E.geometry=null,E.material=null,E.group=null}},sort:function m(x,M){t.length>1&&t.sort(x||zc),r.length>1&&r.sort(M||Tl),s.length>1&&s.sort(M||Tl)}}}function Vc(){let l=new WeakMap;return{get:function e(r,s){const a=l.get(r);let u;return void 0===a?(u=new Al,l.set(r,[u])):s>=a.length?(u=new Al,a.push(u)):u=a[s],u},dispose:function t(){l=new WeakMap}}}function Gc(){const l={};return{get:function(e){if(void 0!==l[e.id])return l[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new J,color:new Pt};break;case"SpotLight":t={position:new J,direction:new J,color:new Pt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new J,color:new Pt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new J,skyColor:new Pt,groundColor:new Pt};break;case"RectAreaLight":t={color:new Pt,position:new J,halfWidth:new J,halfHeight:new J}}return l[e.id]=t,t}}}let $c=0;function jc(l,e){return(e.castShadow?2:0)-(l.castShadow?2:0)+(e.map?1:0)-(l.map?1:0)}function Xc(l,e){const t=new Gc,r=function Wc(){const l={};return{get:function(e){if(void 0!==l[e.id])return l[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new je};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new je,shadowCameraNear:1,shadowCameraFar:1e3}}return l[e.id]=t,t}}}(),s={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let y=0;y<9;y++)s.probe.push(new J);const a=new J,u=new Nn,d=new Nn;return{setup:function p(y,x){let M=0,E=0,A=0;for(let Ce=0;Ce<9;Ce++)s.probe[Ce].set(0,0,0);let L=0,D=0,S=0,U=0,N=0,V=0,j=0,q=0,Q=0,ae=0;y.sort(jc);const W=!0===x?Math.PI:1;for(let Ce=0,qe=y.length;Ce<qe;Ce++){const ye=y[Ce],xe=ye.color,Se=ye.intensity,Xe=ye.distance,Oe=ye.shadow&&ye.shadow.map?ye.shadow.map.texture:null;if(ye.isAmbientLight)M+=xe.r*Se*W,E+=xe.g*Se*W,A+=xe.b*Se*W;else if(ye.isLightProbe)for(let ze=0;ze<9;ze++)s.probe[ze].addScaledVector(ye.sh.coefficients[ze],Se);else if(ye.isDirectionalLight){const ze=t.get(ye);if(ze.color.copy(ye.color).multiplyScalar(ye.intensity*W),ye.castShadow){const Je=ye.shadow,Qe=r.get(ye);Qe.shadowBias=Je.bias,Qe.shadowNormalBias=Je.normalBias,Qe.shadowRadius=Je.radius,Qe.shadowMapSize=Je.mapSize,s.directionalShadow[L]=Qe,s.directionalShadowMap[L]=Oe,s.directionalShadowMatrix[L]=ye.shadow.matrix,V++}s.directional[L]=ze,L++}else if(ye.isSpotLight){const ze=t.get(ye);ze.position.setFromMatrixPosition(ye.matrixWorld),ze.color.copy(xe).multiplyScalar(Se*W),ze.distance=Xe,ze.coneCos=Math.cos(ye.angle),ze.penumbraCos=Math.cos(ye.angle*(1-ye.penumbra)),ze.decay=ye.decay,s.spot[S]=ze;const Je=ye.shadow;if(ye.map&&(s.spotLightMap[Q]=ye.map,Q++,Je.updateMatrices(ye),ye.castShadow&&ae++),s.spotLightMatrix[S]=Je.matrix,ye.castShadow){const Qe=r.get(ye);Qe.shadowBias=Je.bias,Qe.shadowNormalBias=Je.normalBias,Qe.shadowRadius=Je.radius,Qe.shadowMapSize=Je.mapSize,s.spotShadow[S]=Qe,s.spotShadowMap[S]=Oe,q++}S++}else if(ye.isRectAreaLight){const ze=t.get(ye);ze.color.copy(xe).multiplyScalar(Se),ze.halfWidth.set(.5*ye.width,0,0),ze.halfHeight.set(0,.5*ye.height,0),s.rectArea[U]=ze,U++}else if(ye.isPointLight){const ze=t.get(ye);if(ze.color.copy(ye.color).multiplyScalar(ye.intensity*W),ze.distance=ye.distance,ze.decay=ye.decay,ye.castShadow){const Je=ye.shadow,Qe=r.get(ye);Qe.shadowBias=Je.bias,Qe.shadowNormalBias=Je.normalBias,Qe.shadowRadius=Je.radius,Qe.shadowMapSize=Je.mapSize,Qe.shadowCameraNear=Je.camera.near,Qe.shadowCameraFar=Je.camera.far,s.pointShadow[D]=Qe,s.pointShadowMap[D]=Oe,s.pointShadowMatrix[D]=ye.shadow.matrix,j++}s.point[D]=ze,D++}else if(ye.isHemisphereLight){const ze=t.get(ye);ze.skyColor.copy(ye.color).multiplyScalar(Se*W),ze.groundColor.copy(ye.groundColor).multiplyScalar(Se*W),s.hemi[N]=ze,N++}}U>0&&(e.isWebGL2||!0===l.has("OES_texture_float_linear")?(s.rectAreaLTC1=St.LTC_FLOAT_1,s.rectAreaLTC2=St.LTC_FLOAT_2):!0===l.has("OES_texture_half_float_linear")?(s.rectAreaLTC1=St.LTC_HALF_1,s.rectAreaLTC2=St.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),s.ambient[0]=M,s.ambient[1]=E,s.ambient[2]=A;const Y=s.hash;(Y.directionalLength!==L||Y.pointLength!==D||Y.spotLength!==S||Y.rectAreaLength!==U||Y.hemiLength!==N||Y.numDirectionalShadows!==V||Y.numPointShadows!==j||Y.numSpotShadows!==q||Y.numSpotMaps!==Q)&&(s.directional.length=L,s.spot.length=S,s.rectArea.length=U,s.point.length=D,s.hemi.length=N,s.directionalShadow.length=V,s.directionalShadowMap.length=V,s.pointShadow.length=j,s.pointShadowMap.length=j,s.spotShadow.length=q,s.spotShadowMap.length=q,s.directionalShadowMatrix.length=V,s.pointShadowMatrix.length=j,s.spotLightMatrix.length=q+Q-ae,s.spotLightMap.length=Q,s.numSpotLightShadowsWithMaps=ae,Y.directionalLength=L,Y.pointLength=D,Y.spotLength=S,Y.rectAreaLength=U,Y.hemiLength=N,Y.numDirectionalShadows=V,Y.numPointShadows=j,Y.numSpotShadows=q,Y.numSpotMaps=Q,s.version=$c++)},setupView:function m(y,x){let M=0,E=0,A=0,L=0,D=0;const S=x.matrixWorldInverse;for(let U=0,N=y.length;U<N;U++){const V=y[U];if(V.isDirectionalLight){const j=s.directional[M];j.direction.setFromMatrixPosition(V.matrixWorld),a.setFromMatrixPosition(V.target.matrixWorld),j.direction.sub(a),j.direction.transformDirection(S),M++}else if(V.isSpotLight){const j=s.spot[A];j.position.setFromMatrixPosition(V.matrixWorld),j.position.applyMatrix4(S),j.direction.setFromMatrixPosition(V.matrixWorld),a.setFromMatrixPosition(V.target.matrixWorld),j.direction.sub(a),j.direction.transformDirection(S),A++}else if(V.isRectAreaLight){const j=s.rectArea[L];j.position.setFromMatrixPosition(V.matrixWorld),j.position.applyMatrix4(S),d.identity(),u.copy(V.matrixWorld),u.premultiply(S),d.extractRotation(u),j.halfWidth.set(.5*V.width,0,0),j.halfHeight.set(0,.5*V.height,0),j.halfWidth.applyMatrix4(d),j.halfHeight.applyMatrix4(d),L++}else if(V.isPointLight){const j=s.point[E];j.position.setFromMatrixPosition(V.matrixWorld),j.position.applyMatrix4(S),E++}else if(V.isHemisphereLight){const j=s.hemi[D];j.direction.setFromMatrixPosition(V.matrixWorld),j.direction.transformDirection(S),D++}}},state:s}}function Bp(l,e){const t=new Xc(l,e),r=[],s=[];return{init:function a(){r.length=0,s.length=0},state:{lightsArray:r,shadowsArray:s,lights:t},setupLights:function p(x){t.setup(r,x)},setupLightsView:function m(x){t.setupView(r,x)},pushLight:function u(x){r.push(x)},pushShadow:function d(x){s.push(x)}}}function oy(l,e){let t=new WeakMap;return{get:function r(a,u=0){const d=t.get(a);let p;return void 0===d?(p=new Bp(l,e),t.set(a,[p])):u>=d.length?(p=new Bp(l,e),d.push(p)):p=d[u],p},dispose:function s(){t=new WeakMap}}}class Hp extends Ac{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class zp extends Ac{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function cy(l,e,t){let r=new _d;const s=new je,a=new je,u=new vi,d=new Hp({depthPacking:3201}),p=new zp,m={},y=t.maxTextureSize,x={0:1,1:0,2:2},M=new Io({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new je},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),E=M.clone();E.defines.HORIZONTAL_PASS=1;const A=new zn;A.setAttribute("position",new cr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const L=new hs(A,M),D=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1;let S=this.type;function U(j,q){const Q=e.update(L);M.defines.VSM_SAMPLES!==j.blurSamples&&(M.defines.VSM_SAMPLES=j.blurSamples,E.defines.VSM_SAMPLES=j.blurSamples,M.needsUpdate=!0,E.needsUpdate=!0),null===j.mapPass&&(j.mapPass=new cl(s.x,s.y)),M.uniforms.shadow_pass.value=j.map.texture,M.uniforms.resolution.value=j.mapSize,M.uniforms.radius.value=j.radius,l.setRenderTarget(j.mapPass),l.clear(),l.renderBufferDirect(q,null,Q,M,L,null),E.uniforms.shadow_pass.value=j.mapPass.texture,E.uniforms.resolution.value=j.mapSize,E.uniforms.radius.value=j.radius,l.setRenderTarget(j.map),l.clear(),l.renderBufferDirect(q,null,Q,E,L,null)}function N(j,q,Q,ae){let W=null;const Y=!0===Q.isPointLight?j.customDistanceMaterial:j.customDepthMaterial;if(void 0!==Y)W=Y;else if(W=!0===Q.isPointLight?p:d,l.localClippingEnabled&&!0===q.clipShadows&&Array.isArray(q.clippingPlanes)&&0!==q.clippingPlanes.length||q.displacementMap&&0!==q.displacementScale||q.alphaMap&&q.alphaTest>0||q.map&&q.alphaTest>0){const Ce=W.uuid,qe=q.uuid;let ye=m[Ce];void 0===ye&&(ye={},m[Ce]=ye);let xe=ye[qe];void 0===xe&&(xe=W.clone(),ye[qe]=xe),W=xe}return W.visible=q.visible,W.wireframe=q.wireframe,W.side=3===ae?null!==q.shadowSide?q.shadowSide:q.side:null!==q.shadowSide?q.shadowSide:x[q.side],W.alphaMap=q.alphaMap,W.alphaTest=q.alphaTest,W.map=q.map,W.clipShadows=q.clipShadows,W.clippingPlanes=q.clippingPlanes,W.clipIntersection=q.clipIntersection,W.displacementMap=q.displacementMap,W.displacementScale=q.displacementScale,W.displacementBias=q.displacementBias,W.wireframeLinewidth=q.wireframeLinewidth,W.linewidth=q.linewidth,!0===Q.isPointLight&&!0===W.isMeshDistanceMaterial&&(l.properties.get(W).light=Q),W}function V(j,q,Q,ae,W){if(!1===j.visible)return;if(j.layers.test(q.layers)&&(j.isMesh||j.isLine||j.isPoints)&&(j.castShadow||j.receiveShadow&&3===W)&&(!j.frustumCulled||r.intersectsObject(j))){j.modelViewMatrix.multiplyMatrices(Q.matrixWorldInverse,j.matrixWorld);const qe=e.update(j),ye=j.material;if(Array.isArray(ye)){const xe=qe.groups;for(let Se=0,Xe=xe.length;Se<Xe;Se++){const Oe=xe[Se],ze=ye[Oe.materialIndex];if(ze&&ze.visible){const Je=N(j,ze,ae,W);l.renderBufferDirect(Q,null,qe,Je,j,Oe)}}}else if(ye.visible){const xe=N(j,ye,ae,W);l.renderBufferDirect(Q,null,qe,xe,j,null)}}const Ce=j.children;for(let qe=0,ye=Ce.length;qe<ye;qe++)V(Ce[qe],q,Q,ae,W)}this.render=function(j,q,Q){if(!1===D.enabled||!1===D.autoUpdate&&!1===D.needsUpdate||0===j.length)return;const ae=l.getRenderTarget(),W=l.getActiveCubeFace(),Y=l.getActiveMipmapLevel(),Ce=l.state;Ce.setBlending(0),Ce.buffers.color.setClear(1,1,1,1),Ce.buffers.depth.setTest(!0),Ce.setScissorTest(!1);const qe=3!==S&&3===this.type,ye=3===S&&3!==this.type;for(let xe=0,Se=j.length;xe<Se;xe++){const Xe=j[xe],Oe=Xe.shadow;if(void 0===Oe){console.warn("THREE.WebGLShadowMap:",Xe,"has no shadow.");continue}if(!1===Oe.autoUpdate&&!1===Oe.needsUpdate)continue;s.copy(Oe.mapSize);const ze=Oe.getFrameExtents();if(s.multiply(ze),a.copy(Oe.mapSize),(s.x>y||s.y>y)&&(s.x>y&&(a.x=Math.floor(y/ze.x),s.x=a.x*ze.x,Oe.mapSize.x=a.x),s.y>y&&(a.y=Math.floor(y/ze.y),s.y=a.y*ze.y,Oe.mapSize.y=a.y)),null===Oe.map||!0===qe||!0===ye){const Qe=3!==this.type?{minFilter:mi,magFilter:mi}:{};null!==Oe.map&&Oe.map.dispose(),Oe.map=new cl(s.x,s.y,Qe),Oe.map.texture.name=Xe.name+".shadowMap",Oe.camera.updateProjectionMatrix()}l.setRenderTarget(Oe.map),l.clear();const Je=Oe.getViewportCount();for(let Qe=0;Qe<Je;Qe++){const me=Oe.getViewport(Qe);u.set(a.x*me.x,a.y*me.y,a.x*me.z,a.y*me.w),Ce.viewport(u),Oe.updateMatrices(Xe,Qe),r=Oe.getFrustum(),V(q,Q,Oe.camera,Xe,this.type)}!0!==Oe.isPointLightShadow&&3===this.type&&U(Oe,Q),Oe.needsUpdate=!1}S=this.type,D.needsUpdate=!1,l.setRenderTarget(ae,W,Y)}}function uy(l,e,t){const r=t.isWebGL2,d=new function s(){let ce=!1;const At=new vi;let De=null;const vt=new vi(0,0,0,0);return{setMask:function(Dt){De!==Dt&&!ce&&(l.colorMask(Dt,Dt,Dt,Dt),De=Dt)},setLocked:function(Dt){ce=Dt},setClear:function(Dt,ai,Ui,ir,ya){!0===ya&&(Dt*=ir,ai*=ir,Ui*=ir),At.set(Dt,ai,Ui,ir),!1===vt.equals(At)&&(l.clearColor(Dt,ai,Ui,ir),vt.copy(At))},reset:function(){ce=!1,De=null,vt.set(-1,0,0,0)}}},p=new function a(){let ce=!1,At=null,De=null,vt=null;return{setTest:function(Dt){Dt?Nt(l.DEPTH_TEST):Jt(l.DEPTH_TEST)},setMask:function(Dt){At!==Dt&&!ce&&(l.depthMask(Dt),At=Dt)},setFunc:function(Dt){if(De!==Dt){switch(Dt){case 0:l.depthFunc(l.NEVER);break;case 1:l.depthFunc(l.ALWAYS);break;case 2:l.depthFunc(l.LESS);break;case 3:default:l.depthFunc(l.LEQUAL);break;case 4:l.depthFunc(l.EQUAL);break;case 5:l.depthFunc(l.GEQUAL);break;case 6:l.depthFunc(l.GREATER);break;case 7:l.depthFunc(l.NOTEQUAL)}De=Dt}},setLocked:function(Dt){ce=Dt},setClear:function(Dt){vt!==Dt&&(l.clearDepth(Dt),vt=Dt)},reset:function(){ce=!1,At=null,De=null,vt=null}}},m=new function u(){let ce=!1,At=null,De=null,vt=null,Dt=null,ai=null,Ui=null,ir=null,ya=null;return{setTest:function(Ai){ce||(Ai?Nt(l.STENCIL_TEST):Jt(l.STENCIL_TEST))},setMask:function(Ai){At!==Ai&&!ce&&(l.stencilMask(Ai),At=Ai)},setFunc:function(Ai,Ho,Kr){(De!==Ai||vt!==Ho||Dt!==Kr)&&(l.stencilFunc(Ai,Ho,Kr),De=Ai,vt=Ho,Dt=Kr)},setOp:function(Ai,Ho,Kr){(ai!==Ai||Ui!==Ho||ir!==Kr)&&(l.stencilOp(Ai,Ho,Kr),ai=Ai,Ui=Ho,ir=Kr)},setLocked:function(Ai){ce=Ai},setClear:function(Ai){ya!==Ai&&(l.clearStencil(Ai),ya=Ai)},reset:function(){ce=!1,At=null,De=null,vt=null,Dt=null,ai=null,Ui=null,ir=null,ya=null}}},y=new WeakMap,x=new WeakMap;let M={},E={},A=new WeakMap,L=[],D=null,S=!1,U=null,N=null,V=null,j=null,q=null,Q=null,ae=null,W=!1,Y=null,Ce=null,qe=null,ye=null,xe=null;const Se=l.getParameter(l.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Xe=!1,Oe=0;const ze=l.getParameter(l.VERSION);-1!==ze.indexOf("WebGL")?(Oe=parseFloat(/^WebGL (\d)/.exec(ze)[1]),Xe=Oe>=1):-1!==ze.indexOf("OpenGL ES")&&(Oe=parseFloat(/^OpenGL ES (\d)/.exec(ze)[1]),Xe=Oe>=2);let Je=null,Qe={};const me=l.getParameter(l.SCISSOR_BOX),Be=l.getParameter(l.VIEWPORT),Tt=(new vi).fromArray(me),Ct=(new vi).fromArray(Be);function Rt(ce,At,De,vt){const Dt=new Uint8Array(4),ai=l.createTexture();l.bindTexture(ce,ai),l.texParameteri(ce,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(ce,l.TEXTURE_MAG_FILTER,l.NEAREST);for(let Ui=0;Ui<De;Ui++)!r||ce!==l.TEXTURE_3D&&ce!==l.TEXTURE_2D_ARRAY?l.texImage2D(At+Ui,0,l.RGBA,1,1,0,l.RGBA,l.UNSIGNED_BYTE,Dt):l.texImage3D(At,0,l.RGBA,1,1,vt,0,l.RGBA,l.UNSIGNED_BYTE,Dt);return ai}const un={};function Nt(ce){!0!==M[ce]&&(l.enable(ce),M[ce]=!0)}function Jt(ce){!1!==M[ce]&&(l.disable(ce),M[ce]=!1)}un[l.TEXTURE_2D]=Rt(l.TEXTURE_2D,l.TEXTURE_2D,1),un[l.TEXTURE_CUBE_MAP]=Rt(l.TEXTURE_CUBE_MAP,l.TEXTURE_CUBE_MAP_POSITIVE_X,6),r&&(un[l.TEXTURE_2D_ARRAY]=Rt(l.TEXTURE_2D_ARRAY,l.TEXTURE_2D_ARRAY,1,1),un[l.TEXTURE_3D]=Rt(l.TEXTURE_3D,l.TEXTURE_3D,1,1)),d.setClear(0,0,0,1),p.setClear(1),m.setClear(0),Nt(l.DEPTH_TEST),p.setFunc(3),Ze(!1),rn(1),Nt(l.CULL_FACE),He(0);const oe={100:l.FUNC_ADD,101:l.FUNC_SUBTRACT,102:l.FUNC_REVERSE_SUBTRACT};if(r)oe[103]=l.MIN,oe[104]=l.MAX;else{const ce=e.get("EXT_blend_minmax");null!==ce&&(oe[103]=ce.MIN_EXT,oe[104]=ce.MAX_EXT)}const yt={200:l.ZERO,201:l.ONE,202:l.SRC_COLOR,204:l.SRC_ALPHA,210:l.SRC_ALPHA_SATURATE,208:l.DST_COLOR,206:l.DST_ALPHA,203:l.ONE_MINUS_SRC_COLOR,205:l.ONE_MINUS_SRC_ALPHA,209:l.ONE_MINUS_DST_COLOR,207:l.ONE_MINUS_DST_ALPHA};function He(ce,At,De,vt,Dt,ai,Ui,ir){if(0!==ce){if(!1===S&&(Nt(l.BLEND),S=!0),5===ce)Dt=Dt||At,ai=ai||De,Ui=Ui||vt,(At!==N||Dt!==q)&&(l.blendEquationSeparate(oe[At],oe[Dt]),N=At,q=Dt),(De!==V||vt!==j||ai!==Q||Ui!==ae)&&(l.blendFuncSeparate(yt[De],yt[vt],yt[ai],yt[Ui]),V=De,j=vt,Q=ai,ae=Ui),U=ce,W=!1;else if(ce!==U||ir!==W){if((100!==N||100!==q)&&(l.blendEquation(l.FUNC_ADD),N=100,q=100),ir)switch(ce){case 1:l.blendFuncSeparate(l.ONE,l.ONE_MINUS_SRC_ALPHA,l.ONE,l.ONE_MINUS_SRC_ALPHA);break;case 2:l.blendFunc(l.ONE,l.ONE);break;case 3:l.blendFuncSeparate(l.ZERO,l.ONE_MINUS_SRC_COLOR,l.ZERO,l.ONE);break;case 4:l.blendFuncSeparate(l.ZERO,l.SRC_COLOR,l.ZERO,l.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",ce)}else switch(ce){case 1:l.blendFuncSeparate(l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA,l.ONE,l.ONE_MINUS_SRC_ALPHA);break;case 2:l.blendFunc(l.SRC_ALPHA,l.ONE);break;case 3:l.blendFuncSeparate(l.ZERO,l.ONE_MINUS_SRC_COLOR,l.ZERO,l.ONE);break;case 4:l.blendFunc(l.ZERO,l.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",ce)}V=null,j=null,Q=null,ae=null,U=ce,W=ir}}else!0===S&&(Jt(l.BLEND),S=!1)}function Ze(ce){Y!==ce&&(l.frontFace(ce?l.CW:l.CCW),Y=ce)}function rn(ce){0!==ce?(Nt(l.CULL_FACE),ce!==Ce&&l.cullFace(1===ce?l.BACK:2===ce?l.FRONT:l.FRONT_AND_BACK)):Jt(l.CULL_FACE),Ce=ce}function Vt(ce,At,De){ce?(Nt(l.POLYGON_OFFSET_FILL),(ye!==At||xe!==De)&&(l.polygonOffset(At,De),ye=At,xe=De)):Jt(l.POLYGON_OFFSET_FILL)}return{buffers:{color:d,depth:p,stencil:m},enable:Nt,disable:Jt,bindFramebuffer:function ui(ce,At){return E[ce]!==At&&(l.bindFramebuffer(ce,At),E[ce]=At,r&&(ce===l.DRAW_FRAMEBUFFER&&(E[l.FRAMEBUFFER]=At),ce===l.FRAMEBUFFER&&(E[l.DRAW_FRAMEBUFFER]=At)),!0)},drawBuffers:function Fi(ce,At){let De=L,vt=!1;if(ce)if(De=A.get(At),void 0===De&&(De=[],A.set(At,De)),ce.isWebGLMultipleRenderTargets){const Dt=ce.texture;if(De.length!==Dt.length||De[0]!==l.COLOR_ATTACHMENT0){for(let ai=0,Ui=Dt.length;ai<Ui;ai++)De[ai]=l.COLOR_ATTACHMENT0+ai;De.length=Dt.length,vt=!0}}else De[0]!==l.COLOR_ATTACHMENT0&&(De[0]=l.COLOR_ATTACHMENT0,vt=!0);else De[0]!==l.BACK&&(De[0]=l.BACK,vt=!0);vt&&(t.isWebGL2?l.drawBuffers(De):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(De))},useProgram:function Mn(ce){return D!==ce&&(l.useProgram(ce),D=ce,!0)},setBlending:He,setMaterial:function dt(ce,At){2===ce.side?Jt(l.CULL_FACE):Nt(l.CULL_FACE);let De=1===ce.side;At&&(De=!De),Ze(De),1===ce.blending&&!1===ce.transparent?He(0):He(ce.blending,ce.blendEquation,ce.blendSrc,ce.blendDst,ce.blendEquationAlpha,ce.blendSrcAlpha,ce.blendDstAlpha,ce.premultipliedAlpha),p.setFunc(ce.depthFunc),p.setTest(ce.depthTest),p.setMask(ce.depthWrite),d.setMask(ce.colorWrite);const vt=ce.stencilWrite;m.setTest(vt),vt&&(m.setMask(ce.stencilWriteMask),m.setFunc(ce.stencilFunc,ce.stencilRef,ce.stencilFuncMask),m.setOp(ce.stencilFail,ce.stencilZFail,ce.stencilZPass)),Vt(ce.polygonOffset,ce.polygonOffsetFactor,ce.polygonOffsetUnits),!0===ce.alphaToCoverage?Nt(l.SAMPLE_ALPHA_TO_COVERAGE):Jt(l.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:Ze,setCullFace:rn,setLineWidth:function Ut(ce){ce!==qe&&(Xe&&l.lineWidth(ce),qe=ce)},setPolygonOffset:Vt,setScissorTest:function In(ce){ce?Nt(l.SCISSOR_TEST):Jt(l.SCISSOR_TEST)},activeTexture:function Jn(ce){void 0===ce&&(ce=l.TEXTURE0+Se-1),Je!==ce&&(l.activeTexture(ce),Je=ce)},bindTexture:function Pi(ce,At,De){void 0===De&&(De=null===Je?l.TEXTURE0+Se-1:Je);let vt=Qe[De];void 0===vt&&(vt={type:void 0,texture:void 0},Qe[De]=vt),(vt.type!==ce||vt.texture!==At)&&(Je!==De&&(l.activeTexture(De),Je=De),l.bindTexture(ce,At||un[ce]),vt.type=ce,vt.texture=At)},unbindTexture:function te(){const ce=Qe[Je];void 0!==ce&&void 0!==ce.type&&(l.bindTexture(ce.type,null),ce.type=void 0,ce.texture=void 0)},compressedTexImage2D:function $(){try{l.compressedTexImage2D.apply(l,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}},compressedTexImage3D:function Me(){try{l.compressedTexImage3D.apply(l,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}},texImage2D:function ln(){try{l.texImage2D.apply(l,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}},texImage3D:function hn(){try{l.texImage3D.apply(l,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}},updateUBOMapping:function Xt(ce,At){let De=x.get(At);void 0===De&&(De=new WeakMap,x.set(At,De));let vt=De.get(ce);void 0===vt&&(vt=l.getUniformBlockIndex(At,ce.name),De.set(ce,vt))},uniformBlockBinding:function Vn(ce,At){const vt=x.get(At).get(ce);y.get(At)!==vt&&(l.uniformBlockBinding(At,vt,ce.__bindingPointIndex),y.set(At,vt))},texStorage2D:function mt(){try{l.texStorage2D.apply(l,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}},texStorage3D:function we(){try{l.texStorage3D.apply(l,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}},texSubImage2D:function ct(){try{l.texSubImage2D.apply(l,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}},texSubImage3D:function tt(){try{l.texSubImage3D.apply(l,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}},compressedTexSubImage2D:function at(){try{l.compressedTexSubImage2D.apply(l,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}},compressedTexSubImage3D:function Qt(){try{l.compressedTexSubImage3D.apply(l,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}},scissor:function dn(ce){!1===Tt.equals(ce)&&(l.scissor(ce.x,ce.y,ce.z,ce.w),Tt.copy(ce))},viewport:function Yt(ce){!1===Ct.equals(ce)&&(l.viewport(ce.x,ce.y,ce.z,ce.w),Ct.copy(ce))},reset:function Ti(){l.disable(l.BLEND),l.disable(l.CULL_FACE),l.disable(l.DEPTH_TEST),l.disable(l.POLYGON_OFFSET_FILL),l.disable(l.SCISSOR_TEST),l.disable(l.STENCIL_TEST),l.disable(l.SAMPLE_ALPHA_TO_COVERAGE),l.blendEquation(l.FUNC_ADD),l.blendFunc(l.ONE,l.ZERO),l.blendFuncSeparate(l.ONE,l.ZERO,l.ONE,l.ZERO),l.colorMask(!0,!0,!0,!0),l.clearColor(0,0,0,0),l.depthMask(!0),l.depthFunc(l.LESS),l.clearDepth(1),l.stencilMask(4294967295),l.stencilFunc(l.ALWAYS,0,4294967295),l.stencilOp(l.KEEP,l.KEEP,l.KEEP),l.clearStencil(0),l.cullFace(l.BACK),l.frontFace(l.CCW),l.polygonOffset(0,0),l.activeTexture(l.TEXTURE0),l.bindFramebuffer(l.FRAMEBUFFER,null),!0===r&&(l.bindFramebuffer(l.DRAW_FRAMEBUFFER,null),l.bindFramebuffer(l.READ_FRAMEBUFFER,null)),l.useProgram(null),l.lineWidth(1),l.scissor(0,0,l.canvas.width,l.canvas.height),l.viewport(0,0,l.canvas.width,l.canvas.height),M={},Je=null,Qe={},E={},A=new WeakMap,L=[],D=null,S=!1,U=null,N=null,V=null,j=null,q=null,Q=null,ae=null,W=!1,Y=null,Ce=null,qe=null,ye=null,xe=null,Tt.set(0,0,l.canvas.width,l.canvas.height),Ct.set(0,0,l.canvas.width,l.canvas.height),d.reset(),p.reset(),m.reset()}}}function hy(l,e,t,r,s,a,u){const d=s.isWebGL2,p=s.maxTextures,m=s.maxCubemapSize,y=s.maxTextureSize,x=s.maxSamples,M=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,E="undefined"!=typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),A=new WeakMap;let L;const D=new WeakMap;let S=!1;try{S="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(te){}function U(te,$){return S?new OffscreenCanvas(te,$):ol("canvas")}function N(te,$,Me,ct){let tt=1;if((te.width>ct||te.height>ct)&&(tt=ct/Math.max(te.width,te.height)),tt<1||!0===$){if("undefined"!=typeof HTMLImageElement&&te instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&te instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&te instanceof ImageBitmap){const at=$?kr:Math.floor,Qt=at(tt*te.width),mt=at(tt*te.height);void 0===L&&(L=U(Qt,mt));const we=Me?U(Qt,mt):L;return we.width=Qt,we.height=mt,we.getContext("2d").drawImage(te,0,0,Qt,mt),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+te.width+"x"+te.height+") to ("+Qt+"x"+mt+")."),we}return"data"in te&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+te.width+"x"+te.height+")."),te}return te}function V(te){return Vm(te.width)&&Vm(te.height)}function q(te,$){return te.generateMipmaps&&$&&te.minFilter!==mi&&te.minFilter!==yi}function Q(te){l.generateMipmap(te)}function ae(te,$,Me,ct,tt=!1){if(!1===d)return $;if(null!==te){if(void 0!==l[te])return l[te];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+te+"'")}let at=$;return $===l.RED&&(Me===l.FLOAT&&(at=l.R32F),Me===l.HALF_FLOAT&&(at=l.R16F),Me===l.UNSIGNED_BYTE&&(at=l.R8)),$===l.RED_INTEGER&&(Me===l.UNSIGNED_BYTE&&(at=l.R8UI),Me===l.UNSIGNED_SHORT&&(at=l.R16UI),Me===l.UNSIGNED_INT&&(at=l.R32UI),Me===l.BYTE&&(at=l.R8I),Me===l.SHORT&&(at=l.R16I),Me===l.INT&&(at=l.R32I)),$===l.RG&&(Me===l.FLOAT&&(at=l.RG32F),Me===l.HALF_FLOAT&&(at=l.RG16F),Me===l.UNSIGNED_BYTE&&(at=l.RG8)),$===l.RGBA&&(Me===l.FLOAT&&(at=l.RGBA32F),Me===l.HALF_FLOAT&&(at=l.RGBA16F),Me===l.UNSIGNED_BYTE&&(at=ct===Ln&&!1===tt?l.SRGB8_ALPHA8:l.RGBA8),Me===l.UNSIGNED_SHORT_4_4_4_4&&(at=l.RGBA4),Me===l.UNSIGNED_SHORT_5_5_5_1&&(at=l.RGB5_A1)),(at===l.R16F||at===l.R32F||at===l.RG16F||at===l.RG32F||at===l.RGBA16F||at===l.RGBA32F)&&e.get("EXT_color_buffer_float"),at}function W(te,$,Me){return!0===q(te,Me)||te.isFramebufferTexture&&te.minFilter!==mi&&te.minFilter!==yi?Math.log2(Math.max($.width,$.height))+1:void 0!==te.mipmaps&&te.mipmaps.length>0?te.mipmaps.length:te.isCompressedTexture&&Array.isArray(te.image)?$.mipmaps.length:1}function Y(te){return te===mi||1004===te||1005===te?l.NEAREST:l.LINEAR}function Ce(te){const $=te.target;$.removeEventListener("dispose",Ce),function ye(te){const $=r.get(te);if(void 0===$.__webglInit)return;const Me=te.source,ct=D.get(Me);if(ct){const tt=ct[$.__cacheKey];tt.usedTimes--,0===tt.usedTimes&&xe(te),0===Object.keys(ct).length&&D.delete(Me)}r.remove(te)}($),$.isVideoTexture&&A.delete($)}function qe(te){const $=te.target;$.removeEventListener("dispose",qe),function Se(te){const $=te.texture,Me=r.get(te),ct=r.get($);if(void 0!==ct.__webglTexture&&(l.deleteTexture(ct.__webglTexture),u.memory.textures--),te.depthTexture&&te.depthTexture.dispose(),te.isWebGLCubeRenderTarget)for(let tt=0;tt<6;tt++){if(Array.isArray(Me.__webglFramebuffer[tt]))for(let at=0;at<Me.__webglFramebuffer[tt].length;at++)l.deleteFramebuffer(Me.__webglFramebuffer[tt][at]);else l.deleteFramebuffer(Me.__webglFramebuffer[tt]);Me.__webglDepthbuffer&&l.deleteRenderbuffer(Me.__webglDepthbuffer[tt])}else{if(Array.isArray(Me.__webglFramebuffer))for(let tt=0;tt<Me.__webglFramebuffer.length;tt++)l.deleteFramebuffer(Me.__webglFramebuffer[tt]);else l.deleteFramebuffer(Me.__webglFramebuffer);if(Me.__webglDepthbuffer&&l.deleteRenderbuffer(Me.__webglDepthbuffer),Me.__webglMultisampledFramebuffer&&l.deleteFramebuffer(Me.__webglMultisampledFramebuffer),Me.__webglColorRenderbuffer)for(let tt=0;tt<Me.__webglColorRenderbuffer.length;tt++)Me.__webglColorRenderbuffer[tt]&&l.deleteRenderbuffer(Me.__webglColorRenderbuffer[tt]);Me.__webglDepthRenderbuffer&&l.deleteRenderbuffer(Me.__webglDepthRenderbuffer)}if(te.isWebGLMultipleRenderTargets)for(let tt=0,at=$.length;tt<at;tt++){const Qt=r.get($[tt]);Qt.__webglTexture&&(l.deleteTexture(Qt.__webglTexture),u.memory.textures--),r.remove($[tt])}r.remove($),r.remove(te)}($)}function xe(te){const $=r.get(te);l.deleteTexture($.__webglTexture),delete D.get(te.source)[$.__cacheKey],u.memory.textures--}let Xe=0;function Qe(te,$){const Me=r.get(te);if(te.isVideoTexture&&function Jn(te){const $=u.render.frame;A.get(te)!==$&&(A.set(te,$),te.update())}(te),!1===te.isRenderTargetTexture&&te.version>0&&Me.__version!==te.version){const ct=te.image;if(null===ct)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==ct.complete)return void ui(Me,te,$);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(l.TEXTURE_2D,Me.__webglTexture,l.TEXTURE0+$)}const Ct={1e3:l.REPEAT,[Mi]:l.CLAMP_TO_EDGE,1002:l.MIRRORED_REPEAT},Rt={[mi]:l.NEAREST,1004:l.NEAREST_MIPMAP_NEAREST,1005:l.NEAREST_MIPMAP_LINEAR,[yi]:l.LINEAR,1007:l.LINEAR_MIPMAP_NEAREST,[wa]:l.LINEAR_MIPMAP_LINEAR},un={512:l.NEVER,519:l.ALWAYS,513:l.LESS,515:l.LEQUAL,514:l.EQUAL,518:l.GEQUAL,516:l.GREATER,517:l.NOTEQUAL};function Nt(te,$,Me){if(Me?(l.texParameteri(te,l.TEXTURE_WRAP_S,Ct[$.wrapS]),l.texParameteri(te,l.TEXTURE_WRAP_T,Ct[$.wrapT]),(te===l.TEXTURE_3D||te===l.TEXTURE_2D_ARRAY)&&l.texParameteri(te,l.TEXTURE_WRAP_R,Ct[$.wrapR]),l.texParameteri(te,l.TEXTURE_MAG_FILTER,Rt[$.magFilter]),l.texParameteri(te,l.TEXTURE_MIN_FILTER,Rt[$.minFilter])):(l.texParameteri(te,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(te,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),(te===l.TEXTURE_3D||te===l.TEXTURE_2D_ARRAY)&&l.texParameteri(te,l.TEXTURE_WRAP_R,l.CLAMP_TO_EDGE),($.wrapS!==Mi||$.wrapT!==Mi)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),l.texParameteri(te,l.TEXTURE_MAG_FILTER,Y($.magFilter)),l.texParameteri(te,l.TEXTURE_MIN_FILTER,Y($.minFilter)),$.minFilter!==mi&&$.minFilter!==yi&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),$.compareFunction&&(l.texParameteri(te,l.TEXTURE_COMPARE_MODE,l.COMPARE_REF_TO_TEXTURE),l.texParameteri(te,l.TEXTURE_COMPARE_FUNC,un[$.compareFunction])),!0===e.has("EXT_texture_filter_anisotropic")){const ct=e.get("EXT_texture_filter_anisotropic");if($.magFilter===mi||1005!==$.minFilter&&$.minFilter!==wa||$.type===Dn&&!1===e.has("OES_texture_float_linear")||!1===d&&$.type===Ja&&!1===e.has("OES_texture_half_float_linear"))return;($.anisotropy>1||r.get($).__currentAnisotropy)&&(l.texParameterf(te,ct.TEXTURE_MAX_ANISOTROPY_EXT,Math.min($.anisotropy,s.getMaxAnisotropy())),r.get($).__currentAnisotropy=$.anisotropy)}}function Jt(te,$){let Me=!1;void 0===te.__webglInit&&(te.__webglInit=!0,$.addEventListener("dispose",Ce));const ct=$.source;let tt=D.get(ct);void 0===tt&&(tt={},D.set(ct,tt));const at=function Je(te){const $=[];return $.push(te.wrapS),$.push(te.wrapT),$.push(te.wrapR||0),$.push(te.magFilter),$.push(te.minFilter),$.push(te.anisotropy),$.push(te.internalFormat),$.push(te.format),$.push(te.type),$.push(te.generateMipmaps),$.push(te.premultiplyAlpha),$.push(te.flipY),$.push(te.unpackAlignment),$.push(te.colorSpace),$.join()}($);if(at!==te.__cacheKey){void 0===tt[at]&&(tt[at]={texture:l.createTexture(),usedTimes:0},u.memory.textures++,Me=!0),tt[at].usedTimes++;const Qt=tt[te.__cacheKey];void 0!==Qt&&(tt[te.__cacheKey].usedTimes--,0===Qt.usedTimes&&xe($)),te.__cacheKey=at,te.__webglTexture=tt[at].texture}return Me}function ui(te,$,Me){let ct=l.TEXTURE_2D;($.isDataArrayTexture||$.isCompressedArrayTexture)&&(ct=l.TEXTURE_2D_ARRAY),$.isData3DTexture&&(ct=l.TEXTURE_3D);const tt=Jt(te,$),at=$.source;t.bindTexture(ct,te.__webglTexture,l.TEXTURE0+Me);const Qt=r.get(at);if(at.version!==Qt.__version||!0===tt){t.activeTexture(l.TEXTURE0+Me),l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,$.flipY),l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,$.premultiplyAlpha),l.pixelStorei(l.UNPACK_ALIGNMENT,$.unpackAlignment),l.pixelStorei(l.UNPACK_COLORSPACE_CONVERSION_WEBGL,l.NONE);const mt=function j(te){return!d&&(te.wrapS!==Mi||te.wrapT!==Mi||te.minFilter!==mi&&te.minFilter!==yi)}($)&&!1===V($.image);let we=N($.image,mt,!1,y);we=Pi($,we);const ln=V(we)||d,hn=a.convert($.format,$.colorSpace);let Xt,dn=a.convert($.type),Yt=ae($.internalFormat,hn,dn,$.colorSpace);Nt(ct,$,ln);const Vn=$.mipmaps,Ti=d&&!0!==$.isVideoTexture,ce=void 0===Qt.__version||!0===tt,At=W($,we,ln);if($.isDepthTexture)Yt=l.DEPTH_COMPONENT,d?Yt=$.type===Dn?l.DEPTH_COMPONENT32F:$.type===Fe?l.DEPTH_COMPONENT24:$.type===wr?l.DEPTH24_STENCIL8:l.DEPTH_COMPONENT16:$.type===Dn&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),$.format===Yo&&Yt===l.DEPTH_COMPONENT&&1012!==$.type&&$.type!==Fe&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),$.type=Fe,dn=a.convert($.type)),$.format===Qa&&Yt===l.DEPTH_COMPONENT&&(Yt=l.DEPTH_STENCIL,$.type!==wr&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),$.type=wr,dn=a.convert($.type))),ce&&(Ti?t.texStorage2D(l.TEXTURE_2D,1,Yt,we.width,we.height):t.texImage2D(l.TEXTURE_2D,0,Yt,we.width,we.height,0,hn,dn,null));else if($.isDataTexture)if(Vn.length>0&&ln){Ti&&ce&&t.texStorage2D(l.TEXTURE_2D,At,Yt,Vn[0].width,Vn[0].height);for(let De=0,vt=Vn.length;De<vt;De++)Xt=Vn[De],Ti?t.texSubImage2D(l.TEXTURE_2D,De,0,0,Xt.width,Xt.height,hn,dn,Xt.data):t.texImage2D(l.TEXTURE_2D,De,Yt,Xt.width,Xt.height,0,hn,dn,Xt.data);$.generateMipmaps=!1}else Ti?(ce&&t.texStorage2D(l.TEXTURE_2D,At,Yt,we.width,we.height),t.texSubImage2D(l.TEXTURE_2D,0,0,0,we.width,we.height,hn,dn,we.data)):t.texImage2D(l.TEXTURE_2D,0,Yt,we.width,we.height,0,hn,dn,we.data);else if($.isCompressedTexture)if($.isCompressedArrayTexture){Ti&&ce&&t.texStorage3D(l.TEXTURE_2D_ARRAY,At,Yt,Vn[0].width,Vn[0].height,we.depth);for(let De=0,vt=Vn.length;De<vt;De++)Xt=Vn[De],$.format!==Fr?null!==hn?Ti?t.compressedTexSubImage3D(l.TEXTURE_2D_ARRAY,De,0,0,0,Xt.width,Xt.height,we.depth,hn,Xt.data,0,0):t.compressedTexImage3D(l.TEXTURE_2D_ARRAY,De,Yt,Xt.width,Xt.height,we.depth,0,Xt.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ti?t.texSubImage3D(l.TEXTURE_2D_ARRAY,De,0,0,0,Xt.width,Xt.height,we.depth,hn,dn,Xt.data):t.texImage3D(l.TEXTURE_2D_ARRAY,De,Yt,Xt.width,Xt.height,we.depth,0,hn,dn,Xt.data)}else{Ti&&ce&&t.texStorage2D(l.TEXTURE_2D,At,Yt,Vn[0].width,Vn[0].height);for(let De=0,vt=Vn.length;De<vt;De++)Xt=Vn[De],$.format!==Fr?null!==hn?Ti?t.compressedTexSubImage2D(l.TEXTURE_2D,De,0,0,Xt.width,Xt.height,hn,Xt.data):t.compressedTexImage2D(l.TEXTURE_2D,De,Yt,Xt.width,Xt.height,0,Xt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ti?t.texSubImage2D(l.TEXTURE_2D,De,0,0,Xt.width,Xt.height,hn,dn,Xt.data):t.texImage2D(l.TEXTURE_2D,De,Yt,Xt.width,Xt.height,0,hn,dn,Xt.data)}else if($.isDataArrayTexture)Ti?(ce&&t.texStorage3D(l.TEXTURE_2D_ARRAY,At,Yt,we.width,we.height,we.depth),t.texSubImage3D(l.TEXTURE_2D_ARRAY,0,0,0,0,we.width,we.height,we.depth,hn,dn,we.data)):t.texImage3D(l.TEXTURE_2D_ARRAY,0,Yt,we.width,we.height,we.depth,0,hn,dn,we.data);else if($.isData3DTexture)Ti?(ce&&t.texStorage3D(l.TEXTURE_3D,At,Yt,we.width,we.height,we.depth),t.texSubImage3D(l.TEXTURE_3D,0,0,0,0,we.width,we.height,we.depth,hn,dn,we.data)):t.texImage3D(l.TEXTURE_3D,0,Yt,we.width,we.height,we.depth,0,hn,dn,we.data);else if($.isFramebufferTexture){if(ce)if(Ti)t.texStorage2D(l.TEXTURE_2D,At,Yt,we.width,we.height);else{let De=we.width,vt=we.height;for(let Dt=0;Dt<At;Dt++)t.texImage2D(l.TEXTURE_2D,Dt,Yt,De,vt,0,hn,dn,null),De>>=1,vt>>=1}}else if(Vn.length>0&&ln){Ti&&ce&&t.texStorage2D(l.TEXTURE_2D,At,Yt,Vn[0].width,Vn[0].height);for(let De=0,vt=Vn.length;De<vt;De++)Xt=Vn[De],Ti?t.texSubImage2D(l.TEXTURE_2D,De,0,0,hn,dn,Xt):t.texImage2D(l.TEXTURE_2D,De,Yt,hn,dn,Xt);$.generateMipmaps=!1}else Ti?(ce&&t.texStorage2D(l.TEXTURE_2D,At,Yt,we.width,we.height),t.texSubImage2D(l.TEXTURE_2D,0,0,0,hn,dn,we)):t.texImage2D(l.TEXTURE_2D,0,Yt,hn,dn,we);q($,ln)&&Q(ct),Qt.__version=at.version,$.onUpdate&&$.onUpdate($)}te.__version=$.version}function Mn(te,$,Me,ct,tt,at){const Qt=a.convert(Me.format,Me.colorSpace),mt=a.convert(Me.type),we=ae(Me.internalFormat,Qt,mt,Me.colorSpace);if(!r.get($).__hasExternalTextures){const hn=Math.max(1,$.width>>at),dn=Math.max(1,$.height>>at);tt===l.TEXTURE_3D||tt===l.TEXTURE_2D_ARRAY?t.texImage3D(tt,at,we,hn,dn,$.depth,0,Qt,mt,null):t.texImage2D(tt,at,we,hn,dn,0,Qt,mt,null)}t.bindFramebuffer(l.FRAMEBUFFER,te),In($)?M.framebufferTexture2DMultisampleEXT(l.FRAMEBUFFER,ct,tt,r.get(Me).__webglTexture,0,Vt($)):(tt===l.TEXTURE_2D||tt>=l.TEXTURE_CUBE_MAP_POSITIVE_X&&tt<=l.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&l.framebufferTexture2D(l.FRAMEBUFFER,ct,tt,r.get(Me).__webglTexture,at),t.bindFramebuffer(l.FRAMEBUFFER,null)}function oe(te,$,Me){if(l.bindRenderbuffer(l.RENDERBUFFER,te),$.depthBuffer&&!$.stencilBuffer){let ct=l.DEPTH_COMPONENT16;if(Me||In($)){const tt=$.depthTexture;tt&&tt.isDepthTexture&&(tt.type===Dn?ct=l.DEPTH_COMPONENT32F:tt.type===Fe&&(ct=l.DEPTH_COMPONENT24));const at=Vt($);In($)?M.renderbufferStorageMultisampleEXT(l.RENDERBUFFER,at,ct,$.width,$.height):l.renderbufferStorageMultisample(l.RENDERBUFFER,at,ct,$.width,$.height)}else l.renderbufferStorage(l.RENDERBUFFER,ct,$.width,$.height);l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.RENDERBUFFER,te)}else if($.depthBuffer&&$.stencilBuffer){const ct=Vt($);Me&&!1===In($)?l.renderbufferStorageMultisample(l.RENDERBUFFER,ct,l.DEPTH24_STENCIL8,$.width,$.height):In($)?M.renderbufferStorageMultisampleEXT(l.RENDERBUFFER,ct,l.DEPTH24_STENCIL8,$.width,$.height):l.renderbufferStorage(l.RENDERBUFFER,l.DEPTH_STENCIL,$.width,$.height),l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_STENCIL_ATTACHMENT,l.RENDERBUFFER,te)}else{const ct=!0===$.isWebGLMultipleRenderTargets?$.texture:[$.texture];for(let tt=0;tt<ct.length;tt++){const at=ct[tt],Qt=a.convert(at.format,at.colorSpace),mt=a.convert(at.type),we=ae(at.internalFormat,Qt,mt,at.colorSpace),ln=Vt($);Me&&!1===In($)?l.renderbufferStorageMultisample(l.RENDERBUFFER,ln,we,$.width,$.height):In($)?M.renderbufferStorageMultisampleEXT(l.RENDERBUFFER,ln,we,$.width,$.height):l.renderbufferStorage(l.RENDERBUFFER,we,$.width,$.height)}}l.bindRenderbuffer(l.RENDERBUFFER,null)}function He(te){const $=r.get(te),Me=!0===te.isWebGLCubeRenderTarget;if(te.depthTexture&&!$.__autoAllocateDepthBuffer){if(Me)throw new Error("target.depthTexture not supported in Cube render targets");!function yt(te,$){if($&&$.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(l.FRAMEBUFFER,te),!$.depthTexture||!$.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get($.depthTexture).__webglTexture||$.depthTexture.image.width!==$.width||$.depthTexture.image.height!==$.height)&&($.depthTexture.image.width=$.width,$.depthTexture.image.height=$.height,$.depthTexture.needsUpdate=!0),Qe($.depthTexture,0);const ct=r.get($.depthTexture).__webglTexture,tt=Vt($);if($.depthTexture.format===Yo)In($)?M.framebufferTexture2DMultisampleEXT(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.TEXTURE_2D,ct,0,tt):l.framebufferTexture2D(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.TEXTURE_2D,ct,0);else{if($.depthTexture.format!==Qa)throw new Error("Unknown depthTexture format");In($)?M.framebufferTexture2DMultisampleEXT(l.FRAMEBUFFER,l.DEPTH_STENCIL_ATTACHMENT,l.TEXTURE_2D,ct,0,tt):l.framebufferTexture2D(l.FRAMEBUFFER,l.DEPTH_STENCIL_ATTACHMENT,l.TEXTURE_2D,ct,0)}}($.__webglFramebuffer,te)}else if(Me){$.__webglDepthbuffer=[];for(let ct=0;ct<6;ct++)t.bindFramebuffer(l.FRAMEBUFFER,$.__webglFramebuffer[ct]),$.__webglDepthbuffer[ct]=l.createRenderbuffer(),oe($.__webglDepthbuffer[ct],te,!1)}else t.bindFramebuffer(l.FRAMEBUFFER,$.__webglFramebuffer),$.__webglDepthbuffer=l.createRenderbuffer(),oe($.__webglDepthbuffer,te,!1);t.bindFramebuffer(l.FRAMEBUFFER,null)}function Vt(te){return Math.min(x,te.samples)}function In(te){const $=r.get(te);return d&&te.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==$.__useRenderToTexture}function Pi(te,$){const Me=te.colorSpace,ct=te.format,tt=te.type;return!0===te.isCompressedTexture||1035===te.format||Me!==Sr&&""!==Me&&(Me===Ln?!1===d?!0===e.has("EXT_sRGB")&&ct===Fr?(te.format=1035,te.minFilter=yi,te.generateMipmaps=!1):$=$m.sRGBToLinear($):(ct!==Fr||tt!==wo)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Me)),$}this.allocateTextureUnit=function ze(){const te=Xe;return te>=p&&console.warn("THREE.WebGLTextures: Trying to use "+te+" texture units while this GPU supports only "+p),Xe+=1,te},this.resetTextureUnits=function Oe(){Xe=0},this.setTexture2D=Qe,this.setTexture2DArray=function me(te,$){const Me=r.get(te);te.version>0&&Me.__version!==te.version?ui(Me,te,$):t.bindTexture(l.TEXTURE_2D_ARRAY,Me.__webglTexture,l.TEXTURE0+$)},this.setTexture3D=function Be(te,$){const Me=r.get(te);te.version>0&&Me.__version!==te.version?ui(Me,te,$):t.bindTexture(l.TEXTURE_3D,Me.__webglTexture,l.TEXTURE0+$)},this.setTextureCube=function Tt(te,$){const Me=r.get(te);te.version>0&&Me.__version!==te.version?function Fi(te,$,Me){if(6!==$.image.length)return;const ct=Jt(te,$),tt=$.source;t.bindTexture(l.TEXTURE_CUBE_MAP,te.__webglTexture,l.TEXTURE0+Me);const at=r.get(tt);if(tt.version!==at.__version||!0===ct){t.activeTexture(l.TEXTURE0+Me),l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,$.flipY),l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,$.premultiplyAlpha),l.pixelStorei(l.UNPACK_ALIGNMENT,$.unpackAlignment),l.pixelStorei(l.UNPACK_COLORSPACE_CONVERSION_WEBGL,l.NONE);const Qt=$.isCompressedTexture||$.image[0].isCompressedTexture,mt=$.image[0]&&$.image[0].isDataTexture,we=[];for(let De=0;De<6;De++)we[De]=Qt||mt?mt?$.image[De].image:$.image[De]:N($.image[De],!1,!0,m),we[De]=Pi($,we[De]);const ln=we[0],hn=V(ln)||d,dn=a.convert($.format,$.colorSpace),Yt=a.convert($.type),Xt=ae($.internalFormat,dn,Yt,$.colorSpace),Vn=d&&!0!==$.isVideoTexture,Ti=void 0===at.__version||!0===ct;let At,ce=W($,ln,hn);if(Nt(l.TEXTURE_CUBE_MAP,$,hn),Qt){Vn&&Ti&&t.texStorage2D(l.TEXTURE_CUBE_MAP,ce,Xt,ln.width,ln.height);for(let De=0;De<6;De++){At=we[De].mipmaps;for(let vt=0;vt<At.length;vt++){const Dt=At[vt];$.format!==Fr?null!==dn?Vn?t.compressedTexSubImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+De,vt,0,0,Dt.width,Dt.height,dn,Dt.data):t.compressedTexImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+De,vt,Xt,Dt.width,Dt.height,0,Dt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Vn?t.texSubImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+De,vt,0,0,Dt.width,Dt.height,dn,Yt,Dt.data):t.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+De,vt,Xt,Dt.width,Dt.height,0,dn,Yt,Dt.data)}}}else{At=$.mipmaps,Vn&&Ti&&(At.length>0&&ce++,t.texStorage2D(l.TEXTURE_CUBE_MAP,ce,Xt,we[0].width,we[0].height));for(let De=0;De<6;De++)if(mt){Vn?t.texSubImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+De,0,0,0,we[De].width,we[De].height,dn,Yt,we[De].data):t.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+De,0,Xt,we[De].width,we[De].height,0,dn,Yt,we[De].data);for(let vt=0;vt<At.length;vt++){const ai=At[vt].image[De].image;Vn?t.texSubImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+De,vt+1,0,0,ai.width,ai.height,dn,Yt,ai.data):t.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+De,vt+1,Xt,ai.width,ai.height,0,dn,Yt,ai.data)}}else{Vn?t.texSubImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+De,0,0,0,dn,Yt,we[De]):t.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+De,0,Xt,dn,Yt,we[De]);for(let vt=0;vt<At.length;vt++){const Dt=At[vt];Vn?t.texSubImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+De,vt+1,0,0,dn,Yt,Dt.image[De]):t.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+De,vt+1,Xt,dn,Yt,Dt.image[De])}}}q($,hn)&&Q(l.TEXTURE_CUBE_MAP),at.__version=tt.version,$.onUpdate&&$.onUpdate($)}te.__version=$.version}(Me,te,$):t.bindTexture(l.TEXTURE_CUBE_MAP,Me.__webglTexture,l.TEXTURE0+$)},this.rebindTextures=function dt(te,$,Me){const ct=r.get(te);void 0!==$&&Mn(ct.__webglFramebuffer,te,te.texture,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,0),void 0!==Me&&He(te)},this.setupRenderTarget=function Ze(te){const $=te.texture,Me=r.get(te),ct=r.get($);te.addEventListener("dispose",qe),!0!==te.isWebGLMultipleRenderTargets&&(void 0===ct.__webglTexture&&(ct.__webglTexture=l.createTexture()),ct.__version=$.version,u.memory.textures++);const tt=!0===te.isWebGLCubeRenderTarget,at=!0===te.isWebGLMultipleRenderTargets,Qt=V(te)||d;if(tt){Me.__webglFramebuffer=[];for(let mt=0;mt<6;mt++)if(d&&$.mipmaps&&$.mipmaps.length>0){Me.__webglFramebuffer[mt]=[];for(let we=0;we<$.mipmaps.length;we++)Me.__webglFramebuffer[mt][we]=l.createFramebuffer()}else Me.__webglFramebuffer[mt]=l.createFramebuffer()}else{if(d&&$.mipmaps&&$.mipmaps.length>0){Me.__webglFramebuffer=[];for(let mt=0;mt<$.mipmaps.length;mt++)Me.__webglFramebuffer[mt]=l.createFramebuffer()}else Me.__webglFramebuffer=l.createFramebuffer();if(at)if(s.drawBuffers){const mt=te.texture;for(let we=0,ln=mt.length;we<ln;we++){const hn=r.get(mt[we]);void 0===hn.__webglTexture&&(hn.__webglTexture=l.createTexture(),u.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(d&&te.samples>0&&!1===In(te)){const mt=at?$:[$];Me.__webglMultisampledFramebuffer=l.createFramebuffer(),Me.__webglColorRenderbuffer=[],t.bindFramebuffer(l.FRAMEBUFFER,Me.__webglMultisampledFramebuffer);for(let we=0;we<mt.length;we++){const ln=mt[we];Me.__webglColorRenderbuffer[we]=l.createRenderbuffer(),l.bindRenderbuffer(l.RENDERBUFFER,Me.__webglColorRenderbuffer[we]);const hn=a.convert(ln.format,ln.colorSpace),dn=a.convert(ln.type),Yt=ae(ln.internalFormat,hn,dn,ln.colorSpace,!0===te.isXRRenderTarget),Xt=Vt(te);l.renderbufferStorageMultisample(l.RENDERBUFFER,Xt,Yt,te.width,te.height),l.framebufferRenderbuffer(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0+we,l.RENDERBUFFER,Me.__webglColorRenderbuffer[we])}l.bindRenderbuffer(l.RENDERBUFFER,null),te.depthBuffer&&(Me.__webglDepthRenderbuffer=l.createRenderbuffer(),oe(Me.__webglDepthRenderbuffer,te,!0)),t.bindFramebuffer(l.FRAMEBUFFER,null)}}if(tt){t.bindTexture(l.TEXTURE_CUBE_MAP,ct.__webglTexture),Nt(l.TEXTURE_CUBE_MAP,$,Qt);for(let mt=0;mt<6;mt++)if(d&&$.mipmaps&&$.mipmaps.length>0)for(let we=0;we<$.mipmaps.length;we++)Mn(Me.__webglFramebuffer[mt][we],te,$,l.COLOR_ATTACHMENT0,l.TEXTURE_CUBE_MAP_POSITIVE_X+mt,we);else Mn(Me.__webglFramebuffer[mt],te,$,l.COLOR_ATTACHMENT0,l.TEXTURE_CUBE_MAP_POSITIVE_X+mt,0);q($,Qt)&&Q(l.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(at){const mt=te.texture;for(let we=0,ln=mt.length;we<ln;we++){const hn=mt[we],dn=r.get(hn);t.bindTexture(l.TEXTURE_2D,dn.__webglTexture),Nt(l.TEXTURE_2D,hn,Qt),Mn(Me.__webglFramebuffer,te,hn,l.COLOR_ATTACHMENT0+we,l.TEXTURE_2D,0),q(hn,Qt)&&Q(l.TEXTURE_2D)}t.unbindTexture()}else{let mt=l.TEXTURE_2D;if((te.isWebGL3DRenderTarget||te.isWebGLArrayRenderTarget)&&(d?mt=te.isWebGL3DRenderTarget?l.TEXTURE_3D:l.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(mt,ct.__webglTexture),Nt(mt,$,Qt),d&&$.mipmaps&&$.mipmaps.length>0)for(let we=0;we<$.mipmaps.length;we++)Mn(Me.__webglFramebuffer[we],te,$,l.COLOR_ATTACHMENT0,mt,we);else Mn(Me.__webglFramebuffer,te,$,l.COLOR_ATTACHMENT0,mt,0);q($,Qt)&&Q(mt),t.unbindTexture()}te.depthBuffer&&He(te)},this.updateRenderTargetMipmap=function rn(te){const $=V(te)||d,Me=!0===te.isWebGLMultipleRenderTargets?te.texture:[te.texture];for(let ct=0,tt=Me.length;ct<tt;ct++){const at=Me[ct];if(q(at,$)){const Qt=te.isWebGLCubeRenderTarget?l.TEXTURE_CUBE_MAP:l.TEXTURE_2D,mt=r.get(at).__webglTexture;t.bindTexture(Qt,mt),Q(Qt),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function Ut(te){if(d&&te.samples>0&&!1===In(te)){const $=te.isWebGLMultipleRenderTargets?te.texture:[te.texture],Me=te.width,ct=te.height;let tt=l.COLOR_BUFFER_BIT;const at=[],Qt=te.stencilBuffer?l.DEPTH_STENCIL_ATTACHMENT:l.DEPTH_ATTACHMENT,mt=r.get(te),we=!0===te.isWebGLMultipleRenderTargets;if(we)for(let ln=0;ln<$.length;ln++)t.bindFramebuffer(l.FRAMEBUFFER,mt.__webglMultisampledFramebuffer),l.framebufferRenderbuffer(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0+ln,l.RENDERBUFFER,null),t.bindFramebuffer(l.FRAMEBUFFER,mt.__webglFramebuffer),l.framebufferTexture2D(l.DRAW_FRAMEBUFFER,l.COLOR_ATTACHMENT0+ln,l.TEXTURE_2D,null,0);t.bindFramebuffer(l.READ_FRAMEBUFFER,mt.__webglMultisampledFramebuffer),t.bindFramebuffer(l.DRAW_FRAMEBUFFER,mt.__webglFramebuffer);for(let ln=0;ln<$.length;ln++){at.push(l.COLOR_ATTACHMENT0+ln),te.depthBuffer&&at.push(Qt);const hn=void 0!==mt.__ignoreDepthValues&&mt.__ignoreDepthValues;if(!1===hn&&(te.depthBuffer&&(tt|=l.DEPTH_BUFFER_BIT),te.stencilBuffer&&(tt|=l.STENCIL_BUFFER_BIT)),we&&l.framebufferRenderbuffer(l.READ_FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.RENDERBUFFER,mt.__webglColorRenderbuffer[ln]),!0===hn&&(l.invalidateFramebuffer(l.READ_FRAMEBUFFER,[Qt]),l.invalidateFramebuffer(l.DRAW_FRAMEBUFFER,[Qt])),we){const dn=r.get($[ln]).__webglTexture;l.framebufferTexture2D(l.DRAW_FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,dn,0)}l.blitFramebuffer(0,0,Me,ct,0,0,Me,ct,tt,l.NEAREST),E&&l.invalidateFramebuffer(l.READ_FRAMEBUFFER,at)}if(t.bindFramebuffer(l.READ_FRAMEBUFFER,null),t.bindFramebuffer(l.DRAW_FRAMEBUFFER,null),we)for(let ln=0;ln<$.length;ln++){t.bindFramebuffer(l.FRAMEBUFFER,mt.__webglMultisampledFramebuffer),l.framebufferRenderbuffer(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0+ln,l.RENDERBUFFER,mt.__webglColorRenderbuffer[ln]);const hn=r.get($[ln]).__webglTexture;t.bindFramebuffer(l.FRAMEBUFFER,mt.__webglFramebuffer),l.framebufferTexture2D(l.DRAW_FRAMEBUFFER,l.COLOR_ATTACHMENT0+ln,l.TEXTURE_2D,hn,0)}t.bindFramebuffer(l.DRAW_FRAMEBUFFER,mt.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=He,this.setupFrameBufferTexture=Mn,this.useMultisampledRTT=In}function A_(l,e,t){const r=t.isWebGL2;return{convert:function s(a,u=""){let d;if(a===wo)return l.UNSIGNED_BYTE;if(1017===a)return l.UNSIGNED_SHORT_4_4_4_4;if(1018===a)return l.UNSIGNED_SHORT_5_5_5_1;if(1010===a)return l.BYTE;if(1011===a)return l.SHORT;if(1012===a)return l.UNSIGNED_SHORT;if(1013===a)return l.INT;if(a===Fe)return l.UNSIGNED_INT;if(a===Dn)return l.FLOAT;if(a===Ja)return r?l.HALF_FLOAT:(d=e.get("OES_texture_half_float"),null!==d?d.HALF_FLOAT_OES:null);if(1021===a)return l.ALPHA;if(a===Fr)return l.RGBA;if(1024===a)return l.LUMINANCE;if(1025===a)return l.LUMINANCE_ALPHA;if(a===Yo)return l.DEPTH_COMPONENT;if(a===Qa)return l.DEPTH_STENCIL;if(1035===a)return d=e.get("EXT_sRGB"),null!==d?d.SRGB_ALPHA_EXT:null;if(1028===a)return l.RED;if(1029===a)return l.RED_INTEGER;if(1030===a)return l.RG;if(1031===a)return l.RG_INTEGER;if(1033===a)return l.RGBA_INTEGER;if(33776===a||33777===a||33778===a||33779===a)if(u===Ln){if(d=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===d)return null;if(33776===a)return d.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===a)return d.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===a)return d.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===a)return d.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(d=e.get("WEBGL_compressed_texture_s3tc"),null===d)return null;if(33776===a)return d.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===a)return d.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===a)return d.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===a)return d.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===a||35841===a||35842===a||35843===a){if(d=e.get("WEBGL_compressed_texture_pvrtc"),null===d)return null;if(35840===a)return d.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===a)return d.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===a)return d.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===a)return d.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===a)return d=e.get("WEBGL_compressed_texture_etc1"),null!==d?d.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===a||37496===a){if(d=e.get("WEBGL_compressed_texture_etc"),null===d)return null;if(37492===a)return u===Ln?d.COMPRESSED_SRGB8_ETC2:d.COMPRESSED_RGB8_ETC2;if(37496===a)return u===Ln?d.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:d.COMPRESSED_RGBA8_ETC2_EAC}if(37808===a||37809===a||37810===a||37811===a||37812===a||37813===a||37814===a||37815===a||37816===a||37817===a||37818===a||37819===a||37820===a||37821===a){if(d=e.get("WEBGL_compressed_texture_astc"),null===d)return null;if(37808===a)return u===Ln?d.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:d.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===a)return u===Ln?d.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:d.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===a)return u===Ln?d.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:d.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===a)return u===Ln?d.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:d.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===a)return u===Ln?d.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:d.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===a)return u===Ln?d.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:d.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===a)return u===Ln?d.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:d.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===a)return u===Ln?d.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:d.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===a)return u===Ln?d.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:d.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===a)return u===Ln?d.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:d.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===a)return u===Ln?d.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:d.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===a)return u===Ln?d.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:d.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===a)return u===Ln?d.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:d.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===a)return u===Ln?d.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:d.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===a){if(d=e.get("EXT_texture_compression_bptc"),null===d)return null;if(36492===a)return u===Ln?d.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:d.COMPRESSED_RGBA_BPTC_UNORM_EXT}if(36283===a||36284===a||36285===a||36286===a){if(d=e.get("EXT_texture_compression_rgtc"),null===d)return null;if(36492===a)return d.COMPRESSED_RED_RGTC1_EXT;if(36284===a)return d.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===a)return d.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===a)return d.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return a===wr?r?l.UNSIGNED_INT_24_8:(d=e.get("WEBGL_depth_texture"),null!==d?d.UNSIGNED_INT_24_8_WEBGL:null):void 0!==l[a]?l[a]:null}}}class C_ extends Hr{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class rh extends Hs{constructor(){super(),this.isGroup=!0,this.type="Group"}}const D_={type:"move"};class Ld{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new rh,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new rh,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new J,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new J),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new rh,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new J,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new J),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const r of e.hand.values())this._getHandJoint(t,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,r){let s=null,a=null,u=null;const d=this._targetRay,p=this._grip,m=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(m&&e.hand){u=!0;for(const L of e.hand.values()){const D=t.getJointPose(L,r),S=this._getHandJoint(m,L);null!==D&&(S.matrix.fromArray(D.transform.matrix),S.matrix.decompose(S.position,S.rotation,S.scale),S.matrixWorldNeedsUpdate=!0,S.jointRadius=D.radius),S.visible=null!==D}const M=m.joints["index-finger-tip"].position.distanceTo(m.joints["thumb-tip"].position),E=.02,A=.005;m.inputState.pinching&&M>E+A?(m.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!m.inputState.pinching&&M<=E-A&&(m.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==p&&e.gripSpace&&(a=t.getPose(e.gripSpace,r),null!==a&&(p.matrix.fromArray(a.transform.matrix),p.matrix.decompose(p.position,p.rotation,p.scale),p.matrixWorldNeedsUpdate=!0,a.linearVelocity?(p.hasLinearVelocity=!0,p.linearVelocity.copy(a.linearVelocity)):p.hasLinearVelocity=!1,a.angularVelocity?(p.hasAngularVelocity=!0,p.angularVelocity.copy(a.angularVelocity)):p.hasAngularVelocity=!1));null!==d&&(s=t.getPose(e.targetRaySpace,r),null===s&&null!==a&&(s=a),null!==s&&(d.matrix.fromArray(s.transform.matrix),d.matrix.decompose(d.position,d.rotation,d.scale),d.matrixWorldNeedsUpdate=!0,s.linearVelocity?(d.hasLinearVelocity=!0,d.linearVelocity.copy(s.linearVelocity)):d.hasLinearVelocity=!1,s.angularVelocity?(d.hasAngularVelocity=!0,d.angularVelocity.copy(s.angularVelocity)):d.hasAngularVelocity=!1,this.dispatchEvent(D_)))}return null!==d&&(d.visible=null!==s),null!==p&&(p.visible=null!==a),null!==m&&(m.visible=null!==u),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const r=new rh;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[t.jointName]=r,e.add(r)}return e.joints[t.jointName]}}class R_ extends ks{constructor(e,t,r,s,a,u,d,p,m,y){if((y=void 0!==y?y:Yo)!==Yo&&y!==Qa)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===r&&y===Yo&&(r=Fe),void 0===r&&y===Qa&&(r=wr),super(null,s,a,u,d,p,y,r,m),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==d?d:mi,this.minFilter=void 0!==p?p:mi,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}class I_ extends Tu{constructor(e,t){super();const r=this;let s=null,a=1,u=null,d="local-floor",p=1,m=null,y=null,x=null,M=null,E=null,A=null;const L=t.getContextAttributes();let D=null,S=null;const U=[],N=[],V=new Hr;V.layers.enable(1),V.viewport=new vi;const j=new Hr;j.layers.enable(2),j.viewport=new vi;const q=[V,j],Q=new C_;Q.layers.enable(1),Q.layers.enable(2);let ae=null,W=null;function Y(me){const Be=N.indexOf(me.inputSource);if(-1===Be)return;const Tt=U[Be];void 0!==Tt&&(Tt.update(me.inputSource,me.frame,m||u),Tt.dispatchEvent({type:me.type,data:me.inputSource}))}function Ce(){s.removeEventListener("select",Y),s.removeEventListener("selectstart",Y),s.removeEventListener("selectend",Y),s.removeEventListener("squeeze",Y),s.removeEventListener("squeezestart",Y),s.removeEventListener("squeezeend",Y),s.removeEventListener("end",Ce),s.removeEventListener("inputsourceschange",qe);for(let me=0;me<U.length;me++){const Be=N[me];null!==Be&&(N[me]=null,U[me].disconnect(Be))}ae=null,W=null,e.setRenderTarget(D),E=null,M=null,x=null,s=null,S=null,Qe.stop(),r.isPresenting=!1,r.dispatchEvent({type:"sessionend"})}function qe(me){for(let Be=0;Be<me.removed.length;Be++){const Tt=me.removed[Be],Ct=N.indexOf(Tt);Ct>=0&&(N[Ct]=null,U[Ct].disconnect(Tt))}for(let Be=0;Be<me.added.length;Be++){const Tt=me.added[Be];let Ct=N.indexOf(Tt);if(-1===Ct){for(let un=0;un<U.length;un++){if(un>=N.length){N.push(Tt),Ct=un;break}if(null===N[un]){N[un]=Tt,Ct=un;break}}if(-1===Ct)break}const Rt=U[Ct];Rt&&Rt.connect(Tt)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(me){let Be=U[me];return void 0===Be&&(Be=new Ld,U[me]=Be),Be.getTargetRaySpace()},this.getControllerGrip=function(me){let Be=U[me];return void 0===Be&&(Be=new Ld,U[me]=Be),Be.getGripSpace()},this.getHand=function(me){let Be=U[me];return void 0===Be&&(Be=new Ld,U[me]=Be),Be.getHandSpace()},this.setFramebufferScaleFactor=function(me){a=me,!0===r.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(me){d=me,!0===r.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return m||u},this.setReferenceSpace=function(me){m=me},this.getBaseLayer=function(){return null!==M?M:E},this.getBinding=function(){return x},this.getFrame=function(){return A},this.getSession=function(){return s},this.setSession=function(){var me=function ql(l){return function(){var e=this,t=arguments;return new Promise(function(r,s){var a=l.apply(e,t);function u(p){si(a,r,s,u,d,"next",p)}function d(p){si(a,r,s,u,d,"throw",p)}u(void 0)})}}(function*(Be){if(s=Be,null!==s){if(D=e.getRenderTarget(),s.addEventListener("select",Y),s.addEventListener("selectstart",Y),s.addEventListener("selectend",Y),s.addEventListener("squeeze",Y),s.addEventListener("squeezestart",Y),s.addEventListener("squeezeend",Y),s.addEventListener("end",Ce),s.addEventListener("inputsourceschange",qe),!0!==L.xrCompatible&&(yield t.makeXRCompatible()),void 0===s.renderState.layers||!1===e.capabilities.isWebGL2)E=new XRWebGLLayer(s,t,{antialias:void 0!==s.renderState.layers||L.antialias,alpha:!0,depth:L.depth,stencil:L.stencil,framebufferScaleFactor:a}),s.updateRenderState({baseLayer:E}),S=new cl(E.framebufferWidth,E.framebufferHeight,{format:Fr,type:wo,colorSpace:e.outputColorSpace,stencilBuffer:L.stencil});else{let Tt=null,Ct=null,Rt=null;L.depth&&(Rt=L.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Tt=L.stencil?Qa:Yo,Ct=L.stencil?wr:Fe);const un={colorFormat:t.RGBA8,depthFormat:Rt,scaleFactor:a};x=new XRWebGLBinding(s,t),M=x.createProjectionLayer(un),s.updateRenderState({layers:[M]}),S=new cl(M.textureWidth,M.textureHeight,{format:Fr,type:wo,depthTexture:new R_(M.textureWidth,M.textureHeight,Ct,void 0,void 0,void 0,void 0,void 0,void 0,Tt),stencilBuffer:L.stencil,colorSpace:e.outputColorSpace,samples:L.antialias?4:0}),e.properties.get(S).__ignoreDepthValues=M.ignoreDepthValues}S.isXRRenderTarget=!0,this.setFoveation(p),m=null,u=yield s.requestReferenceSpace(d),Qe.setContext(s),Qe.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}});return function(Be){return me.apply(this,arguments)}}(),this.getEnvironmentBlendMode=function(){if(null!==s)return s.environmentBlendMode};const ye=new J,xe=new J;function Xe(me,Be){null===Be?me.matrixWorld.copy(me.matrix):me.matrixWorld.multiplyMatrices(Be.matrixWorld,me.matrix),me.matrixWorldInverse.copy(me.matrixWorld).invert()}this.updateCamera=function(me){if(null===s)return;Q.near=j.near=V.near=me.near,Q.far=j.far=V.far=me.far,(ae!==Q.near||W!==Q.far)&&(s.updateRenderState({depthNear:Q.near,depthFar:Q.far}),ae=Q.near,W=Q.far);const Be=me.parent,Tt=Q.cameras;Xe(Q,Be);for(let Ct=0;Ct<Tt.length;Ct++)Xe(Tt[Ct],Be);2===Tt.length?function Se(me,Be,Tt){ye.setFromMatrixPosition(Be.matrixWorld),xe.setFromMatrixPosition(Tt.matrixWorld);const Ct=ye.distanceTo(xe),Rt=Be.projectionMatrix.elements,un=Tt.projectionMatrix.elements,Nt=Rt[14]/(Rt[10]-1),Jt=Rt[14]/(Rt[10]+1),ui=(Rt[9]+1)/Rt[5],Fi=(Rt[9]-1)/Rt[5],Mn=(Rt[8]-1)/Rt[0],oe=(un[8]+1)/un[0],yt=Nt*Mn,He=Nt*oe,dt=Ct/(-Mn+oe),Ze=dt*-Mn;Be.matrixWorld.decompose(me.position,me.quaternion,me.scale),me.translateX(Ze),me.translateZ(dt),me.matrixWorld.compose(me.position,me.quaternion,me.scale),me.matrixWorldInverse.copy(me.matrixWorld).invert();const rn=Nt+dt,Ut=Jt+dt;me.projectionMatrix.makePerspective(yt-Ze,He+(Ct-Ze),ui*Jt/Ut*rn,Fi*Jt/Ut*rn,rn,Ut),me.projectionMatrixInverse.copy(me.projectionMatrix).invert()}(Q,V,j):Q.projectionMatrix.copy(V.projectionMatrix),function Oe(me,Be,Tt){null===Tt?me.matrix.copy(Be.matrixWorld):(me.matrix.copy(Tt.matrixWorld),me.matrix.invert(),me.matrix.multiply(Be.matrixWorld)),me.matrix.decompose(me.position,me.quaternion,me.scale),me.updateMatrixWorld(!0);const Ct=me.children;for(let Rt=0,un=Ct.length;Rt<un;Rt++)Ct[Rt].updateMatrixWorld(!0);me.projectionMatrix.copy(Be.projectionMatrix),me.projectionMatrixInverse.copy(Be.projectionMatrixInverse),me.isPerspectiveCamera&&(me.fov=2*Au*Math.atan(1/me.projectionMatrix.elements[5]),me.zoom=1)}(me,Q,Be)},this.getCamera=function(){return Q},this.getFoveation=function(){if(null!==M||null!==E)return p},this.setFoveation=function(me){p=me,null!==M&&(M.fixedFoveation=me),null!==E&&void 0!==E.fixedFoveation&&(E.fixedFoveation=me)};let ze=null;const Qe=new Xu;Qe.setAnimationLoop(function Je(me,Be){if(y=Be.getViewerPose(m||u),A=Be,null!==y){const Tt=y.views;null!==E&&(e.setRenderTargetFramebuffer(S,E.framebuffer),e.setRenderTarget(S));let Ct=!1;Tt.length!==Q.cameras.length&&(Q.cameras.length=0,Ct=!0);for(let Rt=0;Rt<Tt.length;Rt++){const un=Tt[Rt];let Nt=null;if(null!==E)Nt=E.getViewport(un);else{const ui=x.getViewSubImage(M,un);Nt=ui.viewport,0===Rt&&(e.setRenderTargetTextures(S,ui.colorTexture,M.ignoreDepthValues?void 0:ui.depthStencilTexture),e.setRenderTarget(S))}let Jt=q[Rt];void 0===Jt&&(Jt=new Hr,Jt.layers.enable(Rt),Jt.viewport=new vi,q[Rt]=Jt),Jt.matrix.fromArray(un.transform.matrix),Jt.matrix.decompose(Jt.position,Jt.quaternion,Jt.scale),Jt.projectionMatrix.fromArray(un.projectionMatrix),Jt.projectionMatrixInverse.copy(Jt.projectionMatrix).invert(),Jt.viewport.set(Nt.x,Nt.y,Nt.width,Nt.height),0===Rt&&(Q.matrix.copy(Jt.matrix),Q.matrix.decompose(Q.position,Q.quaternion,Q.scale)),!0===Ct&&Q.cameras.push(Jt)}}for(let Tt=0;Tt<U.length;Tt++){const Ct=N[Tt],Rt=U[Tt];null!==Ct&&void 0!==Rt&&Rt.update(Ct,Be,m||u)}ze&&ze(me,Be),Be.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:Be}),A=null}),this.setAnimationLoop=function(me){ze=me},this.dispose=function(){}}}function dy(l,e){function t(D,S){!0===D.matrixAutoUpdate&&D.updateMatrix(),S.value.copy(D.matrix)}function a(D,S){D.opacity.value=S.opacity,S.color&&D.diffuse.value.copy(S.color),S.emissive&&D.emissive.value.copy(S.emissive).multiplyScalar(S.emissiveIntensity),S.map&&(D.map.value=S.map,t(S.map,D.mapTransform)),S.alphaMap&&(D.alphaMap.value=S.alphaMap,t(S.alphaMap,D.alphaMapTransform)),S.bumpMap&&(D.bumpMap.value=S.bumpMap,t(S.bumpMap,D.bumpMapTransform),D.bumpScale.value=S.bumpScale,1===S.side&&(D.bumpScale.value*=-1)),S.normalMap&&(D.normalMap.value=S.normalMap,t(S.normalMap,D.normalMapTransform),D.normalScale.value.copy(S.normalScale),1===S.side&&D.normalScale.value.negate()),S.displacementMap&&(D.displacementMap.value=S.displacementMap,t(S.displacementMap,D.displacementMapTransform),D.displacementScale.value=S.displacementScale,D.displacementBias.value=S.displacementBias),S.emissiveMap&&(D.emissiveMap.value=S.emissiveMap,t(S.emissiveMap,D.emissiveMapTransform)),S.specularMap&&(D.specularMap.value=S.specularMap,t(S.specularMap,D.specularMapTransform)),S.alphaTest>0&&(D.alphaTest.value=S.alphaTest);const U=e.get(S).envMap;if(U&&(D.envMap.value=U,D.flipEnvMap.value=U.isCubeTexture&&!1===U.isRenderTargetTexture?-1:1,D.reflectivity.value=S.reflectivity,D.ior.value=S.ior,D.refractionRatio.value=S.refractionRatio),S.lightMap){D.lightMap.value=S.lightMap;const N=!0===l._useLegacyLights?Math.PI:1;D.lightMapIntensity.value=S.lightMapIntensity*N,t(S.lightMap,D.lightMapTransform)}S.aoMap&&(D.aoMap.value=S.aoMap,D.aoMapIntensity.value=S.aoMapIntensity,t(S.aoMap,D.aoMapTransform))}return{refreshFogUniforms:function r(D,S){S.color.getRGB(D.fogColor.value,po(l)),S.isFog?(D.fogNear.value=S.near,D.fogFar.value=S.far):S.isFogExp2&&(D.fogDensity.value=S.density)},refreshMaterialUniforms:function s(D,S,U,N,V){S.isMeshBasicMaterial||S.isMeshLambertMaterial?a(D,S):S.isMeshToonMaterial?(a(D,S),function x(D,S){S.gradientMap&&(D.gradientMap.value=S.gradientMap)}(D,S)):S.isMeshPhongMaterial?(a(D,S),function y(D,S){D.specular.value.copy(S.specular),D.shininess.value=Math.max(S.shininess,1e-4)}(D,S)):S.isMeshStandardMaterial?(a(D,S),function M(D,S){D.metalness.value=S.metalness,S.metalnessMap&&(D.metalnessMap.value=S.metalnessMap,t(S.metalnessMap,D.metalnessMapTransform)),D.roughness.value=S.roughness,S.roughnessMap&&(D.roughnessMap.value=S.roughnessMap,t(S.roughnessMap,D.roughnessMapTransform)),e.get(S).envMap&&(D.envMapIntensity.value=S.envMapIntensity)}(D,S),S.isMeshPhysicalMaterial&&function E(D,S,U){D.ior.value=S.ior,S.sheen>0&&(D.sheenColor.value.copy(S.sheenColor).multiplyScalar(S.sheen),D.sheenRoughness.value=S.sheenRoughness,S.sheenColorMap&&(D.sheenColorMap.value=S.sheenColorMap,t(S.sheenColorMap,D.sheenColorMapTransform)),S.sheenRoughnessMap&&(D.sheenRoughnessMap.value=S.sheenRoughnessMap,t(S.sheenRoughnessMap,D.sheenRoughnessMapTransform))),S.clearcoat>0&&(D.clearcoat.value=S.clearcoat,D.clearcoatRoughness.value=S.clearcoatRoughness,S.clearcoatMap&&(D.clearcoatMap.value=S.clearcoatMap,t(S.clearcoatMap,D.clearcoatMapTransform)),S.clearcoatRoughnessMap&&(D.clearcoatRoughnessMap.value=S.clearcoatRoughnessMap,t(S.clearcoatRoughnessMap,D.clearcoatRoughnessMapTransform)),S.clearcoatNormalMap&&(D.clearcoatNormalMap.value=S.clearcoatNormalMap,t(S.clearcoatNormalMap,D.clearcoatNormalMapTransform),D.clearcoatNormalScale.value.copy(S.clearcoatNormalScale),1===S.side&&D.clearcoatNormalScale.value.negate())),S.iridescence>0&&(D.iridescence.value=S.iridescence,D.iridescenceIOR.value=S.iridescenceIOR,D.iridescenceThicknessMinimum.value=S.iridescenceThicknessRange[0],D.iridescenceThicknessMaximum.value=S.iridescenceThicknessRange[1],S.iridescenceMap&&(D.iridescenceMap.value=S.iridescenceMap,t(S.iridescenceMap,D.iridescenceMapTransform)),S.iridescenceThicknessMap&&(D.iridescenceThicknessMap.value=S.iridescenceThicknessMap,t(S.iridescenceThicknessMap,D.iridescenceThicknessMapTransform))),S.transmission>0&&(D.transmission.value=S.transmission,D.transmissionSamplerMap.value=U.texture,D.transmissionSamplerSize.value.set(U.width,U.height),S.transmissionMap&&(D.transmissionMap.value=S.transmissionMap,t(S.transmissionMap,D.transmissionMapTransform)),D.thickness.value=S.thickness,S.thicknessMap&&(D.thicknessMap.value=S.thicknessMap,t(S.thicknessMap,D.thicknessMapTransform)),D.attenuationDistance.value=S.attenuationDistance,D.attenuationColor.value.copy(S.attenuationColor)),S.anisotropy>0&&(D.anisotropyVector.value.set(S.anisotropy*Math.cos(S.anisotropyRotation),S.anisotropy*Math.sin(S.anisotropyRotation)),S.anisotropyMap&&(D.anisotropyMap.value=S.anisotropyMap,t(S.anisotropyMap,D.anisotropyMapTransform))),D.specularIntensity.value=S.specularIntensity,D.specularColor.value.copy(S.specularColor),S.specularColorMap&&(D.specularColorMap.value=S.specularColorMap,t(S.specularColorMap,D.specularColorMapTransform)),S.specularIntensityMap&&(D.specularIntensityMap.value=S.specularIntensityMap,t(S.specularIntensityMap,D.specularIntensityMapTransform))}(D,S,V)):S.isMeshMatcapMaterial?(a(D,S),function A(D,S){S.matcap&&(D.matcap.value=S.matcap)}(D,S)):S.isMeshDepthMaterial?a(D,S):S.isMeshDistanceMaterial?(a(D,S),function L(D,S){const U=e.get(S).light;D.referencePosition.value.setFromMatrixPosition(U.matrixWorld),D.nearDistance.value=U.shadow.camera.near,D.farDistance.value=U.shadow.camera.far}(D,S)):S.isMeshNormalMaterial?a(D,S):S.isLineBasicMaterial?(function u(D,S){D.diffuse.value.copy(S.color),D.opacity.value=S.opacity,S.map&&(D.map.value=S.map,t(S.map,D.mapTransform))}(D,S),S.isLineDashedMaterial&&function d(D,S){D.dashSize.value=S.dashSize,D.totalSize.value=S.dashSize+S.gapSize,D.scale.value=S.scale}(D,S)):S.isPointsMaterial?function p(D,S,U,N){D.diffuse.value.copy(S.color),D.opacity.value=S.opacity,D.size.value=S.size*U,D.scale.value=.5*N,S.map&&(D.map.value=S.map,t(S.map,D.uvTransform)),S.alphaMap&&(D.alphaMap.value=S.alphaMap,t(S.alphaMap,D.alphaMapTransform)),S.alphaTest>0&&(D.alphaTest.value=S.alphaTest)}(D,S,U,N):S.isSpriteMaterial?function m(D,S){D.diffuse.value.copy(S.color),D.opacity.value=S.opacity,D.rotation.value=S.rotation,S.map&&(D.map.value=S.map,t(S.map,D.mapTransform)),S.alphaMap&&(D.alphaMap.value=S.alphaMap,t(S.alphaMap,D.alphaMapTransform)),S.alphaTest>0&&(D.alphaTest.value=S.alphaTest)}(D,S):S.isShadowMaterial?(D.color.value.copy(S.color),D.opacity.value=S.opacity):S.isShaderMaterial&&(S.uniformsNeedUpdate=!1)}}}function P_(l,e,t,r){let s={},a={},u=[];const d=t.isWebGL2?l.getParameter(l.MAX_UNIFORM_BUFFER_BINDINGS):0;function E(U,N,V){const j=U.value;if(void 0===V[N]){if("number"==typeof j)V[N]=j;else{const q=Array.isArray(j)?j:[j],Q=[];for(let ae=0;ae<q.length;ae++)Q.push(q[ae].clone());V[N]=Q}return!0}if("number"==typeof j){if(V[N]!==j)return V[N]=j,!0}else{const q=Array.isArray(V[N])?V[N]:[V[N]],Q=Array.isArray(j)?j:[j];for(let ae=0;ae<q.length;ae++){const W=q[ae];if(!1===W.equals(Q[ae]))return W.copy(Q[ae]),!0}}return!1}function L(U){const N={boundary:0,storage:0};return"number"==typeof U?(N.boundary=4,N.storage=4):U.isVector2?(N.boundary=8,N.storage=8):U.isVector3||U.isColor?(N.boundary=16,N.storage=12):U.isVector4?(N.boundary=16,N.storage=16):U.isMatrix3?(N.boundary=48,N.storage=48):U.isMatrix4?(N.boundary=64,N.storage=64):U.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",U),N}function D(U){const N=U.target;N.removeEventListener("dispose",D);const V=u.indexOf(N.__bindingPointIndex);u.splice(V,1),l.deleteBuffer(s[N.id]),delete s[N.id],delete a[N.id]}return{bind:function p(U,N){r.uniformBlockBinding(U,N.program)},update:function m(U,N){let V=s[U.id];void 0===V&&(function A(U){const N=U.uniforms;let V=0;let q=0;for(let Q=0,ae=N.length;Q<ae;Q++){const W=N[Q],Y={boundary:0,storage:0},Ce=Array.isArray(W.value)?W.value:[W.value];for(let qe=0,ye=Ce.length;qe<ye;qe++){const Se=L(Ce[qe]);Y.boundary+=Se.boundary,Y.storage+=Se.storage}if(W.__data=new Float32Array(Y.storage/Float32Array.BYTES_PER_ELEMENT),W.__offset=V,Q>0){q=V%16;const qe=16-q;0!==q&&qe-Y.boundary<0&&(V+=16-q,W.__offset=V)}V+=Y.storage}q=V%16,q>0&&(V+=16-q),U.__size=V,U.__cache={}}(U),V=function y(U){const N=function x(){for(let U=0;U<d;U++)if(-1===u.indexOf(U))return u.push(U),U;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();U.__bindingPointIndex=N;const V=l.createBuffer(),j=U.__size,q=U.usage;return l.bindBuffer(l.UNIFORM_BUFFER,V),l.bufferData(l.UNIFORM_BUFFER,j,q),l.bindBuffer(l.UNIFORM_BUFFER,null),l.bindBufferBase(l.UNIFORM_BUFFER,N,V),V}(U),s[U.id]=V,U.addEventListener("dispose",D)),r.updateUBOMapping(U,N.program);const q=e.render.frame;a[U.id]!==q&&(function M(U){const V=U.uniforms,j=U.__cache;l.bindBuffer(l.UNIFORM_BUFFER,s[U.id]);for(let q=0,Q=V.length;q<Q;q++){const ae=V[q];if(!0===E(ae,q,j)){const W=ae.__offset,Y=Array.isArray(ae.value)?ae.value:[ae.value];let Ce=0;for(let qe=0;qe<Y.length;qe++){const ye=Y[qe],xe=L(ye);"number"==typeof ye?(ae.__data[0]=ye,l.bufferSubData(l.UNIFORM_BUFFER,W+Ce,ae.__data)):ye.isMatrix3?(ae.__data[0]=ye.elements[0],ae.__data[1]=ye.elements[1],ae.__data[2]=ye.elements[2],ae.__data[3]=ye.elements[0],ae.__data[4]=ye.elements[3],ae.__data[5]=ye.elements[4],ae.__data[6]=ye.elements[5],ae.__data[7]=ye.elements[0],ae.__data[8]=ye.elements[6],ae.__data[9]=ye.elements[7],ae.__data[10]=ye.elements[8],ae.__data[11]=ye.elements[0]):(ye.toArray(ae.__data,Ce),Ce+=xe.storage/Float32Array.BYTES_PER_ELEMENT)}l.bufferSubData(l.UNIFORM_BUFFER,W,ae.__data)}}l.bindBuffer(l.UNIFORM_BUFFER,null)}(U),a[U.id]=q)},dispose:function S(){for(const U in s)l.deleteBuffer(s[U]);u=[],s={},a={}}}}function fy(){const l=ol("canvas");return l.style.display="block",l}class py{constructor(e={}){const{canvas:t=fy(),context:r=null,depth:s=!0,stencil:a=!0,alpha:u=!1,antialias:d=!1,premultipliedAlpha:p=!0,preserveDrawingBuffer:m=!1,powerPreference:y="default",failIfMajorPerformanceCaveat:x=!1}=e;let M;this.isWebGLRenderer=!0,M=null!==r?r.getContextAttributes().alpha:u;const E=new Uint32Array(4),A=new Int32Array(4);let L=null,D=null;const S=[],U=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputColorSpace=Ln,this._useLegacyLights=!1,this.toneMapping=0,this.toneMappingExposure=1;const N=this;let V=!1,j=0,q=0,Q=null,ae=-1,W=null;const Y=new vi,Ce=new vi;let qe=null;const ye=new Pt(0);let xe=0,Se=t.width,Xe=t.height,Oe=1,ze=null,Je=null;const Qe=new vi(0,0,Se,Xe),me=new vi(0,0,Se,Xe);let Be=!1;const Tt=new _d;let Ct=!1,Rt=!1,un=null;const Nt=new Nn,Jt=new je,ui=new J,Fi={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Mn(){return null===Q?Oe:1}let He,dt,Ze,rn,Ut,Vt,In,Jn,Pi,te,$,Me,ct,tt,at,Qt,mt,we,ln,hn,dn,Yt,Xt,Vn,oe=r;function yt(Z,ge){for(let Pe=0;Pe<Z.length;Pe++){const Re=t.getContext(Z[Pe],ge);if(null!==Re)return Re}return null}try{const Z={alpha:!0,depth:s,stencil:a,antialias:d,premultipliedAlpha:p,preserveDrawingBuffer:m,powerPreference:y,failIfMajorPerformanceCaveat:x};if("setAttribute"in t&&t.setAttribute("data-engine","three.js r155"),t.addEventListener("webglcontextlost",At,!1),t.addEventListener("webglcontextrestored",De,!1),t.addEventListener("webglcontextcreationerror",vt,!1),null===oe){const ge=["webgl2","webgl","experimental-webgl"];if(!0===N.isWebGL1Renderer&&ge.shift(),oe=yt(ge,Z),null===oe)throw yt(ge)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}"undefined"!=typeof WebGLRenderingContext&&oe instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),void 0===oe.getShaderPrecisionFormat&&(oe.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Z){throw console.error("THREE.WebGLRenderer: "+Z.message),Z}function Ti(){He=new Kv(oe),dt=new Pg(oe,He,e),He.init(dt),Yt=new A_(oe,He,dt),Ze=new uy(oe,He,dt),rn=new _p(oe),Ut=new kp,Vt=new hy(oe,He,Ze,Ut,dt,Yt,rn),In=new Yv(N),Jn=new vp(N),Pi=new lg(oe,dt),Xt=new Xv(oe,He,Pi,dt),te=new Jv(oe,Pi,rn,Xt),$=new Bg(oe,te,Pi,rn),ln=new Mp(oe,dt,Vt),Qt=new qv(Ut),Me=new Ws(N,In,Jn,He,dt,Xt,Qt),ct=new dy(N,Ut),tt=new Vc,at=new oy(He,dt),we=new KM(N,In,Jn,Ze,$,M,p),mt=new cy(N,$,dt),Vn=new P_(oe,rn,dt,Ze),hn=new fp(oe,He,rn,dt),dn=new Cd(oe,He,rn,dt),rn.programs=Me.programs,N.capabilities=dt,N.extensions=He,N.properties=Ut,N.renderLists=tt,N.shadowMap=mt,N.state=Ze,N.info=rn}Ti();const ce=new I_(N,oe);function At(Z){Z.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),V=!0}function De(){console.log("THREE.WebGLRenderer: Context Restored."),V=!1;const Z=rn.autoReset,ge=mt.enabled,Pe=mt.autoUpdate,de=mt.needsUpdate,Re=mt.type;Ti(),rn.autoReset=Z,mt.enabled=ge,mt.autoUpdate=Pe,mt.needsUpdate=de,mt.type=Re}function vt(Z){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",Z.statusMessage)}function Dt(Z){const ge=Z.target;ge.removeEventListener("dispose",Dt),function ai(Z){(function Ui(Z){const ge=Ut.get(Z).programs;void 0!==ge&&(ge.forEach(function(Pe){Me.releaseProgram(Pe)}),Z.isShaderMaterial&&Me.releaseShaderCache(Z))})(Z),Ut.remove(Z)}(ge)}this.xr=ce,this.getContext=function(){return oe},this.getContextAttributes=function(){return oe.getContextAttributes()},this.forceContextLoss=function(){const Z=He.get("WEBGL_lose_context");Z&&Z.loseContext()},this.forceContextRestore=function(){const Z=He.get("WEBGL_lose_context");Z&&Z.restoreContext()},this.getPixelRatio=function(){return Oe},this.setPixelRatio=function(Z){void 0!==Z&&(Oe=Z,this.setSize(Se,Xe,!1))},this.getSize=function(Z){return Z.set(Se,Xe)},this.setSize=function(Z,ge,Pe=!0){ce.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(Se=Z,Xe=ge,t.width=Math.floor(Z*Oe),t.height=Math.floor(ge*Oe),!0===Pe&&(t.style.width=Z+"px",t.style.height=ge+"px"),this.setViewport(0,0,Z,ge))},this.getDrawingBufferSize=function(Z){return Z.set(Se*Oe,Xe*Oe).floor()},this.setDrawingBufferSize=function(Z,ge,Pe){Se=Z,Xe=ge,Oe=Pe,t.width=Math.floor(Z*Pe),t.height=Math.floor(ge*Pe),this.setViewport(0,0,Z,ge)},this.getCurrentViewport=function(Z){return Z.copy(Y)},this.getViewport=function(Z){return Z.copy(Qe)},this.setViewport=function(Z,ge,Pe,de){Z.isVector4?Qe.set(Z.x,Z.y,Z.z,Z.w):Qe.set(Z,ge,Pe,de),Ze.viewport(Y.copy(Qe).multiplyScalar(Oe).floor())},this.getScissor=function(Z){return Z.copy(me)},this.setScissor=function(Z,ge,Pe,de){Z.isVector4?me.set(Z.x,Z.y,Z.z,Z.w):me.set(Z,ge,Pe,de),Ze.scissor(Ce.copy(me).multiplyScalar(Oe).floor())},this.getScissorTest=function(){return Be},this.setScissorTest=function(Z){Ze.setScissorTest(Be=Z)},this.setOpaqueSort=function(Z){ze=Z},this.setTransparentSort=function(Z){Je=Z},this.getClearColor=function(Z){return Z.copy(we.getClearColor())},this.setClearColor=function(){we.setClearColor.apply(we,arguments)},this.getClearAlpha=function(){return we.getClearAlpha()},this.setClearAlpha=function(){we.setClearAlpha.apply(we,arguments)},this.clear=function(Z=!0,ge=!0,Pe=!0){let de=0;if(Z){let Re=!1;if(null!==Q){const Bt=Q.texture.format;Re=1033===Bt||1031===Bt||1029===Bt}if(Re){const Bt=Q.texture.type,vn=Bt===wo||Bt===Fe||1012===Bt||Bt===wr||1017===Bt||1018===Bt,bn=we.getClearColor(),Sn=we.getClearAlpha(),Zn=bn.r,En=bn.g,Hn=bn.b;vn?(E[0]=Zn,E[1]=En,E[2]=Hn,E[3]=Sn,oe.clearBufferuiv(oe.COLOR,0,E)):(A[0]=Zn,A[1]=En,A[2]=Hn,A[3]=Sn,oe.clearBufferiv(oe.COLOR,0,A))}else de|=oe.COLOR_BUFFER_BIT}ge&&(de|=oe.DEPTH_BUFFER_BIT),Pe&&(de|=oe.STENCIL_BUFFER_BIT),oe.clear(de)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",At,!1),t.removeEventListener("webglcontextrestored",De,!1),t.removeEventListener("webglcontextcreationerror",vt,!1),tt.dispose(),at.dispose(),Ut.dispose(),In.dispose(),Jn.dispose(),$.dispose(),Xt.dispose(),Vn.dispose(),Me.dispose(),ce.dispose(),ce.removeEventListener("sessionstart",Ai),ce.removeEventListener("sessionend",Ho),un&&(un.dispose(),un=null),Kr.stop()},this.renderBufferDirect=function(Z,ge,Pe,de,Re,Bt){null===ge&&(ge=Fi);const vn=Re.isMesh&&Re.matrixWorld.determinant()<0,bn=function Bb(Z,ge,Pe,de,Re){!0!==ge.isScene&&(ge=Fi),Vt.resetTextureUnits();const Bt=ge.fog,bn=null===Q?N.outputColorSpace:!0===Q.isXRRenderTarget?Q.texture.colorSpace:Sr,Sn=(de.isMeshStandardMaterial?Jn:In).get(de.envMap||(de.isMeshStandardMaterial?ge.environment:null)),Zn=!0===de.vertexColors&&!!Pe.attributes.color&&4===Pe.attributes.color.itemSize,En=!!Pe.attributes.tangent&&(!!de.normalMap||de.anisotropy>0),Hn=!!Pe.morphAttributes.position,qi=!!Pe.morphAttributes.normal,rr=!!Pe.morphAttributes.color;let fs=0;de.toneMapped&&(null===Q||!0===Q.isXRRenderTarget)&&(fs=N.toneMapping);const va=Pe.morphAttributes.position||Pe.morphAttributes.normal||Pe.morphAttributes.color,mr=void 0!==va?va.length:0,ei=Ut.get(de),S0=D.state.lights;!0!==Ct||!0!==Rt&&Z===W||Qt.setState(de,Z,Z===W&&de.id===ae);let ur=!1;de.version===ei.__version?(ei.needsLights&&ei.lightsStateVersion!==S0.state.version||ei.outputColorSpace!==bn||Re.isInstancedMesh&&!1===ei.instancing||!Re.isInstancedMesh&&!0===ei.instancing||Re.isSkinnedMesh&&!1===ei.skinning||!Re.isSkinnedMesh&&!0===ei.skinning||Re.isInstancedMesh&&!0===ei.instancingColor&&null===Re.instanceColor||Re.isInstancedMesh&&!1===ei.instancingColor&&null!==Re.instanceColor||ei.envMap!==Sn||!0===de.fog&&ei.fog!==Bt||void 0!==ei.numClippingPlanes&&(ei.numClippingPlanes!==Qt.numPlanes||ei.numIntersection!==Qt.numIntersection)||ei.vertexAlphas!==Zn||ei.vertexTangents!==En||ei.morphTargets!==Hn||ei.morphNormals!==qi||ei.morphColors!==rr||ei.toneMapping!==fs||!0===dt.isWebGL2&&ei.morphTargetsCount!==mr)&&(ur=!0):(ur=!0,ei.__version=de.version);let Wl=ei.currentProgram;!0===ur&&(Wl=Rm(de,ge,Re));let T0=!1,Ef=!1,Im=!1;const Rr=Wl.getUniforms(),$l=ei.uniforms;if(Ze.useProgram(Wl.program)&&(T0=!0,Ef=!0,Im=!0),de.id!==ae&&(ae=de.id,Ef=!0),T0||W!==Z){if(Rr.setValue(oe,"projectionMatrix",Z.projectionMatrix),dt.logarithmicDepthBuffer&&Rr.setValue(oe,"logDepthBufFC",2/(Math.log(Z.far+1)/Math.LN2)),W!==Z&&(W=Z,Ef=!0,Im=!0),de.isShaderMaterial||de.isMeshPhongMaterial||de.isMeshToonMaterial||de.isMeshStandardMaterial||de.envMap){const Ds=Rr.map.cameraPosition;void 0!==Ds&&Ds.setValue(oe,ui.setFromMatrixPosition(Z.matrixWorld))}(de.isMeshPhongMaterial||de.isMeshToonMaterial||de.isMeshLambertMaterial||de.isMeshBasicMaterial||de.isMeshStandardMaterial||de.isShaderMaterial)&&Rr.setValue(oe,"isOrthographic",!0===Z.isOrthographicCamera),(de.isMeshPhongMaterial||de.isMeshToonMaterial||de.isMeshLambertMaterial||de.isMeshBasicMaterial||de.isMeshStandardMaterial||de.isShaderMaterial||de.isShadowMaterial||Re.isSkinnedMesh)&&Rr.setValue(oe,"viewMatrix",Z.matrixWorldInverse)}if(Re.isSkinnedMesh){Rr.setOptional(oe,Re,"bindMatrix"),Rr.setOptional(oe,Re,"bindMatrixInverse");const Ds=Re.skeleton;Ds&&(dt.floatVertexTextures?(null===Ds.boneTexture&&Ds.computeBoneTexture(),Rr.setValue(oe,"boneTexture",Ds.boneTexture,Vt),Rr.setValue(oe,"boneTextureSize",Ds.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const Cs=Pe.morphAttributes;if((void 0!==Cs.position||void 0!==Cs.normal||void 0!==Cs.color&&!0===dt.isWebGL2)&&ln.update(Re,Pe,Wl),(Ef||ei.receiveShadow!==Re.receiveShadow)&&(ei.receiveShadow=Re.receiveShadow,Rr.setValue(oe,"receiveShadow",Re.receiveShadow)),de.isMeshGouraudMaterial&&null!==de.envMap&&($l.envMap.value=Sn,$l.flipEnvMap.value=Sn.isCubeTexture&&!1===Sn.isRenderTargetTexture?-1:1),Ef&&(Rr.setValue(oe,"toneMappingExposure",N.toneMappingExposure),ei.needsLights&&function Hb(Z,ge){Z.ambientLightColor.needsUpdate=ge,Z.lightProbe.needsUpdate=ge,Z.directionalLights.needsUpdate=ge,Z.directionalLightShadows.needsUpdate=ge,Z.pointLights.needsUpdate=ge,Z.pointLightShadows.needsUpdate=ge,Z.spotLights.needsUpdate=ge,Z.spotLightShadows.needsUpdate=ge,Z.rectAreaLights.needsUpdate=ge,Z.hemisphereLights.needsUpdate=ge}($l,Im),Bt&&!0===de.fog&&ct.refreshFogUniforms($l,Bt),ct.refreshMaterialUniforms($l,de,Oe,Xe,un),Np.upload(oe,ei.uniformsList,$l,Vt)),de.isShaderMaterial&&!0===de.uniformsNeedUpdate&&(Np.upload(oe,ei.uniformsList,$l,Vt),de.uniformsNeedUpdate=!1),de.isSpriteMaterial&&Rr.setValue(oe,"center",Re.center),Rr.setValue(oe,"modelViewMatrix",Re.modelViewMatrix),Rr.setValue(oe,"normalMatrix",Re.normalMatrix),Rr.setValue(oe,"modelMatrix",Re.matrixWorld),de.isShaderMaterial||de.isRawShaderMaterial){const Ds=de.uniformsGroups;for(let Oh=0,$x=Ds.length;Oh<$x;Oh++)if(dt.isWebGL2){const A0=Ds[Oh];Vn.update(A0,Wl),Vn.bind(A0,Wl)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Wl}(Z,ge,Pe,de,Re);Ze.setMaterial(de,vn);let Sn=Pe.index,Zn=1;if(!0===de.wireframe){if(Sn=te.getWireframeAttribute(Pe),void 0===Sn)return;Zn=2}const En=Pe.drawRange,Hn=Pe.attributes.position;let qi=En.start*Zn,rr=(En.start+En.count)*Zn;null!==Bt&&(qi=Math.max(qi,Bt.start*Zn),rr=Math.min(rr,(Bt.start+Bt.count)*Zn)),null!==Sn?(qi=Math.max(qi,0),rr=Math.min(rr,Sn.count)):null!=Hn&&(qi=Math.max(qi,0),rr=Math.min(rr,Hn.count));const fs=rr-qi;if(fs<0||fs===1/0)return;Xt.setup(Re,de,bn,Pe,Sn);let va,mr=hn;if(null!==Sn&&(va=Pi.get(Sn),mr=dn,mr.setIndex(va)),Re.isMesh)!0===de.wireframe?(Ze.setLineWidth(de.wireframeLinewidth*Mn()),mr.setMode(oe.LINES)):mr.setMode(oe.TRIANGLES);else if(Re.isLine){let ei=de.linewidth;void 0===ei&&(ei=1),Ze.setLineWidth(ei*Mn()),mr.setMode(Re.isLineSegments?oe.LINES:Re.isLineLoop?oe.LINE_LOOP:oe.LINE_STRIP)}else Re.isPoints?mr.setMode(oe.POINTS):Re.isSprite&&mr.setMode(oe.TRIANGLES);if(Re.isInstancedMesh)mr.renderInstances(qi,fs,Re.count);else if(Pe.isInstancedBufferGeometry){const S0=Math.min(Pe.instanceCount,void 0!==Pe._maxInstanceCount?Pe._maxInstanceCount:1/0);mr.renderInstances(qi,fs,S0)}else mr.render(qi,fs)},this.compile=function(Z,ge){function Pe(de,Re,Bt){!0===de.transparent&&2===de.side&&!1===de.forceSinglePass?(de.side=1,de.needsUpdate=!0,Rm(de,Re,Bt),de.side=0,de.needsUpdate=!0,Rm(de,Re,Bt),de.side=2):Rm(de,Re,Bt)}D=at.get(Z),D.init(),U.push(D),Z.traverseVisible(function(de){de.isLight&&de.layers.test(ge.layers)&&(D.pushLight(de),de.castShadow&&D.pushShadow(de))}),D.setupLights(N._useLegacyLights),Z.traverse(function(de){const Re=de.material;if(Re)if(Array.isArray(Re))for(let Bt=0;Bt<Re.length;Bt++)Pe(Re[Bt],Z,de);else Pe(Re,Z,de)}),U.pop(),D=null};let ir=null;function Ai(){Kr.stop()}function Ho(){Kr.start()}const Kr=new Xu;function Vx(Z,ge,Pe,de){if(!1===Z.visible)return;if(Z.layers.test(ge.layers))if(Z.isGroup)Pe=Z.renderOrder;else if(Z.isLOD)!0===Z.autoUpdate&&Z.update(ge);else if(Z.isLight)D.pushLight(Z),Z.castShadow&&D.pushShadow(Z);else if(Z.isSprite){if(!Z.frustumCulled||Tt.intersectsSprite(Z)){de&&ui.setFromMatrixPosition(Z.matrixWorld).applyMatrix4(Nt);const vn=$.update(Z),bn=Z.material;bn.visible&&L.push(Z,vn,bn,Pe,ui.z,null)}}else if((Z.isMesh||Z.isLine||Z.isPoints)&&(!Z.frustumCulled||Tt.intersectsObject(Z))){const vn=$.update(Z),bn=Z.material;if(de&&(void 0!==Z.boundingSphere?(null===Z.boundingSphere&&Z.computeBoundingSphere(),ui.copy(Z.boundingSphere.center)):(null===vn.boundingSphere&&vn.computeBoundingSphere(),ui.copy(vn.boundingSphere.center)),ui.applyMatrix4(Z.matrixWorld).applyMatrix4(Nt)),Array.isArray(bn)){const Sn=vn.groups;for(let Zn=0,En=Sn.length;Zn<En;Zn++){const Hn=Sn[Zn],qi=bn[Hn.materialIndex];qi&&qi.visible&&L.push(Z,vn,qi,Pe,ui.z,Hn)}}else bn.visible&&L.push(Z,vn,bn,Pe,ui.z,null)}const Bt=Z.children;for(let vn=0,bn=Bt.length;vn<bn;vn++)Vx(Bt[vn],ge,Pe,de)}function Cm(Z,ge,Pe,de){const Re=Z.opaque,Bt=Z.transmissive,vn=Z.transparent;D.setupLightsView(Pe),!0===Ct&&Qt.setGlobalState(N.clippingPlanes,Pe),Bt.length>0&&function kb(Z,ge,Pe,de){const Re=dt.isWebGL2;null===un&&(un=new cl(1,1,{generateMipmaps:!0,type:He.has("EXT_color_buffer_half_float")?Ja:wo,minFilter:wa,samples:Re?4:0})),N.getDrawingBufferSize(Jt),Re?un.setSize(Jt.x,Jt.y):un.setSize(kr(Jt.x),kr(Jt.y));const Bt=N.getRenderTarget();N.setRenderTarget(un),N.getClearColor(ye),xe=N.getClearAlpha(),xe<1&&N.setClearColor(16777215,.5),N.clear();const vn=N.toneMapping;N.toneMapping=0,Dm(Z,Pe,de),Vt.updateMultisampleRenderTarget(un),Vt.updateRenderTargetMipmap(un);let bn=!1;for(let Sn=0,Zn=ge.length;Sn<Zn;Sn++){const En=ge[Sn],Hn=En.object,qi=En.geometry,rr=En.material,fs=En.group;if(2===rr.side&&Hn.layers.test(de.layers)){const va=rr.side;rr.side=1,rr.needsUpdate=!0,Gx(Hn,Pe,de,qi,rr,fs),rr.side=va,rr.needsUpdate=!0,bn=!0}}!0===bn&&(Vt.updateMultisampleRenderTarget(un),Vt.updateRenderTargetMipmap(un)),N.setRenderTarget(Bt),N.setClearColor(ye,xe),N.toneMapping=vn}(Re,Bt,ge,Pe),de&&Ze.viewport(Y.copy(de)),Re.length>0&&Dm(Re,ge,Pe),Bt.length>0&&Dm(Bt,ge,Pe),vn.length>0&&Dm(vn,ge,Pe),Ze.buffers.depth.setTest(!0),Ze.buffers.depth.setMask(!0),Ze.buffers.color.setMask(!0),Ze.setPolygonOffset(!1)}function Dm(Z,ge,Pe){const de=!0===ge.isScene?ge.overrideMaterial:null;for(let Re=0,Bt=Z.length;Re<Bt;Re++){const vn=Z[Re],bn=vn.object,Sn=vn.geometry,Zn=null===de?vn.material:de,En=vn.group;bn.layers.test(Pe.layers)&&Gx(bn,ge,Pe,Sn,Zn,En)}}function Gx(Z,ge,Pe,de,Re,Bt){Z.onBeforeRender(N,ge,Pe,de,Re,Bt),Z.modelViewMatrix.multiplyMatrices(Pe.matrixWorldInverse,Z.matrixWorld),Z.normalMatrix.getNormalMatrix(Z.modelViewMatrix),Re.onBeforeRender(N,ge,Pe,de,Z,Bt),!0===Re.transparent&&2===Re.side&&!1===Re.forceSinglePass?(Re.side=1,Re.needsUpdate=!0,N.renderBufferDirect(Pe,ge,de,Re,Z,Bt),Re.side=0,Re.needsUpdate=!0,N.renderBufferDirect(Pe,ge,de,Re,Z,Bt),Re.side=2):N.renderBufferDirect(Pe,ge,de,Re,Z,Bt),Z.onAfterRender(N,ge,Pe,de,Re,Bt)}function Rm(Z,ge,Pe){!0!==ge.isScene&&(ge=Fi);const de=Ut.get(Z),Re=D.state.lights,vn=Re.state.version,bn=Me.getParameters(Z,Re.state,D.state.shadowsArray,ge,Pe),Sn=Me.getProgramCacheKey(bn);let Zn=de.programs;de.environment=Z.isMeshStandardMaterial?ge.environment:null,de.fog=ge.fog,de.envMap=(Z.isMeshStandardMaterial?Jn:In).get(Z.envMap||de.environment),void 0===Zn&&(Z.addEventListener("dispose",Dt),Zn=new Map,de.programs=Zn);let En=Zn.get(Sn);if(void 0!==En){if(de.currentProgram===En&&de.lightsStateVersion===vn)return Wx(Z,bn),En}else bn.uniforms=Me.getUniforms(Z),Z.onBuild(Pe,bn,N),Z.onBeforeCompile(bn,N),En=Me.acquireProgram(bn,Sn),Zn.set(Sn,En),de.uniforms=bn.uniforms;const Hn=de.uniforms;(!Z.isShaderMaterial&&!Z.isRawShaderMaterial||!0===Z.clipping)&&(Hn.clippingPlanes=Qt.uniform),Wx(Z,bn),de.needsLights=function zb(Z){return Z.isMeshLambertMaterial||Z.isMeshToonMaterial||Z.isMeshPhongMaterial||Z.isMeshStandardMaterial||Z.isShadowMaterial||Z.isShaderMaterial&&!0===Z.lights}(Z),de.lightsStateVersion=vn,de.needsLights&&(Hn.ambientLightColor.value=Re.state.ambient,Hn.lightProbe.value=Re.state.probe,Hn.directionalLights.value=Re.state.directional,Hn.directionalLightShadows.value=Re.state.directionalShadow,Hn.spotLights.value=Re.state.spot,Hn.spotLightShadows.value=Re.state.spotShadow,Hn.rectAreaLights.value=Re.state.rectArea,Hn.ltc_1.value=Re.state.rectAreaLTC1,Hn.ltc_2.value=Re.state.rectAreaLTC2,Hn.pointLights.value=Re.state.point,Hn.pointLightShadows.value=Re.state.pointShadow,Hn.hemisphereLights.value=Re.state.hemi,Hn.directionalShadowMap.value=Re.state.directionalShadowMap,Hn.directionalShadowMatrix.value=Re.state.directionalShadowMatrix,Hn.spotShadowMap.value=Re.state.spotShadowMap,Hn.spotLightMatrix.value=Re.state.spotLightMatrix,Hn.spotLightMap.value=Re.state.spotLightMap,Hn.pointShadowMap.value=Re.state.pointShadowMap,Hn.pointShadowMatrix.value=Re.state.pointShadowMatrix);const qi=En.getUniforms(),rr=Np.seqWithValue(qi.seq,Hn);return de.currentProgram=En,de.uniformsList=rr,En}function Wx(Z,ge){const Pe=Ut.get(Z);Pe.outputColorSpace=ge.outputColorSpace,Pe.instancing=ge.instancing,Pe.instancingColor=ge.instancingColor,Pe.skinning=ge.skinning,Pe.morphTargets=ge.morphTargets,Pe.morphNormals=ge.morphNormals,Pe.morphColors=ge.morphColors,Pe.morphTargetsCount=ge.morphTargetsCount,Pe.numClippingPlanes=ge.numClippingPlanes,Pe.numIntersection=ge.numClipIntersection,Pe.vertexAlphas=ge.vertexAlphas,Pe.vertexTangents=ge.vertexTangents,Pe.toneMapping=ge.toneMapping}Kr.setAnimationLoop(function ya(Z){ir&&ir(Z)}),"undefined"!=typeof self&&Kr.setContext(self),this.setAnimationLoop=function(Z){ir=Z,ce.setAnimationLoop(Z),null===Z?Kr.stop():Kr.start()},ce.addEventListener("sessionstart",Ai),ce.addEventListener("sessionend",Ho),this.render=function(Z,ge){if(void 0===ge||!0===ge.isCamera){if(!0!==V){if(!0===Z.matrixWorldAutoUpdate&&Z.updateMatrixWorld(),null===ge.parent&&!0===ge.matrixWorldAutoUpdate&&ge.updateMatrixWorld(),!0===ce.enabled&&!0===ce.isPresenting&&(!0===ce.cameraAutoUpdate&&ce.updateCamera(ge),ge=ce.getCamera()),!0===Z.isScene&&Z.onBeforeRender(N,Z,ge,Q),D=at.get(Z,U.length),D.init(),U.push(D),Nt.multiplyMatrices(ge.projectionMatrix,ge.matrixWorldInverse),Tt.setFromProjectionMatrix(Nt),Rt=this.localClippingEnabled,Ct=Qt.init(this.clippingPlanes,Rt),L=tt.get(Z,S.length),L.init(),S.push(L),Vx(Z,ge,0,N.sortObjects),L.finish(),!0===N.sortObjects&&L.sort(ze,Je),this.info.render.frame++,!0===Ct&&Qt.beginShadows(),mt.render(D.state.shadowsArray,Z,ge),!0===Ct&&Qt.endShadows(),!0===this.info.autoReset&&this.info.reset(),we.render(L,Z),D.setupLights(N._useLegacyLights),ge.isArrayCamera){const de=ge.cameras;for(let Re=0,Bt=de.length;Re<Bt;Re++){const vn=de[Re];Cm(L,Z,vn,vn.viewport)}}else Cm(L,Z,ge);null!==Q&&(Vt.updateMultisampleRenderTarget(Q),Vt.updateRenderTargetMipmap(Q)),!0===Z.isScene&&Z.onAfterRender(N,Z,ge),Xt.resetDefaultState(),ae=-1,W=null,U.pop(),D=U.length>0?U[U.length-1]:null,S.pop(),L=S.length>0?S[S.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return j},this.getActiveMipmapLevel=function(){return q},this.getRenderTarget=function(){return Q},this.setRenderTargetTextures=function(Z,ge,Pe){Ut.get(Z.texture).__webglTexture=ge,Ut.get(Z.depthTexture).__webglTexture=Pe;const de=Ut.get(Z);de.__hasExternalTextures=!0,de.__hasExternalTextures&&(de.__autoAllocateDepthBuffer=void 0===Pe,de.__autoAllocateDepthBuffer||!0===He.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),de.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(Z,ge){const Pe=Ut.get(Z);Pe.__webglFramebuffer=ge,Pe.__useDefaultFramebuffer=void 0===ge},this.setRenderTarget=function(Z,ge=0,Pe=0){Q=Z,j=ge,q=Pe;let de=!0,Re=null,Bt=!1,vn=!1;if(Z){const Sn=Ut.get(Z);void 0!==Sn.__useDefaultFramebuffer?(Ze.bindFramebuffer(oe.FRAMEBUFFER,null),de=!1):void 0===Sn.__webglFramebuffer?Vt.setupRenderTarget(Z):Sn.__hasExternalTextures&&Vt.rebindTextures(Z,Ut.get(Z.texture).__webglTexture,Ut.get(Z.depthTexture).__webglTexture);const Zn=Z.texture;(Zn.isData3DTexture||Zn.isDataArrayTexture||Zn.isCompressedArrayTexture)&&(vn=!0);const En=Ut.get(Z).__webglFramebuffer;Z.isWebGLCubeRenderTarget?(Re=Array.isArray(En[ge])?En[ge][Pe]:En[ge],Bt=!0):Re=dt.isWebGL2&&Z.samples>0&&!1===Vt.useMultisampledRTT(Z)?Ut.get(Z).__webglMultisampledFramebuffer:Array.isArray(En)?En[Pe]:En,Y.copy(Z.viewport),Ce.copy(Z.scissor),qe=Z.scissorTest}else Y.copy(Qe).multiplyScalar(Oe).floor(),Ce.copy(me).multiplyScalar(Oe).floor(),qe=Be;if(Ze.bindFramebuffer(oe.FRAMEBUFFER,Re)&&dt.drawBuffers&&de&&Ze.drawBuffers(Z,Re),Ze.viewport(Y),Ze.scissor(Ce),Ze.setScissorTest(qe),Bt){const Sn=Ut.get(Z.texture);oe.framebufferTexture2D(oe.FRAMEBUFFER,oe.COLOR_ATTACHMENT0,oe.TEXTURE_CUBE_MAP_POSITIVE_X+ge,Sn.__webglTexture,Pe)}else if(vn){const Sn=Ut.get(Z.texture);oe.framebufferTextureLayer(oe.FRAMEBUFFER,oe.COLOR_ATTACHMENT0,Sn.__webglTexture,Pe||0,ge||0)}ae=-1},this.readRenderTargetPixels=function(Z,ge,Pe,de,Re,Bt,vn){if(!Z||!Z.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let bn=Ut.get(Z).__webglFramebuffer;if(Z.isWebGLCubeRenderTarget&&void 0!==vn&&(bn=bn[vn]),bn){Ze.bindFramebuffer(oe.FRAMEBUFFER,bn);try{const Sn=Z.texture,Zn=Sn.format,En=Sn.type;if(Zn!==Fr&&Yt.convert(Zn)!==oe.getParameter(oe.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const Hn=En===Ja&&(He.has("EXT_color_buffer_half_float")||dt.isWebGL2&&He.has("EXT_color_buffer_float"));if(!(En===wo||Yt.convert(En)===oe.getParameter(oe.IMPLEMENTATION_COLOR_READ_TYPE)||En===Dn&&(dt.isWebGL2||He.has("OES_texture_float")||He.has("WEBGL_color_buffer_float"))||Hn))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");ge>=0&&ge<=Z.width-de&&Pe>=0&&Pe<=Z.height-Re&&oe.readPixels(ge,Pe,de,Re,Yt.convert(Zn),Yt.convert(En),Bt)}finally{const Sn=null!==Q?Ut.get(Q).__webglFramebuffer:null;Ze.bindFramebuffer(oe.FRAMEBUFFER,Sn)}}},this.copyFramebufferToTexture=function(Z,ge,Pe=0){const de=Math.pow(2,-Pe),Re=Math.floor(ge.image.width*de),Bt=Math.floor(ge.image.height*de);Vt.setTexture2D(ge,0),oe.copyTexSubImage2D(oe.TEXTURE_2D,Pe,0,0,Z.x,Z.y,Re,Bt),Ze.unbindTexture()},this.copyTextureToTexture=function(Z,ge,Pe,de=0){const Re=ge.image.width,Bt=ge.image.height,vn=Yt.convert(Pe.format),bn=Yt.convert(Pe.type);Vt.setTexture2D(Pe,0),oe.pixelStorei(oe.UNPACK_FLIP_Y_WEBGL,Pe.flipY),oe.pixelStorei(oe.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Pe.premultiplyAlpha),oe.pixelStorei(oe.UNPACK_ALIGNMENT,Pe.unpackAlignment),ge.isDataTexture?oe.texSubImage2D(oe.TEXTURE_2D,de,Z.x,Z.y,Re,Bt,vn,bn,ge.image.data):ge.isCompressedTexture?oe.compressedTexSubImage2D(oe.TEXTURE_2D,de,Z.x,Z.y,ge.mipmaps[0].width,ge.mipmaps[0].height,vn,ge.mipmaps[0].data):oe.texSubImage2D(oe.TEXTURE_2D,de,Z.x,Z.y,vn,bn,ge.image),0===de&&Pe.generateMipmaps&&oe.generateMipmap(oe.TEXTURE_2D),Ze.unbindTexture()},this.copyTextureToTexture3D=function(Z,ge,Pe,de,Re=0){if(N.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const Bt=Z.max.x-Z.min.x+1,vn=Z.max.y-Z.min.y+1,bn=Z.max.z-Z.min.z+1,Sn=Yt.convert(de.format),Zn=Yt.convert(de.type);let En;if(de.isData3DTexture)Vt.setTexture3D(de,0),En=oe.TEXTURE_3D;else{if(!de.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");Vt.setTexture2DArray(de,0),En=oe.TEXTURE_2D_ARRAY}oe.pixelStorei(oe.UNPACK_FLIP_Y_WEBGL,de.flipY),oe.pixelStorei(oe.UNPACK_PREMULTIPLY_ALPHA_WEBGL,de.premultiplyAlpha),oe.pixelStorei(oe.UNPACK_ALIGNMENT,de.unpackAlignment);const Hn=oe.getParameter(oe.UNPACK_ROW_LENGTH),qi=oe.getParameter(oe.UNPACK_IMAGE_HEIGHT),rr=oe.getParameter(oe.UNPACK_SKIP_PIXELS),fs=oe.getParameter(oe.UNPACK_SKIP_ROWS),va=oe.getParameter(oe.UNPACK_SKIP_IMAGES),mr=Pe.isCompressedTexture?Pe.mipmaps[0]:Pe.image;oe.pixelStorei(oe.UNPACK_ROW_LENGTH,mr.width),oe.pixelStorei(oe.UNPACK_IMAGE_HEIGHT,mr.height),oe.pixelStorei(oe.UNPACK_SKIP_PIXELS,Z.min.x),oe.pixelStorei(oe.UNPACK_SKIP_ROWS,Z.min.y),oe.pixelStorei(oe.UNPACK_SKIP_IMAGES,Z.min.z),Pe.isDataTexture||Pe.isData3DTexture?oe.texSubImage3D(En,Re,ge.x,ge.y,ge.z,Bt,vn,bn,Sn,Zn,mr.data):Pe.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),oe.compressedTexSubImage3D(En,Re,ge.x,ge.y,ge.z,Bt,vn,bn,Sn,mr.data)):oe.texSubImage3D(En,Re,ge.x,ge.y,ge.z,Bt,vn,bn,Sn,Zn,mr),oe.pixelStorei(oe.UNPACK_ROW_LENGTH,Hn),oe.pixelStorei(oe.UNPACK_IMAGE_HEIGHT,qi),oe.pixelStorei(oe.UNPACK_SKIP_PIXELS,rr),oe.pixelStorei(oe.UNPACK_SKIP_ROWS,fs),oe.pixelStorei(oe.UNPACK_SKIP_IMAGES,va),0===Re&&de.generateMipmaps&&oe.generateMipmap(En),Ze.unbindTexture()},this.initTexture=function(Z){Z.isCubeTexture?Vt.setTextureCube(Z,0):Z.isData3DTexture?Vt.setTexture3D(Z,0):Z.isDataArrayTexture||Z.isCompressedArrayTexture?Vt.setTexture2DArray(Z,0):Vt.setTexture2D(Z,0),Ze.unbindTexture()},this.resetState=function(){j=0,q=0,Q=null,Ze.reset(),Xt.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Qo}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(e){console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===Ln?Jo:3e3}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===Jo?Ln:Sr}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}(class L_ extends py{}).prototype.isWebGL1Renderer=!0;class Nd extends Hs{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}}function Xs(l,e,t){return cf(l)?new l.constructor(l.subarray(e,void 0!==t?t:l.length)):l.slice(e,t)}function Ol(l,e,t){return!l||!t&&l.constructor===e?l:"number"==typeof e.BYTES_PER_ELEMENT?new e(l):Array.prototype.slice.call(l)}function cf(l){return ArrayBuffer.isView(l)&&!(l instanceof DataView)}class Ba{constructor(e,t,r,s){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==s?s:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let r=this._cachedIndex,s=t[r],a=t[r-1];e:{t:{let u;n:{i:if(!(e<s)){for(let d=r+2;;){if(void 0===s){if(e<a)break i;return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===d)break;if(a=s,s=t[++r],e<s)break t}u=t.length;break n}if(e>=a)break e;{const d=t[1];e<d&&(r=2,a=d);for(let p=r-2;;){if(void 0===a)return this._cachedIndex=0,this.copySampleValue_(0);if(r===p)break;if(s=a,a=t[--r-1],e>=a)break t}u=r,r=0}}for(;r<u;){const d=r+u>>>1;e<t[d]?u=d:r=d+1}if(s=t[r],a=t[r-1],void 0===a)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===s)return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,a,s)}return this.interpolate_(r,a,e,s)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,r=this.sampleValues,s=this.valueSize,a=e*s;for(let u=0;u!==s;++u)t[u]=r[a+u];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class ux extends Ba{constructor(e,t,r,s){super(e,t,r,s),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,r){const s=this.parameterPositions;let a=e-2,u=e+1,d=s[a],p=s[u];if(void 0===d)switch(this.getSettings_().endingStart){case 2401:a=e,d=2*t-r;break;case 2402:a=s.length-2,d=t+s[a]-s[a+1];break;default:a=e,d=r}if(void 0===p)switch(this.getSettings_().endingEnd){case 2401:u=e,p=2*r-t;break;case 2402:u=1,p=r+s[1]-s[0];break;default:u=e-1,p=t}const m=.5*(r-t),y=this.valueSize;this._weightPrev=m/(t-d),this._weightNext=m/(p-r),this._offsetPrev=a*y,this._offsetNext=u*y}interpolate_(e,t,r,s){const a=this.resultBuffer,u=this.sampleValues,d=this.valueSize,p=e*d,m=p-d,y=this._offsetPrev,x=this._offsetNext,M=this._weightPrev,E=this._weightNext,A=(r-t)/(s-t),L=A*A,D=L*A,S=-M*D+2*M*L-M*A,U=(1+M)*D+(-1.5-2*M)*L+(-.5+M)*A+1,N=(-1-E)*D+(1.5+E)*L+.5*A,V=E*D-E*L;for(let j=0;j!==d;++j)a[j]=S*u[y+j]+U*u[m+j]+N*u[p+j]+V*u[x+j];return a}}class Yy extends Ba{constructor(e,t,r,s){super(e,t,r,s)}interpolate_(e,t,r,s){const a=this.resultBuffer,u=this.sampleValues,d=this.valueSize,p=e*d,m=p-d,y=(r-t)/(s-t),x=1-y;for(let M=0;M!==d;++M)a[M]=u[m+M]*x+u[p+M]*y;return a}}class hx extends Ba{constructor(e,t,r,s){super(e,t,r,s)}interpolate_(e){return this.copySampleValue_(e-1)}}class As{constructor(e,t,r,s){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Ol(t,this.TimeBufferType),this.values=Ol(r,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let r;if(t.toJSON!==this.toJSON)r=t.toJSON(e);else{r={name:e.name,times:Ol(e.times,Array),values:Ol(e.values,Array)};const s=e.getInterpolation();s!==e.DefaultInterpolation&&(r.interpolation=s)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new hx(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Yy(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new ux(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case 2300:t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(r);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let r=0,s=t.length;r!==s;++r)t[r]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let r=0,s=t.length;r!==s;++r)t[r]*=e}return this}trim(e,t){const r=this.times,s=r.length;let a=0,u=s-1;for(;a!==s&&r[a]<e;)++a;for(;-1!==u&&r[u]>t;)--u;if(++u,0!==a||u!==s){a>=u&&(u=Math.max(u,1),a=u-1);const d=this.getValueSize();this.times=Xs(r,a,u),this.values=Xs(this.values,a*d,u*d)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const r=this.times,s=this.values,a=r.length;0===a&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let u=null;for(let d=0;d!==a;d++){const p=r[d];if("number"==typeof p&&isNaN(p)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,d,p),e=!1;break}if(null!==u&&u>p){console.error("THREE.KeyframeTrack: Out of order keys.",this,d,p,u),e=!1;break}u=p}if(void 0!==s&&cf(s))for(let d=0,p=s.length;d!==p;++d){const m=s[d];if(isNaN(m)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,d,m),e=!1;break}}return e}optimize(){const e=Xs(this.times),t=Xs(this.values),r=this.getValueSize(),s=2302===this.getInterpolation(),a=e.length-1;let u=1;for(let d=1;d<a;++d){let p=!1;const m=e[d];if(m!==e[d+1]&&(1!==d||m!==e[0]))if(s)p=!0;else{const x=d*r,M=x-r,E=x+r;for(let A=0;A!==r;++A){const L=t[x+A];if(L!==t[M+A]||L!==t[E+A]){p=!0;break}}}if(p){if(d!==u){e[u]=e[d];const x=d*r,M=u*r;for(let E=0;E!==r;++E)t[M+E]=t[x+E]}++u}}if(a>0){e[u]=e[a];for(let d=a*r,p=u*r,m=0;m!==r;++m)t[p+m]=t[d+m];++u}return u!==e.length?(this.times=Xs(e,0,u),this.values=Xs(t,0,u*r)):(this.times=e,this.values=t),this}clone(){const e=Xs(this.times,0),t=Xs(this.values,0),s=new(0,this.constructor)(this.name,e,t);return s.createInterpolant=this.createInterpolant,s}}As.prototype.TimeBufferType=Float32Array,As.prototype.ValueBufferType=Float32Array,As.prototype.DefaultInterpolation=2301;class Fl extends As{}Fl.prototype.ValueTypeName="bool",Fl.prototype.ValueBufferType=Array,Fl.prototype.DefaultInterpolation=2300,Fl.prototype.InterpolantFactoryMethodLinear=void 0,Fl.prototype.InterpolantFactoryMethodSmooth=void 0;(class mm extends As{}).prototype.ValueTypeName="color";(class Ch extends As{}).prototype.ValueTypeName="number";class dx extends Ba{constructor(e,t,r,s){super(e,t,r,s)}interpolate_(e,t,r,s){const a=this.resultBuffer,u=this.sampleValues,d=this.valueSize,p=(r-t)/(s-t);let m=e*d;for(let y=m+d;m!==y;m+=4)ls.slerpFlat(a,0,u,m-d,u,m,p);return a}}class da extends As{InterpolantFactoryMethodLinear(e){return new dx(this.times,this.values,this.getValueSize(),e)}}da.prototype.ValueTypeName="quaternion",da.prototype.DefaultInterpolation=2301,da.prototype.InterpolantFactoryMethodSmooth=void 0;class Bo extends As{}Bo.prototype.ValueTypeName="string",Bo.prototype.ValueBufferType=Array,Bo.prototype.DefaultInterpolation=2300,Bo.prototype.InterpolantFactoryMethodLinear=void 0,Bo.prototype.InterpolantFactoryMethodSmooth=void 0;(class df extends As{}).prototype.ValueTypeName="vector",Error;const Em="\\[\\]\\.:\\/",wx=new RegExp("["+Em+"]","g"),wm="[^"+Em+"]",m0="[^"+Em.replace("\\.","")+"]",gf=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",wm)+/(WCOD+)?/.source.replace("WCOD",m0)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",wm)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",wm)+"$"),Ax=["material","materials","bones","map"];class iu{constructor(e,t,r){const s=r||gi.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,s)}getValue(e,t){this.bind();const s=this._bindings[this._targetGroup.nCachedObjects_];void 0!==s&&s.getValue(e,t)}setValue(e,t){const r=this._bindings;for(let s=this._targetGroup.nCachedObjects_,a=r.length;s!==a;++s)r[s].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}}let gi=(()=>{class l{constructor(t,r,s){this.path=r,this.parsedPath=s||l.parseTrackName(r),this.node=l.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,r,s){return t&&t.isAnimationObjectGroup?new l.Composite(t,r,s):new l(t,r,s)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(wx,"")}static parseTrackName(t){const r=gf.exec(t);if(null===r)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const s={nodeName:r[2],objectName:r[3],objectIndex:r[4],propertyName:r[5],propertyIndex:r[6]},a=s.nodeName&&s.nodeName.lastIndexOf(".");if(void 0!==a&&-1!==a){const u=s.nodeName.substring(a+1);-1!==Ax.indexOf(u)&&(s.nodeName=s.nodeName.substring(0,a),s.objectName=u)}if(null===s.propertyName||0===s.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return s}static findNode(t,r){if(void 0===r||""===r||"."===r||-1===r||r===t.name||r===t.uuid)return t;if(t.skeleton){const s=t.skeleton.getBoneByName(r);if(void 0!==s)return s}if(t.children){const s=function(u){for(let d=0;d<u.length;d++){const p=u[d];if(p.name===r||p.uuid===r)return p;const m=s(p.children);if(m)return m}return null},a=s(t.children);if(a)return a}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,r){t[r]=this.targetObject[this.propertyName]}_getValue_array(t,r){const s=this.resolvedProperty;for(let a=0,u=s.length;a!==u;++a)t[r++]=s[a]}_getValue_arrayElement(t,r){t[r]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,r){this.resolvedProperty.toArray(t,r)}_setValue_direct(t,r){this.targetObject[this.propertyName]=t[r]}_setValue_direct_setNeedsUpdate(t,r){this.targetObject[this.propertyName]=t[r],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,r){this.targetObject[this.propertyName]=t[r],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,r){const s=this.resolvedProperty;for(let a=0,u=s.length;a!==u;++a)s[a]=t[r++]}_setValue_array_setNeedsUpdate(t,r){const s=this.resolvedProperty;for(let a=0,u=s.length;a!==u;++a)s[a]=t[r++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,r){const s=this.resolvedProperty;for(let a=0,u=s.length;a!==u;++a)s[a]=t[r++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,r){this.resolvedProperty[this.propertyIndex]=t[r]}_setValue_arrayElement_setNeedsUpdate(t,r){this.resolvedProperty[this.propertyIndex]=t[r],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,r){this.resolvedProperty[this.propertyIndex]=t[r],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,r){this.resolvedProperty.fromArray(t,r)}_setValue_fromArray_setNeedsUpdate(t,r){this.resolvedProperty.fromArray(t,r),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,r){this.resolvedProperty.fromArray(t,r),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,r){this.bind(),this.getValue(t,r)}_setValue_unbound(t,r){this.bind(),this.setValue(t,r)}bind(){let t=this.node;const r=this.parsedPath,s=r.objectName,a=r.propertyName;let u=r.propertyIndex;if(t||(t=l.findNode(this.rootNode,r.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(s){let y=r.objectIndex;switch(s){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let x=0;x<t.length;x++)if(t[x].name===y){y=x;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[s])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[s]}if(void 0!==y){if(void 0===t[y])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[y]}}const d=t[a];if(void 0===d)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+r.nodeName+"."+a+" but it wasn't found.",t);let p=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?p=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(p=this.Versioning.MatrixWorldNeedsUpdate);let m=this.BindingType.Direct;if(void 0!==u){if("morphTargetInfluences"===a){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[u]&&(u=t.morphTargetDictionary[u])}m=this.BindingType.ArrayElement,this.resolvedProperty=d,this.propertyIndex=u}else void 0!==d.fromArray&&void 0!==d.toArray?(m=this.BindingType.HasFromToArray,this.resolvedProperty=d):Array.isArray(d)?(m=this.BindingType.EntireArray,this.resolvedProperty=d):this.propertyName=a;this.getValue=this.GetterByBindingType[m],this.setValue=this.SetterByBindingTypeAndVersioning[m][p]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return l.Composite=iu,l})();gi.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},gi.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},gi.prototype.GetterByBindingType=[gi.prototype._getValue_direct,gi.prototype._getValue_array,gi.prototype._getValue_arrayElement,gi.prototype._getValue_toArray],gi.prototype.SetterByBindingTypeAndVersioning=[[gi.prototype._setValue_direct,gi.prototype._setValue_direct_setNeedsUpdate,gi.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[gi.prototype._setValue_array,gi.prototype._setValue_array_setNeedsUpdate,gi.prototype._setValue_array_setMatrixWorldNeedsUpdate],[gi.prototype._setValue_arrayElement,gi.prototype._setValue_arrayElement_setNeedsUpdate,gi.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[gi.prototype._setValue_fromArray,gi.prototype._setValue_fromArray_setNeedsUpdate,gi.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1),"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"155"}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="155");const w0=[{path:"",component:Ki,children:[{path:"star",component:(()=>{class l{constructor(t){this.markdownService=t,this.title="star",this.domWidth=window.innerWidth-20,this.domHeight=150,this.vertexShader="\n        //vertexShader\n        varying vec2 vUv;\n        uniform float uTime;\n        void main() {\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n          vUv = uv;\n        }",this.fragmentShader="\n        //fragmentShader\n        #define PI 3.1415926535897932384626433832795\n        varying vec2 vUv;\n        vec2 rotate(vec2 uv, float rotation, vec2 mid) {\n          return vec2(\n            cos(rotation) * (uv.x - mid.x) + sin(rotation) * (uv.y - mid.y) + mid.x,\n            cos(rotation) * (uv.y - mid.y) - sin(rotation) * (uv.x - mid.x) + mid.y\n          );\n        }\n        uniform float uTime;\n        void main() {\n            vec2 rotatedUv = rotate(vUv, PI*0.25, vec2(0.5));\n            float animation = mix(0.005, 0.05, (sin(uTime) + 1.0) * 0.5);\n            float strength = animation / distance(vec2(rotatedUv.x,(rotatedUv.y - 0.5)*5.0 + 0.5), vec2(0.5));\n            strength *= animation / distance(vec2(rotatedUv.y,(rotatedUv.x - 0.5)*5.0 + 0.5), vec2(0.5));\n            vec3 adjustedColor = vec3(0.5, 0.7, 0.9);\n            gl_FragColor = vec4(vec3(adjustedColor * strength ), 1.0);\n        }",this.myValue="print('hello-world')"}ngOnInit(){this.init(),console.log(this.markdownService.compile("I am using __markdown__."))}init(){var t;const r=new Hr(70,this.domWidth/this.domHeight,.01,10);r.position.z=1;const s=new Nd,a=new Ml(6,6,1),u=new Io({uniforms:{uOpacity:{value:50},uTime:{value:.1}},vertexShader:this.vertexShader,fragmentShader:this.fragmentShader,side:2}),d=new hs(a,u);s.add(d);const p=new py({antialias:!0});p.setClearColor(new Pt(16777215)),p.setSize(this.domWidth,this.domHeight),p.setAnimationLoop(function y(x){u.uniforms.uTime.value+=.02,p.render(s,r)}),null===(t=document.getElementById("star-container"))||void 0===t||t.appendChild(p.domElement)}onLoad(){}}return l.\u0275fac=function(t){return new(t||l)(F.Y36(rs))},l.\u0275cmp=F.Xpm({type:l,selectors:[["app-star"]],decls:8,vars:8,consts:[[1,"flex-box"],["id","star-container"],[1,"terminal"],[2,"overflow","auto"],[3,"data"]],template:function(t,r){1&t&&(F.TgZ(0,"div",0),F._UZ(1,"div",1),F.qZA(),F.TgZ(2,"div",2)(3,"div",3),F._UZ(4,"markdown",4),F.ALo(5,"language"),F._UZ(6,"markdown",4),F.ALo(7,"language"),F.qZA()()),2&t&&(F.xp6(4),F.Q6J("data",F.xi3(5,2,r.vertexShader,"c")),F.xp6(2),F.Q6J("data",F.xi3(7,5,r.fragmentShader,"c")))},directives:[Mo],pipes:[zi],styles:[""]}),l})()}]}];let Hx=(()=>{class l{}return l.\u0275fac=function(t){return new(t||l)},l.\u0275mod=F.oAB({type:l}),l.\u0275inj=F.cJS({imports:[[ar.Bz.forChild(w0)],ar.Bz]}),l})(),zx=(()=>{class l{}return l.\u0275fac=function(t){return new(t||l)},l.\u0275mod=F.oAB({type:l}),l.\u0275inj=F.cJS({imports:[[k.ez,Hx,Zi,Ks.forRoot({loader:Qn})]]}),l})()},3962:(Zt,Ve,ne)=>{var k=ne(2313),F=ne(1223),be=ne(6035);const Ue=[{path:"",redirectTo:"index",pathMatch:"full"},{path:"index",component:(()=>{class ve{constructor(){}ngOnInit(){}}return ve.\u0275fac=function(nn){return new(nn||ve)},ve.\u0275cmp=F.Xpm({type:ve,selectors:[["app-index"]],decls:83,vars:0,consts:[["role","banner",1,"toolbar"],[1,"spacer"],["aria-label","Angular on twitter","target","_blank","rel","noopener","href","https://twitter.com","title","Twitter"],["id","twitter-logo","height","24","data-name","Logo","xmlns","http://www.w3.org/2000/svg","viewBox","0 0 400 400"],["width","400","height","400","fill","none"],["d","M153.62,301.59c94.34,0,145.94-78.16,145.94-145.94,0-2.22,0-4.43-.15-6.63A104.36,104.36,0,0,0,325,122.47a102.38,102.38,0,0,1-29.46,8.07,51.47,51.47,0,0,0,22.55-28.37,102.79,102.79,0,0,1-32.57,12.45,51.34,51.34,0,0,0-87.41,46.78A145.62,145.62,0,0,1,92.4,107.81a51.33,51.33,0,0,0,15.88,68.47A50.91,50.91,0,0,1,85,169.86c0,.21,0,.43,0,.65a51.31,51.31,0,0,0,41.15,50.28,51.21,51.21,0,0,1-23.16.88,51.35,51.35,0,0,0,47.92,35.62,102.92,102.92,0,0,1-63.7,22A104.41,104.41,0,0,1,75,278.55a145.21,145.21,0,0,0,78.62,23","fill","#fff"],["aria-label","Angular on YouTube","target","_blank","rel","noopener","href","https://youtube.com","title","YouTube"],["id","youtube-logo","height","24","width","24","data-name","Logo","xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","#fff"],["d","M0 0h24v24H0V0z","fill","none"],["d","M21.58 7.19c-.23-.86-.91-1.54-1.77-1.77C18.25 5 12 5 12 5s-6.25 0-7.81.42c-.86.23-1.54.91-1.77 1.77C2 8.75 2 12 2 12s0 3.25.42 4.81c.23.86.91 1.54 1.77 1.77C5.75 19 12 19 12 19s6.25 0 7.81-.42c.86-.23 1.54-.91 1.77-1.77C22 15.25 22 12 22 12s0-3.25-.42-4.81zM10 15V9l5.2 3-5.2 3z"],["role","main",1,"content"],[1,"card","highlight-card","card-small"],["id","rocket-smoke","xmlns","http://www.w3.org/2000/svg","width","516.119","height","1083.632","viewBox","0 0 516.119 1083.632"],["id","Path_40","data-name","Path 40","d","M644.6,141S143.02,215.537,147.049,870.207s342.774,201.755,342.774,201.755S404.659,847.213,388.815,762.2c-27.116-145.51-11.551-384.124,271.9-609.1C671.15,139.365,644.6,141,644.6,141Z","transform","translate(-147.025 -140.939)","fill","#f5f5f5"],[1,"card-container"],["target","_blank","rel","noopener","href","https://angular.io/tutorial",1,"card"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24",1,"material-icons"],["d","M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82zM12 3L1 9l11 6 9-4.91V17h2V9L12 3z"],["d","M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"],["rel","noopener","routerLink","/shader",1,"card"],["d","M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"],["target","_blank","rel","noopener","href","https://material.angular.io",1,"card"],["xmlns","http://www.w3.org/2000/svg","width","21.813","height","23.453","viewBox","0 0 21.813 23.453",2,"margin-right","8px"],["d","M4099.584,972.736h0l-10.882,3.9,1.637,14.4,9.245,5.153,9.245-5.153,1.686-14.4Z","transform","translate(-4088.702 -972.736)","fill","#808080"],["d","M4181.516,972.736v23.453l9.245-5.153,1.686-14.4Z","transform","translate(-4170.633 -972.736)","fill","#808080"],["d","M4137.529,1076.127l-7.7-3.723,4.417-2.721,7.753,3.723Z","transform","translate(-4125.003 -1058.315)","fill","#ffe0b2"],["d","M4137.529,1051.705l-7.7-3.723,4.417-2.721,7.753,3.723Z","transform","translate(-4125.003 -1036.757)","fill","#fff3e0"],["d","M4137.529,1027.283l-7.7-3.723,4.417-2.721,7.753,3.723Z","transform","translate(-4125.003 -1015.199)","fill","#fff"],["target","_blank","rel","noopener","href","https://blog.angular.io/",1,"card"],["d","M13.5.67s.74 2.65.74 4.8c0 2.06-1.35 3.73-3.41 3.73-2.07 0-3.63-1.67-3.63-3.73l.03-.36C5.21 7.51 4 10.62 4 14c0 4.42 3.58 8 8 8s8-3.58 8-8C20 8.61 17.41 3.8 13.5.67zM11.71 19c-1.78 0-3.22-1.4-3.22-3.14 0-1.62 1.05-2.76 2.81-3.12 1.77-.36 3.6-1.21 4.62-2.58.39 1.29.59 2.65.59 4.04 0 2.65-2.15 4.8-4.8 4.8z"],["target","_blank","rel","noopener","href","https://angular.io/devtools/",1,"card"],["xmlns","http://www.w3.org/2000/svg","enable-background","new 0 0 24 24","height","24px","viewBox","0 0 24 24","width","24px","fill","#000000",1,"material-icons"],["fill","none","height","24","width","24"],["d","M14.73,13.31C15.52,12.24,16,10.93,16,9.5C16,5.91,13.09,3,9.5,3S3,5.91,3,9.5C3,13.09,5.91,16,9.5,16 c1.43,0,2.74-0.48,3.81-1.27L19.59,21L21,19.59L14.73,13.31z M9.5,14C7.01,14,5,11.99,5,9.5S7.01,5,9.5,5S14,7.01,14,9.5 S11.99,14,9.5,14z"],["points","10.29,8.44 9.5,6 8.71,8.44 6.25,8.44 8.26,10.03 7.49,12.5 9.5,10.97 11.51,12.5 10.74,10.03 12.75,8.44"],["href","https://github.com/February3O","target","_blank","rel","noopener"],[1,"github-star-badge"],["d","M0 0h24v24H0z","fill","none"],["d","M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"],["d","M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z","fill","#1976d2"],["id","clouds","xmlns","http://www.w3.org/2000/svg","width","2611.084","height","485.677","viewBox","0 0 2611.084 485.677"],["id","Path_39","data-name","Path 39","d","M2379.709,863.793c10-93-77-171-168-149-52-114-225-105-264,15-75,3-140,59-152,133-30,2.83-66.725,9.829-93.5,26.25-26.771-16.421-63.5-23.42-93.5-26.25-12-74-77-130-152-133-39-120-212-129-264-15-54.084-13.075-106.753,9.173-138.488,48.9-31.734-39.726-84.4-61.974-138.487-48.9-52-114-225-105-264,15a162.027,162.027,0,0,0-103.147,43.044c-30.633-45.365-87.1-72.091-145.206-58.044-52-114-225-105-264,15-75,3-140,59-152,133-53,5-127,23-130,83-2,42,35,72,70,86,49,20,106,18,157,5a165.625,165.625,0,0,0,120,0c47,94,178,113,251,33,61.112,8.015,113.854-5.72,150.492-29.764a165.62,165.62,0,0,0,110.861-3.236c47,94,178,113,251,33,31.385,4.116,60.563,2.495,86.487-3.311,25.924,5.806,55.1,7.427,86.488,3.311,73,80,204,61,251-33a165.625,165.625,0,0,0,120,0c51,13,108,15,157-5a147.188,147.188,0,0,0,33.5-18.694,147.217,147.217,0,0,0,33.5,18.694c49,20,106,18,157,5a165.625,165.625,0,0,0,120,0c47,94,178,113,251,33C2446.709,1093.793,2554.709,922.793,2379.709,863.793Z","transform","translate(142.69 -634.312)","fill","#eee"]],template:function(nn,Ne){1&nn&&(F.TgZ(0,"div",0)(1,"span"),F._uU(2,"Welcome"),F.qZA(),F._UZ(3,"div",1),F.TgZ(4,"a",2),F.O4$(),F.TgZ(5,"svg",3),F._UZ(6,"rect",4)(7,"path",5),F.qZA()(),F.kcU(),F.TgZ(8,"a",6),F.O4$(),F.TgZ(9,"svg",7),F._UZ(10,"path",8)(11,"path",9),F.qZA()()(),F.kcU(),F.TgZ(12,"div",10)(13,"div",11)(14,"span"),F._uU(15,"hello world!"),F.qZA(),F.O4$(),F.TgZ(16,"svg",12)(17,"title"),F._uU(18,"Rocket Ship Smoke"),F.qZA(),F._UZ(19,"path",13),F.qZA()(),F.kcU(),F.TgZ(20,"div",14)(21,"a",15),F.O4$(),F.TgZ(22,"svg",16),F._UZ(23,"path",17),F.qZA(),F.kcU(),F.TgZ(24,"span"),F._uU(25,"Learn"),F.qZA(),F.O4$(),F.TgZ(26,"svg",16),F._UZ(27,"path",18),F.qZA()(),F.kcU(),F.TgZ(28,"a",19),F.O4$(),F.TgZ(29,"svg",16),F._UZ(30,"path",20),F.qZA(),F.kcU(),F.TgZ(31,"span"),F._uU(32,"Shader"),F.qZA(),F.O4$(),F.TgZ(33,"svg",16),F._UZ(34,"path",18),F.qZA()(),F.kcU(),F.TgZ(35,"a",21),F.O4$(),F.TgZ(36,"svg",22),F._UZ(37,"path",23)(38,"path",24)(39,"path",25)(40,"path",26)(41,"path",27),F.qZA(),F.kcU(),F.TgZ(42,"span"),F._uU(43,"Material"),F.qZA(),F.O4$(),F.TgZ(44,"svg",16),F._UZ(45,"path",18),F.qZA()(),F.kcU(),F.TgZ(46,"a",28),F.O4$(),F.TgZ(47,"svg",16),F._UZ(48,"path",29),F.qZA(),F.kcU(),F.TgZ(49,"span"),F._uU(50,"Blog"),F.qZA(),F.O4$(),F.TgZ(51,"svg",16),F._UZ(52,"path",18),F.qZA()(),F.kcU(),F.TgZ(53,"a",30),F.O4$(),F.TgZ(54,"svg",31)(55,"g"),F._UZ(56,"rect",32),F.qZA(),F.TgZ(57,"g")(58,"g"),F._UZ(59,"path",33)(60,"polygon",34),F.qZA()()(),F.kcU(),F.TgZ(61,"span"),F._uU(62,"DevTools"),F.qZA(),F.O4$(),F.TgZ(63,"svg",16),F._UZ(64,"path",18),F.qZA()()(),F.kcU(),F._UZ(65,"div",14)(66,"div",14),F.TgZ(67,"footer"),F._uU(68," GitHub?\xa0 "),F.TgZ(69,"a",35)(70,"div",36),F.O4$(),F.TgZ(71,"svg",16),F._UZ(72,"path",37)(73,"path",38),F.qZA(),F._uU(74," Star "),F.qZA()(),F.kcU(),F.TgZ(75,"a",35),F.O4$(),F.TgZ(76,"svg",16),F._UZ(77,"path",39)(78,"path",37),F.qZA()()(),F.TgZ(79,"svg",40)(80,"title"),F._uU(81,"Gray Clouds Background"),F.qZA(),F._UZ(82,"path",41),F.qZA()())},directives:[be.yS],styles:["",""]}),ve})()},{path:"shader",loadChildren:()=>Promise.resolve().then(ne.bind(ne,2296)).then(ve=>ve.ShaderModule)}];let It=(()=>{class ve{}return ve.\u0275fac=function(nn){return new(nn||ve)},ve.\u0275mod=F.oAB({type:ve}),ve.\u0275inj=F.cJS({imports:[[be.Bz.forRoot(Ue,{useHash:!0})],be.Bz]}),ve})(),xt=(()=>{class ve{constructor(){this.title="docs"}ngOnInit(){}}return ve.\u0275fac=function(nn){return new(nn||ve)},ve.\u0275cmp=F.Xpm({type:ve,selectors:[["app-root"]],decls:1,vars:0,template:function(nn,Ne){1&nn&&F._UZ(0,"router-outlet")},directives:[be.lC],styles:[""]}),ve})();var kt=ne(2296);let Ot=(()=>{class ve{}return ve.\u0275fac=function(nn){return new(nn||ve)},ve.\u0275mod=F.oAB({type:ve,bootstrap:[xt]}),ve.\u0275inj=F.cJS({providers:[],imports:[[k.b2,It,kt.ShaderModule]]}),ve})();(0,F.G48)(),k.q6().bootstrapModule(Ot).catch(ve=>console.error(ve))},8306:(Zt,Ve,ne)=>{ne.d(Ve,{y:()=>it});var k=ne(2961),F=ne(727),be=ne(8822),Ye=ne(4671);var xt=ne(2416),kt=ne(576),Ot=ne(2806);let it=(()=>{class Ne{constructor(Ge){Ge&&(this._subscribe=Ge)}lift(Ge){const fn=new Ne;return fn.source=this,fn.operator=Ge,fn}subscribe(Ge,fn,Wn){const $n=function nn(Ne){return Ne&&Ne instanceof k.Lv||function rt(Ne){return Ne&&(0,kt.m)(Ne.next)&&(0,kt.m)(Ne.error)&&(0,kt.m)(Ne.complete)}(Ne)&&(0,F.Nn)(Ne)}(Ge)?Ge:new k.Hp(Ge,fn,Wn);return(0,Ot.x)(()=>{const{operator:gt,source:Et}=this;$n.add(gt?gt.call($n,Et):Et?this._subscribe($n):this._trySubscribe($n))}),$n}_trySubscribe(Ge){try{return this._subscribe(Ge)}catch(fn){Ge.error(fn)}}forEach(Ge,fn){return new(fn=ve(fn))((Wn,$n)=>{const gt=new k.Hp({next:Et=>{try{Ge(Et)}catch(lt){$n(lt),gt.unsubscribe()}},error:$n,complete:Wn});this.subscribe(gt)})}_subscribe(Ge){var fn;return null===(fn=this.source)||void 0===fn?void 0:fn.subscribe(Ge)}[be.L](){return this}pipe(...Ge){return function It(Ne){return 0===Ne.length?Ye.y:1===Ne.length?Ne[0]:function(Ge){return Ne.reduce((fn,Wn)=>Wn(fn),Ge)}}(Ge)(this)}toPromise(Ge){return new(Ge=ve(Ge))((fn,Wn)=>{let $n;this.subscribe(gt=>$n=gt,gt=>Wn(gt),()=>fn($n))})}}return Ne.create=Gn=>new Ne(Gn),Ne})();function ve(Ne){var Gn;return null!==(Gn=null!=Ne?Ne:xt.v.Promise)&&void 0!==Gn?Gn:Promise}},7579:(Zt,Ve,ne)=>{ne.d(Ve,{x:()=>xt});var k=ne(8306),F=ne(727);const Ye=(0,ne(3888).d)(Ot=>function(){Ot(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Ue=ne(8737),It=ne(2806);let xt=(()=>{class Ot extends k.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(ve){const rt=new kt(this,this);return rt.operator=ve,rt}_throwIfClosed(){if(this.closed)throw new Ye}next(ve){(0,It.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const rt of this.currentObservers)rt.next(ve)}})}error(ve){(0,It.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=ve;const{observers:rt}=this;for(;rt.length;)rt.shift().error(ve)}})}complete(){(0,It.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:ve}=this;for(;ve.length;)ve.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var ve;return(null===(ve=this.observers)||void 0===ve?void 0:ve.length)>0}_trySubscribe(ve){return this._throwIfClosed(),super._trySubscribe(ve)}_subscribe(ve){return this._throwIfClosed(),this._checkFinalizedStatuses(ve),this._innerSubscribe(ve)}_innerSubscribe(ve){const{hasError:rt,isStopped:nn,observers:Ne}=this;return rt||nn?F.Lc:(this.currentObservers=null,Ne.push(ve),new F.w0(()=>{this.currentObservers=null,(0,Ue.P)(Ne,ve)}))}_checkFinalizedStatuses(ve){const{hasError:rt,thrownError:nn,isStopped:Ne}=this;rt?ve.error(nn):Ne&&ve.complete()}asObservable(){const ve=new k.y;return ve.source=this,ve}}return Ot.create=(it,ve)=>new kt(it,ve),Ot})();class kt extends xt{constructor(it,ve){super(),this.destination=it,this.source=ve}next(it){var ve,rt;null===(rt=null===(ve=this.destination)||void 0===ve?void 0:ve.next)||void 0===rt||rt.call(ve,it)}error(it){var ve,rt;null===(rt=null===(ve=this.destination)||void 0===ve?void 0:ve.error)||void 0===rt||rt.call(ve,it)}complete(){var it,ve;null===(ve=null===(it=this.destination)||void 0===it?void 0:it.complete)||void 0===ve||ve.call(it)}_subscribe(it){var ve,rt;return null!==(rt=null===(ve=this.source)||void 0===ve?void 0:ve.subscribe(it))&&void 0!==rt?rt:F.Lc}}},2961:(Zt,Ve,ne)=>{ne.d(Ve,{Hp:()=>Ge,Lv:()=>rt});var k=ne(576),F=ne(727),be=ne(2416),Ye=ne(7849);function Ue(){}const It=Ot("C",void 0,void 0);function Ot(Et,lt,ut){return{kind:Et,value:lt,error:ut}}var it=ne(3410),ve=ne(2806);class rt extends F.w0{constructor(lt){super(),this.isStopped=!1,lt?(this.destination=lt,(0,F.Nn)(lt)&&lt.add(this)):this.destination=gt}static create(lt,ut,jn){return new Ge(lt,ut,jn)}next(lt){this.isStopped?$n(function kt(Et){return Ot("N",Et,void 0)}(lt),this):this._next(lt)}error(lt){this.isStopped?$n(function xt(Et){return Ot("E",void 0,Et)}(lt),this):(this.isStopped=!0,this._error(lt))}complete(){this.isStopped?$n(It,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(lt){this.destination.next(lt)}_error(lt){try{this.destination.error(lt)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const nn=Function.prototype.bind;function Ne(Et,lt){return nn.call(Et,lt)}class Gn{constructor(lt){this.partialObserver=lt}next(lt){const{partialObserver:ut}=this;if(ut.next)try{ut.next(lt)}catch(jn){fn(jn)}}error(lt){const{partialObserver:ut}=this;if(ut.error)try{ut.error(lt)}catch(jn){fn(jn)}else fn(lt)}complete(){const{partialObserver:lt}=this;if(lt.complete)try{lt.complete()}catch(ut){fn(ut)}}}class Ge extends rt{constructor(lt,ut,jn){let We;if(super(),(0,k.m)(lt)||!lt)We={next:null!=lt?lt:void 0,error:null!=ut?ut:void 0,complete:null!=jn?jn:void 0};else{let Mt;this&&be.v.useDeprecatedNextContext?(Mt=Object.create(lt),Mt.unsubscribe=()=>this.unsubscribe(),We={next:lt.next&&Ne(lt.next,Mt),error:lt.error&&Ne(lt.error,Mt),complete:lt.complete&&Ne(lt.complete,Mt)}):We=lt}this.destination=new Gn(We)}}function fn(Et){be.v.useDeprecatedSynchronousErrorHandling?(0,ve.O)(Et):(0,Ye.h)(Et)}function $n(Et,lt){const{onStoppedNotification:ut}=be.v;ut&&it.z.setTimeout(()=>ut(Et,lt))}const gt={closed:!0,next:Ue,error:function Wn(Et){throw Et},complete:Ue}},727:(Zt,Ve,ne)=>{ne.d(Ve,{Lc:()=>It,w0:()=>Ue,Nn:()=>xt});var k=ne(576);const be=(0,ne(3888).d)(Ot=>function(ve){Ot(this),this.message=ve?`${ve.length} errors occurred during unsubscription:\n${ve.map((rt,nn)=>`${nn+1}) ${rt.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=ve});var Ye=ne(8737);class Ue{constructor(it){this.initialTeardown=it,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let it;if(!this.closed){this.closed=!0;const{_parentage:ve}=this;if(ve)if(this._parentage=null,Array.isArray(ve))for(const Ne of ve)Ne.remove(this);else ve.remove(this);const{initialTeardown:rt}=this;if((0,k.m)(rt))try{rt()}catch(Ne){it=Ne instanceof be?Ne.errors:[Ne]}const{_finalizers:nn}=this;if(nn){this._finalizers=null;for(const Ne of nn)try{kt(Ne)}catch(Gn){it=null!=it?it:[],Gn instanceof be?it=[...it,...Gn.errors]:it.push(Gn)}}if(it)throw new be(it)}}add(it){var ve;if(it&&it!==this)if(this.closed)kt(it);else{if(it instanceof Ue){if(it.closed||it._hasParent(this))return;it._addParent(this)}(this._finalizers=null!==(ve=this._finalizers)&&void 0!==ve?ve:[]).push(it)}}_hasParent(it){const{_parentage:ve}=this;return ve===it||Array.isArray(ve)&&ve.includes(it)}_addParent(it){const{_parentage:ve}=this;this._parentage=Array.isArray(ve)?(ve.push(it),ve):ve?[ve,it]:it}_removeParent(it){const{_parentage:ve}=this;ve===it?this._parentage=null:Array.isArray(ve)&&(0,Ye.P)(ve,it)}remove(it){const{_finalizers:ve}=this;ve&&(0,Ye.P)(ve,it),it instanceof Ue&&it._removeParent(this)}}Ue.EMPTY=(()=>{const Ot=new Ue;return Ot.closed=!0,Ot})();const It=Ue.EMPTY;function xt(Ot){return Ot instanceof Ue||Ot&&"closed"in Ot&&(0,k.m)(Ot.remove)&&(0,k.m)(Ot.add)&&(0,k.m)(Ot.unsubscribe)}function kt(Ot){(0,k.m)(Ot)?Ot():Ot.unsubscribe()}},2416:(Zt,Ve,ne)=>{ne.d(Ve,{v:()=>k});const k={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},515:(Zt,Ve,ne)=>{ne.d(Ve,{E:()=>F});const F=new(ne(8306).y)(Ue=>Ue.complete())},2076:(Zt,Ve,ne)=>{ne.d(Ve,{D:()=>jn});var k=ne(8421),F=ne(9672),be=ne(4482),Ye=ne(5403);function Ue(We,Mt=0){return(0,be.e)((yn,en)=>{yn.subscribe((0,Ye.x)(en,kn=>(0,F.f)(en,We,()=>en.next(kn),Mt),()=>(0,F.f)(en,We,()=>en.complete(),Mt),kn=>(0,F.f)(en,We,()=>en.error(kn),Mt)))})}function It(We,Mt=0){return(0,be.e)((yn,en)=>{en.add(We.schedule(()=>yn.subscribe(en),Mt))})}var Ot=ne(8306),ve=ne(2202),rt=ne(576);function Ne(We,Mt){if(!We)throw new Error("Iterable cannot be null");return new Ot.y(yn=>{(0,F.f)(yn,Mt,()=>{const en=We[Symbol.asyncIterator]();(0,F.f)(yn,Mt,()=>{en.next().then(kn=>{kn.done?yn.complete():yn.next(kn.value)})},0,!0)})})}var Gn=ne(3670),Ge=ne(8239),fn=ne(1144),Wn=ne(6495),$n=ne(2206),gt=ne(4532),Et=ne(3260);function jn(We,Mt){return Mt?function ut(We,Mt){if(null!=We){if((0,Gn.c)(We))return function xt(We,Mt){return(0,k.Xf)(We).pipe(It(Mt),Ue(Mt))}(We,Mt);if((0,fn.z)(We))return function it(We,Mt){return new Ot.y(yn=>{let en=0;return Mt.schedule(function(){en===We.length?yn.complete():(yn.next(We[en++]),yn.closed||this.schedule())})})}(We,Mt);if((0,Ge.t)(We))return function kt(We,Mt){return(0,k.Xf)(We).pipe(It(Mt),Ue(Mt))}(We,Mt);if((0,$n.D)(We))return Ne(We,Mt);if((0,Wn.T)(We))return function nn(We,Mt){return new Ot.y(yn=>{let en;return(0,F.f)(yn,Mt,()=>{en=We[ve.h](),(0,F.f)(yn,Mt,()=>{let kn,sn;try{({value:kn,done:sn}=en.next())}catch(mn){return void yn.error(mn)}sn?yn.complete():yn.next(kn)},0,!0)}),()=>(0,rt.m)(null==en?void 0:en.return)&&en.return()})}(We,Mt);if((0,Et.L)(We))return function lt(We,Mt){return Ne((0,Et.Q)(We),Mt)}(We,Mt)}throw(0,gt.z)(We)}(We,Mt):(0,k.Xf)(We)}},8421:(Zt,Ve,ne)=>{ne.d(Ve,{Xf:()=>nn});var k=ne(7582),F=ne(1144),be=ne(8239),Ye=ne(8306),Ue=ne(3670),It=ne(2206),xt=ne(4532),kt=ne(6495),Ot=ne(3260),it=ne(576),ve=ne(7849),rt=ne(8822);function nn(Et){if(Et instanceof Ye.y)return Et;if(null!=Et){if((0,Ue.c)(Et))return function Ne(Et){return new Ye.y(lt=>{const ut=Et[rt.L]();if((0,it.m)(ut.subscribe))return ut.subscribe(lt);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(Et);if((0,F.z)(Et))return function Gn(Et){return new Ye.y(lt=>{for(let ut=0;ut<Et.length&&!lt.closed;ut++)lt.next(Et[ut]);lt.complete()})}(Et);if((0,be.t)(Et))return function Ge(Et){return new Ye.y(lt=>{Et.then(ut=>{lt.closed||(lt.next(ut),lt.complete())},ut=>lt.error(ut)).then(null,ve.h)})}(Et);if((0,It.D)(Et))return Wn(Et);if((0,kt.T)(Et))return function fn(Et){return new Ye.y(lt=>{for(const ut of Et)if(lt.next(ut),lt.closed)return;lt.complete()})}(Et);if((0,Ot.L)(Et))return function $n(Et){return Wn((0,Ot.Q)(Et))}(Et)}throw(0,xt.z)(Et)}function Wn(Et){return new Ye.y(lt=>{(function gt(Et,lt){var ut,jn,We,Mt;return(0,k.mG)(this,void 0,void 0,function*(){try{for(ut=(0,k.KL)(Et);!(jn=yield ut.next()).done;)if(lt.next(jn.value),lt.closed)return}catch(yn){We={error:yn}}finally{try{jn&&!jn.done&&(Mt=ut.return)&&(yield Mt.call(ut))}finally{if(We)throw We.error}}lt.complete()})})(Et,lt).catch(ut=>lt.error(ut))})}},9646:(Zt,Ve,ne)=>{ne.d(Ve,{of:()=>be});var k=ne(7669),F=ne(2076);function be(...Ye){const Ue=(0,k.yG)(Ye);return(0,F.D)(Ye,Ue)}},5403:(Zt,Ve,ne)=>{ne.d(Ve,{x:()=>F});var k=ne(2961);function F(Ye,Ue,It,xt,kt){return new be(Ye,Ue,It,xt,kt)}class be extends k.Lv{constructor(Ue,It,xt,kt,Ot,it){super(Ue),this.onFinalize=Ot,this.shouldUnsubscribe=it,this._next=It?function(ve){try{It(ve)}catch(rt){Ue.error(rt)}}:super._next,this._error=kt?function(ve){try{kt(ve)}catch(rt){Ue.error(rt)}finally{this.unsubscribe()}}:super._error,this._complete=xt?function(){try{xt()}catch(ve){Ue.error(ve)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var Ue;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:It}=this;super.unsubscribe(),!It&&(null===(Ue=this.onFinalize)||void 0===Ue||Ue.call(this))}}}},4351:(Zt,Ve,ne)=>{ne.d(Ve,{b:()=>be});var k=ne(5577),F=ne(576);function be(Ye,Ue){return(0,F.m)(Ue)?(0,k.z)(Ye,Ue,1):(0,k.z)(Ye,1)}},6590:(Zt,Ve,ne)=>{ne.d(Ve,{d:()=>be});var k=ne(4482),F=ne(5403);function be(Ye){return(0,k.e)((Ue,It)=>{let xt=!1;Ue.subscribe((0,F.x)(It,kt=>{xt=!0,It.next(kt)},()=>{xt||It.next(Ye),It.complete()}))})}},9300:(Zt,Ve,ne)=>{ne.d(Ve,{h:()=>be});var k=ne(4482),F=ne(5403);function be(Ye,Ue){return(0,k.e)((It,xt)=>{let kt=0;It.subscribe((0,F.x)(xt,Ot=>Ye.call(Ue,Ot,kt++)&&xt.next(Ot)))})}},590:(Zt,Ve,ne)=>{ne.d(Ve,{P:()=>xt});var k=ne(6805),F=ne(9300),be=ne(5698),Ye=ne(6590),Ue=ne(8068),It=ne(4671);function xt(kt,Ot){const it=arguments.length>=2;return ve=>ve.pipe(kt?(0,F.h)((rt,nn)=>kt(rt,nn,ve)):It.y,(0,be.q)(1),it?(0,Ye.d)(Ot):(0,Ue.T)(()=>new k.K))}},4004:(Zt,Ve,ne)=>{ne.d(Ve,{U:()=>be});var k=ne(4482),F=ne(5403);function be(Ye,Ue){return(0,k.e)((It,xt)=>{let kt=0;It.subscribe((0,F.x)(xt,Ot=>{xt.next(Ye.call(Ue,Ot,kt++))}))})}},8189:(Zt,Ve,ne)=>{ne.d(Ve,{J:()=>be});var k=ne(5577),F=ne(4671);function be(Ye=1/0){return(0,k.z)(F.y,Ye)}},5577:(Zt,Ve,ne)=>{ne.d(Ve,{z:()=>kt});var k=ne(4004),F=ne(8421),be=ne(4482),Ye=ne(9672),Ue=ne(5403),xt=ne(576);function kt(Ot,it,ve=1/0){return(0,xt.m)(it)?kt((rt,nn)=>(0,k.U)((Ne,Gn)=>it(rt,Ne,nn,Gn))((0,F.Xf)(Ot(rt,nn))),ve):("number"==typeof it&&(ve=it),(0,be.e)((rt,nn)=>function It(Ot,it,ve,rt,nn,Ne,Gn,Ge){const fn=[];let Wn=0,$n=0,gt=!1;const Et=()=>{gt&&!fn.length&&!Wn&&it.complete()},lt=jn=>Wn<rt?ut(jn):fn.push(jn),ut=jn=>{Ne&&it.next(jn),Wn++;let We=!1;(0,F.Xf)(ve(jn,$n++)).subscribe((0,Ue.x)(it,Mt=>{null==nn||nn(Mt),Ne?lt(Mt):it.next(Mt)},()=>{We=!0},void 0,()=>{if(We)try{for(Wn--;fn.length&&Wn<rt;){const Mt=fn.shift();Gn?(0,Ye.f)(it,Gn,()=>ut(Mt)):ut(Mt)}Et()}catch(Mt){it.error(Mt)}}))};return Ot.subscribe((0,Ue.x)(it,lt,()=>{gt=!0,Et()})),()=>{null==Ge||Ge()}}(rt,nn,Ot,ve)))}},5698:(Zt,Ve,ne)=>{ne.d(Ve,{q:()=>Ye});var k=ne(515),F=ne(4482),be=ne(5403);function Ye(Ue){return Ue<=0?()=>k.E:(0,F.e)((It,xt)=>{let kt=0;It.subscribe((0,be.x)(xt,Ot=>{++kt<=Ue&&(xt.next(Ot),Ue<=kt&&xt.complete())}))})}},8068:(Zt,Ve,ne)=>{ne.d(Ve,{T:()=>Ye});var k=ne(6805),F=ne(4482),be=ne(5403);function Ye(It=Ue){return(0,F.e)((xt,kt)=>{let Ot=!1;xt.subscribe((0,be.x)(kt,it=>{Ot=!0,kt.next(it)},()=>Ot?kt.complete():kt.error(It())))})}function Ue(){return new k.K}},3410:(Zt,Ve,ne)=>{ne.d(Ve,{z:()=>k});const k={setTimeout(F,be,...Ye){const{delegate:Ue}=k;return(null==Ue?void 0:Ue.setTimeout)?Ue.setTimeout(F,be,...Ye):setTimeout(F,be,...Ye)},clearTimeout(F){const{delegate:be}=k;return((null==be?void 0:be.clearTimeout)||clearTimeout)(F)},delegate:void 0}},2202:(Zt,Ve,ne)=>{ne.d(Ve,{h:()=>F});const F=function k(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(Zt,Ve,ne)=>{ne.d(Ve,{L:()=>k});const k="function"==typeof Symbol&&Symbol.observable||"@@observable"},6805:(Zt,Ve,ne)=>{ne.d(Ve,{K:()=>F});const F=(0,ne(3888).d)(be=>function(){be(this),this.name="EmptyError",this.message="no elements in sequence"})},7669:(Zt,Ve,ne)=>{ne.d(Ve,{_6:()=>It,jO:()=>Ye,yG:()=>Ue});var k=ne(576);function be(xt){return xt[xt.length-1]}function Ye(xt){return(0,k.m)(be(xt))?xt.pop():void 0}function Ue(xt){return function F(xt){return xt&&(0,k.m)(xt.schedule)}(be(xt))?xt.pop():void 0}function It(xt,kt){return"number"==typeof be(xt)?xt.pop():kt}},8737:(Zt,Ve,ne)=>{function k(F,be){if(F){const Ye=F.indexOf(be);0<=Ye&&F.splice(Ye,1)}}ne.d(Ve,{P:()=>k})},3888:(Zt,Ve,ne)=>{function k(F){const Ye=F(Ue=>{Error.call(Ue),Ue.stack=(new Error).stack});return Ye.prototype=Object.create(Error.prototype),Ye.prototype.constructor=Ye,Ye}ne.d(Ve,{d:()=>k})},2806:(Zt,Ve,ne)=>{ne.d(Ve,{O:()=>Ye,x:()=>be});var k=ne(2416);let F=null;function be(Ue){if(k.v.useDeprecatedSynchronousErrorHandling){const It=!F;if(It&&(F={errorThrown:!1,error:null}),Ue(),It){const{errorThrown:xt,error:kt}=F;if(F=null,xt)throw kt}}else Ue()}function Ye(Ue){k.v.useDeprecatedSynchronousErrorHandling&&F&&(F.errorThrown=!0,F.error=Ue)}},9672:(Zt,Ve,ne)=>{function k(F,be,Ye,Ue=0,It=!1){const xt=be.schedule(function(){Ye(),It?F.add(this.schedule(null,Ue)):this.unsubscribe()},Ue);if(F.add(xt),!It)return xt}ne.d(Ve,{f:()=>k})},4671:(Zt,Ve,ne)=>{function k(F){return F}ne.d(Ve,{y:()=>k})},1144:(Zt,Ve,ne)=>{ne.d(Ve,{z:()=>k});const k=F=>F&&"number"==typeof F.length&&"function"!=typeof F},2206:(Zt,Ve,ne)=>{ne.d(Ve,{D:()=>F});var k=ne(576);function F(be){return Symbol.asyncIterator&&(0,k.m)(null==be?void 0:be[Symbol.asyncIterator])}},576:(Zt,Ve,ne)=>{function k(F){return"function"==typeof F}ne.d(Ve,{m:()=>k})},3670:(Zt,Ve,ne)=>{ne.d(Ve,{c:()=>be});var k=ne(8822),F=ne(576);function be(Ye){return(0,F.m)(Ye[k.L])}},6495:(Zt,Ve,ne)=>{ne.d(Ve,{T:()=>be});var k=ne(2202),F=ne(576);function be(Ye){return(0,F.m)(null==Ye?void 0:Ye[k.h])}},8239:(Zt,Ve,ne)=>{ne.d(Ve,{t:()=>F});var k=ne(576);function F(be){return(0,k.m)(null==be?void 0:be.then)}},3260:(Zt,Ve,ne)=>{ne.d(Ve,{L:()=>Ye,Q:()=>be});var k=ne(7582),F=ne(576);function be(Ue){return(0,k.FC)(this,arguments,function*(){const xt=Ue.getReader();try{for(;;){const{value:kt,done:Ot}=yield(0,k.qq)(xt.read());if(Ot)return yield(0,k.qq)(void 0);yield yield(0,k.qq)(kt)}}finally{xt.releaseLock()}})}function Ye(Ue){return(0,F.m)(null==Ue?void 0:Ue.getReader)}},4482:(Zt,Ve,ne)=>{ne.d(Ve,{A:()=>F,e:()=>be});var k=ne(576);function F(Ye){return(0,k.m)(null==Ye?void 0:Ye.lift)}function be(Ye){return Ue=>{if(F(Ue))return Ue.lift(function(It){try{return Ye(It,this)}catch(xt){this.error(xt)}});throw new TypeError("Unable to lift unknown Observable type")}}},7849:(Zt,Ve,ne)=>{ne.d(Ve,{h:()=>be});var k=ne(2416),F=ne(3410);function be(Ye){F.z.setTimeout(()=>{const{onUnhandledError:Ue}=k.v;if(!Ue)throw Ye;Ue(Ye)})}},4532:(Zt,Ve,ne)=>{function k(F){return new TypeError(`You provided ${null!==F&&"object"==typeof F?"an invalid object":`'${F}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}ne.d(Ve,{z:()=>k})},9808:(Zt,Ve,ne)=>{ne.d(Ve,{Do:()=>Et,EM:()=>Qs,HT:()=>Ue,JF:()=>Xo,K0:()=>xt,Mx:()=>yr,NF:()=>Jl,S$:()=>fn,V_:()=>it,Ye:()=>lt,b0:()=>gt,bD:()=>lu,ez:()=>Kl,lw:()=>kt,mr:()=>$n,q:()=>be,w_:()=>It});var k=ne(1223);let F=null;function be(){return F}function Ue(R){F||(F=R)}class It{}const xt=new k.OlP("DocumentToken");let kt=(()=>{class R{historyGo(I){throw new Error("Not implemented")}}return R.\u0275fac=function(I){return new(I||R)},R.\u0275prov=k.Yz7({token:R,factory:function(){return function Ot(){return(0,k.LFG)(ve)}()},providedIn:"platform"}),R})();const it=new k.OlP("Location Initialized");let ve=(()=>{class R extends kt{constructor(I){super(),this._doc=I,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return be().getBaseHref(this._doc)}onPopState(I){const G=be().getGlobalEventTarget(this._doc,"window");return G.addEventListener("popstate",I,!1),()=>G.removeEventListener("popstate",I)}onHashChange(I){const G=be().getGlobalEventTarget(this._doc,"window");return G.addEventListener("hashchange",I,!1),()=>G.removeEventListener("hashchange",I)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(I){this.location.pathname=I}pushState(I,G,se){rt()?this._history.pushState(I,G,se):this.location.hash=se}replaceState(I,G,se){rt()?this._history.replaceState(I,G,se):this.location.hash=se}forward(){this._history.forward()}back(){this._history.back()}historyGo(I=0){this._history.go(I)}getState(){return this._history.state}}return R.\u0275fac=function(I){return new(I||R)(k.LFG(xt))},R.\u0275prov=k.Yz7({token:R,factory:function(){return function nn(){return new ve((0,k.LFG)(xt))}()},providedIn:"platform"}),R})();function rt(){return!!window.history.pushState}function Ne(R,z){if(0==R.length)return z;if(0==z.length)return R;let I=0;return R.endsWith("/")&&I++,z.startsWith("/")&&I++,2==I?R+z.substring(1):1==I?R+z:R+"/"+z}function Gn(R){const z=R.match(/#|\?|$/),I=z&&z.index||R.length;return R.slice(0,I-("/"===R[I-1]?1:0))+R.slice(I)}function Ge(R){return R&&"?"!==R[0]?"?"+R:R}let fn=(()=>{class R{historyGo(I){throw new Error("Not implemented")}}return R.\u0275fac=function(I){return new(I||R)},R.\u0275prov=k.Yz7({token:R,factory:function(){return function Wn(R){const z=(0,k.LFG)(xt).location;return new gt((0,k.LFG)(kt),z&&z.origin||"")}()},providedIn:"root"}),R})();const $n=new k.OlP("appBaseHref");let gt=(()=>{class R extends fn{constructor(I,G){if(super(),this._platformLocation=I,this._removeListenerFns=[],null==G&&(G=this._platformLocation.getBaseHrefFromDOM()),null==G)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=G}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(I){this._removeListenerFns.push(this._platformLocation.onPopState(I),this._platformLocation.onHashChange(I))}getBaseHref(){return this._baseHref}prepareExternalUrl(I){return Ne(this._baseHref,I)}path(I=!1){const G=this._platformLocation.pathname+Ge(this._platformLocation.search),se=this._platformLocation.hash;return se&&I?`${G}${se}`:G}pushState(I,G,se,Te){const Ke=this.prepareExternalUrl(se+Ge(Te));this._platformLocation.pushState(I,G,Ke)}replaceState(I,G,se,Te){const Ke=this.prepareExternalUrl(se+Ge(Te));this._platformLocation.replaceState(I,G,Ke)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(I=0){var G,se;null===(se=(G=this._platformLocation).historyGo)||void 0===se||se.call(G,I)}}return R.\u0275fac=function(I){return new(I||R)(k.LFG(kt),k.LFG($n,8))},R.\u0275prov=k.Yz7({token:R,factory:R.\u0275fac}),R})(),Et=(()=>{class R extends fn{constructor(I,G){super(),this._platformLocation=I,this._baseHref="",this._removeListenerFns=[],null!=G&&(this._baseHref=G)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(I){this._removeListenerFns.push(this._platformLocation.onPopState(I),this._platformLocation.onHashChange(I))}getBaseHref(){return this._baseHref}path(I=!1){let G=this._platformLocation.hash;return null==G&&(G="#"),G.length>0?G.substring(1):G}prepareExternalUrl(I){const G=Ne(this._baseHref,I);return G.length>0?"#"+G:G}pushState(I,G,se,Te){let Ke=this.prepareExternalUrl(se+Ge(Te));0==Ke.length&&(Ke=this._platformLocation.pathname),this._platformLocation.pushState(I,G,Ke)}replaceState(I,G,se,Te){let Ke=this.prepareExternalUrl(se+Ge(Te));0==Ke.length&&(Ke=this._platformLocation.pathname),this._platformLocation.replaceState(I,G,Ke)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(I=0){var G,se;null===(se=(G=this._platformLocation).historyGo)||void 0===se||se.call(G,I)}}return R.\u0275fac=function(I){return new(I||R)(k.LFG(kt),k.LFG($n,8))},R.\u0275prov=k.Yz7({token:R,factory:R.\u0275fac}),R})(),lt=(()=>{class R{constructor(I,G){this._subject=new k.vpe,this._urlChangeListeners=[],this._platformStrategy=I;const se=this._platformStrategy.getBaseHref();this._platformLocation=G,this._baseHref=Gn(We(se)),this._platformStrategy.onPopState(Te=>{this._subject.emit({url:this.path(!0),pop:!0,state:Te.state,type:Te.type})})}path(I=!1){return this.normalize(this._platformStrategy.path(I))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(I,G=""){return this.path()==this.normalize(I+Ge(G))}normalize(I){return R.stripTrailingSlash(function jn(R,z){return R&&z.startsWith(R)?z.substring(R.length):z}(this._baseHref,We(I)))}prepareExternalUrl(I){return I&&"/"!==I[0]&&(I="/"+I),this._platformStrategy.prepareExternalUrl(I)}go(I,G="",se=null){this._platformStrategy.pushState(se,"",I,G),this._notifyUrlChangeListeners(this.prepareExternalUrl(I+Ge(G)),se)}replaceState(I,G="",se=null){this._platformStrategy.replaceState(se,"",I,G),this._notifyUrlChangeListeners(this.prepareExternalUrl(I+Ge(G)),se)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(I=0){var G,se;null===(se=(G=this._platformStrategy).historyGo)||void 0===se||se.call(G,I)}onUrlChange(I){this._urlChangeListeners.push(I),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(G=>{this._notifyUrlChangeListeners(G.url,G.state)}))}_notifyUrlChangeListeners(I="",G){this._urlChangeListeners.forEach(se=>se(I,G))}subscribe(I,G,se){return this._subject.subscribe({next:I,error:G,complete:se})}}return R.normalizeQueryParams=Ge,R.joinWithSlash=Ne,R.stripTrailingSlash=Gn,R.\u0275fac=function(I){return new(I||R)(k.LFG(fn),k.LFG(kt))},R.\u0275prov=k.Yz7({token:R,factory:function(){return function ut(){return new lt((0,k.LFG)(fn),(0,k.LFG)(kt))}()},providedIn:"root"}),R})();function We(R){return R.replace(/\/index.html$/,"")}function yr(R,z){z=encodeURIComponent(z);for(const I of R.split(";")){const G=I.indexOf("="),[se,Te]=-1==G?[I,""]:[I.slice(0,G),I.slice(G+1)];if(se.trim()===z)return decodeURIComponent(Te)}return null}let Kl=(()=>{class R{}return R.\u0275fac=function(I){return new(I||R)},R.\u0275mod=k.oAB({type:R}),R.\u0275inj=k.cJS({}),R})();const lu="browser";function Jl(R){return R===lu}let Qs=(()=>{class R{}return R.\u0275prov=(0,k.Yz7)({token:R,providedIn:"root",factory:()=>new Ka((0,k.LFG)(xt),window)}),R})();class Ka{constructor(z,I){this.document=z,this.window=I,this.offset=()=>[0,0]}setOffset(z){this.offset=Array.isArray(z)?()=>z:z}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(z){this.supportsScrolling()&&this.window.scrollTo(z[0],z[1])}scrollToAnchor(z){if(!this.supportsScrolling())return;const I=function Lr(R,z){const I=R.getElementById(z)||R.getElementsByName(z)[0];if(I)return I;if("function"==typeof R.createTreeWalker&&R.body&&(R.body.createShadowRoot||R.body.attachShadow)){const G=R.createTreeWalker(R.body,NodeFilter.SHOW_ELEMENT);let se=G.currentNode;for(;se;){const Te=se.shadowRoot;if(Te){const Ke=Te.getElementById(z)||Te.querySelector(`[name="${z}"]`);if(Ke)return Ke}se=G.nextNode()}}return null}(this.document,z);I&&(this.scrollToElement(I),I.focus())}setHistoryScrollRestoration(z){if(this.supportScrollRestoration()){const I=this.window.history;I&&I.scrollRestoration&&(I.scrollRestoration=z)}}scrollToElement(z){const I=z.getBoundingClientRect(),G=I.left+this.window.pageXOffset,se=I.top+this.window.pageYOffset,Te=this.offset();this.window.scrollTo(G-Te[0],se-Te[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const z=Ea(this.window.history)||Ea(Object.getPrototypeOf(this.window.history));return!(!z||!z.writable&&!z.set)}catch(z){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(z){return!1}}}function Ea(R){return Object.getOwnPropertyDescriptor(R,"scrollRestoration")}class Xo{}},1223:(Zt,Ve,ne)=>{ne.d(Ve,{deG:()=>Qo,tb:()=>En,AFp:()=>Re,ip1:()=>Pe,CZH:()=>de,hGG:()=>jE,z2F:()=>Yx,sBO:()=>RE,Sil:()=>Wl,_Vd:()=>gf,EJc:()=>va,SBq:()=>gi,qLn:()=>xd,vpe:()=>s,tBr:()=>xc,XFs:()=>tn,OlP:()=>Oi,zs3:()=>Lo,ZZ4:()=>tM,aQg:()=>nM,soG:()=>fs,YKP:()=>yf,h0i:()=>ga,PXZ:()=>bE,R0b:()=>Cs,FiY:()=>nd,Lbi:()=>Zn,g9A:()=>Sn,Qsj:()=>Tb,FYo:()=>y0,JOm:()=>Bs,q3G:()=>er,tp0:()=>id,Rgc:()=>d,dDg:()=>Wb,GfV:()=>Dx,s_b:()=>M,ifc:()=>Qr,eFA:()=>Xb,G48:()=>DE,_c5:()=>$E,VLi:()=>_E,c2e:()=>qi,zSh:()=>Ap,wAp:()=>an,vHH:()=>ut,EiD:()=>lg,mCW:()=>pr,qzn:()=>oa,JVY:()=>pd,pB0:()=>tg,eBb:()=>Qm,L6k:()=>md,LAX:()=>eg,cg1:()=>Ah,kL8:()=>sf,yhl:()=>Vu,dqk:()=>ni,sIi:()=>nh,CqO:()=>Zp,QGY:()=>Yp,F4k:()=>ds,RDi:()=>se,AaK:()=>Ge,z3N:()=>fo,TTD:()=>Za,xp6:()=>gg,uIk:()=>kp,Suo:()=>Je,Xpm:()=>le,lG2:()=>Ys,Yz7:()=>li,cJS:()=>ri,oAB:()=>On,Yjl:()=>ns,Y36:()=>mh,_UZ:()=>ka,qZA:()=>Ua,TgZ:()=>Yc,LFG:()=>Ar,$8M:()=>vc,$Z:()=>Xp,NdJ:()=>Vd,CRH:()=>Qe,kcU:()=>dc,O4$:()=>xu,ALo:()=>Bx,xi3:()=>w0,Hsn:()=>Qp,F$t:()=>wy,Q6J:()=>Dl,iGM:()=>Oe,LSH:()=>ep,_uU:()=>Iy});var k=ne(7579),F=ne(727),be=ne(8306),Ye=ne(8189),Ue=ne(8421),It=ne(515),xt=ne(7669),kt=ne(2076),it=ne(2961),ve=ne(4482);function nn(n,i,...o){if(!0===i)return void n();if(!1===i)return;const c=new it.Hp({next:()=>{c.unsubscribe(),n()}});return i(...o).subscribe(c)}function Ne(n){for(let i in n)if(n[i]===Ne)return i;throw Error("Could not find renamed property on target object.")}function Ge(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(Ge).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const i=n.toString();if(null==i)return""+i;const o=i.indexOf("\n");return-1===o?i:i.substring(0,o)}function fn(n,i){return null==n||""===n?null===i?"":i:null==i||""===i?n:n+" "+i}const Wn=Ne({__forward_ref__:Ne});function $n(n){return n.__forward_ref__=$n,n.toString=function(){return Ge(this())},n}function gt(n){return function Et(n){return"function"==typeof n&&n.hasOwnProperty(Wn)&&n.__forward_ref__===$n}(n)?n():n}class ut extends Error{constructor(i,o){super(function jn(n,i){return`NG0${Math.abs(n)}${i?": "+i:""}`}(i,o)),this.code=i}}function We(n){return"string"==typeof n?n:null==n?"":String(n)}function Mt(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():We(n)}function sn(n,i){const o=i?` in ${i}`:"";throw new ut(-201,`No provider for ${Mt(n)} found${o}`)}function gn(n,i){null==n&&function ht(n,i,o,c){throw new Error(`ASSERTION ERROR: ${n}`+(null==c?"":` [Expected=> ${o} ${c} ${i} <=Actual]`))}(i,n,null,"!=")}function li(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function ri(n){return{providers:n.providers||[],imports:n.imports||[]}}function xi(n){return ps(n,Jr)||ps(n,za)}function ps(n,i){return n.hasOwnProperty(i)?n[i]:null}function Rs(n){return n&&(n.hasOwnProperty(xo)||n.hasOwnProperty(jl))?n[xo]:null}const Jr=Ne({\u0275prov:Ne}),xo=Ne({\u0275inj:Ne}),za=Ne({ngInjectableDef:Ne}),jl=Ne({ngInjectorDef:Ne});var tn=(()=>((tn=tn||{})[tn.Default=0]="Default",tn[tn.Host=1]="Host",tn[tn.Self=2]="Self",tn[tn.SkipSelf=4]="SkipSelf",tn[tn.Optional=8]="Optional",tn))();let xr;function Gt(n){const i=xr;return xr=n,i}function pn(n,i,o){const c=xi(n);return c&&"root"==c.providedIn?void 0===c.value?c.value=c.factory():c.value:o&tn.Optional?null:void 0!==i?i:void sn(Ge(n),"Injector")}function Ir(n){return{toString:n}.toString()}var Ci=(()=>((Ci=Ci||{})[Ci.OnPush=0]="OnPush",Ci[Ci.Default=1]="Default",Ci))(),Qr=(()=>{return(n=Qr||(Qr={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",Qr;var n})();const zt="undefined"!=typeof globalThis&&globalThis,Xl="undefined"!=typeof window&&window,Xn="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,ni=zt||"undefined"!=typeof global&&global||Xl||Xn,hi={},An=[],es=Ne({\u0275cmp:Ne}),Gr=Ne({\u0275dir:Ne}),ts=Ne({\u0275pipe:Ne}),Vo=Ne({\u0275mod:Ne}),Qn=Ne({\u0275fac:Ne}),sr=Ne({__NG_ELEMENT_ID__:Ne});let fe=0;function le(n){return Ir(()=>{const o={},c={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:o,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===Ci.OnPush,directiveDefs:null,pipeDefs:null,selectors:n.selectors||An,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||Qr.Emulated,id:"c",styles:n.styles||An,_:null,setInput:null,schemas:n.schemas||null,tView:null},h=n.directives,f=n.features,g=n.pipes;return c.id+=fe++,c.inputs=gr(n.inputs,o),c.outputs=gr(n.outputs),f&&f.forEach(b=>b(c)),c.directiveDefs=h?()=>("function"==typeof h?h():h).map(he):null,c.pipeDefs=g?()=>("function"==typeof g?g():g).map($e):null,c})}function he(n){return Kt(n)||function Mr(n){return n[Gr]||null}(n)}function $e(n){return function Wr(n){return n[ts]||null}(n)}const on={};function On(n){return Ir(()=>{const i={type:n.type,bootstrap:n.bootstrap||An,declarations:n.declarations||An,imports:n.imports||An,exports:n.exports||An,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null};return null!=n.id&&(on[n.id]=n.type),i})}function gr(n,i){if(null==n)return hi;const o={};for(const c in n)if(n.hasOwnProperty(c)){let h=n[c],f=h;Array.isArray(h)&&(f=h[1],h=h[0]),o[h]=c,i&&(i[h]=f)}return o}const Ys=le;function ns(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,onDestroy:n.type.prototype.ngOnDestroy||null}}function Kt(n){return n[es]||null}function Ni(n,i){const o=n[Vo]||null;if(!o&&!0===i)throw new Error(`Type ${Ge(n)} does not have '\u0275mod' property.`);return o}function br(n){return Array.isArray(n)&&"object"==typeof n[1]}function Di(n){return Array.isArray(n)&&!0===n[1]}function Wa(n){return 0!=(8&n.flags)}function Ls(n){return 2==(2&n.flags)}function jo(n){return 1==(1&n.flags)}function Pr(n){return null!==n.template}function ou(n){return 0!=(512&n[2])}function Ms(n,i){return n.hasOwnProperty(Qn)?n[Qn]:null}class Ya{constructor(i,o,c){this.previousValue=i,this.currentValue=o,this.firstChange=c}isFirstChange(){return this.firstChange}}function Za(){return Jl}function Jl(n){return n.type.prototype.ngOnChanges&&(n.setInput=Ql),zh}function zh(){const n=cu(this),i=null==n?void 0:n.current;if(i){const o=n.previous;if(o===hi)n.previous=i;else for(let c in i)o[c]=i[c];n.current=null,this.ngOnChanges(i)}}function Ql(n,i,o,c){const h=cu(n)||function Qs(n,i){return n[Ns]=i}(n,{previous:hi,current:null}),f=h.current||(h.current={}),g=h.previous,b=this.declaredInputs[o],T=g[b];f[b]=new Ya(T&&T.currentValue,i,g===hi),n[c]=i}Za.ngInherit=!0;const Ns="__ngSimpleChanges__";function cu(n){return n[Ns]||null}const R="math";let G;function se(n){G=n}function pt(n){return!!n.listen}const pi={createRenderer:(n,i)=>function Te(){return void 0!==G?G:"undefined"!=typeof document?document:void 0}()};function qt(n){for(;Array.isArray(n);)n=n[0];return n}function qn(n,i){return qt(i[n.index])}function Nr(n,i){return n.data[i]}function Ri(n,i){const o=i[n];return br(o)?o:o[0]}function mi(n){return 4==(4&n[2])}function Os(n){return 128==(128&n[2])}function Or(n,i){return null==i?null:n[i]}function Vh(n){n[18]=0}function yi(n,i){n[5]+=i;let o=n,c=n[3];for(;null!==c&&(1===i&&1===o[5]||-1===i&&0===o[5]);)c[5]+=i,o=c,c=c[3]}const _n={lFrame:gu(null),bindingsEnabled:!0};function nc(){return _n.bindingsEnabled}function Fe(){return _n.lFrame.lView}function Dn(){return _n.lFrame.tView}function Ii(){let n=du();for(;null!==n&&64===n.type;)n=n.parent;return n}function du(){return _n.lFrame.currentTNode}function Fs(n,i){const o=_n.lFrame;o.currentTNode=n,o.isParent=i}function Fr(){return _n.lFrame.isParent}function qo(){_n.lFrame.isParent=!1}function Zo(){return _n.lFrame.bindingIndex++}function pu(n,i){const o=_n.lFrame;o.bindingIndex=o.bindingRootIndex=n,oc(i)}function oc(n){_n.lFrame.currentDirectiveIndex=n}function lc(){return _n.lFrame.currentQueryIndex}function Wh(n){_n.lFrame.currentQueryIndex=n}function mu(n){const i=n[1];return 2===i.type?i.declTNode:1===i.type?n[6]:null}function cc(n,i,o){if(o&tn.SkipSelf){let h=i,f=n;for(;!(h=h.parent,null!==h||o&tn.Host||(h=mu(f),null===h||(f=f[15],10&h.type))););if(null===h)return!1;i=h,n=f}const c=_n.lFrame=uc();return c.currentTNode=i,c.lView=n,!0}function Sa(n){const i=uc(),o=n[1];_n.lFrame=i,i.currentTNode=o.firstChild,i.lView=n,i.tView=o,i.contextLView=n,i.bindingIndex=o.bindingStartIndex,i.inI18n=!1}function uc(){const n=_n.lFrame,i=null===n?null:n.child;return null===i?gu(n):i}function gu(n){const i={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=i),i}function yu(){const n=_n.lFrame;return _n.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const vu=yu;function el(){const n=yu();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function lr(){return _n.lFrame.selectedIndex}function to(n){_n.lFrame.selectedIndex=n}function Si(){const n=_n.lFrame;return Nr(n.tView,n.selectedIndex)}function xu(){_n.lFrame.currentNamespace="svg"}function dc(){!function Mu(){_n.lFrame.currentNamespace=null}()}function tl(n,i){for(let o=i.directiveStart,c=i.directiveEnd;o<c;o++){const f=n.data[o].type.prototype,{ngAfterContentInit:g,ngAfterContentChecked:b,ngAfterViewInit:T,ngAfterViewChecked:O,ngOnDestroy:B}=f;g&&(n.contentHooks||(n.contentHooks=[])).push(-o,g),b&&((n.contentHooks||(n.contentHooks=[])).push(o,b),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(o,b)),T&&(n.viewHooks||(n.viewHooks=[])).push(-o,T),O&&((n.viewHooks||(n.viewHooks=[])).push(o,O),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(o,O)),null!=B&&(n.destroyHooks||(n.destroyHooks=[])).push(o,B)}}function Ta(n,i,o){Ur(n,i,3,o)}function fc(n,i,o,c){(3&n[2])===o&&Ur(n,i,o,c)}function bu(n,i){let o=n[2];(3&o)===i&&(o&=2047,o+=1,n[2]=o)}function Ur(n,i,o,c){const f=null!=c?c:-1,g=i.length-1;let b=0;for(let T=void 0!==c?65535&n[18]:0;T<g;T++)if("number"==typeof i[T+1]){if(b=i[T],null!=c&&b>=c)break}else i[T]<0&&(n[18]+=65536),(b<f||-1==f)&&(pc(n,o,i,T),n[18]=(4294901760&n[18])+T+2),T++}function pc(n,i,o,c){const h=o[c]<0,f=o[c+1],b=n[h?-o[c]:o[c]];if(h){if(n[2]>>11<n[18]>>16&&(3&n[2])===i){n[2]+=2048;try{f.call(b)}finally{}}}else try{f.call(b)}finally{}}class no{constructor(i,o,c){this.factory=i,this.resolving=!1,this.canSeeViewProviders=o,this.injectImpl=c}}function Ko(n,i,o){const c=pt(n);let h=0;for(;h<o.length;){const f=o[h];if("number"==typeof f){if(0!==f)break;h++;const g=o[h++],b=o[h++],T=o[h++];c?n.setAttribute(i,b,T,g):i.setAttributeNS(g,b,T)}else{const g=f,b=o[++h];ro(g)?c&&n.setProperty(i,g,b):c?n.setAttribute(i,g,b):i.setAttribute(g,b),h++}}return h}function Jo(n){return 3===n||4===n||6===n}function ro(n){return 64===n.charCodeAt(0)}function il(n,i){if(null!==i&&0!==i.length)if(null===n||0===n.length)n=i.slice();else{let o=-1;for(let c=0;c<i.length;c++){const h=i[c];"number"==typeof h?o=h:0===o||To(n,o,h,null,-1===o||2===o?i[++c]:null)}}return n}function To(n,i,o,c,h){let f=0,g=n.length;if(-1===i)g=-1;else for(;f<n.length;){const b=n[f++];if("number"==typeof b){if(b===i){g=-1;break}if(b>i){g=f-1;break}}}for(;f<n.length;){const b=n[f];if("number"==typeof b)break;if(b===o){if(null===c)return void(null!==h&&(n[f+1]=h));if(c===n[f+1])return void(n[f+2]=h)}f++,null!==c&&f++,null!==h&&f++}-1!==g&&(n.splice(g,0,i),f=g+1),n.splice(f++,0,o),null!==c&&n.splice(f++,0,c),null!==h&&n.splice(f++,0,h)}function Xh(n){return-1!==n}function as(n){return 32767&n}function Sr(n,i){let o=function Ln(n){return n>>16}(n),c=i;for(;o>0;)c=c[15],o--;return c}let mc=!0;function gc(n){const i=mc;return mc=n,i}let Yh=0;function yc(n,i){const o=Zh(n,i);if(-1!==o)return o;const c=i[1];c.firstCreatePass&&(n.injectorIndex=i.length,wu(c.data,n),wu(i,null),wu(c.blueprint,null));const h=Kh(n,i),f=n.injectorIndex;if(Xh(h)){const g=as(h),b=Sr(h,i),T=b[1].data;for(let O=0;O<8;O++)i[f+O]=b[g+O]|T[g+O]}return i[f+8]=h,f}function wu(n,i){n.push(0,0,0,0,0,0,0,0,i)}function Zh(n,i){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===i[n.injectorIndex+8]?-1:n.injectorIndex}function Kh(n,i){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let o=0,c=null,h=i;for(;null!==h;){const f=h[1],g=f.type;if(c=2===g?f.declTNode:1===g?h[6]:null,null===c)return-1;if(o++,h=h[15],-1!==c.injectorIndex)return c.injectorIndex|o<<16}return-1}function w(n,i,o){!function Um(n,i,o){let c;"string"==typeof o?c=o.charCodeAt(0)||0:o.hasOwnProperty(sr)&&(c=o[sr]),null==c&&(c=o[sr]=Yh++);const h=255&c;i.data[n+(h>>5)]|=1<<h}(n,i,o)}function v(n,i,o){if(o&tn.Optional)return n;sn(i,"NodeInjector")}function C(n,i,o,c){if(o&tn.Optional&&void 0===c&&(c=null),0==(o&(tn.Self|tn.Host))){const h=n[9],f=Gt(void 0);try{return h?h.get(i,c,o&tn.Optional):pn(i,c,o&tn.Optional)}finally{Gt(f)}}return v(c,i,o)}function P(n,i,o,c=tn.Default,h){if(null!==n){const f=function xn(n){if("string"==typeof n)return n.charCodeAt(0)||0;const i=n.hasOwnProperty(sr)?n[sr]:void 0;return"number"==typeof i?i>=0?255&i:K:i}(o);if("function"==typeof f){if(!cc(i,n,c))return c&tn.Host?v(h,o,c):C(i,o,c,h);try{const g=f(c);if(null!=g||c&tn.Optional)return g;sn(o)}finally{vu()}}else if("number"==typeof f){let g=null,b=Zh(n,i),T=-1,O=c&tn.Host?i[16][6]:null;for((-1===b||c&tn.SkipSelf)&&(T=-1===b?Kh(n,i):i[b+8],-1!==T&&oi(c,!1)?(g=i[1],b=as(T),i=Sr(T,i)):b=-1);-1!==b;){const B=i[1];if(Ft(f,b,B.data)){const X=ie(b,i,o,g,c,O);if(X!==H)return X}T=i[b+8],-1!==T&&oi(c,i[1].data[b+8]===O)&&Ft(f,b,i)?(g=B,b=as(T),i=Sr(T,i)):b=-1}}}return C(i,o,c,h)}const H={};function K(){return new Yn(Ii(),Fe())}function ie(n,i,o,c,h,f){const g=i[1],b=g.data[n+8],B=pe(b,g,o,null==c?Ls(b)&&mc:c!=g&&0!=(3&b.type),h&tn.Host&&f===b);return null!==B?st(i,g,B,b):H}function pe(n,i,o,c,h){const f=n.providerIndexes,g=i.data,b=1048575&f,T=n.directiveStart,B=f>>20,re=h?b+B:n.directiveEnd;for(let ue=c?b:b+B;ue<re;ue++){const Ie=g[ue];if(ue<T&&o===Ie||ue>=T&&Ie.type===o)return ue}if(h){const ue=g[T];if(ue&&Pr(ue)&&ue.type===o)return T}return null}function st(n,i,o,c){let h=n[o];const f=i.data;if(function io(n){return n instanceof no}(h)){const g=h;g.resolving&&function yn(n,i){const o=i?`. Dependency path: ${i.join(" > ")} > ${n}`:"";throw new ut(-200,`Circular dependency in DI detected for ${n}${o}`)}(Mt(f[o]));const b=gc(g.canSeeViewProviders);g.resolving=!0;const T=g.injectImpl?Gt(g.injectImpl):null;cc(n,c,tn.Default);try{h=n[o]=g.factory(void 0,f,n,c),i.firstCreatePass&&o>=c.directiveStart&&function jh(n,i,o){const{ngOnChanges:c,ngOnInit:h,ngDoCheck:f}=i.type.prototype;if(c){const g=Jl(i);(o.preOrderHooks||(o.preOrderHooks=[])).push(n,g),(o.preOrderCheckHooks||(o.preOrderCheckHooks=[])).push(n,g)}h&&(o.preOrderHooks||(o.preOrderHooks=[])).push(0-n,h),f&&((o.preOrderHooks||(o.preOrderHooks=[])).push(n,f),(o.preOrderCheckHooks||(o.preOrderCheckHooks=[])).push(n,f))}(o,f[o],i)}finally{null!==T&&Gt(T),gc(b),g.resolving=!1,vu()}}return h}function Ft(n,i,o){return!!(o[i+(n>>5)]&1<<n)}function oi(n,i){return!(n&tn.Self||n&tn.Host&&i)}class Yn{constructor(i,o){this._tNode=i,this._lView=o}get(i,o,c){return P(this._tNode,this._lView,i,c,o)}}function vc(n){return function _(n,i){if("class"===i)return n.classes;if("style"===i)return n.styles;const o=n.attrs;if(o){const c=o.length;let h=0;for(;h<c;){const f=o[h];if(Jo(f))break;if(0===f)h+=2;else if("number"==typeof f)for(h++;h<c&&"string"==typeof o[h];)h++;else{if(f===i)return o[h+1];h+=2}}}return null}(Ii(),n)}const so="__parameters__";function Su(n,i,o){return Ir(()=>{const c=function km(n){return function(...o){if(n){const c=n(...o);for(const h in c)this[h]=c[h]}}}(i);function h(...f){if(this instanceof h)return c.apply(this,f),this;const g=new h(...f);return b.annotation=g,b;function b(T,O,B){const X=T.hasOwnProperty(so)?T[so]:Object.defineProperty(T,so,{value:[]})[so];for(;X.length<=B;)X.push(null);return(X[B]=X[B]||[]).push(g),T}}return o&&(h.prototype=Object.create(o.prototype)),h.prototype.ngMetadataName=n,h.annotationCls=h,h})}class Oi{constructor(i,o){this._desc=i,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof o?this.__NG_ELEMENT_ID__=o:void 0!==o&&(this.\u0275prov=li({token:this,providedIn:o.providedIn||"root",factory:o.factory}))}toString(){return`InjectionToken ${this._desc}`}}const Qo=new Oi("AnalyzeForEntryComponents");function Us(n,i){void 0===i&&(i=n);for(let o=0;o<n.length;o++){let c=n[o];Array.isArray(c)?(i===n&&(i=n.slice(0,o)),Us(c,i)):i!==n&&i.push(c)}return i}function Co(n,i){n.forEach(o=>Array.isArray(o)?Co(o,i):i(o))}function Hm(n,i,o){i>=n.length?n.push(o):n.splice(i,0,o)}function Qh(n,i){return i>=n.length-1?n.pop():n.splice(i,1)[0]}function Du(n,i){const o=[];for(let c=0;c<n;c++)o.push(i);return o}const Do={},Iu="__NG_DI_FLAG__",td="ngTempTokenPath",k0=/\n/gm,Wm="__source",H0=Ne({provide:String,useValue:Ne});let Yr;function al(n){const i=Yr;return Yr=n,i}function $m(n,i=tn.Default){if(void 0===Yr)throw new ut(203,"");return null===Yr?pn(n,void 0,i):Yr.get(n,i&tn.Optional?null:void 0,i)}function Ar(n,i=tn.Default){return(function ii(){return xr}()||$m)(gt(n),i)}const Uf=Ar;function kf(n){const i=[];for(let o=0;o<n.length;o++){const c=gt(n[o]);if(Array.isArray(c)){if(0===c.length)throw new ut(900,"");let h,f=tn.Default;for(let g=0;g<c.length;g++){const b=c[g],T=vi(b);"number"==typeof T?-1===T?h=b.token:f|=T:h=b}i.push(Ar(h,f))}else i.push(Ar(c))}return i}function ks(n,i){return n[Iu]=i,n.prototype[Iu]=i,n}function vi(n){return n[Iu]}const xc=ks(Su("Inject",n=>({token:n})),-1),nd=ks(Su("Optional"),8),id=ks(Su("SkipSelf"),4);var Bs=(()=>((Bs=Bs||{})[Bs.Important=1]="Important",Bs[Bs.DashCase=2]="DashCase",Bs))();const na="__ngContext__";function _r(n,i){n[na]=i}function Uu(n){const i=function Da(n){return n[na]||null}(n);return i?Array.isArray(i)?i:i.lView:null}function ld(n,i){return undefined(n,i)}function Bu(n){const i=n[3];return Di(i)?i[3]:i}function lo(n){return Sc(n[13])}function wc(n){return Sc(n[4])}function Sc(n){for(;null!==n&&!Di(n);)n=n[4];return n}function Tc(n,i,o,c,h){if(null!=c){let f,g=!1;Di(c)?f=c:br(c)&&(g=!0,c=c[0]);const b=qt(c);0===n&&null!==o?null==h?Ac(i,o,b):gl(i,o,b,h||null,!0):1===n&&null!==o?gl(i,o,b,h||null,!0):2===n?function Cc(n,i,o){const c=yl(n,i);c&&function uo(n,i,o,c){pt(n)?n.removeChild(i,o,c):i.removeChild(o)}(n,c,i,o)}(i,b,g):3===n&&i.destroyNode(b),null!=f&&function yM(n,i,o,c,h){const f=o[7];f!==qt(o)&&Tc(i,n,c,f,h);for(let b=10;b<o.length;b++){const T=o[b];hd(T[1],T,n,i,c,f)}}(i,n,f,o,h)}}function Wf(n,i,o){if(pt(n))return n.createElement(i,o);{const c=null!==o?function I(n){const i=n.toLowerCase();return"svg"===i?"http://www.w3.org/2000/svg":i===R?"http://www.w3.org/1998/MathML/":null}(o):null;return null===c?n.createElement(i):n.createElementNS(c,i)}}function ml(n,i){const o=n[9],c=o.indexOf(i),h=i[3];1024&i[2]&&(i[2]&=-1025,yi(h,-1)),o.splice(c,1)}function Ra(n,i){if(n.length<=10)return;const o=10+i,c=n[o];if(c){const h=c[17];null!==h&&h!==n&&ml(h,c),i>0&&(n[o-1][4]=c[4]);const f=Qh(n,10+i);!function qm(n,i){hd(n,i,i[11],2,null,null),i[0]=null,i[6]=null}(c[1],c);const g=f[19];null!==g&&g.detachView(f[1]),c[3]=null,c[4]=null,c[2]&=-129}return c}function jf(n,i){if(!(256&i[2])){const o=i[11];pt(o)&&o.destroyNode&&hd(n,i,o,3,null,null),function ra(n){let i=n[13];if(!i)return Hu(n[1],n);for(;i;){let o=null;if(br(i))o=i[13];else{const c=i[10];c&&(o=c)}if(!o){for(;i&&!i[4]&&i!==n;)br(i)&&Hu(i[1],i),i=i[3];null===i&&(i=n),br(i)&&Hu(i[1],i),o=i&&i[4]}i=o}}(i)}}function Hu(n,i){if(!(256&i[2])){i[2]&=-129,i[2]|=256,function qf(n,i){let o;if(null!=n&&null!=(o=n.destroyHooks))for(let c=0;c<o.length;c+=2){const h=i[o[c]];if(!(h instanceof no)){const f=o[c+1];if(Array.isArray(f))for(let g=0;g<f.length;g+=2){const b=h[f[g]],T=f[g+1];try{T.call(b)}finally{}}else try{f.call(h)}finally{}}}}(n,i),function Xf(n,i){const o=n.cleanup,c=i[7];let h=-1;if(null!==o)for(let f=0;f<o.length-1;f+=2)if("string"==typeof o[f]){const g=o[f+1],b="function"==typeof g?g(i):qt(i[g]),T=c[h=o[f+2]],O=o[f+3];"boolean"==typeof O?b.removeEventListener(o[f],T,O):O>=0?c[h=O]():c[h=-O].unsubscribe(),f+=2}else{const g=c[h=o[f+1]];o[f].call(g)}if(null!==c){for(let f=h+1;f<c.length;f++)c[f]();i[7]=null}}(n,i),1===i[1].type&&pt(i[11])&&i[11].destroy();const o=i[17];if(null!==o&&Di(i[3])){o!==i[3]&&ml(o,i);const c=i[19];null!==c&&c.detachView(n)}}}function zu(n,i,o){return function us(n,i,o){let c=i;for(;null!==c&&40&c.type;)c=(i=c).parent;if(null===c)return o[0];if(2&c.flags){const h=n.data[c.directiveStart].encapsulation;if(h===Qr.None||h===Qr.Emulated)return null}return qn(c,o)}(n,i.parent,o)}function gl(n,i,o,c,h){pt(n)?n.insertBefore(i,o,c,h):i.insertBefore(o,c,h)}function Ac(n,i,o){pt(n)?n.appendChild(i,o):i.appendChild(o)}function Yf(n,i,o,c,h){null!==c?gl(n,i,o,c,h):Ac(n,i,o)}function yl(n,i){return pt(n)?n.parentNode(i):i.parentNode}function Pt(n,i,o){return Ia(n,i,o)}let Kf,Ia=function Cr(n,i,o){return 40&n.type?qn(n,o):null};function Dr(n,i,o,c){const h=zu(n,c,i),f=i[11],b=Pt(c.parent||i[6],c,i);if(null!=h)if(Array.isArray(o))for(let T=0;T<o.length;T++)Yf(f,h,o[T],b,!1);else Yf(f,h,o,b,!1)}function Pa(n,i){if(null!==i){const o=i.type;if(3&o)return qn(i,n);if(4&o)return Wi(-1,n[i.index]);if(8&o){const c=i.child;if(null!==c)return Pa(n,c);{const h=n[i.index];return Di(h)?Wi(-1,h):qt(h)}}if(32&o)return ld(i,n)()||qt(n[i.index]);{const c=$0(n,i);return null!==c?Array.isArray(c)?c[0]:Pa(Bu(n[16]),c):Pa(n,i.next)}}return null}function $0(n,i){return null!==i?n[16][6].projection[i.projection]:null}function Wi(n,i){const o=10+n+1;if(o<i.length){const c=i[o],h=c[1].firstChild;if(null!==h)return Pa(c,h)}return i[7]}function cr(n,i,o,c,h,f,g){for(;null!=o;){const b=c[o.index],T=o.type;if(g&&0===i&&(b&&_r(qt(b),c),o.flags|=4),64!=(64&o.flags))if(8&T)cr(n,i,o.child,c,h,f,!1),Tc(i,n,h,b,f);else if(32&T){const O=ld(o,c);let B;for(;B=O();)Tc(i,n,h,B,f);Tc(i,n,h,b,f)}else 16&T?j0(n,i,c,o,h,f):Tc(i,n,h,b,f);o=g?o.projectionNext:o.next}}function hd(n,i,o,c,h,f){cr(o,c,n.firstChild,i,h,f,!1)}function j0(n,i,o,c,h,f){const g=o[16],T=g[6].projection[c.projection];if(Array.isArray(T))for(let O=0;O<T.length;O++)Tc(i,n,h,T[O],f);else cr(n,i,T,g[3],h,f,!0)}function X0(n,i,o){pt(n)?n.setAttribute(i,"style",o):i.style.cssText=o}function dd(n,i,o){pt(n)?""===o?n.removeAttribute(i,"class"):n.setAttribute(i,"class",o):i.className=o}function Dc(n){var i;return(null===(i=function Wt(){if(void 0===Kf&&(Kf=null,ni.trustedTypes))try{Kf=ni.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch(n){}return Kf}())||void 0===i?void 0:i.createHTML(n))||n}class Ts{constructor(i){this.changingThisBreaksApplicationSecurity=i}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class fd extends Ts{getTypeName(){return"HTML"}}class Jm extends Ts{getTypeName(){return"Style"}}class Ic extends Ts{getTypeName(){return"Script"}}class Pc extends Ts{getTypeName(){return"URL"}}class Lc extends Ts{getTypeName(){return"ResourceURL"}}function fo(n){return n instanceof Ts?n.changingThisBreaksApplicationSecurity:n}function oa(n,i){const o=Vu(n);if(null!=o&&o!==i){if("ResourceURL"===o&&"URL"===i)return!0;throw new Error(`Required a safe ${i}, got a ${o} (see https://g.co/ng/security#xss)`)}return o===i}function Vu(n){return n instanceof Ts&&n.getTypeName()||null}function pd(n){return new fd(n)}function md(n){return new Jm(n)}function Qm(n){return new Ic(n)}function eg(n){return new Pc(n)}function tg(n){return new Lc(n)}class gd{constructor(i){this.inertDocumentHelper=i}getInertBodyElement(i){i="<body><remove></remove>"+i;try{const o=(new window.DOMParser).parseFromString(Dc(i),"text/html").body;return null===o?this.inertDocumentHelper.getInertBodyElement(i):(o.removeChild(o.firstChild),o)}catch(o){return null}}}class hs{constructor(i){if(this.defaultDoc=i,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const o=this.inertDocument.createElement("html");this.inertDocument.appendChild(o);const c=this.inertDocument.createElement("body");o.appendChild(c)}}getInertBodyElement(i){const o=this.inertDocument.createElement("template");if("content"in o)return o.innerHTML=Dc(i),o;const c=this.inertDocument.createElement("body");return c.innerHTML=Dc(i),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(c),c}stripCustomNsAttrs(i){const o=i.attributes;for(let h=o.length-1;0<h;h--){const g=o.item(h).name;("xmlns:ns1"===g||0===g.indexOf("ns1:"))&&i.removeAttribute(g)}let c=i.firstChild;for(;c;)c.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(c),c=c.nextSibling}}const yd=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,Nc=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function pr(n){return(n=String(n)).match(yd)||n.match(Nc)?n:"unsafe:"+n}function po(n){const i={};for(const o of n.split(","))i[o]=!0;return i}function $u(...n){const i={};for(const o of n)for(const c in o)o.hasOwnProperty(c)&&(i[c]=!0);return i}const ig=po("area,br,col,hr,img,wbr"),rg=po("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Io=po("rp,rt"),La=$u(ig,$u(rg,po("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),$u(Io,po("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),$u(Io,rg)),Qf=po("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Oc=po("srcset"),ag=$u(Qf,Oc,po("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),po("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),Z0=po("script,style,template");class _l{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(i){let o=i.firstChild,c=!0;for(;o;)if(o.nodeType===Node.ELEMENT_NODE?c=this.startElement(o):o.nodeType===Node.TEXT_NODE?this.chars(o.nodeValue):this.sanitizedSomething=!0,c&&o.firstChild)o=o.firstChild;else for(;o;){o.nodeType===Node.ELEMENT_NODE&&this.endElement(o);let h=this.checkClobberedElement(o,o.nextSibling);if(h){o=h;break}o=this.checkClobberedElement(o,o.parentNode)}return this.buf.join("")}startElement(i){const o=i.nodeName.toLowerCase();if(!La.hasOwnProperty(o))return this.sanitizedSomething=!0,!Z0.hasOwnProperty(o);this.buf.push("<"),this.buf.push(o);const c=i.attributes;for(let h=0;h<c.length;h++){const f=c.item(h),g=f.name,b=g.toLowerCase();if(!ag.hasOwnProperty(b)){this.sanitizedSomething=!0;continue}let T=f.value;Qf[b]&&(T=pr(T)),Oc[b]&&(n=T,T=(n=String(n)).split(",").map(i=>pr(i.trim())).join(", ")),this.buf.push(" ",g,'="',_d(T),'"')}var n;return this.buf.push(">"),!0}endElement(i){const o=i.nodeName.toLowerCase();La.hasOwnProperty(o)&&!ig.hasOwnProperty(o)&&(this.buf.push("</"),this.buf.push(o),this.buf.push(">"))}chars(i){this.buf.push(_d(i))}checkClobberedElement(i,o){if(o&&(i.compareDocumentPosition(o)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${i.outerHTML}`);return o}}const xl=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,vd=/([^\#-~ |!])/g;function _d(n){return n.replace(/&/g,"&amp;").replace(xl,function(i){return"&#"+(1024*(i.charCodeAt(0)-55296)+(i.charCodeAt(1)-56320)+65536)+";"}).replace(vd,function(i){return"&#"+i.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Xu;function lg(n,i){let o=null;try{Xu=Xu||function Gu(n){const i=new hs(n);return function Y0(){try{return!!(new window.DOMParser).parseFromString(Dc(""),"text/html")}catch(n){return!1}}()?new gd(i):i}(n);let c=i?String(i):"";o=Xu.getInertBodyElement(c);let h=5,f=c;do{if(0===h)throw new Error("Failed to sanitize html because the input is unstable");h--,c=f,f=o.innerHTML,o=Xu.getInertBodyElement(c)}while(c!==f);return Dc((new _l).sanitizeChildren(Ml(o)||o))}finally{if(o){const c=Ml(o)||o;for(;c.firstChild;)c.removeChild(c.firstChild)}}}function Ml(n){return"content"in n&&function K0(n){return n.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===n.nodeName}(n)?n.content:null}var er=(()=>((er=er||{})[er.NONE=0]="NONE",er[er.HTML=1]="HTML",er[er.STYLE=2]="STYLE",er[er.SCRIPT=3]="SCRIPT",er[er.URL=4]="URL",er[er.RESOURCE_URL=5]="RESOURCE_URL",er))();function ep(n){const i=function qu(){const n=Fe();return n&&n[12]}();return i?i.sanitize(er.URL,n)||"":oa(n,"URL")?fo(n):pr(We(n))}function np(n){return n.ngOriginalError}function lv(n,...i){n.error(...i)}class xd{constructor(){this._console=console}handleError(i){const o=this._findOriginalError(i),c=function av(n){return n&&n.ngErrorLogger||lv}(i);c(this._console,"ERROR",i),o&&c(this._console,"ORIGINAL ERROR",o)}_findOriginalError(i){let o=i&&np(i);for(;o&&np(o);)o=np(o);return o||null}}const mv=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(ni))();function Po(n){return n instanceof Function?n():n}function hg(n,i,o){let c=n.length;for(;;){const h=n.indexOf(i,o);if(-1===h)return h;if(0===h||n.charCodeAt(h-1)<=32){const f=i.length;if(h+f===c||n.charCodeAt(h+f)<=32)return h}o=h+1}}const dg="ng-template";function _v(n,i,o){let c=0;for(;c<n.length;){let h=n[c++];if(o&&"class"===h){if(h=n[c],-1!==hg(h.toLowerCase(),i,0))return!0}else if(1===h){for(;c<n.length&&"string"==typeof(h=n[c++]);)if(h.toLowerCase()===i)return!0;return!1}}return!1}function fg(n){return 4===n.type&&n.value!==dg}function xv(n,i,o){return i===(4!==n.type||o?n.value:dg)}function Mv(n,i,o){let c=4;const h=n.attrs||[],f=function wv(n){for(let i=0;i<n.length;i++)if(Jo(n[i]))return i;return n.length}(h);let g=!1;for(let b=0;b<i.length;b++){const T=i[b];if("number"!=typeof T){if(!g)if(4&c){if(c=2|1&c,""!==T&&!xv(n,T,o)||""===T&&1===i.length){if(mo(c))return!1;g=!0}}else{const O=8&c?T:i[++b];if(8&c&&null!==n.attrs){if(!_v(n.attrs,O,o)){if(mo(c))return!1;g=!0}continue}const X=bv(8&c?"class":T,h,fg(n),o);if(-1===X){if(mo(c))return!1;g=!0;continue}if(""!==O){let re;re=X>f?"":h[X+1].toLowerCase();const ue=8&c?re:null;if(ue&&-1!==hg(ue,O,0)||2&c&&O!==re){if(mo(c))return!1;g=!0}}}}else{if(!g&&!mo(c)&&!mo(T))return!1;if(g&&mo(T))continue;g=!1,c=T|1&c}}return mo(c)||g}function mo(n){return 0==(1&n)}function bv(n,i,o,c){if(null===i)return-1;let h=0;if(c||!o){let f=!1;for(;h<i.length;){const g=i[h];if(g===n)return h;if(3===g||6===g)f=!0;else{if(1===g||2===g){let b=i[++h];for(;"string"==typeof b;)b=i[++h];continue}if(4===g)break;if(0===g){h+=4;continue}}h+=f?1:2}return-1}return function Sv(n,i){let o=n.indexOf(4);if(o>-1)for(o++;o<n.length;){const c=n[o];if("number"==typeof c)return-1;if(c===i)return o;o++}return-1}(i,n)}function pg(n,i,o=!1){for(let c=0;c<i.length;c++)if(Mv(n,i[c],o))return!0;return!1}function Tv(n,i){e:for(let o=0;o<i.length;o++){const c=i[o];if(n.length===c.length){for(let h=0;h<n.length;h++)if(n[h]!==c[h])continue e;return!0}}return!1}function mg(n,i){return n?":not("+i.trim()+")":i}function Av(n){let i=n[0],o=1,c=2,h="",f=!1;for(;o<n.length;){let g=n[o];if("string"==typeof g)if(2&c){const b=n[++o];h+="["+g+(b.length>0?'="'+b+'"':"")+"]"}else 8&c?h+="."+g:4&c&&(h+=" "+g);else""!==h&&!mo(g)&&(i+=mg(f,h),h=""),c=g,f=f||!mo(c);o++}return""!==h&&(i+=mg(f,h)),i}const Rn={};function gg(n){yg(Dn(),Fe(),lr()+n,!1)}function yg(n,i,o,c){if(!c)if(3==(3&i[2])){const f=n.preOrderCheckHooks;null!==f&&Ta(i,f,o)}else{const f=n.preOrderHooks;null!==f&&fc(i,f,0,o)}to(o)}function Bv(n,i){const o=n.contentQueries;if(null!==o)for(let c=0;c<o.length;c+=2){const h=o[c],f=o[c+1];if(-1!==f){const g=n.data[f];Wh(h),g.contentQueries(2,i[f],f)}}}function wd(n,i,o,c,h,f,g,b,T,O){const B=i.blueprint.slice();return B[0]=h,B[2]=140|c,Vh(B),B[3]=B[15]=n,B[8]=o,B[10]=g||n&&n[10],B[11]=b||n&&n[11],B[12]=T||n&&n[12]||null,B[9]=O||n&&n[9]||null,B[6]=f,B[16]=2==i.type?n[16]:B,B}function Yu(n,i,o,c,h){let f=n.data[i];if(null===f)f=function Dg(n,i,o,c,h){const f=du(),g=Fr(),T=n.data[i]=function XM(n,i,o,c,h,f){return{type:o,index:c,insertBeforeIndex:null,injectorIndex:i?i.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:h,attrs:f,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:i,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,g?f:f&&f.parent,o,i,c,h);return null===n.firstChild&&(n.firstChild=T),null!==f&&(g?null==f.child&&null!==T.parent&&(f.child=T):null===f.next&&(f.next=T)),T}(n,i,o,c,h),function rc(){return _n.lFrame.inI18n}()&&(f.flags|=64);else if(64&f.type){f.type=o,f.value=c,f.attrs=h;const g=function wr(){const n=_n.lFrame,i=n.currentTNode;return n.isParent?i:i.parent}();f.injectorIndex=null===g?-1:g.injectorIndex}return Fs(f,!0),f}function Zu(n,i,o,c){if(0===o)return-1;const h=i.length;for(let f=0;f<o;f++)i.push(c),n.blueprint.push(c),n.data.push(null);return h}function Sd(n,i,o){Sa(i);try{const c=n.viewQuery;null!==c&&Dd(1,c,o);const h=n.template;null!==h&&Hv(n,i,h,1,o),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&Bv(n,i),n.staticViewQueries&&Dd(2,n.viewQuery,o);const f=n.components;null!==f&&function WM(n,i){for(let o=0;o<i.length;o++)Kv(n,i[o])}(i,f)}catch(c){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),c}finally{i[2]&=-5,el()}}function Ku(n,i,o,c){const h=i[2];if(256!=(256&h)){Sa(i);try{Vh(i),function fu(n){return _n.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==o&&Hv(n,i,o,2,c);const g=3==(3&h);if(g){const O=n.preOrderCheckHooks;null!==O&&Ta(i,O,null)}else{const O=n.preOrderHooks;null!==O&&fc(i,O,0,null),bu(i,0)}if(function kg(n){for(let i=lo(n);null!==i;i=wc(i)){if(!i[2])continue;const o=i[9];for(let c=0;c<o.length;c++){const h=o[c],f=h[3];0==(1024&h[2])&&yi(f,1),h[2]|=1024}}}(i),function Ug(n){for(let i=lo(n);null!==i;i=wc(i))for(let o=10;o<i.length;o++){const c=i[o],h=c[1];Os(c)&&Ku(h,c,h.template,c[8])}}(i),null!==n.contentQueries&&Bv(n,i),g){const O=n.contentCheckHooks;null!==O&&Ta(i,O)}else{const O=n.contentHooks;null!==O&&fc(i,O,1),bu(i,1)}!function VM(n,i){const o=n.hostBindingOpCodes;if(null!==o)try{for(let c=0;c<o.length;c++){const h=o[c];if(h<0)to(~h);else{const f=h,g=o[++c],b=o[++c];pu(g,f),b(2,i[f])}}}finally{to(-1)}}(n,i);const b=n.components;null!==b&&function GM(n,i){for(let o=0;o<i.length;o++)yp(n,i[o])}(i,b);const T=n.viewQuery;if(null!==T&&Dd(2,T,c),g){const O=n.viewCheckHooks;null!==O&&Ta(i,O)}else{const O=n.viewHooks;null!==O&&fc(i,O,2),bu(i,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),i[2]&=-73,1024&i[2]&&(i[2]&=-1025,yi(i[3],-1))}finally{el()}}}function $M(n,i,o,c){const h=i[10],g=mi(i);try{!g&&h.begin&&h.begin(),g&&Sd(n,i,c),Ku(n,i,o,c)}finally{!g&&h.end&&h.end()}}function Hv(n,i,o,c,h){const f=lr(),g=2&c;try{to(-1),g&&i.length>20&&yg(n,i,20,!1),o(c,h)}finally{to(f)}}function Vv(n){const i=n.tView;return null===i||i.incompleteFirstPass?n.tView=dp(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):i}function dp(n,i,o,c,h,f,g,b,T,O){const B=20+c,X=B+h,re=function jM(n,i){const o=[];for(let c=0;c<i;c++)o.push(c<n?null:Rn);return o}(B,X),ue="function"==typeof O?O():O;return re[1]={type:n,blueprint:re,template:o,queries:null,viewQuery:b,declTNode:i,data:re.slice().fill(null,B),bindingStartIndex:B,expandoStartIndex:X,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof f?f():f,pipeRegistry:"function"==typeof g?g():g,firstChild:null,schemas:T,consts:ue,incompleteFirstPass:!1}}function $v(n,i,o,c){const h=bp(i);null===o?h.push(c):(h.push(o),n.firstCreatePass&&Ep(n).push(c,h.length-1))}function jv(n,i,o){for(let c in n)if(n.hasOwnProperty(c)){const h=n[c];(o=null===o?{}:o).hasOwnProperty(c)?o[c].push(i,h):o[c]=[i,h]}return o}function Pg(n,i,o,c,h,f){const g=f.hostBindings;if(g){let b=n.hostBindingOpCodes;null===b&&(b=n.hostBindingOpCodes=[]);const T=~i.index;(function qv(n){let i=n.length;for(;i>0;){const o=n[--i];if("number"==typeof o&&o<0)return o}return 0})(b)!=T&&b.push(T),b.push(c,h,g)}}function El(n,i){null!==n.hostBindings&&n.hostBindings(1,i)}function Oa(n,i){i.flags|=2,(n.components||(n.components=[])).push(i.index)}function Ng(n,i,o){if(o){if(i.exportAs)for(let c=0;c<i.exportAs.length;c++)o[i.exportAs[c]]=n;Pr(i)&&(o[""]=n)}}function Td(n,i,o){n.flags|=1,n.directiveStart=i,n.directiveEnd=i+o,n.providerIndexes=i}function Fa(n,i,o,c,h){n.data[c]=h;const f=h.factory||(h.factory=Ms(h.type)),g=new no(f,Pr(h),null);n.blueprint[c]=g,o[c]=g,Pg(n,i,0,c,Zu(n,o,h.hostVars,Rn),h)}function Uc(n,i,o){const c=qn(i,n),h=Vv(o),f=n[10],g=Cd(n,wd(n,h,null,o.onPush?64:16,c,i,f,f.createRenderer(c,o),null,null));n[i.index]=g}function yo(n,i,o,c,h,f){const g=qn(n,i);!function Ad(n,i,o,c,h,f,g){if(null==f)pt(n)?n.removeAttribute(i,h,o):i.removeAttribute(h);else{const b=null==g?We(f):g(f,c||"",h);pt(n)?n.setAttribute(i,h,b,o):o?i.setAttributeNS(o,h,b):i.setAttribute(h,b)}}(i[11],g,f,n.value,o,c,h)}function Zv(n,i,o,c,h,f){const g=f[i];if(null!==g){const b=c.setInput;for(let T=0;T<g.length;){const O=g[T++],B=g[T++],X=g[T++];null!==b?c.setInput(o,X,O,B):o[B]=X}}}function Og(n,i){let o=null,c=0;for(;c<i.length;){const h=i[c];if(0!==h)if(5!==h){if("number"==typeof h)break;n.hasOwnProperty(h)&&(null===o&&(o=[]),o.push(h,n[h],i[c+1])),c+=2}else c+=2;else c+=4}return o}function yp(n,i){const o=Ri(i,n);if(Os(o)){const c=o[1];80&o[2]?Ku(c,o,c.template,o[8]):o[5]>0&&vp(o)}}function vp(n){for(let c=lo(n);null!==c;c=wc(c))for(let h=10;h<c.length;h++){const f=c[h];if(1024&f[2]){const g=f[1];Ku(g,f,g.template,f[8])}else f[5]>0&&vp(f)}const o=n[1].components;if(null!==o)for(let c=0;c<o.length;c++){const h=Ri(o[c],n);Os(h)&&h[5]>0&&vp(h)}}function Kv(n,i){const o=Ri(i,n),c=o[1];(function Jv(n,i){for(let o=i.length;o<n.blueprint.length;o++)i.push(n.blueprint[o])})(c,o),Sd(c,o,o[8])}function Cd(n,i){return n[13]?n[14][4]=i:n[13]=i,n[14]=i,i}function _p(n){for(;n;){n[2]|=64;const i=Bu(n);if(ou(n)&&!i)return n;n=i}return null}function Bg(n){!function xp(n){for(let i=0;i<n.components.length;i++){const o=n.components[i],c=Uu(o),h=c[1];$M(h,c,h.template,o)}}(n[8])}function Dd(n,i,o){Wh(0),i(n,o)}const Hg=(()=>Promise.resolve(null))();function bp(n){return n[7]||(n[7]=[])}function Ep(n){return n.cleanup||(n.cleanup=[])}function Sp(n,i){const o=n[9],c=o?o.get(xd,null):null;c&&c.handleError(i)}function wl(n,i,o,c,h){for(let f=0;f<o.length;){const g=o[f++],b=o[f++],T=i[g],O=n.data[g];null!==O.setInput?O.setInput(T,h,c,b):T[b]=h}}function $i(n,i,o){let c=o?n.styles:null,h=o?n.classes:null,f=0;if(null!==i)for(let g=0;g<i.length;g++){const b=i[g];"number"==typeof b?f=b:1==f?h=fn(h,b):2==f&&(c=fn(c,b+": "+i[++g]+";"))}o?n.styles=c:n.stylesWithoutHost=c,o?n.classes=h:n.classesWithoutHost=h}const Tp=new Oi("INJECTOR",-1);class zg{get(i,o=Do){if(o===Do){const c=new Error(`NullInjectorError: No provider for ${Ge(i)}!`);throw c.name="NullInjectorError",c}return o}}const Ap=new Oi("Set Injector scope."),Qu={},r_={};let Cp;function Vg(){return void 0===Cp&&(Cp=new zg),Cp}function Gg(n,i=null,o=null,c){const h=Wg(n,i,o,c);return h._resolveInjectorDefTypes(),h}function Wg(n,i=null,o=null,c){return new s_(n,o,i||Vg(),c)}class s_{constructor(i,o,c,h=null){this.parent=c,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const f=[];o&&Co(o,b=>this.processProvider(b,i,o)),Co([i],b=>this.processInjectorType(b,[],f)),this.records.set(Tp,kc(void 0,this));const g=this.records.get(Ap);this.scope=null!=g?g.value:null,this.source=h||("object"==typeof i?null:Ge(i))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(i=>i.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(i,o=Do,c=tn.Default){this.assertNotDestroyed();const h=al(this),f=Gt(void 0);try{if(!(c&tn.SkipSelf)){let b=this.records.get(i);if(void 0===b){const T=function f_(n){return"function"==typeof n||"object"==typeof n&&n instanceof Oi}(i)&&xi(i);b=T&&this.injectableDefInScope(T)?kc(Dp(i),Qu):null,this.records.set(i,b)}if(null!=b)return this.hydrate(i,b)}return(c&tn.Self?Vg():this.parent).get(i,o=c&tn.Optional&&o===Do?null:o)}catch(g){if("NullInjectorError"===g.name){if((g[td]=g[td]||[]).unshift(Ge(i)),h)throw g;return function z0(n,i,o,c){const h=n[td];throw i[Wm]&&h.unshift(i[Wm]),n.message=function cl(n,i,o,c=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.substr(2):n;let h=Ge(i);if(Array.isArray(i))h=i.map(Ge).join(" -> ");else if("object"==typeof i){let f=[];for(let g in i)if(i.hasOwnProperty(g)){let b=i[g];f.push(g+":"+("string"==typeof b?JSON.stringify(b):Ge(b)))}h=`{${f.join(", ")}}`}return`${o}${c?"("+c+")":""}[${h}]: ${n.replace(k0,"\n  ")}`}("\n"+n.message,h,o,c),n.ngTokenPath=h,n[td]=null,n}(g,i,"R3InjectorError",this.source)}throw g}finally{Gt(f),al(h)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(i=>this.get(i))}toString(){const i=[];return this.records.forEach((c,h)=>i.push(Ge(h))),`R3Injector[${i.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ut(205,!1)}processInjectorType(i,o,c){if(!(i=gt(i)))return!1;let h=Rs(i);const f=null==h&&i.ngModule||void 0,g=void 0===f?i:f,b=-1!==c.indexOf(g);if(void 0!==f&&(h=Rs(f)),null==h)return!1;if(null!=h.imports&&!b){let B;c.push(g);try{Co(h.imports,X=>{this.processInjectorType(X,o,c)&&(void 0===B&&(B=[]),B.push(X))})}finally{}if(void 0!==B)for(let X=0;X<B.length;X++){const{ngModule:re,providers:ue}=B[X];Co(ue,Ie=>this.processProvider(Ie,re,ue||An))}}this.injectorDefTypes.add(g);const T=Ms(g)||(()=>new g);this.records.set(g,kc(T,Qu));const O=h.providers;if(null!=O&&!b){const B=i;Co(O,X=>this.processProvider(X,B,O))}return void 0!==f&&void 0!==i.providers}processProvider(i,o,c){let h=Bc(i=gt(i))?i:gt(i&&i.provide);const f=function a_(n,i,o){return jg(n)?kc(void 0,n.useValue):kc(function $g(n,i,o){let c;if(Bc(n)){const h=gt(n);return Ms(h)||Dp(h)}if(jg(n))c=()=>gt(n.useValue);else if(function c_(n){return!(!n||!n.useFactory)}(n))c=()=>n.useFactory(...kf(n.deps||[]));else if(function l_(n){return!(!n||!n.useExisting)}(n))c=()=>Ar(gt(n.useExisting));else{const h=gt(n&&(n.useClass||n.provide));if(!function h_(n){return!!n.deps}(n))return Ms(h)||Dp(h);c=()=>new h(...kf(n.deps))}return c}(n),Qu)}(i);if(Bc(i)||!0!==i.multi)this.records.get(h);else{let g=this.records.get(h);g||(g=kc(void 0,Qu,!0),g.factory=()=>kf(g.multi),this.records.set(h,g)),h=i,g.multi.push(i)}this.records.set(h,f)}hydrate(i,o){return o.value===Qu&&(o.value=r_,o.value=o.factory()),"object"==typeof o.value&&o.value&&function d_(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(o.value)&&this.onDestroy.add(o.value),o.value}injectableDefInScope(i){if(!i.providedIn)return!1;const o=gt(i.providedIn);return"string"==typeof o?"any"===o||o===this.scope:this.injectorDefTypes.has(o)}}function Dp(n){const i=xi(n),o=null!==i?i.factory:Ms(n);if(null!==o)return o;if(n instanceof Oi)throw new ut(204,!1);if(n instanceof Function)return function o_(n){const i=n.length;if(i>0)throw Du(i,"?"),new ut(204,!1);const o=function ms(n){const i=n&&(n[Jr]||n[za]);if(i){const o=function fi(n){if(n.hasOwnProperty("name"))return n.name;const i=(""+n).match(/^function\s*([^\s(]+)/);return null===i?"":i[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${o}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${o}" class.`),i}return null}(n);return null!==o?()=>o.factory(n):()=>new n}(n);throw new ut(204,!1)}function kc(n,i,o=!1){return{factory:n,value:i,multi:o?[]:void 0}}function jg(n){return null!==n&&"object"==typeof n&&H0 in n}function Bc(n){return"function"==typeof n}let Lo=(()=>{class n{static create(o,c){var h;if(Array.isArray(o))return Gg({name:""},c,o,"");{const f=null!==(h=o.name)&&void 0!==h?h:"";return Gg({name:f},o.parent,o.providers,f)}}}return n.THROW_IF_NOT_FOUND=Do,n.NULL=new zg,n.\u0275prov=li({token:n,providedIn:"any",factory:()=>Ar(Tp)}),n.__NG_ELEMENT_ID__=-1,n})();function x_(n,i){tl(Uu(n)[1],Ii())}let th=null;function Hc(){if(!th){const n=ni.Symbol;if(n&&n.iterator)th=n.iterator;else{const i=Object.getOwnPropertyNames(Map.prototype);for(let o=0;o<i.length;++o){const c=i[o];"entries"!==c&&"size"!==c&&Map.prototype[c]===Map.prototype.entries&&(th=c)}}}return th}function nh(n){return!!Up(n)&&(Array.isArray(n)||!(n instanceof Map)&&Hc()in n)}function Up(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function zr(n,i,o){return!Object.is(n[i],o)&&(n[i]=o,!0)}function kp(n,i,o,c){const h=Fe();return zr(h,Zo(),i)&&(Dn(),yo(Si(),h,n,i,o,c)),kp}function mh(n,i=tn.Default){const o=Fe();return null===o?Ar(n,i):P(Ii(),o,gt(n),i)}function Xp(){throw new Error("invalid")}function Dl(n,i,o){const c=Fe();return zr(c,Zo(),i)&&function Vs(n,i,o,c,h,f,g,b){const T=qn(i,o);let B,O=i.inputs;!b&&null!=O&&(B=O[c])?(wl(n,o,B,c,h),Ls(i)&&function ZM(n,i){const o=Ri(i,n);16&o[2]||(o[2]|=64)}(o,i.index)):3&i.type&&(c=function YM(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(c),h=null!=g?g(h,i.value||"",c):h,pt(f)?f.setProperty(T,c,h):ro(c)||(T.setProperty?T.setProperty(c,h):T[c]=h))}(Dn(),Si(),c,n,i,c[11],o,!1),Dl}function Bd(n,i,o,c,h){const g=h?"class":"style";wl(n,o,i.inputs[g],g,c)}function Yc(n,i,o,c){const h=Fe(),f=Dn(),g=20+n,b=h[11],T=h[g]=Wf(b,i,function Df(){return _n.lFrame.currentNamespace}()),O=f.firstCreatePass?function U_(n,i,o,c,h,f,g){const b=i.consts,O=Yu(i,n,2,h,Or(b,f));return function fp(n,i,o,c){let h=!1;if(nc()){const f=function Lg(n,i,o){const c=n.directiveRegistry;let h=null;if(c)for(let f=0;f<c.length;f++){const g=c[f];pg(o,g.selectors,!1)&&(h||(h=[]),w(yc(o,i),n,g.type),Pr(g)?(Oa(n,o),h.unshift(g)):h.push(g))}return h}(n,i,o),g=null===c?null:{"":-1};if(null!==f){h=!0,Td(o,n.data.length,f.length);for(let B=0;B<f.length;B++){const X=f[B];X.providersResolver&&X.providersResolver(X)}let b=!1,T=!1,O=Zu(n,i,f.length,null);for(let B=0;B<f.length;B++){const X=f[B];o.mergedAttrs=il(o.mergedAttrs,X.hostAttrs),Fa(n,o,i,O,X),Ng(O,X,g),null!==X.contentQueries&&(o.flags|=8),(null!==X.hostBindings||null!==X.hostAttrs||0!==X.hostVars)&&(o.flags|=128);const re=X.type.prototype;!b&&(re.ngOnChanges||re.ngOnInit||re.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(o.index),b=!0),!T&&(re.ngOnChanges||re.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(o.index),T=!0),O++}!function qM(n,i){const c=i.directiveEnd,h=n.data,f=i.attrs,g=[];let b=null,T=null;for(let O=i.directiveStart;O<c;O++){const B=h[O],X=B.inputs,re=null===f||fg(i)?null:Og(X,f);g.push(re),b=jv(X,O,b),T=jv(B.outputs,O,T)}null!==b&&(b.hasOwnProperty("class")&&(i.flags|=16),b.hasOwnProperty("style")&&(i.flags|=32)),i.initialInputs=g,i.inputs=b,i.outputs=T}(n,o)}g&&function mp(n,i,o){if(i){const c=n.localNames=[];for(let h=0;h<i.length;h+=2){const f=o[i[h+1]];if(null==f)throw new ut(-301,!1);c.push(i[h],f)}}}(o,c,g)}return o.mergedAttrs=il(o.mergedAttrs,o.attrs),h}(i,o,O,Or(b,g)),null!==O.attrs&&$i(O,O.attrs,!1),null!==O.mergedAttrs&&$i(O,O.mergedAttrs,!0),null!==i.queries&&i.queries.elementStart(i,O),O}(g,f,h,0,i,o,c):f.data[g];Fs(O,!0);const B=O.mergedAttrs;null!==B&&Ko(b,T,B);const X=O.classes;null!==X&&dd(b,T,X);const re=O.styles;return null!==re&&X0(b,T,re),64!=(64&O.flags)&&Dr(f,h,T,O),0===function Pm(){return _n.lFrame.elementDepthCount}()&&_r(T,h),function wo(){_n.lFrame.elementDepthCount++}(),jo(O)&&(function Rg(n,i,o){!nc()||(function Yv(n,i,o,c){const h=o.directiveStart,f=o.directiveEnd;n.firstCreatePass||yc(o,i),_r(c,i);const g=o.initialInputs;for(let b=h;b<f;b++){const T=n.data[b],O=Pr(T);O&&Uc(i,o,T);const B=st(i,n,b,o);_r(B,i),null!==g&&Zv(0,b-h,B,T,0,g),O&&(Ri(o.index,i)[8]=B)}}(n,i,o,qn(o,i)),128==(128&o.flags)&&function pp(n,i,o){const c=o.directiveStart,h=o.directiveEnd,g=o.index,b=function Gh(){return _n.lFrame.currentDirectiveIndex}();try{to(g);for(let T=c;T<h;T++){const O=n.data[T],B=i[T];oc(T),(null!==O.hostBindings||0!==O.hostVars||null!==O.hostAttrs)&&El(O,B)}}finally{to(-1),oc(b)}}(n,i,o))}(f,h,O),function zv(n,i,o){if(Wa(i)){const h=i.directiveEnd;for(let f=i.directiveStart;f<h;f++){const g=n.data[f];g.contentQueries&&g.contentQueries(1,o[f],f)}}}(f,O,h)),null!==c&&function Ig(n,i,o=qn){const c=i.localNames;if(null!==c){let h=i.index+1;for(let f=0;f<c.length;f+=2){const g=c[f+1],b=-1===g?o(i,n):n[g];n[h++]=b}}}(h,O),Yc}function Ua(){let n=Ii();Fr()?qo():(n=n.parent,Fs(n,!1));const i=n;!function Cf(){_n.lFrame.elementDepthCount--}();const o=Dn();return o.firstCreatePass&&(tl(o,n),Wa(n)&&o.queries.elementEnd(n)),null!=i.classesWithoutHost&&function Eu(n){return 0!=(16&n.flags)}(i)&&Bd(o,i,Fe(),i.classesWithoutHost,!0),null!=i.stylesWithoutHost&&function Nm(n){return 0!=(32&n.flags)}(i)&&Bd(o,i,Fe(),i.stylesWithoutHost,!1),Ua}function ka(n,i,o,c){return Yc(n,i,o,c),Ua(),ka}function Yp(n){return!!n&&"function"==typeof n.then}function ds(n){return!!n&&"function"==typeof n.subscribe}const Zp=ds;function Vd(n,i,o,c){const h=Fe(),f=Dn(),g=Ii();return function yh(n,i,o,c,h,f,g,b){const T=jo(c),B=n.firstCreatePass&&Ep(n),X=i[8],re=bp(i);let ue=!0;if(3&c.type||b){const _t=qn(c,i),Lt=b?b(_t):_t,ke=re.length,cn=b?ti=>b(qt(ti[c.index])):c.index;if(pt(o)){let ti=null;if(!b&&T&&(ti=function Jp(n,i,o,c){const h=n.cleanup;if(null!=h)for(let f=0;f<h.length-1;f+=2){const g=h[f];if(g===o&&h[f+1]===c){const b=i[7],T=h[f+2];return b.length>T?b[T]:null}"string"==typeof g&&(f+=2)}return null}(n,i,h,c.index)),null!==ti)(ti.__ngLastListenerFn__||ti).__ngNextListenerFn__=f,ti.__ngLastListenerFn__=f,ue=!1;else{f=Gd(c,i,X,f,!1);const _i=o.listen(Lt,h,f);re.push(f,_i),B&&B.push(h,cn,ke,ke+1)}}else f=Gd(c,i,X,f,!0),Lt.addEventListener(h,f,g),re.push(f),B&&B.push(h,cn,ke,g)}else f=Gd(c,i,X,f,!1);const Ie=c.outputs;let nt;if(ue&&null!==Ie&&(nt=Ie[h])){const _t=nt.length;if(_t)for(let Lt=0;Lt<_t;Lt+=2){const _o=i[nt[Lt]][nt[Lt+1]].subscribe(f),kh=re.length;re.push(f,_o),B&&B.push(h,c.index,kh,-(kh+1))}}}(f,h,h[11],g,n,i,!!o,c),Vd}function vh(n,i,o,c){try{return!1!==o(c)}catch(h){return Sp(n,h),!1}}function Gd(n,i,o,c,h){return function f(g){if(g===Function)return c;const b=2&n.flags?Ri(n.index,i):i;0==(32&i[2])&&_p(b);let T=vh(i,0,c,g),O=f.__ngNextListenerFn__;for(;O;)T=vh(i,0,O,g)&&T,O=O.__ngNextListenerFn__;return h&&!1===T&&(g.preventDefault(),g.returnValue=!1),T}}function Ey(n,i){let o=null;const c=function Ev(n){const i=n.attrs;if(null!=i){const o=i.indexOf(5);if(0==(1&o))return i[o+1]}return null}(n);for(let h=0;h<i.length;h++){const f=i[h];if("*"!==f){if(null===c?pg(n,f,!0):Tv(c,f))return h}else o=h}return o}function wy(n){const i=Fe()[16][6];if(!i.projection){const c=i.projection=Du(n?n.length:1,null),h=c.slice();let f=i.child;for(;null!==f;){const g=n?Ey(f,n):0;null!==g&&(h[g]?h[g].projectionNext=f:c[g]=f,h[g]=f),f=f.next}}}function Qp(n,i=0,o){const c=Fe(),h=Dn(),f=Yu(h,20+n,16,null,o||null);null===f.projection&&(f.projection=i),qo(),64!=(64&f.flags)&&function gM(n,i,o){j0(i[11],0,i,o,zu(n,o,i),Pt(o.parent||i[6],o,i))}(h,c,f)}function Iy(n,i=""){const o=Fe(),c=Dn(),h=n+20,f=c.firstCreatePass?Yu(c,h,1,i,null):c.data[h],g=o[h]=function ud(n,i){return pt(n)?n.createText(i):n.createTextNode(i)}(o[11],i);Dr(c,o,g,f),Fs(f,!1)}const ua=void 0;var nx=["en",[["a","p"],["AM","PM"],ua],[["AM","PM"],ua,ua],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],ua,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],ua,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",ua,"{1} 'at' {0}",ua],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function fm(n){const o=Math.floor(Math.abs(n)),c=n.toString().replace(/^[^.]*\.?/,"").length;return 1===o&&0===c?1:5}];let ha={};function Ah(n){const i=function rx(n){return n.toLowerCase().replace(/_/g,"-")}(n);let o=Xy(i);if(o)return o;const c=i.split("-")[0];if(o=Xy(c),o)return o;if("en"===c)return nx;throw new Error(`Missing locale data for the locale "${n}".`)}function sf(n){return Ah(n)[an.PluralCase]}function Xy(n){return n in ha||(ha[n]=ni.ng&&ni.ng.common&&ni.ng.common.locales&&ni.ng.common.locales[n]),ha[n]}var an=(()=>((an=an||{})[an.LocaleId=0]="LocaleId",an[an.DayPeriodsFormat=1]="DayPeriodsFormat",an[an.DayPeriodsStandalone=2]="DayPeriodsStandalone",an[an.DaysFormat=3]="DaysFormat",an[an.DaysStandalone=4]="DaysStandalone",an[an.MonthsFormat=5]="MonthsFormat",an[an.MonthsStandalone=6]="MonthsStandalone",an[an.Eras=7]="Eras",an[an.FirstDayOfWeek=8]="FirstDayOfWeek",an[an.WeekendRange=9]="WeekendRange",an[an.DateFormat=10]="DateFormat",an[an.TimeFormat=11]="TimeFormat",an[an.DateTimeFormat=12]="DateTimeFormat",an[an.NumberSymbols=13]="NumberSymbols",an[an.NumberFormats=14]="NumberFormats",an[an.CurrencyCode=15]="CurrencyCode",an[an.CurrencySymbol=16]="CurrencySymbol",an[an.CurrencyName=17]="CurrencyName",an[an.Currencies=18]="Currencies",an[an.Directionality=19]="Directionality",an[an.PluralCase=20]="PluralCase",an[an.ExtraData=21]="ExtraData",an))();const of="en-US";let qy=of;class m0{}class Tx{resolveComponentFactory(i){throw function Sx(n){const i=Error(`No component factory found for ${Ge(n)}. Did you add it to @NgModule.entryComponents?`);return i.ngComponent=n,i}(i)}}let gf=(()=>{class n{}return n.NULL=new Tx,n})();function Ax(){return iu(Ii(),Fe())}function iu(n,i){return new gi(qn(n,i))}let gi=(()=>{class n{constructor(o){this.nativeElement=o}}return n.__NG_ELEMENT_ID__=Ax,n})();function wb(n){return n instanceof gi?n.nativeElement:n}class y0{}let Tb=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>function Cx(){const n=Fe(),o=Ri(Ii().index,n);return function v0(n){return n[11]}(br(o)?o:n)}(),n})(),Ab=(()=>{class n{}return n.\u0275prov=li({token:n,providedIn:"root",factory:()=>null}),n})();class Dx{constructor(i){this.full=i,this.major=i.split(".")[0],this.minor=i.split(".")[1],this.patch=i.split(".").slice(2).join(".")}}const Cb=new Dx("13.3.12"),_0={};function Ph(n,i,o,c,h=!1){for(;null!==o;){const f=i[o.index];if(null!==f&&c.push(qt(f)),Di(f))for(let b=10;b<f.length;b++){const T=f[b],O=T[1].firstChild;null!==O&&Ph(T[1],T,O,c)}const g=o.type;if(8&g)Ph(n,i,o.child,c);else if(32&g){const b=ld(o,i);let T;for(;T=b();)c.push(T)}else if(16&g){const b=$0(i,o);if(Array.isArray(b))c.push(...b);else{const T=Bu(i[16]);Ph(T[1],T,b,c,!0)}}o=h?o.projectionNext:o.next}return c}class Gl{constructor(i,o){this._lView=i,this._cdRefInjectingView=o,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const i=this._lView,o=i[1];return Ph(o,i,o.firstChild,[])}get context(){return this._lView[8]}set context(i){this._lView[8]=i}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const i=this._lView[3];if(Di(i)){const o=i[8],c=o?o.indexOf(this):-1;c>-1&&(Ra(i,c),Qh(o,c))}this._attachedToViewContainer=!1}jf(this._lView[1],this._lView)}onDestroy(i){$v(this._lView[1],this._lView,null,i)}markForCheck(){_p(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){!function Mp(n,i,o){const c=i[10];c.begin&&c.begin();try{Ku(n,i,n.template,o)}catch(h){throw Sp(i,h),h}finally{c.end&&c.end()}}(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ut(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function co(n,i){hd(n,i,i[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(i){if(this._attachedToViewContainer)throw new ut(902,"");this._appRef=i}}class Db extends Gl{constructor(i){super(i),this._view=i}detectChanges(){Bg(this._view)}checkNoChanges(){}get context(){return null}}class Rx extends gf{constructor(i){super(),this.ngModule=i}resolveComponentFactory(i){const o=Kt(i);return new ru(o,this.ngModule)}}function Sm(n){const i=[];for(let o in n)n.hasOwnProperty(o)&&i.push({propName:n[o],templateName:o});return i}class ru extends m0{constructor(i,o){super(),this.componentDef=i,this.ngModule=o,this.componentType=i.type,this.selector=function Cv(n){return n.map(Av).join(",")}(i.selectors),this.ngContentSelectors=i.ngContentSelectors?i.ngContentSelectors:[],this.isBoundToModule=!!o}get inputs(){return Sm(this.componentDef.inputs)}get outputs(){return Sm(this.componentDef.outputs)}create(i,o,c,h){const f=(h=h||this.ngModule)?function x0(n,i){return{get:(o,c,h)=>{const f=n.get(o,_0,h);return f!==_0||c===_0?f:i.get(o,c,h)}}}(i,h.injector):i,g=f.get(y0,pi),b=f.get(Ab,null),T=g.createRenderer(null,this.componentDef),O=this.componentDef.selectors[0][0]||"div",B=c?function Wv(n,i,o){if(pt(n))return n.selectRootElement(i,o===Qr.ShadowDom);let c="string"==typeof i?n.querySelector(i):i;return c.textContent="",c}(T,c,this.componentDef.encapsulation):Wf(g.createRenderer(null,this.componentDef),O,function Rb(n){const i=n.toLowerCase();return"svg"===i?"svg":"math"===i?R:null}(O)),X=this.componentDef.onPush?576:528,re=function ty(n,i){return{components:[],scheduler:n||mv,clean:Hg,playerHandler:i||null,flags:0}}(),ue=dp(0,null,null,1,0,null,null,null,null,null),Ie=wd(null,ue,re,X,null,null,g,T,b,f);let nt,_t;Sa(Ie);try{const Lt=function ey(n,i,o,c,h,f){const g=o[1];o[20]=n;const T=Yu(g,20,2,"#host",null),O=T.mergedAttrs=i.hostAttrs;null!==O&&($i(T,O,!0),null!==n&&(Ko(h,n,O),null!==T.classes&&dd(h,n,T.classes),null!==T.styles&&X0(h,n,T.styles)));const B=c.createRenderer(n,i),X=wd(o,Vv(i),null,i.onPush?64:16,o[20],T,c,B,f||null,null);return g.firstCreatePass&&(w(yc(T,o),g,i.type),Oa(g,T),Td(T,o.length,1)),Cd(o,X),o[20]=X}(B,this.componentDef,Ie,g,T);if(B)if(c)Ko(T,B,["ng-version",Cb.full]);else{const{attrs:ke,classes:cn}=function Dv(n){const i=[],o=[];let c=1,h=2;for(;c<n.length;){let f=n[c];if("string"==typeof f)2===h?""!==f&&i.push(f,n[++c]):8===h&&o.push(f);else{if(!mo(h))break;h=f}c++}return{attrs:i,classes:o}}(this.componentDef.selectors[0]);ke&&Ko(T,B,ke),cn&&cn.length>0&&dd(T,B,cn.join(" "))}if(_t=Nr(ue,20),void 0!==o){const ke=_t.projection=[];for(let cn=0;cn<this.ngContentSelectors.length;cn++){const ti=o[cn];ke.push(null!=ti?Array.from(ti):null)}}nt=function Op(n,i,o,c,h){const f=o[1],g=function Xv(n,i,o){const c=Ii();n.firstCreatePass&&(o.providersResolver&&o.providersResolver(o),Fa(n,c,i,Zu(n,i,1,null),o));const h=st(i,n,c.directiveStart,c);_r(h,i);const f=qn(c,i);return f&&_r(f,i),h}(f,o,i);if(c.components.push(g),n[8]=g,h&&h.forEach(T=>T(g,i)),i.contentQueries){const T=Ii();i.contentQueries(1,g,T.directiveStart)}const b=Ii();return!f.firstCreatePass||null===i.hostBindings&&null===i.hostAttrs||(to(b.index),Pg(o[1],b,0,b.directiveStart,b.directiveEnd,i),El(i,g)),g}(Lt,this.componentDef,Ie,re,[x_]),Sd(ue,Ie,null)}finally{el()}return new Pb(this.componentType,nt,iu(_t,Ie),Ie,_t)}}class Pb extends class wm{}{constructor(i,o,c,h,f){super(),this.location=c,this._rootLView=h,this._tNode=f,this.instance=o,this.hostView=this.changeDetectorRef=new Db(h),this.componentType=i}get injector(){return new Yn(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(i){this.hostView.onDestroy(i)}}class ga{}class yf{}const Lh=new Map;class Fx extends ga{constructor(i,o){super(),this._parent=o,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new Rx(this);const c=Ni(i);this._bootstrapComponents=Po(c.bootstrap),this._r3Injector=Wg(i,o,[{provide:ga,useValue:this},{provide:gf,useValue:this.componentFactoryResolver}],Ge(i)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(i)}get(i,o=Lo.THROW_IF_NOT_FOUND,c=tn.Default){return i===Lo||i===ga||i===Tp?this:this._r3Injector.get(i,o,c)}destroy(){const i=this._r3Injector;!i.destroyed&&i.destroy(),this.destroyCbs.forEach(o=>o()),this.destroyCbs=null}onDestroy(i){this.destroyCbs.push(i)}}class M0 extends yf{constructor(i){super(),this.moduleType=i,null!==Ni(i)&&function Nx(n){const i=new Set;!function o(c){const h=Ni(c,!0),f=h.id;null!==f&&(function Lx(n,i,o){if(i&&i!==o)throw new Error(`Duplicate module registered for ${n} - ${Ge(i)} vs ${Ge(i.name)}`)}(f,Lh.get(f),c),Lh.set(f,c));const g=Po(h.imports);for(const b of g)i.has(b)||(i.add(b),o(b))}(n)}(i)}create(i){return new Fx(this.moduleType,i)}}function Am(n,i,o,c,h,f,g){const b=i+o;return function Sl(n,i,o,c){const h=zr(n,i,o);return zr(n,i+1,c)||h}(n,b,h,f)?function No(n,i,o){return n[i]=o}(n,b+2,g?c.call(g,h,f):c(h,f)):function Mf(n,i){const o=n[i];return o===Rn?void 0:o}(n,b+2)}function Bx(n,i){const o=Dn();let c;const h=n+20;o.firstCreatePass?(c=function Fb(n,i){if(i)for(let o=i.length-1;o>=0;o--){const c=i[o];if(n===c.name)return c}}(i,o.pipeRegistry),o.data[h]=c,c.onDestroy&&(o.destroyHooks||(o.destroyHooks=[])).push(h,c.onDestroy)):c=o.data[h];const f=c.factory||(c.factory=Ms(c.type)),g=Gt(mh);try{const b=gc(!1),T=f();return gc(b),function rh(n,i,o,c){o>=n.data.length&&(n.data[o]=null,n.blueprint[o]=null),i[o]=c}(o,Fe(),h,T),T}finally{Gt(g)}}function w0(n,i,o,c){const h=n+20,f=Fe(),g=function Mi(n,i){return n[i]}(f,h);return function e(n,i){return n[1].data[i].pure}(f,h)?Am(f,function vr(){const n=_n.lFrame;let i=n.bindingRootIndex;return-1===i&&(i=n.bindingRootIndex=n.tView.bindingStartIndex),i}(),i,g.transform,o,c,g):g.transform(o,c)}function r(n){return i=>{setTimeout(n,void 0,i)}}const s=class t extends k.x{constructor(i=!1){super(),this.__isAsync=i}emit(i){super.next(i)}subscribe(i,o,c){var h,f,g;let b=i,T=o||(()=>null),O=c;if(i&&"object"==typeof i){const X=i;b=null===(h=X.next)||void 0===h?void 0:h.bind(X),T=null===(f=X.error)||void 0===f?void 0:f.bind(X),O=null===(g=X.complete)||void 0===g?void 0:g.bind(X)}this.__isAsync&&(T=r(T),b&&(b=r(b)),O&&(O=r(O)));const B=super.subscribe({next:b,error:T,complete:O});return i instanceof F.w0&&i.add(B),B}};function a(){return this._results[Hc()]()}class u{constructor(i=!1){this._emitDistinctChangesOnly=i,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const o=Hc(),c=u.prototype;c[o]||(c[o]=a)}get changes(){return this._changes||(this._changes=new s)}get(i){return this._results[i]}map(i){return this._results.map(i)}filter(i){return this._results.filter(i)}find(i){return this._results.find(i)}reduce(i,o){return this._results.reduce(i,o)}forEach(i){this._results.forEach(i)}some(i){return this._results.some(i)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(i,o){const c=this;c.dirty=!1;const h=Us(i);(this._changesDetected=!function P0(n,i,o){if(n.length!==i.length)return!1;for(let c=0;c<n.length;c++){let h=n[c],f=i[c];if(o&&(h=o(h),f=o(f)),f!==h)return!1}return!0}(c._results,h,o))&&(c._results=h,c.length=h.length,c.last=h[this.length-1],c.first=h[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let d=(()=>{class n{}return n.__NG_ELEMENT_ID__=y,n})();const p=d,m=class extends p{constructor(i,o,c){super(),this._declarationLView=i,this._declarationTContainer=o,this.elementRef=c}createEmbeddedView(i){const o=this._declarationTContainer.tViews,c=wd(this._declarationLView,o,i,16,null,o.declTNode,null,null,null,null);c[17]=this._declarationLView[this._declarationTContainer.index];const f=this._declarationLView[19];return null!==f&&(c[19]=f.createEmbeddedView(o)),Sd(o,c,i),new Gl(c)}};function y(){return x(Ii(),Fe())}function x(n,i){return 4&n.type?new m(i,n,iu(n,i)):null}let M=(()=>{class n{}return n.__NG_ELEMENT_ID__=E,n})();function E(){return U(Ii(),Fe())}const A=M,L=class extends A{constructor(i,o,c){super(),this._lContainer=i,this._hostTNode=o,this._hostLView=c}get element(){return iu(this._hostTNode,this._hostLView)}get injector(){return new Yn(this._hostTNode,this._hostLView)}get parentInjector(){const i=Kh(this._hostTNode,this._hostLView);if(Xh(i)){const o=Sr(i,this._hostLView),c=as(i);return new Yn(o[1].data[c+8],o)}return new Yn(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(i){const o=D(this._lContainer);return null!==o&&o[i]||null}get length(){return this._lContainer.length-10}createEmbeddedView(i,o,c){const h=i.createEmbeddedView(o||{});return this.insert(h,c),h}createComponent(i,o,c,h,f){const g=i&&!function Cu(n){return"function"==typeof n}(i);let b;if(g)b=o;else{const X=o||{};b=X.index,c=X.injector,h=X.projectableNodes,f=X.ngModuleRef}const T=g?i:new ru(Kt(i)),O=c||this.parentInjector;if(!f&&null==T.ngModule){const re=(g?O:this.parentInjector).get(ga,null);re&&(f=re)}const B=T.create(O,h,void 0,f);return this.insert(B.hostView,b),B}insert(i,o){const c=i._lView,h=c[1];if(function tc(n){return Di(n[3])}(c)){const B=this.indexOf(i);if(-1!==B)this.detach(B);else{const X=c[3],re=new L(X,X[6],X[3]);re.detach(re.indexOf(i))}}const f=this._adjustIndex(o),g=this._lContainer;!function $f(n,i,o,c){const h=10+c,f=o.length;c>0&&(o[h-1][4]=i),c<f-10?(i[4]=o[h],Hm(o,10+c,i)):(o.push(i),i[4]=null),i[3]=o;const g=i[17];null!==g&&o!==g&&function sa(n,i){const o=n[9];i[16]!==i[3][3][16]&&(n[2]=!0),null===o?n[9]=[i]:o.push(i)}(g,i);const b=i[19];null!==b&&b.insertView(n),i[2]|=128}(h,c,g,f);const b=Wi(f,g),T=c[11],O=yl(T,g[7]);return null!==O&&function Hs(n,i,o,c,h,f){c[0]=h,c[6]=i,hd(n,c,o,1,h,f)}(h,g[6],T,c,O,b),i.attachToViewContainerRef(),Hm(S(g),f,i),i}move(i,o){return this.insert(i,o)}indexOf(i){const o=D(this._lContainer);return null!==o?o.indexOf(i):-1}remove(i){const o=this._adjustIndex(i,-1),c=Ra(this._lContainer,o);c&&(Qh(S(this._lContainer),o),jf(c[1],c))}detach(i){const o=this._adjustIndex(i,-1),c=Ra(this._lContainer,o);return c&&null!=Qh(S(this._lContainer),o)?new Gl(c):null}_adjustIndex(i,o=0){return null==i?this.length+o:i}};function D(n){return n[8]}function S(n){return n[8]||(n[8]=[])}function U(n,i){let o;const c=i[n.index];if(Di(c))o=c;else{let h;if(8&n.type)h=qt(c);else{const f=i[11];h=f.createComment("");const g=qn(n,i);gl(f,yl(f,g),h,function Zf(n,i){return pt(n)?n.nextSibling(i):i.nextSibling}(f,g),!1)}i[n.index]=o=function Fg(n,i,o,c){return new Array(n,!0,!1,i,null,0,c,o,null,null)}(c,i,h,n),Cd(i,o)}return new L(o,n,i)}class q{constructor(i){this.queryList=i,this.matches=null}clone(){return new q(this.queryList)}setDirty(){this.queryList.setDirty()}}class Q{constructor(i=[]){this.queries=i}createEmbeddedView(i){const o=i.queries;if(null!==o){const c=null!==i.contentQueries?i.contentQueries[0]:o.length,h=[];for(let f=0;f<c;f++){const g=o.getByIndex(f);h.push(this.queries[g.indexInDeclarationView].clone())}return new Q(h)}return null}insertView(i){this.dirtyQueriesWithMatches(i)}detachView(i){this.dirtyQueriesWithMatches(i)}dirtyQueriesWithMatches(i){for(let o=0;o<this.queries.length;o++)null!==Rt(i,o).matches&&this.queries[o].setDirty()}}class ae{constructor(i,o,c=null){this.predicate=i,this.flags=o,this.read=c}}class W{constructor(i=[]){this.queries=i}elementStart(i,o){for(let c=0;c<this.queries.length;c++)this.queries[c].elementStart(i,o)}elementEnd(i){for(let o=0;o<this.queries.length;o++)this.queries[o].elementEnd(i)}embeddedTView(i){let o=null;for(let c=0;c<this.length;c++){const h=null!==o?o.length:0,f=this.getByIndex(c).embeddedTView(i,h);f&&(f.indexInDeclarationView=c,null!==o?o.push(f):o=[f])}return null!==o?new W(o):null}template(i,o){for(let c=0;c<this.queries.length;c++)this.queries[c].template(i,o)}getByIndex(i){return this.queries[i]}get length(){return this.queries.length}track(i){this.queries.push(i)}}class Y{constructor(i,o=-1){this.metadata=i,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=o}elementStart(i,o){this.isApplyingToNode(o)&&this.matchTNode(i,o)}elementEnd(i){this._declarationNodeIndex===i.index&&(this._appliesToNextNode=!1)}template(i,o){this.elementStart(i,o)}embeddedTView(i,o){return this.isApplyingToNode(i)?(this.crossesNgTemplate=!0,this.addMatch(-i.index,o),new Y(this.metadata)):null}isApplyingToNode(i){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const o=this._declarationNodeIndex;let c=i.parent;for(;null!==c&&8&c.type&&c.index!==o;)c=c.parent;return o===(null!==c?c.index:-1)}return this._appliesToNextNode}matchTNode(i,o){const c=this.metadata.predicate;if(Array.isArray(c))for(let h=0;h<c.length;h++){const f=c[h];this.matchTNodeWithReadOption(i,o,Ce(o,f)),this.matchTNodeWithReadOption(i,o,pe(o,i,f,!1,!1))}else c===d?4&o.type&&this.matchTNodeWithReadOption(i,o,-1):this.matchTNodeWithReadOption(i,o,pe(o,i,c,!1,!1))}matchTNodeWithReadOption(i,o,c){if(null!==c){const h=this.metadata.read;if(null!==h)if(h===gi||h===M||h===d&&4&o.type)this.addMatch(o.index,-2);else{const f=pe(o,i,h,!1,!1);null!==f&&this.addMatch(o.index,f)}else this.addMatch(o.index,c)}}addMatch(i,o){null===this.matches?this.matches=[i,o]:this.matches.push(i,o)}}function Ce(n,i){const o=n.localNames;if(null!==o)for(let c=0;c<o.length;c+=2)if(o[c]===i)return o[c+1];return null}function ye(n,i,o,c){return-1===o?function qe(n,i){return 11&n.type?iu(n,i):4&n.type?x(n,i):null}(i,n):-2===o?function xe(n,i,o){return o===gi?iu(i,n):o===d?x(i,n):o===M?U(i,n):void 0}(n,i,c):st(n,n[1],o,i)}function Se(n,i,o,c){const h=i[19].queries[c];if(null===h.matches){const f=n.data,g=o.matches,b=[];for(let T=0;T<g.length;T+=2){const O=g[T];b.push(O<0?null:ye(i,f[O],g[T+1],o.metadata.read))}h.matches=b}return h.matches}function Xe(n,i,o,c){const h=n.queries.getByIndex(o),f=h.matches;if(null!==f){const g=Se(n,i,h,o);for(let b=0;b<f.length;b+=2){const T=f[b];if(T>0)c.push(g[b/2]);else{const O=f[b+1],B=i[-T];for(let X=10;X<B.length;X++){const re=B[X];re[17]===re[3]&&Xe(re[1],re,O,c)}if(null!==B[9]){const X=B[9];for(let re=0;re<X.length;re++){const ue=X[re];Xe(ue[1],ue,O,c)}}}}}return c}function Oe(n){const i=Fe(),o=Dn(),c=lc();Wh(c+1);const h=Rt(o,c);if(n.dirty&&mi(i)===(2==(2&h.metadata.flags))){if(null===h.matches)n.reset([]);else{const f=h.crossesNgTemplate?Xe(o,i,c,[]):Se(o,i,h,c);n.reset(f,wb),n.notifyOnChanges()}return!0}return!1}function Je(n,i,o,c){const h=Dn();if(h.firstCreatePass){const f=Ii();(function Tt(n,i,o){null===n.queries&&(n.queries=new W),n.queries.track(new Y(i,o))})(h,new ae(i,o,c),f.index),function Ct(n,i){const o=n.contentQueries||(n.contentQueries=[]);i!==(o.length?o[o.length-1]:-1)&&o.push(n.queries.length-1,i)}(h,n),2==(2&o)&&(h.staticContentQueries=!0)}!function Be(n,i,o){const c=new u(4==(4&o));$v(n,i,c,c.destroy),null===i[19]&&(i[19]=new Q),i[19].queries.push(new q(c))}(h,Fe(),o)}function Qe(){return function me(n,i){return n[19].queries[i].queryList}(Fe(),lc())}function Rt(n,i){return n.queries.getByIndex(i)}function Z(...n){}const Pe=new Oi("Application Initializer");let de=(()=>{class n{constructor(o){this.appInits=o,this.resolve=Z,this.reject=Z,this.initialized=!1,this.done=!1,this.donePromise=new Promise((c,h)=>{this.resolve=c,this.reject=h})}runInitializers(){if(this.initialized)return;const o=[],c=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let h=0;h<this.appInits.length;h++){const f=this.appInits[h]();if(Yp(f))o.push(f);else if(Zp(f)){const g=new Promise((b,T)=>{f.subscribe({complete:b,error:T})});o.push(g)}}Promise.all(o).then(()=>{c()}).catch(h=>{this.reject(h)}),0===o.length&&c(),this.initialized=!0}}return n.\u0275fac=function(o){return new(o||n)(Ar(Pe,8))},n.\u0275prov=li({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Re=new Oi("AppId",{providedIn:"root",factory:function Bt(){return`${bn()}${bn()}${bn()}`}});function bn(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const Sn=new Oi("Platform Initializer"),Zn=new Oi("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),En=new Oi("appBootstrapListener");let qi=(()=>{class n{log(o){console.log(o)}warn(o){console.warn(o)}}return n.\u0275fac=function(o){return new(o||n)},n.\u0275prov=li({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const fs=new Oi("LocaleId",{providedIn:"root",factory:()=>Uf(fs,tn.Optional|tn.SkipSelf)||function rr(){return"undefined"!=typeof $localize&&$localize.locale||of}()}),va=new Oi("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});class ur{constructor(i,o){this.ngModuleFactory=i,this.componentFactories=o}}let Wl=(()=>{class n{compileModuleSync(o){return new M0(o)}compileModuleAsync(o){return Promise.resolve(this.compileModuleSync(o))}compileModuleAndAllComponentsSync(o){const c=this.compileModuleSync(o),f=Po(Ni(o).declarations).reduce((g,b)=>{const T=Kt(b);return T&&g.push(new ru(T)),g},[]);return new ur(c,f)}compileModuleAndAllComponentsAsync(o){return Promise.resolve(this.compileModuleAndAllComponentsSync(o))}clearCache(){}clearCacheFor(o){}getModuleId(o){}}return n.\u0275fac=function(o){return new(o||n)},n.\u0275prov=li({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Im=(()=>Promise.resolve(0))();function Rr(n){"undefined"==typeof Zone?Im.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class Cs{constructor({enableLongStackTrace:i=!1,shouldCoalesceEventChangeDetection:o=!1,shouldCoalesceRunChangeDetection:c=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new s(!1),this.onMicrotaskEmpty=new s(!1),this.onStable=new s(!1),this.onError=new s(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const h=this;h._nesting=0,h._outer=h._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(h._inner=h._inner.fork(new Zone.TaskTrackingZoneSpec)),i&&Zone.longStackTraceZoneSpec&&(h._inner=h._inner.fork(Zone.longStackTraceZoneSpec)),h.shouldCoalesceEventChangeDetection=!c&&o,h.shouldCoalesceRunChangeDetection=c,h.lastRequestAnimationFrameId=-1,h.nativeRequestAnimationFrame=function $l(){let n=ni.requestAnimationFrame,i=ni.cancelAnimationFrame;if("undefined"!=typeof Zone&&n&&i){const o=n[Zone.__symbol__("OriginalDelegate")];o&&(n=o);const c=i[Zone.__symbol__("OriginalDelegate")];c&&(i=c)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:i}}().nativeRequestAnimationFrame,function A0(n){const i=()=>{!function $x(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(ni,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,jx(n),n.isCheckStableRunning=!0,Oh(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),jx(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(o,c,h,f,g,b)=>{try{return Vb(n),o.invokeTask(h,f,g,b)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===f.type||n.shouldCoalesceRunChangeDetection)&&i(),Gb(n)}},onInvoke:(o,c,h,f,g,b,T)=>{try{return Vb(n),o.invoke(h,f,g,b,T)}finally{n.shouldCoalesceRunChangeDetection&&i(),Gb(n)}},onHasTask:(o,c,h,f)=>{o.hasTask(h,f),c===h&&("microTask"==f.change?(n._hasPendingMicrotasks=f.microTask,jx(n),Oh(n)):"macroTask"==f.change&&(n.hasPendingMacrotasks=f.macroTask))},onHandleError:(o,c,h,f)=>(o.handleError(h,f),n.runOutsideAngular(()=>n.onError.emit(f)),!1)})}(h)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Cs.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(Cs.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(i,o,c){return this._inner.run(i,o,c)}runTask(i,o,c,h){const f=this._inner,g=f.scheduleEventTask("NgZoneEvent: "+h,i,Ds,Z,Z);try{return f.runTask(g,o,c)}finally{f.cancelTask(g)}}runGuarded(i,o,c){return this._inner.runGuarded(i,o,c)}runOutsideAngular(i){return this._outer.run(i)}}const Ds={};function Oh(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function jx(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function Vb(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function Gb(n){n._nesting--,Oh(n)}class gE{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new s,this.onMicrotaskEmpty=new s,this.onStable=new s,this.onError=new s}run(i,o,c){return i.apply(o,c)}runGuarded(i,o,c){return i.apply(o,c)}runOutsideAngular(i){return i()}runTask(i,o,c,h){return i.apply(o,c)}}let Wb=(()=>{class n{constructor(o){this._ngZone=o,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),o.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Cs.assertNotInAngularZone(),Rr(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Rr(()=>{for(;0!==this._callbacks.length;){let o=this._callbacks.pop();clearTimeout(o.timeoutId),o.doneCb(this._didWork)}this._didWork=!1});else{let o=this.getPendingTasks();this._callbacks=this._callbacks.filter(c=>!c.updateCb||!c.updateCb(o)||(clearTimeout(c.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(o=>({source:o.source,creationLocation:o.creationLocation,data:o.data})):[]}addCallback(o,c,h){let f=-1;c&&c>0&&(f=setTimeout(()=>{this._callbacks=this._callbacks.filter(g=>g.timeoutId!==f),o(this._didWork,this.getPendingTasks())},c)),this._callbacks.push({doneCb:o,timeoutId:f,updateCb:h})}whenStable(o,c,h){if(h&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(o,c,h),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(o,c,h){return[]}}return n.\u0275fac=function(o){return new(o||n)(Ar(Cs))},n.\u0275prov=li({token:n,factory:n.\u0275fac}),n})(),yE=(()=>{class n{constructor(){this._applications=new Map,Xx.addToWindow(this)}registerApplication(o,c){this._applications.set(o,c)}unregisterApplication(o){this._applications.delete(o)}unregisterAllApplications(){this._applications.clear()}getTestability(o){return this._applications.get(o)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(o,c=!0){return Xx.findTestabilityInTree(this,o,c)}}return n.\u0275fac=function(o){return new(o||n)},n.\u0275prov=li({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();class vE{addToWindow(i){}findTestabilityInTree(i,o,c){return null}}function _E(n){Xx=n}let Xx=new vE,Fh=null;const $b=new Oi("AllowMultipleToken"),jb=new Oi("PlatformOnDestroy");class bE{constructor(i,o){this.name=i,this.token=o}}function Xb(n,i,o=[]){const c=`Platform: ${i}`,h=new Oi(c);return(f=[])=>{let g=qx();if(!g||g.injector.get($b,!1)){const b=[...o,...f,{provide:h,useValue:!0}];n?n(b):function EE(n){if(Fh&&!Fh.get($b,!1))throw new ut(400,"");Fh=n;const i=n.get(qb),o=n.get(Sn,null);o&&o.forEach(c=>c())}(function SE(n=[],i){return Lo.create({name:i,providers:[{provide:Ap,useValue:"platform"},{provide:jb,useValue:()=>Fh=null},...n]})}(b,c))}return function wE(n){const i=qx();if(!i)throw new ut(401,"");return i}()}}function qx(){var n;return null!==(n=null==Fh?void 0:Fh.get(qb))&&void 0!==n?n:null}let qb=(()=>{class n{constructor(o){this._injector=o,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(o,c){const b=function TE(n,i){let o;return o="noop"===n?new gE:("zone.js"===n?void 0:n)||new Cs({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==i?void 0:i.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==i?void 0:i.ngZoneRunCoalescing)}),o}(c?c.ngZone:void 0,{ngZoneEventCoalescing:c&&c.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:c&&c.ngZoneRunCoalescing||!1}),T=[{provide:Cs,useValue:b}];return b.run(()=>{const O=Lo.create({providers:T,parent:this.injector,name:o.moduleType.name}),B=o.create(O),X=B.injector.get(xd,null);if(!X)throw new ut(402,"");return b.runOutsideAngular(()=>{const re=b.onError.subscribe({next:ue=>{X.handleError(ue)}});B.onDestroy(()=>{Zx(this._modules,B),re.unsubscribe()})}),function AE(n,i,o){try{const c=o();return Yp(c)?c.catch(h=>{throw i.runOutsideAngular(()=>n.handleError(h)),h}):c}catch(c){throw i.runOutsideAngular(()=>n.handleError(c)),c}}(X,b,()=>{const re=B.injector.get(de);return re.runInitializers(),re.donePromise.then(()=>(function Xs(n){gn(n,"Expected localeId to be defined"),"string"==typeof n&&(qy=n.toLowerCase().replace(/_/g,"-"))}(B.injector.get(fs,of)||of),this._moduleDoBootstrap(B),B))})})}bootstrapModule(o,c=[]){const h=Yb({},c);return function xE(n,i,o){const c=new M0(o);return Promise.resolve(c)}(0,0,o).then(f=>this.bootstrapModuleFactory(f,h))}_moduleDoBootstrap(o){const c=o.injector.get(Yx);if(o._bootstrapComponents.length>0)o._bootstrapComponents.forEach(h=>c.bootstrap(h));else{if(!o.instance.ngDoBootstrap)throw new ut(403,"");o.instance.ngDoBootstrap(c)}this._modules.push(o)}onDestroy(o){this._destroyListeners.push(o)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new ut(404,"");this._modules.slice().forEach(c=>c.destroy()),this._destroyListeners.forEach(c=>c());const o=this._injector.get(jb,null);null==o||o(),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(o){return new(o||n)(Ar(Lo))},n.\u0275prov=li({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();function Yb(n,i){return Array.isArray(i)?i.reduce(Yb,n):Object.assign(Object.assign({},n),i)}let Yx=(()=>{class n{constructor(o,c,h,f){this._zone=o,this._injector=c,this._exceptionHandler=h,this._initStatus=f,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const g=new be.y(T=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{T.next(this._stable),T.complete()})}),b=new be.y(T=>{let O;this._zone.runOutsideAngular(()=>{O=this._zone.onStable.subscribe(()=>{Cs.assertNotInAngularZone(),Rr(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,T.next(!0))})})});const B=this._zone.onUnstable.subscribe(()=>{Cs.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{T.next(!1)}))});return()=>{O.unsubscribe(),B.unsubscribe()}});this.isStable=function Ot(...n){const i=(0,xt.yG)(n),o=(0,xt._6)(n,1/0),c=n;return c.length?1===c.length?(0,Ue.Xf)(c[0]):(0,Ye.J)(o)((0,kt.D)(c,i)):It.E}(g,b.pipe(function rt(n={}){const{connector:i=(()=>new k.x),resetOnError:o=!0,resetOnComplete:c=!0,resetOnRefCountZero:h=!0}=n;return f=>{let g,b,T,O=0,B=!1,X=!1;const re=()=>{null==b||b.unsubscribe(),b=void 0},ue=()=>{re(),g=T=void 0,B=X=!1},Ie=()=>{const nt=g;ue(),null==nt||nt.unsubscribe()};return(0,ve.e)((nt,_t)=>{O++,!X&&!B&&re();const Lt=T=null!=T?T:i();_t.add(()=>{O--,0===O&&!X&&!B&&(b=nn(Ie,h))}),Lt.subscribe(_t),!g&&O>0&&(g=new it.Hp({next:ke=>Lt.next(ke),error:ke=>{X=!0,re(),b=nn(ue,o,ke),Lt.error(ke)},complete:()=>{B=!0,re(),b=nn(ue,c),Lt.complete()}}),(0,Ue.Xf)(nt).subscribe(g))})(f)}}()))}bootstrap(o,c){if(!this._initStatus.done)throw new ut(405,"");let h;h=o instanceof m0?o:this._injector.get(gf).resolveComponentFactory(o),this.componentTypes.push(h.componentType);const f=function ME(n){return n.isBoundToModule}(h)?void 0:this._injector.get(ga),b=h.create(Lo.NULL,[],c||h.selector,f),T=b.location.nativeElement,O=b.injector.get(Wb,null),B=O&&b.injector.get(yE);return O&&B&&B.registerApplication(T,O),b.onDestroy(()=>{this.detachView(b.hostView),Zx(this.components,b),B&&B.unregisterApplication(T)}),this._loadComponent(b),b}tick(){if(this._runningTick)throw new ut(101,"");try{this._runningTick=!0;for(let o of this._views)o.detectChanges()}catch(o){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(o))}finally{this._runningTick=!1}}attachView(o){const c=o;this._views.push(c),c.attachToAppRef(this)}detachView(o){const c=o;Zx(this._views,c),c.detachFromAppRef()}_loadComponent(o){this.attachView(o.hostView),this.tick(),this.components.push(o),this._injector.get(En,[]).concat(this._bootstrapListeners).forEach(h=>h(o))}ngOnDestroy(){this._views.slice().forEach(o=>o.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return n.\u0275fac=function(o){return new(o||n)(Ar(Cs),Ar(Lo),Ar(xd),Ar(de))},n.\u0275prov=li({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Zx(n,i){const o=n.indexOf(i);o>-1&&n.splice(o,1)}let Kb=!0;function DE(){Kb=!1}let RE=(()=>{class n{}return n.__NG_ELEMENT_ID__=IE,n})();function IE(n){return function PE(n,i,o){if(Ls(n)&&!o){const c=Ri(n.index,i);return new Gl(c,c)}return 47&n.type?new Gl(i[16],i):null}(Ii(),Fe(),16==(16&n))}class nE{constructor(){}supports(i){return nh(i)}create(i){return new kE(i)}}const UE=(n,i)=>i;class kE{constructor(i){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=i||UE}forEachItem(i){let o;for(o=this._itHead;null!==o;o=o._next)i(o)}forEachOperation(i){let o=this._itHead,c=this._removalsHead,h=0,f=null;for(;o||c;){const g=!c||o&&o.currentIndex<rE(c,h,f)?o:c,b=rE(g,h,f),T=g.currentIndex;if(g===c)h--,c=c._nextRemoved;else if(o=o._next,null==g.previousIndex)h++;else{f||(f=[]);const O=b-h,B=T-h;if(O!=B){for(let re=0;re<O;re++){const ue=re<f.length?f[re]:f[re]=0,Ie=ue+re;B<=Ie&&Ie<O&&(f[re]=ue+1)}f[g.previousIndex]=B-O}}b!==T&&i(g,b,T)}}forEachPreviousItem(i){let o;for(o=this._previousItHead;null!==o;o=o._nextPrevious)i(o)}forEachAddedItem(i){let o;for(o=this._additionsHead;null!==o;o=o._nextAdded)i(o)}forEachMovedItem(i){let o;for(o=this._movesHead;null!==o;o=o._nextMoved)i(o)}forEachRemovedItem(i){let o;for(o=this._removalsHead;null!==o;o=o._nextRemoved)i(o)}forEachIdentityChange(i){let o;for(o=this._identityChangesHead;null!==o;o=o._nextIdentityChange)i(o)}diff(i){if(null==i&&(i=[]),!nh(i))throw new ut(900,"");return this.check(i)?this:null}onDestroy(){}check(i){this._reset();let h,f,g,o=this._itHead,c=!1;if(Array.isArray(i)){this.length=i.length;for(let b=0;b<this.length;b++)f=i[b],g=this._trackByFn(b,f),null!==o&&Object.is(o.trackById,g)?(c&&(o=this._verifyReinsertion(o,f,g,b)),Object.is(o.item,f)||this._addIdentityChange(o,f)):(o=this._mismatch(o,f,g,b),c=!0),o=o._next}else h=0,function T_(n,i){if(Array.isArray(n))for(let o=0;o<n.length;o++)i(n[o]);else{const o=n[Hc()]();let c;for(;!(c=o.next()).done;)i(c.value)}}(i,b=>{g=this._trackByFn(h,b),null!==o&&Object.is(o.trackById,g)?(c&&(o=this._verifyReinsertion(o,b,g,h)),Object.is(o.item,b)||this._addIdentityChange(o,b)):(o=this._mismatch(o,b,g,h),c=!0),o=o._next,h++}),this.length=h;return this._truncate(o),this.collection=i,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let i;for(i=this._previousItHead=this._itHead;null!==i;i=i._next)i._nextPrevious=i._next;for(i=this._additionsHead;null!==i;i=i._nextAdded)i.previousIndex=i.currentIndex;for(this._additionsHead=this._additionsTail=null,i=this._movesHead;null!==i;i=i._nextMoved)i.previousIndex=i.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(i,o,c,h){let f;return null===i?f=this._itTail:(f=i._prev,this._remove(i)),null!==(i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(c,null))?(Object.is(i.item,o)||this._addIdentityChange(i,o),this._reinsertAfter(i,f,h)):null!==(i=null===this._linkedRecords?null:this._linkedRecords.get(c,h))?(Object.is(i.item,o)||this._addIdentityChange(i,o),this._moveAfter(i,f,h)):i=this._addAfter(new BE(o,c),f,h),i}_verifyReinsertion(i,o,c,h){let f=null===this._unlinkedRecords?null:this._unlinkedRecords.get(c,null);return null!==f?i=this._reinsertAfter(f,i._prev,h):i.currentIndex!=h&&(i.currentIndex=h,this._addToMoves(i,h)),i}_truncate(i){for(;null!==i;){const o=i._next;this._addToRemovals(this._unlink(i)),i=o}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(i,o,c){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(i);const h=i._prevRemoved,f=i._nextRemoved;return null===h?this._removalsHead=f:h._nextRemoved=f,null===f?this._removalsTail=h:f._prevRemoved=h,this._insertAfter(i,o,c),this._addToMoves(i,c),i}_moveAfter(i,o,c){return this._unlink(i),this._insertAfter(i,o,c),this._addToMoves(i,c),i}_addAfter(i,o,c){return this._insertAfter(i,o,c),this._additionsTail=null===this._additionsTail?this._additionsHead=i:this._additionsTail._nextAdded=i,i}_insertAfter(i,o,c){const h=null===o?this._itHead:o._next;return i._next=h,i._prev=o,null===h?this._itTail=i:h._prev=i,null===o?this._itHead=i:o._next=i,null===this._linkedRecords&&(this._linkedRecords=new iE),this._linkedRecords.put(i),i.currentIndex=c,i}_remove(i){return this._addToRemovals(this._unlink(i))}_unlink(i){null!==this._linkedRecords&&this._linkedRecords.remove(i);const o=i._prev,c=i._next;return null===o?this._itHead=c:o._next=c,null===c?this._itTail=o:c._prev=o,i}_addToMoves(i,o){return i.previousIndex===o||(this._movesTail=null===this._movesTail?this._movesHead=i:this._movesTail._nextMoved=i),i}_addToRemovals(i){return null===this._unlinkedRecords&&(this._unlinkedRecords=new iE),this._unlinkedRecords.put(i),i.currentIndex=null,i._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=i,i._prevRemoved=null):(i._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=i),i}_addIdentityChange(i,o){return i.item=o,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=i:this._identityChangesTail._nextIdentityChange=i,i}}class BE{constructor(i,o){this.item=i,this.trackById=o,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class HE{constructor(){this._head=null,this._tail=null}add(i){null===this._head?(this._head=this._tail=i,i._nextDup=null,i._prevDup=null):(this._tail._nextDup=i,i._prevDup=this._tail,i._nextDup=null,this._tail=i)}get(i,o){let c;for(c=this._head;null!==c;c=c._nextDup)if((null===o||o<=c.currentIndex)&&Object.is(c.trackById,i))return c;return null}remove(i){const o=i._prevDup,c=i._nextDup;return null===o?this._head=c:o._nextDup=c,null===c?this._tail=o:c._prevDup=o,null===this._head}}class iE{constructor(){this.map=new Map}put(i){const o=i.trackById;let c=this.map.get(o);c||(c=new HE,this.map.set(o,c)),c.add(i)}get(i,o){const h=this.map.get(i);return h?h.get(i,o):null}remove(i){const o=i.trackById;return this.map.get(o).remove(i)&&this.map.delete(o),i}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function rE(n,i,o){const c=n.previousIndex;if(null===c)return c;let h=0;return o&&c<o.length&&(h=o[c]),c+i+h}class sE{constructor(){}supports(i){return i instanceof Map||Up(i)}create(){return new zE}}class zE{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(i){let o;for(o=this._mapHead;null!==o;o=o._next)i(o)}forEachPreviousItem(i){let o;for(o=this._previousMapHead;null!==o;o=o._nextPrevious)i(o)}forEachChangedItem(i){let o;for(o=this._changesHead;null!==o;o=o._nextChanged)i(o)}forEachAddedItem(i){let o;for(o=this._additionsHead;null!==o;o=o._nextAdded)i(o)}forEachRemovedItem(i){let o;for(o=this._removalsHead;null!==o;o=o._nextRemoved)i(o)}diff(i){if(i){if(!(i instanceof Map||Up(i)))throw new ut(900,"")}else i=new Map;return this.check(i)?this:null}onDestroy(){}check(i){this._reset();let o=this._mapHead;if(this._appendAfter=null,this._forEach(i,(c,h)=>{if(o&&o.key===h)this._maybeAddToChanges(o,c),this._appendAfter=o,o=o._next;else{const f=this._getOrCreateRecordForKey(h,c);o=this._insertBeforeOrAppend(o,f)}}),o){o._prev&&(o._prev._next=null),this._removalsHead=o;for(let c=o;null!==c;c=c._nextRemoved)c===this._mapHead&&(this._mapHead=null),this._records.delete(c.key),c._nextRemoved=c._next,c.previousValue=c.currentValue,c.currentValue=null,c._prev=null,c._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(i,o){if(i){const c=i._prev;return o._next=i,o._prev=c,i._prev=o,c&&(c._next=o),i===this._mapHead&&(this._mapHead=o),this._appendAfter=i,i}return this._appendAfter?(this._appendAfter._next=o,o._prev=this._appendAfter):this._mapHead=o,this._appendAfter=o,null}_getOrCreateRecordForKey(i,o){if(this._records.has(i)){const h=this._records.get(i);this._maybeAddToChanges(h,o);const f=h._prev,g=h._next;return f&&(f._next=g),g&&(g._prev=f),h._next=null,h._prev=null,h}const c=new VE(i);return this._records.set(i,c),c.currentValue=o,this._addToAdditions(c),c}_reset(){if(this.isDirty){let i;for(this._previousMapHead=this._mapHead,i=this._previousMapHead;null!==i;i=i._next)i._nextPrevious=i._next;for(i=this._changesHead;null!==i;i=i._nextChanged)i.previousValue=i.currentValue;for(i=this._additionsHead;null!=i;i=i._nextAdded)i.previousValue=i.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(i,o){Object.is(o,i.currentValue)||(i.previousValue=i.currentValue,i.currentValue=o,this._addToChanges(i))}_addToAdditions(i){null===this._additionsHead?this._additionsHead=this._additionsTail=i:(this._additionsTail._nextAdded=i,this._additionsTail=i)}_addToChanges(i){null===this._changesHead?this._changesHead=this._changesTail=i:(this._changesTail._nextChanged=i,this._changesTail=i)}_forEach(i,o){i instanceof Map?i.forEach(o):Object.keys(i).forEach(c=>o(i[c],c))}}class VE{constructor(i){this.key=i,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function oE(){return new tM([new nE])}let tM=(()=>{class n{constructor(o){this.factories=o}static create(o,c){if(null!=c){const h=c.factories.slice();o=o.concat(h)}return new n(o)}static extend(o){return{provide:n,useFactory:c=>n.create(o,c||oE()),deps:[[n,new id,new nd]]}}find(o){const c=this.factories.find(h=>h.supports(o));if(null!=c)return c;throw new ut(901,"")}}return n.\u0275prov=li({token:n,providedIn:"root",factory:oE}),n})();function aE(){return new nM([new sE])}let nM=(()=>{class n{constructor(o){this.factories=o}static create(o,c){if(c){const h=c.factories.slice();o=o.concat(h)}return new n(o)}static extend(o){return{provide:n,useFactory:c=>n.create(o,c||aE()),deps:[[n,new id,new nd]]}}find(o){const c=this.factories.find(f=>f.supports(o));if(c)return c;throw new ut(901,"")}}return n.\u0275prov=li({token:n,providedIn:"root",factory:aE}),n})();const $E=Xb(null,"core",[]);let jE=(()=>{class n{constructor(o){}}return n.\u0275fac=function(o){return new(o||n)(Ar(Yx))},n.\u0275mod=On({type:n}),n.\u0275inj=ri({}),n})()},2313:(Zt,Ve,ne)=>{ne.d(Ve,{H7:()=>ts,b2:()=>ri,q6:()=>li});var k=ne(9808),F=ne(1223);class be extends k.w_{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class Ye extends be{static makeCurrent(){(0,k.HT)(new Ye)}onAndCancel(le,ee,he){return le.addEventListener(ee,he,!1),()=>{le.removeEventListener(ee,he,!1)}}dispatchEvent(le,ee){le.dispatchEvent(ee)}remove(le){le.parentNode&&le.parentNode.removeChild(le)}createElement(le,ee){return(ee=ee||this.getDefaultDocument()).createElement(le)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(le){return le.nodeType===Node.ELEMENT_NODE}isShadowRoot(le){return le instanceof DocumentFragment}getGlobalEventTarget(le,ee){return"window"===ee?window:"document"===ee?le:"body"===ee?le.body:null}getBaseHref(le){const ee=function It(){return Ue=Ue||document.querySelector("base"),Ue?Ue.getAttribute("href"):null}();return null==ee?null:function kt(fe){xt=xt||document.createElement("a"),xt.setAttribute("href",fe);const le=xt.pathname;return"/"===le.charAt(0)?le:`/${le}`}(ee)}resetBaseElement(){Ue=null}getUserAgent(){return window.navigator.userAgent}getCookie(le){return(0,k.Mx)(document.cookie,le)}}let xt,Ue=null;const Ot=new F.OlP("TRANSITION_ID"),ve=[{provide:F.ip1,useFactory:function it(fe,le,ee){return()=>{ee.get(F.CZH).donePromise.then(()=>{const he=(0,k.q)(),$e=le.querySelectorAll(`style[ng-transition="${fe}"]`);for(let on=0;on<$e.length;on++)he.remove($e[on])})}},deps:[Ot,k.K0,F.zs3],multi:!0}];class rt{static init(){(0,F.VLi)(new rt)}addToWindow(le){F.dqk.getAngularTestability=(he,$e=!0)=>{const on=le.findTestabilityInTree(he,$e);if(null==on)throw new Error("Could not find testability for element.");return on},F.dqk.getAllAngularTestabilities=()=>le.getAllTestabilities(),F.dqk.getAllAngularRootElements=()=>le.getAllRootElements(),F.dqk.frameworkStabilizers||(F.dqk.frameworkStabilizers=[]),F.dqk.frameworkStabilizers.push(he=>{const $e=F.dqk.getAllAngularTestabilities();let on=$e.length,On=!1;const Bi=function(gr){On=On||gr,on--,0==on&&he(On)};$e.forEach(function(gr){gr.whenStable(Bi)})})}findTestabilityInTree(le,ee,he){if(null==ee)return null;const $e=le.getTestability(ee);return null!=$e?$e:he?(0,k.q)().isShadowRoot(ee)?this.findTestabilityInTree(le,ee.host,!0):this.findTestabilityInTree(le,ee.parentElement,!0):null}}let nn=(()=>{class fe{build(){return new XMLHttpRequest}}return fe.\u0275fac=function(ee){return new(ee||fe)},fe.\u0275prov=F.Yz7({token:fe,factory:fe.\u0275fac}),fe})();const Ne=new F.OlP("EventManagerPlugins");let Gn=(()=>{class fe{constructor(ee,he){this._zone=he,this._eventNameToPlugin=new Map,ee.forEach($e=>$e.manager=this),this._plugins=ee.slice().reverse()}addEventListener(ee,he,$e){return this._findPluginFor(he).addEventListener(ee,he,$e)}addGlobalEventListener(ee,he,$e){return this._findPluginFor(he).addGlobalEventListener(ee,he,$e)}getZone(){return this._zone}_findPluginFor(ee){const he=this._eventNameToPlugin.get(ee);if(he)return he;const $e=this._plugins;for(let on=0;on<$e.length;on++){const On=$e[on];if(On.supports(ee))return this._eventNameToPlugin.set(ee,On),On}throw new Error(`No event manager plugin found for event ${ee}`)}}return fe.\u0275fac=function(ee){return new(ee||fe)(F.LFG(Ne),F.LFG(F.R0b))},fe.\u0275prov=F.Yz7({token:fe,factory:fe.\u0275fac}),fe})();class Ge{constructor(le){this._doc=le}addGlobalEventListener(le,ee,he){const $e=(0,k.q)().getGlobalEventTarget(this._doc,le);if(!$e)throw new Error(`Unsupported event target ${$e} for event ${ee}`);return this.addEventListener($e,ee,he)}}let fn=(()=>{class fe{constructor(){this._stylesSet=new Set}addStyles(ee){const he=new Set;ee.forEach($e=>{this._stylesSet.has($e)||(this._stylesSet.add($e),he.add($e))}),this.onStylesAdded(he)}onStylesAdded(ee){}getAllStyles(){return Array.from(this._stylesSet)}}return fe.\u0275fac=function(ee){return new(ee||fe)},fe.\u0275prov=F.Yz7({token:fe,factory:fe.\u0275fac}),fe})(),Wn=(()=>{class fe extends fn{constructor(ee){super(),this._doc=ee,this._hostNodes=new Map,this._hostNodes.set(ee.head,[])}_addStylesToHost(ee,he,$e){ee.forEach(on=>{const On=this._doc.createElement("style");On.textContent=on,$e.push(he.appendChild(On))})}addHost(ee){const he=[];this._addStylesToHost(this._stylesSet,ee,he),this._hostNodes.set(ee,he)}removeHost(ee){const he=this._hostNodes.get(ee);he&&he.forEach($n),this._hostNodes.delete(ee)}onStylesAdded(ee){this._hostNodes.forEach((he,$e)=>{this._addStylesToHost(ee,$e,he)})}ngOnDestroy(){this._hostNodes.forEach(ee=>ee.forEach($n))}}return fe.\u0275fac=function(ee){return new(ee||fe)(F.LFG(k.K0))},fe.\u0275prov=F.Yz7({token:fe,factory:fe.\u0275fac}),fe})();function $n(fe){(0,k.q)().remove(fe)}const gt={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Et=/%COMP%/g;function en(fe,le,ee){for(let he=0;he<le.length;he++){let $e=le[he];Array.isArray($e)?en(fe,$e,ee):($e=$e.replace(Et,fe),ee.push($e))}return ee}function kn(fe){return le=>{if("__ngUnwrap__"===le)return fe;!1===fe(le)&&(le.preventDefault(),le.returnValue=!1)}}let mn=(()=>{class fe{constructor(ee,he,$e){this.eventManager=ee,this.sharedStylesHost=he,this.appId=$e,this.rendererByCompId=new Map,this.defaultRenderer=new $t(ee)}createRenderer(ee,he){if(!ee||!he)return this.defaultRenderer;switch(he.encapsulation){case F.ifc.Emulated:{let $e=this.rendererByCompId.get(he.id);return $e||($e=new ot(this.eventManager,this.sharedStylesHost,he,this.appId),this.rendererByCompId.set(he.id,$e)),$e.applyToHost(ee),$e}case 1:case F.ifc.ShadowDom:return new _e(this.eventManager,this.sharedStylesHost,ee,he);default:if(!this.rendererByCompId.has(he.id)){const $e=en(he.id,he.styles,[]);this.sharedStylesHost.addStyles($e),this.rendererByCompId.set(he.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return fe.\u0275fac=function(ee){return new(ee||fe)(F.LFG(Gn),F.LFG(Wn),F.LFG(F.AFp))},fe.\u0275prov=F.Yz7({token:fe,factory:fe.\u0275fac}),fe})();class $t{constructor(le){this.eventManager=le,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(le,ee){return ee?document.createElementNS(gt[ee]||ee,le):document.createElement(le)}createComment(le){return document.createComment(le)}createText(le){return document.createTextNode(le)}appendChild(le,ee){le.appendChild(ee)}insertBefore(le,ee,he){le&&le.insertBefore(ee,he)}removeChild(le,ee){le&&le.removeChild(ee)}selectRootElement(le,ee){let he="string"==typeof le?document.querySelector(le):le;if(!he)throw new Error(`The selector "${le}" did not match any elements`);return ee||(he.textContent=""),he}parentNode(le){return le.parentNode}nextSibling(le){return le.nextSibling}setAttribute(le,ee,he,$e){if($e){ee=$e+":"+ee;const on=gt[$e];on?le.setAttributeNS(on,ee,he):le.setAttribute(ee,he)}else le.setAttribute(ee,he)}removeAttribute(le,ee,he){if(he){const $e=gt[he];$e?le.removeAttributeNS($e,ee):le.removeAttribute(`${he}:${ee}`)}else le.removeAttribute(ee)}addClass(le,ee){le.classList.add(ee)}removeClass(le,ee){le.classList.remove(ee)}setStyle(le,ee,he,$e){$e&(F.JOm.DashCase|F.JOm.Important)?le.style.setProperty(ee,he,$e&F.JOm.Important?"important":""):le.style[ee]=he}removeStyle(le,ee,he){he&F.JOm.DashCase?le.style.removeProperty(ee):le.style[ee]=""}setProperty(le,ee,he){le[ee]=he}setValue(le,ee){le.nodeValue=ee}listen(le,ee,he){return"string"==typeof le?this.eventManager.addGlobalEventListener(le,ee,kn(he)):this.eventManager.addEventListener(le,ee,kn(he))}}class ot extends $t{constructor(le,ee,he,$e){super(le),this.component=he;const on=en($e+"-"+he.id,he.styles,[]);ee.addStyles(on),this.contentAttr=function Mt(fe){return"_ngcontent-%COMP%".replace(Et,fe)}($e+"-"+he.id),this.hostAttr=function yn(fe){return"_nghost-%COMP%".replace(Et,fe)}($e+"-"+he.id)}applyToHost(le){super.setAttribute(le,this.hostAttr,"")}createElement(le,ee){const he=super.createElement(le,ee);return super.setAttribute(he,this.contentAttr,""),he}}class _e extends $t{constructor(le,ee,he,$e){super(le),this.sharedStylesHost=ee,this.hostEl=he,this.shadowRoot=he.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const on=en($e.id,$e.styles,[]);for(let On=0;On<on.length;On++){const Bi=document.createElement("style");Bi.textContent=on[On],this.shadowRoot.appendChild(Bi)}}nodeOrShadowRoot(le){return le===this.hostEl?this.shadowRoot:le}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(le,ee){return super.appendChild(this.nodeOrShadowRoot(le),ee)}insertBefore(le,ee,he){return super.insertBefore(this.nodeOrShadowRoot(le),ee,he)}removeChild(le,ee){return super.removeChild(this.nodeOrShadowRoot(le),ee)}parentNode(le){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(le)))}}let Ee=(()=>{class fe extends Ge{constructor(ee){super(ee)}supports(ee){return!0}addEventListener(ee,he,$e){return ee.addEventListener(he,$e,!1),()=>this.removeEventListener(ee,he,$e)}removeEventListener(ee,he,$e){return ee.removeEventListener(he,$e)}}return fe.\u0275fac=function(ee){return new(ee||fe)(F.LFG(k.K0))},fe.\u0275prov=F.Yz7({token:fe,factory:fe.\u0275fac}),fe})();const Ae=["alt","control","meta","shift"],ft={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},et={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Ht={alt:fe=>fe.altKey,control:fe=>fe.ctrlKey,meta:fe=>fe.metaKey,shift:fe=>fe.shiftKey};let Tn=(()=>{class fe extends Ge{constructor(ee){super(ee)}supports(ee){return null!=fe.parseEventName(ee)}addEventListener(ee,he,$e){const on=fe.parseEventName(he),On=fe.eventCallback(on.fullKey,$e,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>(0,k.q)().onAndCancel(ee,on.domEventName,On))}static parseEventName(ee){const he=ee.toLowerCase().split("."),$e=he.shift();if(0===he.length||"keydown"!==$e&&"keyup"!==$e)return null;const on=fe._normalizeKey(he.pop());let On="";if(Ae.forEach(gr=>{const Ys=he.indexOf(gr);Ys>-1&&(he.splice(Ys,1),On+=gr+".")}),On+=on,0!=he.length||0===on.length)return null;const Bi={};return Bi.domEventName=$e,Bi.fullKey=On,Bi}static getEventFullKey(ee){let he="",$e=function gn(fe){let le=fe.key;if(null==le){if(le=fe.keyIdentifier,null==le)return"Unidentified";le.startsWith("U+")&&(le=String.fromCharCode(parseInt(le.substring(2),16)),3===fe.location&&et.hasOwnProperty(le)&&(le=et[le]))}return ft[le]||le}(ee);return $e=$e.toLowerCase()," "===$e?$e="space":"."===$e&&($e="dot"),Ae.forEach(on=>{on!=$e&&Ht[on](ee)&&(he+=on+".")}),he+=$e,he}static eventCallback(ee,he,$e){return on=>{fe.getEventFullKey(on)===ee&&$e.runGuarded(()=>he(on))}}static _normalizeKey(ee){return"esc"===ee?"escape":ee}}return fe.\u0275fac=function(ee){return new(ee||fe)(F.LFG(k.K0))},fe.\u0275prov=F.Yz7({token:fe,factory:fe.\u0275fac}),fe})();const li=(0,F.eFA)(F._c5,"browser",[{provide:F.Lbi,useValue:k.bD},{provide:F.g9A,useValue:function ht(){Ye.makeCurrent(),rt.init()},multi:!0},{provide:k.K0,useFactory:function Yi(){return(0,F.RDi)(document),document},deps:[]}]),hr=[{provide:F.zSh,useValue:"root"},{provide:F.qLn,useFactory:function bt(){return new F.qLn},deps:[]},{provide:Ne,useClass:Ee,multi:!0,deps:[k.K0,F.R0b,F.Lbi]},{provide:Ne,useClass:Tn,multi:!0,deps:[k.K0]},{provide:mn,useClass:mn,deps:[Gn,Wn,F.AFp]},{provide:F.FYo,useExisting:mn},{provide:fn,useExisting:Wn},{provide:Wn,useClass:Wn,deps:[k.K0]},{provide:F.dDg,useClass:F.dDg,deps:[F.R0b]},{provide:Gn,useClass:Gn,deps:[Ne,F.R0b]},{provide:k.JF,useClass:nn,deps:[]}];let ri=(()=>{class fe{constructor(ee){if(ee)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(ee){return{ngModule:fe,providers:[{provide:F.AFp,useValue:ee.appId},{provide:Ot,useExisting:F.AFp},ve]}}}return fe.\u0275fac=function(ee){return new(ee||fe)(F.LFG(fe,12))},fe.\u0275mod=F.oAB({type:fe}),fe.\u0275inj=F.cJS({providers:hr,imports:[k.ez,F.hGG]}),fe})();"undefined"!=typeof window&&window;let ts=(()=>{class fe{}return fe.\u0275fac=function(ee){return new(ee||fe)},fe.\u0275prov=F.Yz7({token:fe,factory:function(ee){let he=null;return he=ee?new(ee||fe):F.LFG(Qn),he},providedIn:"root"}),fe})(),Qn=(()=>{class fe extends ts{constructor(ee){super(),this._doc=ee}sanitize(ee,he){if(null==he)return null;switch(ee){case F.q3G.NONE:return he;case F.q3G.HTML:return(0,F.qzn)(he,"HTML")?(0,F.z3N)(he):(0,F.EiD)(this._doc,String(he)).toString();case F.q3G.STYLE:return(0,F.qzn)(he,"Style")?(0,F.z3N)(he):he;case F.q3G.SCRIPT:if((0,F.qzn)(he,"Script"))return(0,F.z3N)(he);throw new Error("unsafe value used in a script context");case F.q3G.URL:return(0,F.yhl)(he),(0,F.qzn)(he,"URL")?(0,F.z3N)(he):(0,F.mCW)(String(he));case F.q3G.RESOURCE_URL:if((0,F.qzn)(he,"ResourceURL"))return(0,F.z3N)(he);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${ee} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(ee){return(0,F.JVY)(ee)}bypassSecurityTrustStyle(ee){return(0,F.L6k)(ee)}bypassSecurityTrustScript(ee){return(0,F.eBb)(ee)}bypassSecurityTrustUrl(ee){return(0,F.LAX)(ee)}bypassSecurityTrustResourceUrl(ee){return(0,F.pB0)(ee)}}return fe.\u0275fac=function(ee){return new(ee||fe)(F.LFG(k.K0))},fe.\u0275prov=F.Yz7({token:fe,factory:function(ee){let he=null;return he=ee?new ee:function Vo(fe){return new Qn(fe.get(k.K0))}(F.LFG(F.zs3)),he},providedIn:"root"}),fe})()},6035:(Zt,Ve,ne)=>{ne.d(Ve,{yS:()=>io,Bz:()=>as,lC:()=>G});var k=ne(1223),F=ne(2076),be=ne(9646),Ye=ne(7579);class Ue extends Ye.x{constructor(_){super(),this._value=_}get value(){return this.getValue()}_subscribe(_){const v=super._subscribe(_);return!v.closed&&_.next(this._value),v}getValue(){const{hasError:_,thrownError:v,_value:C}=this;if(_)throw v;return this._throwIfClosed(),C}next(_){super.next(this._value=_)}}var It=ne(8306);const{isArray:xt}=Array,{getPrototypeOf:kt,prototype:Ot,keys:it}=Object;var nn=ne(4671),Ne=ne(4004);const{isArray:Gn}=Array;var Wn=ne(7669),gt=ne(5403),Et=ne(9672);function lt(...w){const _=(0,Wn.yG)(w),v=(0,Wn.jO)(w),{args:C,keys:P}=function ve(w){if(1===w.length){const _=w[0];if(xt(_))return{args:_,keys:null};if(function rt(w){return w&&"object"==typeof w&&kt(w)===Ot}(_)){const v=it(_);return{args:v.map(C=>_[C]),keys:v}}}return{args:w,keys:null}}(w);if(0===C.length)return(0,F.D)([],_);const H=new It.y(function ut(w,_,v=nn.y){return C=>{jn(_,()=>{const{length:P}=w,H=new Array(P);let K=P,ie=P;for(let pe=0;pe<P;pe++)jn(_,()=>{const st=(0,F.D)(w[pe],_);let xn=!1;st.subscribe((0,gt.x)(C,Ft=>{H[pe]=Ft,xn||(xn=!0,ie--),ie||C.next(v(H.slice()))},()=>{--K||C.complete()}))},C)},C)}}(C,_,P?K=>function $n(w,_){return w.reduce((v,C,P)=>(v[C]=_[P],v),{})}(P,K):nn.y));return v?H.pipe(function fn(w){return(0,Ne.U)(_=>function Ge(w,_){return Gn(_)?w(..._):w(_)}(w,_))}(v)):H}function jn(w,_,v){w?(0,Et.f)(v,w,_):_()}var We=ne(576);function Mt(w,_){const v=(0,We.m)(w)?w:()=>w,C=P=>P.error(v());return new It.y(_?P=>_.schedule(C,0,P):C)}var yn=ne(6805),en=ne(8189);function sn(...w){return function kn(){return(0,en.J)(1)}()((0,F.D)(w,(0,Wn.yG)(w)))}var mn=ne(8421);function $t(w){return new It.y(_=>{(0,mn.Xf)(w()).subscribe(_)})}var Vr=ne(515),jt=ne(727),ot=ne(4482);function _e(){return(0,ot.e)((w,_)=>{let v=null;w._refCount++;const C=(0,gt.x)(_,void 0,void 0,void 0,()=>{if(!w||w._refCount<=0||0<--w._refCount)return void(v=null);const P=w._connection,H=v;v=null,P&&(!H||P===H)&&P.unsubscribe(),_.unsubscribe()});w.subscribe(C),C.closed||(v=w.connect())})}class Ee extends It.y{constructor(_,v){super(),this.source=_,this.subjectFactory=v,this._subject=null,this._refCount=0,this._connection=null,(0,ot.A)(_)&&(this.lift=_.lift)}_subscribe(_){return this.getSubject().subscribe(_)}getSubject(){const _=this._subject;return(!_||_.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:_}=this;this._subject=this._connection=null,null==_||_.unsubscribe()}connect(){let _=this._connection;if(!_){_=this._connection=new jt.w0;const v=this.getSubject();_.add(this.source.subscribe((0,gt.x)(v,void 0,()=>{this._teardown(),v.complete()},C=>{this._teardown(),v.error(C)},()=>this._teardown()))),_.closed&&(this._connection=null,_=jt.w0.EMPTY)}return _}refCount(){return _e()(this)}}function Ae(w,_){return(0,ot.e)((v,C)=>{let P=null,H=0,K=!1;const ie=()=>K&&!P&&C.complete();v.subscribe((0,gt.x)(C,pe=>{null==P||P.unsubscribe();let st=0;const xn=H++;(0,mn.Xf)(w(pe,xn)).subscribe(P=(0,gt.x)(C,Ft=>C.next(_?_(pe,Ft,xn,st++):Ft),()=>{P=null,ie()}))},()=>{K=!0,ie()}))})}var Le=ne(5698);function et(w,_,v,C,P){return(H,K)=>{let ie=v,pe=_,st=0;H.subscribe((0,gt.x)(K,xn=>{const Ft=st++;pe=ie?w(pe,xn,Ft):(ie=!0,xn),C&&K.next(pe)},P&&(()=>{ie&&K.next(pe),K.complete()})))}}function Ht(w,_){return(0,ot.e)(et(w,_,arguments.length>=2,!0))}var Tn=ne(9300);function gn(w){return(0,ot.e)((_,v)=>{let H,C=null,P=!1;C=_.subscribe((0,gt.x)(v,void 0,void 0,K=>{H=(0,mn.Xf)(w(K,gn(w)(_))),C?(C.unsubscribe(),C=null,H.subscribe(v)):P=!0})),P&&(C.unsubscribe(),C=null,H.subscribe(v))})}var ht=ne(4351);function bt(w){return w<=0?()=>Vr.E:(0,ot.e)((_,v)=>{let C=[];_.subscribe((0,gt.x)(v,P=>{C.push(P),w<C.length&&C.shift()},()=>{for(const P of C)v.next(P);v.complete()},void 0,()=>{C=null}))})}var Yi=ne(8068),Li=ne(6590),hr=ne(590),ri=ne(5577);function xi(w,_,v){const C=(0,We.m)(w)||_||v?{next:w,error:_,complete:v}:w;return C?(0,ot.e)((P,H)=>{var K;null===(K=C.subscribe)||void 0===K||K.call(C);let ie=!0;P.subscribe((0,gt.x)(H,pe=>{var st;null===(st=C.next)||void 0===st||st.call(C,pe),H.next(pe)},()=>{var pe;ie=!1,null===(pe=C.complete)||void 0===pe||pe.call(C),H.complete()},pe=>{var st;ie=!1,null===(st=C.error)||void 0===st||st.call(C,pe),H.error(pe)},()=>{var pe,st;ie&&(null===(pe=C.unsubscribe)||void 0===pe||pe.call(C)),null===(st=C.finalize)||void 0===st||st.call(C)}))}):nn.y}var ms=ne(9808);class fi{constructor(_,v){this.id=_,this.url=v}}class Rs extends fi{constructor(_,v,C="imperative",P=null){super(_,v),this.navigationTrigger=C,this.restoredState=P}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Jr extends fi{constructor(_,v,C){super(_,v),this.urlAfterRedirects=C}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class xo extends fi{constructor(_,v,C){super(_,v),this.reason=C}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class za extends fi{constructor(_,v,C){super(_,v),this.error=C}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class jl extends fi{constructor(_,v,C,P){super(_,v),this.urlAfterRedirects=C,this.state=P}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class tn extends fi{constructor(_,v,C,P){super(_,v),this.urlAfterRedirects=C,this.state=P}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class xr extends fi{constructor(_,v,C,P,H){super(_,v),this.urlAfterRedirects=C,this.state=P,this.shouldActivate=H}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class ii extends fi{constructor(_,v,C,P){super(_,v),this.urlAfterRedirects=C,this.state=P}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Gt extends fi{constructor(_,v,C,P){super(_,v),this.urlAfterRedirects=C,this.state=P}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class pn{constructor(_){this.route=_}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class _a{constructor(_){this.route=_}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Ir{constructor(_){this.snapshot=_}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Ci{constructor(_){this.snapshot=_}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class zo{constructor(_){this.snapshot=_}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ki{constructor(_){this.snapshot=_}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Qr{constructor(_,v,C){this.routerEvent=_,this.position=v,this.anchor=C}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const zt="primary";class Xl{constructor(_){this.params=_||{}}has(_){return Object.prototype.hasOwnProperty.call(this.params,_)}get(_){if(this.has(_)){const v=this.params[_];return Array.isArray(v)?v[0]:v}return null}getAll(_){if(this.has(_)){const v=this.params[_];return Array.isArray(v)?v:[v]}return[]}get keys(){return Object.keys(this.params)}}function Xn(w){return new Xl(w)}const Va="ngNavigationCancelingError";function ni(w){const _=Error("NavigationCancelingError: "+w);return _[Va]=!0,_}function Is(w,_,v){const C=v.path.split("/");if(C.length>w.length||"full"===v.pathMatch&&(_.hasChildren()||C.length<w.length))return null;const P={};for(let H=0;H<C.length;H++){const K=C[H],ie=w[H];if(K.startsWith(":"))P[K.substring(1)]=ie;else if(K!==ie.path)return null}return{consumed:w.slice(0,C.length),posParams:P}}function An(w,_){const v=w?Object.keys(w):void 0,C=_?Object.keys(_):void 0;if(!v||!C||v.length!=C.length)return!1;let P;for(let H=0;H<v.length;H++)if(P=v[H],!es(w[P],_[P]))return!1;return!0}function es(w,_){if(Array.isArray(w)&&Array.isArray(_)){if(w.length!==_.length)return!1;const v=[...w].sort(),C=[..._].sort();return v.every((P,H)=>C[H]===P)}return w===_}function Gr(w){return Array.prototype.concat.apply([],w)}function ts(w){return w.length>0?w[w.length-1]:null}function Qn(w,_){for(const v in w)w.hasOwnProperty(v)&&_(w[v],v)}function sr(w){return(0,k.CqO)(w)?w:(0,k.QGY)(w)?(0,F.D)(Promise.resolve(w)):(0,be.of)(w)}const le={exact:function on(w,_,v){if(!Ni(w.segments,_.segments)||!Ys(w.segments,_.segments,v)||w.numberOfChildren!==_.numberOfChildren)return!1;for(const C in _.children)if(!w.children[C]||!on(w.children[C],_.children[C],v))return!1;return!0},subset:Bi},ee={exact:function $e(w,_){return An(w,_)},subset:function On(w,_){return Object.keys(_).length<=Object.keys(w).length&&Object.keys(_).every(v=>es(w[v],_[v]))},ignored:()=>!0};function he(w,_,v){return le[v.paths](w.root,_.root,v.matrixParams)&&ee[v.queryParams](w.queryParams,_.queryParams)&&!("exact"===v.fragment&&w.fragment!==_.fragment)}function Bi(w,_,v){return gr(w,_,_.segments,v)}function gr(w,_,v,C){if(w.segments.length>v.length){const P=w.segments.slice(0,v.length);return!(!Ni(P,v)||_.hasChildren()||!Ys(P,v,C))}if(w.segments.length===v.length){if(!Ni(w.segments,v)||!Ys(w.segments,v,C))return!1;for(const P in _.children)if(!w.children[P]||!Bi(w.children[P],_.children[P],C))return!1;return!0}{const P=v.slice(0,w.segments.length),H=v.slice(w.segments.length);return!!(Ni(w.segments,P)&&Ys(w.segments,P,C)&&w.children[zt])&&gr(w.children[zt],_,H,C)}}function Ys(w,_,v){return _.every((C,P)=>ee[v](w[P].parameters,C.parameters))}class ns{constructor(_,v,C){this.root=_,this.queryParams=v,this.fragment=C}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Xn(this.queryParams)),this._queryParamMap}toString(){return Ma.serialize(this)}}class Kt{constructor(_,v){this.segments=_,this.children=v,this.parent=null,Qn(v,(C,P)=>C.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return gs(this)}}class Mr{constructor(_,v){this.path=_,this.parameters=v}get parameterMap(){return this._parameterMap||(this._parameterMap=Xn(this.parameters)),this._parameterMap}toString(){return Zs(this)}}function Ni(w,_){return w.length===_.length&&w.every((v,C)=>v.path===_[C].path)}class xa{}class is{parse(_){const v=new Mo(_);return new ns(v.parseRootSegment(),v.parseQueryParams(),v.parseFragment())}serialize(_){const v=`/${Hi(_.root,!0)}`,C=function $r(w){const _=Object.keys(w).map(v=>{const C=w[v];return Array.isArray(C)?C.map(P=>`${Zi(v)}=${Zi(P)}`).join("&"):`${Zi(v)}=${Zi(C)}`}).filter(v=>!!v);return _.length?`?${_.join("&")}`:""}(_.queryParams);return`${v}${C}${"string"==typeof _.fragment?`#${function wt(w){return encodeURI(w)}(_.fragment)}`:""}`}}const Ma=new is;function gs(w){return w.segments.map(_=>Zs(_)).join("/")}function Hi(w,_){if(!w.hasChildren())return gs(w);if(_){const v=w.children[zt]?Hi(w.children[zt],!1):"",C=[];return Qn(w.children,(P,H)=>{H!==zt&&C.push(`${H}:${Hi(P,!1)}`)}),C.length>0?`${v}(${C.join("//")})`:v}{const v=function Go(w,_){let v=[];return Qn(w.children,(C,P)=>{P===zt&&(v=v.concat(_(C,P)))}),Qn(w.children,(C,P)=>{P!==zt&&(v=v.concat(_(C,P)))}),v}(w,(C,P)=>P===zt?[Hi(w.children[zt],!1)]:[`${P}:${Hi(C,!1)}`]);return 1===Object.keys(w.children).length&&null!=w.children[zt]?`${gs(w)}/${v[0]}`:`${gs(w)}/(${v.join("//")})`}}function ba(w){return encodeURIComponent(w).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Zi(w){return ba(w).replace(/%3B/gi,";")}function Pn(w){return ba(w).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function ci(w){return decodeURIComponent(w)}function yr(w){return ci(w.replace(/\+/g,"%20"))}function Zs(w){return`${Pn(w.path)}${function zi(w){return Object.keys(w).map(_=>`;${Pn(_)}=${Pn(w[_])}`).join("")}(w.parameters)}`}const Ei=/^[^\/()?;=#]+/;function ys(w){const _=w.match(Ei);return _?_[0]:""}const Wo=/^[^=?&#]+/,$o=/^[^&#]+/;class Mo{constructor(_){this.url=_,this.remaining=_}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Kt([],{}):new Kt([],this.parseChildren())}parseQueryParams(){const _={};if(this.consumeOptional("?"))do{this.parseQueryParam(_)}while(this.consumeOptional("&"));return _}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const _=[];for(this.peekStartsWith("(")||_.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),_.push(this.parseSegment());let v={};this.peekStartsWith("/(")&&(this.capture("/"),v=this.parseParens(!0));let C={};return this.peekStartsWith("(")&&(C=this.parseParens(!1)),(_.length>0||Object.keys(v).length>0)&&(C[zt]=new Kt(_,v)),C}parseSegment(){const _=ys(this.remaining);if(""===_&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(_),new Mr(ci(_),this.parseMatrixParams())}parseMatrixParams(){const _={};for(;this.consumeOptional(";");)this.parseParam(_);return _}parseParam(_){const v=ys(this.remaining);if(!v)return;this.capture(v);let C="";if(this.consumeOptional("=")){const P=ys(this.remaining);P&&(C=P,this.capture(C))}_[ci(v)]=ci(C)}parseQueryParam(_){const v=function wn(w){const _=w.match(Wo);return _?_[0]:""}(this.remaining);if(!v)return;this.capture(v);let C="";if(this.consumeOptional("=")){const K=function rs(w){const _=w.match($o);return _?_[0]:""}(this.remaining);K&&(C=K,this.capture(C))}const P=yr(v),H=yr(C);if(_.hasOwnProperty(P)){let K=_[P];Array.isArray(K)||(K=[K],_[P]=K),K.push(H)}else _[P]=H}parseParens(_){const v={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const C=ys(this.remaining),P=this.remaining[C.length];if("/"!==P&&")"!==P&&";"!==P)throw new Error(`Cannot parse url '${this.url}'`);let H;C.indexOf(":")>-1?(H=C.substr(0,C.indexOf(":")),this.capture(H),this.capture(":")):_&&(H=zt);const K=this.parseChildren();v[H]=1===Object.keys(K).length?K[zt]:new Kt([],K),this.consumeOptional("//")}return v}peekStartsWith(_){return this.remaining.startsWith(_)}consumeOptional(_){return!!this.peekStartsWith(_)&&(this.remaining=this.remaining.substring(_.length),!0)}capture(_){if(!this.consumeOptional(_))throw new Error(`Expected "${_}".`)}}class Ps{constructor(_){this._root=_}get root(){return this._root.value}parent(_){const v=this.pathFromRoot(_);return v.length>1?v[v.length-2]:null}children(_){const v=or(_,this._root);return v?v.children.map(C=>C.value):[]}firstChild(_){const v=or(_,this._root);return v&&v.children.length>0?v.children[0].value:null}siblings(_){const v=Ks(_,this._root);return v.length<2?[]:v[v.length-2].children.map(P=>P.value).filter(P=>P!==_)}pathFromRoot(_){return Ks(_,this._root).map(v=>v.value)}}function or(w,_){if(w===_.value)return _;for(const v of _.children){const C=or(w,v);if(C)return C}return null}function Ks(w,_){if(w===_.value)return[_];for(const v of _.children){const C=Ks(w,v);if(C.length)return C.unshift(_),C}return[]}class ar{constructor(_,v){this.value=_,this.children=v}toString(){return`TreeNode(${this.value})`}}function Ki(w){const _={};return w&&w.children.forEach(v=>_[v.value.outlet]=v),_}class si extends Ps{constructor(_,v){super(_),this.snapshot=v,Pr(this,_)}toString(){return this.snapshot.toString()}}function ql(w,_){const v=function Ga(w,_){const K=new Ls([],{},{},"",{},zt,_,null,w.root,-1,{});return new jo("",new ar(K,[]))}(w,_),C=new Ue([new Mr("",{})]),P=new Ue({}),H=new Ue({}),K=new Ue({}),ie=new Ue(""),pe=new br(C,P,K,ie,H,zt,_,v.root);return pe.snapshot=v.root,new si(new ar(pe,[]),v)}class br{constructor(_,v,C,P,H,K,ie,pe){this.url=_,this.params=v,this.queryParams=C,this.fragment=P,this.data=H,this.outlet=K,this.component=ie,this._futureSnapshot=pe}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,Ne.U)(_=>Xn(_)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,Ne.U)(_=>Xn(_)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Di(w,_="emptyOnly"){const v=w.pathFromRoot;let C=0;if("always"!==_)for(C=v.length-1;C>=1;){const P=v[C],H=v[C-1];if(P.routeConfig&&""===P.routeConfig.path)C--;else{if(H.component)break;C--}}return function Wa(w){return w.reduce((_,v)=>({params:Object.assign(Object.assign({},_.params),v.params),data:Object.assign(Object.assign({},_.data),v.data),resolve:Object.assign(Object.assign({},_.resolve),v._resolvedData)}),{params:{},data:{},resolve:{}})}(v.slice(C))}class Ls{constructor(_,v,C,P,H,K,ie,pe,st,xn,Ft){this.url=_,this.params=v,this.queryParams=C,this.fragment=P,this.data=H,this.outlet=K,this.component=ie,this.routeConfig=pe,this._urlSegment=st,this._lastPathIndex=xn,this._resolve=Ft}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Xn(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Xn(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(C=>C.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class jo extends Ps{constructor(_,v){super(v),this.url=_,Pr(this,v)}toString(){return ou(this._root)}}function Pr(w,_){_.value._routerState=w,_.children.forEach(v=>Pr(w,v))}function ou(w){const _=w.children.length>0?` { ${w.children.map(ou).join(", ")} } `:"";return`${w.value}${_}`}function $a(w){if(w.snapshot){const _=w.snapshot,v=w._futureSnapshot;w.snapshot=v,An(_.queryParams,v.queryParams)||w.queryParams.next(v.queryParams),_.fragment!==v.fragment&&w.fragment.next(v.fragment),An(_.params,v.params)||w.params.next(v.params),function hi(w,_){if(w.length!==_.length)return!1;for(let v=0;v<w.length;++v)if(!An(w[v],_[v]))return!1;return!0}(_.url,v.url)||w.url.next(v.url),An(_.data,v.data)||w.data.next(v.data)}else w.snapshot=w._futureSnapshot,w.data.next(w._futureSnapshot.data)}function ja(w,_){const v=An(w.params,_.params)&&function Wr(w,_){return Ni(w,_)&&w.every((v,C)=>An(v.parameters,_[C].parameters))}(w.url,_.url);return v&&!(!w.parent!=!_.parent)&&(!w.parent||ja(w.parent,_.parent))}function jr(w,_,v){if(v&&w.shouldReuseRoute(_.value,v.value.snapshot)){const C=v.value;C._futureSnapshot=_.value;const P=function Er(w,_,v){return _.children.map(C=>{for(const P of v.children)if(w.shouldReuseRoute(C.value,P.value.snapshot))return jr(w,C,P);return jr(w,C)})}(w,_,v);return new ar(C,P)}{if(w.shouldAttach(_.value)){const H=w.retrieve(_.value);if(null!==H){const K=H.route;return K.value._futureSnapshot=_.value,K.children=_.children.map(ie=>jr(w,ie)),K}}const C=function _s(w){return new br(new Ue(w.url),new Ue(w.params),new Ue(w.queryParams),new Ue(w.fragment),new Ue(w.data),w.outlet,w.component,w)}(_.value),P=_.children.map(H=>jr(w,H));return new ar(C,P)}}function ss(w){return"object"==typeof w&&null!=w&&!w.outlets&&!w.segmentPath}function xs(w){return"object"==typeof w&&null!=w&&w.outlets}function Xa(w,_,v,C,P){let H={};if(C&&Qn(C,(ie,pe)=>{H[pe]=Array.isArray(ie)?ie.map(st=>`${st}`):`${ie}`}),w===_)return new ns(v,H,P);const K=Yl(w,_,v);return new ns(K,H,P)}function Yl(w,_,v){const C={};return Qn(w.children,(P,H)=>{C[H]=P===_?v:Yl(P,_,v)}),new Kt(w.segments,C)}class Zl{constructor(_,v,C){if(this.isAbsolute=_,this.numberOfDoubleDots=v,this.commands=C,_&&C.length>0&&ss(C[0]))throw new Error("Root segment cannot have matrix parameters");const P=C.find(xs);if(P&&P!==ts(C))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Js{constructor(_,v,C){this.segmentGroup=_,this.processChildren=v,this.index=C}}function bo(w,_,v){if(w||(w=new Kt([],{})),0===w.segments.length&&w.hasChildren())return Eo(w,_,v);const C=function Tf(w,_,v){let C=0,P=_;const H={match:!1,pathIndex:0,commandIndex:0};for(;P<w.segments.length;){if(C>=v.length)return H;const K=w.segments[P],ie=v[C];if(xs(ie))break;const pe=`${ie}`,st=C<v.length-1?v[C+1]:null;if(P>0&&void 0===pe)break;if(pe&&st&&"object"==typeof st&&void 0===st.outlets){if(!Ya(pe,st,K))return H;C+=2}else{if(!Ya(pe,{},K))return H;C++}P++}return{match:!0,pathIndex:P,commandIndex:C}}(w,_,v),P=v.slice(C.commandIndex);if(C.match&&C.pathIndex<w.segments.length){const H=new Kt(w.segments.slice(0,C.pathIndex),{});return H.children[zt]=new Kt(w.segments.slice(C.pathIndex),w.children),Eo(H,0,P)}return C.match&&0===P.length?new Kt(w.segments,{}):C.match&&!w.hasChildren()?Kl(w,_,v):C.match?Eo(w,0,P):Kl(w,_,v)}function Eo(w,_,v){if(0===v.length)return new Kt(w.segments,{});{const C=function qa(w){return xs(w[0])?w[0].outlets:{[zt]:w}}(v),P={};return Qn(C,(H,K)=>{"string"==typeof H&&(H=[H]),null!==H&&(P[K]=bo(w.children[K],_,H))}),Qn(w.children,(H,K)=>{void 0===C[K]&&(P[K]=H)}),new Kt(w.segments,P)}}function Kl(w,_,v){const C=w.segments.slice(0,_);let P=0;for(;P<v.length;){const H=v[P];if(xs(H)){const pe=lu(H.outlets);return new Kt(C,pe)}if(0===P&&ss(v[0])){C.push(new Mr(w.segments[_].path,Ms(v[0]))),P++;continue}const K=xs(H)?H.outlets[zt]:`${H}`,ie=P<v.length-1?v[P+1]:null;K&&ie&&ss(ie)?(C.push(new Mr(K,Ms(ie))),P+=2):(C.push(new Mr(K,{})),P++)}return new Kt(C,{})}function lu(w){const _={};return Qn(w,(v,C)=>{"string"==typeof v&&(v=[v]),null!==v&&(_[C]=Kl(new Kt([],{}),0,v))}),_}function Ms(w){const _={};return Qn(w,(v,C)=>_[C]=`${v}`),_}function Ya(w,_,v){return w==v.path&&An(_,v.parameters)}class Jl{constructor(_,v,C,P){this.routeReuseStrategy=_,this.futureState=v,this.currState=C,this.forwardEvent=P}activate(_){const v=this.futureState._root,C=this.currState?this.currState._root:null;this.deactivateChildRoutes(v,C,_),$a(this.futureState.root),this.activateChildRoutes(v,C,_)}deactivateChildRoutes(_,v,C){const P=Ki(v);_.children.forEach(H=>{const K=H.value.outlet;this.deactivateRoutes(H,P[K],C),delete P[K]}),Qn(P,(H,K)=>{this.deactivateRouteAndItsChildren(H,C)})}deactivateRoutes(_,v,C){const P=_.value,H=v?v.value:null;if(P===H)if(P.component){const K=C.getContext(P.outlet);K&&this.deactivateChildRoutes(_,v,K.children)}else this.deactivateChildRoutes(_,v,C);else H&&this.deactivateRouteAndItsChildren(v,C)}deactivateRouteAndItsChildren(_,v){_.value.component&&this.routeReuseStrategy.shouldDetach(_.value.snapshot)?this.detachAndStoreRouteSubtree(_,v):this.deactivateRouteAndOutlet(_,v)}detachAndStoreRouteSubtree(_,v){const C=v.getContext(_.value.outlet),P=C&&_.value.component?C.children:v,H=Ki(_);for(const K of Object.keys(H))this.deactivateRouteAndItsChildren(H[K],P);if(C&&C.outlet){const K=C.outlet.detach(),ie=C.children.onOutletDeactivated();this.routeReuseStrategy.store(_.value.snapshot,{componentRef:K,route:_,contexts:ie})}}deactivateRouteAndOutlet(_,v){const C=v.getContext(_.value.outlet),P=C&&_.value.component?C.children:v,H=Ki(_);for(const K of Object.keys(H))this.deactivateRouteAndItsChildren(H[K],P);C&&C.outlet&&(C.outlet.deactivate(),C.children.onOutletDeactivated(),C.attachRef=null,C.resolver=null,C.route=null)}activateChildRoutes(_,v,C){const P=Ki(v);_.children.forEach(H=>{this.activateRoutes(H,P[H.value.outlet],C),this.forwardEvent(new ki(H.value.snapshot))}),_.children.length&&this.forwardEvent(new Ci(_.value.snapshot))}activateRoutes(_,v,C){const P=_.value,H=v?v.value:null;if($a(P),P===H)if(P.component){const K=C.getOrCreateContext(P.outlet);this.activateChildRoutes(_,v,K.children)}else this.activateChildRoutes(_,v,C);else if(P.component){const K=C.getOrCreateContext(P.outlet);if(this.routeReuseStrategy.shouldAttach(P.snapshot)){const ie=this.routeReuseStrategy.retrieve(P.snapshot);this.routeReuseStrategy.store(P.snapshot,null),K.children.onOutletReAttached(ie.contexts),K.attachRef=ie.componentRef,K.route=ie.route.value,K.outlet&&K.outlet.attach(ie.componentRef,ie.route.value),$a(ie.route.value),this.activateChildRoutes(_,null,K.children)}else{const ie=function zh(w){for(let _=w.parent;_;_=_.parent){const v=_.routeConfig;if(v&&v._loadedConfig)return v._loadedConfig;if(v&&v.component)return null}return null}(P.snapshot),pe=ie?ie.module.componentFactoryResolver:null;K.attachRef=null,K.route=P,K.resolver=pe,K.outlet&&K.outlet.activateWith(P,pe),this.activateChildRoutes(_,null,K.children)}}else this.activateChildRoutes(_,null,C)}}class Ql{constructor(_,v){this.routes=_,this.module=v}}function Ns(w){return"function"==typeof w}function Qs(w){return w instanceof ns}const Xo=Symbol("INITIAL_VALUE");function R(){return Ae(w=>lt(w.map(_=>_.pipe((0,Le.q)(1),function ft(...w){const _=(0,Wn.yG)(w);return(0,ot.e)((v,C)=>{(_?sn(w,v,_):sn(w,v)).subscribe(C)})}(Xo)))).pipe(Ht((_,v)=>{let C=!1;return v.reduce((P,H,K)=>P!==Xo?P:(H===Xo&&(C=!0),C||!1!==H&&K!==v.length-1&&!Qs(H)?P:H),_)},Xo),(0,Tn.h)(_=>_!==Xo),(0,Ne.U)(_=>Qs(_)?_:!0===_),(0,Le.q)(1)))}class z{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new I,this.attachRef=null}}class I{constructor(){this.contexts=new Map}onChildOutletCreated(_,v){const C=this.getOrCreateContext(_);C.outlet=v,this.contexts.set(_,C)}onChildOutletDestroyed(_){const v=this.getContext(_);v&&(v.outlet=null,v.attachRef=null)}onOutletDeactivated(){const _=this.contexts;return this.contexts=new Map,_}onOutletReAttached(_){this.contexts=_}getOrCreateContext(_){let v=this.getContext(_);return v||(v=new z,this.contexts.set(_,v)),v}getContext(_){return this.contexts.get(_)||null}}let G=(()=>{class w{constructor(v,C,P,H,K){this.parentContexts=v,this.location=C,this.resolver=P,this.changeDetector=K,this.activated=null,this._activatedRoute=null,this.activateEvents=new k.vpe,this.deactivateEvents=new k.vpe,this.attachEvents=new k.vpe,this.detachEvents=new k.vpe,this.name=H||zt,v.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const v=this.parentContexts.getContext(this.name);v&&v.route&&(v.attachRef?this.attach(v.attachRef,v.route):this.activateWith(v.route,v.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const v=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(v.instance),v}attach(v,C){this.activated=v,this._activatedRoute=C,this.location.insert(v.hostView),this.attachEvents.emit(v.instance)}deactivate(){if(this.activated){const v=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(v)}}activateWith(v,C){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=v;const K=(C=C||this.resolver).resolveComponentFactory(v._futureSnapshot.routeConfig.component),ie=this.parentContexts.getOrCreateContext(this.name).children,pe=new se(v,ie,this.location.injector);this.activated=this.location.createComponent(K,this.location.length,pe),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return w.\u0275fac=function(v){return new(v||w)(k.Y36(I),k.Y36(k.s_b),k.Y36(k._Vd),k.$8M("name"),k.Y36(k.sBO))},w.\u0275dir=k.lG2({type:w,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),w})();class se{constructor(_,v,C){this.route=_,this.childContexts=v,this.parent=C}get(_,v){return _===br?this.route:_===I?this.childContexts:this.parent.get(_,v)}}let Te=(()=>{class w{}return w.\u0275fac=function(v){return new(v||w)},w.\u0275cmp=k.Xpm({type:w,selectors:[["ng-component"]],decls:1,vars:0,template:function(v,C){1&v&&k._UZ(0,"router-outlet")},directives:[G],encapsulation:2}),w})();function Ke(w,_=""){for(let v=0;v<w.length;v++){const C=w[v];pt(C,pi(_,C))}}function pt(w,_){w.children&&Ke(w.children,_)}function pi(w,_){return _?w||_.path?w&&!_.path?`${w}/`:!w&&_.path?_.path:`${w}/${_.path}`:"":w}function di(w){const _=w.children&&w.children.map(di),v=_?Object.assign(Object.assign({},w),{children:_}):Object.assign({},w);return!v.component&&(_||v.loadChildren)&&v.outlet&&v.outlet!==zt&&(v.component=Te),v}function qt(w){return w.outlet||zt}function Cn(w,_){const v=w.filter(C=>qt(C)===_);return v.push(...w.filter(C=>qt(C)!==_)),v}const wi={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Kn(w,_,v){var C;if(""===_.path)return"full"===_.pathMatch&&(w.hasChildren()||v.length>0)?Object.assign({},wi):{matched:!0,consumedSegments:[],remainingSegments:v,parameters:{},positionalParamSegments:{}};const H=(_.matcher||Is)(v,w,_);if(!H)return Object.assign({},wi);const K={};Qn(H.posParams,(pe,st)=>{K[st]=pe.path});const ie=H.consumed.length>0?Object.assign(Object.assign({},K),H.consumed[H.consumed.length-1].parameters):K;return{matched:!0,consumedSegments:H.consumed,remainingSegments:v.slice(H.consumed.length),parameters:ie,positionalParamSegments:null!==(C=H.posParams)&&void 0!==C?C:{}}}function qn(w,_,v,C,P="corrected"){if(v.length>0&&function Mi(w,_,v){return v.some(C=>mi(w,_,C)&&qt(C)!==zt)}(w,v,C)){const K=new Kt(_,function Nr(w,_,v,C){const P={};P[zt]=C,C._sourceSegment=w,C._segmentIndexShift=_.length;for(const H of v)if(""===H.path&&qt(H)!==zt){const K=new Kt([],{});K._sourceSegment=w,K._segmentIndexShift=_.length,P[qt(H)]=K}return P}(w,_,C,new Kt(v,w.children)));return K._sourceSegment=w,K._segmentIndexShift=_.length,{segmentGroup:K,slicedSegments:[]}}if(0===v.length&&function Ri(w,_,v){return v.some(C=>mi(w,_,C))}(w,v,C)){const K=new Kt(w.segments,function bs(w,_,v,C,P,H){const K={};for(const ie of C)if(mi(w,v,ie)&&!P[qt(ie)]){const pe=new Kt([],{});pe._sourceSegment=w,pe._segmentIndexShift="legacy"===H?w.segments.length:_.length,K[qt(ie)]=pe}return Object.assign(Object.assign({},P),K)}(w,_,v,C,w.children,P));return K._sourceSegment=w,K._segmentIndexShift=_.length,{segmentGroup:K,slicedSegments:v}}const H=new Kt(w.segments,w.children);return H._sourceSegment=w,H._segmentIndexShift=_.length,{segmentGroup:H,slicedSegments:v}}function mi(w,_,v){return(!(w.hasChildren()||_.length>0)||"full"!==v.pathMatch)&&""===v.path}function Os(w,_,v,C){return!!(qt(w)===C||C!==zt&&mi(_,v,w))&&("**"===w.path||Kn(_,w,v).matched)}function tc(w,_,v){return 0===_.length&&!w.children[v]}class Or{constructor(_){this.segmentGroup=_||null}}class Vh{constructor(_){this.urlTree=_}}function yi(w){return Mt(new Or(w))}function _n(w){return Mt(new Vh(w))}class wo{constructor(_,v,C,P,H){this.configLoader=v,this.urlSerializer=C,this.urlTree=P,this.config=H,this.allowRedirects=!0,this.ngModule=_.get(k.h0i)}apply(){const _=qn(this.urlTree.root,[],[],this.config).segmentGroup,v=new Kt(_.segments,_.children);return this.expandSegmentGroup(this.ngModule,this.config,v,zt).pipe((0,Ne.U)(H=>this.createUrlTree(nc(H),this.urlTree.queryParams,this.urlTree.fragment))).pipe(gn(H=>{if(H instanceof Vh)return this.allowRedirects=!1,this.match(H.urlTree);throw H instanceof Or?this.noMatchError(H):H}))}match(_){return this.expandSegmentGroup(this.ngModule,this.config,_.root,zt).pipe((0,Ne.U)(P=>this.createUrlTree(nc(P),_.queryParams,_.fragment))).pipe(gn(P=>{throw P instanceof Or?this.noMatchError(P):P}))}noMatchError(_){return new Error(`Cannot match any routes. URL Segment: '${_.segmentGroup}'`)}createUrlTree(_,v,C){const P=_.segments.length>0?new Kt([],{[zt]:_}):_;return new ns(P,v,C)}expandSegmentGroup(_,v,C,P){return 0===C.segments.length&&C.hasChildren()?this.expandChildren(_,v,C).pipe((0,Ne.U)(H=>new Kt([],H))):this.expandSegment(_,C,v,C.segments,P,!0)}expandChildren(_,v,C){const P=[];for(const H of Object.keys(C.children))"primary"===H?P.unshift(H):P.push(H);return(0,F.D)(P).pipe((0,ht.b)(H=>{const K=C.children[H],ie=Cn(v,H);return this.expandSegmentGroup(_,ie,K,H).pipe((0,Ne.U)(pe=>({segment:pe,outlet:H})))}),Ht((H,K)=>(H[K.outlet]=K.segment,H),{}),function li(w,_){const v=arguments.length>=2;return C=>C.pipe(w?(0,Tn.h)((P,H)=>w(P,H,C)):nn.y,bt(1),v?(0,Li.d)(_):(0,Yi.T)(()=>new yn.K))}())}expandSegment(_,v,C,P,H,K){return(0,F.D)(C).pipe((0,ht.b)(ie=>this.expandSegmentAgainstRoute(_,v,C,ie,P,H,K).pipe(gn(st=>{if(st instanceof Or)return(0,be.of)(null);throw st}))),(0,hr.P)(ie=>!!ie),gn((ie,pe)=>{if(ie instanceof yn.K||"EmptyError"===ie.name)return tc(v,P,H)?(0,be.of)(new Kt([],{})):yi(v);throw ie}))}expandSegmentAgainstRoute(_,v,C,P,H,K,ie){return Os(P,v,H,K)?void 0===P.redirectTo?this.matchSegmentAgainstRoute(_,v,P,H,K):ie&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(_,v,C,P,H,K):yi(v):yi(v)}expandSegmentAgainstRouteUsingRedirect(_,v,C,P,H,K){return"**"===P.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(_,C,P,K):this.expandRegularSegmentAgainstRouteUsingRedirect(_,v,C,P,H,K)}expandWildCardWithParamsAgainstRouteUsingRedirect(_,v,C,P){const H=this.applyRedirectCommands([],C.redirectTo,{});return C.redirectTo.startsWith("/")?_n(H):this.lineralizeSegments(C,H).pipe((0,ri.z)(K=>{const ie=new Kt(K,{});return this.expandSegment(_,ie,v,K,P,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(_,v,C,P,H,K){const{matched:ie,consumedSegments:pe,remainingSegments:st,positionalParamSegments:xn}=Kn(v,P,H);if(!ie)return yi(v);const Ft=this.applyRedirectCommands(pe,P.redirectTo,xn);return P.redirectTo.startsWith("/")?_n(Ft):this.lineralizeSegments(P,Ft).pipe((0,ri.z)(oi=>this.expandSegment(_,v,C,oi.concat(st),K,!1)))}matchSegmentAgainstRoute(_,v,C,P,H){if("**"===C.path)return C.loadChildren?(C._loadedConfig?(0,be.of)(C._loadedConfig):this.configLoader.load(_.injector,C)).pipe((0,Ne.U)(Ft=>(C._loadedConfig=Ft,new Kt(P,{})))):(0,be.of)(new Kt(P,{}));const{matched:K,consumedSegments:ie,remainingSegments:pe}=Kn(v,C,P);return K?this.getChildConfig(_,C,P).pipe((0,ri.z)(xn=>{const Ft=xn.module,oi=xn.routes,{segmentGroup:Yn,slicedSegments:Xr}=qn(v,ie,pe,oi),Ao=new Kt(Yn.segments,Yn.children);if(0===Xr.length&&Ao.hasChildren())return this.expandChildren(Ft,oi,Ao).pipe((0,Ne.U)(rl=>new Kt(ie,rl)));if(0===oi.length&&0===Xr.length)return(0,be.of)(new Kt(ie,{}));const vc=qt(C)===H;return this.expandSegment(Ft,Ao,oi,Xr,vc?zt:H,!0).pipe((0,Ne.U)(so=>new Kt(ie.concat(so.segments),so.children)))})):yi(v)}getChildConfig(_,v,C){return v.children?(0,be.of)(new Ql(v.children,_)):v.loadChildren?void 0!==v._loadedConfig?(0,be.of)(v._loadedConfig):this.runCanLoadGuards(_.injector,v,C).pipe((0,ri.z)(P=>P?this.configLoader.load(_.injector,v).pipe((0,Ne.U)(H=>(v._loadedConfig=H,H))):function wa(w){return Mt(ni(`Cannot load children because the guard of the route "path: '${w.path}'" returned false`))}(v))):(0,be.of)(new Ql([],_))}runCanLoadGuards(_,v,C){const P=v.canLoad;if(!P||0===P.length)return(0,be.of)(!0);const H=P.map(K=>{const ie=_.get(K);let pe;if(function Ka(w){return w&&Ns(w.canLoad)}(ie))pe=ie.canLoad(v,C);else{if(!Ns(ie))throw new Error("Invalid CanLoad guard");pe=ie(v,C)}return sr(pe)});return(0,be.of)(H).pipe(R(),xi(K=>{if(!Qs(K))return;const ie=ni(`Redirecting to "${this.urlSerializer.serialize(K)}"`);throw ie.url=K,ie}),(0,Ne.U)(K=>!0===K))}lineralizeSegments(_,v){let C=[],P=v.root;for(;;){if(C=C.concat(P.segments),0===P.numberOfChildren)return(0,be.of)(C);if(P.numberOfChildren>1||!P.children[zt])return Mt(new Error(`Only absolute redirects can have named outlets. redirectTo: '${_.redirectTo}'`));P=P.children[zt]}}applyRedirectCommands(_,v,C){return this.applyRedirectCreatreUrlTree(v,this.urlSerializer.parse(v),_,C)}applyRedirectCreatreUrlTree(_,v,C,P){const H=this.createSegmentGroup(_,v.root,C,P);return new ns(H,this.createQueryParams(v.queryParams,this.urlTree.queryParams),v.fragment)}createQueryParams(_,v){const C={};return Qn(_,(P,H)=>{if("string"==typeof P&&P.startsWith(":")){const ie=P.substring(1);C[H]=v[ie]}else C[H]=P}),C}createSegmentGroup(_,v,C,P){const H=this.createSegments(_,v.segments,C,P);let K={};return Qn(v.children,(ie,pe)=>{K[pe]=this.createSegmentGroup(_,ie,C,P)}),new Kt(H,K)}createSegments(_,v,C,P){return v.map(H=>H.path.startsWith(":")?this.findPosParam(_,H,P):this.findOrReturn(H,C))}findPosParam(_,v,C){const P=C[v.path.substring(1)];if(!P)throw new Error(`Cannot redirect to '${_}'. Cannot find '${v.path}'.`);return P}findOrReturn(_,v){let C=0;for(const P of v){if(P.path===_.path)return v.splice(C),P;C++}return _}}function nc(w){const _={};for(const C of Object.keys(w.children)){const H=nc(w.children[C]);(H.segments.length>0||H.hasChildren())&&(_[C]=H)}return function Cf(w){if(1===w.numberOfChildren&&w.children[zt]){const _=w.children[zt];return new Kt(w.segments.concat(_.segments),_.children)}return w}(new Kt(w.segments,_))}class hu{constructor(_){this.path=_,this.route=this.path[this.path.length-1]}}class Fe{constructor(_,v){this.component=_,this.route=v}}function Dn(w,_,v){const C=w._root;return wr(C,_?_._root:null,v,[C.value])}function Ii(w,_,v){const C=function du(w){if(!w)return null;for(let _=w.parent;_;_=_.parent){const v=_.routeConfig;if(v&&v._loadedConfig)return v._loadedConfig}return null}(_);return(C?C.module.injector:v).get(w)}function wr(w,_,v,C,P={canDeactivateChecks:[],canActivateChecks:[]}){const H=Ki(_);return w.children.forEach(K=>{(function Fs(w,_,v,C,P={canDeactivateChecks:[],canActivateChecks:[]}){const H=w.value,K=_?_.value:null,ie=v?v.getContext(w.value.outlet):null;if(K&&H.routeConfig===K.routeConfig){const pe=function Fr(w,_,v){if("function"==typeof v)return v(w,_);switch(v){case"pathParamsChange":return!Ni(w.url,_.url);case"pathParamsOrQueryParamsChange":return!Ni(w.url,_.url)||!An(w.queryParams,_.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!ja(w,_)||!An(w.queryParams,_.queryParams);default:return!ja(w,_)}}(K,H,H.routeConfig.runGuardsAndResolvers);pe?P.canActivateChecks.push(new hu(C)):(H.data=K.data,H._resolvedData=K._resolvedData),wr(w,_,H.component?ie?ie.children:null:v,C,P),pe&&ie&&ie.outlet&&ie.outlet.isActivated&&P.canDeactivateChecks.push(new Fe(ie.outlet.component,K))}else K&&qo(_,ie,P),P.canActivateChecks.push(new hu(C)),wr(w,null,H.component?ie?ie.children:null:v,C,P)})(K,H[K.value.outlet],v,C.concat([K.value]),P),delete H[K.value.outlet]}),Qn(H,(K,ie)=>qo(K,v.getContext(ie),P)),P}function qo(w,_,v){const C=Ki(w),P=w.value;Qn(C,(H,K)=>{qo(H,P.component?_?_.children.getContext(K):null:_,v)}),v.canDeactivateChecks.push(new Fe(P.component&&_&&_.outlet&&_.outlet.isActivated?_.outlet.component:null,P))}class Es{}function rc(w){return new It.y(_=>_.error(w))}class pu{constructor(_,v,C,P,H,K){this.rootComponentType=_,this.config=v,this.urlTree=C,this.url=P,this.paramsInheritanceStrategy=H,this.relativeLinkResolution=K}recognize(){const _=qn(this.urlTree.root,[],[],this.config.filter(K=>void 0===K.redirectTo),this.relativeLinkResolution).segmentGroup,v=this.processSegmentGroup(this.config,_,zt);if(null===v)return null;const C=new Ls([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},zt,this.rootComponentType,null,this.urlTree.root,-1,{}),P=new ar(C,v),H=new jo(this.url,P);return this.inheritParamsAndData(H._root),H}inheritParamsAndData(_){const v=_.value,C=Di(v,this.paramsInheritanceStrategy);v.params=Object.freeze(C.params),v.data=Object.freeze(C.data),_.children.forEach(P=>this.inheritParamsAndData(P))}processSegmentGroup(_,v,C){return 0===v.segments.length&&v.hasChildren()?this.processChildren(_,v):this.processSegment(_,v,v.segments,C)}processChildren(_,v){const C=[];for(const H of Object.keys(v.children)){const K=v.children[H],ie=Cn(_,H),pe=this.processSegmentGroup(ie,K,H);if(null===pe)return null;C.push(...pe)}const P=lc(C);return function Gh(w){w.sort((_,v)=>_.value.outlet===zt?-1:v.value.outlet===zt?1:_.value.outlet.localeCompare(v.value.outlet))}(P),P}processSegment(_,v,C,P){for(const H of _){const K=this.processSegmentAgainstRoute(H,v,C,P);if(null!==K)return K}return tc(v,C,P)?[]:null}processSegmentAgainstRoute(_,v,C,P){if(_.redirectTo||!Os(_,v,C,P))return null;let H,K=[],ie=[];if("**"===_.path){const Yn=C.length>0?ts(C).parameters:{};H=new Ls(C,Yn,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Sa(_),qt(_),_.component,_,mu(v),cc(v)+C.length,uc(_))}else{const Yn=Kn(v,_,C);if(!Yn.matched)return null;K=Yn.consumedSegments,ie=Yn.remainingSegments,H=new Ls(K,Yn.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Sa(_),qt(_),_.component,_,mu(v),cc(v)+K.length,uc(_))}const pe=function oc(w){return w.children?w.children:w.loadChildren?w._loadedConfig.routes:[]}(_),{segmentGroup:st,slicedSegments:xn}=qn(v,K,ie,pe.filter(Yn=>void 0===Yn.redirectTo),this.relativeLinkResolution);if(0===xn.length&&st.hasChildren()){const Yn=this.processChildren(pe,st);return null===Yn?null:[new ar(H,Yn)]}if(0===pe.length&&0===xn.length)return[new ar(H,[])];const Ft=qt(_)===P,oi=this.processSegment(pe,st,xn,Ft?zt:P);return null===oi?null:[new ar(H,oi)]}}function ac(w){const _=w.value.routeConfig;return _&&""===_.path&&void 0===_.redirectTo}function lc(w){const _=[],v=new Set;for(const C of w){if(!ac(C)){_.push(C);continue}const P=_.find(H=>C.value.routeConfig===H.value.routeConfig);void 0!==P?(P.children.push(...C.children),v.add(P)):_.push(C)}for(const C of v){const P=lc(C.children);_.push(new ar(C.value,P))}return _.filter(C=>!v.has(C))}function mu(w){let _=w;for(;_._sourceSegment;)_=_._sourceSegment;return _}function cc(w){let _=w,v=_._segmentIndexShift?_._segmentIndexShift:0;for(;_._sourceSegment;)_=_._sourceSegment,v+=_._segmentIndexShift?_._segmentIndexShift:0;return v-1}function Sa(w){return w.data||{}}function uc(w){return w.resolve||{}}function _u(w){return[...Object.keys(w),...Object.getOwnPropertySymbols(w)]}function lr(w){return Ae(_=>{const v=w(_);return v?(0,F.D)(v).pipe((0,Ne.U)(()=>_)):(0,be.of)(_)})}class xu extends class Si{shouldDetach(_){return!1}store(_,v){}shouldAttach(_){return!1}retrieve(_){return null}shouldReuseRoute(_,v){return _.routeConfig===v.routeConfig}}{}const hc=new k.OlP("ROUTES");class dc{constructor(_,v,C,P){this.injector=_,this.compiler=v,this.onLoadStartListener=C,this.onLoadEndListener=P}load(_,v){if(v._loader$)return v._loader$;this.onLoadStartListener&&this.onLoadStartListener(v);const P=this.loadModuleFactory(v.loadChildren).pipe((0,Ne.U)(H=>{this.onLoadEndListener&&this.onLoadEndListener(v);const K=H.create(_);return new Ql(Gr(K.injector.get(hc,void 0,k.XFs.Self|k.XFs.Optional)).map(di),K)}),gn(H=>{throw v._loader$=void 0,H}));return v._loader$=new Ee(P,()=>new Ye.x).pipe(_e()),v._loader$}loadModuleFactory(_){return sr(_()).pipe((0,ri.z)(v=>v instanceof k.YKP?(0,be.of)(v):(0,F.D)(this.compiler.compileModuleAsync(v))))}}class Df{shouldProcessUrl(_){return!0}extract(_){return _}merge(_,v){return _}}function jh(w){throw w}function tl(w,_,v){return _.parse("/")}function Ta(w,_){return(0,be.of)(null)}const fc={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},bu={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Ur=(()=>{class w{constructor(v,C,P,H,K,ie,pe){this.rootComponentType=v,this.urlSerializer=C,this.rootContexts=P,this.location=H,this.config=pe,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new Ye.x,this.errorHandler=jh,this.malformedUriErrorHandler=tl,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:Ta,afterPreactivation:Ta},this.urlHandlingStrategy=new Df,this.routeReuseStrategy=new xu,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=K.get(k.h0i),this.console=K.get(k.c2e);const Ft=K.get(k.R0b);this.isNgZoneEnabled=Ft instanceof k.R0b&&k.R0b.isInAngularZone(),this.resetConfig(pe),this.currentUrlTree=function fe(){return new ns(new Kt([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new dc(K,ie,oi=>this.triggerEvent(new pn(oi)),oi=>this.triggerEvent(new _a(oi))),this.routerState=ql(this.currentUrlTree,this.rootComponentType),this.transitions=new Ue({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var v;return null===(v=this.location.getState())||void 0===v?void 0:v.\u0275routerPageId}setupNavigations(v){const C=this.events;return v.pipe((0,Tn.h)(P=>0!==P.id),(0,Ne.U)(P=>Object.assign(Object.assign({},P),{extractedUrl:this.urlHandlingStrategy.extract(P.rawUrl)})),Ae(P=>{let H=!1,K=!1;return(0,be.of)(P).pipe(xi(ie=>{this.currentNavigation={id:ie.id,initialUrl:ie.currentRawUrl,extractedUrl:ie.extractedUrl,trigger:ie.source,extras:ie.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),Ae(ie=>{const pe=this.browserUrlTree.toString(),st=!this.navigated||ie.extractedUrl.toString()!==pe||pe!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||st)&&this.urlHandlingStrategy.shouldProcessUrl(ie.rawUrl))return os(ie.source)&&(this.browserUrlTree=ie.extractedUrl),(0,be.of)(ie).pipe(Ae(Ft=>{const oi=this.transitions.getValue();return C.next(new Rs(Ft.id,this.serializeUrl(Ft.extractedUrl),Ft.source,Ft.restoredState)),oi!==this.transitions.getValue()?Vr.E:Promise.resolve(Ft)}),function uu(w,_,v,C){return Ae(P=>function Pm(w,_,v,C,P){return new wo(w,_,v,C,P).apply()}(w,_,v,P.extractedUrl,C).pipe((0,Ne.U)(H=>Object.assign(Object.assign({},P),{urlAfterRedirects:H}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),xi(Ft=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:Ft.urlAfterRedirects})}),function gu(w,_,v,C,P){return(0,ri.z)(H=>function sc(w,_,v,C,P="emptyOnly",H="legacy"){try{const K=new pu(w,_,v,C,P,H).recognize();return null===K?rc(new Es):(0,be.of)(K)}catch(K){return rc(K)}}(w,_,H.urlAfterRedirects,v(H.urlAfterRedirects),C,P).pipe((0,Ne.U)(K=>Object.assign(Object.assign({},H),{targetSnapshot:K}))))}(this.rootComponentType,this.config,Ft=>this.serializeUrl(Ft),this.paramsInheritanceStrategy,this.relativeLinkResolution),xi(Ft=>{if("eager"===this.urlUpdateStrategy){if(!Ft.extras.skipLocationChange){const Yn=this.urlHandlingStrategy.merge(Ft.urlAfterRedirects,Ft.rawUrl);this.setBrowserUrl(Yn,Ft)}this.browserUrlTree=Ft.urlAfterRedirects}const oi=new jl(Ft.id,this.serializeUrl(Ft.extractedUrl),this.serializeUrl(Ft.urlAfterRedirects),Ft.targetSnapshot);C.next(oi)}));if(st&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:oi,extractedUrl:Yn,source:Xr,restoredState:Ao,extras:vc}=ie,Aa=new Rs(oi,this.serializeUrl(Yn),Xr,Ao);C.next(Aa);const so=ql(Yn,this.rootComponentType).snapshot;return(0,be.of)(Object.assign(Object.assign({},ie),{targetSnapshot:so,urlAfterRedirects:Yn,extras:Object.assign(Object.assign({},vc),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=ie.rawUrl,ie.resolve(null),Vr.E}),lr(ie=>{const{targetSnapshot:pe,id:st,extractedUrl:xn,rawUrl:Ft,extras:{skipLocationChange:oi,replaceUrl:Yn}}=ie;return this.hooks.beforePreactivation(pe,{navigationId:st,appliedUrlTree:xn,rawUrlTree:Ft,skipLocationChange:!!oi,replaceUrl:!!Yn})}),xi(ie=>{const pe=new tn(ie.id,this.serializeUrl(ie.extractedUrl),this.serializeUrl(ie.urlAfterRedirects),ie.targetSnapshot);this.triggerEvent(pe)}),(0,Ne.U)(ie=>Object.assign(Object.assign({},ie),{guards:Dn(ie.targetSnapshot,ie.currentSnapshot,this.rootContexts)})),function Lm(w,_){return(0,ri.z)(v=>{const{targetSnapshot:C,currentSnapshot:P,guards:{canActivateChecks:H,canDeactivateChecks:K}}=v;return 0===K.length&&0===H.length?(0,be.of)(Object.assign(Object.assign({},v),{guardsResult:!0})):function Yo(w,_,v,C){return(0,F.D)(w).pipe((0,ri.z)(P=>function Zo(w,_,v,C,P){const H=_&&_.routeConfig?_.routeConfig.canDeactivate:null;if(!H||0===H.length)return(0,be.of)(!0);const K=H.map(ie=>{const pe=Ii(ie,_,P);let st;if(function ec(w){return w&&Ns(w.canDeactivate)}(pe))st=sr(pe.canDeactivate(w,_,v,C));else{if(!Ns(pe))throw new Error("Invalid CanDeactivate guard");st=sr(pe(w,_,v,C))}return st.pipe((0,hr.P)())});return(0,be.of)(K).pipe(R())}(P.component,P.route,v,_,C)),(0,hr.P)(P=>!0!==P,!0))}(K,C,P,w).pipe((0,ri.z)(ie=>ie&&function cu(w){return"boolean"==typeof w}(ie)?function Qa(w,_,v,C){return(0,F.D)(_).pipe((0,ht.b)(P=>sn(function vr(w,_){return null!==w&&_&&_(new Ir(w)),(0,be.of)(!0)}(P.route.parent,C),function ic(w,_){return null!==w&&_&&_(new zo(w)),(0,be.of)(!0)}(P.route,C),function fu(w,_,v){const C=_[_.length-1],H=_.slice(0,_.length-1).reverse().map(K=>function Ja(w){const _=w.routeConfig?w.routeConfig.canActivateChild:null;return _&&0!==_.length?{node:w,guards:_}:null}(K)).filter(K=>null!==K).map(K=>$t(()=>{const ie=K.guards.map(pe=>{const st=Ii(pe,K.node,v);let xn;if(function Lr(w){return w&&Ns(w.canActivateChild)}(st))xn=sr(st.canActivateChild(C,w));else{if(!Ns(st))throw new Error("Invalid CanActivateChild guard");xn=sr(st(C,w))}return xn.pipe((0,hr.P)())});return(0,be.of)(ie).pipe(R())}));return(0,be.of)(H).pipe(R())}(w,P.path,v),function eo(w,_,v){const C=_.routeConfig?_.routeConfig.canActivate:null;if(!C||0===C.length)return(0,be.of)(!0);const P=C.map(H=>$t(()=>{const K=Ii(H,_,v);let ie;if(function Ea(w){return w&&Ns(w.canActivate)}(K))ie=sr(K.canActivate(_,w));else{if(!Ns(K))throw new Error("Invalid CanActivate guard");ie=sr(K(_,w))}return ie.pipe((0,hr.P)())}));return(0,be.of)(P).pipe(R())}(w,P.route,v))),(0,hr.P)(P=>!0!==P,!0))}(C,H,w,_):(0,be.of)(ie)),(0,Ne.U)(ie=>Object.assign(Object.assign({},v),{guardsResult:ie})))})}(this.ngModule.injector,ie=>this.triggerEvent(ie)),xi(ie=>{if(Qs(ie.guardsResult)){const st=ni(`Redirecting to "${this.serializeUrl(ie.guardsResult)}"`);throw st.url=ie.guardsResult,st}const pe=new xr(ie.id,this.serializeUrl(ie.extractedUrl),this.serializeUrl(ie.urlAfterRedirects),ie.targetSnapshot,!!ie.guardsResult);this.triggerEvent(pe)}),(0,Tn.h)(ie=>!!ie.guardsResult||(this.restoreHistory(ie),this.cancelNavigationTransition(ie,""),!1)),lr(ie=>{if(ie.guards.canActivateChecks.length)return(0,be.of)(ie).pipe(xi(pe=>{const st=new ii(pe.id,this.serializeUrl(pe.extractedUrl),this.serializeUrl(pe.urlAfterRedirects),pe.targetSnapshot);this.triggerEvent(st)}),Ae(pe=>{let st=!1;return(0,be.of)(pe).pipe(function yu(w,_){return(0,ri.z)(v=>{const{targetSnapshot:C,guards:{canActivateChecks:P}}=v;if(!P.length)return(0,be.of)(v);let H=0;return(0,F.D)(P).pipe((0,ht.b)(K=>function vu(w,_,v,C){return function el(w,_,v,C){const P=_u(w);if(0===P.length)return(0,be.of)({});const H={};return(0,F.D)(P).pipe((0,ri.z)(K=>function $h(w,_,v,C){const P=Ii(w,_,C);return sr(P.resolve?P.resolve(_,v):P(_,v))}(w[K],_,v,C).pipe(xi(ie=>{H[K]=ie}))),bt(1),(0,ri.z)(()=>_u(H).length===P.length?(0,be.of)(H):Vr.E))}(w._resolve,w,_,C).pipe((0,Ne.U)(H=>(w._resolvedData=H,w.data=Object.assign(Object.assign({},w.data),Di(w,v).resolve),null)))}(K.route,C,w,_)),xi(()=>H++),bt(1),(0,ri.z)(K=>H===P.length?(0,be.of)(v):Vr.E))})}(this.paramsInheritanceStrategy,this.ngModule.injector),xi({next:()=>st=!0,complete:()=>{st||(this.restoreHistory(pe),this.cancelNavigationTransition(pe,"At least one route resolver didn't emit any value."))}}))}),xi(pe=>{const st=new Gt(pe.id,this.serializeUrl(pe.extractedUrl),this.serializeUrl(pe.urlAfterRedirects),pe.targetSnapshot);this.triggerEvent(st)}))}),lr(ie=>{const{targetSnapshot:pe,id:st,extractedUrl:xn,rawUrl:Ft,extras:{skipLocationChange:oi,replaceUrl:Yn}}=ie;return this.hooks.afterPreactivation(pe,{navigationId:st,appliedUrlTree:xn,rawUrlTree:Ft,skipLocationChange:!!oi,replaceUrl:!!Yn})}),(0,Ne.U)(ie=>{const pe=function vs(w,_,v){const C=jr(w,_._root,v?v._root:void 0);return new si(C,_)}(this.routeReuseStrategy,ie.targetSnapshot,ie.currentRouterState);return Object.assign(Object.assign({},ie),{targetRouterState:pe})}),xi(ie=>{this.currentUrlTree=ie.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(ie.urlAfterRedirects,ie.rawUrl),this.routerState=ie.targetRouterState,"deferred"===this.urlUpdateStrategy&&(ie.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,ie),this.browserUrlTree=ie.urlAfterRedirects)}),((w,_,v)=>(0,Ne.U)(C=>(new Jl(_,C.targetRouterState,C.currentRouterState,v).activate(w),C)))(this.rootContexts,this.routeReuseStrategy,ie=>this.triggerEvent(ie)),xi({next(){H=!0},complete(){H=!0}}),function ps(w){return(0,ot.e)((_,v)=>{try{_.subscribe(v)}finally{v.add(w)}})}(()=>{var ie;H||K||this.cancelNavigationTransition(P,`Navigation ID ${P.id} is not equal to the current navigation id ${this.navigationId}`),(null===(ie=this.currentNavigation)||void 0===ie?void 0:ie.id)===P.id&&(this.currentNavigation=null)}),gn(ie=>{if(K=!0,function su(w){return w&&w[Va]}(ie)){const pe=Qs(ie.url);pe||(this.navigated=!0,this.restoreHistory(P,!0));const st=new xo(P.id,this.serializeUrl(P.extractedUrl),ie.message);C.next(st),pe?setTimeout(()=>{const xn=this.urlHandlingStrategy.merge(ie.url,this.rawUrlTree),Ft={skipLocationChange:P.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||os(P.source)};this.scheduleNavigation(xn,"imperative",null,Ft,{resolve:P.resolve,reject:P.reject,promise:P.promise})},0):P.resolve(!1)}else{this.restoreHistory(P,!0);const pe=new za(P.id,this.serializeUrl(P.extractedUrl),ie);C.next(pe);try{P.resolve(this.errorHandler(ie))}catch(st){P.reject(st)}}return Vr.E}))}))}resetRootComponentType(v){this.rootComponentType=v,this.routerState.root.component=this.rootComponentType}setTransition(v){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),v))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(v=>{const C="popstate"===v.type?"popstate":"hashchange";"popstate"===C&&setTimeout(()=>{var P;const H={replaceUrl:!0},K=(null===(P=v.state)||void 0===P?void 0:P.navigationId)?v.state:null;if(K){const pe=Object.assign({},K);delete pe.navigationId,delete pe.\u0275routerPageId,0!==Object.keys(pe).length&&(H.state=pe)}const ie=this.parseUrl(v.url);this.scheduleNavigation(ie,C,K,H)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(v){this.events.next(v)}resetConfig(v){Ke(v),this.config=v.map(di),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(v,C={}){const{relativeTo:P,queryParams:H,fragment:K,queryParamsHandling:ie,preserveFragment:pe}=C,st=P||this.routerState.root,xn=pe?this.currentUrlTree.fragment:K;let Ft=null;switch(ie){case"merge":Ft=Object.assign(Object.assign({},this.currentUrlTree.queryParams),H);break;case"preserve":Ft=this.currentUrlTree.queryParams;break;default:Ft=H||null}return null!==Ft&&(Ft=this.removeEmptyProps(Ft)),function Sf(w,_,v,C,P){if(0===v.length)return Xa(_.root,_.root,_.root,C,P);const H=function au(w){if("string"==typeof w[0]&&1===w.length&&"/"===w[0])return new Zl(!0,0,w);let _=0,v=!1;const C=w.reduce((P,H,K)=>{if("object"==typeof H&&null!=H){if(H.outlets){const ie={};return Qn(H.outlets,(pe,st)=>{ie[st]="string"==typeof pe?pe.split("/"):pe}),[...P,{outlets:ie}]}if(H.segmentPath)return[...P,H.segmentPath]}return"string"!=typeof H?[...P,H]:0===K?(H.split("/").forEach((ie,pe)=>{0==pe&&"."===ie||(0==pe&&""===ie?v=!0:".."===ie?_++:""!=ie&&P.push(ie))}),P):[...P,H]},[]);return new Zl(v,_,C)}(v);if(H.toRoot())return Xa(_.root,_.root,new Kt([],{}),C,P);const K=function Bh(w,_,v){if(w.isAbsolute)return new Js(_.root,!0,0);if(-1===v.snapshot._lastPathIndex){const H=v.snapshot._urlSegment;return new Js(H,H===_.root,0)}const C=ss(w.commands[0])?0:1;return function Hh(w,_,v){let C=w,P=_,H=v;for(;H>P;){if(H-=P,C=C.parent,!C)throw new Error("Invalid number of '../'");P=C.segments.length}return new Js(C,!1,P-H)}(v.snapshot._urlSegment,v.snapshot._lastPathIndex+C,w.numberOfDoubleDots)}(H,_,w),ie=K.processChildren?Eo(K.segmentGroup,K.index,H.commands):bo(K.segmentGroup,K.index,H.commands);return Xa(_.root,K.segmentGroup,ie,C,P)}(st,this.currentUrlTree,v,Ft,null!=xn?xn:null)}navigateByUrl(v,C={skipLocationChange:!1}){const P=Qs(v)?v:this.parseUrl(v),H=this.urlHandlingStrategy.merge(P,this.rawUrlTree);return this.scheduleNavigation(H,"imperative",null,C)}navigate(v,C={skipLocationChange:!1}){return function pc(w){for(let _=0;_<w.length;_++){const v=w[_];if(null==v)throw new Error(`The requested path contains ${v} segment at index ${_}`)}}(v),this.navigateByUrl(this.createUrlTree(v,C),C)}serializeUrl(v){return this.urlSerializer.serialize(v)}parseUrl(v){let C;try{C=this.urlSerializer.parse(v)}catch(P){C=this.malformedUriErrorHandler(P,this.urlSerializer,v)}return C}isActive(v,C){let P;if(P=!0===C?Object.assign({},fc):!1===C?Object.assign({},bu):C,Qs(v))return he(this.currentUrlTree,v,P);const H=this.parseUrl(v);return he(this.currentUrlTree,H,P)}removeEmptyProps(v){return Object.keys(v).reduce((C,P)=>{const H=v[P];return null!=H&&(C[P]=H),C},{})}processNavigations(){this.navigations.subscribe(v=>{this.navigated=!0,this.lastSuccessfulId=v.id,this.currentPageId=v.targetPageId,this.events.next(new Jr(v.id,this.serializeUrl(v.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,v.resolve(!0)},v=>{this.console.warn(`Unhandled Navigation Error: ${v}`)})}scheduleNavigation(v,C,P,H,K){var ie,pe;if(this.disposed)return Promise.resolve(!1);let st,xn,Ft;K?(st=K.resolve,xn=K.reject,Ft=K.promise):Ft=new Promise((Xr,Ao)=>{st=Xr,xn=Ao});const oi=++this.navigationId;let Yn;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(P=this.location.getState()),Yn=P&&P.\u0275routerPageId?P.\u0275routerPageId:H.replaceUrl||H.skipLocationChange?null!==(ie=this.browserPageId)&&void 0!==ie?ie:0:(null!==(pe=this.browserPageId)&&void 0!==pe?pe:0)+1):Yn=0,this.setTransition({id:oi,targetPageId:Yn,source:C,restoredState:P,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:v,extras:H,resolve:st,reject:xn,promise:Ft,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),Ft.catch(Xr=>Promise.reject(Xr))}setBrowserUrl(v,C){const P=this.urlSerializer.serialize(v),H=Object.assign(Object.assign({},C.extras.state),this.generateNgRouterState(C.id,C.targetPageId));this.location.isCurrentPathEqualTo(P)||C.extras.replaceUrl?this.location.replaceState(P,"",H):this.location.go(P,"",H)}restoreHistory(v,C=!1){var P,H;if("computed"===this.canceledNavigationResolution){const K=this.currentPageId-v.targetPageId;"popstate"!==v.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(P=this.currentNavigation)||void 0===P?void 0:P.finalUrl)||0===K?this.currentUrlTree===(null===(H=this.currentNavigation)||void 0===H?void 0:H.finalUrl)&&0===K&&(this.resetState(v),this.browserUrlTree=v.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(K)}else"replace"===this.canceledNavigationResolution&&(C&&this.resetState(v),this.resetUrlToCurrentUrlTree())}resetState(v){this.routerState=v.currentRouterState,this.currentUrlTree=v.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,v.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(v,C){const P=new xo(v.id,this.serializeUrl(v.extractedUrl),C);this.triggerEvent(P),v.resolve(!1)}generateNgRouterState(v,C){return"computed"===this.canceledNavigationResolution?{navigationId:v,\u0275routerPageId:C}:{navigationId:v}}}return w.\u0275fac=function(v){k.$Z()},w.\u0275prov=k.Yz7({token:w,factory:w.\u0275fac}),w})();function os(w){return"imperative"!==w}let io=(()=>{class w{constructor(v,C,P){this.router=v,this.route=C,this.locationStrategy=P,this.commands=null,this.href=null,this.onChanges=new Ye.x,this.subscription=v.events.subscribe(H=>{H instanceof Jr&&this.updateTargetUrlAndHref()})}set routerLink(v){this.commands=null!=v?Array.isArray(v)?v:[v]:null}ngOnChanges(v){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(v,C,P,H,K){if(0!==v||C||P||H||K||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)return!0;const ie={skipLocationChange:ws(this.skipLocationChange),replaceUrl:ws(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,ie),!1}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:ws(this.preserveFragment)})}}return w.\u0275fac=function(v){return new(v||w)(k.Y36(Ur),k.Y36(br),k.Y36(ms.S$))},w.\u0275dir=k.lG2({type:w,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(v,C){1&v&&k.NdJ("click",function(H){return C.onClick(H.button,H.ctrlKey,H.shiftKey,H.altKey,H.metaKey)}),2&v&&k.uIk("target",C.target)("href",C.href,k.LSH)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[k.TTD]}),w})();function ws(w){return""===w||!!w}class Eu{}class Om{preload(_,v){return(0,be.of)(null)}}let Fm=(()=>{class w{constructor(v,C,P,H){this.router=v,this.injector=P,this.preloadingStrategy=H,this.loader=new dc(P,C,pe=>v.triggerEvent(new pn(pe)),pe=>v.triggerEvent(new _a(pe)))}setUpPreloading(){this.subscription=this.router.events.pipe((0,Tn.h)(v=>v instanceof Jr),(0,ht.b)(()=>this.preload())).subscribe(()=>{})}preload(){const v=this.injector.get(k.h0i);return this.processRoutes(v,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(v,C){const P=[];for(const H of C)if(H.loadChildren&&!H.canLoad&&H._loadedConfig){const K=H._loadedConfig;P.push(this.processRoutes(K.module,K.routes))}else H.loadChildren&&!H.canLoad?P.push(this.preloadConfig(v,H)):H.children&&P.push(this.processRoutes(v,H.children));return(0,F.D)(P).pipe((0,en.J)(),(0,Ne.U)(H=>{}))}preloadConfig(v,C){return this.preloadingStrategy.preload(C,()=>(C._loadedConfig?(0,be.of)(C._loadedConfig):this.loader.load(v.injector,C)).pipe((0,ri.z)(H=>(C._loadedConfig=H,this.processRoutes(H.module,H.routes)))))}}return w.\u0275fac=function(v){return new(v||w)(k.LFG(Ur),k.LFG(k.Sil),k.LFG(k.zs3),k.LFG(Eu))},w.\u0275prov=k.Yz7({token:w,factory:w.\u0275fac}),w})(),Ko=(()=>{class w{constructor(v,C,P={}){this.router=v,this.viewportScroller=C,this.options=P,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},P.scrollPositionRestoration=P.scrollPositionRestoration||"disabled",P.anchorScrolling=P.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(v=>{v instanceof Rs?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=v.navigationTrigger,this.restoredId=v.restoredState?v.restoredState.navigationId:0):v instanceof Jr&&(this.lastId=v.id,this.scheduleScrollEvent(v,this.router.parseUrl(v.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(v=>{v instanceof Qr&&(v.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(v.position):v.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(v.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(v,C){this.router.triggerEvent(new Qr(v,"popstate"===this.lastSource?this.store[this.restoredId]:null,C))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return w.\u0275fac=function(v){k.$Z()},w.\u0275prov=k.Yz7({token:w,factory:w.\u0275fac}),w})();const ro=new k.OlP("ROUTER_CONFIGURATION"),il=new k.OlP("ROUTER_FORROOT_GUARD"),To=[ms.Ye,{provide:xa,useClass:is},{provide:Ur,useFactory:function qh(w,_,v,C,P,H,K={},ie,pe){const st=new Ur(null,w,_,v,C,P,Gr(H));return ie&&(st.urlHandlingStrategy=ie),pe&&(st.routeReuseStrategy=pe),function Rf(w,_){w.errorHandler&&(_.errorHandler=w.errorHandler),w.malformedUriErrorHandler&&(_.malformedUriErrorHandler=w.malformedUriErrorHandler),w.onSameUrlNavigation&&(_.onSameUrlNavigation=w.onSameUrlNavigation),w.paramsInheritanceStrategy&&(_.paramsInheritanceStrategy=w.paramsInheritanceStrategy),w.relativeLinkResolution&&(_.relativeLinkResolution=w.relativeLinkResolution),w.urlUpdateStrategy&&(_.urlUpdateStrategy=w.urlUpdateStrategy),w.canceledNavigationResolution&&(_.canceledNavigationResolution=w.canceledNavigationResolution)}(K,st),K.enableTracing&&st.events.subscribe(xn=>{var Ft,oi;null===(Ft=console.group)||void 0===Ft||Ft.call(console,`Router Event: ${xn.constructor.name}`),console.log(xn.toString()),console.log(xn),null===(oi=console.groupEnd)||void 0===oi||oi.call(console)}),st},deps:[xa,I,ms.Ye,k.zs3,k.Sil,hc,ro,[class Mu{},new k.FiY],[class to{},new k.FiY]]},I,{provide:br,useFactory:function If(w){return w.routerState.root},deps:[Ur]},Fm,Om,class Nm{preload(_,v){return v().pipe(gn(()=>(0,be.of)(null)))}},{provide:ro,useValue:{enableTracing:!1}}];function Xh(){return new k.PXZ("Router",Ur)}let as=(()=>{class w{constructor(v,C){}static forRoot(v,C){return{ngModule:w,providers:[To,gc(v),{provide:il,useFactory:mc,deps:[[Ur,new k.FiY,new k.tp0]]},{provide:ro,useValue:C||{}},{provide:ms.S$,useFactory:Sr,deps:[ms.lw,[new k.tBr(ms.mr),new k.FiY],ro]},{provide:Ko,useFactory:Ln,deps:[Ur,ms.EM,ro]},{provide:Eu,useExisting:C&&C.preloadingStrategy?C.preloadingStrategy:Om},{provide:k.PXZ,multi:!0,useFactory:Xh},[Yh,{provide:k.ip1,multi:!0,useFactory:Um,deps:[Yh]},{provide:wu,useFactory:yc,deps:[Yh]},{provide:k.tb,multi:!0,useExisting:wu}]]}}static forChild(v){return{ngModule:w,providers:[gc(v)]}}}return w.\u0275fac=function(v){return new(v||w)(k.LFG(il,8),k.LFG(Ur,8))},w.\u0275mod=k.oAB({type:w}),w.\u0275inj=k.cJS({}),w})();function Ln(w,_,v){return v.scrollOffset&&_.setOffset(v.scrollOffset),new Ko(w,_,v)}function Sr(w,_,v={}){return v.useHash?new ms.Do(w,_):new ms.b0(w,_)}function mc(w){return"guarded"}function gc(w){return[{provide:k.deG,multi:!0,useValue:w},{provide:hc,multi:!0,useValue:w}]}let Yh=(()=>{class w{constructor(v){this.injector=v,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new Ye.x}appInitializer(){return this.injector.get(ms.V_,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let C=null;const P=new Promise(ie=>C=ie),H=this.injector.get(Ur),K=this.injector.get(ro);return"disabled"===K.initialNavigation?(H.setUpLocationChangeListener(),C(!0)):"enabled"===K.initialNavigation||"enabledBlocking"===K.initialNavigation?(H.hooks.afterPreactivation=()=>this.initNavigation?(0,be.of)(null):(this.initNavigation=!0,C(!0),this.resultOfPreactivationDone),H.initialNavigation()):C(!0),P})}bootstrapListener(v){const C=this.injector.get(ro),P=this.injector.get(Fm),H=this.injector.get(Ko),K=this.injector.get(Ur),ie=this.injector.get(k.z2F);v===ie.components[0]&&(("enabledNonBlocking"===C.initialNavigation||void 0===C.initialNavigation)&&K.initialNavigation(),P.setUpPreloading(),H.init(),K.resetRootComponentType(ie.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return w.\u0275fac=function(v){return new(v||w)(k.LFG(k.zs3))},w.\u0275prov=k.Yz7({token:w,factory:w.\u0275fac}),w})();function Um(w){return w.appInitializer.bind(w)}function yc(w){return w.bootstrapListener.bind(w)}const wu=new k.OlP("Router Initializer")},7582:(Zt,Ve,ne)=>{function rt(_e,Ee,Ae,Le){return new(Ae||(Ae=Promise))(function(et,Ht){function Tn(bt){try{ht(Le.next(bt))}catch(Yi){Ht(Yi)}}function gn(bt){try{ht(Le.throw(bt))}catch(Yi){Ht(Yi)}}function ht(bt){bt.done?et(bt.value):function ft(et){return et instanceof Ae?et:new Ae(function(Ht){Ht(et)})}(bt.value).then(Tn,gn)}ht((Le=Le.apply(_e,Ee||[])).next())})}function Et(_e){return this instanceof Et?(this.v=_e,this):new Et(_e)}function lt(_e,Ee,Ae){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var ft,Le=Ae.apply(_e,Ee||[]),et=[];return ft={},Ht("next"),Ht("throw"),Ht("return"),ft[Symbol.asyncIterator]=function(){return this},ft;function Ht(Li){Le[Li]&&(ft[Li]=function(li){return new Promise(function(hr,ri){et.push([Li,li,hr,ri])>1||Tn(Li,li)})})}function Tn(Li,li){try{!function gn(Li){Li.value instanceof Et?Promise.resolve(Li.value.v).then(ht,bt):Yi(et[0][2],Li)}(Le[Li](li))}catch(hr){Yi(et[0][3],hr)}}function ht(Li){Tn("next",Li)}function bt(Li){Tn("throw",Li)}function Yi(Li,li){Li(li),et.shift(),et.length&&Tn(et[0][0],et[0][1])}}function jn(_e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Ae,Ee=_e[Symbol.asyncIterator];return Ee?Ee.call(_e):(_e=function Ge(_e){var Ee="function"==typeof Symbol&&Symbol.iterator,Ae=Ee&&_e[Ee],Le=0;if(Ae)return Ae.call(_e);if(_e&&"number"==typeof _e.length)return{next:function(){return _e&&Le>=_e.length&&(_e=void 0),{value:_e&&_e[Le++],done:!_e}}};throw new TypeError(Ee?"Object is not iterable.":"Symbol.iterator is not defined.")}(_e),Ae={},Le("next"),Le("throw"),Le("return"),Ae[Symbol.asyncIterator]=function(){return this},Ae);function Le(et){Ae[et]=_e[et]&&function(Ht){return new Promise(function(Tn,gn){!function ft(et,Ht,Tn,gn){Promise.resolve(gn).then(function(ht){et({value:ht,done:Tn})},Ht)}(Tn,gn,(Ht=_e[et](Ht)).done,Ht.value)})}}}ne.d(Ve,{FC:()=>lt,KL:()=>jn,mG:()=>rt,qq:()=>Et}),"function"==typeof SuppressedError&&SuppressedError}},Zt=>{Zt(Zt.s=3962)}]);