"use strict";var uT=Object.defineProperty,hT=Object.defineProperties,dT=Object.getOwnPropertyDescriptors,EA=Object.getOwnPropertySymbols,fT=Object.prototype.hasOwnProperty,pT=Object.prototype.propertyIsEnumerable,gE=(an,Je,ie)=>Je in an?uT(an,Je,{enumerable:!0,configurable:!0,writable:!0,value:ie}):an[Je]=ie,la=(an,Je)=>{for(var ie in Je||(Je={}))fT.call(Je,ie)&&gE(an,ie,Je[ie]);if(EA)for(var ie of EA(Je))pT.call(Je,ie)&&gE(an,ie,Je[ie]);return an},Im=(an,Je)=>hT(an,dT(Je)),SA=(an,Je,ie)=>(gE(an,"symbol"!=typeof Je?Je+"":Je,ie),ie);(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[179],{3890:(an,Je,ie)=>{ie.r(Je),ie.d(Je,{ShaderModule:()=>rT});var G=ie(9808),I=ie(1223);let et={async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,hooks:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1};const kt=/[&<>"']/,mt=new RegExp(kt.source,"g"),It=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,zt=new RegExp(It.source,"g"),rt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ye=o=>rt[o];function gt(o,e){if(e){if(kt.test(o))return o.replace(mt,ye)}else if(It.test(o))return o.replace(zt,ye);return o}const zn=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function st(o){return o.replace(zn,(e,t)=>"colon"===(t=t.toLowerCase())?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):"")}const Jn=/(^|[^\[])\^/g;function Qe(o,e){o="string"==typeof o?o:o.source,e=e||"";const t={replace:(n,i)=>(i=(i=i.source||i).replace(Jn,"$1"),o=o.replace(n,i),t),getRegex:()=>new RegExp(o,e)};return t}const pn=/[^\w:]/g,Xn=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function Fn(o,e,t){if(o){let n;try{n=decodeURIComponent(st(t)).replace(pn,"").toLowerCase()}catch(i){return null}if(0===n.indexOf("javascript:")||0===n.indexOf("vbscript:")||0===n.indexOf("data:"))return null}e&&!Xn.test(t)&&(t=function jn(o,e){Pt[" "+o]||(Pt[" "+o]=Ot.test(o)?o+"/":cn(o,"/",!0));const t=-1===(o=Pt[" "+o]).indexOf(":");return"//"===e.substring(0,2)?t?e:o.replace(dt,"$1")+e:"/"===e.charAt(0)?t?e:o.replace(vt,"$1")+e:o+e}(e,t));try{t=encodeURI(t).replace(/%25/g,"%")}catch(n){return null}return t}const Pt={},Ot=/^[^:]+:\/*[^/]*$/,dt=/^([^:]+:)[\s\S]*$/,vt=/^([^:]+:\/*[^/]*)[\s\S]*$/,qe={exec:function(){}};function Ft(o,e){const n=o.replace(/\|/g,(a,c,u)=>{let d=!1,p=c;for(;--p>=0&&"\\"===u[p];)d=!d;return d?"|":" |"}).split(/ \|/);let i=0;if(n[0].trim()||n.shift(),n.length>0&&!n[n.length-1].trim()&&n.pop(),n.length>e)n.splice(e);else for(;n.length<e;)n.push("");for(;i<n.length;i++)n[i]=n[i].trim().replace(/\\\|/g,"|");return n}function cn(o,e,t){const n=o.length;if(0===n)return"";let i=0;for(;i<n;){const a=o.charAt(n-i-1);if(a!==e||t){if(a===e||!t)break;i++}else i++}return o.slice(0,n-i)}function Dt(o,e){if(e<1)return"";let t="";for(;e>1;)1&e&&(t+=o),e>>=1,o+=o;return t+o}function gn(o,e,t,n){const i=e.href,a=e.title?gt(e.title):null,c=o[1].replace(/\\([\[\]])/g,"$1");if("!"!==o[0].charAt(0)){n.state.inLink=!0;const u={type:"link",raw:t,href:i,title:a,text:c,tokens:n.inlineTokens(c)};return n.state.inLink=!1,u}return{type:"image",raw:t,href:i,title:a,text:gt(c)}}class Sr{constructor(e){this.options=e||et}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const n=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?n:cn(n,"\n")}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const n=t[0],i=function en(o,e){const t=o.match(/^(\s+)(?:```)/);if(null===t)return e;const n=t[1];return e.split("\n").map(i=>{const a=i.match(/^\s+/);if(null===a)return i;const[c]=a;return c.length>=n.length?i.slice(n.length):i}).join("\n")}(n,t[3]||"");return{type:"code",raw:n,lang:t[2]?t[2].trim().replace(this.rules.inline._escapes,"$1"):t[2],text:i}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let n=t[2].trim();if(/#$/.test(n)){const i=cn(n,"#");(this.options.pedantic||!i||/ $/.test(i))&&(n=i.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){const n=t[0].replace(/^ *>[ \t]?/gm,""),i=this.lexer.state.top;this.lexer.state.top=!0;const a=this.lexer.blockTokens(n);return this.lexer.state.top=i,{type:"blockquote",raw:t[0],tokens:a,text:n}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n,i,a,c,u,d,p,v,_,M,b,A,P=t[1].trim();const R=P.length>1,T={type:"list",raw:"",ordered:R,start:R?+P.slice(0,-1):"",loose:!1,items:[]};P=R?`\\d{1,9}\\${P.slice(-1)}`:`\\${P}`,this.options.pedantic&&(P=R?P:"[*+-]");const U=new RegExp(`^( {0,3}${P})((?:[\t ][^\\n]*)?(?:\\n|$))`);for(;e&&(A=!1,(t=U.exec(e))&&!this.rules.block.hr.test(e));){if(n=t[0],e=e.substring(n.length),v=t[2].split("\n",1)[0].replace(/^\t+/,V=>" ".repeat(3*V.length)),_=e.split("\n",1)[0],this.options.pedantic?(c=2,b=v.trimLeft()):(c=t[2].search(/[^ ]/),c=c>4?1:c,b=v.slice(c),c+=t[1].length),d=!1,!v&&/^ *$/.test(_)&&(n+=_+"\n",e=e.substring(_.length+1),A=!0),!A){const V=new RegExp(`^ {0,${Math.min(3,c-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ \t][^\\n]*)?(?:\\n|$))`),X=new RegExp(`^ {0,${Math.min(3,c-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),Z=new RegExp(`^ {0,${Math.min(3,c-1)}}(?:\`\`\`|~~~)`),q=new RegExp(`^ {0,${Math.min(3,c-1)}}#`);for(;e&&(M=e.split("\n",1)[0],_=M,this.options.pedantic&&(_=_.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!(Z.test(_)||q.test(_)||V.test(_)||X.test(e)));){if(_.search(/[^ ]/)>=c||!_.trim())b+="\n"+_.slice(c);else{if(d||v.search(/[^ ]/)>=4||Z.test(v)||q.test(v)||X.test(v))break;b+="\n"+_}!d&&!_.trim()&&(d=!0),n+=M+"\n",e=e.substring(M.length+1),v=_.slice(c)}}T.loose||(p?T.loose=!0:/\n *\n *$/.test(n)&&(p=!0)),this.options.gfm&&(i=/^\[[ xX]\] /.exec(b),i&&(a="[ ] "!==i[0],b=b.replace(/^\[[ xX]\] +/,""))),T.items.push({type:"list_item",raw:n,task:!!i,checked:a,loose:!1,text:b}),T.raw+=n}T.items[T.items.length-1].raw=n.trimRight(),T.items[T.items.length-1].text=b.trimRight(),T.raw=T.raw.trimRight();const F=T.items.length;for(u=0;u<F;u++)if(this.lexer.state.top=!1,T.items[u].tokens=this.lexer.blockTokens(T.items[u].text,[]),!T.loose){const V=T.items[u].tokens.filter(Z=>"space"===Z.type),X=V.length>0&&V.some(Z=>/\n.*\n/.test(Z.raw));T.loose=X}if(T.loose)for(u=0;u<F;u++)T.items[u].loose=!0;return T}}html(e){const t=this.rules.block.html.exec(e);if(t){const n={type:"html",raw:t[0],pre:!this.options.sanitizer&&("pre"===t[1]||"script"===t[1]||"style"===t[1]),text:t[0]};if(this.options.sanitize){const i=this.options.sanitizer?this.options.sanitizer(t[0]):gt(t[0]);n.type="paragraph",n.text=i,n.tokens=this.lexer.inline(i)}return n}}def(e){const t=this.rules.block.def.exec(e);if(t){const n=t[1].toLowerCase().replace(/\s+/g," "),i=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline._escapes,"$1"):"",a=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline._escapes,"$1"):t[3];return{type:"def",tag:n,raw:t[0],href:i,title:a}}}table(e){const t=this.rules.block.table.exec(e);if(t){const n={type:"table",header:Ft(t[1]).map(i=>({text:i})),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split("\n"):[]};if(n.header.length===n.align.length){n.raw=t[0];let a,c,u,d,i=n.align.length;for(a=0;a<i;a++)n.align[a]=/^ *-+: *$/.test(n.align[a])?"right":/^ *:-+: *$/.test(n.align[a])?"center":/^ *:-+ *$/.test(n.align[a])?"left":null;for(i=n.rows.length,a=0;a<i;a++)n.rows[a]=Ft(n.rows[a],n.header.length).map(p=>({text:p}));for(i=n.header.length,c=0;c<i;c++)n.header[c].tokens=this.lexer.inline(n.header[c].text);for(i=n.rows.length,c=0;c<i;c++)for(d=n.rows[c],u=0;u<d.length;u++)d[u].tokens=this.lexer.inline(d[u].text);return n}}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:"="===t[2].charAt(0)?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const n="\n"===t[1].charAt(t[1].length-1)?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:n,tokens:this.lexer.inline(n)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:gt(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(t[0]):gt(t[0]):t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const n=t[2].trim();if(!this.options.pedantic&&/^</.test(n)){if(!/>$/.test(n))return;const c=cn(n.slice(0,-1),"\\");if((n.length-c.length)%2==0)return}else{const c=function mn(o,e){if(-1===o.indexOf(e[1]))return-1;const t=o.length;let n=0,i=0;for(;i<t;i++)if("\\"===o[i])i++;else if(o[i]===e[0])n++;else if(o[i]===e[1]&&(n--,n<0))return i;return-1}(t[2],"()");if(c>-1){const d=(0===t[0].indexOf("!")?5:4)+t[1].length+c;t[2]=t[2].substring(0,c),t[0]=t[0].substring(0,d).trim(),t[3]=""}}let i=t[2],a="";if(this.options.pedantic){const c=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(i);c&&(i=c[1],a=c[3])}else a=t[3]?t[3].slice(1,-1):"";return i=i.trim(),/^</.test(i)&&(i=this.options.pedantic&&!/>$/.test(n)?i.slice(1):i.slice(1,-1)),gn(t,{href:i&&i.replace(this.rules.inline._escapes,"$1"),title:a&&a.replace(this.rules.inline._escapes,"$1")},t[0],this.lexer)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){let i=(n[2]||n[1]).replace(/\s+/g," ");if(i=t[i.toLowerCase()],!i){const a=n[0].charAt(0);return{type:"text",raw:a,text:a}}return gn(n,i,n[0],this.lexer)}}emStrong(e,t,n=""){let i=this.rules.inline.emStrong.lDelim.exec(e);if(!i||i[3]&&n.match(/[\p{L}\p{N}]/u))return;const a=i[1]||i[2]||"";if(!a||a&&(""===n||this.rules.inline.punctuation.exec(n))){const c=i[0].length-1;let u,d,p=c,v=0;const _="*"===i[0][0]?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(_.lastIndex=0,t=t.slice(-1*e.length+c);null!=(i=_.exec(t));){if(u=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!u)continue;if(d=u.length,i[3]||i[4]){p+=d;continue}if((i[5]||i[6])&&c%3&&!((c+d)%3)){v+=d;continue}if(p-=d,p>0)continue;d=Math.min(d,d+p+v);const M=e.slice(0,c+i.index+(i[0].length-u.length)+d);if(Math.min(c,d)%2){const A=M.slice(1,-1);return{type:"em",raw:M,text:A,tokens:this.lexer.inlineTokens(A)}}const b=M.slice(2,-2);return{type:"strong",raw:M,text:b,tokens:this.lexer.inlineTokens(b)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let n=t[2].replace(/\n/g," ");const i=/[^ ]/.test(n),a=/^ /.test(n)&&/ $/.test(n);return i&&a&&(n=n.substring(1,n.length-1)),n=gt(n,!0),{type:"codespan",raw:t[0],text:n}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e,t){const n=this.rules.inline.autolink.exec(e);if(n){let i,a;return"@"===n[2]?(i=gt(this.options.mangle?t(n[1]):n[1]),a="mailto:"+i):(i=gt(n[1]),a=i),{type:"link",raw:n[0],text:i,href:a,tokens:[{type:"text",raw:i,text:i}]}}}url(e,t){let n;if(n=this.rules.inline.url.exec(e)){let i,a;if("@"===n[2])i=gt(this.options.mangle?t(n[0]):n[0]),a="mailto:"+i;else{let c;do{c=n[0],n[0]=this.rules.inline._backpedal.exec(n[0])[0]}while(c!==n[0]);i=gt(n[0]),a="www."===n[1]?"http://"+n[0]:n[0]}return{type:"link",raw:n[0],text:i,href:a,tokens:[{type:"text",raw:i,text:i}]}}}inlineText(e,t){const n=this.rules.inline.text.exec(e);if(n){let i;return i=this.lexer.state.inRawBlock?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(n[0]):gt(n[0]):n[0]:gt(this.options.smartypants?t(n[0]):n[0]),{type:"text",raw:n[0],text:i}}}}const rn={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:qe,lheading:/^((?:.|\n(?!\n))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/,_label:/(?!\s*\])(?:\\.|[^\[\]\\])+/,_title:/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/};rn.def=Qe(rn.def).replace("label",rn._label).replace("title",rn._title).getRegex(),rn.bullet=/(?:[*+-]|\d{1,9}[.)])/,rn.listItemStart=Qe(/^( *)(bull) */).replace("bull",rn.bullet).getRegex(),rn.list=Qe(rn.list).replace(/bull/g,rn.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+rn.def.source+")").getRegex(),rn._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",rn._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,rn.html=Qe(rn.html,"i").replace("comment",rn._comment).replace("tag",rn._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),rn.paragraph=Qe(rn._paragraph).replace("hr",rn.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",rn._tag).getRegex(),rn.blockquote=Qe(rn.blockquote).replace("paragraph",rn.paragraph).getRegex(),rn.normal=la({},rn),rn.gfm=Im(la({},rn.normal),{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),rn.gfm.table=Qe(rn.gfm.table).replace("hr",rn.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",rn._tag).getRegex(),rn.gfm.paragraph=Qe(rn._paragraph).replace("hr",rn.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",rn.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",rn._tag).getRegex(),rn.pedantic=Im(la({},rn.normal),{html:Qe("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",rn._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:qe,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Qe(rn.normal._paragraph).replace("hr",rn.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",rn.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});const Tt={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:qe,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^(?:[^_*\\]|\\.)*?\_\_(?:[^_*\\]|\\.)*?\*(?:[^_*\\]|\\.)*?(?=\_\_)|(?:[^*\\]|\\.)+(?=[^*])|[punct_](\*+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|(?:[^punct*_\s\\]|\\.)(\*+)(?=[^punct*_\s])/,rDelimUnd:/^(?:[^_*\\]|\\.)*?\*\*(?:[^_*\\]|\\.)*?\_(?:[^_*\\]|\\.)*?(?=\*\*)|(?:[^_\\]|\\.)+(?=[^_])|[punct*](\_+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:qe,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};function Ee(o){return o.replace(/---/g,"\u2014").replace(/--/g,"\u2013").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1\u2018").replace(/'/g,"\u2019").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1\u201c").replace(/"/g,"\u201d").replace(/\.{3}/g,"\u2026")}function Ae(o){let t,n,e="";const i=o.length;for(t=0;t<i;t++)n=o.charCodeAt(t),Math.random()>.5&&(n="x"+n.toString(16)),e+="&#"+n+";";return e}Tt._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~",Tt.punctuation=Qe(Tt.punctuation).replace(/punctuation/g,Tt._punctuation).getRegex(),Tt.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,Tt.escapedEmSt=/(?:^|[^\\])(?:\\\\)*\\[*_]/g,Tt._comment=Qe(rn._comment).replace("(?:--\x3e|$)","--\x3e").getRegex(),Tt.emStrong.lDelim=Qe(Tt.emStrong.lDelim).replace(/punct/g,Tt._punctuation).getRegex(),Tt.emStrong.rDelimAst=Qe(Tt.emStrong.rDelimAst,"g").replace(/punct/g,Tt._punctuation).getRegex(),Tt.emStrong.rDelimUnd=Qe(Tt.emStrong.rDelimUnd,"g").replace(/punct/g,Tt._punctuation).getRegex(),Tt._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,Tt._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,Tt._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,Tt.autolink=Qe(Tt.autolink).replace("scheme",Tt._scheme).replace("email",Tt._email).getRegex(),Tt._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,Tt.tag=Qe(Tt.tag).replace("comment",Tt._comment).replace("attribute",Tt._attribute).getRegex(),Tt._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Tt._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,Tt._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,Tt.link=Qe(Tt.link).replace("label",Tt._label).replace("href",Tt._href).replace("title",Tt._title).getRegex(),Tt.reflink=Qe(Tt.reflink).replace("label",Tt._label).replace("ref",rn._label).getRegex(),Tt.nolink=Qe(Tt.nolink).replace("ref",rn._label).getRegex(),Tt.reflinkSearch=Qe(Tt.reflinkSearch,"g").replace("reflink",Tt.reflink).replace("nolink",Tt.nolink).getRegex(),Tt.normal=la({},Tt),Tt.pedantic=Im(la({},Tt.normal),{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:Qe(/^!?\[(label)\]\((.*?)\)/).replace("label",Tt._label).getRegex(),reflink:Qe(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Tt._label).getRegex()}),Tt.gfm=Im(la({},Tt.normal),{escape:Qe(Tt.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),Tt.gfm.url=Qe(Tt.gfm.url,"i").replace("email",Tt.gfm._extended_email).getRegex(),Tt.breaks=Im(la({},Tt.gfm),{br:Qe(Tt.br).replace("{2,}","*").getRegex(),text:Qe(Tt.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});class ke{constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||et,this.options.tokenizer=this.options.tokenizer||new Sr,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:rn.normal,inline:Tt.normal};this.options.pedantic?(t.block=rn.pedantic,t.inline=Tt.pedantic):this.options.gfm&&(t.block=rn.gfm,t.inline=this.options.breaks?Tt.breaks:Tt.gfm),this.tokenizer.rules=t}static get rules(){return{block:rn,inline:Tt}}static lex(e,t){return new ke(t).lex(e)}static lexInline(e,t){return new ke(t).inlineTokens(e)}lex(e){let t;for(e=e.replace(/\r\n|\r/g,"\n"),this.blockTokens(e,this.tokens);t=this.inlineQueue.shift();)this.inlineTokens(t.src,t.tokens);return this.tokens}blockTokens(e,t=[]){let n,i,a,c;for(e=this.options.pedantic?e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e.replace(/^( *)(\t+)/gm,(u,d,p)=>d+"    ".repeat(p.length));e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(u=>!!(n=u.call({lexer:this},e,t))&&(e=e.substring(n.raw.length),t.push(n),!0)))){if(n=this.tokenizer.space(e)){e=e.substring(n.raw.length),1===n.raw.length&&t.length>0?t[t.length-1].raw+="\n":t.push(n);continue}if(n=this.tokenizer.code(e)){e=e.substring(n.raw.length),i=t[t.length-1],!i||"paragraph"!==i.type&&"text"!==i.type?t.push(n):(i.raw+="\n"+n.raw,i.text+="\n"+n.text,this.inlineQueue[this.inlineQueue.length-1].src=i.text);continue}if(n=this.tokenizer.fences(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.heading(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.hr(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.blockquote(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.list(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.html(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.def(e)){e=e.substring(n.raw.length),i=t[t.length-1],!i||"paragraph"!==i.type&&"text"!==i.type?this.tokens.links[n.tag]||(this.tokens.links[n.tag]={href:n.href,title:n.title}):(i.raw+="\n"+n.raw,i.text+="\n"+n.raw,this.inlineQueue[this.inlineQueue.length-1].src=i.text);continue}if(n=this.tokenizer.table(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.lheading(e)){e=e.substring(n.raw.length),t.push(n);continue}if(a=e,this.options.extensions&&this.options.extensions.startBlock){let u=1/0;const d=e.slice(1);let p;this.options.extensions.startBlock.forEach(function(v){p=v.call({lexer:this},d),"number"==typeof p&&p>=0&&(u=Math.min(u,p))}),u<1/0&&u>=0&&(a=e.substring(0,u+1))}if(this.state.top&&(n=this.tokenizer.paragraph(a))){i=t[t.length-1],c&&"paragraph"===i.type?(i.raw+="\n"+n.raw,i.text+="\n"+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(n),c=a.length!==e.length,e=e.substring(n.raw.length);continue}if(n=this.tokenizer.text(e)){e=e.substring(n.raw.length),i=t[t.length-1],i&&"text"===i.type?(i.raw+="\n"+n.raw,i.text+="\n"+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(n);continue}if(e){const u="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(u);break}throw new Error(u)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let n,i,a,u,d,p,c=e;if(this.tokens.links){const v=Object.keys(this.tokens.links);if(v.length>0)for(;null!=(u=this.tokenizer.rules.inline.reflinkSearch.exec(c));)v.includes(u[0].slice(u[0].lastIndexOf("[")+1,-1))&&(c=c.slice(0,u.index)+"["+Dt("a",u[0].length-2)+"]"+c.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(u=this.tokenizer.rules.inline.blockSkip.exec(c));)c=c.slice(0,u.index)+"["+Dt("a",u[0].length-2)+"]"+c.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(u=this.tokenizer.rules.inline.escapedEmSt.exec(c));)c=c.slice(0,u.index+u[0].length-2)+"++"+c.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex),this.tokenizer.rules.inline.escapedEmSt.lastIndex--;for(;e;)if(d||(p=""),d=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(v=>!!(n=v.call({lexer:this},e,t))&&(e=e.substring(n.raw.length),t.push(n),!0)))){if(n=this.tokenizer.escape(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.tag(e)){e=e.substring(n.raw.length),i=t[t.length-1],i&&"text"===n.type&&"text"===i.type?(i.raw+=n.raw,i.text+=n.text):t.push(n);continue}if(n=this.tokenizer.link(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(n.raw.length),i=t[t.length-1],i&&"text"===n.type&&"text"===i.type?(i.raw+=n.raw,i.text+=n.text):t.push(n);continue}if(n=this.tokenizer.emStrong(e,c,p)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.codespan(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.br(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.del(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.autolink(e,Ae)){e=e.substring(n.raw.length),t.push(n);continue}if(!this.state.inLink&&(n=this.tokenizer.url(e,Ae))){e=e.substring(n.raw.length),t.push(n);continue}if(a=e,this.options.extensions&&this.options.extensions.startInline){let v=1/0;const _=e.slice(1);let M;this.options.extensions.startInline.forEach(function(b){M=b.call({lexer:this},_),"number"==typeof M&&M>=0&&(v=Math.min(v,M))}),v<1/0&&v>=0&&(a=e.substring(0,v+1))}if(n=this.tokenizer.inlineText(a,Ee)){e=e.substring(n.raw.length),"_"!==n.raw.slice(-1)&&(p=n.raw.slice(-1)),d=!0,i=t[t.length-1],i&&"text"===i.type?(i.raw+=n.raw,i.text+=n.text):t.push(n);continue}if(e){const v="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(v);break}throw new Error(v)}}return t}}class Ue{constructor(e){this.options=e||et}code(e,t,n){const i=(t||"").match(/\S*/)[0];if(this.options.highlight){const a=this.options.highlight(e,i);null!=a&&a!==e&&(n=!0,e=a)}return e=e.replace(/\n$/,"")+"\n",i?'<pre><code class="'+this.options.langPrefix+gt(i)+'">'+(n?e:gt(e,!0))+"</code></pre>\n":"<pre><code>"+(n?e:gt(e,!0))+"</code></pre>\n"}blockquote(e){return`<blockquote>\n${e}</blockquote>\n`}html(e){return e}heading(e,t,n,i){return this.options.headerIds?`<h${t} id="${this.options.headerPrefix+i.slug(n)}">${e}</h${t}>\n`:`<h${t}>${e}</h${t}>\n`}hr(){return this.options.xhtml?"<hr/>\n":"<hr>\n"}list(e,t,n){const i=t?"ol":"ul";return"<"+i+(t&&1!==n?' start="'+n+'"':"")+">\n"+e+"</"+i+">\n"}listitem(e){return`<li>${e}</li>\n`}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(e){return`<p>${e}</p>\n`}table(e,t){return t&&(t=`<tbody>${t}</tbody>`),"<table>\n<thead>\n"+e+"</thead>\n"+t+"</table>\n"}tablerow(e){return`<tr>\n${e}</tr>\n`}tablecell(e,t){const n=t.header?"th":"td";return(t.align?`<${n} align="${t.align}">`:`<${n}>`)+e+`</${n}>\n`}strong(e){return`<strong>${e}</strong>`}em(e){return`<em>${e}</em>`}codespan(e){return`<code>${e}</code>`}br(){return this.options.xhtml?"<br/>":"<br>"}del(e){return`<del>${e}</del>`}link(e,t,n){if(null===(e=Fn(this.options.sanitize,this.options.baseUrl,e)))return n;let i='<a href="'+e+'"';return t&&(i+=' title="'+t+'"'),i+=">"+n+"</a>",i}image(e,t,n){if(null===(e=Fn(this.options.sanitize,this.options.baseUrl,e)))return n;let i=`<img src="${e}" alt="${n}"`;return t&&(i+=` title="${t}"`),i+=this.options.xhtml?"/>":">",i}text(e){return e}}class Mt{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,t,n){return""+n}image(e,t,n){return""+n}br(){return""}}class ot{constructor(){this.seen={}}serialize(e){return e.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(e,t){let n=e,i=0;if(this.seen.hasOwnProperty(n)){i=this.seen[e];do{i++,n=e+"-"+i}while(this.seen.hasOwnProperty(n))}return t||(this.seen[e]=i,this.seen[n]=0),n}slug(e,t={}){const n=this.serialize(e);return this.getNextSafeSlug(n,t.dryrun)}}class Kt{constructor(e){this.options=e||et,this.options.renderer=this.options.renderer||new Ue,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new Mt,this.slugger=new ot}static parse(e,t){return new Kt(t).parse(e)}static parseInline(e,t){return new Kt(t).parseInline(e)}parse(e,t=!0){let i,a,c,u,d,p,v,_,M,b,A,P,R,T,U,F,V,X,Z,n="";const q=e.length;for(i=0;i<q;i++)if(b=e[i],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[b.type]&&(Z=this.options.extensions.renderers[b.type].call({parser:this},b),!1!==Z||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(b.type)))n+=Z||"";else switch(b.type){case"space":continue;case"hr":n+=this.renderer.hr();continue;case"heading":n+=this.renderer.heading(this.parseInline(b.tokens),b.depth,st(this.parseInline(b.tokens,this.textRenderer)),this.slugger);continue;case"code":n+=this.renderer.code(b.text,b.lang,b.escaped);continue;case"table":for(_="",v="",u=b.header.length,a=0;a<u;a++)v+=this.renderer.tablecell(this.parseInline(b.header[a].tokens),{header:!0,align:b.align[a]});for(_+=this.renderer.tablerow(v),M="",u=b.rows.length,a=0;a<u;a++){for(p=b.rows[a],v="",d=p.length,c=0;c<d;c++)v+=this.renderer.tablecell(this.parseInline(p[c].tokens),{header:!1,align:b.align[c]});M+=this.renderer.tablerow(v)}n+=this.renderer.table(_,M);continue;case"blockquote":M=this.parse(b.tokens),n+=this.renderer.blockquote(M);continue;case"list":for(A=b.ordered,P=b.start,R=b.loose,u=b.items.length,M="",a=0;a<u;a++)U=b.items[a],F=U.checked,V=U.task,T="",U.task&&(X=this.renderer.checkbox(F),R?U.tokens.length>0&&"paragraph"===U.tokens[0].type?(U.tokens[0].text=X+" "+U.tokens[0].text,U.tokens[0].tokens&&U.tokens[0].tokens.length>0&&"text"===U.tokens[0].tokens[0].type&&(U.tokens[0].tokens[0].text=X+" "+U.tokens[0].tokens[0].text)):U.tokens.unshift({type:"text",text:X}):T+=X),T+=this.parse(U.tokens,R),M+=this.renderer.listitem(T,V,F);n+=this.renderer.list(M,A,P);continue;case"html":n+=this.renderer.html(b.text);continue;case"paragraph":n+=this.renderer.paragraph(this.parseInline(b.tokens));continue;case"text":for(M=b.tokens?this.parseInline(b.tokens):b.text;i+1<q&&"text"===e[i+1].type;)b=e[++i],M+="\n"+(b.tokens?this.parseInline(b.tokens):b.text);n+=t?this.renderer.paragraph(M):M;continue;default:{const ee='Token with "'+b.type+'" type was not found.';if(this.options.silent)return void console.error(ee);throw new Error(ee)}}return n}parseInline(e,t){t=t||this.renderer;let i,a,c,n="";const u=e.length;for(i=0;i<u;i++)if(a=e[i],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[a.type]&&(c=this.options.extensions.renderers[a.type].call({parser:this},a),!1!==c||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(a.type)))n+=c||"";else switch(a.type){case"escape":case"text":n+=t.text(a.text);break;case"html":n+=t.html(a.text);break;case"link":n+=t.link(a.href,a.title,this.parseInline(a.tokens,t));break;case"image":n+=t.image(a.href,a.title,a.text);break;case"strong":n+=t.strong(this.parseInline(a.tokens,t));break;case"em":n+=t.em(this.parseInline(a.tokens,t));break;case"codespan":n+=t.codespan(a.text);break;case"br":n+=t.br();break;case"del":n+=t.del(this.parseInline(a.tokens,t));break;default:{const d='Token with "'+a.type+'" type was not found.';if(this.options.silent)return void console.error(d);throw new Error(d)}}return n}}class Dn{constructor(e){this.options=e||et}preprocess(e){return e}postprocess(e){return e}}function lt(o,e){return(t,n,i)=>{"function"==typeof n&&(i=n,n=null);const a=la({},n),c=function un(o,e,t){return n=>{if(n.message+="\nPlease report this to https://github.com/markedjs/marked.",o){const i="<p>An error occurred:</p><pre>"+gt(n.message+"",!0)+"</pre>";return e?Promise.resolve(i):t?void t(null,i):i}if(e)return Promise.reject(n);if(!t)throw n;t(n)}}((n=la(la({},Nt.defaults),a)).silent,n.async,i);if(null==t)return c(new Error("marked(): input parameter is undefined or null"));if("string"!=typeof t)return c(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));if(function $n(o){o&&o.sanitize&&!o.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}(n),n.hooks&&(n.hooks.options=n),i){const u=n.highlight;let d;try{n.hooks&&(t=n.hooks.preprocess(t)),d=o(t,n)}catch(_){return c(_)}const p=function(_){let M;if(!_)try{n.walkTokens&&Nt.walkTokens(d,n.walkTokens),M=e(d,n),n.hooks&&(M=n.hooks.postprocess(M))}catch(b){_=b}return n.highlight=u,_?c(_):i(null,M)};if(!u||u.length<3||(delete n.highlight,!d.length))return p();let v=0;return Nt.walkTokens(d,function(_){"code"===_.type&&(v++,setTimeout(()=>{u(_.text,_.lang,function(M,b){if(M)return p(M);null!=b&&b!==_.text&&(_.text=b,_.escaped=!0),v--,0===v&&p()})},0))}),void(0===v&&p())}if(n.async)return Promise.resolve(n.hooks?n.hooks.preprocess(t):t).then(u=>o(u,n)).then(u=>n.walkTokens?Promise.all(Nt.walkTokens(u,n.walkTokens)).then(()=>u):u).then(u=>e(u,n)).then(u=>n.hooks?n.hooks.postprocess(u):u).catch(c);try{n.hooks&&(t=n.hooks.preprocess(t));const u=o(t,n);n.walkTokens&&Nt.walkTokens(u,n.walkTokens);let d=e(u,n);return n.hooks&&(d=n.hooks.postprocess(d)),d}catch(u){return c(u)}}}function Nt(o,e,t){return lt(ke.lex,Kt.parse)(o,e,t)}SA(Dn,"passThroughHooks",new Set(["preprocess","postprocess"])),Nt.options=Nt.setOptions=function(o){return function Ge(o){et=o}(Nt.defaults=la(la({},Nt.defaults),o)),Nt},Nt.getDefaults=function Te(){return{async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,hooks:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}},Nt.defaults=et,Nt.use=function(...o){const e=Nt.defaults.extensions||{renderers:{},childTokens:{}};o.forEach(t=>{const n=la({},t);if(n.async=Nt.defaults.async||n.async||!1,t.extensions&&(t.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if(i.renderer){const a=e.renderers[i.name];e.renderers[i.name]=a?function(...c){let u=i.renderer.apply(this,c);return!1===u&&(u=a.apply(this,c)),u}:i.renderer}if(i.tokenizer){if(!i.level||"block"!==i.level&&"inline"!==i.level)throw new Error("extension level must be 'block' or 'inline'");e[i.level]?e[i.level].unshift(i.tokenizer):e[i.level]=[i.tokenizer],i.start&&("block"===i.level?e.startBlock?e.startBlock.push(i.start):e.startBlock=[i.start]:"inline"===i.level&&(e.startInline?e.startInline.push(i.start):e.startInline=[i.start]))}i.childTokens&&(e.childTokens[i.name]=i.childTokens)}),n.extensions=e),t.renderer){const i=Nt.defaults.renderer||new Ue;for(const a in t.renderer){const c=i[a];i[a]=(...u)=>{let d=t.renderer[a].apply(i,u);return!1===d&&(d=c.apply(i,u)),d}}n.renderer=i}if(t.tokenizer){const i=Nt.defaults.tokenizer||new Sr;for(const a in t.tokenizer){const c=i[a];i[a]=(...u)=>{let d=t.tokenizer[a].apply(i,u);return!1===d&&(d=c.apply(i,u)),d}}n.tokenizer=i}if(t.hooks){const i=Nt.defaults.hooks||new Dn;for(const a in t.hooks){const c=i[a];i[a]=Dn.passThroughHooks.has(a)?u=>{if(Nt.defaults.async)return Promise.resolve(t.hooks[a].call(i,u)).then(p=>c.call(i,p));const d=t.hooks[a].call(i,u);return c.call(i,d)}:(...u)=>{let d=t.hooks[a].apply(i,u);return!1===d&&(d=c.apply(i,u)),d}}n.hooks=i}if(t.walkTokens){const i=Nt.defaults.walkTokens;n.walkTokens=function(a){let c=[];return c.push(t.walkTokens.call(this,a)),i&&(c=c.concat(i.call(this,a))),c}}Nt.setOptions(n)})},Nt.walkTokens=function(o,e){let t=[];for(const n of o)switch(t=t.concat(e.call(Nt,n)),n.type){case"table":for(const i of n.header)t=t.concat(Nt.walkTokens(i.tokens,e));for(const i of n.rows)for(const a of i)t=t.concat(Nt.walkTokens(a.tokens,e));break;case"list":t=t.concat(Nt.walkTokens(n.items,e));break;default:Nt.defaults.extensions&&Nt.defaults.extensions.childTokens&&Nt.defaults.extensions.childTokens[n.type]?Nt.defaults.extensions.childTokens[n.type].forEach(function(i){t=t.concat(Nt.walkTokens(n[i],e))}):n.tokens&&(t=t.concat(Nt.walkTokens(n.tokens,e)))}return t},Nt.parseInline=lt(ke.lexInline,Kt.parseInline),Nt.Parser=Kt,Nt.parser=Kt.parse,Nt.Renderer=Ue,Nt.TextRenderer=Mt,Nt.Lexer=ke,Nt.lexer=ke.lex,Nt.Tokenizer=Sr,Nt.Slugger=ot,Nt.Hooks=Dn,Nt.parse=Nt;var Zi=ie(4004),Fo=(ie(590),ie(9646)),No=ie(8306),Va=ie(4351),Jl=ie(9300);class hn{}class Fr{}class oi{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(t=>{const n=t.indexOf(":");if(n>0){const i=t.slice(0,n),a=i.toLowerCase(),c=t.slice(n+1).trim();this.maybeSetNormalizedName(i,a),this.headers.has(a)?this.headers.get(a).push(c):this.headers.set(a,[c])}})}:()=>{this.headers=new Map,Object.keys(e).forEach(t=>{let n=e[t];const i=t.toLowerCase();"string"==typeof n&&(n=[n]),n.length>0&&(this.headers.set(i,n),this.maybeSetNormalizedName(t,i))})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof oi?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new oi;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof oi?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);const i=("a"===e.op?this.headers.get(t):void 0)||[];i.push(...n),this.headers.set(t,i);break;case"d":const a=e.value;if(a){let c=this.headers.get(t);if(!c)return;c=c.filter(u=>-1===a.indexOf(u)),0===c.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,c)}else this.headers.delete(t),this.normalizedNames.delete(t)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class tn{encodeKey(e){return ki(e)}encodeValue(e){return ki(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const za=/%(\d[a-f0-9])/gi,er={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function ki(o){return encodeURIComponent(o).replace(za,(e,t)=>{var n;return null!==(n=er[t])&&void 0!==n?n:e})}function lr(o){return`${o}`}class Wi{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new tn,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function _t(o,e){const t=new Map;return o.length>0&&o.replace(/^\?/,"").split("&").forEach(i=>{const a=i.indexOf("="),[c,u]=-1==a?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,a)),e.decodeValue(i.slice(a+1))],d=t.get(c)||[];d.push(u),t.set(c,d)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const n=e.fromObject[t];this.map.set(t,Array.isArray(n)?n:[n])})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(n=>{const i=e[n];Array.isArray(i)?i.forEach(a=>{t.push({param:n,value:a,op:"a"})}):t.push({param:n,value:i,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(n=>t+"="+this.encoder.encodeValue(n)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new Wi({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(lr(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let n=this.map.get(e.param)||[];const i=n.indexOf(lr(e.value));-1!==i&&n.splice(i,1),n.length>0?this.map.set(e.param,n):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class An{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function ai(o){return"undefined"!=typeof ArrayBuffer&&o instanceof ArrayBuffer}function vl(o){return"undefined"!=typeof Blob&&o instanceof Blob}function fi(o){return"undefined"!=typeof FormData&&o instanceof FormData}class Li{constructor(e,t,n,i){let a;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function is(o){switch(o){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==n?n:null,a=i):a=n,a&&(this.reportProgress=!!a.reportProgress,this.withCredentials=!!a.withCredentials,a.responseType&&(this.responseType=a.responseType),a.headers&&(this.headers=a.headers),a.context&&(this.context=a.context),a.params&&(this.params=a.params)),this.headers||(this.headers=new oi),this.context||(this.context=new An),this.params){const c=this.params.toString();if(0===c.length)this.urlWithParams=t;else{const u=t.indexOf("?");this.urlWithParams=t+(-1===u?"?":u<t.length-1?"&":"")+c}}else this.params=new Wi,this.urlWithParams=t}serializeBody(){return null===this.body?null:ai(this.body)||vl(this.body)||fi(this.body)||function Gu(o){return"undefined"!=typeof URLSearchParams&&o instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Wi?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||fi(this.body)?null:vl(this.body)?this.body.type||null:ai(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Wi?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){var t;const n=e.method||this.method,i=e.url||this.url,a=e.responseType||this.responseType,c=void 0!==e.body?e.body:this.body,u=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,d=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let p=e.headers||this.headers,v=e.params||this.params;const _=null!==(t=e.context)&&void 0!==t?t:this.context;return void 0!==e.setHeaders&&(p=Object.keys(e.setHeaders).reduce((M,b)=>M.set(b,e.setHeaders[b]),p)),e.setParams&&(v=Object.keys(e.setParams).reduce((M,b)=>M.set(b,e.setParams[b]),v)),new Li(n,i,c,{params:v,headers:p,context:_,reportProgress:d,responseType:a,withCredentials:u})}}var qn=(()=>((qn=qn||{})[qn.Sent=0]="Sent",qn[qn.UploadProgress=1]="UploadProgress",qn[qn.ResponseHeader=2]="ResponseHeader",qn[qn.DownloadProgress=3]="DownloadProgress",qn[qn.Response=4]="Response",qn[qn.User=5]="User",qn))();class ti{constructor(e,t=200,n="OK"){this.headers=e.headers||new oi,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||n,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class Gs extends ti{constructor(e={}){super(e),this.type=qn.ResponseHeader}clone(e={}){return new Gs({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class ps extends ti{constructor(e={}){super(e),this.type=qn.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new ps({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class Ps extends ti{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function Ks(o,e){return{body:e,headers:o.headers,context:o.context,observe:o.observe,params:o.params,reportProgress:o.reportProgress,responseType:o.responseType,withCredentials:o.withCredentials}}let vr=(()=>{class o{constructor(t){this.handler=t}request(t,n,i={}){let a;if(t instanceof Li)a=t;else{let d,p;d=i.headers instanceof oi?i.headers:new oi(i.headers),i.params&&(p=i.params instanceof Wi?i.params:new Wi({fromObject:i.params})),a=new Li(t,n,void 0!==i.body?i.body:null,{headers:d,context:i.context,params:p,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials})}const c=(0,Fo.of)(a).pipe((0,Va.b)(d=>this.handler.handle(d)));if(t instanceof Li||"events"===i.observe)return c;const u=c.pipe((0,Jl.h)(d=>d instanceof ps));switch(i.observe||"body"){case"body":switch(a.responseType){case"arraybuffer":return u.pipe((0,Zi.U)(d=>{if(null!==d.body&&!(d.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return d.body}));case"blob":return u.pipe((0,Zi.U)(d=>{if(null!==d.body&&!(d.body instanceof Blob))throw new Error("Response is not a Blob.");return d.body}));case"text":return u.pipe((0,Zi.U)(d=>{if(null!==d.body&&"string"!=typeof d.body)throw new Error("Response is not a string.");return d.body}));default:return u.pipe((0,Zi.U)(d=>d.body))}case"response":return u;default:throw new Error(`Unreachable: unhandled observe type ${i.observe}}`)}}delete(t,n={}){return this.request("DELETE",t,n)}get(t,n={}){return this.request("GET",t,n)}head(t,n={}){return this.request("HEAD",t,n)}jsonp(t,n){return this.request("JSONP",t,{params:(new Wi).append(n,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,n={}){return this.request("OPTIONS",t,n)}patch(t,n,i={}){return this.request("PATCH",t,Ks(i,n))}post(t,n,i={}){return this.request("POST",t,Ks(i,n))}put(t,n,i={}){return this.request("PUT",t,Ks(i,n))}}return o.\u0275fac=function(t){return new(t||o)(I.LFG(hn))},o.\u0275prov=I.Yz7({token:o,factory:o.\u0275fac}),o})();class po{constructor(e,t){this.next=e,this.interceptor=t}handle(e){return this.interceptor.intercept(e,this.next)}}const be=new I.OlP("HTTP_INTERCEPTORS");let de=(()=>{class o{intercept(t,n){return n.handle(t)}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275prov=I.Yz7({token:o,factory:o.\u0275fac}),o})();const kr=/^\)\]\}',?\n/;let jr=(()=>{class o{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new No.y(n=>{const i=this.xhrFactory.build();if(i.open(t.method,t.urlWithParams),t.withCredentials&&(i.withCredentials=!0),t.headers.forEach((b,A)=>i.setRequestHeader(b,A.join(","))),t.headers.has("Accept")||i.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const b=t.detectContentTypeHeader();null!==b&&i.setRequestHeader("Content-Type",b)}if(t.responseType){const b=t.responseType.toLowerCase();i.responseType="json"!==b?b:"text"}const a=t.serializeBody();let c=null;const u=()=>{if(null!==c)return c;const b=i.statusText||"OK",A=new oi(i.getAllResponseHeaders()),P=function tr(o){return"responseURL"in o&&o.responseURL?o.responseURL:/^X-Request-URL:/m.test(o.getAllResponseHeaders())?o.getResponseHeader("X-Request-URL"):null}(i)||t.url;return c=new Gs({headers:A,status:i.status,statusText:b,url:P}),c},d=()=>{let{headers:b,status:A,statusText:P,url:R}=u(),T=null;204!==A&&(T=void 0===i.response?i.responseText:i.response),0===A&&(A=T?200:0);let U=A>=200&&A<300;if("json"===t.responseType&&"string"==typeof T){const F=T;T=T.replace(kr,"");try{T=""!==T?JSON.parse(T):null}catch(V){T=F,U&&(U=!1,T={error:V,text:T})}}U?(n.next(new ps({body:T,headers:b,status:A,statusText:P,url:R||void 0})),n.complete()):n.error(new Ps({error:T,headers:b,status:A,statusText:P,url:R||void 0}))},p=b=>{const{url:A}=u(),P=new Ps({error:b,status:i.status||0,statusText:i.statusText||"Unknown Error",url:A||void 0});n.error(P)};let v=!1;const _=b=>{v||(n.next(u()),v=!0);let A={type:qn.DownloadProgress,loaded:b.loaded};b.lengthComputable&&(A.total=b.total),"text"===t.responseType&&!!i.responseText&&(A.partialText=i.responseText),n.next(A)},M=b=>{let A={type:qn.UploadProgress,loaded:b.loaded};b.lengthComputable&&(A.total=b.total),n.next(A)};return i.addEventListener("load",d),i.addEventListener("error",p),i.addEventListener("timeout",p),i.addEventListener("abort",p),t.reportProgress&&(i.addEventListener("progress",_),null!==a&&i.upload&&i.upload.addEventListener("progress",M)),i.send(a),n.next({type:qn.Sent}),()=>{i.removeEventListener("error",p),i.removeEventListener("abort",p),i.removeEventListener("load",d),i.removeEventListener("timeout",p),t.reportProgress&&(i.removeEventListener("progress",_),null!==a&&i.upload&&i.upload.removeEventListener("progress",M)),i.readyState!==i.DONE&&i.abort()}})}}return o.\u0275fac=function(t){return new(t||o)(I.LFG(G.JF))},o.\u0275prov=I.Yz7({token:o,factory:o.\u0275fac}),o})();const Ar=new I.OlP("XSRF_COOKIE_NAME"),Tr=new I.OlP("XSRF_HEADER_NAME");class Js{}let ca=(()=>{class o{constructor(t,n,i){this.doc=t,this.platform=n,this.cookieName=i,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=(0,G.Mx)(t,this.cookieName),this.lastCookieString=t),this.lastToken}}return o.\u0275fac=function(t){return new(t||o)(I.LFG(G.K0),I.LFG(I.Lbi),I.LFG(Ar))},o.\u0275prov=I.Yz7({token:o,factory:o.\u0275fac}),o})(),nr=(()=>{class o{constructor(t,n){this.tokenService=t,this.headerName=n}intercept(t,n){const i=t.url.toLowerCase();if("GET"===t.method||"HEAD"===t.method||i.startsWith("http://")||i.startsWith("https://"))return n.handle(t);const a=this.tokenService.getToken();return null!==a&&!t.headers.has(this.headerName)&&(t=t.clone({headers:t.headers.set(this.headerName,a)})),n.handle(t)}}return o.\u0275fac=function(t){return new(t||o)(I.LFG(Js),I.LFG(Tr))},o.\u0275prov=I.Yz7({token:o,factory:o.\u0275fac}),o})(),Qs=(()=>{class o{constructor(t,n){this.backend=t,this.injector=n,this.chain=null}handle(t){if(null===this.chain){const n=this.injector.get(be,[]);this.chain=n.reduceRight((i,a)=>new po(i,a),this.backend)}return this.chain.handle(t)}}return o.\u0275fac=function(t){return new(t||o)(I.LFG(Fr),I.LFG(I.zs3))},o.\u0275prov=I.Yz7({token:o,factory:o.\u0275fac}),o})(),yl=(()=>{class o{static disable(){return{ngModule:o,providers:[{provide:nr,useClass:de}]}}static withOptions(t={}){return{ngModule:o,providers:[t.cookieName?{provide:Ar,useValue:t.cookieName}:[],t.headerName?{provide:Tr,useValue:t.headerName}:[]]}}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=I.oAB({type:o}),o.\u0275inj=I.cJS({providers:[nr,{provide:be,useExisting:nr,multi:!0},{provide:Js,useClass:ca},{provide:Ar,useValue:"XSRF-TOKEN"},{provide:Tr,useValue:"X-XSRF-TOKEN"}]}),o})(),$r=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=I.oAB({type:o}),o.\u0275inj=I.cJS({providers:[vr,{provide:hn,useClass:Qs},jr,{provide:Fr,useExisting:jr}],imports:[[yl.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),o})();var Di=ie(2313);const Ur=["*"];let Vi=(()=>{class o{transform(t,n){return null==t&&(t=""),null==n&&(n=""),"string"!=typeof t?(console.error(`LanguagePipe has been invoked with an invalid value type [${typeof t}]`),t):"string"!=typeof n?(console.error(`LanguagePipe has been invoked with an invalid parameter [${typeof n}]`),t):"```"+n+"\n"+t+"\n```"}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275pipe=I.Yjl({name:"language",type:o,pure:!0}),o})();var rs=(()=>{return(o=rs||(rs={})).CommandLine="command-line",o.LineHighlight="line-highlight",o.LineNumbers="line-numbers",rs;var o})();class Ri{}const vs=new I.OlP("SECURITY_CONTEXT");let ss=(()=>{class o{constructor(t,n,i,a,c){this.platform=t,this.securityContext=n,this.http=i,this.sanitizer=c,this.initialMarkedOptions={renderer:new Ue},this.options=a}get options(){return this._options}set options(t){this._options=Object.assign(Object.assign({},this.initialMarkedOptions),t)}get renderer(){return this.options.renderer}set renderer(t){this.options.renderer=t}compile(t,n=!1,i=!1,a=this.options){const c=this.trimIndentation(t),u=n?this.decodeHtml(c):c,p=Nt(i?this.renderEmoji(u):u,a);return this.sanitizer.sanitize(this.securityContext,p)||""}getSource(t){if(!this.http)throw new Error("[ngx-markdown] When using the `src` attribute you *have to* pass the `HttpClient` as a parameter of the `forRoot` method. See README for more information");return this.http.get(t,{responseType:"text"}).pipe((0,Zi.U)(n=>this.handleExtension(t,n)))}highlight(t){if((0,G.NF)(this.platform)&&"undefined"!=typeof Prism){t||(t=document);const n=t.querySelectorAll('pre code:not([class*="language-"])');Array.prototype.forEach.call(n,i=>i.classList.add("language-none")),Prism.highlightAllUnder(t)}}renderKatex(t,n){if(!(0,G.NF)(this.platform))return t;if("undefined"==typeof katex||void 0===katex.renderToString)throw new Error("[ngx-markdown] When using the `katex` attribute you *have to* include KaTeX files to `angular.json` or use imports. See README for more information");return t.replace(/\$([^\s][^$]*?[^\s])\$/gm,(i,a)=>katex.renderToString(a,n))}decodeHtml(t){if(!(0,G.NF)(this.platform))return t;const n=document.createElement("textarea");return n.innerHTML=t,n.value}handleExtension(t,n){const i=t?t.split("?")[0].split(".").splice(-1).join():"";return"md"!==i?"```"+i+"\n"+n+"\n```":n}renderEmoji(t){if(!(0,G.NF)(this.platform))return t;if("undefined"==typeof joypixels||void 0===joypixels.shortnameToUnicode)throw new Error("[ngx-markdown] When using the `emoji` attribute you *have to* include Emoji-Toolkit files to `angular.json` or use imports. See README for more information");return joypixels.shortnameToUnicode(t)}trimIndentation(t){if(!t)return"";let n;return t.split("\n").map(i=>{let a=n;return i.length>0&&(a=isNaN(a)?i.search(/\S|$/):Math.min(i.search(/\S|$/),a)),isNaN(n)&&(n=a),a?i.substring(a):i}).join("\n")}}return o.\u0275fac=function(t){return new(t||o)(I.LFG(I.Lbi),I.LFG(vs),I.LFG(vr,8),I.LFG(Ri,8),I.LFG(Di.H7))},o.\u0275prov=I.Yz7({token:o,factory:o.\u0275fac}),o})(),to=(()=>{class o{constructor(t,n){this.element=t,this.markdownService=n,this.error=new I.vpe,this.load=new I.vpe,this.ready=new I.vpe,this._commandLine=!1,this._emoji=!1,this._katex=!1,this._lineHighlight=!1,this._lineNumbers=!1}get emoji(){return this._emoji}set emoji(t){this._emoji=this.coerceBooleanProperty(t)}get katex(){return this._katex}set katex(t){this._katex=this.coerceBooleanProperty(t)}get lineHighlight(){return this._lineHighlight}set lineHighlight(t){this._lineHighlight=this.coerceBooleanProperty(t)}get lineNumbers(){return this._lineNumbers}set lineNumbers(t){this._lineNumbers=this.coerceBooleanProperty(t)}get commandLine(){return this._commandLine}set commandLine(t){this._commandLine=this.coerceBooleanProperty(t)}ngOnChanges(){null==this.data?null==this.src||this.handleSrc():this.handleData()}ngAfterViewInit(){!this.data&&!this.src&&this.handleTransclusion()}render(t,n=!1){let i=this.markdownService.compile(t,n,this.emoji);i=this.katex?this.markdownService.renderKatex(i,this.katexOptions):i,this.element.nativeElement.innerHTML=i,this.handlePlugins(),this.markdownService.highlight(this.element.nativeElement),this.ready.emit()}coerceBooleanProperty(t){return null!=t&&"false"!=`${String(t)}`}handleData(){this.render(this.data)}handleSrc(){this.markdownService.getSource(this.src).subscribe(t=>{this.render(t),this.load.emit(t)},t=>this.error.emit(t))}handleTransclusion(){this.render(this.element.nativeElement.innerHTML,!0)}handlePlugins(){this.commandLine&&(this.setPluginClass(this.element.nativeElement,rs.CommandLine),this.setPluginOptions(this.element.nativeElement,{dataFilterOutput:this.filterOutput,dataHost:this.host,dataPrompt:this.prompt,dataOutput:this.output,dataUser:this.user})),this.lineHighlight&&this.setPluginOptions(this.element.nativeElement,{dataLine:this.line,dataLineOffset:this.lineOffset}),this.lineNumbers&&(this.setPluginClass(this.element.nativeElement,rs.LineNumbers),this.setPluginOptions(this.element.nativeElement,{dataStart:this.start}))}setPluginClass(t,n){const i=t.querySelectorAll("pre");for(let a=0;a<i.length;a++){const c=n instanceof Array?n:[n];i.item(a).classList.add(...c)}}setPluginOptions(t,n){const i=t.querySelectorAll("pre");for(let a=0;a<i.length;a++)Object.keys(n).forEach(c=>{const u=n[c];if(u){const d=this.toLispCase(c);i.item(a).setAttribute(d,u.toString())}})}toLispCase(t){const n=t.match(/([A-Z])/g);if(!n)return t;let i=t.toString();for(let a=0,c=n.length;a<c;a++)i=i.replace(new RegExp(n[a]),"-"+n[a].toLowerCase());return"-"===i.slice(0,1)&&(i=i.slice(1)),i}}return o.\u0275fac=function(t){return new(t||o)(I.Y36(I.SBq),I.Y36(ss))},o.\u0275cmp=I.Xpm({type:o,selectors:[["markdown"],["","markdown",""]],inputs:{data:"data",src:"src",emoji:"emoji",katex:"katex",katexOptions:"katexOptions",lineHighlight:"lineHighlight",line:"line",lineOffset:"lineOffset",lineNumbers:"lineNumbers",start:"start",commandLine:"commandLine",filterOutput:"filterOutput",host:"host",prompt:"prompt",output:"output",user:"user"},outputs:{error:"error",load:"load",ready:"ready"},features:[I.TTD],ngContentSelectors:Ur,decls:1,vars:0,template:function(t,n){1&t&&(I.F$t(),I.Hsn(0))},encapsulation:2}),o})(),io=(()=>{class o{static forRoot(t){return{ngModule:o,providers:[ss,t&&t.loader||[],t&&t.markedOptions||[],{provide:vs,useValue:t&&null!=t.sanitize?t.sanitize:I.q3G.HTML}]}}static forChild(){return{ngModule:o}}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=I.oAB({type:o}),o.\u0275inj=I.cJS({}),o})();var ro=ie(6324);let cr=(()=>{class o{constructor(){}ngOnInit(){}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=I.Xpm({type:o,selectors:[["app-shader"]],decls:1,vars:0,template:function(t,n){1&t&&I._UZ(0,"router-outlet")},directives:[ro.lC],styles:[""]}),o})();function pi(o,e,t,n,i,a,c){try{var u=o[a](c),d=u.value}catch(p){return void t(p)}u.done?e(d):Promise.resolve(d).then(n,i)}const $i=1e3,ri=1001,Fi=1003,Ii=1006,Ms=1008,Vo=1009,Ze=1014,Tn=1015,_o=1016,js=1020,qr=1023,Go=1026,Xa=1027,Za=2300,Yr=2301,xa=3001,vn="srgb",ls="srgb-linear",mc="display-p3",E=7680,qs=2e3;class Rl{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const i=this._listeners[e];if(void 0!==i){const a=i.indexOf(t);-1!==a&&i.splice(a,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const n=this._listeners[e.type];if(void 0!==n){e.target=this;const i=n.slice(0);for(let a=0,c=i.length;a<c;a++)i[a].call(this,e);e.target=null}}}const cs=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];const $o=Math.PI/180,Qu=180/Math.PI;function Hr(){const o=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(cs[255&o]+cs[o>>8&255]+cs[o>>16&255]+cs[o>>24&255]+"-"+cs[255&e]+cs[e>>8&255]+"-"+cs[e>>16&15|64]+cs[e>>24&255]+"-"+cs[63&t|128]+cs[t>>8&255]+"-"+cs[t>>16&255]+cs[t>>24&255]+cs[255&n]+cs[n>>8&255]+cs[n>>16&255]+cs[n>>24&255]).toLowerCase()}function Ki(o,e,t){return Math.max(e,Math.min(t,o))}function dr(o,e){return(o%e+e)%e}function Of(o,e,t){return(1-t)*o+t*e}function ay(o){return 0==(o&o-1)&&0!==o}function Om(o){return Math.pow(2,Math.ceil(Math.log(o)/Math.LN2))}function ks(o){return Math.pow(2,Math.floor(Math.log(o)/Math.LN2))}function Kr(o,e){switch(e.constructor){case Float32Array:return o;case Uint32Array:return o/4294967295;case Uint16Array:return o/65535;case Uint8Array:return o/255;case Int32Array:return Math.max(o/2147483647,-1);case Int16Array:return Math.max(o/32767,-1);case Int8Array:return Math.max(o/127,-1);default:throw new Error("Invalid component type.")}}function Yn(o,e){switch(e.constructor){case Float32Array:return o;case Uint32Array:return Math.round(4294967295*o);case Uint16Array:return Math.round(65535*o);case Uint8Array:return Math.round(255*o);case Int32Array:return Math.round(2147483647*o);case Int16Array:return Math.round(32767*o);case Int8Array:return Math.round(127*o);default:throw new Error("Invalid component type.")}}const Co_DEG2RAD=$o,Co_degToRad=function Ax(o){return o*$o},Co_radToDeg=function vE(o){return o*Qu};class Be{constructor(e=0,t=0){Be.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6],this.y=i[1]*t+i[4]*n+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Ki(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),i=Math.sin(t),a=this.x-e.x,c=this.y-e.y;return this.x=a*n-c*i+e.x,this.y=a*i+c*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Zn{constructor(e,t,n,i,a,c,u,d,p){Zn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,n,i,a,c,u,d,p)}set(e,t,n,i,a,c,u,d,p){const v=this.elements;return v[0]=e,v[1]=i,v[2]=u,v[3]=t,v[4]=a,v[5]=d,v[6]=n,v[7]=c,v[8]=p,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,a=this.elements,c=n[0],u=n[3],d=n[6],p=n[1],v=n[4],_=n[7],M=n[2],b=n[5],A=n[8],P=i[0],R=i[3],T=i[6],U=i[1],F=i[4],V=i[7],X=i[2],Z=i[5],q=i[8];return a[0]=c*P+u*U+d*X,a[3]=c*R+u*F+d*Z,a[6]=c*T+u*V+d*q,a[1]=p*P+v*U+_*X,a[4]=p*R+v*F+_*Z,a[7]=p*T+v*V+_*q,a[2]=M*P+b*U+A*X,a[5]=M*R+b*F+A*Z,a[8]=M*T+b*V+A*q,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],i=e[2],a=e[3],c=e[4],u=e[5],d=e[6],p=e[7],v=e[8];return t*c*v-t*u*p-n*a*v+n*u*d+i*a*p-i*c*d}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],a=e[3],c=e[4],u=e[5],d=e[6],p=e[7],v=e[8],_=v*c-u*p,M=u*d-v*a,b=p*a-c*d,A=t*_+n*M+i*b;if(0===A)return this.set(0,0,0,0,0,0,0,0,0);const P=1/A;return e[0]=_*P,e[1]=(i*p-v*n)*P,e[2]=(u*n-i*c)*P,e[3]=M*P,e[4]=(v*t-i*d)*P,e[5]=(i*a-u*t)*P,e[6]=b*P,e[7]=(n*d-p*t)*P,e[8]=(c*t-n*a)*P,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,i,a,c,u){const d=Math.cos(a),p=Math.sin(a);return this.set(n*d,n*p,-n*(d*c+p*u)+c+e,-i*p,i*d,-i*(-p*c+d*u)+u+t,0,0,1),this}scale(e,t){return this.premultiply(Nm.makeScale(e,t)),this}rotate(e){return this.premultiply(Nm.makeRotation(-e)),this}translate(e,t){return this.premultiply(Nm.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<9;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const Nm=new Zn;function ly(o){for(let e=o.length-1;e>=0;--e)if(o[e]>=65535)return!0;return!1}function iu(o){return document.createElementNS("http://www.w3.org/1999/xhtml",o)}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const cd={};function Nf(o){o in cd||(cd[o]=!0,console.warn(o))}function el(o){return o<.04045?.0773993808*o:Math.pow(.9478672986*o+.0521327014,2.4)}function ud(o){return o<.0031308?12.92*o:1.055*Math.pow(o,.41666)-.055}const kf=(new Zn).fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),Cx=(new Zn).fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]),cy={[ls]:o=>o,[vn]:o=>o.convertSRGBToLinear(),[mc]:function Dx(o){return o.convertSRGBToLinear().applyMatrix3(Cx)}},Ix={[ls]:o=>o,[vn]:o=>o.convertLinearToSRGB(),[mc]:function Rx(o){return o.applyMatrix3(kf).convertLinearToSRGB()}},Ys={enabled:!0,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(o){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!o},get workingColorSpace(){return ls},set workingColorSpace(o){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(o,e,t){if(!1===this.enabled||e===t||!e||!t)return o;const n=cy[e],i=Ix[t];if(void 0===n||void 0===i)throw new Error(`Unsupported color space conversion, "${e}" to "${t}".`);return i(n(o))},fromWorkingColorSpace:function(o,e){return this.convert(o,this.workingColorSpace,e)},toWorkingColorSpace:function(o,e){return this.convert(o,e,this.workingColorSpace)}};let ru;class uy{static getDataURL(e){if(/^data:/i.test(e.src)||"undefined"==typeof HTMLCanvasElement)return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===ru&&(ru=iu("canvas")),ru.width=e.width,ru.height=e.height;const n=ru.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=ru}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const t=iu("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const i=n.getImageData(0,0,e.width,e.height),a=i.data;for(let c=0;c<a.length;c++)a[c]=255*el(a[c]/255);return n.putImageData(i,0,0),t}if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t[n]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*el(t[n]/255)):el(t[n]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let Es=0;class su{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:Es++}),this.uuid=Hr(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const n={uuid:this.uuid,url:""},i=this.data;if(null!==i){let a;if(Array.isArray(i)){a=[];for(let c=0,u=i.length;c<u;c++)a.push(km(i[c].isDataTexture?i[c].image:i[c]))}else a=km(i);n.url=a}return t||(e.images[this.uuid]=n),n}}function km(o){return"undefined"!=typeof HTMLImageElement&&o instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&o instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&o instanceof ImageBitmap?uy.getDataURL(o):o.data?{data:Array.from(o.data),width:o.width,height:o.height,type:o.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Um=0,Ss=(()=>{class o extends Rl{constructor(t=o.DEFAULT_IMAGE,n=o.DEFAULT_MAPPING,i=ri,a=ri,c=Ii,u=Ms,d=qr,p=Vo,v=o.DEFAULT_ANISOTROPY,_=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Um++}),this.uuid=Hr(),this.name="",this.source=new su(t),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=i,this.wrapT=a,this.magFilter=c,this.minFilter=u,this.anisotropy=v,this.format=d,this.internalFormat=null,this.type=p,this.offset=new Be(0,0),this.repeat=new Be(1,1),this.center=new Be(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Zn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,"string"==typeof _?this.colorSpace=_:(Nf("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=_===xa?vn:""),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const n=void 0===t||"string"==typeof t;if(!n&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const i={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),n||(t.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case $i:t.x=t.x-Math.floor(t.x);break;case ri:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case $i:t.y=t.y-Math.floor(t.y);break;case ri:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return Nf("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===vn?xa:3e3}set encoding(t){Nf("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=t===xa?vn:""}}return o.DEFAULT_IMAGE=null,o.DEFAULT_MAPPING=300,o.DEFAULT_ANISOTROPY=1,o})();class Ci{constructor(e=0,t=0,n=0,i=1){Ci.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,a=this.w,c=e.elements;return this.x=c[0]*t+c[4]*n+c[8]*i+c[12]*a,this.y=c[1]*t+c[5]*n+c[9]*i+c[13]*a,this.z=c[2]*t+c[6]*n+c[10]*i+c[14]*a,this.w=c[3]*t+c[7]*n+c[11]*i+c[15]*a,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,i,a;const d=e.elements,p=d[0],v=d[4],_=d[8],M=d[1],b=d[5],A=d[9],P=d[2],R=d[6],T=d[10];if(Math.abs(v-M)<.01&&Math.abs(_-P)<.01&&Math.abs(A-R)<.01){if(Math.abs(v+M)<.1&&Math.abs(_+P)<.1&&Math.abs(A+R)<.1&&Math.abs(p+b+T-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const F=(p+1)/2,V=(b+1)/2,X=(T+1)/2,Z=(v+M)/4,q=(_+P)/4,ee=(A+R)/4;return F>V&&F>X?F<.01?(n=0,i=.707106781,a=.707106781):(n=Math.sqrt(F),i=Z/n,a=q/n):V>X?V<.01?(n=.707106781,i=0,a=.707106781):(i=Math.sqrt(V),n=Z/i,a=ee/i):X<.01?(n=.707106781,i=.707106781,a=0):(a=Math.sqrt(X),n=q/a,i=ee/a),this.set(n,i,a,t),this}let U=Math.sqrt((R-A)*(R-A)+(_-P)*(_-P)+(M-v)*(M-v));return Math.abs(U)<.001&&(U=1),this.x=(R-A)/U,this.y=(_-P)/U,this.z=(M-v)/U,this.w=Math.acos((p+b+T-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Px extends Rl{constructor(e=1,t=1,n={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Ci(0,0,e,t),this.scissorTest=!1,this.viewport=new Ci(0,0,e,t);const i={width:e,height:t,depth:1};void 0!==n.encoding&&(Nf("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),n.colorSpace=n.encoding===xa?vn:""),this.texture=new Ss(i,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.internalFormat=void 0!==n.internalFormat?n.internalFormat:null,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:Ii,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null,this.samples=void 0!==n.samples?n.samples:0}setSize(e,t,n=1){(this.width!==e||this.height!==t||this.depth!==n)&&(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new su(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class ba extends Px{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}}class eh extends Ss{constructor(e=null,t=1,n=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=Fi,this.minFilter=Fi,this.wrapR=ri,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Bm extends Ss{constructor(e=null,t=1,n=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=Fi,this.minFilter=Fi,this.wrapR=ri,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class _r{constructor(e=0,t=0,n=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=i}static slerpFlat(e,t,n,i,a,c,u){let d=n[i+0],p=n[i+1],v=n[i+2],_=n[i+3];const M=a[c+0],b=a[c+1],A=a[c+2],P=a[c+3];if(0===u)return e[t+0]=d,e[t+1]=p,e[t+2]=v,void(e[t+3]=_);if(1===u)return e[t+0]=M,e[t+1]=b,e[t+2]=A,void(e[t+3]=P);if(_!==P||d!==M||p!==b||v!==A){let R=1-u;const T=d*M+p*b+v*A+_*P,U=T>=0?1:-1,F=1-T*T;if(F>Number.EPSILON){const X=Math.sqrt(F),Z=Math.atan2(X,T*U);R=Math.sin(R*Z)/X,u=Math.sin(u*Z)/X}const V=u*U;if(d=d*R+M*V,p=p*R+b*V,v=v*R+A*V,_=_*R+P*V,R===1-u){const X=1/Math.sqrt(d*d+p*p+v*v+_*_);d*=X,p*=X,v*=X,_*=X}}e[t]=d,e[t+1]=p,e[t+2]=v,e[t+3]=_}static multiplyQuaternionsFlat(e,t,n,i,a,c){const u=n[i],d=n[i+1],p=n[i+2],v=n[i+3],_=a[c],M=a[c+1],b=a[c+2],A=a[c+3];return e[t]=u*A+v*_+d*b-p*M,e[t+1]=d*A+v*M+p*_-u*b,e[t+2]=p*A+v*b+u*M-d*_,e[t+3]=v*A-u*_-d*M-p*b,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const n=e._x,i=e._y,a=e._z,c=e._order,u=Math.cos,d=Math.sin,p=u(n/2),v=u(i/2),_=u(a/2),M=d(n/2),b=d(i/2),A=d(a/2);switch(c){case"XYZ":this._x=M*v*_+p*b*A,this._y=p*b*_-M*v*A,this._z=p*v*A+M*b*_,this._w=p*v*_-M*b*A;break;case"YXZ":this._x=M*v*_+p*b*A,this._y=p*b*_-M*v*A,this._z=p*v*A-M*b*_,this._w=p*v*_+M*b*A;break;case"ZXY":this._x=M*v*_-p*b*A,this._y=p*b*_+M*v*A,this._z=p*v*A+M*b*_,this._w=p*v*_-M*b*A;break;case"ZYX":this._x=M*v*_-p*b*A,this._y=p*b*_+M*v*A,this._z=p*v*A-M*b*_,this._w=p*v*_+M*b*A;break;case"YZX":this._x=M*v*_+p*b*A,this._y=p*b*_+M*v*A,this._z=p*v*A-M*b*_,this._w=p*v*_-M*b*A;break;case"XZY":this._x=M*v*_-p*b*A,this._y=p*b*_-M*v*A,this._z=p*v*A+M*b*_,this._w=p*v*_+M*b*A;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+c)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,i=Math.sin(n);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],i=t[4],a=t[8],c=t[1],u=t[5],d=t[9],p=t[2],v=t[6],_=t[10],M=n+u+_;if(M>0){const b=.5/Math.sqrt(M+1);this._w=.25/b,this._x=(v-d)*b,this._y=(a-p)*b,this._z=(c-i)*b}else if(n>u&&n>_){const b=2*Math.sqrt(1+n-u-_);this._w=(v-d)/b,this._x=.25*b,this._y=(i+c)/b,this._z=(a+p)/b}else if(u>_){const b=2*Math.sqrt(1+u-n-_);this._w=(a-p)/b,this._x=(i+c)/b,this._y=.25*b,this._z=(d+v)/b}else{const b=2*Math.sqrt(1+_-n-u);this._w=(c-i)/b,this._x=(a+p)/b,this._y=(d+v)/b,this._z=.25*b}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Ki(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const i=Math.min(1,t/n);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,i=e._y,a=e._z,c=e._w,u=t._x,d=t._y,p=t._z,v=t._w;return this._x=n*v+c*u+i*p-a*d,this._y=i*v+c*d+a*u-n*p,this._z=a*v+c*p+n*d-i*u,this._w=c*v-n*u-i*d-a*p,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const n=this._x,i=this._y,a=this._z,c=this._w;let u=c*e._w+n*e._x+i*e._y+a*e._z;if(u<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,u=-u):this.copy(e),u>=1)return this._w=c,this._x=n,this._y=i,this._z=a,this;const d=1-u*u;if(d<=Number.EPSILON){const b=1-t;return this._w=b*c+t*this._w,this._x=b*n+t*this._x,this._y=b*i+t*this._y,this._z=b*a+t*this._z,this.normalize(),this._onChangeCallback(),this}const p=Math.sqrt(d),v=Math.atan2(p,u),_=Math.sin((1-t)*v)/p,M=Math.sin(t*v)/p;return this._w=c*_+this._w*M,this._x=n*_+this._x*M,this._y=i*_+this._y*M,this._z=a*_+this._z*M,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),i=2*Math.PI*Math.random(),a=2*Math.PI*Math.random();return this.set(t*Math.cos(i),n*Math.sin(a),n*Math.cos(a),t*Math.sin(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Q{constructor(e=0,t=0,n=0){Q.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(Vm.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Vm.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,i=this.z,a=e.elements;return this.x=a[0]*t+a[3]*n+a[6]*i,this.y=a[1]*t+a[4]*n+a[7]*i,this.z=a[2]*t+a[5]*n+a[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,a=e.elements,c=1/(a[3]*t+a[7]*n+a[11]*i+a[15]);return this.x=(a[0]*t+a[4]*n+a[8]*i+a[12])*c,this.y=(a[1]*t+a[5]*n+a[9]*i+a[13])*c,this.z=(a[2]*t+a[6]*n+a[10]*i+a[14])*c,this}applyQuaternion(e){const t=this.x,n=this.y,i=this.z,a=e.x,c=e.y,u=e.z,d=e.w,p=d*t+c*i-u*n,v=d*n+u*t-a*i,_=d*i+a*n-c*t,M=-a*t-c*n-u*i;return this.x=p*d+M*-a+v*-u-_*-c,this.y=v*d+M*-c+_*-a-p*-u,this.z=_*d+M*-u+p*-c-v*-a,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,i=this.z,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*i,this.y=a[1]*t+a[5]*n+a[9]*i,this.z=a[2]*t+a[6]*n+a[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,i=e.y,a=e.z,c=t.x,u=t.y,d=t.z;return this.x=i*d-a*u,this.y=a*c-n*d,this.z=n*u-i*c,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return th.copy(this).projectOnVector(e),this.sub(th)}reflect(e){return this.sub(th.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Ki(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const i=Math.sin(t)*e;return this.x=i*Math.sin(n),this.y=Math.cos(t)*e,this.z=i*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,n=Math.sqrt(1-e**2);return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const th=new Q,Vm=new _r;class tl{constructor(e=new Q(1/0,1/0,1/0),t=new Q(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(oo.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(oo.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=oo.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){if(e.updateWorldMatrix(!1,!1),void 0!==e.boundingBox)null===e.boundingBox&&e.computeBoundingBox(),nl.copy(e.boundingBox),nl.applyMatrix4(e.matrixWorld),this.union(nl);else{const i=e.geometry;if(void 0!==i)if(t&&void 0!==i.attributes&&void 0!==i.attributes.position){const a=i.attributes.position;for(let c=0,u=a.count;c<u;c++)oo.fromBufferAttribute(a,c).applyMatrix4(e.matrixWorld),this.expandByPoint(oo)}else null===i.boundingBox&&i.computeBoundingBox(),nl.copy(i.boundingBox),nl.applyMatrix4(e.matrixWorld),this.union(nl)}const n=e.children;for(let i=0,a=n.length;i<a;i++)this.expandByObject(n[i],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,oo),oo.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(dd),Vf.subVectors(this.max,dd),nh.subVectors(e.a,dd),hd.subVectors(e.b,dd),ou.subVectors(e.c,dd),gc.subVectors(hd,nh),au.subVectors(ou,hd),lu.subVectors(nh,ou);let t=[0,-gc.z,gc.y,0,-au.z,au.y,0,-lu.z,lu.y,gc.z,0,-gc.x,au.z,0,-au.x,lu.z,0,-lu.x,-gc.y,gc.x,0,-au.y,au.x,0,-lu.y,lu.x,0];return!(!qo(t,nh,hd,ou,Vf)||(t=[1,0,0,0,1,0,0,0,1],!qo(t,nh,hd,ou,Vf)))&&(zf.crossVectors(gc,au),t=[zf.x,zf.y,zf.z],qo(t,nh,hd,ou,Vf))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,oo).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(oo).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Il[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Il[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Il[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Il[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Il[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Il[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Il[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Il[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Il)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Il=[new Q,new Q,new Q,new Q,new Q,new Q,new Q,new Q],oo=new Q,nl=new tl,nh=new Q,hd=new Q,ou=new Q,gc=new Q,au=new Q,lu=new Q,dd=new Q,Vf=new Q,zf=new Q,ih=new Q;function qo(o,e,t,n,i){for(let a=0,c=o.length-3;a<=c;a+=3){ih.fromArray(o,a);const u=i.x*Math.abs(ih.x)+i.y*Math.abs(ih.y)+i.z*Math.abs(ih.z),d=e.dot(ih),p=t.dot(ih),v=n.dot(ih);if(Math.max(-Math.max(d,p,v),Math.min(d,p,v))>u)return!1}return!0}const Lx=new tl,fd=new Q,zm=new Q;class Yo{constructor(e=new Q,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):Lx.setFromPoints(e).getCenter(n);let i=0;for(let a=0,c=e.length;a<c;a++)i=Math.max(i,n.distanceToSquared(e[a]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;fd.subVectors(e,this.center);const t=fd.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),i=.5*(n-this.radius);this.center.addScaledVector(fd,i/n),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(zm.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(fd.copy(e.center).add(zm)),this.expandByPoint(fd.copy(e.center).sub(zm))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const fr=new Q,pd=new Q,md=new Q,Pl=new Q,us=new Q,vc=new Q,gd=new Q;class rh{constructor(e=new Q,t=new Q(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,fr)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=fr.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(fr.copy(this.origin).addScaledVector(this.direction,t),fr.distanceToSquared(e))}distanceSqToSegment(e,t,n,i){pd.copy(e).add(t).multiplyScalar(.5),md.copy(t).sub(e).normalize(),Pl.copy(this.origin).sub(pd);const a=.5*e.distanceTo(t),c=-this.direction.dot(md),u=Pl.dot(this.direction),d=-Pl.dot(md),p=Pl.lengthSq(),v=Math.abs(1-c*c);let _,M,b,A;if(v>0)if(_=c*d-u,M=c*u-d,A=a*v,_>=0)if(M>=-A)if(M<=A){const P=1/v;_*=P,M*=P,b=_*(_+c*M+2*u)+M*(c*_+M+2*d)+p}else M=a,_=Math.max(0,-(c*M+u)),b=-_*_+M*(M+2*d)+p;else M=-a,_=Math.max(0,-(c*M+u)),b=-_*_+M*(M+2*d)+p;else M<=-A?(_=Math.max(0,-(-c*a+u)),M=_>0?-a:Math.min(Math.max(-a,-d),a),b=-_*_+M*(M+2*d)+p):M<=A?(_=0,M=Math.min(Math.max(-a,-d),a),b=M*(M+2*d)+p):(_=Math.max(0,-(c*a+u)),M=_>0?a:Math.min(Math.max(-a,-d),a),b=-_*_+M*(M+2*d)+p);else M=c>0?-a:a,_=Math.max(0,-(c*M+u)),b=-_*_+M*(M+2*d)+p;return n&&n.copy(this.origin).addScaledVector(this.direction,_),i&&i.copy(pd).addScaledVector(md,M),b}intersectSphere(e,t){fr.subVectors(e.center,this.origin);const n=fr.dot(this.direction),i=fr.dot(fr)-n*n,a=e.radius*e.radius;if(i>a)return null;const c=Math.sqrt(a-i),u=n-c,d=n+c;return d<0?null:this.at(u<0?d:u,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,i,a,c,u,d;const p=1/this.direction.x,v=1/this.direction.y,_=1/this.direction.z,M=this.origin;return p>=0?(n=(e.min.x-M.x)*p,i=(e.max.x-M.x)*p):(n=(e.max.x-M.x)*p,i=(e.min.x-M.x)*p),v>=0?(a=(e.min.y-M.y)*v,c=(e.max.y-M.y)*v):(a=(e.max.y-M.y)*v,c=(e.min.y-M.y)*v),n>c||a>i||((a>n||isNaN(n))&&(n=a),(c<i||isNaN(i))&&(i=c),_>=0?(u=(e.min.z-M.z)*_,d=(e.max.z-M.z)*_):(u=(e.max.z-M.z)*_,d=(e.min.z-M.z)*_),n>d||u>i)||((u>n||n!=n)&&(n=u),(d<i||i!=i)&&(i=d),i<0)?null:this.at(n>=0?n:i,t)}intersectsBox(e){return null!==this.intersectBox(e,fr)}intersectTriangle(e,t,n,i,a){us.subVectors(t,e),vc.subVectors(n,e),gd.crossVectors(us,vc);let u,c=this.direction.dot(gd);if(c>0){if(i)return null;u=1}else{if(!(c<0))return null;u=-1,c=-c}Pl.subVectors(this.origin,e);const d=u*this.direction.dot(vc.crossVectors(Pl,vc));if(d<0)return null;const p=u*this.direction.dot(us.cross(Pl));if(p<0||d+p>c)return null;const v=-u*Pl.dot(gd);return v<0?null:this.at(v/c,a)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Yt{constructor(e,t,n,i,a,c,u,d,p,v,_,M,b,A,P,R){Yt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,n,i,a,c,u,d,p,v,_,M,b,A,P,R)}set(e,t,n,i,a,c,u,d,p,v,_,M,b,A,P,R){const T=this.elements;return T[0]=e,T[4]=t,T[8]=n,T[12]=i,T[1]=a,T[5]=c,T[9]=u,T[13]=d,T[2]=p,T[6]=v,T[10]=_,T[14]=M,T[3]=b,T[7]=A,T[11]=P,T[15]=R,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Yt).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,i=1/cu.setFromMatrixColumn(e,0).length(),a=1/cu.setFromMatrixColumn(e,1).length(),c=1/cu.setFromMatrixColumn(e,2).length();return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=0,t[4]=n[4]*a,t[5]=n[5]*a,t[6]=n[6]*a,t[7]=0,t[8]=n[8]*c,t[9]=n[9]*c,t[10]=n[10]*c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,i=e.y,a=e.z,c=Math.cos(n),u=Math.sin(n),d=Math.cos(i),p=Math.sin(i),v=Math.cos(a),_=Math.sin(a);if("XYZ"===e.order){const M=c*v,b=c*_,A=u*v,P=u*_;t[0]=d*v,t[4]=-d*_,t[8]=p,t[1]=b+A*p,t[5]=M-P*p,t[9]=-u*d,t[2]=P-M*p,t[6]=A+b*p,t[10]=c*d}else if("YXZ"===e.order){const M=d*v,b=d*_,A=p*v,P=p*_;t[0]=M+P*u,t[4]=A*u-b,t[8]=c*p,t[1]=c*_,t[5]=c*v,t[9]=-u,t[2]=b*u-A,t[6]=P+M*u,t[10]=c*d}else if("ZXY"===e.order){const M=d*v,b=d*_,A=p*v,P=p*_;t[0]=M-P*u,t[4]=-c*_,t[8]=A+b*u,t[1]=b+A*u,t[5]=c*v,t[9]=P-M*u,t[2]=-c*p,t[6]=u,t[10]=c*d}else if("ZYX"===e.order){const M=c*v,b=c*_,A=u*v,P=u*_;t[0]=d*v,t[4]=A*p-b,t[8]=M*p+P,t[1]=d*_,t[5]=P*p+M,t[9]=b*p-A,t[2]=-p,t[6]=u*d,t[10]=c*d}else if("YZX"===e.order){const M=c*d,b=c*p,A=u*d,P=u*p;t[0]=d*v,t[4]=P-M*_,t[8]=A*_+b,t[1]=_,t[5]=c*v,t[9]=-u*v,t[2]=-p*v,t[6]=b*_+A,t[10]=M-P*_}else if("XZY"===e.order){const M=c*d,b=c*p,A=u*d,P=u*p;t[0]=d*v,t[4]=-_,t[8]=p*v,t[1]=M*_+P,t[5]=c*v,t[9]=b*_-A,t[2]=A*_-b,t[6]=u*v,t[10]=P*_+M}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(hy,e,Ox)}lookAt(e,t,n){const i=this.elements;return Do.subVectors(e,t),0===Do.lengthSq()&&(Do.z=1),Do.normalize(),Ll.crossVectors(n,Do),0===Ll.lengthSq()&&(1===Math.abs(n.z)?Do.x+=1e-4:Do.z+=1e-4,Do.normalize(),Ll.crossVectors(n,Do)),Ll.normalize(),Hf.crossVectors(Do,Ll),i[0]=Ll.x,i[4]=Hf.x,i[8]=Do.x,i[1]=Ll.y,i[5]=Hf.y,i[9]=Do.y,i[2]=Ll.z,i[6]=Hf.z,i[10]=Do.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,a=this.elements,c=n[0],u=n[4],d=n[8],p=n[12],v=n[1],_=n[5],M=n[9],b=n[13],A=n[2],P=n[6],R=n[10],T=n[14],U=n[3],F=n[7],V=n[11],X=n[15],Z=i[0],q=i[4],ee=i[8],j=i[12],K=i[1],Me=i[5],De=i[9],me=i[13],pe=i[2],xe=i[6],Ne=i[10],Pe=i[14],ze=i[3],$e=i[7],Ke=i[11],_e=i[15];return a[0]=c*Z+u*K+d*pe+p*ze,a[4]=c*q+u*Me+d*xe+p*$e,a[8]=c*ee+u*De+d*Ne+p*Ke,a[12]=c*j+u*me+d*Pe+p*_e,a[1]=v*Z+_*K+M*pe+b*ze,a[5]=v*q+_*Me+M*xe+b*$e,a[9]=v*ee+_*De+M*Ne+b*Ke,a[13]=v*j+_*me+M*Pe+b*_e,a[2]=A*Z+P*K+R*pe+T*ze,a[6]=A*q+P*Me+R*xe+T*$e,a[10]=A*ee+P*De+R*Ne+T*Ke,a[14]=A*j+P*me+R*Pe+T*_e,a[3]=U*Z+F*K+V*pe+X*ze,a[7]=U*q+F*Me+V*xe+X*$e,a[11]=U*ee+F*De+V*Ne+X*Ke,a[15]=U*j+F*me+V*Pe+X*_e,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],i=e[8],a=e[12],c=e[1],u=e[5],d=e[9],p=e[13],v=e[2],_=e[6],M=e[10],b=e[14];return e[3]*(+a*d*_-i*p*_-a*u*M+n*p*M+i*u*b-n*d*b)+e[7]*(+t*d*b-t*p*M+a*c*M-i*c*b+i*p*v-a*d*v)+e[11]*(+t*p*_-t*u*b-a*c*_+n*c*b+a*u*v-n*p*v)+e[15]*(-i*u*v-t*d*_+t*u*M+i*c*_-n*c*M+n*d*v)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],a=e[3],c=e[4],u=e[5],d=e[6],p=e[7],v=e[8],_=e[9],M=e[10],b=e[11],A=e[12],P=e[13],R=e[14],T=e[15],U=_*R*p-P*M*p+P*d*b-u*R*b-_*d*T+u*M*T,F=A*M*p-v*R*p-A*d*b+c*R*b+v*d*T-c*M*T,V=v*P*p-A*_*p+A*u*b-c*P*b-v*u*T+c*_*T,X=A*_*d-v*P*d-A*u*M+c*P*M+v*u*R-c*_*R,Z=t*U+n*F+i*V+a*X;if(0===Z)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const q=1/Z;return e[0]=U*q,e[1]=(P*M*a-_*R*a-P*i*b+n*R*b+_*i*T-n*M*T)*q,e[2]=(u*R*a-P*d*a+P*i*p-n*R*p-u*i*T+n*d*T)*q,e[3]=(_*d*a-u*M*a-_*i*p+n*M*p+u*i*b-n*d*b)*q,e[4]=F*q,e[5]=(v*R*a-A*M*a+A*i*b-t*R*b-v*i*T+t*M*T)*q,e[6]=(A*d*a-c*R*a-A*i*p+t*R*p+c*i*T-t*d*T)*q,e[7]=(c*M*a-v*d*a+v*i*p-t*M*p-c*i*b+t*d*b)*q,e[8]=V*q,e[9]=(A*_*a-v*P*a-A*n*b+t*P*b+v*n*T-t*_*T)*q,e[10]=(c*P*a-A*u*a+A*n*p-t*P*p-c*n*T+t*u*T)*q,e[11]=(v*u*a-c*_*a-v*n*p+t*_*p+c*n*b-t*u*b)*q,e[12]=X*q,e[13]=(v*P*i-A*_*i+A*n*M-t*P*M-v*n*R+t*_*R)*q,e[14]=(A*u*i-c*P*i-A*n*d+t*P*d+c*n*R-t*u*R)*q,e[15]=(c*_*i-v*u*i+v*n*d-t*_*d-c*n*M+t*u*M)*q,this}scale(e){const t=this.elements,n=e.x,i=e.y,a=e.z;return t[0]*=n,t[4]*=i,t[8]*=a,t[1]*=n,t[5]*=i,t[9]*=a,t[2]*=n,t[6]*=i,t[10]*=a,t[3]*=n,t[7]*=i,t[11]*=a,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),i=Math.sin(t),a=1-n,c=e.x,u=e.y,d=e.z,p=a*c,v=a*u;return this.set(p*c+n,p*u-i*d,p*d+i*u,0,p*u+i*d,v*u+n,v*d-i*c,0,p*d-i*u,v*d+i*c,a*d*d+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,i,a,c){return this.set(1,n,a,0,e,1,c,0,t,i,1,0,0,0,0,1),this}compose(e,t,n){const i=this.elements,a=t._x,c=t._y,u=t._z,d=t._w,p=a+a,v=c+c,_=u+u,M=a*p,b=a*v,A=a*_,P=c*v,R=c*_,T=u*_,U=d*p,F=d*v,V=d*_,X=n.x,Z=n.y,q=n.z;return i[0]=(1-(P+T))*X,i[1]=(b+V)*X,i[2]=(A-F)*X,i[3]=0,i[4]=(b-V)*Z,i[5]=(1-(M+T))*Z,i[6]=(R+U)*Z,i[7]=0,i[8]=(A+F)*q,i[9]=(R-U)*q,i[10]=(1-(M+P))*q,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,n){const i=this.elements;let a=cu.set(i[0],i[1],i[2]).length();const c=cu.set(i[4],i[5],i[6]).length(),u=cu.set(i[8],i[9],i[10]).length();this.determinant()<0&&(a=-a),e.x=i[12],e.y=i[13],e.z=i[14],wa.copy(this);const p=1/a,v=1/c,_=1/u;return wa.elements[0]*=p,wa.elements[1]*=p,wa.elements[2]*=p,wa.elements[4]*=v,wa.elements[5]*=v,wa.elements[6]*=v,wa.elements[8]*=_,wa.elements[9]*=_,wa.elements[10]*=_,t.setFromRotationMatrix(wa),n.x=a,n.y=c,n.z=u,this}makePerspective(e,t,n,i,a,c,u=qs){const d=this.elements,p=2*a/(t-e),v=2*a/(n-i),_=(t+e)/(t-e),M=(n+i)/(n-i);let b,A;if(u===qs)b=-(c+a)/(c-a),A=-2*c*a/(c-a);else{if(2001!==u)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+u);b=-c/(c-a),A=-c*a/(c-a)}return d[0]=p,d[4]=0,d[8]=_,d[12]=0,d[1]=0,d[5]=v,d[9]=M,d[13]=0,d[2]=0,d[6]=0,d[10]=b,d[14]=A,d[3]=0,d[7]=0,d[11]=-1,d[15]=0,this}makeOrthographic(e,t,n,i,a,c,u=qs){const d=this.elements,p=1/(t-e),v=1/(n-i),_=1/(c-a),M=(t+e)*p,b=(n+i)*v;let A,P;if(u===qs)A=(c+a)*_,P=-2*_;else{if(2001!==u)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+u);A=a*_,P=-1*_}return d[0]=2*p,d[4]=0,d[8]=0,d[12]=-M,d[1]=0,d[5]=2*v,d[9]=0,d[13]=-b,d[2]=0,d[6]=0,d[10]=P,d[14]=-A,d[3]=0,d[7]=0,d[11]=0,d[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<16;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const cu=new Q,wa=new Yt,hy=new Q(0,0,0),Ox=new Q(1,1,1),Ll=new Q,Hf=new Q,Do=new Q,Gf=new Yt,Wf=new _r;let Ol=(()=>{class o{constructor(t=0,n=0,i=0,a=o.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=n,this._z=i,this._order=a}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,n,i,a=this._order){return this._x=t,this._y=n,this._z=i,this._order=a,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,n=this._order,i=!0){const a=t.elements,c=a[0],u=a[4],d=a[8],p=a[1],v=a[5],_=a[9],M=a[2],b=a[6],A=a[10];switch(n){case"XYZ":this._y=Math.asin(Ki(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(-_,A),this._z=Math.atan2(-u,c)):(this._x=Math.atan2(b,v),this._z=0);break;case"YXZ":this._x=Math.asin(-Ki(_,-1,1)),Math.abs(_)<.9999999?(this._y=Math.atan2(d,A),this._z=Math.atan2(p,v)):(this._y=Math.atan2(-M,c),this._z=0);break;case"ZXY":this._x=Math.asin(Ki(b,-1,1)),Math.abs(b)<.9999999?(this._y=Math.atan2(-M,A),this._z=Math.atan2(-u,v)):(this._y=0,this._z=Math.atan2(p,c));break;case"ZYX":this._y=Math.asin(-Ki(M,-1,1)),Math.abs(M)<.9999999?(this._x=Math.atan2(b,A),this._z=Math.atan2(p,c)):(this._x=0,this._z=Math.atan2(-u,v));break;case"YZX":this._z=Math.asin(Ki(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(-_,v),this._y=Math.atan2(-M,c)):(this._x=0,this._y=Math.atan2(d,A));break;case"XZY":this._z=Math.asin(-Ki(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(b,v),this._y=Math.atan2(d,c)):(this._x=Math.atan2(-_,A),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,!0===i&&this._onChangeCallback(),this}setFromQuaternion(t,n,i){return Gf.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Gf,n,i)}setFromVector3(t,n=this._order){return this.set(t.x,t.y,t.z,n)}reorder(t){return Wf.setFromEuler(this),this.setFromQuaternion(Wf,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],n=0){return t[n]=this._x,t[n+1]=this._y,t[n+2]=this._z,t[n+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return o.DEFAULT_ORDER="XYZ",o})();class jf{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let vd=0;const Hm=new Q,uu=new _r,Ea=new Yt,sh=new Q,oh=new Q,_E=new Q,ah=new _r,$f=new Q(1,0,0),Gm=new Q(0,1,0),dy=new Q(0,0,1),Wm={type:"added"},fy={type:"removed"};let xr=(()=>{class o extends Rl{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:vd++}),this.uuid=Hr(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=o.DEFAULT_UP.clone();const t=new Q,n=new Ol,i=new _r,a=new Q(1,1,1);n._onChange(function c(){i.setFromEuler(n,!1)}),i._onChange(function u(){n.setFromQuaternion(i,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:a},modelViewMatrix:{value:new Yt},normalMatrix:{value:new Zn}}),this.matrix=new Yt,this.matrixWorld=new Yt,this.matrixAutoUpdate=o.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=o.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new jf,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,n){this.quaternion.setFromAxisAngle(t,n)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,n){return uu.setFromAxisAngle(t,n),this.quaternion.multiply(uu),this}rotateOnWorldAxis(t,n){return uu.setFromAxisAngle(t,n),this.quaternion.premultiply(uu),this}rotateX(t){return this.rotateOnAxis($f,t)}rotateY(t){return this.rotateOnAxis(Gm,t)}rotateZ(t){return this.rotateOnAxis(dy,t)}translateOnAxis(t,n){return Hm.copy(t).applyQuaternion(this.quaternion),this.position.add(Hm.multiplyScalar(n)),this}translateX(t){return this.translateOnAxis($f,t)}translateY(t){return this.translateOnAxis(Gm,t)}translateZ(t){return this.translateOnAxis(dy,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(Ea.copy(this.matrixWorld).invert())}lookAt(t,n,i){t.isVector3?sh.copy(t):sh.set(t,n,i);const a=this.parent;this.updateWorldMatrix(!0,!1),oh.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ea.lookAt(oh,sh,this.up):Ea.lookAt(sh,oh,this.up),this.quaternion.setFromRotationMatrix(Ea),a&&(Ea.extractRotation(a.matrixWorld),uu.setFromRotationMatrix(Ea),this.quaternion.premultiply(uu.invert()))}add(t){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(Wm)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const n=this.children.indexOf(t);return-1!==n&&(t.parent=null,this.children.splice(n,1),t.dispatchEvent(fy)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const n=this.children[t];n.parent=null,n.dispatchEvent(fy)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),Ea.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),Ea.multiply(t.parent.matrixWorld)),t.applyMatrix4(Ea),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,n){if(this[t]===n)return this;for(let i=0,a=this.children.length;i<a;i++){const u=this.children[i].getObjectByProperty(t,n);if(void 0!==u)return u}}getObjectsByProperty(t,n){let i=[];this[t]===n&&i.push(this);for(let a=0,c=this.children.length;a<c;a++){const u=this.children[a].getObjectsByProperty(t,n);u.length>0&&(i=i.concat(u))}return i}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(oh,t,_E),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(oh,ah,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return t.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(t){t(this);const n=this.children;for(let i=0,a=n.length;i<a;i++)n[i].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const n=this.children;for(let i=0,a=n.length;i<a;i++)n[i].traverseVisible(t)}traverseAncestors(t){const n=this.parent;null!==n&&(t(n),n.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const n=this.children;for(let i=0,a=n.length;i<a;i++){const c=n[i];(!0===c.matrixWorldAutoUpdate||!0===t)&&c.updateMatrixWorld(t)}}updateWorldMatrix(t,n){const i=this.parent;if(!0===t&&null!==i&&!0===i.matrixWorldAutoUpdate&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===n){const a=this.children;for(let c=0,u=a.length;c<u;c++){const d=a[c];!0===d.matrixWorldAutoUpdate&&d.updateWorldMatrix(!1,!0)}}}toJSON(t){const n=void 0===t||"string"==typeof t,i={};n&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const a={};function c(d,p){return void 0===d[p.uuid]&&(d[p.uuid]=p.toJSON(t)),p.uuid}if(a.uuid=this.uuid,a.type=this.type,""!==this.name&&(a.name=this.name),!0===this.castShadow&&(a.castShadow=!0),!0===this.receiveShadow&&(a.receiveShadow=!0),!1===this.visible&&(a.visible=!1),!1===this.frustumCulled&&(a.frustumCulled=!1),0!==this.renderOrder&&(a.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(a.userData=this.userData),a.layers=this.layers.mask,a.matrix=this.matrix.toArray(),a.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(a.matrixAutoUpdate=!1),this.isInstancedMesh&&(a.type="InstancedMesh",a.count=this.count,a.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(a.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?a.background=this.background.toJSON():this.background.isTexture&&(a.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(a.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){a.geometry=c(t.geometries,this.geometry);const d=this.geometry.parameters;if(void 0!==d&&void 0!==d.shapes){const p=d.shapes;if(Array.isArray(p))for(let v=0,_=p.length;v<_;v++)c(t.shapes,p[v]);else c(t.shapes,p)}}if(this.isSkinnedMesh&&(a.bindMode=this.bindMode,a.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(c(t.skeletons,this.skeleton),a.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const d=[];for(let p=0,v=this.material.length;p<v;p++)d.push(c(t.materials,this.material[p]));a.material=d}else a.material=c(t.materials,this.material);if(this.children.length>0){a.children=[];for(let d=0;d<this.children.length;d++)a.children.push(this.children[d].toJSON(t).object)}if(this.animations.length>0){a.animations=[];for(let d=0;d<this.animations.length;d++)a.animations.push(c(t.animations,this.animations[d]))}if(n){const d=u(t.geometries),p=u(t.materials),v=u(t.textures),_=u(t.images),M=u(t.shapes),b=u(t.skeletons),A=u(t.animations),P=u(t.nodes);d.length>0&&(i.geometries=d),p.length>0&&(i.materials=p),v.length>0&&(i.textures=v),_.length>0&&(i.images=_),M.length>0&&(i.shapes=M),b.length>0&&(i.skeletons=b),A.length>0&&(i.animations=A),P.length>0&&(i.nodes=P)}return i.object=a,i;function u(d){const p=[];for(const v in d){const _=d[v];delete _.metadata,p.push(_)}return p}}clone(t){return(new this.constructor).copy(this,t)}copy(t,n=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),!0===n)for(let i=0;i<t.children.length;i++)this.add(t.children[i].clone());return this}}return o.DEFAULT_UP=new Q(0,1,0),o.DEFAULT_MATRIX_AUTO_UPDATE=!0,o.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,o})();const Sa=new Q,Fl=new Q,jm=new Q,Nl=new Q,hu=new Q,yc=new Q,$m=new Q,yd=new Q,Xm=new Q,qm=new Q;let _d=!1;class ao{constructor(e=new Q,t=new Q,n=new Q){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,i){i.subVectors(n,t),Sa.subVectors(e,t),i.cross(Sa);const a=i.lengthSq();return a>0?i.multiplyScalar(1/Math.sqrt(a)):i.set(0,0,0)}static getBarycoord(e,t,n,i,a){Sa.subVectors(i,t),Fl.subVectors(n,t),jm.subVectors(e,t);const c=Sa.dot(Sa),u=Sa.dot(Fl),d=Sa.dot(jm),p=Fl.dot(Fl),v=Fl.dot(jm),_=c*p-u*u;if(0===_)return a.set(-2,-1,-1);const M=1/_,b=(p*d-u*v)*M,A=(c*v-u*d)*M;return a.set(1-b-A,A,b)}static containsPoint(e,t,n,i){return this.getBarycoord(e,t,n,i,Nl),Nl.x>=0&&Nl.y>=0&&Nl.x+Nl.y<=1}static getUV(e,t,n,i,a,c,u,d){return!1===_d&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),_d=!0),this.getInterpolation(e,t,n,i,a,c,u,d)}static getInterpolation(e,t,n,i,a,c,u,d){return this.getBarycoord(e,t,n,i,Nl),d.setScalar(0),d.addScaledVector(a,Nl.x),d.addScaledVector(c,Nl.y),d.addScaledVector(u,Nl.z),d}static isFrontFacing(e,t,n,i){return Sa.subVectors(n,t),Fl.subVectors(e,t),Sa.cross(Fl).dot(i)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,i){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,n,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,i),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Sa.subVectors(this.c,this.b),Fl.subVectors(this.a,this.b),.5*Sa.cross(Fl).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return ao.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return ao.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,n,i,a){return!1===_d&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),_d=!0),ao.getInterpolation(e,this.a,this.b,this.c,t,n,i,a)}getInterpolation(e,t,n,i,a){return ao.getInterpolation(e,this.a,this.b,this.c,t,n,i,a)}containsPoint(e){return ao.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return ao.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,i=this.b,a=this.c;let c,u;hu.subVectors(i,n),yc.subVectors(a,n),yd.subVectors(e,n);const d=hu.dot(yd),p=yc.dot(yd);if(d<=0&&p<=0)return t.copy(n);Xm.subVectors(e,i);const v=hu.dot(Xm),_=yc.dot(Xm);if(v>=0&&_<=v)return t.copy(i);const M=d*_-v*p;if(M<=0&&d>=0&&v<=0)return c=d/(d-v),t.copy(n).addScaledVector(hu,c);qm.subVectors(e,a);const b=hu.dot(qm),A=yc.dot(qm);if(A>=0&&b<=A)return t.copy(a);const P=b*p-d*A;if(P<=0&&p>=0&&A<=0)return u=p/(p-A),t.copy(n).addScaledVector(yc,u);const R=v*A-b*_;if(R<=0&&_-v>=0&&b-A>=0)return $m.subVectors(a,i),u=(_-v)/(_-v+(b-A)),t.copy(i).addScaledVector($m,u);const T=1/(R+P+M);return c=P*T,u=M*T,t.copy(n).addScaledVector(hu,c).addScaledVector(yc,u)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let du=0;class lo extends Rl{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:du++}),this.uuid=Hr(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=E,this.stencilZFail=E,this.stencilZPass=E,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const n=e[t];if(void 0===n){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const i=this[t];void 0!==i?i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[t]=n:console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function i(a){const c=[];for(const u in a){const d=a[u];delete d.metadata,c.push(d)}return c}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(n.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),0!==this.side&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaHash&&(n.alphaHash=this.alphaHash),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.forceSinglePass&&(n.forceSinglePass=this.forceSinglePass),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),t){const a=i(e.textures),c=i(e.images);a.length>0&&(n.textures=a),c.length>0&&(n.images=c)}return n}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(null!==t){const i=t.length;n=new Array(i);for(let a=0;a!==i;++a)n[a]=t[a].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}const Ym={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Aa={h:0,s:0,l:0},fu={h:0,s:0,l:0};function Zm(o,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?o+6*(e-o)*t:t<.5?e:t<2/3?o+6*(e-o)*(2/3-t):o}class ut{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(void 0===t&&void 0===n){const i=e;i&&i.isColor?this.copy(i):"number"==typeof i?this.setHex(i):"string"==typeof i&&this.setStyle(i)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=vn){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,Ys.toWorkingColorSpace(this,t),this}setRGB(e,t,n,i=Ys.workingColorSpace){return this.r=e,this.g=t,this.b=n,Ys.toWorkingColorSpace(this,i),this}setHSL(e,t,n,i=Ys.workingColorSpace){if(e=dr(e,1),t=Ki(t,0,1),n=Ki(n,0,1),0===t)this.r=this.g=this.b=n;else{const a=n<=.5?n*(1+t):n+t-n*t,c=2*n-a;this.r=Zm(c,a,e+1/3),this.g=Zm(c,a,e),this.b=Zm(c,a,e-1/3)}return Ys.toWorkingColorSpace(this,i),this}setStyle(e,t=vn){function n(a){void 0!==a&&parseFloat(a)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(e)){let a;const u=i[2];switch(i[1]){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return n(a[4]),this.setRGB(Math.min(255,parseInt(a[1],10))/255,Math.min(255,parseInt(a[2],10))/255,Math.min(255,parseInt(a[3],10))/255,t);if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return n(a[4]),this.setRGB(Math.min(100,parseInt(a[1],10))/100,Math.min(100,parseInt(a[2],10))/100,Math.min(100,parseInt(a[3],10))/100,t);break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return n(a[4]),this.setHSL(parseFloat(a[1])/360,parseFloat(a[2])/100,parseFloat(a[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){const a=i[1],c=a.length;if(3===c)return this.setRGB(parseInt(a.charAt(0),16)/15,parseInt(a.charAt(1),16)/15,parseInt(a.charAt(2),16)/15,t);if(6===c)return this.setHex(parseInt(a,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=vn){const n=Ym[e.toLowerCase()];return void 0!==n?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=el(e.r),this.g=el(e.g),this.b=el(e.b),this}copyLinearToSRGB(e){return this.r=ud(e.r),this.g=ud(e.g),this.b=ud(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=vn){return Ys.fromWorkingColorSpace(As.copy(this),e),65536*Math.round(Ki(255*As.r,0,255))+256*Math.round(Ki(255*As.g,0,255))+Math.round(Ki(255*As.b,0,255))}getHexString(e=vn){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Ys.workingColorSpace){Ys.fromWorkingColorSpace(As.copy(this),t);const n=As.r,i=As.g,a=As.b,c=Math.max(n,i,a),u=Math.min(n,i,a);let d,p;const v=(u+c)/2;if(u===c)d=0,p=0;else{const _=c-u;switch(p=v<=.5?_/(c+u):_/(2-c-u),c){case n:d=(i-a)/_+(i<a?6:0);break;case i:d=(a-n)/_+2;break;case a:d=(n-i)/_+4}d/=6}return e.h=d,e.s=p,e.l=v,e}getRGB(e,t=Ys.workingColorSpace){return Ys.fromWorkingColorSpace(As.copy(this),t),e.r=As.r,e.g=As.g,e.b=As.b,e}getStyle(e=vn){Ys.fromWorkingColorSpace(As.copy(this),e);const t=As.r,n=As.g,i=As.b;return e!==vn?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*n)},${Math.round(255*i)})`}offsetHSL(e,t,n){return this.getHSL(Aa),Aa.h+=e,Aa.s+=t,Aa.l+=n,this.setHSL(Aa.h,Aa.s,Aa.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(Aa),e.getHSL(fu);const n=Of(Aa.h,fu.h,t),i=Of(Aa.s,fu.s,t),a=Of(Aa.l,fu.l,t);return this.setHSL(n,i,a),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,i=this.b,a=e.elements;return this.r=a[0]*t+a[3]*n+a[6]*i,this.g=a[1]*t+a[4]*n+a[7]*i,this.b=a[2]*t+a[5]*n+a[8]*i,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const As=new ut;ut.NAMES=Ym;class Ts extends lo{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new ut(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Mr=new Q,lh=new Be;class sr{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=n,this.usage=35044,this.updateRange={offset:0,count:-1},this.gpuType=Tn,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let i=0,a=this.itemSize;i<a;i++)this.array[e+i]=t.array[n+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)lh.fromBufferAttribute(this,t),lh.applyMatrix3(e),this.setXY(t,lh.x,lh.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)Mr.fromBufferAttribute(this,t),Mr.applyMatrix3(e),this.setXYZ(t,Mr.x,Mr.y,Mr.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)Mr.fromBufferAttribute(this,t),Mr.applyMatrix4(e),this.setXYZ(t,Mr.x,Mr.y,Mr.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Mr.fromBufferAttribute(this,t),Mr.applyNormalMatrix(e),this.setXYZ(t,Mr.x,Mr.y,Mr.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Mr.fromBufferAttribute(this,t),Mr.transformDirection(e),this.setXYZ(t,Mr.x,Mr.y,Mr.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=Kr(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Yn(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Kr(t,this.array)),t}setX(e,t){return this.normalized&&(t=Yn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Kr(t,this.array)),t}setY(e,t){return this.normalized&&(t=Yn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Kr(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Yn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Kr(t,this.array)),t}setW(e,t){return this.normalized&&(t=Yn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Yn(t,this.array),n=Yn(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,i){return e*=this.itemSize,this.normalized&&(t=Yn(t,this.array),n=Yn(n,this.array),i=Yn(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this}setXYZW(e,t,n,i,a){return e*=this.itemSize,this.normalized&&(t=Yn(t,this.array),n=Yn(n,this.array),i=Yn(i,this.array),a=Yn(a,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this.array[e+3]=a,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}}class Km extends sr{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class qf extends sr{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class qt extends sr{constructor(e,t,n){super(new Float32Array(e),t,n)}}let Ux=0;const Zo=new Yt,my=new xr,uh=new Q,Us=new tl,pu=new tl,Jr=new Q;class Un extends Rl{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Ux++}),this.uuid=Hr(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(ly(e)?qf:Km)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const a=(new Zn).getNormalMatrix(e);n.applyNormalMatrix(a),n.needsUpdate=!0}const i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(e),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return Zo.makeRotationFromQuaternion(e),this.applyMatrix4(Zo),this}rotateX(e){return Zo.makeRotationX(e),this.applyMatrix4(Zo),this}rotateY(e){return Zo.makeRotationY(e),this.applyMatrix4(Zo),this}rotateZ(e){return Zo.makeRotationZ(e),this.applyMatrix4(Zo),this}translate(e,t,n){return Zo.makeTranslation(e,t,n),this.applyMatrix4(Zo),this}scale(e,t,n){return Zo.makeScale(e,t,n),this.applyMatrix4(Zo),this}lookAt(e){return my.lookAt(e),my.updateMatrix(),this.applyMatrix4(my.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(uh).negate(),this.translate(uh.x,uh.y,uh.z),this}setFromPoints(e){const t=[];for(let n=0,i=e.length;n<i;n++){const a=e[n];t.push(a.x,a.y,a.z||0)}return this.setAttribute("position",new qt(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new tl);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new Q(-1/0,-1/0,-1/0),new Q(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,i=t.length;n<i;n++)Us.setFromBufferAttribute(t[n]),this.morphTargetsRelative?(Jr.addVectors(this.boundingBox.min,Us.min),this.boundingBox.expandByPoint(Jr),Jr.addVectors(this.boundingBox.max,Us.max),this.boundingBox.expandByPoint(Jr)):(this.boundingBox.expandByPoint(Us.min),this.boundingBox.expandByPoint(Us.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Yo);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new Q,1/0);if(e){const n=this.boundingSphere.center;if(Us.setFromBufferAttribute(e),t)for(let a=0,c=t.length;a<c;a++)pu.setFromBufferAttribute(t[a]),this.morphTargetsRelative?(Jr.addVectors(Us.min,pu.min),Us.expandByPoint(Jr),Jr.addVectors(Us.max,pu.max),Us.expandByPoint(Jr)):(Us.expandByPoint(pu.min),Us.expandByPoint(pu.max));Us.getCenter(n);let i=0;for(let a=0,c=e.count;a<c;a++)Jr.fromBufferAttribute(e,a),i=Math.max(i,n.distanceToSquared(Jr));if(t)for(let a=0,c=t.length;a<c;a++){const u=t[a],d=this.morphTargetsRelative;for(let p=0,v=u.count;p<v;p++)Jr.fromBufferAttribute(u,p),d&&(uh.fromBufferAttribute(e,p),Jr.add(uh)),i=Math.max(i,n.distanceToSquared(Jr))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=e.array,i=t.position.array,a=t.normal.array,c=t.uv.array,u=i.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new sr(new Float32Array(4*u),4));const d=this.getAttribute("tangent").array,p=[],v=[];for(let K=0;K<u;K++)p[K]=new Q,v[K]=new Q;const _=new Q,M=new Q,b=new Q,A=new Be,P=new Be,R=new Be,T=new Q,U=new Q;function F(K,Me,De){_.fromArray(i,3*K),M.fromArray(i,3*Me),b.fromArray(i,3*De),A.fromArray(c,2*K),P.fromArray(c,2*Me),R.fromArray(c,2*De),M.sub(_),b.sub(_),P.sub(A),R.sub(A);const me=1/(P.x*R.y-R.x*P.y);!isFinite(me)||(T.copy(M).multiplyScalar(R.y).addScaledVector(b,-P.y).multiplyScalar(me),U.copy(b).multiplyScalar(P.x).addScaledVector(M,-R.x).multiplyScalar(me),p[K].add(T),p[Me].add(T),p[De].add(T),v[K].add(U),v[Me].add(U),v[De].add(U))}let V=this.groups;0===V.length&&(V=[{start:0,count:n.length}]);for(let K=0,Me=V.length;K<Me;++K){const De=V[K],me=De.start;for(let xe=me,Ne=me+De.count;xe<Ne;xe+=3)F(n[xe+0],n[xe+1],n[xe+2])}const X=new Q,Z=new Q,q=new Q,ee=new Q;function j(K){q.fromArray(a,3*K),ee.copy(q);const Me=p[K];X.copy(Me),X.sub(q.multiplyScalar(q.dot(Me))).normalize(),Z.crossVectors(ee,Me);const me=Z.dot(v[K])<0?-1:1;d[4*K]=X.x,d[4*K+1]=X.y,d[4*K+2]=X.z,d[4*K+3]=me}for(let K=0,Me=V.length;K<Me;++K){const De=V[K],me=De.start;for(let xe=me,Ne=me+De.count;xe<Ne;xe+=3)j(n[xe+0]),j(n[xe+1]),j(n[xe+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new sr(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let M=0,b=n.count;M<b;M++)n.setXYZ(M,0,0,0);const i=new Q,a=new Q,c=new Q,u=new Q,d=new Q,p=new Q,v=new Q,_=new Q;if(e)for(let M=0,b=e.count;M<b;M+=3){const A=e.getX(M+0),P=e.getX(M+1),R=e.getX(M+2);i.fromBufferAttribute(t,A),a.fromBufferAttribute(t,P),c.fromBufferAttribute(t,R),v.subVectors(c,a),_.subVectors(i,a),v.cross(_),u.fromBufferAttribute(n,A),d.fromBufferAttribute(n,P),p.fromBufferAttribute(n,R),u.add(v),d.add(v),p.add(v),n.setXYZ(A,u.x,u.y,u.z),n.setXYZ(P,d.x,d.y,d.z),n.setXYZ(R,p.x,p.y,p.z)}else for(let M=0,b=t.count;M<b;M+=3)i.fromBufferAttribute(t,M+0),a.fromBufferAttribute(t,M+1),c.fromBufferAttribute(t,M+2),v.subVectors(c,a),_.subVectors(i,a),v.cross(_),n.setXYZ(M+0,v.x,v.y,v.z),n.setXYZ(M+1,v.x,v.y,v.z),n.setXYZ(M+2,v.x,v.y,v.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Jr.fromBufferAttribute(e,t),Jr.normalize(),e.setXYZ(t,Jr.x,Jr.y,Jr.z)}toNonIndexed(){function e(u,d){const p=u.array,v=u.itemSize,_=u.normalized,M=new p.constructor(d.length*v);let b=0,A=0;for(let P=0,R=d.length;P<R;P++){b=u.isInterleavedBufferAttribute?d[P]*u.data.stride+u.offset:d[P]*v;for(let T=0;T<v;T++)M[A++]=p[b++]}return new sr(M,v,_)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Un,n=this.index.array,i=this.attributes;for(const u in i){const p=e(i[u],n);t.setAttribute(u,p)}const a=this.morphAttributes;for(const u in a){const d=[],p=a[u];for(let v=0,_=p.length;v<_;v++){const b=e(p[v],n);d.push(b)}t.morphAttributes[u]=d}t.morphTargetsRelative=this.morphTargetsRelative;const c=this.groups;for(let u=0,d=c.length;u<d;u++){const p=c[u];t.addGroup(p.start,p.count,p.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const d=this.parameters;for(const p in d)void 0!==d[p]&&(e[p]=d[p]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const d in n)e.data.attributes[d]=n[d].toJSON(e.data);const i={};let a=!1;for(const d in this.morphAttributes){const p=this.morphAttributes[d],v=[];for(let _=0,M=p.length;_<M;_++)v.push(p[_].toJSON(e.data));v.length>0&&(i[d]=v,a=!0)}a&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const c=this.groups;c.length>0&&(e.data.groups=JSON.parse(JSON.stringify(c)));const u=this.boundingSphere;return null!==u&&(e.data.boundingSphere={center:u.center.toArray(),radius:u.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone(t));const i=e.attributes;for(const p in i)this.setAttribute(p,i[p].clone(t));const a=e.morphAttributes;for(const p in a){const v=[],_=a[p];for(let M=0,b=_.length;M<b;M++)v.push(_[M].clone(t));this.morphAttributes[p]=v}this.morphTargetsRelative=e.morphTargetsRelative;const c=e.groups;for(let p=0,v=c.length;p<v;p++){const _=c[p];this.addGroup(_.start,_.count,_.materialIndex)}const u=e.boundingBox;null!==u&&(this.boundingBox=u.clone());const d=e.boundingSphere;return null!==d&&(this.boundingSphere=d.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const Qm=new Yt,Ro=new rh,Yf=new Yo,gy=new Q,hh=new Q,dh=new Q,fh=new Q,Ca=new Q,kl=new Q,xd=new Be,Zf=new Be,Kf=new Be,vy=new Q,yy=new Q,_y=new Q,Md=new Q,Jf=new Q;class Ji extends xr{constructor(e=new Un,t=new Ts){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const i=t[n[0]];if(void 0!==i){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,c=i.length;a<c;a++){const u=i[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=a}}}}getVertexPosition(e,t){const n=this.geometry,a=n.morphAttributes.position,c=n.morphTargetsRelative;t.fromBufferAttribute(n.attributes.position,e);const u=this.morphTargetInfluences;if(a&&u){kl.set(0,0,0);for(let d=0,p=a.length;d<p;d++){const v=u[d],_=a[d];0!==v&&(Ca.fromBufferAttribute(_,e),kl.addScaledVector(c?Ca:Ca.sub(t),v))}t.add(kl)}return t}raycast(e,t){const n=this.geometry,a=this.matrixWorld;void 0!==this.material&&(null===n.boundingSphere&&n.computeBoundingSphere(),Yf.copy(n.boundingSphere),Yf.applyMatrix4(a),Ro.copy(e.ray).recast(e.near),(!1!==Yf.containsPoint(Ro.origin)||!(null===Ro.intersectSphere(Yf,gy)||Ro.origin.distanceToSquared(gy)>(e.far-e.near)**2))&&(Qm.copy(a).invert(),Ro.copy(e.ray).applyMatrix4(Qm),(null===n.boundingBox||!1!==Ro.intersectsBox(n.boundingBox))&&this._computeIntersections(e,t,Ro)))}_computeIntersections(e,t,n){let i;const a=this.geometry,c=this.material,u=a.index,d=a.attributes.position,p=a.attributes.uv,v=a.attributes.uv1,_=a.attributes.normal,M=a.groups,b=a.drawRange;if(null!==u)if(Array.isArray(c))for(let A=0,P=M.length;A<P;A++){const R=M[A],T=c[R.materialIndex];for(let V=Math.max(R.start,b.start),X=Math.min(u.count,Math.min(R.start+R.count,b.start+b.count));V<X;V+=3)i=Qf(this,T,e,n,p,v,_,u.getX(V),u.getX(V+1),u.getX(V+2)),i&&(i.faceIndex=Math.floor(V/3),i.face.materialIndex=R.materialIndex,t.push(i))}else for(let R=Math.max(0,b.start),T=Math.min(u.count,b.start+b.count);R<T;R+=3)i=Qf(this,c,e,n,p,v,_,u.getX(R),u.getX(R+1),u.getX(R+2)),i&&(i.faceIndex=Math.floor(R/3),t.push(i));else if(void 0!==d)if(Array.isArray(c))for(let A=0,P=M.length;A<P;A++){const R=M[A],T=c[R.materialIndex];for(let V=Math.max(R.start,b.start),X=Math.min(d.count,Math.min(R.start+R.count,b.start+b.count));V<X;V+=3)i=Qf(this,T,e,n,p,v,_,V,V+1,V+2),i&&(i.faceIndex=Math.floor(V/3),i.face.materialIndex=R.materialIndex,t.push(i))}else for(let R=Math.max(0,b.start),T=Math.min(d.count,b.start+b.count);R<T;R+=3)i=Qf(this,c,e,n,p,v,_,R,R+1,R+2),i&&(i.faceIndex=Math.floor(R/3),t.push(i))}}function Qf(o,e,t,n,i,a,c,u,d,p){o.getVertexPosition(u,hh),o.getVertexPosition(d,dh),o.getVertexPosition(p,fh);const v=function Bx(o,e,t,n,i,a,c,u){let d;if(d=1===e.side?n.intersectTriangle(c,a,i,!0,u):n.intersectTriangle(i,a,c,0===e.side,u),null===d)return null;Jf.copy(u),Jf.applyMatrix4(o.matrixWorld);const p=t.ray.origin.distanceTo(Jf);return p<t.near||p>t.far?null:{distance:p,point:Jf.clone(),object:o}}(o,e,t,n,hh,dh,fh,Md);if(v){i&&(xd.fromBufferAttribute(i,u),Zf.fromBufferAttribute(i,d),Kf.fromBufferAttribute(i,p),v.uv=ao.getInterpolation(Md,hh,dh,fh,xd,Zf,Kf,new Be)),a&&(xd.fromBufferAttribute(a,u),Zf.fromBufferAttribute(a,d),Kf.fromBufferAttribute(a,p),v.uv1=ao.getInterpolation(Md,hh,dh,fh,xd,Zf,Kf,new Be),v.uv2=v.uv1),c&&(vy.fromBufferAttribute(c,u),yy.fromBufferAttribute(c,d),_y.fromBufferAttribute(c,p),v.normal=ao.getInterpolation(Md,hh,dh,fh,vy,yy,_y,new Q),v.normal.dot(n.direction)>0&&v.normal.multiplyScalar(-1));const _={a:u,b:d,c:p,normal:new Q,materialIndex:0};ao.getNormal(hh,dh,fh,_.normal),v.face=_}return v}class ph extends Un{constructor(e=1,t=1,n=1,i=1,a=1,c=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:i,heightSegments:a,depthSegments:c};const u=this;i=Math.floor(i),a=Math.floor(a),c=Math.floor(c);const d=[],p=[],v=[],_=[];let M=0,b=0;function A(P,R,T,U,F,V,X,Z,q,ee,j){const K=V/q,Me=X/ee,De=V/2,me=X/2,pe=Z/2,xe=q+1,Ne=ee+1;let Pe=0,ze=0;const $e=new Q;for(let Ke=0;Ke<Ne;Ke++){const _e=Ke*Me-me;for(let He=0;He<xe;He++)$e[P]=(He*K-De)*U,$e[R]=_e*F,$e[T]=pe,p.push($e.x,$e.y,$e.z),$e[P]=0,$e[R]=0,$e[T]=Z>0?1:-1,v.push($e.x,$e.y,$e.z),_.push(He/q),_.push(1-Ke/ee),Pe+=1}for(let Ke=0;Ke<ee;Ke++)for(let _e=0;_e<q;_e++){const ft=M+_e+xe*(Ke+1),ht=M+(_e+1)+xe*(Ke+1),pt=M+(_e+1)+xe*Ke;d.push(M+_e+xe*Ke,ft,pt),d.push(ft,ht,pt),ze+=6}u.addGroup(b,ze,j),b+=ze,M+=Pe}A("z","y","x",-1,-1,n,t,e,c,a,0),A("z","y","x",1,-1,n,t,-e,c,a,1),A("x","z","y",1,1,e,n,t,i,c,2),A("x","z","y",1,-1,e,n,-t,i,c,3),A("x","y","z",1,-1,e,t,n,i,a,4),A("x","y","z",-1,-1,e,t,-n,i,a,5),this.setIndex(d),this.setAttribute("position",new qt(p,3)),this.setAttribute("normal",new qt(v,3)),this.setAttribute("uv",new qt(_,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ph(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function mh(o){const e={};for(const t in o){e[t]={};for(const n in o[t]){const i=o[t][n];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=i.clone():e[t][n]=Array.isArray(i)?i.slice():i}}return e}function Qr(o){const e={};for(let t=0;t<o.length;t++){const n=mh(o[t]);for(const i in n)e[i]=n[i]}return e}function Da(o){return null===o.getRenderTarget()?o.outputColorSpace:ls}const xc={clone:mh,merge:Qr};class es extends lo{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=mh(e.uniforms),this.uniformsGroups=function xy(o){const e=[];for(let t=0;t<o.length;t++)e.push(o[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const c=this.uniforms[i].value;t.uniforms[i]=c&&c.isTexture?{type:"t",value:c.toJSON(e).uuid}:c&&c.isColor?{type:"c",value:c.getHex()}:c&&c.isVector2?{type:"v2",value:c.toArray()}:c&&c.isVector3?{type:"v3",value:c.toArray()}:c&&c.isVector4?{type:"v4",value:c.toArray()}:c&&c.isMatrix3?{type:"m3",value:c.toArray()}:c&&c.isMatrix4?{type:"m4",value:c.toArray()}:{value:c}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const i in this.extensions)!0===this.extensions[i]&&(n[i]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class wy extends xr{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Yt,this.projectionMatrix=new Yt,this.projectionMatrixInverse=new Yt,this.coordinateSystem=qs}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class ts extends wy{constructor(e=50,t=1,n=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*Qu*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*$o*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Qu*Math.atan(Math.tan(.5*$o*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,n,i,a,c){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=a,this.view.height=c,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*$o*this.fov)/this.zoom,n=2*t,i=this.aspect*n,a=-.5*i;const c=this.view;if(null!==this.view&&this.view.enabled){const d=c.fullWidth,p=c.fullHeight;a+=c.offsetX*i/d,t-=c.offsetY*n/p,i*=c.width/d,n*=c.height/p}const u=this.filmOffset;0!==u&&(a+=e*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+i,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class eg extends xr{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null;const i=new ts(-90,1,e,t);i.layers=this.layers,this.add(i);const a=new ts(-90,1,e,t);a.layers=this.layers,this.add(a);const c=new ts(-90,1,e,t);c.layers=this.layers,this.add(c);const u=new ts(-90,1,e,t);u.layers=this.layers,this.add(u);const d=new ts(-90,1,e,t);d.layers=this.layers,this.add(d);const p=new ts(-90,1,e,t);p.layers=this.layers,this.add(p)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,i,a,c,u,d]=t;for(const p of t)this.remove(p);if(e===qs)n.up.set(0,1,0),n.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),a.up.set(0,0,-1),a.lookAt(0,1,0),c.up.set(0,0,1),c.lookAt(0,-1,0),u.up.set(0,1,0),u.lookAt(0,0,1),d.up.set(0,1,0),d.lookAt(0,0,-1);else{if(2001!==e)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);n.up.set(0,-1,0),n.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),a.up.set(0,0,1),a.lookAt(0,1,0),c.up.set(0,0,-1),c.lookAt(0,-1,0),u.up.set(0,-1,0),u.lookAt(0,0,1),d.up.set(0,-1,0),d.lookAt(0,0,-1)}for(const p of t)this.add(p),p.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const n=this.renderTarget;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[i,a,c,u,d,p]=this.children,v=e.getRenderTarget(),_=e.xr.enabled;e.xr.enabled=!1;const M=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,i),e.setRenderTarget(n,1),e.render(t,a),e.setRenderTarget(n,2),e.render(t,c),e.setRenderTarget(n,3),e.render(t,u),e.setRenderTarget(n,4),e.render(t,d),n.texture.generateMipmaps=M,e.setRenderTarget(n,5),e.render(t,p),e.setRenderTarget(v),e.xr.enabled=_,n.texture.needsPMREMUpdate=!0}}class gh extends Ss{constructor(e,t,n,i,a,c,u,d,p,v){super(e=void 0!==e?e:[],t=void 0!==t?t:301,n,i,a,c,u,d,p,v),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class bE extends ba{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},i=[n,n,n,n,n,n];void 0!==t.encoding&&(Nf("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===xa?vn:""),this.texture=new gh(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:Ii}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n_uniforms={tEquirect:{value:null}},n_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",n_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",i=new ph(5,5,5),a=new es({name:"CubemapFromEquirect",uniforms:mh(n_uniforms),vertexShader:n_vertexShader,fragmentShader:n_fragmentShader,side:1,blending:0});a.uniforms.tEquirect.value=t;const c=new Ji(i,a),u=t.minFilter;return t.minFilter===Ms&&(t.minFilter=Ii),new eg(1,10,this).update(e,c),t.minFilter=u,c.geometry.dispose(),c.material.dispose(),this}clear(e,t,n,i){const a=e.getRenderTarget();for(let c=0;c<6;c++)e.setRenderTarget(this,c),e.clear(t,n,i);e.setRenderTarget(a)}}const Ey=new Q,Sy=new Q,Vx=new Zn;class bc{constructor(e=new Q(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,i){return this.normal.set(e,t,n),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const i=Ey.subVectors(n,t).cross(Sy.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(Ey),i=this.normal.dot(n);if(0===i)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const a=-(e.start.dot(this.normal)+this.constant)/i;return a<0||a>1?null:t.copy(e.start).addScaledVector(n,a)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||Vx.getNormalMatrix(e),i=this.coplanarPoint(Ey).applyMatrix4(e),a=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(a),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const mu=new Yo,ep=new Q;class tp{constructor(e=new bc,t=new bc,n=new bc,i=new bc,a=new bc,c=new bc){this.planes=[e,t,n,i,a,c]}set(e,t,n,i,a,c){const u=this.planes;return u[0].copy(e),u[1].copy(t),u[2].copy(n),u[3].copy(i),u[4].copy(a),u[5].copy(c),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=qs){const n=this.planes,i=e.elements,a=i[0],c=i[1],u=i[2],d=i[3],p=i[4],v=i[5],_=i[6],M=i[7],b=i[8],A=i[9],P=i[10],R=i[11],T=i[12],U=i[13],F=i[14],V=i[15];if(n[0].setComponents(d-a,M-p,R-b,V-T).normalize(),n[1].setComponents(d+a,M+p,R+b,V+T).normalize(),n[2].setComponents(d+c,M+v,R+A,V+U).normalize(),n[3].setComponents(d-c,M-v,R-A,V-U).normalize(),n[4].setComponents(d-u,M-_,R-P,V-F).normalize(),t===qs)n[5].setComponents(d+u,M+_,R+P,V+F).normalize();else{if(2001!==t)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);n[5].setComponents(u,_,P,F).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),mu.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),mu.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(mu)}intersectsSprite(e){return mu.center.set(0,0,0),mu.radius=.7071067811865476,mu.applyMatrix4(e.matrixWorld),this.intersectsSphere(mu)}intersectsSphere(e){const t=this.planes,n=e.center,i=-e.radius;for(let a=0;a<6;a++)if(t[a].distanceToPoint(n)<i)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const i=t[n];if(ep.x=i.normal.x>0?e.max.x:e.min.x,ep.y=i.normal.y>0?e.max.y:e.min.y,ep.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(ep)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function wd(){let o=null,e=!1,t=null,n=null;function i(a,c){t(a,c),n=o.requestAnimationFrame(i)}return{start:function(){!0!==e&&null!==t&&(n=o.requestAnimationFrame(i),e=!0)},stop:function(){o.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(a){t=a},setContext:function(a){o=a}}}function Ay(o,e){const t=e.isWebGL2,n=new WeakMap;return{get:function c(p){return p.isInterleavedBufferAttribute&&(p=p.data),n.get(p)},remove:function u(p){p.isInterleavedBufferAttribute&&(p=p.data);const v=n.get(p);v&&(o.deleteBuffer(v.buffer),n.delete(p))},update:function d(p,v){if(p.isGLBufferAttribute){const M=n.get(p);return void((!M||M.version<p.version)&&n.set(p,{buffer:p.buffer,type:p.type,bytesPerElement:p.elementSize,version:p.version}))}p.isInterleavedBufferAttribute&&(p=p.data);const _=n.get(p);void 0===_?n.set(p,function i(p,v){const _=p.array,M=p.usage,b=o.createBuffer();let A;if(o.bindBuffer(v,b),o.bufferData(v,_,M),p.onUploadCallback(),_ instanceof Float32Array)A=o.FLOAT;else if(_ instanceof Uint16Array)if(p.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");A=o.HALF_FLOAT}else A=o.UNSIGNED_SHORT;else if(_ instanceof Int16Array)A=o.SHORT;else if(_ instanceof Uint32Array)A=o.UNSIGNED_INT;else if(_ instanceof Int32Array)A=o.INT;else if(_ instanceof Int8Array)A=o.BYTE;else if(_ instanceof Uint8Array)A=o.UNSIGNED_BYTE;else{if(!(_ instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+_);A=o.UNSIGNED_BYTE}return{buffer:b,type:A,bytesPerElement:_.BYTES_PER_ELEMENT,version:p.version}}(p,v)):_.version<p.version&&(function a(p,v,_){const M=v.array,b=v.updateRange;o.bindBuffer(_,p),-1===b.count?o.bufferSubData(_,0,M):(t?o.bufferSubData(_,b.offset*M.BYTES_PER_ELEMENT,M,b.offset,b.count):o.bufferSubData(_,b.offset*M.BYTES_PER_ELEMENT,M.subarray(b.offset,b.offset+b.count)),b.count=-1),v.onUploadCallback()}(_.buffer,p,v),_.version=p.version)}}}class Ul extends Un{constructor(e=1,t=1,n=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i};const a=e/2,c=t/2,u=Math.floor(n),d=Math.floor(i),p=u+1,v=d+1,_=e/u,M=t/d,b=[],A=[],P=[],R=[];for(let T=0;T<v;T++){const U=T*M-c;for(let F=0;F<p;F++)A.push(F*_-a,-U,0),P.push(0,0,1),R.push(F/u),R.push(1-T/d)}for(let T=0;T<d;T++)for(let U=0;U<u;U++){const V=U+p*(T+1),X=U+1+p*(T+1),Z=U+1+p*T;b.push(U+p*T,V,Z),b.push(V,X,Z)}this.setIndex(b),this.setAttribute("position",new qt(A,3)),this.setAttribute("normal",new qt(P,3)),this.setAttribute("uv",new qt(R,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ul(e.width,e.height,e.widthSegments,e.heightSegments)}}const Kn={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tanisotropyV /= material.anisotropy;\n\tmaterial.anisotropy = saturate( material.anisotropy );\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometry.viewDir, geometry.normal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, vMapUv );\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},Vt={common:{diffuse:{value:new ut(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Zn},alphaMap:{value:null},alphaMapTransform:{value:new Zn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Zn}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Zn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Zn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Zn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Zn},normalScale:{value:new Be(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Zn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Zn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Zn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Zn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ut(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new ut(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Zn},alphaTest:{value:0},uvTransform:{value:new Zn}},sprite:{diffuse:{value:new ut(16777215)},opacity:{value:1},center:{value:new Be(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Zn},alphaMap:{value:null},alphaMapTransform:{value:new Zn},alphaTest:{value:0}}},Vl={basic:{uniforms:Qr([Vt.common,Vt.specularmap,Vt.envmap,Vt.aomap,Vt.lightmap,Vt.fog]),vertexShader:Kn.meshbasic_vert,fragmentShader:Kn.meshbasic_frag},lambert:{uniforms:Qr([Vt.common,Vt.specularmap,Vt.envmap,Vt.aomap,Vt.lightmap,Vt.emissivemap,Vt.bumpmap,Vt.normalmap,Vt.displacementmap,Vt.fog,Vt.lights,{emissive:{value:new ut(0)}}]),vertexShader:Kn.meshlambert_vert,fragmentShader:Kn.meshlambert_frag},phong:{uniforms:Qr([Vt.common,Vt.specularmap,Vt.envmap,Vt.aomap,Vt.lightmap,Vt.emissivemap,Vt.bumpmap,Vt.normalmap,Vt.displacementmap,Vt.fog,Vt.lights,{emissive:{value:new ut(0)},specular:{value:new ut(1118481)},shininess:{value:30}}]),vertexShader:Kn.meshphong_vert,fragmentShader:Kn.meshphong_frag},standard:{uniforms:Qr([Vt.common,Vt.envmap,Vt.aomap,Vt.lightmap,Vt.emissivemap,Vt.bumpmap,Vt.normalmap,Vt.displacementmap,Vt.roughnessmap,Vt.metalnessmap,Vt.fog,Vt.lights,{emissive:{value:new ut(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Kn.meshphysical_vert,fragmentShader:Kn.meshphysical_frag},toon:{uniforms:Qr([Vt.common,Vt.aomap,Vt.lightmap,Vt.emissivemap,Vt.bumpmap,Vt.normalmap,Vt.displacementmap,Vt.gradientmap,Vt.fog,Vt.lights,{emissive:{value:new ut(0)}}]),vertexShader:Kn.meshtoon_vert,fragmentShader:Kn.meshtoon_frag},matcap:{uniforms:Qr([Vt.common,Vt.bumpmap,Vt.normalmap,Vt.displacementmap,Vt.fog,{matcap:{value:null}}]),vertexShader:Kn.meshmatcap_vert,fragmentShader:Kn.meshmatcap_frag},points:{uniforms:Qr([Vt.points,Vt.fog]),vertexShader:Kn.points_vert,fragmentShader:Kn.points_frag},dashed:{uniforms:Qr([Vt.common,Vt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Kn.linedashed_vert,fragmentShader:Kn.linedashed_frag},depth:{uniforms:Qr([Vt.common,Vt.displacementmap]),vertexShader:Kn.depth_vert,fragmentShader:Kn.depth_frag},normal:{uniforms:Qr([Vt.common,Vt.bumpmap,Vt.normalmap,Vt.displacementmap,{opacity:{value:1}}]),vertexShader:Kn.meshnormal_vert,fragmentShader:Kn.meshnormal_frag},sprite:{uniforms:Qr([Vt.sprite,Vt.fog]),vertexShader:Kn.sprite_vert,fragmentShader:Kn.sprite_frag},background:{uniforms:{uvTransform:{value:new Zn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Kn.background_vert,fragmentShader:Kn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Kn.backgroundCube_vert,fragmentShader:Kn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Kn.cube_vert,fragmentShader:Kn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Kn.equirect_vert,fragmentShader:Kn.equirect_frag},distanceRGBA:{uniforms:Qr([Vt.common,Vt.displacementmap,{referencePosition:{value:new Q},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Kn.distanceRGBA_vert,fragmentShader:Kn.distanceRGBA_frag},shadow:{uniforms:Qr([Vt.lights,Vt.fog,{color:{value:new ut(0)},opacity:{value:1}}]),vertexShader:Kn.shadow_vert,fragmentShader:Kn.shadow_frag}};Vl.physical={uniforms:Qr([Vl.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Zn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Zn},clearcoatNormalScale:{value:new Be(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Zn},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Zn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Zn},sheen:{value:0},sheenColor:{value:new ut(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Zn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Zn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Zn},transmissionSamplerSize:{value:new Be},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Zn},attenuationDistance:{value:0},attenuationColor:{value:new ut(0)},specularColor:{value:new ut(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Zn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Zn},anisotropyVector:{value:new Be},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Zn}}]),vertexShader:Kn.meshphysical_vert,fragmentShader:Kn.meshphysical_frag};const Cd={r:0,b:0,g:0};function tS(o,e,t,n,i,a,c){const u=new ut(0);let p,v,d=!0===a?0:1,_=null,M=0,b=null;function P(R,T){R.getRGB(Cd,Da(o)),n.buffers.color.setClear(Cd.r,Cd.g,Cd.b,T,c)}return{getClearColor:function(){return u},setClearColor:function(R,T=1){u.set(R),d=T,P(u,d)},getClearAlpha:function(){return d},setClearAlpha:function(R){d=R,P(u,d)},render:function A(R,T){let U=!1,F=!0===T.isScene?T.background:null;switch(F&&F.isTexture&&(F=(T.backgroundBlurriness>0?t:e).get(F)),null===F?P(u,d):F&&F.isColor&&(P(F,1),U=!0),o.xr.getEnvironmentBlendMode()){case"opaque":U=!0;break;case"additive":n.buffers.color.setClear(0,0,0,1,c),U=!0;break;case"alpha-blend":n.buffers.color.setClear(0,0,0,0,c),U=!0}(o.autoClear||U)&&o.clear(o.autoClearColor,o.autoClearDepth,o.autoClearStencil),F&&(F.isCubeTexture||306===F.mapping)?(void 0===v&&(v=new Ji(new ph(1,1,1),new es({name:"BackgroundCubeMaterial",uniforms:mh(Vl.backgroundCube.uniforms),vertexShader:Vl.backgroundCube.vertexShader,fragmentShader:Vl.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),v.geometry.deleteAttribute("normal"),v.geometry.deleteAttribute("uv"),v.onBeforeRender=function(Z,q,ee){this.matrixWorld.copyPosition(ee.matrixWorld)},Object.defineProperty(v.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(v)),v.material.uniforms.envMap.value=F,v.material.uniforms.flipEnvMap.value=F.isCubeTexture&&!1===F.isRenderTargetTexture?-1:1,v.material.uniforms.backgroundBlurriness.value=T.backgroundBlurriness,v.material.uniforms.backgroundIntensity.value=T.backgroundIntensity,v.material.toneMapped=F.colorSpace!==vn,(_!==F||M!==F.version||b!==o.toneMapping)&&(v.material.needsUpdate=!0,_=F,M=F.version,b=o.toneMapping),v.layers.enableAll(),R.unshift(v,v.geometry,v.material,0,0,null)):F&&F.isTexture&&(void 0===p&&(p=new Ji(new Ul(2,2),new es({name:"BackgroundMaterial",uniforms:mh(Vl.background.uniforms),vertexShader:Vl.background.vertexShader,fragmentShader:Vl.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),p.geometry.deleteAttribute("normal"),Object.defineProperty(p.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(p)),p.material.uniforms.t2D.value=F,p.material.uniforms.backgroundIntensity.value=T.backgroundIntensity,p.material.toneMapped=F.colorSpace!==vn,!0===F.matrixAutoUpdate&&F.updateMatrix(),p.material.uniforms.uvTransform.value.copy(F.matrix),(_!==F||M!==F.version||b!==o.toneMapping)&&(p.material.needsUpdate=!0,_=F,M=F.version,b=o.toneMapping),p.layers.enableAll(),R.unshift(p,p.geometry,p.material,0,0,null))}}}function kM(o,e,t,n){const i=o.getParameter(o.MAX_VERTEX_ATTRIBS),a=n.isWebGL2?null:e.get("OES_vertex_array_object"),c=n.isWebGL2||null!==a,u={},d=R(null);let p=d,v=!1;function b(pe){return n.isWebGL2?o.bindVertexArray(pe):a.bindVertexArrayOES(pe)}function A(pe){return n.isWebGL2?o.deleteVertexArray(pe):a.deleteVertexArrayOES(pe)}function R(pe){const xe=[],Ne=[],Pe=[];for(let ze=0;ze<i;ze++)xe[ze]=0,Ne[ze]=0,Pe[ze]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:xe,enabledAttributes:Ne,attributeDivisors:Pe,object:pe,attributes:{},index:null}}function F(){const pe=p.newAttributes;for(let xe=0,Ne=pe.length;xe<Ne;xe++)pe[xe]=0}function V(pe){X(pe,0)}function X(pe,xe){const Pe=p.enabledAttributes,ze=p.attributeDivisors;p.newAttributes[pe]=1,0===Pe[pe]&&(o.enableVertexAttribArray(pe),Pe[pe]=1),ze[pe]!==xe&&((n.isWebGL2?o:e.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](pe,xe),ze[pe]=xe)}function Z(){const pe=p.newAttributes,xe=p.enabledAttributes;for(let Ne=0,Pe=xe.length;Ne<Pe;Ne++)xe[Ne]!==pe[Ne]&&(o.disableVertexAttribArray(Ne),xe[Ne]=0)}function q(pe,xe,Ne,Pe,ze,$e,Ke){!0===Ke?o.vertexAttribIPointer(pe,xe,Ne,ze,$e):o.vertexAttribPointer(pe,xe,Ne,Pe,ze,$e)}function De(){me(),v=!0,p!==d&&(p=d,b(p.object))}function me(){d.geometry=null,d.program=null,d.wireframe=!1}return{setup:function _(pe,xe,Ne,Pe,ze){let $e=!1;if(c){const Ke=function P(pe,xe,Ne){const Pe=!0===Ne.wireframe;let ze=u[pe.id];void 0===ze&&(ze={},u[pe.id]=ze);let $e=ze[xe.id];void 0===$e&&($e={},ze[xe.id]=$e);let Ke=$e[Pe];return void 0===Ke&&(Ke=R(function M(){return n.isWebGL2?o.createVertexArray():a.createVertexArrayOES()}()),$e[Pe]=Ke),Ke}(Pe,Ne,xe);p!==Ke&&(p=Ke,b(p.object)),$e=function T(pe,xe,Ne,Pe){const ze=p.attributes,$e=xe.attributes;let Ke=0;const _e=Ne.getAttributes();for(const He in _e)if(_e[He].location>=0){const ht=ze[He];let pt=$e[He];if(void 0===pt&&("instanceMatrix"===He&&pe.instanceMatrix&&(pt=pe.instanceMatrix),"instanceColor"===He&&pe.instanceColor&&(pt=pe.instanceColor)),void 0===ht||ht.attribute!==pt||pt&&ht.data!==pt.data)return!0;Ke++}return p.attributesNum!==Ke||p.index!==Pe}(pe,Pe,Ne,ze),$e&&function U(pe,xe,Ne,Pe){const ze={},$e=xe.attributes;let Ke=0;const _e=Ne.getAttributes();for(const He in _e)if(_e[He].location>=0){let ht=$e[He];void 0===ht&&("instanceMatrix"===He&&pe.instanceMatrix&&(ht=pe.instanceMatrix),"instanceColor"===He&&pe.instanceColor&&(ht=pe.instanceColor));const pt={};pt.attribute=ht,ht&&ht.data&&(pt.data=ht.data),ze[He]=pt,Ke++}p.attributes=ze,p.attributesNum=Ke,p.index=Pe}(pe,Pe,Ne,ze)}else{const Ke=!0===xe.wireframe;(p.geometry!==Pe.id||p.program!==Ne.id||p.wireframe!==Ke)&&(p.geometry=Pe.id,p.program=Ne.id,p.wireframe=Ke,$e=!0)}null!==ze&&t.update(ze,o.ELEMENT_ARRAY_BUFFER),($e||v)&&(v=!1,function ee(pe,xe,Ne,Pe){if(!1===n.isWebGL2&&(pe.isInstancedMesh||Pe.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;F();const ze=Pe.attributes,$e=Ne.getAttributes(),Ke=xe.defaultAttributeValues;for(const _e in $e){const He=$e[_e];if(He.location>=0){let ft=ze[_e];if(void 0===ft&&("instanceMatrix"===_e&&pe.instanceMatrix&&(ft=pe.instanceMatrix),"instanceColor"===_e&&pe.instanceColor&&(ft=pe.instanceColor)),void 0!==ft){const ht=ft.normalized,pt=ft.itemSize,Zt=t.get(ft);if(void 0===Zt)continue;const sn=Zt.buffer,nn=Zt.type,li=Zt.bytesPerElement,ci=!0===n.isWebGL2&&(nn===o.INT||nn===o.UNSIGNED_INT||1013===ft.gpuType);if(ft.isInterleavedBufferAttribute){const xn=ft.data,ce=xn.stride,Lt=ft.offset;if(xn.isInstancedInterleavedBuffer){for(let Ye=0;Ye<He.locationSize;Ye++)X(He.location+Ye,xn.meshPerAttribute);!0!==pe.isInstancedMesh&&void 0===Pe._maxInstanceCount&&(Pe._maxInstanceCount=xn.meshPerAttribute*xn.count)}else for(let Ye=0;Ye<He.locationSize;Ye++)V(He.location+Ye);o.bindBuffer(o.ARRAY_BUFFER,sn);for(let Ye=0;Ye<He.locationSize;Ye++)q(He.location+Ye,pt/He.locationSize,nn,ht,ce*li,(Lt+pt/He.locationSize*Ye)*li,ci)}else{if(ft.isInstancedBufferAttribute){for(let xn=0;xn<He.locationSize;xn++)X(He.location+xn,ft.meshPerAttribute);!0!==pe.isInstancedMesh&&void 0===Pe._maxInstanceCount&&(Pe._maxInstanceCount=ft.meshPerAttribute*ft.count)}else for(let xn=0;xn<He.locationSize;xn++)V(He.location+xn);o.bindBuffer(o.ARRAY_BUFFER,sn);for(let xn=0;xn<He.locationSize;xn++)q(He.location+xn,pt/He.locationSize,nn,ht,pt*li,pt/He.locationSize*xn*li,ci)}}else if(void 0!==Ke){const ht=Ke[_e];if(void 0!==ht)switch(ht.length){case 2:o.vertexAttrib2fv(He.location,ht);break;case 3:o.vertexAttrib3fv(He.location,ht);break;case 4:o.vertexAttrib4fv(He.location,ht);break;default:o.vertexAttrib1fv(He.location,ht)}}}}Z()}(pe,xe,Ne,Pe),null!==ze&&o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,t.get(ze).buffer))},reset:De,resetDefaultState:me,dispose:function j(){De();for(const pe in u){const xe=u[pe];for(const Ne in xe){const Pe=xe[Ne];for(const ze in Pe)A(Pe[ze].object),delete Pe[ze];delete xe[Ne]}delete u[pe]}},releaseStatesOfGeometry:function K(pe){if(void 0===u[pe.id])return;const xe=u[pe.id];for(const Ne in xe){const Pe=xe[Ne];for(const ze in Pe)A(Pe[ze].object),delete Pe[ze];delete xe[Ne]}delete u[pe.id]},releaseStatesOfProgram:function Me(pe){for(const xe in u){const Ne=u[xe];if(void 0===Ne[pe.id])continue;const Pe=Ne[pe.id];for(const ze in Pe)A(Pe[ze].object),delete Pe[ze];delete Ne[pe.id]}},initAttributes:F,enableAttribute:V,disableUnusedAttributes:Z}}function pg(o,e,t,n){const i=n.isWebGL2;let a;this.setMode=function c(p){a=p},this.render=function u(p,v){o.drawArrays(a,p,v),t.update(v,a,1)},this.renderInstances=function d(p,v,_){if(0===_)return;let M,b;if(i)M=o,b="drawArraysInstanced";else if(M=e.get("ANGLE_instanced_arrays"),b="drawArraysInstancedANGLE",null===M)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");M[b](a,p,v,_),t.update(v,a,_)}}function Zy(o,e,t){let n;function a(q){if("highp"===q){if(o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.HIGH_FLOAT).precision>0&&o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.HIGH_FLOAT).precision>0)return"highp";q="mediump"}return"mediump"===q&&o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.MEDIUM_FLOAT).precision>0&&o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const c="undefined"!=typeof WebGL2RenderingContext&&"WebGL2RenderingContext"===o.constructor.name;let u=void 0!==t.precision?t.precision:"highp";const d=a(u);d!==u&&(console.warn("THREE.WebGLRenderer:",u,"not supported, using",d,"instead."),u=d);const p=c||e.has("WEBGL_draw_buffers"),v=!0===t.logarithmicDepthBuffer,_=o.getParameter(o.MAX_TEXTURE_IMAGE_UNITS),M=o.getParameter(o.MAX_VERTEX_TEXTURE_IMAGE_UNITS),b=o.getParameter(o.MAX_TEXTURE_SIZE),A=o.getParameter(o.MAX_CUBE_MAP_TEXTURE_SIZE),P=o.getParameter(o.MAX_VERTEX_ATTRIBS),R=o.getParameter(o.MAX_VERTEX_UNIFORM_VECTORS),T=o.getParameter(o.MAX_VARYING_VECTORS),U=o.getParameter(o.MAX_FRAGMENT_UNIFORM_VECTORS),F=M>0,V=c||e.has("OES_texture_float");return{isWebGL2:c,drawBuffers:p,getMaxAnisotropy:function i(){if(void 0!==n)return n;if(!0===e.has("EXT_texture_filter_anisotropic")){const q=e.get("EXT_texture_filter_anisotropic");n=o.getParameter(q.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n},getMaxPrecision:a,precision:u,logarithmicDepthBuffer:v,maxTextures:_,maxVertexTextures:M,maxTextureSize:b,maxCubemapSize:A,maxAttributes:P,maxVertexUniforms:R,maxVaryings:T,maxFragmentUniforms:U,vertexTextures:F,floatFragmentTextures:V,floatVertexTextures:F&&V,maxSamples:c?o.getParameter(o.MAX_SAMPLES):0}}function UM(o){const e=this;let t=null,n=0,i=!1,a=!1;const c=new bc,u=new Zn,d={value:null,needsUpdate:!1};function v(_,M,b,A){const P=null!==_?_.length:0;let R=null;if(0!==P){if(R=d.value,!0!==A||null===R){const T=b+4*P,U=M.matrixWorldInverse;u.getNormalMatrix(U),(null===R||R.length<T)&&(R=new Float32Array(T));for(let F=0,V=b;F!==P;++F,V+=4)c.copy(_[F]).applyMatrix4(U,u),c.normal.toArray(R,V),R[V+3]=c.constant}d.value=R,d.needsUpdate=!0}return e.numPlanes=P,e.numIntersection=0,R}this.uniform=d,this.numPlanes=0,this.numIntersection=0,this.init=function(_,M){const b=0!==_.length||M||0!==n||i;return i=M,n=_.length,b},this.beginShadows=function(){a=!0,v(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(_,M){t=v(_,M,0)},this.setState=function(_,M,b){const A=_.clippingPlanes,P=_.clipIntersection,R=_.clipShadows,T=o.get(_);if(!i||null===A||0===A.length||a&&!R)a?v(null):function p(){d.value!==t&&(d.value=t,d.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}();else{const U=a?0:n,F=4*U;let V=T.clippingState||null;d.value=V,V=v(A,M,F,b);for(let X=0;X!==F;++X)V[X]=t[X];T.clippingState=V,this.numIntersection=P?this.numPlanes:0,this.numPlanes+=U}}}function BM(o){let e=new WeakMap;function t(c,u){return 303===u?c.mapping=301:304===u&&(c.mapping=302),c}function i(c){const u=c.target;u.removeEventListener("dispose",i);const d=e.get(u);void 0!==d&&(e.delete(u),d.dispose())}return{get:function n(c){if(c&&c.isTexture&&!1===c.isRenderTargetTexture){const u=c.mapping;if(303===u||304===u){if(e.has(c))return t(e.get(c).texture,c.mapping);{const d=c.image;if(d&&d.height>0){const p=new bE(d.height/2);return p.fromEquirectangularTexture(o,c),e.set(c,p),c.addEventListener("dispose",i),t(p.texture,c.mapping)}return null}}}return c},dispose:function a(){e=new WeakMap}}}class yh extends wy{constructor(e=-1,t=1,n=1,i=-1,a=.1,c=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=i,this.near=a,this.far=c,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,i,a,c){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=a,this.view.height=c,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let a=n-e,c=n+e,u=i+t,d=i-t;if(null!==this.view&&this.view.enabled){const p=(this.right-this.left)/this.view.fullWidth/this.zoom,v=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a+=p*this.view.offsetX,c=a+p*this.view.width,u-=v*this.view.offsetY,d=u-v*this.view.height}this.projectionMatrix.makeOrthographic(a,c,u,d,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const Ky=[.125,.215,.35,.446,.526,.582],mg=new yh,Jy=new ut;let lp=null;const Sc=(1+Math.sqrt(5))/2,_h=1/Sc,Pa=[new Q(1,1,1),new Q(-1,1,1),new Q(1,1,-1),new Q(-1,1,-1),new Q(0,Sc,_h),new Q(0,Sc,-_h),new Q(_h,0,Sc),new Q(-_h,0,Sc),new Q(Sc,_h,0),new Q(-Sc,_h,0)];class cp{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,i=100){lp=this._renderer.getRenderTarget(),this._setSize(256);const a=this._allocateTargets();return a.depthBuffer=!0,this._sceneToCubeUV(e,n,i,a),t>0&&this._blur(a,0,0,t),this._applyPMREM(a),this._cleanup(a),a}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=n0(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=t0(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(lp),e.scissorTest=!1,gg(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(301===e.mapping||302===e.mapping?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),lp=this._renderer.getRenderTarget();const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:Ii,minFilter:Ii,generateMipmaps:!1,type:_o,format:qr,colorSpace:ls,depthBuffer:!1},i=Qy(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=Qy(e,t,n);const{_lodMax:a}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function VM(o){const e=[],t=[],n=[];let i=o;const a=o-4+1+Ky.length;for(let c=0;c<a;c++){const u=Math.pow(2,i);t.push(u);let d=1/u;c>o-4?d=Ky[c-o+4-1]:0===c&&(d=0),n.push(d);const p=1/(u-2),v=-p,_=1+p,M=[v,v,_,v,_,_,v,v,_,_,v,_],b=6,A=6,P=3,R=2,T=1,U=new Float32Array(P*A*b),F=new Float32Array(R*A*b),V=new Float32Array(T*A*b);for(let Z=0;Z<b;Z++){const q=Z%3*2/3-1,ee=Z>2?0:-1;U.set([q,ee,0,q+2/3,ee,0,q+2/3,ee+1,0,q,ee,0,q+2/3,ee+1,0,q,ee+1,0],P*A*Z),F.set(M,R*A*Z),V.set([Z,Z,Z,Z,Z,Z],T*A*Z)}const X=new Un;X.setAttribute("position",new sr(U,P)),X.setAttribute("uv",new sr(F,R)),X.setAttribute("faceIndex",new sr(V,T)),e.push(X),i>4&&i--}return{lodPlanes:e,sizeLods:t,sigmas:n}}(a)),this._blurMaterial=function e0(o,e,t){const n=new Float32Array(20),i=new Q(0,1,0);return new es({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${o}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(a,e,t)}return i}_compileMaterial(e){const t=new Ji(this._lodPlanes[0],e);this._renderer.compile(t,mg)}_sceneToCubeUV(e,t,n,i){const u=new ts(90,1,t,n),d=[1,-1,1,1,1,1],p=[1,1,1,-1,-1,-1],v=this._renderer,_=v.autoClear,M=v.toneMapping;v.getClearColor(Jy),v.toneMapping=0,v.autoClear=!1;const b=new Ts({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),A=new Ji(new ph,b);let P=!1;const R=e.background;R?R.isColor&&(b.color.copy(R),e.background=null,P=!0):(b.color.copy(Jy),P=!0);for(let T=0;T<6;T++){const U=T%3;0===U?(u.up.set(0,d[T],0),u.lookAt(p[T],0,0)):1===U?(u.up.set(0,0,d[T]),u.lookAt(0,p[T],0)):(u.up.set(0,d[T],0),u.lookAt(0,0,p[T]));const F=this._cubeSize;gg(i,U*F,T>2?F:0,F,F),v.setRenderTarget(i),P&&v.render(A,u),v.render(e,u)}A.geometry.dispose(),A.material.dispose(),v.toneMapping=M,v.autoClear=_,e.background=R}_textureToCubeUV(e,t){const n=this._renderer,i=301===e.mapping||302===e.mapping;i?(null===this._cubemapMaterial&&(this._cubemapMaterial=n0()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=t0());const a=i?this._cubemapMaterial:this._equirectMaterial,c=new Ji(this._lodPlanes[0],a);a.uniforms.envMap.value=e;const d=this._cubeSize;gg(t,0,0,3*d,2*d),n.setRenderTarget(t),n.render(c,mg)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;for(let i=1;i<this._lodPlanes.length;i++){const a=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]);this._blur(e,i-1,i,a,Pa[(i-1)%Pa.length])}t.autoClear=n}_blur(e,t,n,i,a){const c=this._pingPongRenderTarget;this._halfBlur(e,c,t,n,i,"latitudinal",a),this._halfBlur(c,e,n,n,i,"longitudinal",a)}_halfBlur(e,t,n,i,a,c,u){const d=this._renderer,p=this._blurMaterial;"latitudinal"!==c&&"longitudinal"!==c&&console.error("blur direction must be either latitudinal or longitudinal!");const _=new Ji(this._lodPlanes[i],p),M=p.uniforms,b=this._sizeLods[n]-1,A=isFinite(a)?Math.PI/(2*b):2*Math.PI/39,P=a/A,R=isFinite(a)?1+Math.floor(3*P):20;R>20&&console.warn(`sigmaRadians, ${a}, is too large and will clip, as it requested ${R} samples when the maximum is set to 20`);const T=[];let U=0;for(let q=0;q<20;++q){const ee=q/P,j=Math.exp(-ee*ee/2);T.push(j),0===q?U+=j:q<R&&(U+=2*j)}for(let q=0;q<T.length;q++)T[q]=T[q]/U;M.envMap.value=e.texture,M.samples.value=R,M.weights.value=T,M.latitudinal.value="latitudinal"===c,u&&(M.poleAxis.value=u);const{_lodMax:F}=this;M.dTheta.value=A,M.mipInt.value=F-n;const V=this._sizeLods[i];gg(t,3*V*(i>F-4?i-F+4:0),4*(this._cubeSize-V),3*V,2*V),d.setRenderTarget(t),d.render(_,mg)}}function Qy(o,e,t){const n=new ba(o,e,t);return n.texture.mapping=306,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function gg(o,e,t,n,i){o.viewport.set(e,t,n,i),o.scissor.set(e,t,n,i)}function t0(){return new es({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function n0(){return new es({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function yg(o){let e=new WeakMap,t=null;function a(u){const d=u.target;d.removeEventListener("dispose",a);const p=e.get(d);void 0!==p&&(e.delete(d),p.dispose())}return{get:function n(u){if(u&&u.isTexture){const d=u.mapping,p=303===d||304===d,v=301===d||302===d;if(p||v){if(u.isRenderTargetTexture&&!0===u.needsPMREMUpdate){u.needsPMREMUpdate=!1;let _=e.get(u);return null===t&&(t=new cp(o)),_=p?t.fromEquirectangular(u,_):t.fromCubemap(u,_),e.set(u,_),_.texture}if(e.has(u))return e.get(u).texture;{const _=u.image;if(p&&_&&_.height>0||v&&_&&function i(u){let d=0;for(let v=0;v<6;v++)void 0!==u[v]&&d++;return 6===d}(_)){null===t&&(t=new cp(o));const M=p?t.fromEquirectangular(u):t.fromCubemap(u);return e.set(u,M),u.addEventListener("dispose",a),M.texture}return null}}}return u},dispose:function c(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function zM(o){const e={};function t(n){if(void 0!==e[n])return e[n];let i;switch(n){case"WEBGL_depth_texture":i=o.getExtension("WEBGL_depth_texture")||o.getExtension("MOZ_WEBGL_depth_texture")||o.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=o.getExtension("WEBGL_compressed_texture_s3tc")||o.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||o.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=o.getExtension("WEBGL_compressed_texture_pvrtc")||o.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=o.getExtension(n)}return e[n]=i,i}return{has:function(n){return null!==t(n)},init:function(n){n.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(n){const i=t(n);return null===i&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),i}}}function HM(o,e,t,n){const i={},a=new WeakMap;function c(_){const M=_.target;null!==M.index&&e.remove(M.index);for(const A in M.attributes)e.remove(M.attributes[A]);for(const A in M.morphAttributes){const P=M.morphAttributes[A];for(let R=0,T=P.length;R<T;R++)e.remove(P[R])}M.removeEventListener("dispose",c),delete i[M.id];const b=a.get(M);b&&(e.remove(b),a.delete(M)),n.releaseStatesOfGeometry(M),!0===M.isInstancedBufferGeometry&&delete M._maxInstanceCount,t.memory.geometries--}function p(_){const M=[],b=_.index,A=_.attributes.position;let P=0;if(null!==b){const U=b.array;P=b.version;for(let F=0,V=U.length;F<V;F+=3){const X=U[F+0],Z=U[F+1],q=U[F+2];M.push(X,Z,Z,q,q,X)}}else{if(void 0===A)return;P=A.version;for(let F=0,V=A.array.length/3-1;F<V;F+=3){const X=F+0,Z=F+1,q=F+2;M.push(X,Z,Z,q,q,X)}}const R=new(ly(M)?qf:Km)(M,1);R.version=P;const T=a.get(_);T&&e.remove(T),a.set(_,R)}return{get:function u(_,M){return!0===i[M.id]||(M.addEventListener("dispose",c),i[M.id]=!0,t.memory.geometries++),M},update:function d(_){const M=_.attributes;for(const A in M)e.update(M[A],o.ARRAY_BUFFER);const b=_.morphAttributes;for(const A in b){const P=b[A];for(let R=0,T=P.length;R<T;R++)e.update(P[R],o.ARRAY_BUFFER)}},getWireframeAttribute:function v(_){const M=a.get(_);if(M){const b=_.index;null!==b&&M.version<b.version&&p(_)}else p(_);return a.get(_)}}}function up(o,e,t,n){const i=n.isWebGL2;let a,u,d;this.setMode=function c(M){a=M},this.setIndex=function p(M){u=M.type,d=M.bytesPerElement},this.render=function v(M,b){o.drawElements(a,b,u,M*d),t.update(b,a,1)},this.renderInstances=function _(M,b,A){if(0===A)return;let P,R;if(i)P=o,R="drawElementsInstanced";else if(P=e.get("ANGLE_instanced_arrays"),R="drawElementsInstancedANGLE",null===P)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");P[R](a,b,u,M*d,A),t.update(b,a,A)}}function _g(o){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function i(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function n(a,c,u){switch(t.calls++,c){case o.TRIANGLES:t.triangles+=u*(a/3);break;case o.LINES:t.lines+=u*(a/2);break;case o.LINE_STRIP:t.lines+=u*(a-1);break;case o.LINE_LOOP:t.lines+=u*a;break;case o.POINTS:t.points+=u*a;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",c)}}}}function GM(o,e){return o[0]-e[0]}function xg(o,e){return Math.abs(e[1])-Math.abs(o[1])}function Mg(o,e,t){const n={},i=new Float32Array(8),a=new WeakMap,c=new Ci,u=[];for(let p=0;p<8;p++)u[p]=[p,0];return{update:function d(p,v,_){const M=p.morphTargetInfluences;if(!0===e.isWebGL2){const b=v.morphAttributes.position||v.morphAttributes.normal||v.morphAttributes.color,A=void 0!==b?b.length:0;let P=a.get(v);if(void 0===P||P.count!==A){let pe=function(){De.dispose(),a.delete(v),v.removeEventListener("dispose",pe)};void 0!==P&&P.texture.dispose();const U=void 0!==v.morphAttributes.position,F=void 0!==v.morphAttributes.normal,V=void 0!==v.morphAttributes.color,X=v.morphAttributes.position||[],Z=v.morphAttributes.normal||[],q=v.morphAttributes.color||[];let ee=0;!0===U&&(ee=1),!0===F&&(ee=2),!0===V&&(ee=3);let j=v.attributes.position.count*ee,K=1;j>e.maxTextureSize&&(K=Math.ceil(j/e.maxTextureSize),j=e.maxTextureSize);const Me=new Float32Array(j*K*4*A),De=new eh(Me,j,K,A);De.type=Tn,De.needsUpdate=!0;const me=4*ee;for(let xe=0;xe<A;xe++){const Ne=X[xe],Pe=Z[xe],ze=q[xe],$e=j*K*4*xe;for(let Ke=0;Ke<Ne.count;Ke++){const _e=Ke*me;!0===U&&(c.fromBufferAttribute(Ne,Ke),Me[$e+_e+0]=c.x,Me[$e+_e+1]=c.y,Me[$e+_e+2]=c.z,Me[$e+_e+3]=0),!0===F&&(c.fromBufferAttribute(Pe,Ke),Me[$e+_e+4]=c.x,Me[$e+_e+5]=c.y,Me[$e+_e+6]=c.z,Me[$e+_e+7]=0),!0===V&&(c.fromBufferAttribute(ze,Ke),Me[$e+_e+8]=c.x,Me[$e+_e+9]=c.y,Me[$e+_e+10]=c.z,Me[$e+_e+11]=4===ze.itemSize?c.w:1)}}P={count:A,texture:De,size:new Be(j,K)},a.set(v,P),v.addEventListener("dispose",pe)}let R=0;for(let U=0;U<M.length;U++)R+=M[U];const T=v.morphTargetsRelative?1:1-R;_.getUniforms().setValue(o,"morphTargetBaseInfluence",T),_.getUniforms().setValue(o,"morphTargetInfluences",M),_.getUniforms().setValue(o,"morphTargetsTexture",P.texture,t),_.getUniforms().setValue(o,"morphTargetsTextureSize",P.size)}else{const b=void 0===M?0:M.length;let A=n[v.id];if(void 0===A||A.length!==b){A=[];for(let F=0;F<b;F++)A[F]=[F,0];n[v.id]=A}for(let F=0;F<b;F++){const V=A[F];V[0]=F,V[1]=M[F]}A.sort(xg);for(let F=0;F<8;F++)F<b&&A[F][1]?(u[F][0]=A[F][0],u[F][1]=A[F][1]):(u[F][0]=Number.MAX_SAFE_INTEGER,u[F][1]=0);u.sort(GM);const P=v.morphAttributes.position,R=v.morphAttributes.normal;let T=0;for(let F=0;F<8;F++){const V=u[F],X=V[0],Z=V[1];X!==Number.MAX_SAFE_INTEGER&&Z?(P&&v.getAttribute("morphTarget"+F)!==P[X]&&v.setAttribute("morphTarget"+F,P[X]),R&&v.getAttribute("morphNormal"+F)!==R[X]&&v.setAttribute("morphNormal"+F,R[X]),i[F]=Z,T+=Z):(P&&!0===v.hasAttribute("morphTarget"+F)&&v.deleteAttribute("morphTarget"+F),R&&!0===v.hasAttribute("morphNormal"+F)&&v.deleteAttribute("morphNormal"+F),i[F]=0)}const U=v.morphTargetsRelative?1:1-T;_.getUniforms().setValue(o,"morphTargetBaseInfluence",U),_.getUniforms().setValue(o,"morphTargetInfluences",i)}}}}function r0(o,e,t,n){let i=new WeakMap;function u(d){const p=d.target;p.removeEventListener("dispose",u),t.remove(p.instanceMatrix),null!==p.instanceColor&&t.remove(p.instanceColor)}return{update:function a(d){const p=n.render.frame,_=e.get(d,d.geometry);if(i.get(_)!==p&&(e.update(_),i.set(_,p)),d.isInstancedMesh&&(!1===d.hasEventListener("dispose",u)&&d.addEventListener("dispose",u),i.get(d)!==p&&(t.update(d.instanceMatrix,o.ARRAY_BUFFER),null!==d.instanceColor&&t.update(d.instanceColor,o.ARRAY_BUFFER),i.set(d,p))),d.isSkinnedMesh){const M=d.skeleton;i.get(M)!==p&&(M.update(),i.set(M,p))}return _},dispose:function c(){i=new WeakMap}}}const WM=new Ss,jM=new eh,hp=new Bm,$M=new gh,s0=[],bg=[],wg=new Float32Array(16),Eg=new Float32Array(9),Sg=new Float32Array(4);function yu(o,e,t){const n=o[0];if(n<=0||n>0)return o;const i=e*t;let a=s0[i];if(void 0===a&&(a=new Float32Array(i),s0[i]=a),0!==e){n.toArray(a,0);for(let c=1,u=0;c!==e;++c)u+=t,o[c].toArray(a,u)}return a}function Hi(o,e){if(o.length!==e.length)return!1;for(let t=0,n=o.length;t<n;t++)if(o[t]!==e[t])return!1;return!0}function br(o,e){for(let t=0,n=e.length;t<n;t++)o[t]=e[t]}function dp(o,e){let t=bg[e];void 0===t&&(t=new Int32Array(e),bg[e]=t);for(let n=0;n!==e;++n)t[n]=o.allocateTextureUnit();return t}function XM(o,e){const t=this.cache;t[0]!==e&&(o.uniform1f(this.addr,e),t[0]=e)}function nS(o,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(o.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Hi(t,e))return;o.uniform2fv(this.addr,e),br(t,e)}}function Ag(o,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(o.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(o.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Hi(t,e))return;o.uniform3fv(this.addr,e),br(t,e)}}function o0(o,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(o.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Hi(t,e))return;o.uniform4fv(this.addr,e),br(t,e)}}function Tg(o,e){const t=this.cache,n=e.elements;if(void 0===n){if(Hi(t,e))return;o.uniformMatrix2fv(this.addr,!1,e),br(t,e)}else{if(Hi(t,n))return;Sg.set(n),o.uniformMatrix2fv(this.addr,!1,Sg),br(t,n)}}function Dd(o,e){const t=this.cache,n=e.elements;if(void 0===n){if(Hi(t,e))return;o.uniformMatrix3fv(this.addr,!1,e),br(t,e)}else{if(Hi(t,n))return;Eg.set(n),o.uniformMatrix3fv(this.addr,!1,Eg),br(t,n)}}function qM(o,e){const t=this.cache,n=e.elements;if(void 0===n){if(Hi(t,e))return;o.uniformMatrix4fv(this.addr,!1,e),br(t,e)}else{if(Hi(t,n))return;wg.set(n),o.uniformMatrix4fv(this.addr,!1,wg),br(t,n)}}function Cg(o,e){const t=this.cache;t[0]!==e&&(o.uniform1i(this.addr,e),t[0]=e)}function a0(o,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(o.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Hi(t,e))return;o.uniform2iv(this.addr,e),br(t,e)}}function l0(o,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(o.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Hi(t,e))return;o.uniform3iv(this.addr,e),br(t,e)}}function c0(o,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(o.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Hi(t,e))return;o.uniform4iv(this.addr,e),br(t,e)}}function YM(o,e){const t=this.cache;t[0]!==e&&(o.uniform1ui(this.addr,e),t[0]=e)}function Dg(o,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(o.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Hi(t,e))return;o.uniform2uiv(this.addr,e),br(t,e)}}function ZM(o,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(o.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Hi(t,e))return;o.uniform3uiv(this.addr,e),br(t,e)}}function KM(o,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(o.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Hi(t,e))return;o.uniform4uiv(this.addr,e),br(t,e)}}function u0(o,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(o.uniform1i(this.addr,i),n[0]=i),t.setTexture2D(e||WM,i)}function xh(o,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(o.uniform1i(this.addr,i),n[0]=i),t.setTexture3D(e||hp,i)}function h0(o,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(o.uniform1i(this.addr,i),n[0]=i),t.setTextureCube(e||$M,i)}function JM(o,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(o.uniform1i(this.addr,i),n[0]=i),t.setTexture2DArray(e||jM,i)}function Mh(o,e){o.uniform1fv(this.addr,e)}function eb(o,e){const t=yu(e,this.size,2);o.uniform2fv(this.addr,t)}function tb(o,e){const t=yu(e,this.size,3);o.uniform3fv(this.addr,t)}function nb(o,e){const t=yu(e,this.size,4);o.uniform4fv(this.addr,t)}function ib(o,e){const t=yu(e,this.size,4);o.uniformMatrix2fv(this.addr,!1,t)}function rl(o,e){const t=yu(e,this.size,9);o.uniformMatrix3fv(this.addr,!1,t)}function Rg(o,e){const t=yu(e,this.size,16);o.uniformMatrix4fv(this.addr,!1,t)}function d0(o,e){o.uniform1iv(this.addr,e)}function f0(o,e){o.uniform2iv(this.addr,e)}function p0(o,e){o.uniform3iv(this.addr,e)}function m0(o,e){o.uniform4iv(this.addr,e)}function rb(o,e){o.uniform1uiv(this.addr,e)}function sb(o,e){o.uniform2uiv(this.addr,e)}function ob(o,e){o.uniform3uiv(this.addr,e)}function ab(o,e){o.uniform4uiv(this.addr,e)}function g0(o,e,t){const n=this.cache,i=e.length,a=dp(t,i);Hi(n,a)||(o.uniform1iv(this.addr,a),br(n,a));for(let c=0;c!==i;++c)t.setTexture2D(e[c]||WM,a[c])}function iS(o,e,t){const n=this.cache,i=e.length,a=dp(t,i);Hi(n,a)||(o.uniform1iv(this.addr,a),br(n,a));for(let c=0;c!==i;++c)t.setTexture3D(e[c]||hp,a[c])}function v0(o,e,t){const n=this.cache,i=e.length,a=dp(t,i);Hi(n,a)||(o.uniform1iv(this.addr,a),br(n,a));for(let c=0;c!==i;++c)t.setTextureCube(e[c]||$M,a[c])}function lb(o,e,t){const n=this.cache,i=e.length,a=dp(t,i);Hi(n,a)||(o.uniform1iv(this.addr,a),br(n,a));for(let c=0;c!==i;++c)t.setTexture2DArray(e[c]||jM,a[c])}class rS{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function QM(o){switch(o){case 5126:return XM;case 35664:return nS;case 35665:return Ag;case 35666:return o0;case 35674:return Tg;case 35675:return Dd;case 35676:return qM;case 5124:case 35670:return Cg;case 35667:case 35671:return a0;case 35668:case 35672:return l0;case 35669:case 35673:return c0;case 5125:return YM;case 36294:return Dg;case 36295:return ZM;case 36296:return KM;case 35678:case 36198:case 36298:case 36306:case 35682:return u0;case 35679:case 36299:case 36307:return xh;case 35680:case 36300:case 36308:case 36293:return h0;case 36289:case 36303:case 36311:case 36292:return JM}}(t.type)}}class sS{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function cb(o){switch(o){case 5126:return Mh;case 35664:return eb;case 35665:return tb;case 35666:return nb;case 35674:return ib;case 35675:return rl;case 35676:return Rg;case 5124:case 35670:return d0;case 35667:case 35671:return f0;case 35668:case 35672:return p0;case 35669:case 35673:return m0;case 5125:return rb;case 36294:return sb;case 36295:return ob;case 36296:return ab;case 35678:case 36198:case 36298:case 36306:case 35682:return g0;case 35679:case 36299:case 36307:return iS;case 35680:case 36300:case 36308:case 36293:return v0;case 36289:case 36303:case 36311:case 36292:return lb}}(t.type)}}class Ig{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const i=this.seq;for(let a=0,c=i.length;a!==c;++a){const u=i[a];u.setValue(e,t[u.id],n)}}}const Pg=/(\w+)(\])?(\[|\.)?/g;function Lg(o,e){o.seq.push(e),o.map[e.id]=e}function y0(o,e,t){const n=o.name,i=n.length;for(Pg.lastIndex=0;;){const a=Pg.exec(n),c=Pg.lastIndex;let u=a[1];const p=a[3];if("]"===a[2]&&(u|=0),void 0===p||"["===p&&c+2===i){Lg(t,void 0===p?new rS(u,o,e):new sS(u,o,e));break}{let _=t.map[u];void 0===_&&(_=new Ig(u),Lg(t,_)),t=_}}}class Og{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<n;++i){const a=e.getActiveUniform(t,i);y0(a,e.getUniformLocation(t,a.name),this)}}setValue(e,t,n,i){const a=this.map[t];void 0!==a&&a.setValue(e,n,i)}setOptional(e,t,n){const i=t[n];void 0!==i&&this.setValue(e,n,i)}static upload(e,t,n,i){for(let a=0,c=t.length;a!==c;++a){const u=t[a],d=n[u.id];!1!==d.needsUpdate&&u.setValue(e,d.value,i)}}static seqWithValue(e,t){const n=[];for(let i=0,a=e.length;i!==a;++i){const c=e[i];c.id in t&&n.push(c)}return n}}function Jo(o,e,t){const n=o.createShader(e);return o.shaderSource(n,t),o.compileShader(n),n}let oS=0;function Fg(o,e,t){const n=o.getShaderParameter(e,o.COMPILE_STATUS),i=o.getShaderInfoLog(e).trim();if(n&&""===i)return"";const a=/ERROR: 0:(\d+)/.exec(i);if(a){const c=parseInt(a[1]);return t.toUpperCase()+"\n\n"+i+"\n\n"+function aS(o,e){const t=o.split("\n"),n=[],i=Math.max(e-6,0),a=Math.min(e+6,t.length);for(let c=i;c<a;c++){const u=c+1;n.push(`${u===e?">":" "} ${u}: ${t[c]}`)}return n.join("\n")}(o.getShaderSource(e),c)}return i}function x0(o,e){const t=function _0(o){switch(o){case ls:return["Linear","( value )"];case vn:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",o),["Linear","( value )"]}}(e);return"vec4 "+o+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function ub(o,e){let t;switch(e){case 1:t="Linear";break;case 2:t="Reinhard";break;case 3:t="OptimizedCineon";break;case 4:t="ACESFilmic";break;case 5:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+o+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function Rd(o){return""!==o}function fp(o,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return o.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function b0(o,e){return o.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const hb=/^[ \t]*#include +<([\w\d./]+)>/gm;function kg(o){return o.replace(hb,fb)}const db=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function fb(o,e){let t=Kn[e];if(void 0===t){const n=db.get(e);if(void 0===n)throw new Error("Can not resolve #include <"+e+">");t=Kn[n],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n)}return kg(t)}const pb=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Id(o){return o.replace(pb,bh)}function bh(o,e,t,n){let i="";for(let a=parseInt(e);a<parseInt(t);a++)i+=n.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return i}function w0(o){let e="precision "+o.precision+" float;\nprecision "+o.precision+" int;";return"highp"===o.precision?e+="\n#define HIGH_PRECISION":"mediump"===o.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===o.precision&&(e+="\n#define LOW_PRECISION"),e}function Ld(o,e,t,n){const i=o.getContext(),a=t.defines;let c=t.vertexShader,u=t.fragmentShader;const d=function Pd(o){let e="SHADOWMAP_TYPE_BASIC";return 1===o.shadowMapType?e="SHADOWMAP_TYPE_PCF":2===o.shadowMapType?e="SHADOWMAP_TYPE_PCF_SOFT":3===o.shadowMapType&&(e="SHADOWMAP_TYPE_VSM"),e}(t),p=function mb(o){let e="ENVMAP_TYPE_CUBE";if(o.envMap)switch(o.envMapMode){case 301:case 302:e="ENVMAP_TYPE_CUBE";break;case 306:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),v=function gb(o){let e="ENVMAP_MODE_REFLECTION";return o.envMap&&302===o.envMapMode&&(e="ENVMAP_MODE_REFRACTION"),e}(t),_=function Ug(o){let e="ENVMAP_BLENDING_NONE";if(o.envMap)switch(o.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD"}return e}(t),M=function sl(o){const e=o.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:n,maxMip:t}}(t),b=t.isWebGL2?"":function lS(o){return[o.extensionDerivatives||o.envMapCubeUVHeight||o.bumpMap||o.normalMapTangentSpace||o.clearcoatNormalMap||o.flatShading||"physical"===o.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(o.extensionFragDepth||o.logarithmicDepthBuffer)&&o.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",o.extensionDrawBuffers&&o.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(o.extensionShaderTextureLOD||o.envMap||o.transmission)&&o.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Rd).join("\n")}(t),A=function M0(o){const e=[];for(const t in o){const n=o[t];!1!==n&&e.push("#define "+t+" "+n)}return e.join("\n")}(a),P=i.createProgram();let R,T,U=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(R=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,A].filter(Rd).join("\n"),R.length>0&&(R+="\n"),T=[b,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,A].filter(Rd).join("\n"),T.length>0&&(T+="\n")):(R=[w0(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,A,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+v:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+d:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Rd).join("\n"),T=[b,w0(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,A,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+p:"",t.envMap?"#define "+v:"",t.envMap?"#define "+_:"",M?"#define CUBEUV_TEXEL_WIDTH "+M.texelWidth:"",M?"#define CUBEUV_TEXEL_HEIGHT "+M.texelHeight:"",M?"#define CUBEUV_MAX_MIP "+M.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+d:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==t.toneMapping?"#define TONE_MAPPING":"",0!==t.toneMapping?Kn.tonemapping_pars_fragment:"",0!==t.toneMapping?ub("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Kn.colorspace_pars_fragment,x0("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(Rd).join("\n")),c=kg(c),c=fp(c,t),c=b0(c,t),u=kg(u),u=fp(u,t),u=b0(u,t),c=Id(c),u=Id(u),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(U="#version 300 es\n",R=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+R,T=["#define varying in","300 es"===t.glslVersion?"":"layout(location = 0) out highp vec4 pc_fragColor;","300 es"===t.glslVersion?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+T);const V=U+T+u,X=Jo(i,i.VERTEX_SHADER,U+R+c),Z=Jo(i,i.FRAGMENT_SHADER,V);if(i.attachShader(P,X),i.attachShader(P,Z),void 0!==t.index0AttributeName?i.bindAttribLocation(P,0,t.index0AttributeName):!0===t.morphTargets&&i.bindAttribLocation(P,0,"position"),i.linkProgram(P),o.debug.checkShaderErrors){const j=i.getProgramInfoLog(P).trim(),K=i.getShaderInfoLog(X).trim(),Me=i.getShaderInfoLog(Z).trim();let De=!0,me=!0;if(!1===i.getProgramParameter(P,i.LINK_STATUS))if(De=!1,"function"==typeof o.debug.onShaderError)o.debug.onShaderError(i,P,X,Z);else{const pe=Fg(i,X,"vertex"),xe=Fg(i,Z,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(P,i.VALIDATE_STATUS)+"\n\nProgram Info Log: "+j+"\n"+pe+"\n"+xe)}else""!==j?console.warn("THREE.WebGLProgram: Program Info Log:",j):(""===K||""===Me)&&(me=!1);me&&(this.diagnostics={runnable:De,programLog:j,vertexShader:{log:K,prefix:R},fragmentShader:{log:Me,prefix:T}})}let q,ee;return i.deleteShader(X),i.deleteShader(Z),this.getUniforms=function(){return void 0===q&&(q=new Og(i,P)),q},this.getAttributes=function(){return void 0===ee&&(ee=function Ng(o,e){const t={},n=o.getProgramParameter(e,o.ACTIVE_ATTRIBUTES);for(let i=0;i<n;i++){const a=o.getActiveAttrib(e,i),c=a.name;let u=1;a.type===o.FLOAT_MAT2&&(u=2),a.type===o.FLOAT_MAT3&&(u=3),a.type===o.FLOAT_MAT4&&(u=4),t[c]={type:a.type,location:o.getAttribLocation(e,c),locationSize:u}}return t}(i,P)),ee},this.destroy=function(){n.releaseStatesOfProgram(this),i.deleteProgram(P),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=oS++,this.cacheKey=e,this.usedTimes=1,this.program=P,this.vertexShader=X,this.fragmentShader=Z,this}let Bs=0;class _u{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.fragmentShader,i=this._getShaderStage(e.vertexShader),a=this._getShaderStage(n),c=this._getShaderCacheForMaterial(e);return!1===c.has(i)&&(c.add(i),i.usedTimes++),!1===c.has(a)&&(c.add(a),a.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return void 0===n&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return void 0===n&&(n=new pp(e),t.set(e,n)),n}}class pp{constructor(e){this.id=Bs++,this.code=e,this.usedTimes=0}}function Qo(o,e,t,n,i,a,c){const u=new jf,d=new _u,p=[],v=i.isWebGL2,_=i.logarithmicDepthBuffer,M=i.vertexTextures;let b=i.precision;const A={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function P(j){return 0===j?"uv":`uv${j}`}return{getParameters:function R(j,K,Me,De,me){const pe=De.fog,xe=me.geometry,Pe=(j.isMeshStandardMaterial?t:e).get(j.envMap||(j.isMeshStandardMaterial?De.environment:null)),ze=Pe&&306===Pe.mapping?Pe.image.height:null,$e=A[j.type];null!==j.precision&&(b=i.getMaxPrecision(j.precision),b!==j.precision&&console.warn("THREE.WebGLProgram.getParameters:",j.precision,"not supported, using",b,"instead."));const Ke=xe.morphAttributes.position||xe.morphAttributes.normal||xe.morphAttributes.color,_e=void 0!==Ke?Ke.length:0;let ft,ht,pt,Zt,He=0;if(void 0!==xe.morphAttributes.position&&(He=1),void 0!==xe.morphAttributes.normal&&(He=2),void 0!==xe.morphAttributes.color&&(He=3),$e){const gr=Vl[$e];ft=gr.vertexShader,ht=gr.fragmentShader}else ft=j.vertexShader,ht=j.fragmentShader,d.update(j),pt=d.getVertexShaderID(j),Zt=d.getFragmentShaderID(j);const sn=o.getRenderTarget(),nn=!0===me.isInstancedMesh,li=!!j.map,xn=!!Pe,ce=!!j.aoMap,Lt=!!j.lightMap,Ye=!!j.bumpMap,St=!!j.normalMap,it=!!j.displacementMap,bn=!!j.emissiveMap,Qt=!!j.metalnessMap,on=!!j.roughnessMap,On=j.anisotropy>0,gi=j.clearcoat>0,Er=j.iridescence>0,oe=j.sheen>0,J=j.transmission>0,Re=On&&!!j.anisotropyMap,wt=gi&&!!j.clearcoatMap,ct=gi&&!!j.clearcoatNormalMap,At=gi&&!!j.clearcoatRoughnessMap,yn=Er&&!!j.iridescenceMap,Ct=Er&&!!j.iridescenceThicknessMap,Fe=oe&&!!j.sheenColorMap,he=oe&&!!j.sheenRoughnessMap,nt=!!j.specularMap,Xt=!!j.specularColorMap,Bt=!!j.specularIntensityMap,jt=J&&!!j.transmissionMap,Wn=J&&!!j.thicknessMap,fe=!!j.alphaMap,xt=!!j.extensions,Gt=!!xe.attributes.uv1,ui=!!xe.attributes.uv2,Gi=!!xe.attributes.uv3;let mr=0;return j.toneMapped&&(null===sn||!0===sn.isXRRenderTarget)&&(mr=o.toneMapping),{isWebGL2:v,shaderID:$e,shaderType:j.type,shaderName:j.name,vertexShader:ft,fragmentShader:ht,defines:j.defines,customVertexShaderID:pt,customFragmentShaderID:Zt,isRawShaderMaterial:!0===j.isRawShaderMaterial,glslVersion:j.glslVersion,precision:b,instancing:nn,instancingColor:nn&&null!==me.instanceColor,supportsVertexTextures:M,outputColorSpace:null===sn?o.outputColorSpace:!0===sn.isXRRenderTarget?sn.texture.colorSpace:ls,map:li,matcap:!!j.matcap,envMap:xn,envMapMode:xn&&Pe.mapping,envMapCubeUVHeight:ze,aoMap:ce,lightMap:Lt,bumpMap:Ye,normalMap:St,displacementMap:M&&it,emissiveMap:bn,normalMapObjectSpace:St&&1===j.normalMapType,normalMapTangentSpace:St&&0===j.normalMapType,metalnessMap:Qt,roughnessMap:on,anisotropy:On,anisotropyMap:Re,clearcoat:gi,clearcoatMap:wt,clearcoatNormalMap:ct,clearcoatRoughnessMap:At,iridescence:Er,iridescenceMap:yn,iridescenceThicknessMap:Ct,sheen:oe,sheenColorMap:Fe,sheenRoughnessMap:he,specularMap:nt,specularColorMap:Xt,specularIntensityMap:Bt,transmission:J,transmissionMap:jt,thicknessMap:Wn,gradientMap:!!j.gradientMap,opaque:!1===j.transparent&&1===j.blending,alphaMap:fe,alphaTest:j.alphaTest>0,alphaHash:!!j.alphaHash,combine:j.combine,mapUv:li&&P(j.map.channel),aoMapUv:ce&&P(j.aoMap.channel),lightMapUv:Lt&&P(j.lightMap.channel),bumpMapUv:Ye&&P(j.bumpMap.channel),normalMapUv:St&&P(j.normalMap.channel),displacementMapUv:it&&P(j.displacementMap.channel),emissiveMapUv:bn&&P(j.emissiveMap.channel),metalnessMapUv:Qt&&P(j.metalnessMap.channel),roughnessMapUv:on&&P(j.roughnessMap.channel),anisotropyMapUv:Re&&P(j.anisotropyMap.channel),clearcoatMapUv:wt&&P(j.clearcoatMap.channel),clearcoatNormalMapUv:ct&&P(j.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:At&&P(j.clearcoatRoughnessMap.channel),iridescenceMapUv:yn&&P(j.iridescenceMap.channel),iridescenceThicknessMapUv:Ct&&P(j.iridescenceThicknessMap.channel),sheenColorMapUv:Fe&&P(j.sheenColorMap.channel),sheenRoughnessMapUv:he&&P(j.sheenRoughnessMap.channel),specularMapUv:nt&&P(j.specularMap.channel),specularColorMapUv:Xt&&P(j.specularColorMap.channel),specularIntensityMapUv:Bt&&P(j.specularIntensityMap.channel),transmissionMapUv:jt&&P(j.transmissionMap.channel),thicknessMapUv:Wn&&P(j.thicknessMap.channel),alphaMapUv:fe&&P(j.alphaMap.channel),vertexTangents:!!xe.attributes.tangent&&(St||On),vertexColors:j.vertexColors,vertexAlphas:!0===j.vertexColors&&!!xe.attributes.color&&4===xe.attributes.color.itemSize,vertexUv1s:Gt,vertexUv2s:ui,vertexUv3s:Gi,pointsUvs:!0===me.isPoints&&!!xe.attributes.uv&&(li||fe),fog:!!pe,useFog:!0===j.fog,fogExp2:pe&&pe.isFogExp2,flatShading:!0===j.flatShading,sizeAttenuation:!0===j.sizeAttenuation,logarithmicDepthBuffer:_,skinning:!0===me.isSkinnedMesh,morphTargets:void 0!==xe.morphAttributes.position,morphNormals:void 0!==xe.morphAttributes.normal,morphColors:void 0!==xe.morphAttributes.color,morphTargetsCount:_e,morphTextureStride:He,numDirLights:K.directional.length,numPointLights:K.point.length,numSpotLights:K.spot.length,numSpotLightMaps:K.spotLightMap.length,numRectAreaLights:K.rectArea.length,numHemiLights:K.hemi.length,numDirLightShadows:K.directionalShadowMap.length,numPointLightShadows:K.pointShadowMap.length,numSpotLightShadows:K.spotShadowMap.length,numSpotLightShadowsWithMaps:K.numSpotLightShadowsWithMaps,numClippingPlanes:c.numPlanes,numClipIntersection:c.numIntersection,dithering:j.dithering,shadowMapEnabled:o.shadowMap.enabled&&Me.length>0,shadowMapType:o.shadowMap.type,toneMapping:mr,useLegacyLights:o._useLegacyLights,premultipliedAlpha:j.premultipliedAlpha,doubleSided:2===j.side,flipSided:1===j.side,useDepthPacking:j.depthPacking>=0,depthPacking:j.depthPacking||0,index0AttributeName:j.index0AttributeName,extensionDerivatives:xt&&!0===j.extensions.derivatives,extensionFragDepth:xt&&!0===j.extensions.fragDepth,extensionDrawBuffers:xt&&!0===j.extensions.drawBuffers,extensionShaderTextureLOD:xt&&!0===j.extensions.shaderTextureLOD,rendererExtensionFragDepth:v||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:v||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:v||n.has("EXT_shader_texture_lod"),customProgramCacheKey:j.customProgramCacheKey()}},getProgramCacheKey:function T(j){const K=[];if(j.shaderID?K.push(j.shaderID):(K.push(j.customVertexShaderID),K.push(j.customFragmentShaderID)),void 0!==j.defines)for(const Me in j.defines)K.push(Me),K.push(j.defines[Me]);return!1===j.isRawShaderMaterial&&(function U(j,K){j.push(K.precision),j.push(K.outputColorSpace),j.push(K.envMapMode),j.push(K.envMapCubeUVHeight),j.push(K.mapUv),j.push(K.alphaMapUv),j.push(K.lightMapUv),j.push(K.aoMapUv),j.push(K.bumpMapUv),j.push(K.normalMapUv),j.push(K.displacementMapUv),j.push(K.emissiveMapUv),j.push(K.metalnessMapUv),j.push(K.roughnessMapUv),j.push(K.anisotropyMapUv),j.push(K.clearcoatMapUv),j.push(K.clearcoatNormalMapUv),j.push(K.clearcoatRoughnessMapUv),j.push(K.iridescenceMapUv),j.push(K.iridescenceThicknessMapUv),j.push(K.sheenColorMapUv),j.push(K.sheenRoughnessMapUv),j.push(K.specularMapUv),j.push(K.specularColorMapUv),j.push(K.specularIntensityMapUv),j.push(K.transmissionMapUv),j.push(K.thicknessMapUv),j.push(K.combine),j.push(K.fogExp2),j.push(K.sizeAttenuation),j.push(K.morphTargetsCount),j.push(K.morphAttributeCount),j.push(K.numDirLights),j.push(K.numPointLights),j.push(K.numSpotLights),j.push(K.numSpotLightMaps),j.push(K.numHemiLights),j.push(K.numRectAreaLights),j.push(K.numDirLightShadows),j.push(K.numPointLightShadows),j.push(K.numSpotLightShadows),j.push(K.numSpotLightShadowsWithMaps),j.push(K.shadowMapType),j.push(K.toneMapping),j.push(K.numClippingPlanes),j.push(K.numClipIntersection),j.push(K.depthPacking)}(K,j),function F(j,K){u.disableAll(),K.isWebGL2&&u.enable(0),K.supportsVertexTextures&&u.enable(1),K.instancing&&u.enable(2),K.instancingColor&&u.enable(3),K.matcap&&u.enable(4),K.envMap&&u.enable(5),K.normalMapObjectSpace&&u.enable(6),K.normalMapTangentSpace&&u.enable(7),K.clearcoat&&u.enable(8),K.iridescence&&u.enable(9),K.alphaTest&&u.enable(10),K.vertexColors&&u.enable(11),K.vertexAlphas&&u.enable(12),K.vertexUv1s&&u.enable(13),K.vertexUv2s&&u.enable(14),K.vertexUv3s&&u.enable(15),K.vertexTangents&&u.enable(16),K.anisotropy&&u.enable(17),j.push(u.mask),u.disableAll(),K.fog&&u.enable(0),K.useFog&&u.enable(1),K.flatShading&&u.enable(2),K.logarithmicDepthBuffer&&u.enable(3),K.skinning&&u.enable(4),K.morphTargets&&u.enable(5),K.morphNormals&&u.enable(6),K.morphColors&&u.enable(7),K.premultipliedAlpha&&u.enable(8),K.shadowMapEnabled&&u.enable(9),K.useLegacyLights&&u.enable(10),K.doubleSided&&u.enable(11),K.flipSided&&u.enable(12),K.useDepthPacking&&u.enable(13),K.dithering&&u.enable(14),K.transmission&&u.enable(15),K.sheen&&u.enable(16),K.opaque&&u.enable(17),K.pointsUvs&&u.enable(18),j.push(u.mask)}(K,j),K.push(o.outputColorSpace)),K.push(j.customProgramCacheKey),K.join()},getUniforms:function V(j){const K=A[j.type];let Me;return Me=K?xc.clone(Vl[K].uniforms):j.uniforms,Me},acquireProgram:function X(j,K){let Me;for(let De=0,me=p.length;De<me;De++){const pe=p[De];if(pe.cacheKey===K){Me=pe,++Me.usedTimes;break}}return void 0===Me&&(Me=new Ld(o,K,j,a),p.push(Me)),Me},releaseProgram:function Z(j){if(0==--j.usedTimes){const K=p.indexOf(j);p[K]=p[p.length-1],p.pop(),j.destroy()}},releaseShaderCache:function q(j){d.remove(j)},programs:p,dispose:function ee(){d.dispose()}}}function Bg(){let o=new WeakMap;return{get:function e(a){let c=o.get(a);return void 0===c&&(c={},o.set(a,c)),c},remove:function t(a){o.delete(a)},update:function n(a,c,u){o.get(a)[c]=u},dispose:function i(){o=new WeakMap}}}function wh(o,e){return o.groupOrder!==e.groupOrder?o.groupOrder-e.groupOrder:o.renderOrder!==e.renderOrder?o.renderOrder-e.renderOrder:o.material.id!==e.material.id?o.material.id-e.material.id:o.z!==e.z?o.z-e.z:o.id-e.id}function xu(o,e){return o.groupOrder!==e.groupOrder?o.groupOrder-e.groupOrder:o.renderOrder!==e.renderOrder?o.renderOrder-e.renderOrder:o.z!==e.z?e.z-o.z:o.id-e.id}function Mu(){const o=[];let e=0;const t=[],n=[],i=[];function c(_,M,b,A,P,R){let T=o[e];return void 0===T?(T={id:_.id,object:_,geometry:M,material:b,groupOrder:A,renderOrder:_.renderOrder,z:P,group:R},o[e]=T):(T.id=_.id,T.object=_,T.geometry=M,T.material=b,T.groupOrder=A,T.renderOrder=_.renderOrder,T.z=P,T.group=R),e++,T}return{opaque:t,transmissive:n,transparent:i,init:function a(){e=0,t.length=0,n.length=0,i.length=0},push:function u(_,M,b,A,P,R){const T=c(_,M,b,A,P,R);b.transmission>0?n.push(T):!0===b.transparent?i.push(T):t.push(T)},unshift:function d(_,M,b,A,P,R){const T=c(_,M,b,A,P,R);b.transmission>0?n.unshift(T):!0===b.transparent?i.unshift(T):t.unshift(T)},finish:function v(){for(let _=e,M=o.length;_<M;_++){const b=o[_];if(null===b.id)break;b.id=null,b.object=null,b.geometry=null,b.material=null,b.group=null}},sort:function p(_,M){t.length>1&&t.sort(_||wh),n.length>1&&n.sort(M||xu),i.length>1&&i.sort(M||xu)}}}function Eh(){let o=new WeakMap;return{get:function e(n,i){const a=o.get(n);let c;return void 0===a?(c=new Mu,o.set(n,[c])):i>=a.length?(c=new Mu,a.push(c)):c=a[i],c},dispose:function t(){o=new WeakMap}}}function Sh(){const o={};return{get:function(e){if(void 0!==o[e.id])return o[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new Q,color:new ut};break;case"SpotLight":t={position:new Q,direction:new Q,color:new ut,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new Q,color:new ut,distance:0,decay:0};break;case"HemisphereLight":t={direction:new Q,skyColor:new ut,groundColor:new ut};break;case"RectAreaLight":t={color:new ut,position:new Q,halfWidth:new Q,halfHeight:new Q}}return o[e.id]=t,t}}}let Th=0;function Ch(o,e){return(e.castShadow?2:0)-(o.castShadow?2:0)+(e.map?1:0)-(o.map?1:0)}function Dh(o,e){const t=new Sh,n=function Ah(){const o={};return{get:function(e){if(void 0!==o[e.id])return o[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Be};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Be,shadowCameraNear:1,shadowCameraFar:1e3}}return o[e.id]=t,t}}}(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let v=0;v<9;v++)i.probe.push(new Q);const a=new Q,c=new Yt,u=new Yt;return{setup:function d(v,_){let M=0,b=0,A=0;for(let Me=0;Me<9;Me++)i.probe[Me].set(0,0,0);let P=0,R=0,T=0,U=0,F=0,V=0,X=0,Z=0,q=0,ee=0;v.sort(Ch);const j=!0===_?Math.PI:1;for(let Me=0,De=v.length;Me<De;Me++){const me=v[Me],pe=me.color,xe=me.intensity,Ne=me.distance,Pe=me.shadow&&me.shadow.map?me.shadow.map.texture:null;if(me.isAmbientLight)M+=pe.r*xe*j,b+=pe.g*xe*j,A+=pe.b*xe*j;else if(me.isLightProbe)for(let ze=0;ze<9;ze++)i.probe[ze].addScaledVector(me.sh.coefficients[ze],xe);else if(me.isDirectionalLight){const ze=t.get(me);if(ze.color.copy(me.color).multiplyScalar(me.intensity*j),me.castShadow){const $e=me.shadow,Ke=n.get(me);Ke.shadowBias=$e.bias,Ke.shadowNormalBias=$e.normalBias,Ke.shadowRadius=$e.radius,Ke.shadowMapSize=$e.mapSize,i.directionalShadow[P]=Ke,i.directionalShadowMap[P]=Pe,i.directionalShadowMatrix[P]=me.shadow.matrix,V++}i.directional[P]=ze,P++}else if(me.isSpotLight){const ze=t.get(me);ze.position.setFromMatrixPosition(me.matrixWorld),ze.color.copy(pe).multiplyScalar(xe*j),ze.distance=Ne,ze.coneCos=Math.cos(me.angle),ze.penumbraCos=Math.cos(me.angle*(1-me.penumbra)),ze.decay=me.decay,i.spot[T]=ze;const $e=me.shadow;if(me.map&&(i.spotLightMap[q]=me.map,q++,$e.updateMatrices(me),me.castShadow&&ee++),i.spotLightMatrix[T]=$e.matrix,me.castShadow){const Ke=n.get(me);Ke.shadowBias=$e.bias,Ke.shadowNormalBias=$e.normalBias,Ke.shadowRadius=$e.radius,Ke.shadowMapSize=$e.mapSize,i.spotShadow[T]=Ke,i.spotShadowMap[T]=Pe,Z++}T++}else if(me.isRectAreaLight){const ze=t.get(me);ze.color.copy(pe).multiplyScalar(xe),ze.halfWidth.set(.5*me.width,0,0),ze.halfHeight.set(0,.5*me.height,0),i.rectArea[U]=ze,U++}else if(me.isPointLight){const ze=t.get(me);if(ze.color.copy(me.color).multiplyScalar(me.intensity*j),ze.distance=me.distance,ze.decay=me.decay,me.castShadow){const $e=me.shadow,Ke=n.get(me);Ke.shadowBias=$e.bias,Ke.shadowNormalBias=$e.normalBias,Ke.shadowRadius=$e.radius,Ke.shadowMapSize=$e.mapSize,Ke.shadowCameraNear=$e.camera.near,Ke.shadowCameraFar=$e.camera.far,i.pointShadow[R]=Ke,i.pointShadowMap[R]=Pe,i.pointShadowMatrix[R]=me.shadow.matrix,X++}i.point[R]=ze,R++}else if(me.isHemisphereLight){const ze=t.get(me);ze.skyColor.copy(me.color).multiplyScalar(xe*j),ze.groundColor.copy(me.groundColor).multiplyScalar(xe*j),i.hemi[F]=ze,F++}}U>0&&(e.isWebGL2||!0===o.has("OES_texture_float_linear")?(i.rectAreaLTC1=Vt.LTC_FLOAT_1,i.rectAreaLTC2=Vt.LTC_FLOAT_2):!0===o.has("OES_texture_half_float_linear")?(i.rectAreaLTC1=Vt.LTC_HALF_1,i.rectAreaLTC2=Vt.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),i.ambient[0]=M,i.ambient[1]=b,i.ambient[2]=A;const K=i.hash;(K.directionalLength!==P||K.pointLength!==R||K.spotLength!==T||K.rectAreaLength!==U||K.hemiLength!==F||K.numDirectionalShadows!==V||K.numPointShadows!==X||K.numSpotShadows!==Z||K.numSpotMaps!==q)&&(i.directional.length=P,i.spot.length=T,i.rectArea.length=U,i.point.length=R,i.hemi.length=F,i.directionalShadow.length=V,i.directionalShadowMap.length=V,i.pointShadow.length=X,i.pointShadowMap.length=X,i.spotShadow.length=Z,i.spotShadowMap.length=Z,i.directionalShadowMatrix.length=V,i.pointShadowMatrix.length=X,i.spotLightMatrix.length=Z+q-ee,i.spotLightMap.length=q,i.numSpotLightShadowsWithMaps=ee,K.directionalLength=P,K.pointLength=R,K.spotLength=T,K.rectAreaLength=U,K.hemiLength=F,K.numDirectionalShadows=V,K.numPointShadows=X,K.numSpotShadows=Z,K.numSpotMaps=q,i.version=Th++)},setupView:function p(v,_){let M=0,b=0,A=0,P=0,R=0;const T=_.matrixWorldInverse;for(let U=0,F=v.length;U<F;U++){const V=v[U];if(V.isDirectionalLight){const X=i.directional[M];X.direction.setFromMatrixPosition(V.matrixWorld),a.setFromMatrixPosition(V.target.matrixWorld),X.direction.sub(a),X.direction.transformDirection(T),M++}else if(V.isSpotLight){const X=i.spot[A];X.position.setFromMatrixPosition(V.matrixWorld),X.position.applyMatrix4(T),X.direction.setFromMatrixPosition(V.matrixWorld),a.setFromMatrixPosition(V.target.matrixWorld),X.direction.sub(a),X.direction.transformDirection(T),A++}else if(V.isRectAreaLight){const X=i.rectArea[P];X.position.setFromMatrixPosition(V.matrixWorld),X.position.applyMatrix4(T),u.identity(),c.copy(V.matrixWorld),c.premultiply(T),u.extractRotation(c),X.halfWidth.set(.5*V.width,0,0),X.halfHeight.set(0,.5*V.height,0),X.halfWidth.applyMatrix4(u),X.halfHeight.applyMatrix4(u),P++}else if(V.isPointLight){const X=i.point[b];X.position.setFromMatrixPosition(V.matrixWorld),X.position.applyMatrix4(T),b++}else if(V.isHemisphereLight){const X=i.hemi[R];X.direction.setFromMatrixPosition(V.matrixWorld),X.direction.transformDirection(T),R++}}},state:i}}function Vg(o,e){const t=new Dh(o,e),n=[],i=[];return{init:function a(){n.length=0,i.length=0},state:{lightsArray:n,shadowsArray:i,lights:t},setupLights:function d(_){t.setup(n,_)},setupLightsView:function p(_){t.setupView(n,_)},pushLight:function c(_){n.push(_)},pushShadow:function u(_){i.push(_)}}}function E0(o,e){let t=new WeakMap;return{get:function n(a,c=0){const u=t.get(a);let d;return void 0===u?(d=new Vg(o,e),t.set(a,[d])):c>=u.length?(d=new Vg(o,e),u.push(d)):d=u[c],d},dispose:function i(){t=new WeakMap}}}class zg extends lo{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class Hg extends lo{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function T0(o,e,t){let n=new tp;const i=new Be,a=new Be,c=new Ci,u=new zg({depthPacking:3201}),d=new Hg,p={},v=t.maxTextureSize,_={0:1,1:0,2:2},M=new es({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Be},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),b=M.clone();b.defines.HORIZONTAL_PASS=1;const A=new Un;A.setAttribute("position",new sr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const P=new Ji(A,M),R=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1;let T=this.type;function U(X,Z){const q=e.update(P);M.defines.VSM_SAMPLES!==X.blurSamples&&(M.defines.VSM_SAMPLES=X.blurSamples,b.defines.VSM_SAMPLES=X.blurSamples,M.needsUpdate=!0,b.needsUpdate=!0),null===X.mapPass&&(X.mapPass=new ba(i.x,i.y)),M.uniforms.shadow_pass.value=X.map.texture,M.uniforms.resolution.value=X.mapSize,M.uniforms.radius.value=X.radius,o.setRenderTarget(X.mapPass),o.clear(),o.renderBufferDirect(Z,null,q,M,P,null),b.uniforms.shadow_pass.value=X.mapPass.texture,b.uniforms.resolution.value=X.mapSize,b.uniforms.radius.value=X.radius,o.setRenderTarget(X.map),o.clear(),o.renderBufferDirect(Z,null,q,b,P,null)}function F(X,Z,q,ee){let j=null;const K=!0===q.isPointLight?X.customDistanceMaterial:X.customDepthMaterial;if(void 0!==K)j=K;else if(j=!0===q.isPointLight?d:u,o.localClippingEnabled&&!0===Z.clipShadows&&Array.isArray(Z.clippingPlanes)&&0!==Z.clippingPlanes.length||Z.displacementMap&&0!==Z.displacementScale||Z.alphaMap&&Z.alphaTest>0||Z.map&&Z.alphaTest>0){const Me=j.uuid,De=Z.uuid;let me=p[Me];void 0===me&&(me={},p[Me]=me);let pe=me[De];void 0===pe&&(pe=j.clone(),me[De]=pe),j=pe}return j.visible=Z.visible,j.wireframe=Z.wireframe,j.side=3===ee?null!==Z.shadowSide?Z.shadowSide:Z.side:null!==Z.shadowSide?Z.shadowSide:_[Z.side],j.alphaMap=Z.alphaMap,j.alphaTest=Z.alphaTest,j.map=Z.map,j.clipShadows=Z.clipShadows,j.clippingPlanes=Z.clippingPlanes,j.clipIntersection=Z.clipIntersection,j.displacementMap=Z.displacementMap,j.displacementScale=Z.displacementScale,j.displacementBias=Z.displacementBias,j.wireframeLinewidth=Z.wireframeLinewidth,j.linewidth=Z.linewidth,!0===q.isPointLight&&!0===j.isMeshDistanceMaterial&&(o.properties.get(j).light=q),j}function V(X,Z,q,ee,j){if(!1===X.visible)return;if(X.layers.test(Z.layers)&&(X.isMesh||X.isLine||X.isPoints)&&(X.castShadow||X.receiveShadow&&3===j)&&(!X.frustumCulled||n.intersectsObject(X))){X.modelViewMatrix.multiplyMatrices(q.matrixWorldInverse,X.matrixWorld);const De=e.update(X),me=X.material;if(Array.isArray(me)){const pe=De.groups;for(let xe=0,Ne=pe.length;xe<Ne;xe++){const Pe=pe[xe],ze=me[Pe.materialIndex];if(ze&&ze.visible){const $e=F(X,ze,ee,j);o.renderBufferDirect(q,null,De,$e,X,Pe)}}}else if(me.visible){const pe=F(X,me,ee,j);o.renderBufferDirect(q,null,De,pe,X,null)}}const Me=X.children;for(let De=0,me=Me.length;De<me;De++)V(Me[De],Z,q,ee,j)}this.render=function(X,Z,q){if(!1===R.enabled||!1===R.autoUpdate&&!1===R.needsUpdate||0===X.length)return;const ee=o.getRenderTarget(),j=o.getActiveCubeFace(),K=o.getActiveMipmapLevel(),Me=o.state;Me.setBlending(0),Me.buffers.color.setClear(1,1,1,1),Me.buffers.depth.setTest(!0),Me.setScissorTest(!1);const De=3!==T&&3===this.type,me=3===T&&3!==this.type;for(let pe=0,xe=X.length;pe<xe;pe++){const Ne=X[pe],Pe=Ne.shadow;if(void 0===Pe){console.warn("THREE.WebGLShadowMap:",Ne,"has no shadow.");continue}if(!1===Pe.autoUpdate&&!1===Pe.needsUpdate)continue;i.copy(Pe.mapSize);const ze=Pe.getFrameExtents();if(i.multiply(ze),a.copy(Pe.mapSize),(i.x>v||i.y>v)&&(i.x>v&&(a.x=Math.floor(v/ze.x),i.x=a.x*ze.x,Pe.mapSize.x=a.x),i.y>v&&(a.y=Math.floor(v/ze.y),i.y=a.y*ze.y,Pe.mapSize.y=a.y)),null===Pe.map||!0===De||!0===me){const Ke=3!==this.type?{minFilter:Fi,magFilter:Fi}:{};null!==Pe.map&&Pe.map.dispose(),Pe.map=new ba(i.x,i.y,Ke),Pe.map.texture.name=Ne.name+".shadowMap",Pe.camera.updateProjectionMatrix()}o.setRenderTarget(Pe.map),o.clear();const $e=Pe.getViewportCount();for(let Ke=0;Ke<$e;Ke++){const _e=Pe.getViewport(Ke);c.set(a.x*_e.x,a.y*_e.y,a.x*_e.z,a.y*_e.w),Me.viewport(c),Pe.updateMatrices(Ne,Ke),n=Pe.getFrustum(),V(Z,q,Pe.camera,Ne,this.type)}!0!==Pe.isPointLightShadow&&3===this.type&&U(Pe,q),Pe.needsUpdate=!1}T=this.type,R.needsUpdate=!1,o.setRenderTarget(ee,j,K)}}function C0(o,e,t){const n=t.isWebGL2,u=new function i(){let fe=!1;const Ht=new Ci;let Le=null;const xt=new Ci(0,0,0,0);return{setMask:function(Gt){Le!==Gt&&!fe&&(o.colorMask(Gt,Gt,Gt,Gt),Le=Gt)},setLocked:function(Gt){fe=Gt},setClear:function(Gt,ui,Gi,mr,td){!0===td&&(Gt*=mr,ui*=mr,Gi*=mr),Ht.set(Gt,ui,Gi,mr),!1===xt.equals(Ht)&&(o.clearColor(Gt,ui,Gi,mr),xt.copy(Ht))},reset:function(){fe=!1,Le=null,xt.set(-1,0,0,0)}}},d=new function a(){let fe=!1,Ht=null,Le=null,xt=null;return{setTest:function(Gt){Gt?sn(o.DEPTH_TEST):nn(o.DEPTH_TEST)},setMask:function(Gt){Ht!==Gt&&!fe&&(o.depthMask(Gt),Ht=Gt)},setFunc:function(Gt){if(Le!==Gt){switch(Gt){case 0:o.depthFunc(o.NEVER);break;case 1:o.depthFunc(o.ALWAYS);break;case 2:o.depthFunc(o.LESS);break;case 3:default:o.depthFunc(o.LEQUAL);break;case 4:o.depthFunc(o.EQUAL);break;case 5:o.depthFunc(o.GEQUAL);break;case 6:o.depthFunc(o.GREATER);break;case 7:o.depthFunc(o.NOTEQUAL)}Le=Gt}},setLocked:function(Gt){fe=Gt},setClear:function(Gt){xt!==Gt&&(o.clearDepth(Gt),xt=Gt)},reset:function(){fe=!1,Ht=null,Le=null,xt=null}}},p=new function c(){let fe=!1,Ht=null,Le=null,xt=null,Gt=null,ui=null,Gi=null,mr=null,td=null;return{setTest:function(gr){fe||(gr?sn(o.STENCIL_TEST):nn(o.STENCIL_TEST))},setMask:function(gr){Ht!==gr&&!fe&&(o.stencilMask(gr),Ht=gr)},setFunc:function(gr,Uc,Lo){(Le!==gr||xt!==Uc||Gt!==Lo)&&(o.stencilFunc(gr,Uc,Lo),Le=gr,xt=Uc,Gt=Lo)},setOp:function(gr,Uc,Lo){(ui!==gr||Gi!==Uc||mr!==Lo)&&(o.stencilOp(gr,Uc,Lo),ui=gr,Gi=Uc,mr=Lo)},setLocked:function(gr){fe=gr},setClear:function(gr){td!==gr&&(o.clearStencil(gr),td=gr)},reset:function(){fe=!1,Ht=null,Le=null,xt=null,Gt=null,ui=null,Gi=null,mr=null,td=null}}},v=new WeakMap,_=new WeakMap;let M={},b={},A=new WeakMap,P=[],R=null,T=!1,U=null,F=null,V=null,X=null,Z=null,q=null,ee=null,j=!1,K=null,Me=null,De=null,me=null,pe=null;const xe=o.getParameter(o.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Ne=!1,Pe=0;const ze=o.getParameter(o.VERSION);-1!==ze.indexOf("WebGL")?(Pe=parseFloat(/^WebGL (\d)/.exec(ze)[1]),Ne=Pe>=1):-1!==ze.indexOf("OpenGL ES")&&(Pe=parseFloat(/^OpenGL ES (\d)/.exec(ze)[1]),Ne=Pe>=2);let $e=null,Ke={};const _e=o.getParameter(o.SCISSOR_BOX),He=o.getParameter(o.VIEWPORT),ft=(new Ci).fromArray(_e),ht=(new Ci).fromArray(He);function pt(fe,Ht,Le,xt){const Gt=new Uint8Array(4),ui=o.createTexture();o.bindTexture(fe,ui),o.texParameteri(fe,o.TEXTURE_MIN_FILTER,o.NEAREST),o.texParameteri(fe,o.TEXTURE_MAG_FILTER,o.NEAREST);for(let Gi=0;Gi<Le;Gi++)!n||fe!==o.TEXTURE_3D&&fe!==o.TEXTURE_2D_ARRAY?o.texImage2D(Ht+Gi,0,o.RGBA,1,1,0,o.RGBA,o.UNSIGNED_BYTE,Gt):o.texImage3D(Ht,0,o.RGBA,1,1,xt,0,o.RGBA,o.UNSIGNED_BYTE,Gt);return ui}const Zt={};function sn(fe){!0!==M[fe]&&(o.enable(fe),M[fe]=!0)}function nn(fe){!1!==M[fe]&&(o.disable(fe),M[fe]=!1)}Zt[o.TEXTURE_2D]=pt(o.TEXTURE_2D,o.TEXTURE_2D,1),Zt[o.TEXTURE_CUBE_MAP]=pt(o.TEXTURE_CUBE_MAP,o.TEXTURE_CUBE_MAP_POSITIVE_X,6),n&&(Zt[o.TEXTURE_2D_ARRAY]=pt(o.TEXTURE_2D_ARRAY,o.TEXTURE_2D_ARRAY,1,1),Zt[o.TEXTURE_3D]=pt(o.TEXTURE_3D,o.TEXTURE_3D,1,1)),u.setClear(0,0,0,1),d.setClear(1),p.setClear(0),sn(o.DEPTH_TEST),d.setFunc(3),it(!1),bn(1),sn(o.CULL_FACE),Ye(0);const ce={100:o.FUNC_ADD,101:o.FUNC_SUBTRACT,102:o.FUNC_REVERSE_SUBTRACT};if(n)ce[103]=o.MIN,ce[104]=o.MAX;else{const fe=e.get("EXT_blend_minmax");null!==fe&&(ce[103]=fe.MIN_EXT,ce[104]=fe.MAX_EXT)}const Lt={200:o.ZERO,201:o.ONE,202:o.SRC_COLOR,204:o.SRC_ALPHA,210:o.SRC_ALPHA_SATURATE,208:o.DST_COLOR,206:o.DST_ALPHA,203:o.ONE_MINUS_SRC_COLOR,205:o.ONE_MINUS_SRC_ALPHA,209:o.ONE_MINUS_DST_COLOR,207:o.ONE_MINUS_DST_ALPHA};function Ye(fe,Ht,Le,xt,Gt,ui,Gi,mr){if(0!==fe){if(!1===T&&(sn(o.BLEND),T=!0),5===fe)Gt=Gt||Ht,ui=ui||Le,Gi=Gi||xt,(Ht!==F||Gt!==Z)&&(o.blendEquationSeparate(ce[Ht],ce[Gt]),F=Ht,Z=Gt),(Le!==V||xt!==X||ui!==q||Gi!==ee)&&(o.blendFuncSeparate(Lt[Le],Lt[xt],Lt[ui],Lt[Gi]),V=Le,X=xt,q=ui,ee=Gi),U=fe,j=!1;else if(fe!==U||mr!==j){if((100!==F||100!==Z)&&(o.blendEquation(o.FUNC_ADD),F=100,Z=100),mr)switch(fe){case 1:o.blendFuncSeparate(o.ONE,o.ONE_MINUS_SRC_ALPHA,o.ONE,o.ONE_MINUS_SRC_ALPHA);break;case 2:o.blendFunc(o.ONE,o.ONE);break;case 3:o.blendFuncSeparate(o.ZERO,o.ONE_MINUS_SRC_COLOR,o.ZERO,o.ONE);break;case 4:o.blendFuncSeparate(o.ZERO,o.SRC_COLOR,o.ZERO,o.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",fe)}else switch(fe){case 1:o.blendFuncSeparate(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA,o.ONE,o.ONE_MINUS_SRC_ALPHA);break;case 2:o.blendFunc(o.SRC_ALPHA,o.ONE);break;case 3:o.blendFuncSeparate(o.ZERO,o.ONE_MINUS_SRC_COLOR,o.ZERO,o.ONE);break;case 4:o.blendFunc(o.ZERO,o.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",fe)}V=null,X=null,q=null,ee=null,U=fe,j=mr}}else!0===T&&(nn(o.BLEND),T=!1)}function it(fe){K!==fe&&(o.frontFace(fe?o.CW:o.CCW),K=fe)}function bn(fe){0!==fe?(sn(o.CULL_FACE),fe!==Me&&o.cullFace(1===fe?o.BACK:2===fe?o.FRONT:o.FRONT_AND_BACK)):nn(o.CULL_FACE),Me=fe}function on(fe,Ht,Le){fe?(sn(o.POLYGON_OFFSET_FILL),(me!==Ht||pe!==Le)&&(o.polygonOffset(Ht,Le),me=Ht,pe=Le)):nn(o.POLYGON_OFFSET_FILL)}return{buffers:{color:u,depth:d,stencil:p},enable:sn,disable:nn,bindFramebuffer:function li(fe,Ht){return b[fe]!==Ht&&(o.bindFramebuffer(fe,Ht),b[fe]=Ht,n&&(fe===o.DRAW_FRAMEBUFFER&&(b[o.FRAMEBUFFER]=Ht),fe===o.FRAMEBUFFER&&(b[o.DRAW_FRAMEBUFFER]=Ht)),!0)},drawBuffers:function ci(fe,Ht){let Le=P,xt=!1;if(fe)if(Le=A.get(Ht),void 0===Le&&(Le=[],A.set(Ht,Le)),fe.isWebGLMultipleRenderTargets){const Gt=fe.texture;if(Le.length!==Gt.length||Le[0]!==o.COLOR_ATTACHMENT0){for(let ui=0,Gi=Gt.length;ui<Gi;ui++)Le[ui]=o.COLOR_ATTACHMENT0+ui;Le.length=Gt.length,xt=!0}}else Le[0]!==o.COLOR_ATTACHMENT0&&(Le[0]=o.COLOR_ATTACHMENT0,xt=!0);else Le[0]!==o.BACK&&(Le[0]=o.BACK,xt=!0);xt&&(t.isWebGL2?o.drawBuffers(Le):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Le))},useProgram:function xn(fe){return R!==fe&&(o.useProgram(fe),R=fe,!0)},setBlending:Ye,setMaterial:function St(fe,Ht){2===fe.side?nn(o.CULL_FACE):sn(o.CULL_FACE);let Le=1===fe.side;Ht&&(Le=!Le),it(Le),1===fe.blending&&!1===fe.transparent?Ye(0):Ye(fe.blending,fe.blendEquation,fe.blendSrc,fe.blendDst,fe.blendEquationAlpha,fe.blendSrcAlpha,fe.blendDstAlpha,fe.premultipliedAlpha),d.setFunc(fe.depthFunc),d.setTest(fe.depthTest),d.setMask(fe.depthWrite),u.setMask(fe.colorWrite);const xt=fe.stencilWrite;p.setTest(xt),xt&&(p.setMask(fe.stencilWriteMask),p.setFunc(fe.stencilFunc,fe.stencilRef,fe.stencilFuncMask),p.setOp(fe.stencilFail,fe.stencilZFail,fe.stencilZPass)),on(fe.polygonOffset,fe.polygonOffsetFactor,fe.polygonOffsetUnits),!0===fe.alphaToCoverage?sn(o.SAMPLE_ALPHA_TO_COVERAGE):nn(o.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:it,setCullFace:bn,setLineWidth:function Qt(fe){fe!==De&&(Ne&&o.lineWidth(fe),De=fe)},setPolygonOffset:on,setScissorTest:function On(fe){fe?sn(o.SCISSOR_TEST):nn(o.SCISSOR_TEST)},activeTexture:function gi(fe){void 0===fe&&(fe=o.TEXTURE0+xe-1),$e!==fe&&(o.activeTexture(fe),$e=fe)},bindTexture:function Er(fe,Ht,Le){void 0===Le&&(Le=null===$e?o.TEXTURE0+xe-1:$e);let xt=Ke[Le];void 0===xt&&(xt={type:void 0,texture:void 0},Ke[Le]=xt),(xt.type!==fe||xt.texture!==Ht)&&($e!==Le&&(o.activeTexture(Le),$e=Le),o.bindTexture(fe,Ht||Zt[fe]),xt.type=fe,xt.texture=Ht)},unbindTexture:function oe(){const fe=Ke[$e];void 0!==fe&&void 0!==fe.type&&(o.bindTexture(fe.type,null),fe.type=void 0,fe.texture=void 0)},compressedTexImage2D:function J(){try{o.compressedTexImage2D.apply(o,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}},compressedTexImage3D:function Re(){try{o.compressedTexImage3D.apply(o,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}},texImage2D:function he(){try{o.texImage2D.apply(o,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}},texImage3D:function nt(){try{o.texImage3D.apply(o,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}},updateUBOMapping:function jt(fe,Ht){let Le=_.get(Ht);void 0===Le&&(Le=new WeakMap,_.set(Ht,Le));let xt=Le.get(fe);void 0===xt&&(xt=o.getUniformBlockIndex(Ht,fe.name),Le.set(fe,xt))},uniformBlockBinding:function Wn(fe,Ht){const xt=_.get(Ht).get(fe);v.get(Ht)!==xt&&(o.uniformBlockBinding(Ht,xt,fe.__bindingPointIndex),v.set(Ht,xt))},texStorage2D:function Ct(){try{o.texStorage2D.apply(o,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}},texStorage3D:function Fe(){try{o.texStorage3D.apply(o,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}},texSubImage2D:function wt(){try{o.texSubImage2D.apply(o,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}},texSubImage3D:function ct(){try{o.texSubImage3D.apply(o,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}},compressedTexSubImage2D:function At(){try{o.compressedTexSubImage2D.apply(o,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}},compressedTexSubImage3D:function yn(){try{o.compressedTexSubImage3D.apply(o,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}},scissor:function Xt(fe){!1===ft.equals(fe)&&(o.scissor(fe.x,fe.y,fe.z,fe.w),ft.copy(fe))},viewport:function Bt(fe){!1===ht.equals(fe)&&(o.viewport(fe.x,fe.y,fe.z,fe.w),ht.copy(fe))},reset:function Ei(){o.disable(o.BLEND),o.disable(o.CULL_FACE),o.disable(o.DEPTH_TEST),o.disable(o.POLYGON_OFFSET_FILL),o.disable(o.SCISSOR_TEST),o.disable(o.STENCIL_TEST),o.disable(o.SAMPLE_ALPHA_TO_COVERAGE),o.blendEquation(o.FUNC_ADD),o.blendFunc(o.ONE,o.ZERO),o.blendFuncSeparate(o.ONE,o.ZERO,o.ONE,o.ZERO),o.colorMask(!0,!0,!0,!0),o.clearColor(0,0,0,0),o.depthMask(!0),o.depthFunc(o.LESS),o.clearDepth(1),o.stencilMask(4294967295),o.stencilFunc(o.ALWAYS,0,4294967295),o.stencilOp(o.KEEP,o.KEEP,o.KEEP),o.clearStencil(0),o.cullFace(o.BACK),o.frontFace(o.CCW),o.polygonOffset(0,0),o.activeTexture(o.TEXTURE0),o.bindFramebuffer(o.FRAMEBUFFER,null),!0===n&&(o.bindFramebuffer(o.DRAW_FRAMEBUFFER,null),o.bindFramebuffer(o.READ_FRAMEBUFFER,null)),o.useProgram(null),o.lineWidth(1),o.scissor(0,0,o.canvas.width,o.canvas.height),o.viewport(0,0,o.canvas.width,o.canvas.height),M={},$e=null,Ke={},b={},A=new WeakMap,P=[],R=null,T=!1,U=null,F=null,V=null,X=null,Z=null,q=null,ee=null,j=!1,K=null,Me=null,De=null,me=null,pe=null,ft.set(0,0,o.canvas.width,o.canvas.height),ht.set(0,0,o.canvas.width,o.canvas.height),u.reset(),d.reset(),p.reset()}}}function D0(o,e,t,n,i,a,c){const u=i.isWebGL2,d=i.maxTextures,p=i.maxCubemapSize,v=i.maxTextureSize,_=i.maxSamples,M=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,b="undefined"!=typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),A=new WeakMap;let P;const R=new WeakMap;let T=!1;try{T="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(oe){}function U(oe,J){return T?new OffscreenCanvas(oe,J):iu("canvas")}function F(oe,J,Re,wt){let ct=1;if((oe.width>wt||oe.height>wt)&&(ct=wt/Math.max(oe.width,oe.height)),ct<1||!0===J){if("undefined"!=typeof HTMLImageElement&&oe instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&oe instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&oe instanceof ImageBitmap){const At=J?ks:Math.floor,yn=At(ct*oe.width),Ct=At(ct*oe.height);void 0===P&&(P=U(yn,Ct));const Fe=Re?U(yn,Ct):P;return Fe.width=yn,Fe.height=Ct,Fe.getContext("2d").drawImage(oe,0,0,yn,Ct),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+oe.width+"x"+oe.height+") to ("+yn+"x"+Ct+")."),Fe}return"data"in oe&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+oe.width+"x"+oe.height+")."),oe}return oe}function V(oe){return ay(oe.width)&&ay(oe.height)}function Z(oe,J){return oe.generateMipmaps&&J&&oe.minFilter!==Fi&&oe.minFilter!==Ii}function q(oe){o.generateMipmap(oe)}function ee(oe,J,Re,wt,ct=!1){if(!1===u)return J;if(null!==oe){if(void 0!==o[oe])return o[oe];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+oe+"'")}let At=J;return J===o.RED&&(Re===o.FLOAT&&(At=o.R32F),Re===o.HALF_FLOAT&&(At=o.R16F),Re===o.UNSIGNED_BYTE&&(At=o.R8)),J===o.RED_INTEGER&&(Re===o.UNSIGNED_BYTE&&(At=o.R8UI),Re===o.UNSIGNED_SHORT&&(At=o.R16UI),Re===o.UNSIGNED_INT&&(At=o.R32UI),Re===o.BYTE&&(At=o.R8I),Re===o.SHORT&&(At=o.R16I),Re===o.INT&&(At=o.R32I)),J===o.RG&&(Re===o.FLOAT&&(At=o.RG32F),Re===o.HALF_FLOAT&&(At=o.RG16F),Re===o.UNSIGNED_BYTE&&(At=o.RG8)),J===o.RGBA&&(Re===o.FLOAT&&(At=o.RGBA32F),Re===o.HALF_FLOAT&&(At=o.RGBA16F),Re===o.UNSIGNED_BYTE&&(At=wt===vn&&!1===ct?o.SRGB8_ALPHA8:o.RGBA8),Re===o.UNSIGNED_SHORT_4_4_4_4&&(At=o.RGBA4),Re===o.UNSIGNED_SHORT_5_5_5_1&&(At=o.RGB5_A1)),(At===o.R16F||At===o.R32F||At===o.RG16F||At===o.RG32F||At===o.RGBA16F||At===o.RGBA32F)&&e.get("EXT_color_buffer_float"),At}function j(oe,J,Re){return!0===Z(oe,Re)||oe.isFramebufferTexture&&oe.minFilter!==Fi&&oe.minFilter!==Ii?Math.log2(Math.max(J.width,J.height))+1:void 0!==oe.mipmaps&&oe.mipmaps.length>0?oe.mipmaps.length:oe.isCompressedTexture&&Array.isArray(oe.image)?J.mipmaps.length:1}function K(oe){return oe===Fi||1004===oe||1005===oe?o.NEAREST:o.LINEAR}function Me(oe){const J=oe.target;J.removeEventListener("dispose",Me),function me(oe){const J=n.get(oe);if(void 0===J.__webglInit)return;const Re=oe.source,wt=R.get(Re);if(wt){const ct=wt[J.__cacheKey];ct.usedTimes--,0===ct.usedTimes&&pe(oe),0===Object.keys(wt).length&&R.delete(Re)}n.remove(oe)}(J),J.isVideoTexture&&A.delete(J)}function De(oe){const J=oe.target;J.removeEventListener("dispose",De),function xe(oe){const J=oe.texture,Re=n.get(oe),wt=n.get(J);if(void 0!==wt.__webglTexture&&(o.deleteTexture(wt.__webglTexture),c.memory.textures--),oe.depthTexture&&oe.depthTexture.dispose(),oe.isWebGLCubeRenderTarget)for(let ct=0;ct<6;ct++){if(Array.isArray(Re.__webglFramebuffer[ct]))for(let At=0;At<Re.__webglFramebuffer[ct].length;At++)o.deleteFramebuffer(Re.__webglFramebuffer[ct][At]);else o.deleteFramebuffer(Re.__webglFramebuffer[ct]);Re.__webglDepthbuffer&&o.deleteRenderbuffer(Re.__webglDepthbuffer[ct])}else{if(Array.isArray(Re.__webglFramebuffer))for(let ct=0;ct<Re.__webglFramebuffer.length;ct++)o.deleteFramebuffer(Re.__webglFramebuffer[ct]);else o.deleteFramebuffer(Re.__webglFramebuffer);if(Re.__webglDepthbuffer&&o.deleteRenderbuffer(Re.__webglDepthbuffer),Re.__webglMultisampledFramebuffer&&o.deleteFramebuffer(Re.__webglMultisampledFramebuffer),Re.__webglColorRenderbuffer)for(let ct=0;ct<Re.__webglColorRenderbuffer.length;ct++)Re.__webglColorRenderbuffer[ct]&&o.deleteRenderbuffer(Re.__webglColorRenderbuffer[ct]);Re.__webglDepthRenderbuffer&&o.deleteRenderbuffer(Re.__webglDepthRenderbuffer)}if(oe.isWebGLMultipleRenderTargets)for(let ct=0,At=J.length;ct<At;ct++){const yn=n.get(J[ct]);yn.__webglTexture&&(o.deleteTexture(yn.__webglTexture),c.memory.textures--),n.remove(J[ct])}n.remove(J),n.remove(oe)}(J)}function pe(oe){const J=n.get(oe);o.deleteTexture(J.__webglTexture),delete R.get(oe.source)[J.__cacheKey],c.memory.textures--}let Ne=0;function Ke(oe,J){const Re=n.get(oe);if(oe.isVideoTexture&&function gi(oe){const J=c.render.frame;A.get(oe)!==J&&(A.set(oe,J),oe.update())}(oe),!1===oe.isRenderTargetTexture&&oe.version>0&&Re.__version!==oe.version){const wt=oe.image;if(null===wt)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==wt.complete)return void li(Re,oe,J);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(o.TEXTURE_2D,Re.__webglTexture,o.TEXTURE0+J)}const ht={[$i]:o.REPEAT,[ri]:o.CLAMP_TO_EDGE,1002:o.MIRRORED_REPEAT},pt={[Fi]:o.NEAREST,1004:o.NEAREST_MIPMAP_NEAREST,1005:o.NEAREST_MIPMAP_LINEAR,[Ii]:o.LINEAR,1007:o.LINEAR_MIPMAP_NEAREST,[Ms]:o.LINEAR_MIPMAP_LINEAR},Zt={512:o.NEVER,519:o.ALWAYS,513:o.LESS,515:o.LEQUAL,514:o.EQUAL,518:o.GEQUAL,516:o.GREATER,517:o.NOTEQUAL};function sn(oe,J,Re){if(Re?(o.texParameteri(oe,o.TEXTURE_WRAP_S,ht[J.wrapS]),o.texParameteri(oe,o.TEXTURE_WRAP_T,ht[J.wrapT]),(oe===o.TEXTURE_3D||oe===o.TEXTURE_2D_ARRAY)&&o.texParameteri(oe,o.TEXTURE_WRAP_R,ht[J.wrapR]),o.texParameteri(oe,o.TEXTURE_MAG_FILTER,pt[J.magFilter]),o.texParameteri(oe,o.TEXTURE_MIN_FILTER,pt[J.minFilter])):(o.texParameteri(oe,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(oe,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),(oe===o.TEXTURE_3D||oe===o.TEXTURE_2D_ARRAY)&&o.texParameteri(oe,o.TEXTURE_WRAP_R,o.CLAMP_TO_EDGE),(J.wrapS!==ri||J.wrapT!==ri)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),o.texParameteri(oe,o.TEXTURE_MAG_FILTER,K(J.magFilter)),o.texParameteri(oe,o.TEXTURE_MIN_FILTER,K(J.minFilter)),J.minFilter!==Fi&&J.minFilter!==Ii&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),J.compareFunction&&(o.texParameteri(oe,o.TEXTURE_COMPARE_MODE,o.COMPARE_REF_TO_TEXTURE),o.texParameteri(oe,o.TEXTURE_COMPARE_FUNC,Zt[J.compareFunction])),!0===e.has("EXT_texture_filter_anisotropic")){const wt=e.get("EXT_texture_filter_anisotropic");if(J.magFilter===Fi||1005!==J.minFilter&&J.minFilter!==Ms||J.type===Tn&&!1===e.has("OES_texture_float_linear")||!1===u&&J.type===_o&&!1===e.has("OES_texture_half_float_linear"))return;(J.anisotropy>1||n.get(J).__currentAnisotropy)&&(o.texParameterf(oe,wt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(J.anisotropy,i.getMaxAnisotropy())),n.get(J).__currentAnisotropy=J.anisotropy)}}function nn(oe,J){let Re=!1;void 0===oe.__webglInit&&(oe.__webglInit=!0,J.addEventListener("dispose",Me));const wt=J.source;let ct=R.get(wt);void 0===ct&&(ct={},R.set(wt,ct));const At=function $e(oe){const J=[];return J.push(oe.wrapS),J.push(oe.wrapT),J.push(oe.wrapR||0),J.push(oe.magFilter),J.push(oe.minFilter),J.push(oe.anisotropy),J.push(oe.internalFormat),J.push(oe.format),J.push(oe.type),J.push(oe.generateMipmaps),J.push(oe.premultiplyAlpha),J.push(oe.flipY),J.push(oe.unpackAlignment),J.push(oe.colorSpace),J.join()}(J);if(At!==oe.__cacheKey){void 0===ct[At]&&(ct[At]={texture:o.createTexture(),usedTimes:0},c.memory.textures++,Re=!0),ct[At].usedTimes++;const yn=ct[oe.__cacheKey];void 0!==yn&&(ct[oe.__cacheKey].usedTimes--,0===yn.usedTimes&&pe(J)),oe.__cacheKey=At,oe.__webglTexture=ct[At].texture}return Re}function li(oe,J,Re){let wt=o.TEXTURE_2D;(J.isDataArrayTexture||J.isCompressedArrayTexture)&&(wt=o.TEXTURE_2D_ARRAY),J.isData3DTexture&&(wt=o.TEXTURE_3D);const ct=nn(oe,J),At=J.source;t.bindTexture(wt,oe.__webglTexture,o.TEXTURE0+Re);const yn=n.get(At);if(At.version!==yn.__version||!0===ct){t.activeTexture(o.TEXTURE0+Re),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,J.flipY),o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,J.premultiplyAlpha),o.pixelStorei(o.UNPACK_ALIGNMENT,J.unpackAlignment),o.pixelStorei(o.UNPACK_COLORSPACE_CONVERSION_WEBGL,o.NONE);const Ct=function X(oe){return!u&&(oe.wrapS!==ri||oe.wrapT!==ri||oe.minFilter!==Fi&&oe.minFilter!==Ii)}(J)&&!1===V(J.image);let Fe=F(J.image,Ct,!1,v);Fe=Er(J,Fe);const he=V(Fe)||u,nt=a.convert(J.format,J.colorSpace);let jt,Xt=a.convert(J.type),Bt=ee(J.internalFormat,nt,Xt,J.colorSpace);sn(wt,J,he);const Wn=J.mipmaps,Ei=u&&!0!==J.isVideoTexture,fe=void 0===yn.__version||!0===ct,Ht=j(J,Fe,he);if(J.isDepthTexture)Bt=o.DEPTH_COMPONENT,u?Bt=J.type===Tn?o.DEPTH_COMPONENT32F:J.type===Ze?o.DEPTH_COMPONENT24:J.type===js?o.DEPTH24_STENCIL8:o.DEPTH_COMPONENT16:J.type===Tn&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),J.format===Go&&Bt===o.DEPTH_COMPONENT&&1012!==J.type&&J.type!==Ze&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),J.type=Ze,Xt=a.convert(J.type)),J.format===Xa&&Bt===o.DEPTH_COMPONENT&&(Bt=o.DEPTH_STENCIL,J.type!==js&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),J.type=js,Xt=a.convert(J.type))),fe&&(Ei?t.texStorage2D(o.TEXTURE_2D,1,Bt,Fe.width,Fe.height):t.texImage2D(o.TEXTURE_2D,0,Bt,Fe.width,Fe.height,0,nt,Xt,null));else if(J.isDataTexture)if(Wn.length>0&&he){Ei&&fe&&t.texStorage2D(o.TEXTURE_2D,Ht,Bt,Wn[0].width,Wn[0].height);for(let Le=0,xt=Wn.length;Le<xt;Le++)jt=Wn[Le],Ei?t.texSubImage2D(o.TEXTURE_2D,Le,0,0,jt.width,jt.height,nt,Xt,jt.data):t.texImage2D(o.TEXTURE_2D,Le,Bt,jt.width,jt.height,0,nt,Xt,jt.data);J.generateMipmaps=!1}else Ei?(fe&&t.texStorage2D(o.TEXTURE_2D,Ht,Bt,Fe.width,Fe.height),t.texSubImage2D(o.TEXTURE_2D,0,0,0,Fe.width,Fe.height,nt,Xt,Fe.data)):t.texImage2D(o.TEXTURE_2D,0,Bt,Fe.width,Fe.height,0,nt,Xt,Fe.data);else if(J.isCompressedTexture)if(J.isCompressedArrayTexture){Ei&&fe&&t.texStorage3D(o.TEXTURE_2D_ARRAY,Ht,Bt,Wn[0].width,Wn[0].height,Fe.depth);for(let Le=0,xt=Wn.length;Le<xt;Le++)jt=Wn[Le],J.format!==qr?null!==nt?Ei?t.compressedTexSubImage3D(o.TEXTURE_2D_ARRAY,Le,0,0,0,jt.width,jt.height,Fe.depth,nt,jt.data,0,0):t.compressedTexImage3D(o.TEXTURE_2D_ARRAY,Le,Bt,jt.width,jt.height,Fe.depth,0,jt.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ei?t.texSubImage3D(o.TEXTURE_2D_ARRAY,Le,0,0,0,jt.width,jt.height,Fe.depth,nt,Xt,jt.data):t.texImage3D(o.TEXTURE_2D_ARRAY,Le,Bt,jt.width,jt.height,Fe.depth,0,nt,Xt,jt.data)}else{Ei&&fe&&t.texStorage2D(o.TEXTURE_2D,Ht,Bt,Wn[0].width,Wn[0].height);for(let Le=0,xt=Wn.length;Le<xt;Le++)jt=Wn[Le],J.format!==qr?null!==nt?Ei?t.compressedTexSubImage2D(o.TEXTURE_2D,Le,0,0,jt.width,jt.height,nt,jt.data):t.compressedTexImage2D(o.TEXTURE_2D,Le,Bt,jt.width,jt.height,0,jt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ei?t.texSubImage2D(o.TEXTURE_2D,Le,0,0,jt.width,jt.height,nt,Xt,jt.data):t.texImage2D(o.TEXTURE_2D,Le,Bt,jt.width,jt.height,0,nt,Xt,jt.data)}else if(J.isDataArrayTexture)Ei?(fe&&t.texStorage3D(o.TEXTURE_2D_ARRAY,Ht,Bt,Fe.width,Fe.height,Fe.depth),t.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,0,Fe.width,Fe.height,Fe.depth,nt,Xt,Fe.data)):t.texImage3D(o.TEXTURE_2D_ARRAY,0,Bt,Fe.width,Fe.height,Fe.depth,0,nt,Xt,Fe.data);else if(J.isData3DTexture)Ei?(fe&&t.texStorage3D(o.TEXTURE_3D,Ht,Bt,Fe.width,Fe.height,Fe.depth),t.texSubImage3D(o.TEXTURE_3D,0,0,0,0,Fe.width,Fe.height,Fe.depth,nt,Xt,Fe.data)):t.texImage3D(o.TEXTURE_3D,0,Bt,Fe.width,Fe.height,Fe.depth,0,nt,Xt,Fe.data);else if(J.isFramebufferTexture){if(fe)if(Ei)t.texStorage2D(o.TEXTURE_2D,Ht,Bt,Fe.width,Fe.height);else{let Le=Fe.width,xt=Fe.height;for(let Gt=0;Gt<Ht;Gt++)t.texImage2D(o.TEXTURE_2D,Gt,Bt,Le,xt,0,nt,Xt,null),Le>>=1,xt>>=1}}else if(Wn.length>0&&he){Ei&&fe&&t.texStorage2D(o.TEXTURE_2D,Ht,Bt,Wn[0].width,Wn[0].height);for(let Le=0,xt=Wn.length;Le<xt;Le++)jt=Wn[Le],Ei?t.texSubImage2D(o.TEXTURE_2D,Le,0,0,nt,Xt,jt):t.texImage2D(o.TEXTURE_2D,Le,Bt,nt,Xt,jt);J.generateMipmaps=!1}else Ei?(fe&&t.texStorage2D(o.TEXTURE_2D,Ht,Bt,Fe.width,Fe.height),t.texSubImage2D(o.TEXTURE_2D,0,0,0,nt,Xt,Fe)):t.texImage2D(o.TEXTURE_2D,0,Bt,nt,Xt,Fe);Z(J,he)&&q(wt),yn.__version=At.version,J.onUpdate&&J.onUpdate(J)}oe.__version=J.version}function xn(oe,J,Re,wt,ct,At){const yn=a.convert(Re.format,Re.colorSpace),Ct=a.convert(Re.type),Fe=ee(Re.internalFormat,yn,Ct,Re.colorSpace);if(!n.get(J).__hasExternalTextures){const nt=Math.max(1,J.width>>At),Xt=Math.max(1,J.height>>At);ct===o.TEXTURE_3D||ct===o.TEXTURE_2D_ARRAY?t.texImage3D(ct,At,Fe,nt,Xt,J.depth,0,yn,Ct,null):t.texImage2D(ct,At,Fe,nt,Xt,0,yn,Ct,null)}t.bindFramebuffer(o.FRAMEBUFFER,oe),On(J)?M.framebufferTexture2DMultisampleEXT(o.FRAMEBUFFER,wt,ct,n.get(Re).__webglTexture,0,on(J)):(ct===o.TEXTURE_2D||ct>=o.TEXTURE_CUBE_MAP_POSITIVE_X&&ct<=o.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&o.framebufferTexture2D(o.FRAMEBUFFER,wt,ct,n.get(Re).__webglTexture,At),t.bindFramebuffer(o.FRAMEBUFFER,null)}function ce(oe,J,Re){if(o.bindRenderbuffer(o.RENDERBUFFER,oe),J.depthBuffer&&!J.stencilBuffer){let wt=o.DEPTH_COMPONENT16;if(Re||On(J)){const ct=J.depthTexture;ct&&ct.isDepthTexture&&(ct.type===Tn?wt=o.DEPTH_COMPONENT32F:ct.type===Ze&&(wt=o.DEPTH_COMPONENT24));const At=on(J);On(J)?M.renderbufferStorageMultisampleEXT(o.RENDERBUFFER,At,wt,J.width,J.height):o.renderbufferStorageMultisample(o.RENDERBUFFER,At,wt,J.width,J.height)}else o.renderbufferStorage(o.RENDERBUFFER,wt,J.width,J.height);o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.RENDERBUFFER,oe)}else if(J.depthBuffer&&J.stencilBuffer){const wt=on(J);Re&&!1===On(J)?o.renderbufferStorageMultisample(o.RENDERBUFFER,wt,o.DEPTH24_STENCIL8,J.width,J.height):On(J)?M.renderbufferStorageMultisampleEXT(o.RENDERBUFFER,wt,o.DEPTH24_STENCIL8,J.width,J.height):o.renderbufferStorage(o.RENDERBUFFER,o.DEPTH_STENCIL,J.width,J.height),o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,oe)}else{const wt=!0===J.isWebGLMultipleRenderTargets?J.texture:[J.texture];for(let ct=0;ct<wt.length;ct++){const At=wt[ct],yn=a.convert(At.format,At.colorSpace),Ct=a.convert(At.type),Fe=ee(At.internalFormat,yn,Ct,At.colorSpace),he=on(J);Re&&!1===On(J)?o.renderbufferStorageMultisample(o.RENDERBUFFER,he,Fe,J.width,J.height):On(J)?M.renderbufferStorageMultisampleEXT(o.RENDERBUFFER,he,Fe,J.width,J.height):o.renderbufferStorage(o.RENDERBUFFER,Fe,J.width,J.height)}}o.bindRenderbuffer(o.RENDERBUFFER,null)}function Ye(oe){const J=n.get(oe),Re=!0===oe.isWebGLCubeRenderTarget;if(oe.depthTexture&&!J.__autoAllocateDepthBuffer){if(Re)throw new Error("target.depthTexture not supported in Cube render targets");!function Lt(oe,J){if(J&&J.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(o.FRAMEBUFFER,oe),!J.depthTexture||!J.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(J.depthTexture).__webglTexture||J.depthTexture.image.width!==J.width||J.depthTexture.image.height!==J.height)&&(J.depthTexture.image.width=J.width,J.depthTexture.image.height=J.height,J.depthTexture.needsUpdate=!0),Ke(J.depthTexture,0);const wt=n.get(J.depthTexture).__webglTexture,ct=on(J);if(J.depthTexture.format===Go)On(J)?M.framebufferTexture2DMultisampleEXT(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.TEXTURE_2D,wt,0,ct):o.framebufferTexture2D(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.TEXTURE_2D,wt,0);else{if(J.depthTexture.format!==Xa)throw new Error("Unknown depthTexture format");On(J)?M.framebufferTexture2DMultisampleEXT(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.TEXTURE_2D,wt,0,ct):o.framebufferTexture2D(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.TEXTURE_2D,wt,0)}}(J.__webglFramebuffer,oe)}else if(Re){J.__webglDepthbuffer=[];for(let wt=0;wt<6;wt++)t.bindFramebuffer(o.FRAMEBUFFER,J.__webglFramebuffer[wt]),J.__webglDepthbuffer[wt]=o.createRenderbuffer(),ce(J.__webglDepthbuffer[wt],oe,!1)}else t.bindFramebuffer(o.FRAMEBUFFER,J.__webglFramebuffer),J.__webglDepthbuffer=o.createRenderbuffer(),ce(J.__webglDepthbuffer,oe,!1);t.bindFramebuffer(o.FRAMEBUFFER,null)}function on(oe){return Math.min(_,oe.samples)}function On(oe){const J=n.get(oe);return u&&oe.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==J.__useRenderToTexture}function Er(oe,J){const Re=oe.colorSpace,wt=oe.format,ct=oe.type;return!0===oe.isCompressedTexture||1035===oe.format||Re!==ls&&""!==Re&&(Re===vn?!1===u?!0===e.has("EXT_sRGB")&&wt===qr?(oe.format=1035,oe.minFilter=Ii,oe.generateMipmaps=!1):J=uy.sRGBToLinear(J):(wt!==qr||ct!==Vo)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Re)),J}this.allocateTextureUnit=function ze(){const oe=Ne;return oe>=d&&console.warn("THREE.WebGLTextures: Trying to use "+oe+" texture units while this GPU supports only "+d),Ne+=1,oe},this.resetTextureUnits=function Pe(){Ne=0},this.setTexture2D=Ke,this.setTexture2DArray=function _e(oe,J){const Re=n.get(oe);oe.version>0&&Re.__version!==oe.version?li(Re,oe,J):t.bindTexture(o.TEXTURE_2D_ARRAY,Re.__webglTexture,o.TEXTURE0+J)},this.setTexture3D=function He(oe,J){const Re=n.get(oe);oe.version>0&&Re.__version!==oe.version?li(Re,oe,J):t.bindTexture(o.TEXTURE_3D,Re.__webglTexture,o.TEXTURE0+J)},this.setTextureCube=function ft(oe,J){const Re=n.get(oe);oe.version>0&&Re.__version!==oe.version?function ci(oe,J,Re){if(6!==J.image.length)return;const wt=nn(oe,J),ct=J.source;t.bindTexture(o.TEXTURE_CUBE_MAP,oe.__webglTexture,o.TEXTURE0+Re);const At=n.get(ct);if(ct.version!==At.__version||!0===wt){t.activeTexture(o.TEXTURE0+Re),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,J.flipY),o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,J.premultiplyAlpha),o.pixelStorei(o.UNPACK_ALIGNMENT,J.unpackAlignment),o.pixelStorei(o.UNPACK_COLORSPACE_CONVERSION_WEBGL,o.NONE);const yn=J.isCompressedTexture||J.image[0].isCompressedTexture,Ct=J.image[0]&&J.image[0].isDataTexture,Fe=[];for(let Le=0;Le<6;Le++)Fe[Le]=yn||Ct?Ct?J.image[Le].image:J.image[Le]:F(J.image[Le],!1,!0,p),Fe[Le]=Er(J,Fe[Le]);const he=Fe[0],nt=V(he)||u,Xt=a.convert(J.format,J.colorSpace),Bt=a.convert(J.type),jt=ee(J.internalFormat,Xt,Bt,J.colorSpace),Wn=u&&!0!==J.isVideoTexture,Ei=void 0===At.__version||!0===wt;let Ht,fe=j(J,he,nt);if(sn(o.TEXTURE_CUBE_MAP,J,nt),yn){Wn&&Ei&&t.texStorage2D(o.TEXTURE_CUBE_MAP,fe,jt,he.width,he.height);for(let Le=0;Le<6;Le++){Ht=Fe[Le].mipmaps;for(let xt=0;xt<Ht.length;xt++){const Gt=Ht[xt];J.format!==qr?null!==Xt?Wn?t.compressedTexSubImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+Le,xt,0,0,Gt.width,Gt.height,Xt,Gt.data):t.compressedTexImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+Le,xt,jt,Gt.width,Gt.height,0,Gt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Wn?t.texSubImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+Le,xt,0,0,Gt.width,Gt.height,Xt,Bt,Gt.data):t.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+Le,xt,jt,Gt.width,Gt.height,0,Xt,Bt,Gt.data)}}}else{Ht=J.mipmaps,Wn&&Ei&&(Ht.length>0&&fe++,t.texStorage2D(o.TEXTURE_CUBE_MAP,fe,jt,Fe[0].width,Fe[0].height));for(let Le=0;Le<6;Le++)if(Ct){Wn?t.texSubImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+Le,0,0,0,Fe[Le].width,Fe[Le].height,Xt,Bt,Fe[Le].data):t.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+Le,0,jt,Fe[Le].width,Fe[Le].height,0,Xt,Bt,Fe[Le].data);for(let xt=0;xt<Ht.length;xt++){const ui=Ht[xt].image[Le].image;Wn?t.texSubImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+Le,xt+1,0,0,ui.width,ui.height,Xt,Bt,ui.data):t.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+Le,xt+1,jt,ui.width,ui.height,0,Xt,Bt,ui.data)}}else{Wn?t.texSubImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+Le,0,0,0,Xt,Bt,Fe[Le]):t.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+Le,0,jt,Xt,Bt,Fe[Le]);for(let xt=0;xt<Ht.length;xt++){const Gt=Ht[xt];Wn?t.texSubImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+Le,xt+1,0,0,Xt,Bt,Gt.image[Le]):t.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+Le,xt+1,jt,Xt,Bt,Gt.image[Le])}}}Z(J,nt)&&q(o.TEXTURE_CUBE_MAP),At.__version=ct.version,J.onUpdate&&J.onUpdate(J)}oe.__version=J.version}(Re,oe,J):t.bindTexture(o.TEXTURE_CUBE_MAP,Re.__webglTexture,o.TEXTURE0+J)},this.rebindTextures=function St(oe,J,Re){const wt=n.get(oe);void 0!==J&&xn(wt.__webglFramebuffer,oe,oe.texture,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,0),void 0!==Re&&Ye(oe)},this.setupRenderTarget=function it(oe){const J=oe.texture,Re=n.get(oe),wt=n.get(J);oe.addEventListener("dispose",De),!0!==oe.isWebGLMultipleRenderTargets&&(void 0===wt.__webglTexture&&(wt.__webglTexture=o.createTexture()),wt.__version=J.version,c.memory.textures++);const ct=!0===oe.isWebGLCubeRenderTarget,At=!0===oe.isWebGLMultipleRenderTargets,yn=V(oe)||u;if(ct){Re.__webglFramebuffer=[];for(let Ct=0;Ct<6;Ct++)if(u&&J.mipmaps&&J.mipmaps.length>0){Re.__webglFramebuffer[Ct]=[];for(let Fe=0;Fe<J.mipmaps.length;Fe++)Re.__webglFramebuffer[Ct][Fe]=o.createFramebuffer()}else Re.__webglFramebuffer[Ct]=o.createFramebuffer()}else{if(u&&J.mipmaps&&J.mipmaps.length>0){Re.__webglFramebuffer=[];for(let Ct=0;Ct<J.mipmaps.length;Ct++)Re.__webglFramebuffer[Ct]=o.createFramebuffer()}else Re.__webglFramebuffer=o.createFramebuffer();if(At)if(i.drawBuffers){const Ct=oe.texture;for(let Fe=0,he=Ct.length;Fe<he;Fe++){const nt=n.get(Ct[Fe]);void 0===nt.__webglTexture&&(nt.__webglTexture=o.createTexture(),c.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(u&&oe.samples>0&&!1===On(oe)){const Ct=At?J:[J];Re.__webglMultisampledFramebuffer=o.createFramebuffer(),Re.__webglColorRenderbuffer=[],t.bindFramebuffer(o.FRAMEBUFFER,Re.__webglMultisampledFramebuffer);for(let Fe=0;Fe<Ct.length;Fe++){const he=Ct[Fe];Re.__webglColorRenderbuffer[Fe]=o.createRenderbuffer(),o.bindRenderbuffer(o.RENDERBUFFER,Re.__webglColorRenderbuffer[Fe]);const nt=a.convert(he.format,he.colorSpace),Xt=a.convert(he.type),Bt=ee(he.internalFormat,nt,Xt,he.colorSpace,!0===oe.isXRRenderTarget),jt=on(oe);o.renderbufferStorageMultisample(o.RENDERBUFFER,jt,Bt,oe.width,oe.height),o.framebufferRenderbuffer(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0+Fe,o.RENDERBUFFER,Re.__webglColorRenderbuffer[Fe])}o.bindRenderbuffer(o.RENDERBUFFER,null),oe.depthBuffer&&(Re.__webglDepthRenderbuffer=o.createRenderbuffer(),ce(Re.__webglDepthRenderbuffer,oe,!0)),t.bindFramebuffer(o.FRAMEBUFFER,null)}}if(ct){t.bindTexture(o.TEXTURE_CUBE_MAP,wt.__webglTexture),sn(o.TEXTURE_CUBE_MAP,J,yn);for(let Ct=0;Ct<6;Ct++)if(u&&J.mipmaps&&J.mipmaps.length>0)for(let Fe=0;Fe<J.mipmaps.length;Fe++)xn(Re.__webglFramebuffer[Ct][Fe],oe,J,o.COLOR_ATTACHMENT0,o.TEXTURE_CUBE_MAP_POSITIVE_X+Ct,Fe);else xn(Re.__webglFramebuffer[Ct],oe,J,o.COLOR_ATTACHMENT0,o.TEXTURE_CUBE_MAP_POSITIVE_X+Ct,0);Z(J,yn)&&q(o.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(At){const Ct=oe.texture;for(let Fe=0,he=Ct.length;Fe<he;Fe++){const nt=Ct[Fe],Xt=n.get(nt);t.bindTexture(o.TEXTURE_2D,Xt.__webglTexture),sn(o.TEXTURE_2D,nt,yn),xn(Re.__webglFramebuffer,oe,nt,o.COLOR_ATTACHMENT0+Fe,o.TEXTURE_2D,0),Z(nt,yn)&&q(o.TEXTURE_2D)}t.unbindTexture()}else{let Ct=o.TEXTURE_2D;if((oe.isWebGL3DRenderTarget||oe.isWebGLArrayRenderTarget)&&(u?Ct=oe.isWebGL3DRenderTarget?o.TEXTURE_3D:o.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(Ct,wt.__webglTexture),sn(Ct,J,yn),u&&J.mipmaps&&J.mipmaps.length>0)for(let Fe=0;Fe<J.mipmaps.length;Fe++)xn(Re.__webglFramebuffer[Fe],oe,J,o.COLOR_ATTACHMENT0,Ct,Fe);else xn(Re.__webglFramebuffer,oe,J,o.COLOR_ATTACHMENT0,Ct,0);Z(J,yn)&&q(Ct),t.unbindTexture()}oe.depthBuffer&&Ye(oe)},this.updateRenderTargetMipmap=function bn(oe){const J=V(oe)||u,Re=!0===oe.isWebGLMultipleRenderTargets?oe.texture:[oe.texture];for(let wt=0,ct=Re.length;wt<ct;wt++){const At=Re[wt];if(Z(At,J)){const yn=oe.isWebGLCubeRenderTarget?o.TEXTURE_CUBE_MAP:o.TEXTURE_2D,Ct=n.get(At).__webglTexture;t.bindTexture(yn,Ct),q(yn),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function Qt(oe){if(u&&oe.samples>0&&!1===On(oe)){const J=oe.isWebGLMultipleRenderTargets?oe.texture:[oe.texture],Re=oe.width,wt=oe.height;let ct=o.COLOR_BUFFER_BIT;const At=[],yn=oe.stencilBuffer?o.DEPTH_STENCIL_ATTACHMENT:o.DEPTH_ATTACHMENT,Ct=n.get(oe),Fe=!0===oe.isWebGLMultipleRenderTargets;if(Fe)for(let he=0;he<J.length;he++)t.bindFramebuffer(o.FRAMEBUFFER,Ct.__webglMultisampledFramebuffer),o.framebufferRenderbuffer(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0+he,o.RENDERBUFFER,null),t.bindFramebuffer(o.FRAMEBUFFER,Ct.__webglFramebuffer),o.framebufferTexture2D(o.DRAW_FRAMEBUFFER,o.COLOR_ATTACHMENT0+he,o.TEXTURE_2D,null,0);t.bindFramebuffer(o.READ_FRAMEBUFFER,Ct.__webglMultisampledFramebuffer),t.bindFramebuffer(o.DRAW_FRAMEBUFFER,Ct.__webglFramebuffer);for(let he=0;he<J.length;he++){At.push(o.COLOR_ATTACHMENT0+he),oe.depthBuffer&&At.push(yn);const nt=void 0!==Ct.__ignoreDepthValues&&Ct.__ignoreDepthValues;if(!1===nt&&(oe.depthBuffer&&(ct|=o.DEPTH_BUFFER_BIT),oe.stencilBuffer&&(ct|=o.STENCIL_BUFFER_BIT)),Fe&&o.framebufferRenderbuffer(o.READ_FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.RENDERBUFFER,Ct.__webglColorRenderbuffer[he]),!0===nt&&(o.invalidateFramebuffer(o.READ_FRAMEBUFFER,[yn]),o.invalidateFramebuffer(o.DRAW_FRAMEBUFFER,[yn])),Fe){const Xt=n.get(J[he]).__webglTexture;o.framebufferTexture2D(o.DRAW_FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,Xt,0)}o.blitFramebuffer(0,0,Re,wt,0,0,Re,wt,ct,o.NEAREST),b&&o.invalidateFramebuffer(o.READ_FRAMEBUFFER,At)}if(t.bindFramebuffer(o.READ_FRAMEBUFFER,null),t.bindFramebuffer(o.DRAW_FRAMEBUFFER,null),Fe)for(let he=0;he<J.length;he++){t.bindFramebuffer(o.FRAMEBUFFER,Ct.__webglMultisampledFramebuffer),o.framebufferRenderbuffer(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0+he,o.RENDERBUFFER,Ct.__webglColorRenderbuffer[he]);const nt=n.get(J[he]).__webglTexture;t.bindFramebuffer(o.FRAMEBUFFER,Ct.__webglFramebuffer),o.framebufferTexture2D(o.DRAW_FRAMEBUFFER,o.COLOR_ATTACHMENT0+he,o.TEXTURE_2D,nt,0)}t.bindFramebuffer(o.DRAW_FRAMEBUFFER,Ct.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=Ye,this.setupFrameBufferTexture=xn,this.useMultisampledRTT=On}function vb(o,e,t){const n=t.isWebGL2;return{convert:function i(a,c=""){let u;if(a===Vo)return o.UNSIGNED_BYTE;if(1017===a)return o.UNSIGNED_SHORT_4_4_4_4;if(1018===a)return o.UNSIGNED_SHORT_5_5_5_1;if(1010===a)return o.BYTE;if(1011===a)return o.SHORT;if(1012===a)return o.UNSIGNED_SHORT;if(1013===a)return o.INT;if(a===Ze)return o.UNSIGNED_INT;if(a===Tn)return o.FLOAT;if(a===_o)return n?o.HALF_FLOAT:(u=e.get("OES_texture_half_float"),null!==u?u.HALF_FLOAT_OES:null);if(1021===a)return o.ALPHA;if(a===qr)return o.RGBA;if(1024===a)return o.LUMINANCE;if(1025===a)return o.LUMINANCE_ALPHA;if(a===Go)return o.DEPTH_COMPONENT;if(a===Xa)return o.DEPTH_STENCIL;if(1035===a)return u=e.get("EXT_sRGB"),null!==u?u.SRGB_ALPHA_EXT:null;if(1028===a)return o.RED;if(1029===a)return o.RED_INTEGER;if(1030===a)return o.RG;if(1031===a)return o.RG_INTEGER;if(1033===a)return o.RGBA_INTEGER;if(33776===a||33777===a||33778===a||33779===a)if(c===vn){if(u=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===u)return null;if(33776===a)return u.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===a)return u.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===a)return u.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===a)return u.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(u=e.get("WEBGL_compressed_texture_s3tc"),null===u)return null;if(33776===a)return u.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===a)return u.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===a)return u.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===a)return u.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===a||35841===a||35842===a||35843===a){if(u=e.get("WEBGL_compressed_texture_pvrtc"),null===u)return null;if(35840===a)return u.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===a)return u.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===a)return u.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===a)return u.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===a)return u=e.get("WEBGL_compressed_texture_etc1"),null!==u?u.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===a||37496===a){if(u=e.get("WEBGL_compressed_texture_etc"),null===u)return null;if(37492===a)return c===vn?u.COMPRESSED_SRGB8_ETC2:u.COMPRESSED_RGB8_ETC2;if(37496===a)return c===vn?u.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:u.COMPRESSED_RGBA8_ETC2_EAC}if(37808===a||37809===a||37810===a||37811===a||37812===a||37813===a||37814===a||37815===a||37816===a||37817===a||37818===a||37819===a||37820===a||37821===a){if(u=e.get("WEBGL_compressed_texture_astc"),null===u)return null;if(37808===a)return c===vn?u.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:u.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===a)return c===vn?u.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:u.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===a)return c===vn?u.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:u.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===a)return c===vn?u.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:u.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===a)return c===vn?u.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:u.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===a)return c===vn?u.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:u.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===a)return c===vn?u.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:u.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===a)return c===vn?u.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:u.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===a)return c===vn?u.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:u.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===a)return c===vn?u.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:u.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===a)return c===vn?u.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:u.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===a)return c===vn?u.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:u.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===a)return c===vn?u.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:u.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===a)return c===vn?u.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:u.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===a){if(u=e.get("EXT_texture_compression_bptc"),null===u)return null;if(36492===a)return c===vn?u.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:u.COMPRESSED_RGBA_BPTC_UNORM_EXT}if(36283===a||36284===a||36285===a||36286===a){if(u=e.get("EXT_texture_compression_rgtc"),null===u)return null;if(36492===a)return u.COMPRESSED_RED_RGTC1_EXT;if(36284===a)return u.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===a)return u.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===a)return u.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return a===js?n?o.UNSIGNED_INT_24_8:(u=e.get("WEBGL_depth_texture"),null!==u?u.UNSIGNED_INT_24_8_WEBGL:null):void 0!==o[a]?o[a]:null}}}class R0 extends ts{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class ol extends xr{constructor(){super(),this.isGroup=!0,this.type="Group"}}const yb={type:"move"};class mp{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new ol,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new ol,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Q,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Q),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new ol,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Q,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Q),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,n){let i=null,a=null,c=null;const u=this._targetRay,d=this._grip,p=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(p&&e.hand){c=!0;for(const P of e.hand.values()){const R=t.getJointPose(P,n),T=this._getHandJoint(p,P);null!==R&&(T.matrix.fromArray(R.transform.matrix),T.matrix.decompose(T.position,T.rotation,T.scale),T.matrixWorldNeedsUpdate=!0,T.jointRadius=R.radius),T.visible=null!==R}const M=p.joints["index-finger-tip"].position.distanceTo(p.joints["thumb-tip"].position),b=.02,A=.005;p.inputState.pinching&&M>b+A?(p.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!p.inputState.pinching&&M<=b-A&&(p.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==d&&e.gripSpace&&(a=t.getPose(e.gripSpace,n),null!==a&&(d.matrix.fromArray(a.transform.matrix),d.matrix.decompose(d.position,d.rotation,d.scale),d.matrixWorldNeedsUpdate=!0,a.linearVelocity?(d.hasLinearVelocity=!0,d.linearVelocity.copy(a.linearVelocity)):d.hasLinearVelocity=!1,a.angularVelocity?(d.hasAngularVelocity=!0,d.angularVelocity.copy(a.angularVelocity)):d.hasAngularVelocity=!1));null!==u&&(i=t.getPose(e.targetRaySpace,n),null===i&&null!==a&&(i=a),null!==i&&(u.matrix.fromArray(i.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale),u.matrixWorldNeedsUpdate=!0,i.linearVelocity?(u.hasLinearVelocity=!0,u.linearVelocity.copy(i.linearVelocity)):u.hasLinearVelocity=!1,i.angularVelocity?(u.hasAngularVelocity=!0,u.angularVelocity.copy(i.angularVelocity)):u.hasAngularVelocity=!1,this.dispatchEvent(yb)))}return null!==u&&(u.visible=null!==i),null!==d&&(d.visible=null!==a),null!==p&&(p.visible=null!==c),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const n=new ol;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class _b extends Ss{constructor(e,t,n,i,a,c,u,d,p,v){if((v=void 0!==v?v:Go)!==Go&&v!==Xa)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&v===Go&&(n=Ze),void 0===n&&v===Xa&&(n=js),super(null,i,a,c,u,d,v,n,p),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==u?u:Fi,this.minFilter=void 0!==d?d:Fi,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}class xb extends Rl{constructor(e,t){super();const n=this;let i=null,a=1,c=null,u="local-floor",d=1,p=null,v=null,_=null,M=null,b=null,A=null;const P=t.getContextAttributes();let R=null,T=null;const U=[],F=[],V=new ts;V.layers.enable(1),V.viewport=new Ci;const X=new ts;X.layers.enable(2),X.viewport=new Ci;const Z=[V,X],q=new R0;q.layers.enable(1),q.layers.enable(2);let ee=null,j=null;function K(_e){const He=F.indexOf(_e.inputSource);if(-1===He)return;const ft=U[He];void 0!==ft&&(ft.update(_e.inputSource,_e.frame,p||c),ft.dispatchEvent({type:_e.type,data:_e.inputSource}))}function Me(){i.removeEventListener("select",K),i.removeEventListener("selectstart",K),i.removeEventListener("selectend",K),i.removeEventListener("squeeze",K),i.removeEventListener("squeezestart",K),i.removeEventListener("squeezeend",K),i.removeEventListener("end",Me),i.removeEventListener("inputsourceschange",De);for(let _e=0;_e<U.length;_e++){const He=F[_e];null!==He&&(F[_e]=null,U[_e].disconnect(He))}ee=null,j=null,e.setRenderTarget(R),b=null,M=null,_=null,i=null,T=null,Ke.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function De(_e){for(let He=0;He<_e.removed.length;He++){const ft=_e.removed[He],ht=F.indexOf(ft);ht>=0&&(F[ht]=null,U[ht].disconnect(ft))}for(let He=0;He<_e.added.length;He++){const ft=_e.added[He];let ht=F.indexOf(ft);if(-1===ht){for(let Zt=0;Zt<U.length;Zt++){if(Zt>=F.length){F.push(ft),ht=Zt;break}if(null===F[Zt]){F[Zt]=ft,ht=Zt;break}}if(-1===ht)break}const pt=U[ht];pt&&pt.connect(ft)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(_e){let He=U[_e];return void 0===He&&(He=new mp,U[_e]=He),He.getTargetRaySpace()},this.getControllerGrip=function(_e){let He=U[_e];return void 0===He&&(He=new mp,U[_e]=He),He.getGripSpace()},this.getHand=function(_e){let He=U[_e];return void 0===He&&(He=new mp,U[_e]=He),He.getHandSpace()},this.setFramebufferScaleFactor=function(_e){a=_e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(_e){u=_e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return p||c},this.setReferenceSpace=function(_e){p=_e},this.getBaseLayer=function(){return null!==M?M:b},this.getBinding=function(){return _},this.getFrame=function(){return A},this.getSession=function(){return i},this.setSession=function(){var _e=function Ha(o){return function(){var e=this,t=arguments;return new Promise(function(n,i){var a=o.apply(e,t);function c(d){pi(a,n,i,c,u,"next",d)}function u(d){pi(a,n,i,c,u,"throw",d)}c(void 0)})}}(function*(He){if(i=He,null!==i){if(R=e.getRenderTarget(),i.addEventListener("select",K),i.addEventListener("selectstart",K),i.addEventListener("selectend",K),i.addEventListener("squeeze",K),i.addEventListener("squeezestart",K),i.addEventListener("squeezeend",K),i.addEventListener("end",Me),i.addEventListener("inputsourceschange",De),!0!==P.xrCompatible&&(yield t.makeXRCompatible()),void 0===i.renderState.layers||!1===e.capabilities.isWebGL2)b=new XRWebGLLayer(i,t,{antialias:void 0!==i.renderState.layers||P.antialias,alpha:!0,depth:P.depth,stencil:P.stencil,framebufferScaleFactor:a}),i.updateRenderState({baseLayer:b}),T=new ba(b.framebufferWidth,b.framebufferHeight,{format:qr,type:Vo,colorSpace:e.outputColorSpace,stencilBuffer:P.stencil});else{let ft=null,ht=null,pt=null;P.depth&&(pt=P.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,ft=P.stencil?Xa:Go,ht=P.stencil?js:Ze);const Zt={colorFormat:t.RGBA8,depthFormat:pt,scaleFactor:a};_=new XRWebGLBinding(i,t),M=_.createProjectionLayer(Zt),i.updateRenderState({layers:[M]}),T=new ba(M.textureWidth,M.textureHeight,{format:qr,type:Vo,depthTexture:new _b(M.textureWidth,M.textureHeight,ht,void 0,void 0,void 0,void 0,void 0,void 0,ft),stencilBuffer:P.stencil,colorSpace:e.outputColorSpace,samples:P.antialias?4:0}),e.properties.get(T).__ignoreDepthValues=M.ignoreDepthValues}T.isXRRenderTarget=!0,this.setFoveation(d),p=null,c=yield i.requestReferenceSpace(u),Ke.setContext(i),Ke.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}});return function(He){return _e.apply(this,arguments)}}(),this.getEnvironmentBlendMode=function(){if(null!==i)return i.environmentBlendMode};const me=new Q,pe=new Q;function Ne(_e,He){null===He?_e.matrixWorld.copy(_e.matrix):_e.matrixWorld.multiplyMatrices(He.matrixWorld,_e.matrix),_e.matrixWorldInverse.copy(_e.matrixWorld).invert()}this.updateCamera=function(_e){if(null===i)return;q.near=X.near=V.near=_e.near,q.far=X.far=V.far=_e.far,(ee!==q.near||j!==q.far)&&(i.updateRenderState({depthNear:q.near,depthFar:q.far}),ee=q.near,j=q.far);const He=_e.parent,ft=q.cameras;Ne(q,He);for(let ht=0;ht<ft.length;ht++)Ne(ft[ht],He);2===ft.length?function xe(_e,He,ft){me.setFromMatrixPosition(He.matrixWorld),pe.setFromMatrixPosition(ft.matrixWorld);const ht=me.distanceTo(pe),pt=He.projectionMatrix.elements,Zt=ft.projectionMatrix.elements,sn=pt[14]/(pt[10]-1),nn=pt[14]/(pt[10]+1),li=(pt[9]+1)/pt[5],ci=(pt[9]-1)/pt[5],xn=(pt[8]-1)/pt[0],ce=(Zt[8]+1)/Zt[0],Lt=sn*xn,Ye=sn*ce,St=ht/(-xn+ce),it=St*-xn;He.matrixWorld.decompose(_e.position,_e.quaternion,_e.scale),_e.translateX(it),_e.translateZ(St),_e.matrixWorld.compose(_e.position,_e.quaternion,_e.scale),_e.matrixWorldInverse.copy(_e.matrixWorld).invert();const bn=sn+St,Qt=nn+St;_e.projectionMatrix.makePerspective(Lt-it,Ye+(ht-it),li*nn/Qt*bn,ci*nn/Qt*bn,bn,Qt),_e.projectionMatrixInverse.copy(_e.projectionMatrix).invert()}(q,V,X):q.projectionMatrix.copy(V.projectionMatrix),function Pe(_e,He,ft){null===ft?_e.matrix.copy(He.matrixWorld):(_e.matrix.copy(ft.matrixWorld),_e.matrix.invert(),_e.matrix.multiply(He.matrixWorld)),_e.matrix.decompose(_e.position,_e.quaternion,_e.scale),_e.updateMatrixWorld(!0);const ht=_e.children;for(let pt=0,Zt=ht.length;pt<Zt;pt++)ht[pt].updateMatrixWorld(!0);_e.projectionMatrix.copy(He.projectionMatrix),_e.projectionMatrixInverse.copy(He.projectionMatrixInverse),_e.isPerspectiveCamera&&(_e.fov=2*Qu*Math.atan(1/_e.projectionMatrix.elements[5]),_e.zoom=1)}(_e,q,He)},this.getCamera=function(){return q},this.getFoveation=function(){if(null!==M||null!==b)return d},this.setFoveation=function(_e){d=_e,null!==M&&(M.fixedFoveation=_e),null!==b&&void 0!==b.fixedFoveation&&(b.fixedFoveation=_e)};let ze=null;const Ke=new wd;Ke.setAnimationLoop(function $e(_e,He){if(v=He.getViewerPose(p||c),A=He,null!==v){const ft=v.views;null!==b&&(e.setRenderTargetFramebuffer(T,b.framebuffer),e.setRenderTarget(T));let ht=!1;ft.length!==q.cameras.length&&(q.cameras.length=0,ht=!0);for(let pt=0;pt<ft.length;pt++){const Zt=ft[pt];let sn=null;if(null!==b)sn=b.getViewport(Zt);else{const li=_.getViewSubImage(M,Zt);sn=li.viewport,0===pt&&(e.setRenderTargetTextures(T,li.colorTexture,M.ignoreDepthValues?void 0:li.depthStencilTexture),e.setRenderTarget(T))}let nn=Z[pt];void 0===nn&&(nn=new ts,nn.layers.enable(pt),nn.viewport=new Ci,Z[pt]=nn),nn.matrix.fromArray(Zt.transform.matrix),nn.matrix.decompose(nn.position,nn.quaternion,nn.scale),nn.projectionMatrix.fromArray(Zt.projectionMatrix),nn.projectionMatrixInverse.copy(nn.projectionMatrix).invert(),nn.viewport.set(sn.x,sn.y,sn.width,sn.height),0===pt&&(q.matrix.copy(nn.matrix),q.matrix.decompose(q.position,q.quaternion,q.scale)),!0===ht&&q.cameras.push(nn)}}for(let ft=0;ft<U.length;ft++){const ht=F[ft],pt=U[ft];null!==ht&&void 0!==pt&&pt.update(ht,He,p||c)}ze&&ze(_e,He),He.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:He}),A=null}),this.setAnimationLoop=function(_e){ze=_e},this.dispose=function(){}}}function I0(o,e){function t(R,T){!0===R.matrixAutoUpdate&&R.updateMatrix(),T.value.copy(R.matrix)}function a(R,T){R.opacity.value=T.opacity,T.color&&R.diffuse.value.copy(T.color),T.emissive&&R.emissive.value.copy(T.emissive).multiplyScalar(T.emissiveIntensity),T.map&&(R.map.value=T.map,t(T.map,R.mapTransform)),T.alphaMap&&(R.alphaMap.value=T.alphaMap,t(T.alphaMap,R.alphaMapTransform)),T.bumpMap&&(R.bumpMap.value=T.bumpMap,t(T.bumpMap,R.bumpMapTransform),R.bumpScale.value=T.bumpScale,1===T.side&&(R.bumpScale.value*=-1)),T.normalMap&&(R.normalMap.value=T.normalMap,t(T.normalMap,R.normalMapTransform),R.normalScale.value.copy(T.normalScale),1===T.side&&R.normalScale.value.negate()),T.displacementMap&&(R.displacementMap.value=T.displacementMap,t(T.displacementMap,R.displacementMapTransform),R.displacementScale.value=T.displacementScale,R.displacementBias.value=T.displacementBias),T.emissiveMap&&(R.emissiveMap.value=T.emissiveMap,t(T.emissiveMap,R.emissiveMapTransform)),T.specularMap&&(R.specularMap.value=T.specularMap,t(T.specularMap,R.specularMapTransform)),T.alphaTest>0&&(R.alphaTest.value=T.alphaTest);const U=e.get(T).envMap;if(U&&(R.envMap.value=U,R.flipEnvMap.value=U.isCubeTexture&&!1===U.isRenderTargetTexture?-1:1,R.reflectivity.value=T.reflectivity,R.ior.value=T.ior,R.refractionRatio.value=T.refractionRatio),T.lightMap){R.lightMap.value=T.lightMap;const F=!0===o._useLegacyLights?Math.PI:1;R.lightMapIntensity.value=T.lightMapIntensity*F,t(T.lightMap,R.lightMapTransform)}T.aoMap&&(R.aoMap.value=T.aoMap,R.aoMapIntensity.value=T.aoMapIntensity,t(T.aoMap,R.aoMapTransform))}return{refreshFogUniforms:function n(R,T){T.color.getRGB(R.fogColor.value,Da(o)),T.isFog?(R.fogNear.value=T.near,R.fogFar.value=T.far):T.isFogExp2&&(R.fogDensity.value=T.density)},refreshMaterialUniforms:function i(R,T,U,F,V){T.isMeshBasicMaterial||T.isMeshLambertMaterial?a(R,T):T.isMeshToonMaterial?(a(R,T),function _(R,T){T.gradientMap&&(R.gradientMap.value=T.gradientMap)}(R,T)):T.isMeshPhongMaterial?(a(R,T),function v(R,T){R.specular.value.copy(T.specular),R.shininess.value=Math.max(T.shininess,1e-4)}(R,T)):T.isMeshStandardMaterial?(a(R,T),function M(R,T){R.metalness.value=T.metalness,T.metalnessMap&&(R.metalnessMap.value=T.metalnessMap,t(T.metalnessMap,R.metalnessMapTransform)),R.roughness.value=T.roughness,T.roughnessMap&&(R.roughnessMap.value=T.roughnessMap,t(T.roughnessMap,R.roughnessMapTransform)),e.get(T).envMap&&(R.envMapIntensity.value=T.envMapIntensity)}(R,T),T.isMeshPhysicalMaterial&&function b(R,T,U){R.ior.value=T.ior,T.sheen>0&&(R.sheenColor.value.copy(T.sheenColor).multiplyScalar(T.sheen),R.sheenRoughness.value=T.sheenRoughness,T.sheenColorMap&&(R.sheenColorMap.value=T.sheenColorMap,t(T.sheenColorMap,R.sheenColorMapTransform)),T.sheenRoughnessMap&&(R.sheenRoughnessMap.value=T.sheenRoughnessMap,t(T.sheenRoughnessMap,R.sheenRoughnessMapTransform))),T.clearcoat>0&&(R.clearcoat.value=T.clearcoat,R.clearcoatRoughness.value=T.clearcoatRoughness,T.clearcoatMap&&(R.clearcoatMap.value=T.clearcoatMap,t(T.clearcoatMap,R.clearcoatMapTransform)),T.clearcoatRoughnessMap&&(R.clearcoatRoughnessMap.value=T.clearcoatRoughnessMap,t(T.clearcoatRoughnessMap,R.clearcoatRoughnessMapTransform)),T.clearcoatNormalMap&&(R.clearcoatNormalMap.value=T.clearcoatNormalMap,t(T.clearcoatNormalMap,R.clearcoatNormalMapTransform),R.clearcoatNormalScale.value.copy(T.clearcoatNormalScale),1===T.side&&R.clearcoatNormalScale.value.negate())),T.iridescence>0&&(R.iridescence.value=T.iridescence,R.iridescenceIOR.value=T.iridescenceIOR,R.iridescenceThicknessMinimum.value=T.iridescenceThicknessRange[0],R.iridescenceThicknessMaximum.value=T.iridescenceThicknessRange[1],T.iridescenceMap&&(R.iridescenceMap.value=T.iridescenceMap,t(T.iridescenceMap,R.iridescenceMapTransform)),T.iridescenceThicknessMap&&(R.iridescenceThicknessMap.value=T.iridescenceThicknessMap,t(T.iridescenceThicknessMap,R.iridescenceThicknessMapTransform))),T.transmission>0&&(R.transmission.value=T.transmission,R.transmissionSamplerMap.value=U.texture,R.transmissionSamplerSize.value.set(U.width,U.height),T.transmissionMap&&(R.transmissionMap.value=T.transmissionMap,t(T.transmissionMap,R.transmissionMapTransform)),R.thickness.value=T.thickness,T.thicknessMap&&(R.thicknessMap.value=T.thicknessMap,t(T.thicknessMap,R.thicknessMapTransform)),R.attenuationDistance.value=T.attenuationDistance,R.attenuationColor.value.copy(T.attenuationColor)),T.anisotropy>0&&(R.anisotropyVector.value.set(T.anisotropy*Math.cos(T.anisotropyRotation),T.anisotropy*Math.sin(T.anisotropyRotation)),T.anisotropyMap&&(R.anisotropyMap.value=T.anisotropyMap,t(T.anisotropyMap,R.anisotropyMapTransform))),R.specularIntensity.value=T.specularIntensity,R.specularColor.value.copy(T.specularColor),T.specularColorMap&&(R.specularColorMap.value=T.specularColorMap,t(T.specularColorMap,R.specularColorMapTransform)),T.specularIntensityMap&&(R.specularIntensityMap.value=T.specularIntensityMap,t(T.specularIntensityMap,R.specularIntensityMapTransform))}(R,T,V)):T.isMeshMatcapMaterial?(a(R,T),function A(R,T){T.matcap&&(R.matcap.value=T.matcap)}(R,T)):T.isMeshDepthMaterial?a(R,T):T.isMeshDistanceMaterial?(a(R,T),function P(R,T){const U=e.get(T).light;R.referencePosition.value.setFromMatrixPosition(U.matrixWorld),R.nearDistance.value=U.shadow.camera.near,R.farDistance.value=U.shadow.camera.far}(R,T)):T.isMeshNormalMaterial?a(R,T):T.isLineBasicMaterial?(function c(R,T){R.diffuse.value.copy(T.color),R.opacity.value=T.opacity,T.map&&(R.map.value=T.map,t(T.map,R.mapTransform))}(R,T),T.isLineDashedMaterial&&function u(R,T){R.dashSize.value=T.dashSize,R.totalSize.value=T.dashSize+T.gapSize,R.scale.value=T.scale}(R,T)):T.isPointsMaterial?function d(R,T,U,F){R.diffuse.value.copy(T.color),R.opacity.value=T.opacity,R.size.value=T.size*U,R.scale.value=.5*F,T.map&&(R.map.value=T.map,t(T.map,R.uvTransform)),T.alphaMap&&(R.alphaMap.value=T.alphaMap,t(T.alphaMap,R.alphaMapTransform)),T.alphaTest>0&&(R.alphaTest.value=T.alphaTest)}(R,T,U,F):T.isSpriteMaterial?function p(R,T){R.diffuse.value.copy(T.color),R.opacity.value=T.opacity,R.rotation.value=T.rotation,T.map&&(R.map.value=T.map,t(T.map,R.mapTransform)),T.alphaMap&&(R.alphaMap.value=T.alphaMap,t(T.alphaMap,R.alphaMapTransform)),T.alphaTest>0&&(R.alphaTest.value=T.alphaTest)}(R,T):T.isShadowMaterial?(R.color.value.copy(T.color),R.opacity.value=T.opacity):T.isShaderMaterial&&(T.uniformsNeedUpdate=!1)}}}function Mb(o,e,t,n){let i={},a={},c=[];const u=t.isWebGL2?o.getParameter(o.MAX_UNIFORM_BUFFER_BINDINGS):0;function b(U,F,V){const X=U.value;if(void 0===V[F]){if("number"==typeof X)V[F]=X;else{const Z=Array.isArray(X)?X:[X],q=[];for(let ee=0;ee<Z.length;ee++)q.push(Z[ee].clone());V[F]=q}return!0}if("number"==typeof X){if(V[F]!==X)return V[F]=X,!0}else{const Z=Array.isArray(V[F])?V[F]:[V[F]],q=Array.isArray(X)?X:[X];for(let ee=0;ee<Z.length;ee++){const j=Z[ee];if(!1===j.equals(q[ee]))return j.copy(q[ee]),!0}}return!1}function P(U){const F={boundary:0,storage:0};return"number"==typeof U?(F.boundary=4,F.storage=4):U.isVector2?(F.boundary=8,F.storage=8):U.isVector3||U.isColor?(F.boundary=16,F.storage=12):U.isVector4?(F.boundary=16,F.storage=16):U.isMatrix3?(F.boundary=48,F.storage=48):U.isMatrix4?(F.boundary=64,F.storage=64):U.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",U),F}function R(U){const F=U.target;F.removeEventListener("dispose",R);const V=c.indexOf(F.__bindingPointIndex);c.splice(V,1),o.deleteBuffer(i[F.id]),delete i[F.id],delete a[F.id]}return{bind:function d(U,F){n.uniformBlockBinding(U,F.program)},update:function p(U,F){let V=i[U.id];void 0===V&&(function A(U){const F=U.uniforms;let V=0;let Z=0;for(let q=0,ee=F.length;q<ee;q++){const j=F[q],K={boundary:0,storage:0},Me=Array.isArray(j.value)?j.value:[j.value];for(let De=0,me=Me.length;De<me;De++){const xe=P(Me[De]);K.boundary+=xe.boundary,K.storage+=xe.storage}if(j.__data=new Float32Array(K.storage/Float32Array.BYTES_PER_ELEMENT),j.__offset=V,q>0){Z=V%16;const De=16-Z;0!==Z&&De-K.boundary<0&&(V+=16-Z,j.__offset=V)}V+=K.storage}Z=V%16,Z>0&&(V+=16-Z),U.__size=V,U.__cache={}}(U),V=function v(U){const F=function _(){for(let U=0;U<u;U++)if(-1===c.indexOf(U))return c.push(U),U;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();U.__bindingPointIndex=F;const V=o.createBuffer(),X=U.__size,Z=U.usage;return o.bindBuffer(o.UNIFORM_BUFFER,V),o.bufferData(o.UNIFORM_BUFFER,X,Z),o.bindBuffer(o.UNIFORM_BUFFER,null),o.bindBufferBase(o.UNIFORM_BUFFER,F,V),V}(U),i[U.id]=V,U.addEventListener("dispose",R)),n.updateUBOMapping(U,F.program);const Z=e.render.frame;a[U.id]!==Z&&(function M(U){const V=U.uniforms,X=U.__cache;o.bindBuffer(o.UNIFORM_BUFFER,i[U.id]);for(let Z=0,q=V.length;Z<q;Z++){const ee=V[Z];if(!0===b(ee,Z,X)){const j=ee.__offset,K=Array.isArray(ee.value)?ee.value:[ee.value];let Me=0;for(let De=0;De<K.length;De++){const me=K[De],pe=P(me);"number"==typeof me?(ee.__data[0]=me,o.bufferSubData(o.UNIFORM_BUFFER,j+Me,ee.__data)):me.isMatrix3?(ee.__data[0]=me.elements[0],ee.__data[1]=me.elements[1],ee.__data[2]=me.elements[2],ee.__data[3]=me.elements[0],ee.__data[4]=me.elements[3],ee.__data[5]=me.elements[4],ee.__data[6]=me.elements[5],ee.__data[7]=me.elements[0],ee.__data[8]=me.elements[6],ee.__data[9]=me.elements[7],ee.__data[10]=me.elements[8],ee.__data[11]=me.elements[0]):(me.toArray(ee.__data,Me),Me+=pe.storage/Float32Array.BYTES_PER_ELEMENT)}o.bufferSubData(o.UNIFORM_BUFFER,j,ee.__data)}}o.bindBuffer(o.UNIFORM_BUFFER,null)}(U),a[U.id]=Z)},dispose:function T(){for(const U in i)o.deleteBuffer(i[U]);c=[],i={},a={}}}}function P0(){const o=iu("canvas");return o.style.display="block",o}class Gg{constructor(e={}){const{canvas:t=P0(),context:n=null,depth:i=!0,stencil:a=!0,alpha:c=!1,antialias:u=!1,premultipliedAlpha:d=!0,preserveDrawingBuffer:p=!1,powerPreference:v="default",failIfMajorPerformanceCaveat:_=!1}=e;let M;this.isWebGLRenderer=!0,M=null!==n?n.getContextAttributes().alpha:c;const b=new Uint32Array(4),A=new Int32Array(4);let P=null,R=null;const T=[],U=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputColorSpace=vn,this._useLegacyLights=!1,this.toneMapping=0,this.toneMappingExposure=1;const F=this;let V=!1,X=0,Z=0,q=null,ee=-1,j=null;const K=new Ci,Me=new Ci;let De=null;const me=new ut(0);let pe=0,xe=t.width,Ne=t.height,Pe=1,ze=null,$e=null;const Ke=new Ci(0,0,xe,Ne),_e=new Ci(0,0,xe,Ne);let He=!1;const ft=new tp;let ht=!1,pt=!1,Zt=null;const sn=new Yt,nn=new Be,li=new Q,ci={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function xn(){return null===q?Pe:1}let Ye,St,it,bn,Qt,on,On,gi,Er,oe,J,Re,wt,ct,At,yn,Ct,Fe,he,nt,Xt,Bt,jt,Wn,ce=n;function Lt(re,Se){for(let je=0;je<re.length;je++){const We=t.getContext(re[je],Se);if(null!==We)return We}return null}try{const re={alpha:!0,depth:i,stencil:a,antialias:u,premultipliedAlpha:d,preserveDrawingBuffer:p,powerPreference:v,failIfMajorPerformanceCaveat:_};if("setAttribute"in t&&t.setAttribute("data-engine","three.js r155"),t.addEventListener("webglcontextlost",Ht,!1),t.addEventListener("webglcontextrestored",Le,!1),t.addEventListener("webglcontextcreationerror",xt,!1),null===ce){const Se=["webgl2","webgl","experimental-webgl"];if(!0===F.isWebGL1Renderer&&Se.shift(),ce=Lt(Se,re),null===ce)throw Lt(Se)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}"undefined"!=typeof WebGLRenderingContext&&ce instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),void 0===ce.getShaderPrecisionFormat&&(ce.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(re){throw console.error("THREE.WebGLRenderer: "+re.message),re}function Ei(){Ye=new zM(ce),St=new Zy(ce,Ye,e),Ye.init(St),Bt=new vb(ce,Ye,St),it=new C0(ce,Ye,St),bn=new _g(ce),Qt=new Bg,on=new D0(ce,Ye,it,Qt,St,Bt,bn),On=new BM(F),gi=new yg(F),Er=new Ay(ce,St),jt=new kM(ce,Ye,Er,St),oe=new HM(ce,Er,bn,jt),J=new r0(ce,oe,Er,bn),he=new Mg(ce,St,on),yn=new UM(Qt),Re=new Qo(F,On,gi,Ye,St,jt,yn),wt=new I0(F,Qt),ct=new Eh,At=new E0(Ye,St),Fe=new tS(F,On,gi,it,J,M,d),Ct=new T0(F,J,St),Wn=new Mb(ce,bn,St,it),nt=new pg(ce,Ye,bn,St),Xt=new up(ce,Ye,bn,St),bn.programs=Re.programs,F.capabilities=St,F.extensions=Ye,F.properties=Qt,F.renderLists=ct,F.shadowMap=Ct,F.state=it,F.info=bn}Ei();const fe=new xb(F,ce);function Ht(re){re.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),V=!0}function Le(){console.log("THREE.WebGLRenderer: Context Restored."),V=!1;const re=bn.autoReset,Se=Ct.enabled,je=Ct.autoUpdate,we=Ct.needsUpdate,We=Ct.type;Ei(),bn.autoReset=re,Ct.enabled=Se,Ct.autoUpdate=je,Ct.needsUpdate=we,Ct.type=We}function xt(re){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",re.statusMessage)}function Gt(re){const Se=re.target;Se.removeEventListener("dispose",Gt),function ui(re){(function Gi(re){const Se=Qt.get(re).programs;void 0!==Se&&(Se.forEach(function(je){Re.releaseProgram(je)}),re.isShaderMaterial&&Re.releaseShaderCache(re))})(re),Qt.remove(re)}(Se)}this.xr=fe,this.getContext=function(){return ce},this.getContextAttributes=function(){return ce.getContextAttributes()},this.forceContextLoss=function(){const re=Ye.get("WEBGL_lose_context");re&&re.loseContext()},this.forceContextRestore=function(){const re=Ye.get("WEBGL_lose_context");re&&re.restoreContext()},this.getPixelRatio=function(){return Pe},this.setPixelRatio=function(re){void 0!==re&&(Pe=re,this.setSize(xe,Ne,!1))},this.getSize=function(re){return re.set(xe,Ne)},this.setSize=function(re,Se,je=!0){fe.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(xe=re,Ne=Se,t.width=Math.floor(re*Pe),t.height=Math.floor(Se*Pe),!0===je&&(t.style.width=re+"px",t.style.height=Se+"px"),this.setViewport(0,0,re,Se))},this.getDrawingBufferSize=function(re){return re.set(xe*Pe,Ne*Pe).floor()},this.setDrawingBufferSize=function(re,Se,je){xe=re,Ne=Se,Pe=je,t.width=Math.floor(re*je),t.height=Math.floor(Se*je),this.setViewport(0,0,re,Se)},this.getCurrentViewport=function(re){return re.copy(K)},this.getViewport=function(re){return re.copy(Ke)},this.setViewport=function(re,Se,je,we){re.isVector4?Ke.set(re.x,re.y,re.z,re.w):Ke.set(re,Se,je,we),it.viewport(K.copy(Ke).multiplyScalar(Pe).floor())},this.getScissor=function(re){return re.copy(_e)},this.setScissor=function(re,Se,je,we){re.isVector4?_e.set(re.x,re.y,re.z,re.w):_e.set(re,Se,je,we),it.scissor(Me.copy(_e).multiplyScalar(Pe).floor())},this.getScissorTest=function(){return He},this.setScissorTest=function(re){it.setScissorTest(He=re)},this.setOpaqueSort=function(re){ze=re},this.setTransparentSort=function(re){$e=re},this.getClearColor=function(re){return re.copy(Fe.getClearColor())},this.setClearColor=function(){Fe.setClearColor.apply(Fe,arguments)},this.getClearAlpha=function(){return Fe.getClearAlpha()},this.setClearAlpha=function(){Fe.setClearAlpha.apply(Fe,arguments)},this.clear=function(re=!0,Se=!0,je=!0){let we=0;if(re){let We=!1;if(null!==q){const ln=q.texture.format;We=1033===ln||1031===ln||1029===ln}if(We){const ln=q.texture.type,Pn=ln===Vo||ln===Ze||1012===ln||ln===js||1017===ln||1018===ln,Bn=Fe.getClearColor(),Vn=Fe.getClearAlpha(),vi=Bn.r,kn=Bn.g,ei=Bn.b;Pn?(b[0]=vi,b[1]=kn,b[2]=ei,b[3]=Vn,ce.clearBufferuiv(ce.COLOR,0,b)):(A[0]=vi,A[1]=kn,A[2]=ei,A[3]=Vn,ce.clearBufferiv(ce.COLOR,0,A))}else we|=ce.COLOR_BUFFER_BIT}Se&&(we|=ce.DEPTH_BUFFER_BIT),je&&(we|=ce.STENCIL_BUFFER_BIT),ce.clear(we)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Ht,!1),t.removeEventListener("webglcontextrestored",Le,!1),t.removeEventListener("webglcontextcreationerror",xt,!1),ct.dispose(),At.dispose(),Qt.dispose(),On.dispose(),gi.dispose(),J.dispose(),jt.dispose(),Wn.dispose(),Re.dispose(),fe.dispose(),fe.removeEventListener("sessionstart",gr),fe.removeEventListener("sessionend",Uc),Zt&&(Zt.dispose(),Zt=null),Lo.stop()},this.renderBufferDirect=function(re,Se,je,we,We,ln){null===Se&&(Se=ci);const Pn=We.isMesh&&We.matrixWorld.determinant()<0,Bn=function oT(re,Se,je,we,We){!0!==Se.isScene&&(Se=ci),on.resetTextureUnits();const ln=Se.fog,Bn=null===q?F.outputColorSpace:!0===q.isXRRenderTarget?q.texture.colorSpace:ls,Vn=(we.isMeshStandardMaterial?gi:On).get(we.envMap||(we.isMeshStandardMaterial?Se.environment:null)),vi=!0===we.vertexColors&&!!je.attributes.color&&4===je.attributes.color.itemSize,kn=!!je.attributes.tangent&&(!!we.normalMap||we.anisotropy>0),ei=!!je.morphAttributes.position,Wr=!!je.morphAttributes.normal,ns=!!je.morphAttributes.color;let gl=0;we.toneMapped&&(null===q||!0===q.isXRRenderTarget)&&(gl=F.toneMapping);const Hu=je.morphAttributes.position||je.morphAttributes.normal||je.morphAttributes.color,hs=void 0!==Hu?Hu.length:0,wi=Qt.get(we),dE=R.state.lights;!0!==ht||!0!==pt&&re===j||yn.setState(we,re,re===j&&we.id===ee);let ds=!1;we.version===wi.__version?(wi.needsLights&&wi.lightsStateVersion!==dE.state.version||wi.outputColorSpace!==Bn||We.isInstancedMesh&&!1===wi.instancing||!We.isInstancedMesh&&!0===wi.instancing||We.isSkinnedMesh&&!1===wi.skinning||!We.isSkinnedMesh&&!0===wi.skinning||We.isInstancedMesh&&!0===wi.instancingColor&&null===We.instanceColor||We.isInstancedMesh&&!1===wi.instancingColor&&null!==We.instanceColor||wi.envMap!==Vn||!0===we.fog&&wi.fog!==ln||void 0!==wi.numClippingPlanes&&(wi.numClippingPlanes!==yn.numPlanes||wi.numIntersection!==yn.numIntersection)||wi.vertexAlphas!==vi||wi.vertexTangents!==kn||wi.morphTargets!==ei||wi.morphNormals!==Wr||wi.morphColors!==ns||wi.toneMapping!==gl||!0===St.isWebGL2&&wi.morphTargetsCount!==hs)&&(ds=!0):(ds=!0,wi.__version=we.version);let Cf=wi.currentProgram;!0===ds&&(Cf=wx(we,Se,We));let bA=!1,ry=!1,fE=!1;const Oo=Cf.getUniforms(),Df=wi.uniforms;if(it.useProgram(Cf.program)&&(bA=!0,ry=!0,fE=!0),we.id!==ee&&(ee=we.id,ry=!0),bA||j!==re){if(Oo.setValue(ce,"projectionMatrix",re.projectionMatrix),St.logarithmicDepthBuffer&&Oo.setValue(ce,"logDepthBufFC",2/(Math.log(re.far+1)/Math.LN2)),j!==re&&(j=re,ry=!0,fE=!0),we.isShaderMaterial||we.isMeshPhongMaterial||we.isMeshToonMaterial||we.isMeshStandardMaterial||we.envMap){const Ba=Oo.map.cameraPosition;void 0!==Ba&&Ba.setValue(ce,li.setFromMatrixPosition(re.matrixWorld))}(we.isMeshPhongMaterial||we.isMeshToonMaterial||we.isMeshLambertMaterial||we.isMeshBasicMaterial||we.isMeshStandardMaterial||we.isShaderMaterial)&&Oo.setValue(ce,"isOrthographic",!0===re.isOrthographicCamera),(we.isMeshPhongMaterial||we.isMeshToonMaterial||we.isMeshLambertMaterial||we.isMeshBasicMaterial||we.isMeshStandardMaterial||we.isShaderMaterial||we.isShadowMaterial||We.isSkinnedMesh)&&Oo.setValue(ce,"viewMatrix",re.matrixWorldInverse)}if(We.isSkinnedMesh){Oo.setOptional(ce,We,"bindMatrix"),Oo.setOptional(ce,We,"bindMatrixInverse");const Ba=We.skeleton;Ba&&(St.floatVertexTextures?(null===Ba.boneTexture&&Ba.computeBoneTexture(),Oo.setValue(ce,"boneTexture",Ba.boneTexture,on),Oo.setValue(ce,"boneTextureSize",Ba.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const pE=je.morphAttributes;if((void 0!==pE.position||void 0!==pE.normal||void 0!==pE.color&&!0===St.isWebGL2)&&he.update(We,je,Cf),(ry||wi.receiveShadow!==We.receiveShadow)&&(wi.receiveShadow=We.receiveShadow,Oo.setValue(ce,"receiveShadow",We.receiveShadow)),we.isMeshGouraudMaterial&&null!==we.envMap&&(Df.envMap.value=Vn,Df.flipEnvMap.value=Vn.isCubeTexture&&!1===Vn.isRenderTargetTexture?-1:1),ry&&(Oo.setValue(ce,"toneMappingExposure",F.toneMappingExposure),wi.needsLights&&function aT(re,Se){re.ambientLightColor.needsUpdate=Se,re.lightProbe.needsUpdate=Se,re.directionalLights.needsUpdate=Se,re.directionalLightShadows.needsUpdate=Se,re.pointLights.needsUpdate=Se,re.pointLightShadows.needsUpdate=Se,re.spotLights.needsUpdate=Se,re.spotLightShadows.needsUpdate=Se,re.rectAreaLights.needsUpdate=Se,re.hemisphereLights.needsUpdate=Se}(Df,fE),ln&&!0===we.fog&&wt.refreshFogUniforms(Df,ln),wt.refreshMaterialUniforms(Df,we,Pe,Ne,Zt),Og.upload(ce,wi.uniformsList,Df,on)),we.isShaderMaterial&&!0===we.uniformsNeedUpdate&&(Og.upload(ce,wi.uniformsList,Df,on),we.uniformsNeedUpdate=!1),we.isSpriteMaterial&&Oo.setValue(ce,"center",We.center),Oo.setValue(ce,"modelViewMatrix",We.modelViewMatrix),Oo.setValue(ce,"normalMatrix",We.normalMatrix),Oo.setValue(ce,"modelMatrix",We.matrixWorld),we.isShaderMaterial||we.isRawShaderMaterial){const Ba=we.uniformsGroups;for(let mE=0,cT=Ba.length;mE<cT;mE++)if(St.isWebGL2){const wA=Ba[mE];Wn.update(wA,Cf),Wn.bind(wA,Cf)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Cf}(re,Se,je,we,We);it.setMaterial(we,Pn);let Vn=je.index,vi=1;if(!0===we.wireframe){if(Vn=oe.getWireframeAttribute(je),void 0===Vn)return;vi=2}const kn=je.drawRange,ei=je.attributes.position;let Wr=kn.start*vi,ns=(kn.start+kn.count)*vi;null!==ln&&(Wr=Math.max(Wr,ln.start*vi),ns=Math.min(ns,(ln.start+ln.count)*vi)),null!==Vn?(Wr=Math.max(Wr,0),ns=Math.min(ns,Vn.count)):null!=ei&&(Wr=Math.max(Wr,0),ns=Math.min(ns,ei.count));const gl=ns-Wr;if(gl<0||gl===1/0)return;jt.setup(We,we,Bn,je,Vn);let Hu,hs=nt;if(null!==Vn&&(Hu=Er.get(Vn),hs=Xt,hs.setIndex(Hu)),We.isMesh)!0===we.wireframe?(it.setLineWidth(we.wireframeLinewidth*xn()),hs.setMode(ce.LINES)):hs.setMode(ce.TRIANGLES);else if(We.isLine){let wi=we.linewidth;void 0===wi&&(wi=1),it.setLineWidth(wi*xn()),hs.setMode(We.isLineSegments?ce.LINES:We.isLineLoop?ce.LINE_LOOP:ce.LINE_STRIP)}else We.isPoints?hs.setMode(ce.POINTS):We.isSprite&&hs.setMode(ce.TRIANGLES);if(We.isInstancedMesh)hs.renderInstances(Wr,gl,We.count);else if(je.isInstancedBufferGeometry){const dE=Math.min(je.instanceCount,void 0!==je._maxInstanceCount?je._maxInstanceCount:1/0);hs.renderInstances(Wr,gl,dE)}else hs.render(Wr,gl)},this.compile=function(re,Se){function je(we,We,ln){!0===we.transparent&&2===we.side&&!1===we.forceSinglePass?(we.side=1,we.needsUpdate=!0,wx(we,We,ln),we.side=0,we.needsUpdate=!0,wx(we,We,ln),we.side=2):wx(we,We,ln)}R=At.get(re),R.init(),U.push(R),re.traverseVisible(function(we){we.isLight&&we.layers.test(Se.layers)&&(R.pushLight(we),we.castShadow&&R.pushShadow(we))}),R.setupLights(F._useLegacyLights),re.traverse(function(we){const We=we.material;if(We)if(Array.isArray(We))for(let ln=0;ln<We.length;ln++)je(We[ln],re,we);else je(We,re,we)}),U.pop(),R=null};let mr=null;function gr(){Lo.stop()}function Uc(){Lo.start()}const Lo=new wd;function yA(re,Se,je,we){if(!1===re.visible)return;if(re.layers.test(Se.layers))if(re.isGroup)je=re.renderOrder;else if(re.isLOD)!0===re.autoUpdate&&re.update(Se);else if(re.isLight)R.pushLight(re),re.castShadow&&R.pushShadow(re);else if(re.isSprite){if(!re.frustumCulled||ft.intersectsSprite(re)){we&&li.setFromMatrixPosition(re.matrixWorld).applyMatrix4(sn);const Pn=J.update(re),Bn=re.material;Bn.visible&&P.push(re,Pn,Bn,je,li.z,null)}}else if((re.isMesh||re.isLine||re.isPoints)&&(!re.frustumCulled||ft.intersectsObject(re))){const Pn=J.update(re),Bn=re.material;if(we&&(void 0!==re.boundingSphere?(null===re.boundingSphere&&re.computeBoundingSphere(),li.copy(re.boundingSphere.center)):(null===Pn.boundingSphere&&Pn.computeBoundingSphere(),li.copy(Pn.boundingSphere.center)),li.applyMatrix4(re.matrixWorld).applyMatrix4(sn)),Array.isArray(Bn)){const Vn=Pn.groups;for(let vi=0,kn=Vn.length;vi<kn;vi++){const ei=Vn[vi],Wr=Bn[ei.materialIndex];Wr&&Wr.visible&&P.push(re,Pn,Wr,je,li.z,ei)}}else Bn.visible&&P.push(re,Pn,Bn,je,li.z,null)}const ln=re.children;for(let Pn=0,Bn=ln.length;Pn<Bn;Pn++)yA(ln[Pn],Se,je,we)}function _A(re,Se,je,we){const We=re.opaque,ln=re.transmissive,Pn=re.transparent;R.setupLightsView(je),!0===ht&&yn.setGlobalState(F.clippingPlanes,je),ln.length>0&&function sT(re,Se,je,we){const We=St.isWebGL2;null===Zt&&(Zt=new ba(1,1,{generateMipmaps:!0,type:Ye.has("EXT_color_buffer_half_float")?_o:Vo,minFilter:Ms,samples:We?4:0})),F.getDrawingBufferSize(nn),We?Zt.setSize(nn.x,nn.y):Zt.setSize(ks(nn.x),ks(nn.y));const ln=F.getRenderTarget();F.setRenderTarget(Zt),F.getClearColor(me),pe=F.getClearAlpha(),pe<1&&F.setClearColor(16777215,.5),F.clear();const Pn=F.toneMapping;F.toneMapping=0,bx(re,je,we),on.updateMultisampleRenderTarget(Zt),on.updateRenderTargetMipmap(Zt);let Bn=!1;for(let Vn=0,vi=Se.length;Vn<vi;Vn++){const kn=Se[Vn],ei=kn.object,Wr=kn.geometry,ns=kn.material,gl=kn.group;if(2===ns.side&&ei.layers.test(we.layers)){const Hu=ns.side;ns.side=1,ns.needsUpdate=!0,xA(ei,je,we,Wr,ns,gl),ns.side=Hu,ns.needsUpdate=!0,Bn=!0}}!0===Bn&&(on.updateMultisampleRenderTarget(Zt),on.updateRenderTargetMipmap(Zt)),F.setRenderTarget(ln),F.setClearColor(me,pe),F.toneMapping=Pn}(We,ln,Se,je),we&&it.viewport(K.copy(we)),We.length>0&&bx(We,Se,je),ln.length>0&&bx(ln,Se,je),Pn.length>0&&bx(Pn,Se,je),it.buffers.depth.setTest(!0),it.buffers.depth.setMask(!0),it.buffers.color.setMask(!0),it.setPolygonOffset(!1)}function bx(re,Se,je){const we=!0===Se.isScene?Se.overrideMaterial:null;for(let We=0,ln=re.length;We<ln;We++){const Pn=re[We],Bn=Pn.object,Vn=Pn.geometry,vi=null===we?Pn.material:we,kn=Pn.group;Bn.layers.test(je.layers)&&xA(Bn,Se,je,Vn,vi,kn)}}function xA(re,Se,je,we,We,ln){re.onBeforeRender(F,Se,je,we,We,ln),re.modelViewMatrix.multiplyMatrices(je.matrixWorldInverse,re.matrixWorld),re.normalMatrix.getNormalMatrix(re.modelViewMatrix),We.onBeforeRender(F,Se,je,we,re,ln),!0===We.transparent&&2===We.side&&!1===We.forceSinglePass?(We.side=1,We.needsUpdate=!0,F.renderBufferDirect(je,Se,we,We,re,ln),We.side=0,We.needsUpdate=!0,F.renderBufferDirect(je,Se,we,We,re,ln),We.side=2):F.renderBufferDirect(je,Se,we,We,re,ln),re.onAfterRender(F,Se,je,we,We,ln)}function wx(re,Se,je){!0!==Se.isScene&&(Se=ci);const we=Qt.get(re),We=R.state.lights,Pn=We.state.version,Bn=Re.getParameters(re,We.state,R.state.shadowsArray,Se,je),Vn=Re.getProgramCacheKey(Bn);let vi=we.programs;we.environment=re.isMeshStandardMaterial?Se.environment:null,we.fog=Se.fog,we.envMap=(re.isMeshStandardMaterial?gi:On).get(re.envMap||we.environment),void 0===vi&&(re.addEventListener("dispose",Gt),vi=new Map,we.programs=vi);let kn=vi.get(Vn);if(void 0!==kn){if(we.currentProgram===kn&&we.lightsStateVersion===Pn)return MA(re,Bn),kn}else Bn.uniforms=Re.getUniforms(re),re.onBuild(je,Bn,F),re.onBeforeCompile(Bn,F),kn=Re.acquireProgram(Bn,Vn),vi.set(Vn,kn),we.uniforms=Bn.uniforms;const ei=we.uniforms;(!re.isShaderMaterial&&!re.isRawShaderMaterial||!0===re.clipping)&&(ei.clippingPlanes=yn.uniform),MA(re,Bn),we.needsLights=function lT(re){return re.isMeshLambertMaterial||re.isMeshToonMaterial||re.isMeshPhongMaterial||re.isMeshStandardMaterial||re.isShadowMaterial||re.isShaderMaterial&&!0===re.lights}(re),we.lightsStateVersion=Pn,we.needsLights&&(ei.ambientLightColor.value=We.state.ambient,ei.lightProbe.value=We.state.probe,ei.directionalLights.value=We.state.directional,ei.directionalLightShadows.value=We.state.directionalShadow,ei.spotLights.value=We.state.spot,ei.spotLightShadows.value=We.state.spotShadow,ei.rectAreaLights.value=We.state.rectArea,ei.ltc_1.value=We.state.rectAreaLTC1,ei.ltc_2.value=We.state.rectAreaLTC2,ei.pointLights.value=We.state.point,ei.pointLightShadows.value=We.state.pointShadow,ei.hemisphereLights.value=We.state.hemi,ei.directionalShadowMap.value=We.state.directionalShadowMap,ei.directionalShadowMatrix.value=We.state.directionalShadowMatrix,ei.spotShadowMap.value=We.state.spotShadowMap,ei.spotLightMatrix.value=We.state.spotLightMatrix,ei.spotLightMap.value=We.state.spotLightMap,ei.pointShadowMap.value=We.state.pointShadowMap,ei.pointShadowMatrix.value=We.state.pointShadowMatrix);const Wr=kn.getUniforms(),ns=Og.seqWithValue(Wr.seq,ei);return we.currentProgram=kn,we.uniformsList=ns,kn}function MA(re,Se){const je=Qt.get(re);je.outputColorSpace=Se.outputColorSpace,je.instancing=Se.instancing,je.instancingColor=Se.instancingColor,je.skinning=Se.skinning,je.morphTargets=Se.morphTargets,je.morphNormals=Se.morphNormals,je.morphColors=Se.morphColors,je.morphTargetsCount=Se.morphTargetsCount,je.numClippingPlanes=Se.numClippingPlanes,je.numIntersection=Se.numClipIntersection,je.vertexAlphas=Se.vertexAlphas,je.vertexTangents=Se.vertexTangents,je.toneMapping=Se.toneMapping}Lo.setAnimationLoop(function td(re){mr&&mr(re)}),"undefined"!=typeof self&&Lo.setContext(self),this.setAnimationLoop=function(re){mr=re,fe.setAnimationLoop(re),null===re?Lo.stop():Lo.start()},fe.addEventListener("sessionstart",gr),fe.addEventListener("sessionend",Uc),this.render=function(re,Se){if(void 0===Se||!0===Se.isCamera){if(!0!==V){if(!0===re.matrixWorldAutoUpdate&&re.updateMatrixWorld(),null===Se.parent&&!0===Se.matrixWorldAutoUpdate&&Se.updateMatrixWorld(),!0===fe.enabled&&!0===fe.isPresenting&&(!0===fe.cameraAutoUpdate&&fe.updateCamera(Se),Se=fe.getCamera()),!0===re.isScene&&re.onBeforeRender(F,re,Se,q),R=At.get(re,U.length),R.init(),U.push(R),sn.multiplyMatrices(Se.projectionMatrix,Se.matrixWorldInverse),ft.setFromProjectionMatrix(sn),pt=this.localClippingEnabled,ht=yn.init(this.clippingPlanes,pt),P=ct.get(re,T.length),P.init(),T.push(P),yA(re,Se,0,F.sortObjects),P.finish(),!0===F.sortObjects&&P.sort(ze,$e),this.info.render.frame++,!0===ht&&yn.beginShadows(),Ct.render(R.state.shadowsArray,re,Se),!0===ht&&yn.endShadows(),!0===this.info.autoReset&&this.info.reset(),Fe.render(P,re),R.setupLights(F._useLegacyLights),Se.isArrayCamera){const we=Se.cameras;for(let We=0,ln=we.length;We<ln;We++){const Pn=we[We];_A(P,re,Pn,Pn.viewport)}}else _A(P,re,Se);null!==q&&(on.updateMultisampleRenderTarget(q),on.updateRenderTargetMipmap(q)),!0===re.isScene&&re.onAfterRender(F,re,Se),jt.resetDefaultState(),ee=-1,j=null,U.pop(),R=U.length>0?U[U.length-1]:null,T.pop(),P=T.length>0?T[T.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return X},this.getActiveMipmapLevel=function(){return Z},this.getRenderTarget=function(){return q},this.setRenderTargetTextures=function(re,Se,je){Qt.get(re.texture).__webglTexture=Se,Qt.get(re.depthTexture).__webglTexture=je;const we=Qt.get(re);we.__hasExternalTextures=!0,we.__hasExternalTextures&&(we.__autoAllocateDepthBuffer=void 0===je,we.__autoAllocateDepthBuffer||!0===Ye.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),we.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(re,Se){const je=Qt.get(re);je.__webglFramebuffer=Se,je.__useDefaultFramebuffer=void 0===Se},this.setRenderTarget=function(re,Se=0,je=0){q=re,X=Se,Z=je;let we=!0,We=null,ln=!1,Pn=!1;if(re){const Vn=Qt.get(re);void 0!==Vn.__useDefaultFramebuffer?(it.bindFramebuffer(ce.FRAMEBUFFER,null),we=!1):void 0===Vn.__webglFramebuffer?on.setupRenderTarget(re):Vn.__hasExternalTextures&&on.rebindTextures(re,Qt.get(re.texture).__webglTexture,Qt.get(re.depthTexture).__webglTexture);const vi=re.texture;(vi.isData3DTexture||vi.isDataArrayTexture||vi.isCompressedArrayTexture)&&(Pn=!0);const kn=Qt.get(re).__webglFramebuffer;re.isWebGLCubeRenderTarget?(We=Array.isArray(kn[Se])?kn[Se][je]:kn[Se],ln=!0):We=St.isWebGL2&&re.samples>0&&!1===on.useMultisampledRTT(re)?Qt.get(re).__webglMultisampledFramebuffer:Array.isArray(kn)?kn[je]:kn,K.copy(re.viewport),Me.copy(re.scissor),De=re.scissorTest}else K.copy(Ke).multiplyScalar(Pe).floor(),Me.copy(_e).multiplyScalar(Pe).floor(),De=He;if(it.bindFramebuffer(ce.FRAMEBUFFER,We)&&St.drawBuffers&&we&&it.drawBuffers(re,We),it.viewport(K),it.scissor(Me),it.setScissorTest(De),ln){const Vn=Qt.get(re.texture);ce.framebufferTexture2D(ce.FRAMEBUFFER,ce.COLOR_ATTACHMENT0,ce.TEXTURE_CUBE_MAP_POSITIVE_X+Se,Vn.__webglTexture,je)}else if(Pn){const Vn=Qt.get(re.texture);ce.framebufferTextureLayer(ce.FRAMEBUFFER,ce.COLOR_ATTACHMENT0,Vn.__webglTexture,je||0,Se||0)}ee=-1},this.readRenderTargetPixels=function(re,Se,je,we,We,ln,Pn){if(!re||!re.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Bn=Qt.get(re).__webglFramebuffer;if(re.isWebGLCubeRenderTarget&&void 0!==Pn&&(Bn=Bn[Pn]),Bn){it.bindFramebuffer(ce.FRAMEBUFFER,Bn);try{const Vn=re.texture,vi=Vn.format,kn=Vn.type;if(vi!==qr&&Bt.convert(vi)!==ce.getParameter(ce.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const ei=kn===_o&&(Ye.has("EXT_color_buffer_half_float")||St.isWebGL2&&Ye.has("EXT_color_buffer_float"));if(!(kn===Vo||Bt.convert(kn)===ce.getParameter(ce.IMPLEMENTATION_COLOR_READ_TYPE)||kn===Tn&&(St.isWebGL2||Ye.has("OES_texture_float")||Ye.has("WEBGL_color_buffer_float"))||ei))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");Se>=0&&Se<=re.width-we&&je>=0&&je<=re.height-We&&ce.readPixels(Se,je,we,We,Bt.convert(vi),Bt.convert(kn),ln)}finally{const Vn=null!==q?Qt.get(q).__webglFramebuffer:null;it.bindFramebuffer(ce.FRAMEBUFFER,Vn)}}},this.copyFramebufferToTexture=function(re,Se,je=0){const we=Math.pow(2,-je),We=Math.floor(Se.image.width*we),ln=Math.floor(Se.image.height*we);on.setTexture2D(Se,0),ce.copyTexSubImage2D(ce.TEXTURE_2D,je,0,0,re.x,re.y,We,ln),it.unbindTexture()},this.copyTextureToTexture=function(re,Se,je,we=0){const We=Se.image.width,ln=Se.image.height,Pn=Bt.convert(je.format),Bn=Bt.convert(je.type);on.setTexture2D(je,0),ce.pixelStorei(ce.UNPACK_FLIP_Y_WEBGL,je.flipY),ce.pixelStorei(ce.UNPACK_PREMULTIPLY_ALPHA_WEBGL,je.premultiplyAlpha),ce.pixelStorei(ce.UNPACK_ALIGNMENT,je.unpackAlignment),Se.isDataTexture?ce.texSubImage2D(ce.TEXTURE_2D,we,re.x,re.y,We,ln,Pn,Bn,Se.image.data):Se.isCompressedTexture?ce.compressedTexSubImage2D(ce.TEXTURE_2D,we,re.x,re.y,Se.mipmaps[0].width,Se.mipmaps[0].height,Pn,Se.mipmaps[0].data):ce.texSubImage2D(ce.TEXTURE_2D,we,re.x,re.y,Pn,Bn,Se.image),0===we&&je.generateMipmaps&&ce.generateMipmap(ce.TEXTURE_2D),it.unbindTexture()},this.copyTextureToTexture3D=function(re,Se,je,we,We=0){if(F.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const ln=re.max.x-re.min.x+1,Pn=re.max.y-re.min.y+1,Bn=re.max.z-re.min.z+1,Vn=Bt.convert(we.format),vi=Bt.convert(we.type);let kn;if(we.isData3DTexture)on.setTexture3D(we,0),kn=ce.TEXTURE_3D;else{if(!we.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");on.setTexture2DArray(we,0),kn=ce.TEXTURE_2D_ARRAY}ce.pixelStorei(ce.UNPACK_FLIP_Y_WEBGL,we.flipY),ce.pixelStorei(ce.UNPACK_PREMULTIPLY_ALPHA_WEBGL,we.premultiplyAlpha),ce.pixelStorei(ce.UNPACK_ALIGNMENT,we.unpackAlignment);const ei=ce.getParameter(ce.UNPACK_ROW_LENGTH),Wr=ce.getParameter(ce.UNPACK_IMAGE_HEIGHT),ns=ce.getParameter(ce.UNPACK_SKIP_PIXELS),gl=ce.getParameter(ce.UNPACK_SKIP_ROWS),Hu=ce.getParameter(ce.UNPACK_SKIP_IMAGES),hs=je.isCompressedTexture?je.mipmaps[0]:je.image;ce.pixelStorei(ce.UNPACK_ROW_LENGTH,hs.width),ce.pixelStorei(ce.UNPACK_IMAGE_HEIGHT,hs.height),ce.pixelStorei(ce.UNPACK_SKIP_PIXELS,re.min.x),ce.pixelStorei(ce.UNPACK_SKIP_ROWS,re.min.y),ce.pixelStorei(ce.UNPACK_SKIP_IMAGES,re.min.z),je.isDataTexture||je.isData3DTexture?ce.texSubImage3D(kn,We,Se.x,Se.y,Se.z,ln,Pn,Bn,Vn,vi,hs.data):je.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),ce.compressedTexSubImage3D(kn,We,Se.x,Se.y,Se.z,ln,Pn,Bn,Vn,hs.data)):ce.texSubImage3D(kn,We,Se.x,Se.y,Se.z,ln,Pn,Bn,Vn,vi,hs),ce.pixelStorei(ce.UNPACK_ROW_LENGTH,ei),ce.pixelStorei(ce.UNPACK_IMAGE_HEIGHT,Wr),ce.pixelStorei(ce.UNPACK_SKIP_PIXELS,ns),ce.pixelStorei(ce.UNPACK_SKIP_ROWS,gl),ce.pixelStorei(ce.UNPACK_SKIP_IMAGES,Hu),0===We&&we.generateMipmaps&&ce.generateMipmap(kn),it.unbindTexture()},this.initTexture=function(re){re.isCubeTexture?on.setTextureCube(re,0):re.isData3DTexture?on.setTexture3D(re,0):re.isDataArrayTexture||re.isCompressedArrayTexture?on.setTexture2DArray(re,0):on.setTexture2D(re,0),it.unbindTexture()},this.resetState=function(){X=0,Z=0,q=null,it.reset(),jt.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return qs}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(e){console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===vn?xa:3e3}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===xa?vn:ls}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}(class bb extends Gg{}).prototype.isWebGL1Renderer=!0;class Od extends xr{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}}class Fd{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Hr()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let i=0,a=this.stride;i<a;i++)this.array[e+i]=t.array[n+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Hr()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Hr()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Zs=new Q;class Rh{constructor(e,t,n,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)Zs.fromBufferAttribute(this,t),Zs.applyMatrix4(e),this.setXYZ(t,Zs.x,Zs.y,Zs.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Zs.fromBufferAttribute(this,t),Zs.applyNormalMatrix(e),this.setXYZ(t,Zs.x,Zs.y,Zs.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Zs.fromBufferAttribute(this,t),Zs.transformDirection(e),this.setXYZ(t,Zs.x,Zs.y,Zs.z);return this}setX(e,t){return this.normalized&&(t=Yn(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Yn(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Yn(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Yn(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Kr(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Kr(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Kr(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Kr(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=Yn(t,this.array),n=Yn(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Yn(t,this.array),n=Yn(n,this.array),i=Yn(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this}setXYZW(e,t,n,i,a){return e=e*this.data.stride+this.offset,this.normalized&&(t=Yn(t,this.array),n=Yn(n,this.array),i=Yn(i,this.array),a=Yn(a,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this.data.array[e+3]=a,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const i=n*this.data.stride+this.offset;for(let a=0;a<this.itemSize;a++)t.push(this.data.array[i+a])}return new sr(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Rh(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const i=n*this.data.stride+this.offset;for(let a=0;a<this.itemSize;a++)t.push(this.data.array[i+a])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}const Xg=new Q,N0=new Ci,qg=new Ci,k0=new Q,yp=new Yt,Gd=new Q,Wd=new Yo,U0=new Yt,B0=new rh;class wu extends Ji{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Yt,this.bindMatrixInverse=new Yt,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;null===this.boundingBox&&(this.boundingBox=new tl),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)Gd.fromBufferAttribute(t,n),this.applyBoneTransform(n,Gd),this.boundingBox.expandByPoint(Gd)}computeBoundingSphere(){const e=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new Yo),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)Gd.fromBufferAttribute(t,n),this.applyBoneTransform(n,Gd),this.boundingSphere.expandByPoint(Gd)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const i=this.matrixWorld;void 0!==this.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),Wd.copy(this.boundingSphere),Wd.applyMatrix4(i),!1!==e.ray.intersectsSphere(Wd)&&(U0.copy(i).invert(),B0.copy(e.ray).applyMatrix4(U0),(null===this.boundingBox||!1!==B0.intersectsBox(this.boundingBox))&&this._computeIntersections(e,t,B0)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Ci,t=this.geometry.attributes.skinWeight;for(let n=0,i=t.count;n<i;n++){e.fromBufferAttribute(t,n);const a=1/e.manhattanLength();a!==1/0?e.multiplyScalar(a):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton,i=this.geometry;N0.fromBufferAttribute(i.attributes.skinIndex,e),qg.fromBufferAttribute(i.attributes.skinWeight,e),Xg.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let a=0;a<4;a++){const c=qg.getComponent(a);if(0!==c){const u=N0.getComponent(a);yp.multiplyMatrices(n.bones[u].matrixWorld,n.boneInverses[u]),t.addScaledVector(k0.copy(Xg).applyMatrix4(yp),c)}}return t.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,t){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,t)}}class Ph extends xr{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Eu extends Ss{constructor(e=null,t=1,n=1,i,a,c,u,d,p=Fi,v=Fi,_,M){super(null,c,u,d,p,v,i,a,_,M),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const _p=new Yt,Ab=new Yt;class Ac{constructor(e=[],t=[]){this.uuid=Hr(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,i=this.bones.length;n<i;n++)this.boneInverses.push(new Yt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new Yt;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,i=this.boneTexture;for(let a=0,c=e.length;a<c;a++)_p.multiplyMatrices(e[a]?e[a].matrixWorld:Ab,t[a]),_p.toArray(n,16*a);null!==i&&(i.needsUpdate=!0)}clone(){return new Ac(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=Om(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new Eu(t,e,e,qr,Tn);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const i=this.bones[t];if(i.name===e)return i}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,i=e.bones.length;n<i;n++){const a=e.bones[n];let c=t[a];void 0===c&&(console.warn("THREE.Skeleton: No bone found with UUID:",a),c=new Ph),this.bones.push(c),this.boneInverses.push((new Yt).fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let i=0,a=t.length;i<a;i++)e.bones.push(t[i].uuid),e.boneInverses.push(n[i].toArray());return e}}class Tc extends sr{constructor(e,t,n,i=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Cc=new Yt,Tb=new Yt,xp=[],Mp=new tl,Yg=new Yt,Lh=new Ji,Oh=new Yo;class bp extends Ji{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Tc(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let i=0;i<n;i++)this.setMatrixAt(i,Yg)}computeBoundingBox(){const e=this.geometry,t=this.count;null===this.boundingBox&&(this.boundingBox=new tl),null===e.boundingBox&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,Cc),Mp.copy(e.boundingBox).applyMatrix4(Cc),this.boundingBox.union(Mp)}computeBoundingSphere(){const e=this.geometry,t=this.count;null===this.boundingSphere&&(this.boundingSphere=new Yo),null===e.boundingSphere&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,Cc),Oh.copy(e.boundingSphere).applyMatrix4(Cc),this.boundingSphere.union(Oh)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const n=this.matrixWorld,i=this.count;if(Lh.geometry=this.geometry,Lh.material=this.material,void 0!==Lh.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),Oh.copy(this.boundingSphere),Oh.applyMatrix4(n),!1!==e.ray.intersectsSphere(Oh)))for(let a=0;a<i;a++){this.getMatrixAt(a,Cc),Tb.multiplyMatrices(n,Cc),Lh.matrixWorld=Tb,Lh.raycast(e,xp);for(let c=0,u=xp.length;c<u;c++){const d=xp[c];d.instanceId=a,d.object=this,t.push(d)}xp.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new Tc(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class Vs extends lo{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new ut(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const Zg=new Q,wp=new Q,Kg=new Yt,Jg=new rh,jd=new Yo;class zl extends xr{constructor(e=new Un,t=new Vs){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[0];for(let i=1,a=t.count;i<a;i++)Zg.fromBufferAttribute(t,i-1),wp.fromBufferAttribute(t,i),n[i]=n[i-1],n[i]+=Zg.distanceTo(wp);e.setAttribute("lineDistance",new qt(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,a=e.params.Line.threshold,c=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),jd.copy(n.boundingSphere),jd.applyMatrix4(i),jd.radius+=a,!1===e.ray.intersectsSphere(jd))return;Kg.copy(i).invert(),Jg.copy(e.ray).applyMatrix4(Kg);const u=a/((this.scale.x+this.scale.y+this.scale.z)/3),d=u*u,p=new Q,v=new Q,_=new Q,M=new Q,b=this.isLineSegments?2:1,A=n.index,R=n.attributes.position;if(null!==A)for(let F=Math.max(0,c.start),V=Math.min(A.count,c.start+c.count)-1;F<V;F+=b){const X=A.getX(F),Z=A.getX(F+1);if(p.fromBufferAttribute(R,X),v.fromBufferAttribute(R,Z),Jg.distanceSqToSegment(p,v,M,_)>d)continue;M.applyMatrix4(this.matrixWorld);const ee=e.ray.origin.distanceTo(M);ee<e.near||ee>e.far||t.push({distance:ee,point:_.clone().applyMatrix4(this.matrixWorld),index:F,face:null,faceIndex:null,object:this})}else for(let F=Math.max(0,c.start),V=Math.min(R.count,c.start+c.count)-1;F<V;F+=b){if(p.fromBufferAttribute(R,F),v.fromBufferAttribute(R,F+1),Jg.distanceSqToSegment(p,v,M,_)>d)continue;M.applyMatrix4(this.matrixWorld);const Z=e.ray.origin.distanceTo(M);Z<e.near||Z>e.far||t.push({distance:Z,point:_.clone().applyMatrix4(this.matrixWorld),index:F,face:null,faceIndex:null,object:this})}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const i=t[n[0]];if(void 0!==i){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,c=i.length;a<c;a++){const u=i[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=a}}}}}const Ep=new Q,Qg=new Q;class $d extends zl{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[];for(let i=0,a=t.count;i<a;i+=2)Ep.fromBufferAttribute(t,i),Qg.fromBufferAttribute(t,i+1),n[i]=0===i?0:n[i-1],n[i+1]=n[i]+Ep.distanceTo(Qg);e.setAttribute("lineDistance",new qt(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class ev extends zl{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class Sp extends lo{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new ut(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const tv=new Yt,Xd=new rh,qd=new Yo,Yd=new Q;class nv extends xr{constructor(e=new Un,t=new Sp){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,a=e.params.Points.threshold,c=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),qd.copy(n.boundingSphere),qd.applyMatrix4(i),qd.radius+=a,!1===e.ray.intersectsSphere(qd))return;tv.copy(i).invert(),Xd.copy(e.ray).applyMatrix4(tv);const u=a/((this.scale.x+this.scale.y+this.scale.z)/3),d=u*u,p=n.index,_=n.attributes.position;if(null!==p)for(let A=Math.max(0,c.start),P=Math.min(p.count,c.start+c.count);A<P;A++){const R=p.getX(A);Yd.fromBufferAttribute(_,R),iv(Yd,R,d,i,e,t,this)}else for(let A=Math.max(0,c.start),P=Math.min(_.count,c.start+c.count);A<P;A++)Yd.fromBufferAttribute(_,A),iv(Yd,A,d,i,e,t,this)}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const i=t[n[0]];if(void 0!==i){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,c=i.length;a<c;a++){const u=i[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=a}}}}}function iv(o,e,t,n,i,a,c){const u=Xd.distanceSqToPoint(o);if(u<t){const d=new Q;Xd.closestPointToPoint(o,d),d.applyMatrix4(n);const p=i.ray.origin.distanceTo(d);if(p<i.near||p>i.far)return;a.push({distance:p,distanceToRay:Math.sqrt(u),point:d,index:e,face:null,object:c})}}const Lp=new Q,Jd=new Q,Op=new Q,Cu=new ao;class j0 extends Un{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},null!==e){const i=Math.pow(10,4),a=Math.cos($o*t),c=e.getIndex(),u=e.getAttribute("position"),d=c?c.count:u.count,p=[0,0,0],v=["a","b","c"],_=new Array(3),M={},b=[];for(let A=0;A<d;A+=3){c?(p[0]=c.getX(A),p[1]=c.getX(A+1),p[2]=c.getX(A+2)):(p[0]=A,p[1]=A+1,p[2]=A+2);const{a:P,b:R,c:T}=Cu;if(P.fromBufferAttribute(u,p[0]),R.fromBufferAttribute(u,p[1]),T.fromBufferAttribute(u,p[2]),Cu.getNormal(Op),_[0]=`${Math.round(P.x*i)},${Math.round(P.y*i)},${Math.round(P.z*i)}`,_[1]=`${Math.round(R.x*i)},${Math.round(R.y*i)},${Math.round(R.z*i)}`,_[2]=`${Math.round(T.x*i)},${Math.round(T.y*i)},${Math.round(T.z*i)}`,_[0]!==_[1]&&_[1]!==_[2]&&_[2]!==_[0])for(let U=0;U<3;U++){const F=(U+1)%3,V=_[U],X=_[F],Z=Cu[v[U]],q=Cu[v[F]],ee=`${V}_${X}`,j=`${X}_${V}`;j in M&&M[j]?(Op.dot(M[j].normal)<=a&&(b.push(Z.x,Z.y,Z.z),b.push(q.x,q.y,q.z)),M[j]=null):ee in M||(M[ee]={index0:p[U],index1:p[F],normal:Op.clone()})}}for(const A in M)if(M[A]){const{index0:P,index1:R}=M[A];Lp.fromBufferAttribute(u,P),Jd.fromBufferAttribute(u,R),b.push(Lp.x,Lp.y,Lp.z),b.push(Jd.x,Jd.y,Jd.z)}this.setAttribute("position",new qt(b,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class na extends Un{constructor(e=1,t=32,n=16,i=0,a=2*Math.PI,c=0,u=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:a,thetaStart:c,thetaLength:u},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const d=Math.min(c+u,Math.PI);let p=0;const v=[],_=new Q,M=new Q,b=[],A=[],P=[],R=[];for(let T=0;T<=n;T++){const U=[],F=T/n;let V=0;0===T&&0===c?V=.5/t:T===n&&d===Math.PI&&(V=-.5/t);for(let X=0;X<=t;X++){const Z=X/t;_.x=-e*Math.cos(i+Z*a)*Math.sin(c+F*u),_.y=e*Math.cos(c+F*u),_.z=e*Math.sin(i+Z*a)*Math.sin(c+F*u),A.push(_.x,_.y,_.z),M.copy(_).normalize(),P.push(M.x,M.y,M.z),R.push(Z+V,1-F),U.push(p++)}v.push(U)}for(let T=0;T<n;T++)for(let U=0;U<t;U++){const F=v[T][U+1],V=v[T][U],X=v[T+1][U],Z=v[T+1][U+1];(0!==T||c>0)&&b.push(F,V,Z),(T!==n-1||d<Math.PI)&&b.push(V,X,Z)}this.setIndex(b),this.setAttribute("position",new qt(A,3)),this.setAttribute("normal",new qt(P,3)),this.setAttribute("uv",new qt(R,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new na(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Gp extends lo{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new ut(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Be(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class ia extends Gp{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Be(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Ki(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new ut(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new ut(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new ut(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class Wp extends lo{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new ut(16777215),this.specular=new ut(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Be(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Qi extends lo{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new ut(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Be(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}function ra(o,e,t){return Xp(o)?new o.constructor(o.subarray(e,void 0!==t?t:o.length)):o.slice(e,t)}function Ru(o,e,t){return!o||!t&&o.constructor===e?o:"number"==typeof e.BYTES_PER_ELEMENT?new e(o):Array.prototype.slice.call(o)}function Xp(o){return ArrayBuffer.isView(o)&&!(o instanceof DataView)}function pv(o){const t=o.length,n=new Array(t);for(let i=0;i!==t;++i)n[i]=i;return n.sort(function e(i,a){return o[i]-o[a]}),n}function qp(o,e,t){const n=o.length,i=new o.constructor(n);for(let a=0,c=0;c!==n;++a){const u=t[a]*e;for(let d=0;d!==e;++d)i[c++]=o[u+d]}return i}function Yp(o,e,t,n){let i=1,a=o[0];for(;void 0!==a&&void 0===a[n];)a=o[i++];if(void 0===a)return;let c=a[n];if(void 0!==c)if(Array.isArray(c))do{c=a[n],void 0!==c&&(e.push(a.time),t.push.apply(t,c)),a=o[i++]}while(void 0!==a);else if(void 0!==c.toArray)do{c=a[n],void 0!==c&&(e.push(a.time),c.toArray(t,t.length)),a=o[i++]}while(void 0!==a);else do{c=a[n],void 0!==c&&(e.push(a.time),t.push(c)),a=o[i++]}while(void 0!==a)}class Wl{constructor(e,t,n,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,i=t[n],a=t[n-1];e:{t:{let c;n:{i:if(!(e<i)){for(let u=n+2;;){if(void 0===i){if(e<a)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===u)break;if(a=i,i=t[++n],e<i)break t}c=t.length;break n}if(e>=a)break e;{const u=t[1];e<u&&(n=2,a=u);for(let d=n-2;;){if(void 0===a)return this._cachedIndex=0,this.copySampleValue_(0);if(n===d)break;if(i=a,a=t[--n-1],e>=a)break t}c=n,n=0}}for(;n<c;){const u=n+c>>>1;e<t[u]?c=u:n=u+1}if(i=t[n],a=t[n-1],void 0===a)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===i)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,a,i)}return this.interpolate_(n,a,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,a=e*i;for(let c=0;c!==i;++c)t[c]=n[a+c];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Zb extends Wl{constructor(e,t,n,i){super(e,t,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,n){const i=this.parameterPositions;let a=e-2,c=e+1,u=i[a],d=i[c];if(void 0===u)switch(this.getSettings_().endingStart){case 2401:a=e,u=2*t-n;break;case 2402:a=i.length-2,u=t+i[a]-i[a+1];break;default:a=e,u=n}if(void 0===d)switch(this.getSettings_().endingEnd){case 2401:c=e,d=2*n-t;break;case 2402:c=1,d=n+i[1]-i[0];break;default:c=e-1,d=t}const p=.5*(n-t),v=this.valueSize;this._weightPrev=p/(t-u),this._weightNext=p/(d-n),this._offsetPrev=a*v,this._offsetNext=c*v}interpolate_(e,t,n,i){const a=this.resultBuffer,c=this.sampleValues,u=this.valueSize,d=e*u,p=d-u,v=this._offsetPrev,_=this._offsetNext,M=this._weightPrev,b=this._weightNext,A=(n-t)/(i-t),P=A*A,R=P*A,T=-M*R+2*M*P-M*A,U=(1+M)*R+(-1.5-2*M)*P+(-.5+M)*A+1,F=(-1-b)*R+(1.5+b)*P+.5*A,V=b*R-b*P;for(let X=0;X!==u;++X)a[X]=T*c[v+X]+U*c[p+X]+F*c[d+X]+V*c[_+X];return a}}class u_ extends Wl{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const a=this.resultBuffer,c=this.sampleValues,u=this.valueSize,d=e*u,p=d-u,v=(n-t)/(i-t),_=1-v;for(let M=0;M!==u;++M)a[M]=c[p+M]*_+c[d+M]*v;return a}}class Kb extends Wl{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class Io{constructor(e,t,n,i){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Ru(t,this.TimeBufferType),this.values=Ru(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:Ru(e.times,Array),values:Ru(e.values,Array)};const i=e.getInterpolation();i!==e.DefaultInterpolation&&(n.interpolation=i)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new Kb(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new u_(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Zb(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Za:t=this.InterpolantFactoryMethodDiscrete;break;case Yr:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Za;case this.InterpolantFactoryMethodLinear:return Yr;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]*=e}return this}trim(e,t){const n=this.times,i=n.length;let a=0,c=i-1;for(;a!==i&&n[a]<e;)++a;for(;-1!==c&&n[c]>t;)--c;if(++c,0!==a||c!==i){a>=c&&(c=Math.max(c,1),a=c-1);const u=this.getValueSize();this.times=ra(n,a,c),this.values=ra(this.values,a*u,c*u)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,i=this.values,a=n.length;0===a&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let c=null;for(let u=0;u!==a;u++){const d=n[u];if("number"==typeof d&&isNaN(d)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,u,d),e=!1;break}if(null!==c&&c>d){console.error("THREE.KeyframeTrack: Out of order keys.",this,u,d,c),e=!1;break}c=d}if(void 0!==i&&Xp(i))for(let u=0,d=i.length;u!==d;++u){const p=i[u];if(isNaN(p)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,u,p),e=!1;break}}return e}optimize(){const e=ra(this.times),t=ra(this.values),n=this.getValueSize(),i=2302===this.getInterpolation(),a=e.length-1;let c=1;for(let u=1;u<a;++u){let d=!1;const p=e[u];if(p!==e[u+1]&&(1!==u||p!==e[0]))if(i)d=!0;else{const _=u*n,M=_-n,b=_+n;for(let A=0;A!==n;++A){const P=t[_+A];if(P!==t[M+A]||P!==t[b+A]){d=!0;break}}}if(d){if(u!==c){e[c]=e[u];const _=u*n,M=c*n;for(let b=0;b!==n;++b)t[M+b]=t[_+b]}++c}}if(a>0){e[c]=e[a];for(let u=a*n,d=c*n,p=0;p!==n;++p)t[d+p]=t[u+p];++c}return c!==e.length?(this.times=ra(e,0,c),this.values=ra(t,0,c*n)):(this.times=e,this.values=t),this}clone(){const e=ra(this.times,0),t=ra(this.values,0),i=new(0,this.constructor)(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}}Io.prototype.TimeBufferType=Float32Array,Io.prototype.ValueBufferType=Float32Array,Io.prototype.DefaultInterpolation=Yr;class Iu extends Io{}Iu.prototype.ValueTypeName="bool",Iu.prototype.ValueBufferType=Array,Iu.prototype.DefaultInterpolation=Za,Iu.prototype.InterpolantFactoryMethodLinear=void 0,Iu.prototype.InterpolantFactoryMethodSmooth=void 0;class mv extends Io{}mv.prototype.ValueTypeName="color";class Dc extends Io{}Dc.prototype.ValueTypeName="number";class Jb extends Wl{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const a=this.resultBuffer,c=this.sampleValues,u=this.valueSize,d=(n-t)/(i-t);let p=e*u;for(let v=p+u;p!==v;p+=4)_r.slerpFlat(a,0,c,p-u,c,p,d);return a}}class sa extends Io{InterpolantFactoryMethodLinear(e){return new Jb(this.times,this.values,this.getValueSize(),e)}}sa.prototype.ValueTypeName="quaternion",sa.prototype.DefaultInterpolation=Yr,sa.prototype.InterpolantFactoryMethodSmooth=void 0;class ul extends Io{}ul.prototype.ValueTypeName="string",ul.prototype.ValueBufferType=Array,ul.prototype.DefaultInterpolation=Za,ul.prototype.InterpolantFactoryMethodLinear=void 0,ul.prototype.InterpolantFactoryMethodSmooth=void 0;class Pu extends Io{}Pu.prototype.ValueTypeName="vector";class Vh{constructor(e,t=-1,n,i=2500){this.name=e,this.tracks=n,this.duration=t,this.blendMode=i,this.uuid=Hr(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,i=1/(e.fps||1);for(let c=0,u=n.length;c!==u;++c)t.push(h_(n[c]).scale(i));const a=new this(e.name,e.duration,t,e.blendMode);return a.uuid=e.uuid,a}static toJSON(e){const t=[],n=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let a=0,c=n.length;a!==c;++a)t.push(Io.toJSON(n[a]));return i}static CreateFromMorphTargetSequence(e,t,n,i){const a=t.length,c=[];for(let u=0;u<a;u++){let d=[],p=[];d.push((u+a-1)%a,u,(u+1)%a),p.push(0,1,0);const v=pv(d);d=qp(d,1,v),p=qp(p,1,v),!i&&0===d[0]&&(d.push(a),p.push(p[0])),c.push(new Dc(".morphTargetInfluences["+t[u].name+"]",d,p).scale(1/n))}return new this(e,-1,c)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const i=e;n=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const i={},a=/^([\w-]*?)([\d]+)$/;for(let u=0,d=e.length;u<d;u++){const p=e[u],v=p.name.match(a);if(v&&v.length>1){const _=v[1];let M=i[_];M||(i[_]=M=[]),M.push(p)}}const c=[];for(const u in i)c.push(this.CreateFromMorphTargetSequence(u,i[u],t,n));return c}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(_,M,b,A,P){if(0!==b.length){const R=[],T=[];Yp(b,R,T,A),0!==R.length&&P.push(new _(M,R,T))}},i=[],a=e.name||"default",c=e.fps||30,u=e.blendMode;let d=e.length||-1;const p=e.hierarchy||[];for(let _=0;_<p.length;_++){const M=p[_].keys;if(M&&0!==M.length)if(M[0].morphTargets){const b={};let A;for(A=0;A<M.length;A++)if(M[A].morphTargets)for(let P=0;P<M[A].morphTargets.length;P++)b[M[A].morphTargets[P]]=-1;for(const P in b){const R=[],T=[];for(let U=0;U!==M[A].morphTargets.length;++U){const F=M[A];R.push(F.time),T.push(F.morphTarget===P?1:0)}i.push(new Dc(".morphTargetInfluence["+P+"]",R,T))}d=b.length*c}else{const b=".bones["+t[_].name+"]";n(Pu,b+".position",M,"pos",i),n(sa,b+".quaternion",M,"rot",i),n(Pu,b+".scale",M,"scl",i)}}return 0===i.length?null:new this(a,d,i,u)}resetDuration(){let t=0;for(let n=0,i=this.tracks.length;n!==i;++n){const a=this.tracks[n];t=Math.max(t,a.times[a.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function h_(o){if(void 0===o.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function Qb(o){switch(o.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Dc;case"vector":case"vector2":case"vector3":case"vector4":return Pu;case"color":return mv;case"quaternion":return sa;case"bool":case"boolean":return Iu;case"string":return ul}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+o)}(o.type);if(void 0===o.times){const t=[],n=[];Yp(o.keys,t,n,"value"),o.times=t,o.values=n}return void 0!==e.parse?e.parse(o):new e(o.name,o.times,o.values,o.interpolation)}const Lu={enabled:!1,files:{},add:function(o,e){!1!==this.enabled&&(this.files[o]=e)},get:function(o){if(!1!==this.enabled)return this.files[o]},remove:function(o){delete this.files[o]},clear:function(){this.files={}}};class gv{constructor(e,t,n){const i=this;let d,a=!1,c=0,u=0;const p=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(v){u++,!1===a&&void 0!==i.onStart&&i.onStart(v,c,u),a=!0},this.itemEnd=function(v){c++,void 0!==i.onProgress&&i.onProgress(v,c,u),c===u&&(a=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(v){void 0!==i.onError&&i.onError(v)},this.resolveURL=function(v){return d?d(v):v},this.setURLModifier=function(v){return d=v,this},this.addHandler=function(v,_){return p.push(v,_),this},this.removeHandler=function(v){const _=p.indexOf(v);return-1!==_&&p.splice(_,2),this},this.getHandler=function(v){for(let _=0,M=p.length;_<M;_+=2){const b=p[_],A=p[_+1];if(b.global&&(b.lastIndex=0),b.test(v))return A}return null}}}const ew=new gv;let jl=(()=>{class o{constructor(t){this.manager=void 0!==t?t:ew,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,n){const i=this;return new Promise(function(a,c){i.load(t,a,n,c)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}return o.DEFAULT_MATERIAL_NAME="__DEFAULT",o})();const $l={};class tw extends Error{constructor(e,t){super(e),this.response=t}}class hl extends jl{constructor(e){super(e)}load(e,t,n,i){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const a=Lu.get(e);if(void 0!==a)return this.manager.itemStart(e),setTimeout(()=>{t&&t(a),this.manager.itemEnd(e)},0),a;if(void 0!==$l[e])return void $l[e].push({onLoad:t,onProgress:n,onError:i});$l[e]=[],$l[e].push({onLoad:t,onProgress:n,onError:i});const c=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),u=this.mimeType,d=this.responseType;fetch(c).then(p=>{if(200===p.status||0===p.status){if(0===p.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"==typeof ReadableStream||void 0===p.body||void 0===p.body.getReader)return p;const v=$l[e],_=p.body.getReader(),M=p.headers.get("Content-Length")||p.headers.get("X-File-Size"),b=M?parseInt(M):0,A=0!==b;let P=0;const R=new ReadableStream({start(T){!function U(){_.read().then(({done:F,value:V})=>{if(F)T.close();else{P+=V.byteLength;const X=new ProgressEvent("progress",{lengthComputable:A,loaded:P,total:b});for(let Z=0,q=v.length;Z<q;Z++){const ee=v[Z];ee.onProgress&&ee.onProgress(X)}T.enqueue(V),U()}})}()}});return new Response(R)}throw new tw(`fetch for "${p.url}" responded with ${p.status}: ${p.statusText}`,p)}).then(p=>{switch(d){case"arraybuffer":return p.arrayBuffer();case"blob":return p.blob();case"document":return p.text().then(v=>(new DOMParser).parseFromString(v,u));case"json":return p.json();default:if(void 0===u)return p.text();{const _=/charset="?([^;"\s]*)"?/i.exec(u),M=_&&_[1]?_[1].toLowerCase():void 0,b=new TextDecoder(M);return p.arrayBuffer().then(A=>b.decode(A))}}}).then(p=>{Lu.add(e,p);const v=$l[e];delete $l[e];for(let _=0,M=v.length;_<M;_++){const b=v[_];b.onLoad&&b.onLoad(p)}}).catch(p=>{const v=$l[e];if(void 0===v)throw this.manager.itemError(e),p;delete $l[e];for(let _=0,M=v.length;_<M;_++){const b=v[_];b.onError&&b.onError(p)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class vv extends jl{constructor(e){super(e)}load(e,t,n,i){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const a=this,c=Lu.get(e);if(void 0!==c)return a.manager.itemStart(e),setTimeout(function(){t&&t(c),a.manager.itemEnd(e)},0),c;const u=iu("img");function d(){v(),Lu.add(e,this),t&&t(this),a.manager.itemEnd(e)}function p(_){v(),i&&i(_),a.manager.itemError(e),a.manager.itemEnd(e)}function v(){u.removeEventListener("load",d,!1),u.removeEventListener("error",p,!1)}return u.addEventListener("load",d,!1),u.addEventListener("error",p,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(u.crossOrigin=this.crossOrigin),a.manager.itemStart(e),u.src=e,u}}class _v extends jl{constructor(e){super(e)}load(e,t,n,i){const a=new Ss,c=new vv(this.manager);return c.setCrossOrigin(this.crossOrigin),c.setPath(this.path),c.load(e,function(u){a.image=u,a.needsUpdate=!0,void 0!==t&&t(a)},n,i),a}}class Zp extends xr{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new ut(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}const Ou=new Yt,f_=new Q,p_=new Q;class xv{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Be(512,512),this.map=null,this.mapPass=null,this.matrix=new Yt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new tp,this._frameExtents=new Be(1,1),this._viewportCount=1,this._viewports=[new Ci(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;f_.setFromMatrixPosition(e.matrixWorld),t.position.copy(f_),p_.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(p_),t.updateMatrixWorld(),Ou.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Ou),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(Ou)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class iw extends xv{constructor(){super(new ts(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,n=2*Qu*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,a=e.distance||t.far;(n!==t.fov||i!==t.aspect||a!==t.far)&&(t.fov=n,t.aspect=i,t.far=a,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class Mv extends Zp{constructor(e,t,n=0,i=Math.PI/3,a=0,c=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(xr.DEFAULT_UP),this.updateMatrix(),this.target=new xr,this.distance=n,this.angle=i,this.penumbra=a,this.decay=c,this.map=null,this.shadow=new iw}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const bv=new Yt,nf=new Q,wv=new Q;class zh extends xv{constructor(){super(new ts(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Be(4,2),this._viewportCount=6,this._viewports=[new Ci(2,1,1,1),new Ci(0,1,1,1),new Ci(3,1,1,1),new Ci(1,1,1,1),new Ci(3,0,1,1),new Ci(1,0,1,1)],this._cubeDirections=[new Q(1,0,0),new Q(-1,0,0),new Q(0,0,1),new Q(0,0,-1),new Q(0,1,0),new Q(0,-1,0)],this._cubeUps=[new Q(0,1,0),new Q(0,1,0),new Q(0,1,0),new Q(0,1,0),new Q(0,0,1),new Q(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,i=this.matrix,a=e.distance||n.far;a!==n.far&&(n.far=a,n.updateProjectionMatrix()),nf.setFromMatrixPosition(e.matrixWorld),n.position.copy(nf),wv.copy(n.position),wv.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(wv),n.updateMatrixWorld(),i.makeTranslation(-nf.x,-nf.y,-nf.z),bv.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(bv)}}class Kp extends Zp{constructor(e,t,n=0,i=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=i,this.shadow=new zh}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class m_ extends xv{constructor(){super(new yh(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class rf extends Zp{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(xr.DEFAULT_UP),this.updateMatrix(),this.target=new xr,this.shadow=new m_}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class Jp extends Zp{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class Hh{static decodeText(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);let t="";for(let n=0,i=e.length;n<i;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch(n){return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class aw extends jl{constructor(e){super(e),this.isImageBitmapLoader=!0,"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,i){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const a=this,c=Lu.get(e);if(void 0!==c)return a.manager.itemStart(e),setTimeout(function(){t&&t(c),a.manager.itemEnd(e)},0),c;const u={};u.credentials="anonymous"===this.crossOrigin?"same-origin":"include",u.headers=this.requestHeader,fetch(e,u).then(function(d){return d.blob()}).then(function(d){return createImageBitmap(d,Object.assign(a.options,{colorSpaceConversion:"none"}))}).then(function(d){Lu.add(e,d),t&&t(d),a.manager.itemEnd(e)}).catch(function(d){i&&i(d),a.manager.itemError(e),a.manager.itemEnd(e)}),a.manager.itemStart(e)}}class em{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Ev(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=Ev();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function Ev(){return("undefined"==typeof performance?Date:performance).now()}const Av="\\[\\]\\.:\\/",A_=new RegExp("["+Av+"]","g"),Tv="[^"+Av+"]",T_="[^"+Av.replace("\\.","")+"]",nm=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",Tv)+/(WCOD+)?/.source.replace("WCOD",T_)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Tv)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Tv)+"$"),uw=["material","materials","bones","map"];class Gh{constructor(e,t,n){const i=n||Mi.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();const i=this._bindings[this._targetGroup.nCachedObjects_];void 0!==i&&i.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let i=this._targetGroup.nCachedObjects_,a=n.length;i!==a;++i)n[i].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}let Mi=(()=>{class o{constructor(t,n,i){this.path=n,this.parsedPath=i||o.parseTrackName(n),this.node=o.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,n,i){return t&&t.isAnimationObjectGroup?new o.Composite(t,n,i):new o(t,n,i)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(A_,"")}static parseTrackName(t){const n=nm.exec(t);if(null===n)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const i={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},a=i.nodeName&&i.nodeName.lastIndexOf(".");if(void 0!==a&&-1!==a){const c=i.nodeName.substring(a+1);-1!==uw.indexOf(c)&&(i.nodeName=i.nodeName.substring(0,a),i.objectName=c)}if(null===i.propertyName||0===i.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return i}static findNode(t,n){if(void 0===n||""===n||"."===n||-1===n||n===t.name||n===t.uuid)return t;if(t.skeleton){const i=t.skeleton.getBoneByName(n);if(void 0!==i)return i}if(t.children){const i=function(c){for(let u=0;u<c.length;u++){const d=c[u];if(d.name===n||d.uuid===n)return d;const p=i(d.children);if(p)return p}return null},a=i(t.children);if(a)return a}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,n){t[n]=this.targetObject[this.propertyName]}_getValue_array(t,n){const i=this.resolvedProperty;for(let a=0,c=i.length;a!==c;++a)t[n++]=i[a]}_getValue_arrayElement(t,n){t[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,n){this.resolvedProperty.toArray(t,n)}_setValue_direct(t,n){this.targetObject[this.propertyName]=t[n]}_setValue_direct_setNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,n){const i=this.resolvedProperty;for(let a=0,c=i.length;a!==c;++a)i[a]=t[n++]}_setValue_array_setNeedsUpdate(t,n){const i=this.resolvedProperty;for(let a=0,c=i.length;a!==c;++a)i[a]=t[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,n){const i=this.resolvedProperty;for(let a=0,c=i.length;a!==c;++a)i[a]=t[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,n){this.resolvedProperty[this.propertyIndex]=t[n]}_setValue_arrayElement_setNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,n){this.resolvedProperty.fromArray(t,n)}_setValue_fromArray_setNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,n){this.bind(),this.getValue(t,n)}_setValue_unbound(t,n){this.bind(),this.setValue(t,n)}bind(){let t=this.node;const n=this.parsedPath,i=n.objectName,a=n.propertyName;let c=n.propertyIndex;if(t||(t=o.findNode(this.rootNode,n.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(i){let v=n.objectIndex;switch(i){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let _=0;_<t.length;_++)if(t[_].name===v){v=_;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[i])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[i]}if(void 0!==v){if(void 0===t[v])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[v]}}const u=t[a];if(void 0===u)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n.nodeName+"."+a+" but it wasn't found.",t);let d=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?d=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(d=this.Versioning.MatrixWorldNeedsUpdate);let p=this.BindingType.Direct;if(void 0!==c){if("morphTargetInfluences"===a){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[c]&&(c=t.morphTargetDictionary[c])}p=this.BindingType.ArrayElement,this.resolvedProperty=u,this.propertyIndex=c}else void 0!==u.fromArray&&void 0!==u.toArray?(p=this.BindingType.HasFromToArray,this.resolvedProperty=u):Array.isArray(u)?(p=this.BindingType.EntireArray,this.resolvedProperty=u):this.propertyName=a;this.getValue=this.GetterByBindingType[p],this.setValue=this.SetterByBindingTypeAndVersioning[p][d]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return o.Composite=Gh,o})();Mi.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Mi.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Mi.prototype.GetterByBindingType=[Mi.prototype._getValue_direct,Mi.prototype._getValue_array,Mi.prototype._getValue_arrayElement,Mi.prototype._getValue_toArray],Mi.prototype.SetterByBindingTypeAndVersioning=[[Mi.prototype._setValue_direct,Mi.prototype._setValue_direct_setNeedsUpdate,Mi.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Mi.prototype._setValue_array,Mi.prototype._setValue_array_setNeedsUpdate,Mi.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Mi.prototype._setValue_arrayElement,Mi.prototype._setValue_arrayElement_setNeedsUpdate,Mi.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Mi.prototype._setValue_fromArray,Mi.prototype._setValue_fromArray_setNeedsUpdate,Mi.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1);class P_{constructor(e=1,t=0,n=0){return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Ki(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}const F_=new Q,rm=new Q,N_=new Q;class k_ extends xr{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",void 0===t&&(t=1);let i=new Un;i.setAttribute("position",new qt([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const a=new Vs({fog:!1,toneMapped:!1});this.lightPlane=new zl(i,a),this.add(this.lightPlane),i=new Un,i.setAttribute("position",new qt([0,0,0,0,0,1],3)),this.targetLine=new zl(i,a),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),F_.setFromMatrixPosition(this.light.matrixWorld),rm.setFromMatrixPosition(this.light.target.matrixWorld),N_.subVectors(rm,F_),this.lightPlane.lookAt(rm),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(rm),this.targetLine.scale.z=N_.length()}}class Iv extends $d{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=new Un;i.setAttribute("position",new qt(t,3)),i.setAttribute("color",new qt([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(i,new Vs({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,n){const i=new ut,a=this.geometry.attributes.color.array;return i.set(e),i.toArray(a,0),i.toArray(a,3),i.set(t),i.toArray(a,6),i.toArray(a,9),i.set(n),i.toArray(a,12),i.toArray(a,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"155"}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="155");let bw=(()=>{class o{constructor(t){this.markdownService=t,this.title="star",this.domWidth=window.innerWidth-20,this.domHeight=window.innerHeight-20,this.vertexShader="\n        //vertexShader\n        varying vec2 vUv;\n        uniform float uTime;\n        void main() {\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n          vUv = uv;\n        }",this.fragmentShader="\n        //fragmentShader\n        #define PI 3.1415926535897932384626433832795\n        varying vec2 vUv;\n        vec2 rotate(vec2 uv, float rotation, vec2 mid) {\n          return vec2(\n            cos(rotation) * (uv.x - mid.x) + sin(rotation) * (uv.y - mid.y) + mid.x,\n            cos(rotation) * (uv.y - mid.y) - sin(rotation) * (uv.x - mid.x) + mid.y\n          );\n        }\n        uniform float uTime;\n        void main() {\n            vec2 rotatedUv = rotate(vUv, PI*0.25, vec2(0.5));\n            float animation = mix(0.001, 0.01, (sin(uTime) + 1.0) * 0.5);\n            float strength = animation / distance(vec2(rotatedUv.x,(rotatedUv.y - 0.5)*5.0 + 0.5), vec2(0.5));\n            strength *= animation / distance(vec2(rotatedUv.y,(rotatedUv.x - 0.5)*5.0 + 0.5), vec2(0.5));\n            vec3 adjustedColor = vec3(0.5, 0.7, 0.9);\n            gl_FragColor = vec4(vec3(adjustedColor * strength ), 1.0);\n        }",this.myValue="print('hello-world')"}ngOnInit(){this.init(),console.log(this.markdownService.compile("I am using __markdown__."))}init(){var t;const n=new ts(70,this.domWidth/this.domHeight,.01,10);n.position.z=1;const i=new Od,a=new Ul(6,6,1),c=new es({uniforms:{uOpacity:{value:50},uTime:{value:.1}},vertexShader:this.vertexShader,fragmentShader:this.fragmentShader,side:2}),u=new Ji(a,c);i.add(u);const d=new Gg({antialias:!0});d.setClearColor(new ut(16777215)),d.setSize(this.domWidth,this.domHeight),d.setAnimationLoop(function v(_){c.uniforms.uTime.value+=.02,d.render(i,n)}),null===(t=document.getElementById("star-container"))||void 0===t||t.appendChild(d.domElement)}onLoad(){}}return o.\u0275fac=function(t){return new(t||o)(I.Y36(ss))},o.\u0275cmp=I.Xpm({type:o,selectors:[["app-star"]],decls:8,vars:8,consts:[[1,"flex-box"],["id","star-container"],[1,"terminal"],[2,"overflow","auto"],[3,"data"]],template:function(t,n){1&t&&(I.TgZ(0,"div",0),I._UZ(1,"div",1),I.qZA(),I.TgZ(2,"div",2)(3,"div",3),I._UZ(4,"markdown",4),I.ALo(5,"language"),I._UZ(6,"markdown",4),I.ALo(7,"language"),I.qZA()()),2&t&&(I.xp6(4),I.Q6J("data",I.xi3(5,2,n.vertexShader,"c")),I.xp6(2),I.Q6J("data",I.xi3(7,5,n.fragmentShader,"c")))},directives:[to],pipes:[Vi],styles:[""]}),o})();const Pv={type:"change"},Lv={type:"start"},U_={type:"end"},cm=new rh,jh=new bc,ww=Math.cos(70*Co_DEG2RAD);class Ov extends Rl{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new Q,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:0,MIDDLE:1,RIGHT:2},this.touches={ONE:0,TWO:2},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return u.phi},this.getAzimuthalAngle=function(){return u.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(he){he.addEventListener("keydown",J),this._domElementKeyEvents=he},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",J),this._domElementKeyEvents=null},this.saveState=function(){n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=function(){n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(Pv),n.update(),a=i.NONE},this.update=function(){const he=new Q,nt=(new _r).setFromUnitVectors(e.up,new Q(0,1,0)),Xt=nt.clone().invert(),Bt=new Q,jt=new _r,Wn=new Q,Ei=2*Math.PI;return function(){const Ht=n.object.position;he.copy(Ht).sub(n.target),he.applyQuaternion(nt),u.setFromVector3(he),n.autoRotate&&a===i.NONE&&Me(function j(){return 2*Math.PI/60/60*n.autoRotateSpeed}()),n.enableDamping?(u.theta+=d.theta*n.dampingFactor,u.phi+=d.phi*n.dampingFactor):(u.theta+=d.theta,u.phi+=d.phi);let Le=n.minAzimuthAngle,xt=n.maxAzimuthAngle;isFinite(Le)&&isFinite(xt)&&(Le<-Math.PI?Le+=Ei:Le>Math.PI&&(Le-=Ei),xt<-Math.PI?xt+=Ei:xt>Math.PI&&(xt-=Ei),u.theta=Le<=xt?Math.max(Le,Math.min(xt,u.theta)):u.theta>(Le+xt)/2?Math.max(Le,u.theta):Math.min(xt,u.theta)),u.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,u.phi)),u.makeSafe(),!0===n.enableDamping?n.target.addScaledVector(v,n.dampingFactor):n.target.add(v),u.radius=$e(n.zoomToCursor&&Z||n.object.isOrthographicCamera?u.radius:u.radius*p),he.setFromSpherical(u),he.applyQuaternion(Xt),Ht.copy(n.target).add(he),n.object.lookAt(n.target),!0===n.enableDamping?(d.theta*=1-n.dampingFactor,d.phi*=1-n.dampingFactor,v.multiplyScalar(1-n.dampingFactor)):(d.set(0,0,0),v.set(0,0,0));let Gt=!1;if(n.zoomToCursor&&Z){let ui=null;if(n.object.isPerspectiveCamera){const Gi=he.length();ui=$e(Gi*p),n.object.position.addScaledVector(V,Gi-ui),n.object.updateMatrixWorld()}else if(n.object.isOrthographicCamera){const Gi=new Q(X.x,X.y,0);Gi.unproject(n.object),n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/p)),n.object.updateProjectionMatrix(),Gt=!0;const mr=new Q(X.x,X.y,0);mr.unproject(n.object),n.object.position.sub(mr).add(Gi),n.object.updateMatrixWorld(),ui=he.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),n.zoomToCursor=!1;null!==ui&&(this.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(ui).add(n.object.position):(cm.origin.copy(n.object.position),cm.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(cm.direction))<ww?e.lookAt(n.target):(jh.setFromNormalAndCoplanarPoint(n.object.up,n.target),cm.intersectPlane(jh,n.target))))}else n.object.isOrthographicCamera&&(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/p)),n.object.updateProjectionMatrix(),Gt=!0);return p=1,Z=!1,!!(Gt||Bt.distanceToSquared(n.object.position)>c||8*(1-jt.dot(n.object.quaternion))>c||Wn.distanceToSquared(n.target)>0)&&(n.dispatchEvent(Pv),Bt.copy(n.object.position),jt.copy(n.object.quaternion),Wn.copy(n.target),Gt=!1,!0)}}(),this.dispose=function(){n.domElement.removeEventListener("contextmenu",ct),n.domElement.removeEventListener("pointerdown",Qt),n.domElement.removeEventListener("pointercancel",On),n.domElement.removeEventListener("wheel",oe),n.domElement.removeEventListener("pointermove",on),n.domElement.removeEventListener("pointerup",On),null!==n._domElementKeyEvents&&(n._domElementKeyEvents.removeEventListener("keydown",J),n._domElementKeyEvents=null)};const n=this,i={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let a=i.NONE;const c=1e-6,u=new P_,d=new P_;let p=1;const v=new Q,_=new Be,M=new Be,b=new Be,A=new Be,P=new Be,R=new Be,T=new Be,U=new Be,F=new Be,V=new Q,X=new Be;let Z=!1;const q=[],ee={};function K(){return Math.pow(.95,n.zoomSpeed)}function Me(he){d.theta-=he}function De(he){d.phi-=he}const me=function(){const he=new Q;return function(Xt,Bt){he.setFromMatrixColumn(Bt,0),he.multiplyScalar(-Xt),v.add(he)}}(),pe=function(){const he=new Q;return function(Xt,Bt){!0===n.screenSpacePanning?he.setFromMatrixColumn(Bt,1):(he.setFromMatrixColumn(Bt,0),he.crossVectors(n.object.up,he)),he.multiplyScalar(Xt),v.add(he)}}(),xe=function(){const he=new Q;return function(Xt,Bt){const jt=n.domElement;if(n.object.isPerspectiveCamera){he.copy(n.object.position).sub(n.target);let Ei=he.length();Ei*=Math.tan(n.object.fov/2*Math.PI/180),me(2*Xt*Ei/jt.clientHeight,n.object.matrix),pe(2*Bt*Ei/jt.clientHeight,n.object.matrix)}else n.object.isOrthographicCamera?(me(Xt*(n.object.right-n.object.left)/n.object.zoom/jt.clientWidth,n.object.matrix),pe(Bt*(n.object.top-n.object.bottom)/n.object.zoom/jt.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}}();function Ne(he){n.object.isPerspectiveCamera||n.object.isOrthographicCamera?p/=he:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function Pe(he){n.object.isPerspectiveCamera||n.object.isOrthographicCamera?p*=he:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function ze(he){if(!n.zoomToCursor)return;Z=!0;const nt=n.domElement.getBoundingClientRect(),Bt=he.clientY-nt.top,Wn=nt.height;X.x=(he.clientX-nt.left)/nt.width*2-1,X.y=-Bt/Wn*2+1,V.set(X.x,X.y,1).unproject(e).sub(e.position).normalize()}function $e(he){return Math.max(n.minDistance,Math.min(n.maxDistance,he))}function Ke(he){_.set(he.clientX,he.clientY)}function He(he){A.set(he.clientX,he.clientY)}function nn(){1===q.length?_.set(q[0].pageX,q[0].pageY):_.set(.5*(q[0].pageX+q[1].pageX),.5*(q[0].pageY+q[1].pageY))}function li(){1===q.length?A.set(q[0].pageX,q[0].pageY):A.set(.5*(q[0].pageX+q[1].pageX),.5*(q[0].pageY+q[1].pageY))}function ci(){const he=q[0].pageX-q[1].pageX,nt=q[0].pageY-q[1].pageY,Xt=Math.sqrt(he*he+nt*nt);T.set(0,Xt)}function Lt(he){if(1==q.length)M.set(he.pageX,he.pageY);else{const Xt=Fe(he);M.set(.5*(he.pageX+Xt.x),.5*(he.pageY+Xt.y))}b.subVectors(M,_).multiplyScalar(n.rotateSpeed);const nt=n.domElement;Me(2*Math.PI*b.x/nt.clientHeight),De(2*Math.PI*b.y/nt.clientHeight),_.copy(M)}function Ye(he){if(1===q.length)P.set(he.pageX,he.pageY);else{const nt=Fe(he);P.set(.5*(he.pageX+nt.x),.5*(he.pageY+nt.y))}R.subVectors(P,A).multiplyScalar(n.panSpeed),xe(R.x,R.y),A.copy(P)}function St(he){const nt=Fe(he),Xt=he.pageX-nt.x,Bt=he.pageY-nt.y,jt=Math.sqrt(Xt*Xt+Bt*Bt);U.set(0,jt),F.set(0,Math.pow(U.y/T.y,n.zoomSpeed)),Ne(F.y),T.copy(U)}function Qt(he){!1!==n.enabled&&(0===q.length&&(n.domElement.setPointerCapture(he.pointerId),n.domElement.addEventListener("pointermove",on),n.domElement.addEventListener("pointerup",On)),function At(he){q.push(he)}(he),"touch"===he.pointerType?function Re(he){switch(Ct(he),q.length){case 1:switch(n.touches.ONE){case 0:if(!1===n.enableRotate)return;nn(),a=i.TOUCH_ROTATE;break;case 1:if(!1===n.enablePan)return;li(),a=i.TOUCH_PAN;break;default:a=i.NONE}break;case 2:switch(n.touches.TWO){case 2:if(!1===n.enableZoom&&!1===n.enablePan)return;(function xn(){n.enableZoom&&ci(),n.enablePan&&li()})(),a=i.TOUCH_DOLLY_PAN;break;case 3:if(!1===n.enableZoom&&!1===n.enableRotate)return;(function ce(){n.enableZoom&&ci(),n.enableRotate&&nn()})(),a=i.TOUCH_DOLLY_ROTATE;break;default:a=i.NONE}break;default:a=i.NONE}a!==i.NONE&&n.dispatchEvent(Lv)}(he):function gi(he){let nt;switch(he.button){case 0:nt=n.mouseButtons.LEFT;break;case 1:nt=n.mouseButtons.MIDDLE;break;case 2:nt=n.mouseButtons.RIGHT;break;default:nt=-1}switch(nt){case 1:if(!1===n.enableZoom)return;(function _e(he){ze(he),T.set(he.clientX,he.clientY)})(he),a=i.DOLLY;break;case 0:if(he.ctrlKey||he.metaKey||he.shiftKey){if(!1===n.enablePan)return;He(he),a=i.PAN}else{if(!1===n.enableRotate)return;Ke(he),a=i.ROTATE}break;case 2:if(he.ctrlKey||he.metaKey||he.shiftKey){if(!1===n.enableRotate)return;Ke(he),a=i.ROTATE}else{if(!1===n.enablePan)return;He(he),a=i.PAN}break;default:a=i.NONE}a!==i.NONE&&n.dispatchEvent(Lv)}(he))}function on(he){!1!==n.enabled&&("touch"===he.pointerType?function wt(he){switch(Ct(he),a){case i.TOUCH_ROTATE:if(!1===n.enableRotate)return;Lt(he),n.update();break;case i.TOUCH_PAN:if(!1===n.enablePan)return;Ye(he),n.update();break;case i.TOUCH_DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;(function it(he){n.enableZoom&&St(he),n.enablePan&&Ye(he)})(he),n.update();break;case i.TOUCH_DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;(function bn(he){n.enableZoom&&St(he),n.enableRotate&&Lt(he)})(he),n.update();break;default:a=i.NONE}}(he):function Er(he){switch(a){case i.ROTATE:if(!1===n.enableRotate)return;!function ft(he){M.set(he.clientX,he.clientY),b.subVectors(M,_).multiplyScalar(n.rotateSpeed);const nt=n.domElement;Me(2*Math.PI*b.x/nt.clientHeight),De(2*Math.PI*b.y/nt.clientHeight),_.copy(M),n.update()}(he);break;case i.DOLLY:if(!1===n.enableZoom)return;!function ht(he){U.set(he.clientX,he.clientY),F.subVectors(U,T),F.y>0?Ne(K()):F.y<0&&Pe(K()),T.copy(U),n.update()}(he);break;case i.PAN:if(!1===n.enablePan)return;!function pt(he){P.set(he.clientX,he.clientY),R.subVectors(P,A).multiplyScalar(n.panSpeed),xe(R.x,R.y),A.copy(P),n.update()}(he)}}(he))}function On(he){(function yn(he){delete ee[he.pointerId];for(let nt=0;nt<q.length;nt++)if(q[nt].pointerId==he.pointerId)return void q.splice(nt,1)})(he),0===q.length&&(n.domElement.releasePointerCapture(he.pointerId),n.domElement.removeEventListener("pointermove",on),n.domElement.removeEventListener("pointerup",On)),n.dispatchEvent(U_),a=i.NONE}function oe(he){!1===n.enabled||!1===n.enableZoom||a!==i.NONE||(he.preventDefault(),n.dispatchEvent(Lv),function Zt(he){ze(he),he.deltaY<0?Pe(K()):he.deltaY>0&&Ne(K()),n.update()}(he),n.dispatchEvent(U_))}function J(he){!1===n.enabled||!1===n.enablePan||function sn(he){let nt=!1;switch(he.code){case n.keys.UP:he.ctrlKey||he.metaKey||he.shiftKey?De(2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):xe(0,n.keyPanSpeed),nt=!0;break;case n.keys.BOTTOM:he.ctrlKey||he.metaKey||he.shiftKey?De(-2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):xe(0,-n.keyPanSpeed),nt=!0;break;case n.keys.LEFT:he.ctrlKey||he.metaKey||he.shiftKey?Me(2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):xe(n.keyPanSpeed,0),nt=!0;break;case n.keys.RIGHT:he.ctrlKey||he.metaKey||he.shiftKey?Me(-2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):xe(-n.keyPanSpeed,0),nt=!0}nt&&(he.preventDefault(),n.update())}(he)}function ct(he){!1!==n.enabled&&he.preventDefault()}function Ct(he){let nt=ee[he.pointerId];void 0===nt&&(nt=new Be,ee[he.pointerId]=nt),nt.set(he.pageX,he.pageY)}function Fe(he){return ee[(he.pointerId===q[0].pointerId?q[1]:q[0]).pointerId]}n.domElement.addEventListener("contextmenu",ct),n.domElement.addEventListener("pointerdown",Qt),n.domElement.addEventListener("pointercancel",On),n.domElement.addEventListener("wheel",oe,{passive:!1}),this.update()}}let co=(()=>{class o{constructor(){this.domWidth=window.innerWidth,this.domHeight=window.innerHeight}init(){return this.scene=new Od,this.renderer=new Gg({antialias:!0,logarithmicDepthBuffer:!0}),this.camera=new ts,this.clock=new em,this.orbit_controls=new Ov(this.camera,this.renderer.domElement),this._initScene(),this._initCamera(),this._initRenderer(),this._initResponsiveResize(),this.renderer.setAnimationLoop(()=>{this.renderer.render(this.scene,this.camera)}),{scene:this.scene,camera:this.camera,renderer:this.renderer,orbit_controls:this.orbit_controls,clock:this.clock}}_initScene(){this.scene.background=new ut(0)}_initCamera(){this.camera.fov=55,this.camera.aspect=this.domWidth/this.domHeight,this.camera.near=.1,this.camera.far=1e3,this.camera.position.set(3,3,3),this.camera.updateProjectionMatrix()}_initRenderer(){this.renderer.shadowMap.enabled=!0,this.renderer.outputColorSpace=vn,this.renderer.toneMapping=4,this.renderer.setSize(this.domWidth,this.domHeight)}_initResponsiveResize(){window.addEventListener("resize",()=>{this.camera.aspect=this.domWidth/this.domHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.domWidth,this.domHeight),this.renderer.setPixelRatio(window.devicePixelRatio)})}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275prov=I.Yz7({token:o,factory:o.\u0275fac}),o})(),Ew=(()=>{class o{constructor(t){this.threeService=t,this.vertexShader="\n                          //vertexShader\n                          precision lowp float;\n                          varying vec2 vUv;\n                          varying vec3 vPosition;\n                          uniform float uTime;\n                          varying vec3 vNormal;\n                          void main() {\n                            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n                            vUv = uv;\n                            vPosition = position;\n                            vNormal = normalize(normalMatrix * normal);\n                        }",this.fragmentShader="\n                        //fragmentShader\n                        precision lowp float;\n                        uniform vec3 scanColor;\n                        varying vec2 vUv;\n                        uniform float uTime;\n                        uniform vec3 uSize;\n                        varying vec3 vPosition;\n                        varying vec3 vNormal;\n                        void main() {\n                          \n                          float y = (vPosition.y / uSize.y) + 0.5;\n                          float color = sin(-vUv.y + uTime * 0.3);\n                          color = mod(color, 1.0);\n                          color = step(0.02, color);\n                          if(y < 0.01 || y > 0.99) \n                          color = 1.0;\n                          float alpha = 1.0 - sin(vUv.y) * 0.7;\n\n                          vec3 lightDirection = normalize(vec3(0.9, 1.0, 0.8)); // \u5149\u6e90\u65b9\u5411\n                          float lightIntensity = max(dot(vNormal, lightDirection), 0.0); // \u5149\u7167\u5f3a\u5ea6\n                          vec3 lightColor = vec3(1.0, 1.0, 1.0); // \u5149\u6e90\u989c\u8272\n\n                          vec3 finalColor = vec3(color, 1.0, color) * lightColor * lightIntensity;\n                          gl_FragColor = vec4(finalColor, alpha);\n                          \n                        }\n                      "}ngOnInit(){const{scene:t,camera:n,renderer:i,orbit_controls:a,clock:c}=this.threeService.init();this.scene=t,this.camera=n,this.renderer=i,this.orbit_controls=a,this.clock=c,this.updaetScene(),this.renderer.render(this.scene,this.camera),this.orbit_controls.update()}updaetScene(){var t;const n=new Iv(30);this.scene.add(n);const i=new Ul(5,5),a=new Qi({color:16777215,side:2}),c=new Ji(i,a);c.rotation.x=-.5*Math.PI,c.position.set(0,0,0),c.receiveShadow=!0;for(let p=0;p<18;p++){const _=Number(1*Math.random()).toFixed(2),M=new ph(1*Math.random(),Number(_),1*Math.random());M.computeBoundingBox();const{max:b,min:A}=M.boundingBox,P=new Q(b.x-A.x,b.y-A.y,b.z-A.z),R=new es({uniforms:{uOpacity:{value:50},uTime:{value:.1},uSize:{value:P},scanColor:{value:new ut(65280)}},vertexShader:this.vertexShader,fragmentShader:this.fragmentShader}),T=new Ji(M,R);T.position.set(2*Math.random(),Number(_)/2,2*Math.random()),T.castShadow=!0,T.name="box",this.scene.add(T)}const u=new rf(16777215),d=new k_(u,.2);u.position.set(-3,2,-1),u.target=c,u.castShadow=!0,this.renderer.shadowMap.enabled=!0,this.scene.add(c,u,d),null===(t=document.getElementById("cube-container"))||void 0===t||t.appendChild(this.renderer.domElement),this.renderer.setAnimationLoop(this.animation.bind(this))}animation(){this.scene.traverse(function(t){"box"===t.name&&(t.material.uniforms.uTime.value+=.02)}),this.renderer.render(this.scene,this.camera)}}return o.\u0275fac=function(t){return new(t||o)(I.Y36(co))},o.\u0275cmp=I.Xpm({type:o,selectors:[["app-cube"]],decls:8,vars:8,consts:[[1,"flex-box"],["id","cube-container"],[1,"terminal"],[2,"overflow","auto"],[3,"data"]],template:function(t,n){1&t&&(I.TgZ(0,"div",0),I._UZ(1,"div",1),I.qZA(),I.TgZ(2,"div",2)(3,"div",3),I._UZ(4,"markdown",4),I.ALo(5,"language"),I._UZ(6,"markdown",4),I.ALo(7,"language"),I.qZA()()),2&t&&(I.xp6(4),I.Q6J("data",I.xi3(5,2,n.vertexShader,"c")),I.xp6(2),I.Q6J("data",I.xi3(7,5,n.fragmentShader,"c")))},directives:[to],pipes:[Vi],styles:[""]}),o})();var Bu=function(o){return URL.createObjectURL(new Blob([o],{type:"text/javascript"}))};try{URL.revokeObjectURL(Bu(""))}catch(o){Bu=function(e){return"data:application/javascript;charset=UTF-8,"+encodeURI(e)}}var Bi=Uint8Array,Lr=Uint16Array,Fa=Uint32Array,$h=new Bi([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Xh=new Bi([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),qh=new Bi([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Fv=function(o,e){for(var t=new Lr(31),n=0;n<31;++n)t[n]=e+=1<<o[n-1];var i=new Fa(t[30]);for(n=1;n<30;++n)for(var a=t[n];a<t[n+1];++a)i[a]=a-t[n]<<5|n;return[t,i]},hm=Fv($h,2),dm=hm[0],fm=hm[1];dm[28]=258,fm[258]=28;for(var Aw=Fv(Xh,0)[0],Vu=new Lr(32768),Yi=0;Yi<32768;++Yi){var dl=(43690&Yi)>>>1|(21845&Yi)<<1;Vu[Yi]=((65280&(dl=(61680&(dl=(52428&dl)>>>2|(13107&dl)<<2))>>>4|(3855&dl)<<4))>>>8|(255&dl)<<8)>>>1}var oa=function(o,e,t){for(var n=o.length,i=0,a=new Lr(e);i<n;++i)++a[o[i]-1];var u,c=new Lr(e);for(i=0;i<e;++i)c[i]=c[i-1]+a[i-1]<<1;if(t){u=new Lr(1<<e);var d=15-e;for(i=0;i<n;++i)if(o[i])for(var p=i<<4|o[i],v=e-o[i],_=c[o[i]-1]++<<v,M=_|(1<<v)-1;_<=M;++_)u[Vu[_]>>>d]=p}else for(u=new Lr(n),i=0;i<n;++i)o[i]&&(u[i]=Vu[c[o[i]-1]++]>>>15-o[i]);return u},Ic=new Bi(288);for(Yi=0;Yi<144;++Yi)Ic[Yi]=8;for(Yi=144;Yi<256;++Yi)Ic[Yi]=9;for(Yi=256;Yi<280;++Yi)Ic[Yi]=7;for(Yi=280;Yi<288;++Yi)Ic[Yi]=8;var hf=new Bi(32);for(Yi=0;Yi<32;++Yi)hf[Yi]=5;var H_=oa(Ic,9,1),pm=oa(hf,5,1),df=function(o){for(var e=o[0],t=1;t<o.length;++t)o[t]>e&&(e=o[t]);return e},aa=function(o,e,t){var n=e/8|0;return(o[n]|o[n+1]<<8)>>(7&e)&t},ff=function(o,e){var t=e/8|0;return(o[t]|o[t+1]<<8|o[t+2]<<16)>>(7&e)},Yh=function(o){return(o/8|0)+(7&o&&1)},pf=function(o,e,t){var n=o.length;if(!n||t&&!t.l&&n<5)return e||new Bi(0);var i=!e||t,a=!t||t.i;t||(t={}),e||(e=new Bi(3*n));var c=function(Zt){var sn=e.length;if(Zt>sn){var nn=new Bi(Math.max(2*sn,Zt));nn.set(e),e=nn}},u=t.f||0,d=t.p||0,p=t.b||0,v=t.l,_=t.d,M=t.m,b=t.n,A=8*n;do{if(!v){t.f=u=aa(o,d,1);var P=aa(o,d+1,3);if(d+=3,!P){var T=o[(R=Yh(d)+4)-4]|o[R-3]<<8,U=R+T;if(U>n){if(a)throw"unexpected EOF";break}i&&c(p+T),e.set(o.subarray(R,U),p),t.b=p+=T,t.p=d=8*U;continue}if(1==P)v=H_,_=pm,M=9,b=5;else{if(2!=P)throw"invalid block type";var F=aa(o,d,31)+257,V=aa(o,d+10,15)+4,X=F+aa(o,d+5,31)+1;d+=14;for(var Z=new Bi(X),q=new Bi(19),ee=0;ee<V;++ee)q[qh[ee]]=aa(o,d+3*ee,7);d+=3*V;var j=df(q),K=(1<<j)-1,Me=oa(q,j,1);for(ee=0;ee<X;){var R,De=Me[aa(o,d,K)];if(d+=15&De,(R=De>>>4)<16)Z[ee++]=R;else{var me=0,pe=0;for(16==R?(pe=3+aa(o,d,3),d+=2,me=Z[ee-1]):17==R?(pe=3+aa(o,d,7),d+=3):18==R&&(pe=11+aa(o,d,127),d+=7);pe--;)Z[ee++]=me}}var xe=Z.subarray(0,F),Ne=Z.subarray(F);M=df(xe),b=df(Ne),v=oa(xe,M,1),_=oa(Ne,b,1)}if(d>A){if(a)throw"unexpected EOF";break}}i&&c(p+131072);for(var Pe=(1<<M)-1,ze=(1<<b)-1,$e=d;;$e=d){var Ke=(me=v[ff(o,d)&Pe])>>>4;if((d+=15&me)>A){if(a)throw"unexpected EOF";break}if(!me)throw"invalid length/literal";if(Ke<256)e[p++]=Ke;else{if(256==Ke){$e=d,v=null;break}var _e=Ke-254;Ke>264&&(_e=aa(o,d,(1<<(He=$h[ee=Ke-257]))-1)+dm[ee],d+=He);var ft=_[ff(o,d)&ze],ht=ft>>>4;if(!ft)throw"invalid distance";if(d+=15&ft,Ne=Aw[ht],ht>3){var He=Xh[ht];Ne+=ff(o,d)&(1<<He)-1,d+=He}if(d>A){if(a)throw"unexpected EOF";break}i&&c(p+131072);for(var pt=p+_e;p<pt;p+=4)e[p]=e[p-Ne],e[p+1]=e[p+1-Ne],e[p+2]=e[p+2-Ne],e[p+3]=e[p+3-Ne];p=pt}}t.l=v,t.p=$e,t.b=p,v&&(u=1,t.m=M,t.d=_,t.n=b)}while(!u);return p==e.length?e:function(o,e,t){(null==e||e<0)&&(e=0),(null==t||t>o.length)&&(t=o.length);var n=new(o instanceof Lr?Lr:o instanceof Fa?Fa:Bi)(t-e);return n.set(o.subarray(e,t)),n}(e,0,p)},Lc=new Bi(0);var Mf="undefined"!=typeof TextDecoder&&new TextDecoder;try{Mf.decode(Lc,{stream:!0})}catch(o){}function fl(o,e,t){const n=t.length-o-1;if(e>=t[n])return n-1;if(e<=t[o])return o;let i=o,a=n,c=Math.floor((i+a)/2);for(;e<t[c]||e>=t[c+1];)e<t[c]?a=c:i=c,c=Math.floor((i+a)/2);return c}function jw(o,e){let t=1;for(let i=2;i<=o;++i)t*=i;let n=1;for(let i=2;i<=e;++i)n*=i;for(let i=2;i<=o-e;++i)n*=i;return t/n}class Yw extends class La{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,i=this.getPoint(0),a=0;t.push(0);for(let c=1;c<=e;c++)n=this.getPoint(c/e),a+=n.distanceTo(i),t.push(a),i=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const n=this.getLengths();let i=0;const a=n.length;let c;c=t||e*n[a-1];let p,u=0,d=a-1;for(;u<=d;)if(i=Math.floor(u+(d-u)/2),p=n[i]-c,p<0)u=i+1;else{if(!(p>0)){d=i;break}d=i-1}if(i=d,n[i]===c)return i/(a-1);const v=n[i];return(i+(c-v)/(n[i+1]-v))/(a-1)}getTangent(e,t){let i=e-1e-4,a=e+1e-4;i<0&&(i=0),a>1&&(a=1);const c=this.getPoint(i),u=this.getPoint(a),d=t||(c.isVector2?new Be:new Q);return d.copy(u).sub(c).normalize(),d}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){const n=new Q,i=[],a=[],c=[],u=new Q,d=new Yt;for(let b=0;b<=e;b++)i[b]=this.getTangentAt(b/e,new Q);a[0]=new Q,c[0]=new Q;let p=Number.MAX_VALUE;const v=Math.abs(i[0].x),_=Math.abs(i[0].y),M=Math.abs(i[0].z);v<=p&&(p=v,n.set(1,0,0)),_<=p&&(p=_,n.set(0,1,0)),M<=p&&n.set(0,0,1),u.crossVectors(i[0],n).normalize(),a[0].crossVectors(i[0],u),c[0].crossVectors(i[0],a[0]);for(let b=1;b<=e;b++){if(a[b]=a[b-1].clone(),c[b]=c[b-1].clone(),u.crossVectors(i[b-1],i[b]),u.length()>Number.EPSILON){u.normalize();const A=Math.acos(Ki(i[b-1].dot(i[b]),-1,1));a[b].applyMatrix4(d.makeRotationAxis(u,A))}c[b].crossVectors(i[b],a[b])}if(!0===t){let b=Math.acos(Ki(a[0].dot(a[e]),-1,1));b/=e,i[0].dot(u.crossVectors(a[0],a[e]))>0&&(b=-b);for(let A=1;A<=e;A++)a[A].applyMatrix4(d.makeRotationAxis(i[A],b*A)),c[A].crossVectors(i[A],a[A])}return{tangents:i,normals:a,binormals:c}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}{constructor(e,t,n,i,a){super(),this.degree=e,this.knots=t,this.controlPoints=[],this.startKnot=i||0,this.endKnot=a||this.knots.length-1;for(let c=0;c<n.length;++c){const u=n[c];this.controlPoints[c]=new Ci(u.x,u.y,u.z,u.w)}}getPoint(e,t=new Q){const n=t,a=function ox(o,e,t,n){const i=fl(o,n,e),a=function Sm(o,e,t,n){const i=[],a=[],c=[];i[0]=1;for(let u=1;u<=t;++u){a[u]=e-n[o+1-u],c[u]=n[o+u]-e;let d=0;for(let p=0;p<u;++p){const v=c[p+1],_=a[u-p],M=i[p]/(v+_);i[p]=d+v*M,d=_*M}i[u]=d}return i}(i,n,o,e),c=new Ci(0,0,0,0);for(let u=0;u<=o;++u){const d=t[i-o+u],p=a[u],v=d.w*p;c.x+=d.x*v,c.y+=d.y*v,c.z+=d.z*v,c.w+=d.w*p}return c}(this.degree,this.knots,this.controlPoints,this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]));return 1!==a.w&&a.divideScalar(a.w),n.set(a.x,a.y,a.z)}getTangent(e,t=new Q){const n=t,a=function Xw(o,e,t,n,i){const a=function qS(o,e,t,n,i){const a=i<o?i:o,c=[],u=fl(o,n,e),d=function Ww(o,e,t,n,i){const a=[];for(let _=0;_<=t;++_)a[_]=0;const c=[];for(let _=0;_<=n;++_)c[_]=a.slice(0);const u=[];for(let _=0;_<=t;++_)u[_]=a.slice(0);u[0][0]=1;const d=a.slice(0),p=a.slice(0);for(let _=1;_<=t;++_){d[_]=e-i[o+1-_],p[_]=i[o+_]-e;let M=0;for(let b=0;b<_;++b){const A=p[b+1],P=d[_-b];u[_][b]=A+P;const R=u[b][_-1]/u[_][b];u[b][_]=M+A*R,M=P*R}u[_][_]=M}for(let _=0;_<=t;++_)c[0][_]=u[_][t];for(let _=0;_<=t;++_){let M=0,b=1;const A=[];for(let P=0;P<=t;++P)A[P]=a.slice(0);A[0][0]=1;for(let P=1;P<=n;++P){let R=0;const T=_-P,U=t-P;_>=P&&(A[b][0]=A[M][0]/u[U+1][T],R=A[b][0]*u[T][U]);const V=_-1<=U?P-1:t-_;for(let Z=T>=-1?1:-T;Z<=V;++Z)A[b][Z]=(A[M][Z]-A[M][Z-1])/u[U+1][T+Z],R+=A[b][Z]*u[T+Z][U];_<=U&&(A[b][P]=-A[M][P-1]/u[U+1][_],R+=A[b][P]*u[_][U]),c[P][_]=R;const X=M;M=b,b=X}}let v=t;for(let _=1;_<=n;++_){for(let M=0;M<=t;++M)c[_][M]*=v;v*=t-_}return c}(u,n,o,a,e),p=[];for(let v=0;v<t.length;++v){const _=t[v].clone(),M=_.w;_.x*=M,_.y*=M,_.z*=M,p[v]=_}for(let v=0;v<=a;++v){const _=p[u-o].clone().multiplyScalar(d[v][0]);for(let M=1;M<=o;++M)_.add(p[u-o+M].clone().multiplyScalar(d[v][M]));c[v]=_}for(let v=a+1;v<=i+1;++v)c[v]=new Ci(0,0,0);return c}(o,e,t,n,i);return function $w(o){const e=o.length,t=[],n=[];for(let a=0;a<e;++a){const c=o[a];t[a]=new Q(c.x,c.y,c.z),n[a]=c.w}const i=[];for(let a=0;a<e;++a){const c=t[a].clone();for(let u=1;u<=a;++u)c.sub(i[a-u].clone().multiplyScalar(jw(a,u)*n[u]));i[a]=c.divideScalar(n[0])}return i}(a)}(this.degree,this.knots,this.controlPoints,this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),1);return n.copy(a[1]).normalize(),n}}let si,Gr,zs;class ax extends jl{constructor(e){super(e)}load(e,t,n,i){const a=this,c=""===a.path?Hh.extractUrlBase(e):a.path,u=new hl(this.manager);u.setPath(a.path),u.setResponseType("arraybuffer"),u.setRequestHeader(a.requestHeader),u.setWithCredentials(a.withCredentials),u.load(e,function(d){try{t(a.parse(d,c))}catch(p){i?i(p):console.error(p),a.manager.itemError(e)}},n,i)}parse(e,t){if(function ux(o){const e="Kaydara FBX Binary  \0";return o.byteLength>=e.length&&e===eE(o,0,e.length)}(e))si=(new Xv).parse(e);else{const i=eE(e);if(!function hx(o){const e=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let t=0;function n(i){const a=o[i-1];return o=o.slice(t+i),t++,a}for(let i=0;i<e.length;++i)if(n(1)===e[i])return!1;return!0}(i))throw new Error("THREE.FBXLoader: Unknown format.");if(Jw(i)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+Jw(i));si=(new $v).parse(i)}const n=new _v(this.manager).setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin);return new Zw(n,this.manager).parse(si)}}class Zw{constructor(e,t){this.textureLoader=e,this.manager=t}parse(){Gr=this.parseConnections();const e=this.parseImages(),t=this.parseTextures(e),n=this.parseMaterials(t),i=this.parseDeformers(),a=(new Kw).parse(i);return this.parseScene(i,a,n),zs}parseConnections(){const e=new Map;return"Connections"in si&&si.Connections.connections.forEach(function(n){const i=n[0],a=n[1],c=n[2];e.has(i)||e.set(i,{parents:[],children:[]});const u={ID:a,relationship:c};e.get(i).parents.push(u),e.has(a)||e.set(a,{parents:[],children:[]});const d={ID:i,relationship:c};e.get(a).children.push(d)}),e}parseImages(){const e={},t={};if("Video"in si.Objects){const n=si.Objects.Video;for(const i in n){const a=n[i];if(e[parseInt(i)]=a.RelativeFilename||a.Filename,"Content"in a){const u=a.Content instanceof ArrayBuffer&&a.Content.byteLength>0,d="string"==typeof a.Content&&""!==a.Content;if(u||d){const p=this.parseImage(n[i]);t[a.RelativeFilename||a.Filename]=p}}}}for(const n in e){const i=e[n];e[n]=void 0!==t[i]?t[i]:e[n].split("\\").pop()}return e}parseImage(e){const t=e.Content,n=e.RelativeFilename||e.Filename,i=n.slice(n.lastIndexOf(".")+1).toLowerCase();let a;switch(i){case"bmp":a="image/bmp";break;case"jpg":case"jpeg":a="image/jpeg";break;case"png":a="image/png";break;case"tif":a="image/tiff";break;case"tga":null===this.manager.getHandler(".tga")&&console.warn("FBXLoader: TGA loader not found, skipping ",n),a="image/tga";break;default:return void console.warn('FBXLoader: Image type "'+i+'" is not supported.')}if("string"==typeof t)return"data:"+a+";base64,"+t;{const c=new Uint8Array(t);return window.URL.createObjectURL(new Blob([c],{type:a}))}}parseTextures(e){const t=new Map;if("Texture"in si.Objects){const n=si.Objects.Texture;for(const i in n){const a=this.parseTexture(n[i],e);t.set(parseInt(i),a)}}return t}parseTexture(e,t){const n=this.loadTexture(e,t);n.ID=e.id,n.name=e.attrName;const i=e.WrapModeU,a=e.WrapModeV,u=void 0!==a?a.value:0;if(n.wrapS=0===(void 0!==i?i.value:0)?$i:ri,n.wrapT=0===u?$i:ri,"Scaling"in e){const d=e.Scaling.value;n.repeat.x=d[0],n.repeat.y=d[1]}if("Translation"in e){const d=e.Translation.value;n.offset.x=d[0],n.offset.y=d[1]}return n}loadTexture(e,t){let n;const i=this.textureLoader.path,a=Gr.get(e.id).children;let c;void 0!==a&&a.length>0&&void 0!==t[a[0].ID]&&(n=t[a[0].ID],(0===n.indexOf("blob:")||0===n.indexOf("data:"))&&this.textureLoader.setPath(void 0));const u=e.FileName.slice(-3).toLowerCase();if("tga"===u){const d=this.manager.getHandler(".tga");null===d?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",e.RelativeFilename),c=new Ss):(d.setPath(this.textureLoader.path),c=d.load(n))}else"psd"===u?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",e.RelativeFilename),c=new Ss):c=this.textureLoader.load(n);return this.textureLoader.setPath(i),c}parseMaterials(e){const t=new Map;if("Material"in si.Objects){const n=si.Objects.Material;for(const i in n){const a=this.parseMaterial(n[i],e);null!==a&&t.set(parseInt(i),a)}}return t}parseMaterial(e,t){const n=e.id,i=e.attrName;let a=e.ShadingModel;if("object"==typeof a&&(a=a.value),!Gr.has(n))return null;const c=this.parseParameters(e,t,n);let u;switch(a.toLowerCase()){case"phong":u=new Wp;break;case"lambert":u=new Qi;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',a),u=new Wp}return u.setValues(c),u.name=i,u}parseParameters(e,t,n){const i={};e.BumpFactor&&(i.bumpScale=e.BumpFactor.value),e.Diffuse?i.color=(new ut).fromArray(e.Diffuse.value).convertSRGBToLinear():e.DiffuseColor&&("Color"===e.DiffuseColor.type||"ColorRGB"===e.DiffuseColor.type)&&(i.color=(new ut).fromArray(e.DiffuseColor.value).convertSRGBToLinear()),e.DisplacementFactor&&(i.displacementScale=e.DisplacementFactor.value),e.Emissive?i.emissive=(new ut).fromArray(e.Emissive.value).convertSRGBToLinear():e.EmissiveColor&&("Color"===e.EmissiveColor.type||"ColorRGB"===e.EmissiveColor.type)&&(i.emissive=(new ut).fromArray(e.EmissiveColor.value).convertSRGBToLinear()),e.EmissiveFactor&&(i.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),e.Opacity&&(i.opacity=parseFloat(e.Opacity.value)),i.opacity<1&&(i.transparent=!0),e.ReflectionFactor&&(i.reflectivity=e.ReflectionFactor.value),e.Shininess&&(i.shininess=e.Shininess.value),e.Specular?i.specular=(new ut).fromArray(e.Specular.value).convertSRGBToLinear():e.SpecularColor&&"Color"===e.SpecularColor.type&&(i.specular=(new ut).fromArray(e.SpecularColor.value).convertSRGBToLinear());const a=this;return Gr.get(n).children.forEach(function(c){const u=c.relationship;switch(u){case"Bump":i.bumpMap=a.getTexture(t,c.ID);break;case"Maya|TEX_ao_map":i.aoMap=a.getTexture(t,c.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":i.map=a.getTexture(t,c.ID),void 0!==i.map&&(i.map.colorSpace=vn);break;case"DisplacementColor":i.displacementMap=a.getTexture(t,c.ID);break;case"EmissiveColor":i.emissiveMap=a.getTexture(t,c.ID),void 0!==i.emissiveMap&&(i.emissiveMap.colorSpace=vn);break;case"NormalMap":case"Maya|TEX_normal_map":i.normalMap=a.getTexture(t,c.ID);break;case"ReflectionColor":i.envMap=a.getTexture(t,c.ID),void 0!==i.envMap&&(i.envMap.mapping=303,i.envMap.colorSpace=vn);break;case"SpecularColor":i.specularMap=a.getTexture(t,c.ID),void 0!==i.specularMap&&(i.specularMap.colorSpace=vn);break;case"TransparentColor":case"TransparencyFactor":i.alphaMap=a.getTexture(t,c.ID),i.transparent=!0;break;default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",u)}}),i}getTexture(e,t){return"LayeredTexture"in si.Objects&&t in si.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),t=Gr.get(t).children[0].ID),e.get(t)}parseDeformers(){const e={},t={};if("Deformer"in si.Objects){const n=si.Objects.Deformer;for(const i in n){const a=n[i],c=Gr.get(parseInt(i));if("Skin"===a.attrType){const u=this.parseSkeleton(c,n);u.ID=i,c.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),u.geometryID=c.parents[0].ID,e[i]=u}else if("BlendShape"===a.attrType){const u={id:i};u.rawTargets=this.parseMorphTargets(c,n),u.id=i,c.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),t[i]=u}}}return{skeletons:e,morphTargets:t}}parseSkeleton(e,t){const n=[];return e.children.forEach(function(i){const a=t[i.ID];if("Cluster"!==a.attrType)return;const c={ID:i.ID,indices:[],weights:[],transformLink:(new Yt).fromArray(a.TransformLink.a)};"Indexes"in a&&(c.indices=a.Indexes.a,c.weights=a.Weights.a),n.push(c)}),{rawBones:n,bones:[]}}parseMorphTargets(e,t){const n=[];for(let i=0;i<e.children.length;i++){const a=e.children[i],c=t[a.ID],u={name:c.attrName,initialWeight:c.DeformPercent,id:c.id,fullWeights:c.FullWeights.a};if("BlendShapeChannel"!==c.attrType)return;u.geoID=Gr.get(parseInt(a.ID)).children.filter(function(d){return void 0===d.relationship})[0].ID,n.push(u)}return n}parseScene(e,t,n){zs=new ol;const i=this.parseModels(e.skeletons,t,n),a=si.Objects.Model,c=this;i.forEach(function(d){c.setLookAtProperties(d,a[d.ID]),Gr.get(d.ID).parents.forEach(function(_){const M=i.get(_.ID);void 0!==M&&M.add(d)}),null===d.parent&&zs.add(d)}),this.bindSkeleton(e.skeletons,t,i),this.createAmbientLight(),zs.traverse(function(d){if(d.userData.transformData){d.parent&&(d.userData.transformData.parentMatrix=d.parent.matrix,d.userData.transformData.parentMatrixWorld=d.parent.matrixWorld);const p=dx(d.userData.transformData);d.applyMatrix4(p),d.updateWorldMatrix()}});const u=(new lx).parse();1===zs.children.length&&zs.children[0].isGroup&&(zs.children[0].animations=u,zs=zs.children[0]),zs.animations=u}parseModels(e,t,n){const i=new Map,a=si.Objects.Model;for(const c in a){const u=parseInt(c),d=a[c],p=Gr.get(u);let v=this.buildSkeleton(p,e,u,d.attrName);if(!v){switch(d.attrType){case"Camera":v=this.createCamera(p);break;case"Light":v=this.createLight(p);break;case"Mesh":v=this.createMesh(p,t,n);break;case"NurbsCurve":v=this.createCurve(p,t);break;case"LimbNode":case"Root":v=new Ph;break;default:v=new ol}v.name=d.attrName?Mi.sanitizeNodeName(d.attrName):"",v.ID=u}this.getTransformData(v,d),i.set(u,v)}return i}buildSkeleton(e,t,n,i){let a=null;return e.parents.forEach(function(c){for(const u in t){const d=t[u];d.rawBones.forEach(function(p,v){if(p.ID===c.ID){const _=a;a=new Ph,a.matrixWorld.copy(p.transformLink),a.name=i?Mi.sanitizeNodeName(i):"",a.ID=n,d.bones[v]=a,null!==_&&a.add(_)}})}}),a}createCamera(e){let t,n;if(e.children.forEach(function(i){const a=si.Objects.NodeAttribute[i.ID];void 0!==a&&(n=a)}),void 0===n)t=new xr;else{let i=0;void 0!==n.CameraProjectionType&&1===n.CameraProjectionType.value&&(i=1);let a=1;void 0!==n.NearPlane&&(a=n.NearPlane.value/1e3);let c=1e3;void 0!==n.FarPlane&&(c=n.FarPlane.value/1e3);let u=window.innerWidth,d=window.innerHeight;void 0!==n.AspectWidth&&void 0!==n.AspectHeight&&(u=n.AspectWidth.value,d=n.AspectHeight.value);const p=u/d;let v=45;void 0!==n.FieldOfView&&(v=n.FieldOfView.value);const _=n.FocalLength?n.FocalLength.value:null;switch(i){case 0:t=new ts(v,p,a,c),null!==_&&t.setFocalLength(_);break;case 1:t=new yh(-u/2,u/2,d/2,-d/2,a,c);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+i+"."),t=new xr}}return t}createLight(e){let t,n;if(e.children.forEach(function(i){const a=si.Objects.NodeAttribute[i.ID];void 0!==a&&(n=a)}),void 0===n)t=new xr;else{let i;i=void 0===n.LightType?0:n.LightType.value;let a=16777215;void 0!==n.Color&&(a=(new ut).fromArray(n.Color.value).convertSRGBToLinear());let c=void 0===n.Intensity?1:n.Intensity.value/100;void 0!==n.CastLightOnObject&&0===n.CastLightOnObject.value&&(c=0);let u=0;void 0!==n.FarAttenuationEnd&&(u=void 0!==n.EnableFarAttenuation&&0===n.EnableFarAttenuation.value?0:n.FarAttenuationEnd.value);const d=1;switch(i){case 0:t=new Kp(a,c,u,d);break;case 1:t=new rf(a,c);break;case 2:let p=Math.PI/3;void 0!==n.InnerAngle&&(p=Co_degToRad(n.InnerAngle.value));let v=0;void 0!==n.OuterAngle&&(v=Co_degToRad(n.OuterAngle.value),v=Math.max(v,1)),t=new Mv(a,c,u,p,v,d);break;default:console.warn("THREE.FBXLoader: Unknown light type "+n.LightType.value+", defaulting to a PointLight."),t=new Kp(a,c)}void 0!==n.CastShadows&&1===n.CastShadows.value&&(t.castShadow=!0)}return t}createMesh(e,t,n){let i,a=null,c=null;const u=[];return e.children.forEach(function(d){t.has(d.ID)&&(a=t.get(d.ID)),n.has(d.ID)&&u.push(n.get(d.ID))}),u.length>1?c=u:u.length>0?c=u[0]:(c=new Wp({name:jl.DEFAULT_MATERIAL_NAME,color:13421772}),u.push(c)),"color"in a.attributes&&u.forEach(function(d){d.vertexColors=!0}),a.FBX_Deformer?(i=new wu(a,c),i.normalizeSkinWeights()):i=new Ji(a,c),i}createCurve(e,t){const n=e.children.reduce(function(a,c){return t.has(c.ID)&&(a=t.get(c.ID)),a},null),i=new Vs({name:jl.DEFAULT_MATERIAL_NAME,color:3342591,linewidth:1});return new zl(n,i)}getTransformData(e,t){const n={};"InheritType"in t&&(n.inheritType=parseInt(t.InheritType.value)),n.eulerOrder="RotationOrder"in t?fx(t.RotationOrder.value):"ZYX","Lcl_Translation"in t&&(n.translation=t.Lcl_Translation.value),"PreRotation"in t&&(n.preRotation=t.PreRotation.value),"Lcl_Rotation"in t&&(n.rotation=t.Lcl_Rotation.value),"PostRotation"in t&&(n.postRotation=t.PostRotation.value),"Lcl_Scaling"in t&&(n.scale=t.Lcl_Scaling.value),"ScalingOffset"in t&&(n.scalingOffset=t.ScalingOffset.value),"ScalingPivot"in t&&(n.scalingPivot=t.ScalingPivot.value),"RotationOffset"in t&&(n.rotationOffset=t.RotationOffset.value),"RotationPivot"in t&&(n.rotationPivot=t.RotationPivot.value),e.userData.transformData=n}setLookAtProperties(e,t){"LookAtProperty"in t&&Gr.get(e.ID).children.forEach(function(i){if("LookAtProperty"===i.relationship){const a=si.Objects.Model[i.ID];if("Lcl_Translation"in a){const c=a.Lcl_Translation.value;void 0!==e.target?(e.target.position.fromArray(c),zs.add(e.target)):e.lookAt((new Q).fromArray(c))}}})}bindSkeleton(e,t,n){const i=this.parsePoseNodes();for(const a in e){const c=e[a];Gr.get(parseInt(c.ID)).parents.forEach(function(d){t.has(d.ID)&&Gr.get(d.ID).parents.forEach(function(_){n.has(_.ID)&&n.get(_.ID).bind(new Ac(c.bones),i[_.ID])})})}}parsePoseNodes(){const e={};if("Pose"in si.Objects){const t=si.Objects.Pose;for(const n in t)if("BindPose"===t[n].attrType&&t[n].NbPoseNodes>0){const i=t[n].PoseNode;Array.isArray(i)?i.forEach(function(a){e[a.Node]=(new Yt).fromArray(a.Matrix.a)}):e[i.Node]=(new Yt).fromArray(i.Matrix.a)}}return e}createAmbientLight(){if("GlobalSettings"in si&&"AmbientColor"in si.GlobalSettings){const e=si.GlobalSettings.AmbientColor.value,t=e[0],n=e[1],i=e[2];if(0!==t||0!==n||0!==i){const a=new ut(t,n,i).convertSRGBToLinear();zs.add(new Jp(a,1))}}}}class Kw{constructor(){this.negativeMaterialIndices=!1}parse(e){const t=new Map;if("Geometry"in si.Objects){const n=si.Objects.Geometry;for(const i in n){const a=Gr.get(parseInt(i)),c=this.parseGeometry(a,n[i],e);t.set(parseInt(i),c)}}return!0===this.negativeMaterialIndices&&console.warn("THREE.FBXLoader: The FBX file contains invalid (negative) material indices. The asset might not render as expected."),t}parseGeometry(e,t,n){switch(t.attrType){case"Mesh":return this.parseMeshGeometry(e,t,n);case"NurbsCurve":return this.parseNurbsGeometry(t)}}parseMeshGeometry(e,t,n){const i=n.skeletons,a=[],c=e.parents.map(function(_){return si.Objects.Model[_.ID]});if(0===c.length)return;const u=e.children.reduce(function(_,M){return void 0!==i[M.ID]&&(_=i[M.ID]),_},null);e.children.forEach(function(_){void 0!==n.morphTargets[_.ID]&&a.push(n.morphTargets[_.ID])});const d=c[0],p={};"RotationOrder"in d&&(p.eulerOrder=fx(d.RotationOrder.value)),"InheritType"in d&&(p.inheritType=parseInt(d.InheritType.value)),"GeometricTranslation"in d&&(p.translation=d.GeometricTranslation.value),"GeometricRotation"in d&&(p.rotation=d.GeometricRotation.value),"GeometricScaling"in d&&(p.scale=d.GeometricScaling.value);const v=dx(p);return this.genGeometry(t,u,a,v)}genGeometry(e,t,n,i){const a=new Un;e.attrName&&(a.name=e.attrName);const c=this.parseGeoNode(e,t),u=this.genBuffers(c),d=new qt(u.vertex,3);if(d.applyMatrix4(i),a.setAttribute("position",d),u.colors.length>0&&a.setAttribute("color",new qt(u.colors,3)),t&&(a.setAttribute("skinIndex",new Km(u.weightsIndices,4)),a.setAttribute("skinWeight",new qt(u.vertexWeights,4)),a.FBX_Deformer=t),u.normal.length>0){const p=(new Zn).getNormalMatrix(i),v=new qt(u.normal,3);v.applyNormalMatrix(p),a.setAttribute("normal",v)}if(u.uvs.forEach(function(p,v){a.setAttribute(0===v?"uv":`uv${v}`,new qt(u.uvs[v],2))}),c.material&&"AllSame"!==c.material.mappingType){let p=u.materialIndex[0],v=0;if(u.materialIndex.forEach(function(_,M){_!==p&&(a.addGroup(v,M-v,p),p=_,v=M)}),a.groups.length>0){const _=a.groups[a.groups.length-1],M=_.start+_.count;M!==u.materialIndex.length&&a.addGroup(M,u.materialIndex.length-M,p)}0===a.groups.length&&a.addGroup(0,u.materialIndex.length,u.materialIndex[0])}return this.addMorphTargets(a,e,n,i),a}parseGeoNode(e,t){const n={};if(n.vertexPositions=void 0!==e.Vertices?e.Vertices.a:[],n.vertexIndices=void 0!==e.PolygonVertexIndex?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(n.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(n.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(n.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){n.uv=[];let i=0;for(;e.LayerElementUV[i];)e.LayerElementUV[i].UV&&n.uv.push(this.parseUVs(e.LayerElementUV[i])),i++}return n.weightTable={},null!==t&&(n.skeleton=t,t.rawBones.forEach(function(i,a){i.indices.forEach(function(c,u){void 0===n.weightTable[c]&&(n.weightTable[c]=[]),n.weightTable[c].push({id:a,weight:i.weights[u]})})})),n}genBuffers(e){const t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let n=0,i=0,a=!1,c=[],u=[],d=[],p=[],v=[],_=[];const M=this;return e.vertexIndices.forEach(function(b,A){let P,R=!1;b<0&&(b^=-1,R=!0);let T=[],U=[];if(c.push(3*b,3*b+1,3*b+2),e.color){const F=Yv(A,n,b,e.color);d.push(F[0],F[1],F[2])}if(e.skeleton){if(void 0!==e.weightTable[b]&&e.weightTable[b].forEach(function(F){U.push(F.weight),T.push(F.id)}),U.length>4){a||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),a=!0);const F=[0,0,0,0],V=[0,0,0,0];U.forEach(function(X,Z){let q=X,ee=T[Z];V.forEach(function(j,K,Me){if(q>j){Me[K]=q,q=j;const De=F[K];F[K]=ee,ee=De}})}),T=F,U=V}for(;U.length<4;)U.push(0),T.push(0);for(let F=0;F<4;++F)v.push(U[F]),_.push(T[F])}if(e.normal){const F=Yv(A,n,b,e.normal);u.push(F[0],F[1],F[2])}e.material&&"AllSame"!==e.material.mappingType&&(P=Yv(A,n,b,e.material)[0],P<0&&(M.negativeMaterialIndices=!0,P=0)),e.uv&&e.uv.forEach(function(F,V){const X=Yv(A,n,b,F);void 0===p[V]&&(p[V]=[]),p[V].push(X[0]),p[V].push(X[1])}),i++,R&&(i>4&&console.warn("THREE.FBXLoader: Polygons with more than four sides are not supported. Make sure to triangulate the geometry during export."),M.genFace(t,e,c,P,u,d,p,v,_,i),n++,i=0,c=[],u=[],d=[],p=[],v=[],_=[])}),t}genFace(e,t,n,i,a,c,u,d,p,v){for(let _=2;_<v;_++)e.vertex.push(t.vertexPositions[n[0]]),e.vertex.push(t.vertexPositions[n[1]]),e.vertex.push(t.vertexPositions[n[2]]),e.vertex.push(t.vertexPositions[n[3*(_-1)]]),e.vertex.push(t.vertexPositions[n[3*(_-1)+1]]),e.vertex.push(t.vertexPositions[n[3*(_-1)+2]]),e.vertex.push(t.vertexPositions[n[3*_]]),e.vertex.push(t.vertexPositions[n[3*_+1]]),e.vertex.push(t.vertexPositions[n[3*_+2]]),t.skeleton&&(e.vertexWeights.push(d[0]),e.vertexWeights.push(d[1]),e.vertexWeights.push(d[2]),e.vertexWeights.push(d[3]),e.vertexWeights.push(d[4*(_-1)]),e.vertexWeights.push(d[4*(_-1)+1]),e.vertexWeights.push(d[4*(_-1)+2]),e.vertexWeights.push(d[4*(_-1)+3]),e.vertexWeights.push(d[4*_]),e.vertexWeights.push(d[4*_+1]),e.vertexWeights.push(d[4*_+2]),e.vertexWeights.push(d[4*_+3]),e.weightsIndices.push(p[0]),e.weightsIndices.push(p[1]),e.weightsIndices.push(p[2]),e.weightsIndices.push(p[3]),e.weightsIndices.push(p[4*(_-1)]),e.weightsIndices.push(p[4*(_-1)+1]),e.weightsIndices.push(p[4*(_-1)+2]),e.weightsIndices.push(p[4*(_-1)+3]),e.weightsIndices.push(p[4*_]),e.weightsIndices.push(p[4*_+1]),e.weightsIndices.push(p[4*_+2]),e.weightsIndices.push(p[4*_+3])),t.color&&(e.colors.push(c[0]),e.colors.push(c[1]),e.colors.push(c[2]),e.colors.push(c[3*(_-1)]),e.colors.push(c[3*(_-1)+1]),e.colors.push(c[3*(_-1)+2]),e.colors.push(c[3*_]),e.colors.push(c[3*_+1]),e.colors.push(c[3*_+2])),t.material&&"AllSame"!==t.material.mappingType&&(e.materialIndex.push(i),e.materialIndex.push(i),e.materialIndex.push(i)),t.normal&&(e.normal.push(a[0]),e.normal.push(a[1]),e.normal.push(a[2]),e.normal.push(a[3*(_-1)]),e.normal.push(a[3*(_-1)+1]),e.normal.push(a[3*(_-1)+2]),e.normal.push(a[3*_]),e.normal.push(a[3*_+1]),e.normal.push(a[3*_+2])),t.uv&&t.uv.forEach(function(M,b){void 0===e.uvs[b]&&(e.uvs[b]=[]),e.uvs[b].push(u[b][0]),e.uvs[b].push(u[b][1]),e.uvs[b].push(u[b][2*(_-1)]),e.uvs[b].push(u[b][2*(_-1)+1]),e.uvs[b].push(u[b][2*_]),e.uvs[b].push(u[b][2*_+1])})}addMorphTargets(e,t,n,i){if(0===n.length)return;e.morphTargetsRelative=!0,e.morphAttributes.position=[];const a=this;n.forEach(function(c){c.rawTargets.forEach(function(u){const d=si.Objects.Geometry[u.geoID];void 0!==d&&a.genMorphGeometry(e,t,d,i,u.name)})})}genMorphGeometry(e,t,n,i,a){const c=void 0!==t.PolygonVertexIndex?t.PolygonVertexIndex.a:[],u=void 0!==n.Vertices?n.Vertices.a:[],d=void 0!==n.Indexes?n.Indexes.a:[],v=new Float32Array(3*e.attributes.position.count);for(let A=0;A<d.length;A++){const P=3*d[A];v[P]=u[3*A],v[P+1]=u[3*A+1],v[P+2]=u[3*A+2]}const M=this.genBuffers({vertexIndices:c,vertexPositions:v}),b=new qt(M.vertex,3);b.name=a||n.attrName,b.applyMatrix4(i),e.morphAttributes.position.push(b)}parseNormals(e){const n=e.ReferenceInformationType;let a=[];return"IndexToDirect"===n&&("NormalIndex"in e?a=e.NormalIndex.a:"NormalsIndex"in e&&(a=e.NormalsIndex.a)),{dataSize:3,buffer:e.Normals.a,indices:a,mappingType:e.MappingInformationType,referenceType:n}}parseUVs(e){const n=e.ReferenceInformationType;let a=[];return"IndexToDirect"===n&&(a=e.UVIndex.a),{dataSize:2,buffer:e.UV.a,indices:a,mappingType:e.MappingInformationType,referenceType:n}}parseVertexColors(e){const t=e.MappingInformationType,n=e.ReferenceInformationType,i=e.Colors.a;let a=[];"IndexToDirect"===n&&(a=e.ColorIndex.a);for(let c=0,u=new ut;c<i.length;c+=4)u.fromArray(i,c).convertSRGBToLinear().toArray(i,c);return{dataSize:4,buffer:i,indices:a,mappingType:t,referenceType:n}}parseMaterialIndices(e){const t=e.MappingInformationType,n=e.ReferenceInformationType;if("NoMappingInformation"===t)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:n};const i=e.Materials.a,a=[];for(let c=0;c<i.length;++c)a.push(c);return{dataSize:1,buffer:i,indices:a,mappingType:t,referenceType:n}}parseNurbsGeometry(e){const t=parseInt(e.Order);if(isNaN(t))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new Un;const n=t-1,i=e.KnotVector.a,a=[],c=e.Points.a;for(let _=0,M=c.length;_<M;_+=4)a.push((new Ci).fromArray(c,_));let u,d;if("Closed"===e.Form)a.push(a[0]);else if("Periodic"===e.Form){u=n,d=i.length-1-u;for(let _=0;_<n;++_)a.push(a[_])}const v=new Yw(n,i,a,u,d).getPoints(12*a.length);return(new Un).setFromPoints(v)}}class lx{parse(){const e=[],t=this.parseClips();if(void 0!==t)for(const n in t){const a=this.addClip(t[n]);e.push(a)}return e}parseClips(){if(void 0===si.Objects.AnimationCurve)return;const e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);const t=this.parseAnimationLayers(e);return this.parseAnimStacks(t)}parseAnimationCurveNodes(){const e=si.Objects.AnimationCurveNode,t=new Map;for(const n in e){const i=e[n];if(null!==i.attrName.match(/S|R|T|DeformPercent/)){const a={id:i.id,attr:i.attrName,curves:{}};t.set(a.id,a)}}return t}parseAnimationCurves(e){const t=si.Objects.AnimationCurve;for(const n in t){const i={id:t[n].id,times:t[n].KeyTime.a.map(Qw),values:t[n].KeyValueFloat.a},a=Gr.get(i.id);if(void 0!==a){const c=a.parents[0].ID,u=a.parents[0].relationship;u.match(/X/)?e.get(c).curves.x=i:u.match(/Y/)?e.get(c).curves.y=i:u.match(/Z/)?e.get(c).curves.z=i:u.match(/DeformPercent/)&&e.has(c)&&(e.get(c).curves.morph=i)}}}parseAnimationLayers(e){const t=si.Objects.AnimationLayer,n=new Map;for(const i in t){const a=[],c=Gr.get(parseInt(i));void 0!==c&&(c.children.forEach(function(d,p){if(e.has(d.ID)){const v=e.get(d.ID);if(void 0!==v.curves.x||void 0!==v.curves.y||void 0!==v.curves.z){if(void 0===a[p]){const _=Gr.get(d.ID).parents.filter(function(M){return void 0!==M.relationship})[0].ID;if(void 0!==_){const M=si.Objects.Model[_.toString()];if(void 0===M)return void console.warn("THREE.FBXLoader: Encountered a unused curve.",d);const b={modelName:M.attrName?Mi.sanitizeNodeName(M.attrName):"",ID:M.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};zs.traverse(function(A){A.ID===M.id&&(b.transform=A.matrix,A.userData.transformData&&(b.eulerOrder=A.userData.transformData.eulerOrder))}),b.transform||(b.transform=new Yt),"PreRotation"in M&&(b.preRotation=M.PreRotation.value),"PostRotation"in M&&(b.postRotation=M.PostRotation.value),a[p]=b}}a[p]&&(a[p][v.attr]=v)}else if(void 0!==v.curves.morph){if(void 0===a[p]){const _=Gr.get(d.ID).parents.filter(function(T){return void 0!==T.relationship})[0].ID,M=Gr.get(_).parents[0].ID,b=Gr.get(M).parents[0].ID,A=Gr.get(b).parents[0].ID,P=si.Objects.Model[A],R={modelName:P.attrName?Mi.sanitizeNodeName(P.attrName):"",morphName:si.Objects.Deformer[_].attrName};a[p]=R}a[p][v.attr]=v}}}),n.set(parseInt(i),a))}return n}parseAnimStacks(e){const t=si.Objects.AnimationStack,n={};for(const i in t){const a=Gr.get(parseInt(i)).children;a.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const c=e.get(a[0].ID);n[i]={name:t[i].attrName,layer:c}}return n}addClip(e){let t=[];const n=this;return e.layer.forEach(function(i){t=t.concat(n.generateTracks(i))}),new Vh(e.name,-1,t)}generateTracks(e){const t=[];let n=new Q,i=new _r,a=new Q;if(e.transform&&e.transform.decompose(n,i,a),n=n.toArray(),i=(new Ol).setFromQuaternion(i,e.eulerOrder).toArray(),a=a.toArray(),void 0!==e.T&&Object.keys(e.T.curves).length>0){const c=this.generateVectorTrack(e.modelName,e.T.curves,n,"position");void 0!==c&&t.push(c)}if(void 0!==e.R&&Object.keys(e.R.curves).length>0){const c=this.generateRotationTrack(e.modelName,e.R.curves,i,e.preRotation,e.postRotation,e.eulerOrder);void 0!==c&&t.push(c)}if(void 0!==e.S&&Object.keys(e.S.curves).length>0){const c=this.generateVectorTrack(e.modelName,e.S.curves,a,"scale");void 0!==c&&t.push(c)}if(void 0!==e.DeformPercent){const c=this.generateMorphTrack(e);void 0!==c&&t.push(c)}return t}generateVectorTrack(e,t,n,i){const a=this.getTimesForAllAxes(t),c=this.getKeyframeTrackValues(a,t,n);return new Pu(e+"."+i,a,c)}generateRotationTrack(e,t,n,i,a,c){void 0!==t.x&&(this.interpolateRotations(t.x),t.x.values=t.x.values.map(Co_degToRad)),void 0!==t.y&&(this.interpolateRotations(t.y),t.y.values=t.y.values.map(Co_degToRad)),void 0!==t.z&&(this.interpolateRotations(t.z),t.z.values=t.z.values.map(Co_degToRad));const u=this.getTimesForAllAxes(t),d=this.getKeyframeTrackValues(u,t,n);void 0!==i&&((i=i.map(Co_degToRad)).push(c),i=(new Ol).fromArray(i),i=(new _r).setFromEuler(i)),void 0!==a&&((a=a.map(Co_degToRad)).push(c),a=(new Ol).fromArray(a),a=(new _r).setFromEuler(a).invert());const p=new _r,v=new Ol,_=[];for(let M=0;M<d.length;M+=3)v.set(d[M],d[M+1],d[M+2],c),p.setFromEuler(v),void 0!==i&&p.premultiply(i),void 0!==a&&p.multiply(a),p.toArray(_,M/3*4);return new sa(e+".quaternion",u,_)}generateMorphTrack(e){const t=e.DeformPercent.curves.morph,n=t.values.map(function(a){return a/100}),i=zs.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new Dc(e.modelName+".morphTargetInfluences["+i+"]",t.times,n)}getTimesForAllAxes(e){let t=[];if(void 0!==e.x&&(t=t.concat(e.x.times)),void 0!==e.y&&(t=t.concat(e.y.times)),void 0!==e.z&&(t=t.concat(e.z.times)),t=t.sort(function(n,i){return n-i}),t.length>1){let n=1,i=t[0];for(let a=1;a<t.length;a++){const c=t[a];c!==i&&(t[n]=c,i=c,n++)}t=t.slice(0,n)}return t}getKeyframeTrackValues(e,t,n){const i=n,a=[];let c=-1,u=-1,d=-1;return e.forEach(function(p){if(t.x&&(c=t.x.times.indexOf(p)),t.y&&(u=t.y.times.indexOf(p)),t.z&&(d=t.z.times.indexOf(p)),-1!==c){const v=t.x.values[c];a.push(v),i[0]=v}else a.push(i[0]);if(-1!==u){const v=t.y.values[u];a.push(v),i[1]=v}else a.push(i[1]);if(-1!==d){const v=t.z.values[d];a.push(v),i[2]=v}else a.push(i[2])}),a}interpolateRotations(e){for(let t=1;t<e.values.length;t++){const n=e.values[t-1],i=e.values[t]-n,a=Math.abs(i);if(a>=180){const c=a/180,u=i/c;let d=n+u;const p=e.times[t-1],_=(e.times[t]-p)/c;let M=p+_;const b=[],A=[];for(;M<e.times[t];)b.push(M),M+=_,A.push(d),d+=u;e.times=tE(e.times,t,b),e.values=tE(e.values,t,A)}}}}class $v{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(e){this.nodeStack.push(e),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(e,t){this.currentProp=e,this.currentPropName=t}parse(e){this.currentIndent=0,this.allNodes=new cx,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const t=this,n=e.split(/[\r\n]+/);return n.forEach(function(i,a){const c=i.match(/^[\s\t]*;/),u=i.match(/^[\s\t]*$/);if(c||u)return;const d=i.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),p=i.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),v=i.match("^\\t{"+(t.currentIndent-1)+"}}");d?t.parseNodeBegin(i,d):p?t.parseNodeProperty(i,p,n[++a]):v?t.popStack():i.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(i)}),this.allNodes}parseNodeBegin(e,t){const n=t[1].trim().replace(/^"/,"").replace(/"$/,""),i=t[2].split(",").map(function(d){return d.trim().replace(/^"/,"").replace(/"$/,"")}),a={name:n},c=this.parseNodeAttr(i),u=this.getCurrentNode();0===this.currentIndent?this.allNodes.add(n,a):n in u?("PoseNode"===n?u.PoseNode.push(a):void 0!==u[n].id&&(u[n]={},u[n][u[n].id]=u[n]),""!==c.id&&(u[n][c.id]=a)):"number"==typeof c.id?(u[n]={},u[n][c.id]=a):"Properties70"!==n&&(u[n]="PoseNode"===n?[a]:a),"number"==typeof c.id&&(a.id=c.id),""!==c.name&&(a.attrName=c.name),""!==c.type&&(a.attrType=c.type),this.pushStack(a)}parseNodeAttr(e){let t=e[0];""!==e[0]&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));let n="",i="";return e.length>1&&(n=e[1].replace(/^(\w+)::/,""),i=e[2]),{id:t,name:n,type:i}}parseNodeProperty(e,t,n){let i=t[1].replace(/^"/,"").replace(/"$/,"").trim(),a=t[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===i&&","===a&&(a=n.replace(/"/g,"").replace(/,$/,"").trim());const c=this.getCurrentNode();if("Properties70"!==c.name){if("C"===i){const d=a.split(",").slice(1),p=parseInt(d[0]),v=parseInt(d[1]);let _=a.split(",").slice(3);_=_.map(function(M){return M.trim().replace(/^"/,"")}),i="connections",a=[p,v],function ZS(o,e){for(let t=0,n=o.length,i=e.length;t<i;t++,n++)o[n]=e[t]}(a,_),void 0===c[i]&&(c[i]=[])}"Node"===i&&(c.id=a),i in c&&Array.isArray(c[i])?c[i].push(a):"a"!==i?c[i]=a:c.a=a,this.setCurrentProp(c,i),"a"===i&&","!==a.slice(-1)&&(c.a=px(a))}else this.parseNodeSpecialProperty(e,i,a)}parseNodePropertyContinued(e){const t=this.getCurrentNode();t.a+=e,","!==e.slice(-1)&&(t.a=px(t.a))}parseNodeSpecialProperty(e,t,n){const i=n.split('",').map(function(v){return v.trim().replace(/^\"/,"").replace(/\s/,"_")}),a=i[0],c=i[1],u=i[2],d=i[3];let p=i[4];switch(c){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":p=parseFloat(p);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":p=px(p)}this.getPrevNode()[a]={type:c,type2:u,flag:d,value:p},this.setCurrentProp(this.getPrevNode(),a)}}class Xv{parse(e){const t=new qv(e);t.skip(23);const n=t.getUint32();if(n<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+n);const i=new cx;for(;!this.endOfContent(t);){const a=this.parseNode(t,n);null!==a&&i.add(a.name,a)}return i}endOfContent(e){return e.size()%16==0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()}parseNode(e,t){const n={},i=t>=7500?e.getUint64():e.getUint32(),a=t>=7500?e.getUint64():e.getUint32();t>=7500?e.getUint64():e.getUint32();const c=e.getUint8(),u=e.getString(c);if(0===i)return null;const d=[];for(let M=0;M<a;M++)d.push(this.parseProperty(e));const p=d.length>0?d[0]:"",v=d.length>1?d[1]:"",_=d.length>2?d[2]:"";for(n.singleProperty=1===a&&e.getOffset()===i;i>e.getOffset();){const M=this.parseNode(e,t);null!==M&&this.parseSubNode(u,n,M)}return n.propertyList=d,"number"==typeof p&&(n.id=p),""!==v&&(n.attrName=v),""!==_&&(n.attrType=_),""!==u&&(n.name=u),n}parseSubNode(e,t,n){if(!0===n.singleProperty){const i=n.propertyList[0];Array.isArray(i)?(t[n.name]=n,n.a=i):t[n.name]=i}else if("Connections"===e&&"C"===n.name){const i=[];n.propertyList.forEach(function(a,c){0!==c&&i.push(a)}),void 0===t.connections&&(t.connections=[]),t.connections.push(i)}else if("Properties70"===n.name)Object.keys(n).forEach(function(a){t[a]=n[a]});else if("Properties70"===e&&"P"===n.name){let i=n.propertyList[0],a=n.propertyList[1];const c=n.propertyList[2],u=n.propertyList[3];let d;0===i.indexOf("Lcl ")&&(i=i.replace("Lcl ","Lcl_")),0===a.indexOf("Lcl ")&&(a=a.replace("Lcl ","Lcl_")),d="Color"===a||"ColorRGB"===a||"Vector"===a||"Vector3D"===a||0===a.indexOf("Lcl_")?[n.propertyList[4],n.propertyList[5],n.propertyList[6]]:n.propertyList[4],t[i]={type:a,type2:c,flag:u,value:d}}else void 0===t[n.name]?"number"==typeof n.id?(t[n.name]={},t[n.name][n.id]=n):t[n.name]=n:"PoseNode"===n.name?(Array.isArray(t[n.name])||(t[n.name]=[t[n.name]]),t[n.name].push(n)):void 0===t[n.name][n.id]&&(t[n.name][n.id]=n)}parseProperty(e){const t=e.getString(1);let n;switch(t){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":return n=e.getUint32(),e.getArrayBuffer(n);case"S":return n=e.getUint32(),e.getString(n);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const i=e.getUint32(),a=e.getUint32(),c=e.getUint32();if(0===a)switch(t){case"b":case"c":return e.getBooleanArray(i);case"d":return e.getFloat64Array(i);case"f":return e.getFloat32Array(i);case"i":return e.getInt32Array(i);case"l":return e.getInt64Array(i)}const u=function Jh(o,e){return pf((function(o){if(8!=(15&o[0])||o[0]>>>4>7||(o[0]<<8|o[1])%31)throw"invalid zlib data";if(32&o[1])throw"invalid zlib data: preset dictionaries not supported"}(o),o.subarray(2,-4)),e)}(new Uint8Array(e.getArrayBuffer(c))),d=new qv(u.buffer);switch(t){case"b":case"c":return d.getBooleanArray(i);case"d":return d.getFloat64Array(i);case"f":return d.getFloat32Array(i);case"i":return d.getInt32Array(i);case"l":return d.getInt64Array(i)}break;default:throw new Error("THREE.FBXLoader: Unknown property type "+t)}}}class qv{constructor(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=void 0===t||t,this._textDecoder=new TextDecoder}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(e){this.offset+=e}getBoolean(){return 1==(1&this.getUint8())}getBooleanArray(e){const t=[];for(let n=0;n<e;n++)t.push(this.getBoolean());return t}getUint8(){const e=this.dv.getUint8(this.offset);return this.offset+=1,e}getInt16(){const e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}getInt32(){const e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}getInt32Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getInt32());return t}getUint32(){const e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}getInt64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),2147483648&t?(t=4294967295&~t,e=4294967295&~e,4294967295===e&&(t=t+1&4294967295),e=e+1&4294967295,-(4294967296*t+e)):4294967296*t+e}getInt64Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getInt64());return t}getUint64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),4294967296*t+e}getFloat32(){const e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}getFloat32Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getFloat32());return t}getFloat64(){const e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}getFloat64Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getFloat64());return t}getArrayBuffer(e){const t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}getString(e){const t=this.offset;let n=new Uint8Array(this.dv.buffer,t,e);this.skip(e);const i=n.indexOf(0);return i>=0&&(n=new Uint8Array(this.dv.buffer,t,i)),this._textDecoder.decode(n)}}class cx{add(e,t){this[e]=t}}function Jw(o){const t=o.match(/FBXVersion: (\d+)/);if(t)return parseInt(t[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function Qw(o){return o/46186158e3}const YS=[];function Yv(o,e,t,n){let i;switch(n.mappingType){case"ByPolygonVertex":i=o;break;case"ByPolygon":i=e;break;case"ByVertice":i=t;break;case"AllSame":i=n.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+n.mappingType)}"IndexToDirect"===n.referenceType&&(i=n.indices[i]);const a=i*n.dataSize;return function KS(o,e,t,n){for(let i=t,a=0;i<n;i++,a++)o[a]=e[i];return o}(YS,n.buffer,a,a+n.dataSize)}const Am=new Ol,Qh=new Q;function dx(o){const e=new Yt,t=new Yt,n=new Yt,i=new Yt,a=new Yt,c=new Yt,u=new Yt,d=new Yt,p=new Yt,v=new Yt,_=new Yt,M=new Yt,b=o.inheritType?o.inheritType:0;if(o.translation&&e.setPosition(Qh.fromArray(o.translation)),o.preRotation){const K=o.preRotation.map(Co_degToRad);K.push(o.eulerOrder||Ol.DEFAULT_ORDER),t.makeRotationFromEuler(Am.fromArray(K))}if(o.rotation){const K=o.rotation.map(Co_degToRad);K.push(o.eulerOrder||Ol.DEFAULT_ORDER),n.makeRotationFromEuler(Am.fromArray(K))}if(o.postRotation){const K=o.postRotation.map(Co_degToRad);K.push(o.eulerOrder||Ol.DEFAULT_ORDER),i.makeRotationFromEuler(Am.fromArray(K)),i.invert()}o.scale&&a.scale(Qh.fromArray(o.scale)),o.scalingOffset&&u.setPosition(Qh.fromArray(o.scalingOffset)),o.scalingPivot&&c.setPosition(Qh.fromArray(o.scalingPivot)),o.rotationOffset&&d.setPosition(Qh.fromArray(o.rotationOffset)),o.rotationPivot&&p.setPosition(Qh.fromArray(o.rotationPivot)),o.parentMatrixWorld&&(_.copy(o.parentMatrix),v.copy(o.parentMatrixWorld));const A=t.clone().multiply(n).multiply(i),P=new Yt;P.extractRotation(v);const R=new Yt;R.copyPosition(v);const T=R.clone().invert().multiply(v),U=P.clone().invert().multiply(T),F=a,V=new Yt;if(0===b)V.copy(P).multiply(A).multiply(U).multiply(F);else if(1===b)V.copy(P).multiply(U).multiply(A).multiply(F);else{const Me=(new Yt).scale((new Q).setFromMatrixScale(_)).clone().invert(),De=U.clone().multiply(Me);V.copy(P).multiply(A).multiply(De).multiply(F)}const X=p.clone().invert(),Z=c.clone().invert();let q=e.clone().multiply(d).multiply(p).multiply(t).multiply(n).multiply(i).multiply(X).multiply(u).multiply(c).multiply(a).multiply(Z);const ee=(new Yt).copyPosition(q),j=v.clone().multiply(ee);return M.copyPosition(j),q=M.clone().multiply(V),q.premultiply(v.invert()),q}function fx(o){const e=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return 6===(o=o||0)?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),e[0]):e[o]}function px(o){return o.split(",").map(function(t){return parseFloat(t)})}function eE(o,e,t){return void 0===e&&(e=0),void 0===t&&(t=o.byteLength),(new TextDecoder).decode(new Uint8Array(o,e,t))}function tE(o,e,t){return o.slice(0,e).concat(t).concat(o.slice(e))}const mx="CITY_UNTRIANGULATED";let Tm=(()=>{class o{constructor(t){this.threeService=t,this.vertexShader="\n                          //vertexShader\n                          precision lowp float;\n                          varying vec2 vUv;\n                          varying vec3 vPosition;\n                          uniform float uTime;\n                          varying vec3 vNormal;\n                          void main() {\n                            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n                            vUv = uv;\n                            vPosition = position;\n                            vNormal = normalize(normalMatrix * normal);\n                        }",this.fragmentShader="\n                        //fragmentShader\n                        #define PI 3.1415926535897932384626433832795\n                        precision lowp float;\n                        uniform vec3 scanColor;\n                        varying vec2 vUv;\n                        uniform float uTime;\n                        uniform vec3 uSize;\n                        varying vec3 vPosition;\n                        varying vec3 vNormal;\n                        void main() {\n                          float dTime = mod(uTime * 25.0, uSize.z); \n                          vec3 distColor = vec3(0.5, 0.5, 0.5);\n                            float topY = vPosition.z + 10.0;\n                            if (dTime > vPosition.z && dTime < topY) {\n                                \n                                float dIndex = sin((topY - dTime) / 10.0 * PI);\n\n                                distColor = mix(distColor, scanColor,  dIndex); \n                            }\n                          \n                          gl_FragColor = vec4(vec3(distColor), 1.0);\n                          \n                        }\n                      "}ngOnInit(){const{scene:t,camera:n,renderer:i,orbit_controls:a,clock:c}=this.threeService.init();this.scene=t,this.camera=n,this.renderer=i,this.orbit_controls=a,this.clock=c,this.updaetScene(),this.renderer.render(this.scene,this.camera),this.orbit_controls.update()}updaetScene(){var t;const n=new Iv(2e3);this.scene.add(n);const i=new Ul(5,5),a=new Qi({color:16777215,side:2}),c=new Ji(i,a);c.rotation.x=-.5*Math.PI,c.position.set(0,0,0),c.receiveShadow=!0;const u=new rf(16777215);new k_(u,.2),u.position.set(1e3,1e3,1e3),u.target=c,u.castShadow=!0,this.renderer.shadowMap.enabled=!0,this.scene.add(u);const p=new ax;this.camera.far=1e4,this.camera.position.set(800,400,800),this.camera.updateProjectionMatrix(),p.load("assets/model/shanghai.FBX",v=>{this.scene.add(v),v.traverse(_=>{_.name===mx&&(this.setMaterial(_),this.aroundLine(_))})}),null===(t=document.getElementById("shanghai-container"))||void 0===t||t.appendChild(this.renderer.domElement),this.renderer.setAnimationLoop(this.animation.bind(this))}setMaterial(t){t.geometry.computeBoundingBox(),t.geometry.computeBoundingSphere();const{geometry:n}=t,{max:c,min:u}=n.boundingBox,d=new Q(c.x-u.x,c.y-u.y,c.z-u.z);t.material=new es({uniforms:{uOpacity:{value:1},uTime:{value:.1},uSize:{value:d},scanColor:{value:new ut(65280)}},vertexShader:this.vertexShader,fragmentShader:this.fragmentShader})}aroundLine(t){const n=new j0(t.geometry),i=new Q;t.getWorldPosition(i);const{max:a,min:c}=t.geometry.boundingBox,u=new Q(a.x-c.x,a.y-c.y,a.z-c.z),d=this.lineMaterial({max:a,min:c,size:u}),p=new $d(n,d);p.name="aroundLine",p.scale.copy(t.scale),p.rotation.copy(t.rotation),p.position.copy(i),this.scene.add(p)}lineMaterial({max:t,min:n}){return this.lineShaderMaterial||(this.lineShaderMaterial=new es({transparent:!0,uniforms:{uColor:{value:new ut("#ffffff")},uActive:{value:new ut("#000000")},uTime:{value:.1},uOpacity:{value:.6},uMax:{value:t},uMin:{value:n},uRange:{value:200},uSpeed:{value:.2},uStartTime:{value:.1}},vertexShader:"\n                    #define PI 3.14159265359\n\n                    uniform mediump float uStartTime;\n                    uniform mediump float uTime;\n                    uniform mediump float uRange;\n                    uniform mediump float uSpeed;\n                \n                    uniform vec3 uColor;\n                    uniform vec3 uActive;\n                    uniform vec3 uMin;\n                    uniform vec3 uMax;\n                \n                    varying vec3 vColor;\n                \n                    float lerp(float x, float y, float t) {\n                        return (1.0 - t) * x + t * y;\n                    }\n                    void main() { \n                        if (uStartTime >= 0.99) {\n                            float iTime = mod(uTime * uSpeed - uStartTime, 1.0);\n                            float rangeY = lerp(uMin.y, uMax.y, iTime);\n                            if (rangeY < position.y && rangeY > position.y - uRange) {\n                                float index = 1.0 - sin((position.y - rangeY) / uRange * PI);\n                                float r = lerp(uActive.r, uColor.r, index);\n                                float g = lerp(uActive.g, uColor.g, index);\n                                float b = lerp(uActive.b, uColor.b, index);\n                \n                                vColor = vec3(r, g, b);\n                                // vColor = vec3(0.0, 0.0, 0.0);\n                            } else {\n                                vColor = uColor;\n                            }\n                        }\n                        vec3 vPosition = vec3(position.x, position.y, position.z * uStartTime);\n                        gl_Position = projectionMatrix * modelViewMatrix * vec4(vPosition, 1.0);\n                    } \n      ",fragmentShader:"\n                    precision mediump float;\n\n                    float distanceTo(vec2 src, vec2 dst) {\n                        float dx = src.x - dst.x;\n                        float dy = src.y - dst.y;\n                        float dv = dx * dx + dy * dy;\n                        return sqrt(dv);\n                    } \n                    \n                    float lerp(float x, float y, float t) {\n                        return (1.0 - t) * x + t * y;\n                    }\n                    \n                    #define PI 3.14159265359\n                    #define PI2 6.28318530718\n                    uniform float uTime;\n                    uniform float uOpacity;\n                    uniform float uStartTime;\n\n                    varying vec3 vColor; \n\n                    void main() {\n\n                        gl_FragColor = vec4(vColor, uOpacity * uStartTime);\n                    }\n      "})),this.lineShaderMaterial}animation(){this.scene.traverse(function(t){t.name===mx&&(t.material.uniforms.uTime.value+=.02),"aroundLine"===t.name&&t.material.uniforms.uStartTime.value<1&&(t.material.uniforms.uStartTime.value+=.02)}),this.renderer.render(this.scene,this.camera)}}return o.\u0275fac=function(t){return new(t||o)(I.Y36(co))},o.\u0275cmp=I.Xpm({type:o,selectors:[["app-shanghai"]],decls:2,vars:0,consts:[[1,"flex-box"],["id","shanghai-container"]],template:function(t,n){1&t&&(I.TgZ(0,"div",0),I._UZ(1,"div",1),I.qZA())},styles:[""]}),o})();var wf,ed={Linear:{None:function(o){return o}},Quadratic:{In:function(o){return o*o},Out:function(o){return o*(2-o)},InOut:function(o){return(o*=2)<1?.5*o*o:-.5*(--o*(o-2)-1)}},Cubic:{In:function(o){return o*o*o},Out:function(o){return--o*o*o+1},InOut:function(o){return(o*=2)<1?.5*o*o*o:.5*((o-=2)*o*o+2)}},Quartic:{In:function(o){return o*o*o*o},Out:function(o){return 1- --o*o*o*o},InOut:function(o){return(o*=2)<1?.5*o*o*o*o:-.5*((o-=2)*o*o*o-2)}},Quintic:{In:function(o){return o*o*o*o*o},Out:function(o){return--o*o*o*o*o+1},InOut:function(o){return(o*=2)<1?.5*o*o*o*o*o:.5*((o-=2)*o*o*o*o+2)}},Sinusoidal:{In:function(o){return 1-Math.cos(o*Math.PI/2)},Out:function(o){return Math.sin(o*Math.PI/2)},InOut:function(o){return.5*(1-Math.cos(Math.PI*o))}},Exponential:{In:function(o){return 0===o?0:Math.pow(1024,o-1)},Out:function(o){return 1===o?1:1-Math.pow(2,-10*o)},InOut:function(o){return 0===o?0:1===o?1:(o*=2)<1?.5*Math.pow(1024,o-1):.5*(2-Math.pow(2,-10*(o-1)))}},Circular:{In:function(o){return 1-Math.sqrt(1-o*o)},Out:function(o){return Math.sqrt(1- --o*o)},InOut:function(o){return(o*=2)<1?-.5*(Math.sqrt(1-o*o)-1):.5*(Math.sqrt(1-(o-=2)*o)+1)}},Elastic:{In:function(o){return 0===o?0:1===o?1:-Math.pow(2,10*(o-1))*Math.sin(5*(o-1.1)*Math.PI)},Out:function(o){return 0===o?0:1===o?1:Math.pow(2,-10*o)*Math.sin(5*(o-.1)*Math.PI)+1},InOut:function(o){return 0===o?0:1===o?1:(o*=2)<1?-.5*Math.pow(2,10*(o-1))*Math.sin(5*(o-1.1)*Math.PI):.5*Math.pow(2,-10*(o-1))*Math.sin(5*(o-1.1)*Math.PI)+1}},Back:{In:function(o){var e=1.70158;return o*o*((e+1)*o-e)},Out:function(o){var e=1.70158;return--o*o*((e+1)*o+e)+1},InOut:function(o){var e=2.5949095;return(o*=2)<1?o*o*((e+1)*o-e)*.5:.5*((o-=2)*o*((e+1)*o+e)+2)}},Bounce:{In:function(o){return 1-ed.Bounce.Out(1-o)},Out:function(o){return o<1/2.75?7.5625*o*o:o<2/2.75?7.5625*(o-=1.5/2.75)*o+.75:o<2.5/2.75?7.5625*(o-=2.25/2.75)*o+.9375:7.5625*(o-=2.625/2.75)*o+.984375},InOut:function(o){return o<.5?.5*ed.Bounce.In(2*o):.5*ed.Bounce.Out(2*o-1)+.5}}};wf="undefined"==typeof self&&"undefined"!=typeof process&&process.hrtime?function(){var o=process.hrtime();return 1e3*o[0]+o[1]/1e6}:"undefined"!=typeof self&&void 0!==self.performance&&void 0!==self.performance.now?self.performance.now.bind(self.performance):void 0!==Date.now?Date.now:function(){return(new Date).getTime()};var o,Fc=wf,Nc=function(){function o(){this._tweens={},this._tweensAddedDuringUpdate={}}return o.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(t){return e._tweens[t]})},o.prototype.removeAll=function(){this._tweens={}},o.prototype.add=function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},o.prototype.remove=function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},o.prototype.update=function(e,t){void 0===e&&(e=Fc()),void 0===t&&(t=!1);var n=Object.keys(this._tweens);if(0===n.length)return!1;for(;n.length>0;){this._tweensAddedDuringUpdate={};for(var i=0;i<n.length;i++){var a=this._tweens[n[i]];a&&!1===a.update(e,!t)&&!t&&delete this._tweens[n[i]]}n=Object.keys(this._tweensAddedDuringUpdate)}return!0},o}(),zu={Linear:function(o,e){var t=o.length-1,n=t*e,i=Math.floor(n),a=zu.Utils.Linear;return e<0?a(o[0],o[1],n):e>1?a(o[t],o[t-1],t-n):a(o[i],o[i+1>t?t:i+1],n-i)},Bezier:function(o,e){for(var t=0,n=o.length-1,i=Math.pow,a=zu.Utils.Bernstein,c=0;c<=n;c++)t+=i(1-e,n-c)*i(e,c)*o[c]*a(n,c);return t},CatmullRom:function(o,e){var t=o.length-1,n=t*e,i=Math.floor(n),a=zu.Utils.CatmullRom;return o[0]===o[t]?(e<0&&(i=Math.floor(n=t*(1+e))),a(o[(i-1+t)%t],o[i],o[(i+1)%t],o[(i+2)%t],n-i)):e<0?o[0]-(a(o[0],o[0],o[1],o[1],-n)-o[0]):e>1?o[t]-(a(o[t],o[t],o[t-1],o[t-1],n-t)-o[t]):a(o[i?i-1:0],o[i],o[t<i+1?t:i+1],o[t<i+2?t:i+2],n-i)},Utils:{Linear:function(o,e,t){return(e-o)*t+o},Bernstein:function(o,e){var t=zu.Utils.Factorial;return t(o)/t(e)/t(o-e)},Factorial:(o=[1],function(e){var t=1;if(o[e])return o[e];for(var n=e;n>1;n--)t*=n;return o[e]=t,t}),CatmullRom:function(o,e,t,n,i){var a=.5*(t-o),c=.5*(n-e),u=i*i;return(2*e-2*t+a+c)*(i*u)+(-3*e+3*t-2*a-c)*u+a*i+e}}},Ef=function(){function o(){}return o.nextId=function(){return o._nextId++},o._nextId=0,o}(),Cm=new Nc,Zv=function(){function o(e,t){void 0===t&&(t=Cm),this._object=e,this._group=t,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=ed.Linear.None,this._interpolationFunction=zu.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._id=Ef.nextId(),this._isChainStopped=!1,this._goToEnd=!1}return o.prototype.getId=function(){return this._id},o.prototype.isPlaying=function(){return this._isPlaying},o.prototype.isPaused=function(){return this._isPaused},o.prototype.to=function(e,t){return this._valuesEnd=Object.create(e),void 0!==t&&(this._duration=t),this},o.prototype.duration=function(e){return this._duration=e,this},o.prototype.start=function(e){if(this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var t in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(t),this._valuesStart[t]=this._valuesStartRepeat[t];return this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=void 0!==e?"string"==typeof e?Fc()+parseFloat(e):e:Fc(),this._startTime+=this._delayTime,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat),this},o.prototype._setupProperties=function(e,t,n,i){for(var a in n){var c=e[a],u=Array.isArray(c),d=u?"array":typeof c,p=!u&&Array.isArray(n[a]);if("undefined"!==d&&"function"!==d){if(p){var v=n[a];if(0===v.length)continue;v=v.map(this._handleRelativeValue.bind(this,c)),n[a]=[c].concat(v)}if("object"!==d&&!u||!c||p)void 0===t[a]&&(t[a]=c),u||(t[a]*=1),i[a]=p?n[a].slice().reverse():t[a]||0;else{for(var _ in t[a]=u?[]:{},c)t[a][_]=c[_];i[a]=u?[]:{},this._setupProperties(c,t[a],n[a],i[a])}}}},o.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},o.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},o.prototype.pause=function(e){return void 0===e&&(e=Fc()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=e,this._group&&this._group.remove(this)),this},o.prototype.resume=function(e){return void 0===e&&(e=Fc()),this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this):this},o.prototype.stopChainedTweens=function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this},o.prototype.group=function(e){return this._group=e,this},o.prototype.delay=function(e){return this._delayTime=e,this},o.prototype.repeat=function(e){return this._initialRepeat=e,this._repeat=e,this},o.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},o.prototype.yoyo=function(e){return this._yoyo=e,this},o.prototype.easing=function(e){return this._easingFunction=e,this},o.prototype.interpolation=function(e){return this._interpolationFunction=e,this},o.prototype.chain=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._chainedTweens=e,this},o.prototype.onStart=function(e){return this._onStartCallback=e,this},o.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},o.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},o.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},o.prototype.onStop=function(e){return this._onStopCallback=e,this},o.prototype.update=function(e,t){if(void 0===e&&(e=Fc()),void 0===t&&(t=!0),this._isPaused)return!0;var n,i;if(!this._goToEnd&&!this._isPlaying){if(e>this._startTime+this._duration)return!1;t&&this.start(e)}if(this._goToEnd=!1,e<this._startTime)return!0;!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),i=(e-this._startTime)/this._duration;var c=this._easingFunction(i=0===this._duration||i>1?1:i);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,c),this._onUpdateCallback&&this._onUpdateCallback(this._object,i),1===i){if(this._repeat>0){for(n in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat)!this._yoyo&&"string"==typeof this._valuesEnd[n]&&(this._valuesStartRepeat[n]=this._valuesStartRepeat[n]+parseFloat(this._valuesEnd[n])),this._yoyo&&this._swapEndStartRepeatValues(n),this._valuesStart[n]=this._valuesStartRepeat[n];return this._yoyo&&(this._reversed=!this._reversed),this._startTime=void 0!==this._repeatDelayTime?e+this._repeatDelayTime:e+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),!0}this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var u=0,d=this._chainedTweens.length;u<d;u++)this._chainedTweens[u].start(this._startTime+this._duration);return this._isPlaying=!1,!1}return!0},o.prototype._updateProperties=function(e,t,n,i){for(var a in n)if(void 0!==t[a]){var c=t[a]||0,u=n[a],d=Array.isArray(e[a]),p=Array.isArray(u);!d&&p?e[a]=this._interpolationFunction(u,i):"object"==typeof u&&u?this._updateProperties(e[a],c,u,i):"number"==typeof(u=this._handleRelativeValue(c,u))&&(e[a]=c+(u-c)*i)}},o.prototype._handleRelativeValue=function(e,t){return"string"!=typeof t?t:"+"===t.charAt(0)||"-"===t.charAt(0)?e+parseFloat(t):parseFloat(t)},o.prototype._swapEndStartRepeatValues=function(e){var t=this._valuesStartRepeat[e],n=this._valuesEnd[e];this._valuesStartRepeat[e]="string"==typeof n?this._valuesStartRepeat[e]+parseFloat(n):this._valuesEnd[e],this._valuesEnd[e]=t},o}(),Po=Cm,Dm=(Po.getAll.bind(Po),Po.removeAll.bind(Po),Po.add.bind(Po),Po.remove.bind(Po),Po.update.bind(Po));function nE(o,e){if(1&o){const t=I.EpF();I.TgZ(0,"span",3),I.NdJ("click",function(){const a=I.CHM(t).$implicit;return I.oxw().handleSwitchButtonClick(a)}),I.TgZ(1,"b",4),I._uU(2),I.qZA(),I._UZ(3,"i",5),I.qZA()}if(2&o){const t=e.$implicit;I.xp6(2),I.Oqu(t.name)}}const gx=[{name:"\u5ba2\u5385",key:"living",position:new Q(0,0,0),target:new Q(0,0,5)},{name:"\u5367\u5ba4",key:"bed",position:new Q(-32,0,0),target:new Q(0,0,5)},{name:"\u4e66\u623f",key:"book",position:new Q(32,0,0),target:new Q(32,6,8)}];let vx=(()=>{class o{constructor(t){this.threeService=t,this.rooms=gx}ngOnInit(){const{scene:t,camera:n,renderer:i,orbit_controls:a,clock:c}=this.threeService.init();this.scene=t,this.camera=n,this.renderer=i,this.orbit_controls=a,this.clock=c,this.updaetScene(),this.renderer.render(this.scene,this.camera),this.orbit_controls.update(),window.addEventListener("resize",()=>{this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,2)),this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix()})}updaetScene(){var t;const n=new _v,i=new na(16,50,50),a=new Ts({map:n.load("assets/map/map_living_room.jpg"),side:1}),c=new Ji(i,a);c.position.set(0,0,0),c.rotation.y=Math.PI/2,this.scene.add(c);const u=new na(16,50,50),d=new Ts({map:n.load("assets/map/map_bed_room.jpg"),side:1}),p=new Ji(u,d);p.position.set(-32,0,0),p.rotation.y=3*Math.PI/5,this.scene.add(p);const v=new na(16,50,50),_=new Ts({map:n.load("assets/map/map_study_room.jpg"),side:1}),M=new Ji(v,_);M.position.set(32,0,0),M.rotation.y=4*Math.PI/5,this.scene.add(M),this.camera.position.x=-5,this.camera.lookAt(new Q(1,0,0)),this.orbit_controls.enablePan=!1,this.orbit_controls.maxDistance=10,this.camera.updateProjectionMatrix(),null===(t=document.getElementById("room-sphere"))||void 0===t||t.appendChild(this.renderer.domElement),this.renderer.setAnimationLoop(this.animation.bind(this))}animation(){this.orbit_controls&&this.orbit_controls.update(),Dm(),this.renderer.render(this.scene,this.camera)}handleSwitchButtonClick(t){const{x:n,y:i,z:a}=t.position,c=new Q(n,i,2),u=new Q(n,i,a);((o,e,t,n,i=2e3,a)=>{const c=new Zv({x1:o.position.x,y1:o.position.y,z1:o.position.z,x2:e.target.x,y2:e.target.y,z2:e.target.z});c.to({x1:t.x,y1:t.y,z1:t.z,x2:n.x,y2:n.y,z2:n.z},i),c.onUpdate(function(u){o.position.x=u.x1,o.position.y=u.y1,o.position.z=u.z1,e.target.x=u.x2,e.target.y=u.y2,e.target.z=u.z2,e.update()}),c.onComplete(function(){e.enabled=!0,e.update(),a()}),c.easing(ed.Cubic.InOut),c.start()})(this.camera,this.orbit_controls,c,u,1600,()=>{console.log(this.orbit_controls.target)}),this.orbit_controls.update()}sort(){for(let t=0;t<100;t++);}}return o.\u0275fac=function(t){return new(t||o)(I.Y36(co))},o.\u0275cmp=I.Xpm({type:o,selectors:[["app-room"]],decls:3,vars:1,consts:[[1,"switch"],["class","button",3,"click",4,"ngFor","ngForOf"],["id","room-sphere"],[1,"button",3,"click"],[1,"text"],[1,"icon"]],template:function(t,n){1&t&&(I.TgZ(0,"div",0),I.YNc(1,nE,4,1,"span",1),I.qZA(),I._UZ(2,"div",2)),2&t&&(I.xp6(1),I.Q6J("ngForOf",n.rooms))},directives:[G.sg],styles:[".switch[_ngcontent-%COMP%]{position:fixed;right:.5rem;top:40%;z-index:11;animation:slideInRight 1s .3s;animation-fill-mode:both}.switch[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{display:block;background:rgba(27,25,24,.5);border-radius:.5rem;display:flex;align-items:center;padding:.5rem .3rem .5rem 1rem;-webkit-backdrop-filter:blur(4px);-moz-backdrop-filter:blur(4px);backdrop-filter:blur(4px);cursor:pointer;transition:all .25s ease-in-out}.switch[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{color:#fff;font-size:1rem;font-weight:600}.switch[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:not(last-child){margin-bottom:2rem}.switch[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{display:inline-block;height:30px;width:1rem;background-size:100% 100%;transform:rotate(180deg);margin-left:8px}.switch[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:hover{background:rgba(27,25,24,.2);box-shadow:1px 1px 2px #0003}"]}),o})();function Mx(o,e){if(0===e)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),o;if(2===e||1===e){let t=o.getIndex();if(null===t){const c=[],u=o.getAttribute("position");if(void 0===u)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),o;for(let d=0;d<u.count;d++)c.push(d);o.setIndex(c),t=o.getIndex()}const n=t.count-2,i=[];if(2===e)for(let c=1;c<=n;c++)i.push(t.getX(0)),i.push(t.getX(c)),i.push(t.getX(c+1));else for(let c=0;c<n;c++)c%2==0?(i.push(t.getX(c)),i.push(t.getX(c+1)),i.push(t.getX(c+2))):(i.push(t.getX(c+2)),i.push(t.getX(c+1)),i.push(t.getX(c)));i.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const a=o.clone();return a.setIndex(i),a.clearGroups(),a}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),o}class aA extends jl{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new hA(t)}),this.register(function(t){return new y(t)}),this.register(function(t){return new w(t)}),this.register(function(t){return new D(t)}),this.register(function(t){return new fA(t)}),this.register(function(t){return new r(t)}),this.register(function(t){return new s(t)}),this.register(function(t){return new l(t)}),this.register(function(t){return new uA(t)}),this.register(function(t){return new h(t)}),this.register(function(t){return new dA(t)}),this.register(function(t){return new f(t)}),this.register(function(t){return new cA(t)}),this.register(function(t){return new L(t)}),this.register(function(t){return new B(t)})}load(e,t,n,i){const a=this;let c;c=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:Hh.extractUrlBase(e),this.manager.itemStart(e);const u=function(p){i?i(p):console.error(p),a.manager.itemError(e),a.manager.itemEnd(e)},d=new hl(this.manager);d.setPath(this.path),d.setResponseType("arraybuffer"),d.setRequestHeader(this.requestHeader),d.setWithCredentials(this.withCredentials),d.load(e,function(p){try{a.parse(p,c,function(v){t(v),a.manager.itemEnd(e)},u)}catch(v){u(v)}},n,u)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,i){let a;const c={},u={},d=new TextDecoder;if("string"==typeof e)a=JSON.parse(e);else if(e instanceof ArrayBuffer)if(d.decode(new Uint8Array(e,0,4))===W){try{c[bi.KHR_BINARY_GLTF]=new ge(e)}catch(_){return void(i&&i(_))}a=JSON.parse(c[bi.KHR_BINARY_GLTF].content)}else a=JSON.parse(d.decode(e));else a=e;if(void 0===a.asset||a.asset.version[0]<2)return void(i&&i(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const p=new qA(a,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});p.fileLoader.setRequestHeader(this.requestHeader);for(let v=0;v<this.pluginCallbacks.length;v++){const _=this.pluginCallbacks[v](p);u[_.name]=_,c[_.name]=!0}if(a.extensionsUsed)for(let v=0;v<a.extensionsUsed.length;++v){const _=a.extensionsUsed[v],M=a.extensionsRequired||[];switch(_){case bi.KHR_MATERIALS_UNLIT:c[_]=new lE;break;case bi.KHR_DRACO_MESH_COMPRESSION:c[_]=new Ve(a,this.dracoLoader);break;case bi.KHR_TEXTURE_TRANSFORM:c[_]=new at;break;case bi.KHR_MESH_QUANTIZATION:c[_]=new Rt;break;default:M.indexOf(_)>=0&&void 0===u[_]&&console.warn('THREE.GLTFLoader: Unknown extension "'+_+'".')}}p.setExtensions(c),p.setPlugins(u),p.parse(n,i)}parseAsync(e,t){const n=this;return new Promise(function(i,a){n.parse(e,t,i,a)})}}function lA(){let o={};return{get:function(e){return o[e]},add:function(e,t){o[e]=t},remove:function(e){delete o[e]},removeAll:function(){o={}}}}const bi={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class cA{constructor(e){this.parser=e,this.name=bi.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,i=t.length;n<i;n++){const a=t[n];a.extensions&&a.extensions[this.name]&&void 0!==a.extensions[this.name].light&&e._addNodeRef(this.cache,a.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let i=t.cache.get(n);if(i)return i;const a=t.json,d=((a.extensions&&a.extensions[this.name]||{}).lights||[])[e];let p;const v=new ut(16777215);void 0!==d.color&&v.fromArray(d.color);const _=void 0!==d.range?d.range:0;switch(d.type){case"directional":p=new rf(v),p.target.position.set(0,0,-1),p.add(p.target);break;case"point":p=new Kp(v),p.distance=_;break;case"spot":p=new Mv(v),p.distance=_,d.spot=d.spot||{},d.spot.innerConeAngle=void 0!==d.spot.innerConeAngle?d.spot.innerConeAngle:0,d.spot.outerConeAngle=void 0!==d.spot.outerConeAngle?d.spot.outerConeAngle:Math.PI/4,p.angle=d.spot.outerConeAngle,p.penumbra=1-d.spot.innerConeAngle/d.spot.outerConeAngle,p.target.position.set(0,0,-1),p.add(p.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+d.type)}return p.position.set(0,0,0),p.decay=2,ml(p,d),void 0!==d.intensity&&(p.intensity=d.intensity),p.name=t.createUniqueName(d.name||"light_"+e),i=Promise.resolve(p),t.cache.add(n,i),i}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,n=this.parser,a=n.json.nodes[e],u=(a.extensions&&a.extensions[this.name]||{}).light;return void 0===u?null:this._loadLight(u).then(function(d){return n._getNodeRef(t.cache,u,d)})}}class lE{constructor(){this.name=bi.KHR_MATERIALS_UNLIT}getMaterialType(){return Ts}extendParams(e,t,n){const i=[];e.color=new ut(1,1,1),e.opacity=1;const a=t.pbrMetallicRoughness;if(a){if(Array.isArray(a.baseColorFactor)){const c=a.baseColorFactor;e.color.fromArray(c),e.opacity=c[3]}void 0!==a.baseColorTexture&&i.push(n.assignTexture(e,"map",a.baseColorTexture,vn))}return Promise.all(i)}}class uA{constructor(e){this.parser=e,this.name=bi.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=i.extensions[this.name].emissiveStrength;return void 0!==a&&(t.emissiveIntensity=a),Promise.resolve()}}class hA{constructor(e){this.parser=e,this.name=bi.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?ia:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=[],c=i.extensions[this.name];if(void 0!==c.clearcoatFactor&&(t.clearcoat=c.clearcoatFactor),void 0!==c.clearcoatTexture&&a.push(n.assignTexture(t,"clearcoatMap",c.clearcoatTexture)),void 0!==c.clearcoatRoughnessFactor&&(t.clearcoatRoughness=c.clearcoatRoughnessFactor),void 0!==c.clearcoatRoughnessTexture&&a.push(n.assignTexture(t,"clearcoatRoughnessMap",c.clearcoatRoughnessTexture)),void 0!==c.clearcoatNormalTexture&&(a.push(n.assignTexture(t,"clearcoatNormalMap",c.clearcoatNormalTexture)),void 0!==c.clearcoatNormalTexture.scale)){const u=c.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Be(u,u)}return Promise.all(a)}}class dA{constructor(e){this.parser=e,this.name=bi.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?ia:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=[],c=i.extensions[this.name];return void 0!==c.iridescenceFactor&&(t.iridescence=c.iridescenceFactor),void 0!==c.iridescenceTexture&&a.push(n.assignTexture(t,"iridescenceMap",c.iridescenceTexture)),void 0!==c.iridescenceIor&&(t.iridescenceIOR=c.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==c.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=c.iridescenceThicknessMinimum),void 0!==c.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=c.iridescenceThicknessMaximum),void 0!==c.iridescenceThicknessTexture&&a.push(n.assignTexture(t,"iridescenceThicknessMap",c.iridescenceThicknessTexture)),Promise.all(a)}}class fA{constructor(e){this.parser=e,this.name=bi.KHR_MATERIALS_SHEEN}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?ia:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=[];t.sheenColor=new ut(0,0,0),t.sheenRoughness=0,t.sheen=1;const c=i.extensions[this.name];return void 0!==c.sheenColorFactor&&t.sheenColor.fromArray(c.sheenColorFactor),void 0!==c.sheenRoughnessFactor&&(t.sheenRoughness=c.sheenRoughnessFactor),void 0!==c.sheenColorTexture&&a.push(n.assignTexture(t,"sheenColorMap",c.sheenColorTexture,vn)),void 0!==c.sheenRoughnessTexture&&a.push(n.assignTexture(t,"sheenRoughnessMap",c.sheenRoughnessTexture)),Promise.all(a)}}class r{constructor(e){this.parser=e,this.name=bi.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?ia:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=[],c=i.extensions[this.name];return void 0!==c.transmissionFactor&&(t.transmission=c.transmissionFactor),void 0!==c.transmissionTexture&&a.push(n.assignTexture(t,"transmissionMap",c.transmissionTexture)),Promise.all(a)}}class s{constructor(e){this.parser=e,this.name=bi.KHR_MATERIALS_VOLUME}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?ia:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=[],c=i.extensions[this.name];t.thickness=void 0!==c.thicknessFactor?c.thicknessFactor:0,void 0!==c.thicknessTexture&&a.push(n.assignTexture(t,"thicknessMap",c.thicknessTexture)),t.attenuationDistance=c.attenuationDistance||1/0;const u=c.attenuationColor||[1,1,1];return t.attenuationColor=new ut(u[0],u[1],u[2]),Promise.all(a)}}class l{constructor(e){this.parser=e,this.name=bi.KHR_MATERIALS_IOR}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?ia:null}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=i.extensions[this.name];return t.ior=void 0!==a.ior?a.ior:1.5,Promise.resolve()}}class h{constructor(e){this.parser=e,this.name=bi.KHR_MATERIALS_SPECULAR}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?ia:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=[],c=i.extensions[this.name];t.specularIntensity=void 0!==c.specularFactor?c.specularFactor:1,void 0!==c.specularTexture&&a.push(n.assignTexture(t,"specularIntensityMap",c.specularTexture));const u=c.specularColorFactor||[1,1,1];return t.specularColor=new ut(u[0],u[1],u[2]),void 0!==c.specularColorTexture&&a.push(n.assignTexture(t,"specularColorMap",c.specularColorTexture,vn)),Promise.all(a)}}class f{constructor(e){this.parser=e,this.name=bi.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?ia:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=[],c=i.extensions[this.name];return void 0!==c.anisotropyStrength&&(t.anisotropy=c.anisotropyStrength),void 0!==c.anisotropyRotation&&(t.anisotropyRotation=c.anisotropyRotation),void 0!==c.anisotropyTexture&&a.push(n.assignTexture(t,"anisotropyMap",c.anisotropyTexture)),Promise.all(a)}}class y{constructor(e){this.parser=e,this.name=bi.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,i=n.textures[e];if(!i.extensions||!i.extensions[this.name])return null;const a=i.extensions[this.name],c=t.options.ktx2Loader;if(!c){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,a.source,c)}}class w{constructor(e){this.parser=e,this.name=bi.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,i=n.json,a=i.textures[e];if(!a.extensions||!a.extensions[t])return null;const c=a.extensions[t],u=i.images[c.source];let d=n.textureLoader;if(u.uri){const p=n.options.manager.getHandler(u.uri);null!==p&&(d=p)}return this.detectSupport().then(function(p){if(p)return n.loadTextureImage(e,c.source,d);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class D{constructor(e){this.parser=e,this.name=bi.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,i=n.json,a=i.textures[e];if(!a.extensions||!a.extensions[t])return null;const c=a.extensions[t],u=i.images[c.source];let d=n.textureLoader;if(u.uri){const p=n.options.manager.getHandler(u.uri);null!==p&&(d=p)}return this.detectSupport().then(function(p){if(p)return n.loadTextureImage(e,c.source,d);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class L{constructor(e){this.name=bi.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const i=n.extensions[this.name],a=this.parser.getDependency("buffer",i.buffer),c=this.parser.options.meshoptDecoder;if(!c||!c.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return a.then(function(u){const v=i.count,_=i.byteStride,M=new Uint8Array(u,i.byteOffset||0,i.byteLength||0);return c.decodeGltfBufferAsync?c.decodeGltfBufferAsync(v,_,M,i.mode,i.filter).then(function(b){return b.buffer}):c.ready.then(function(){const b=new ArrayBuffer(v*_);return c.decodeGltfBuffer(new Uint8Array(b),v,_,M,i.mode,i.filter),b})})}return null}}class B{constructor(e){this.name=bi.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||void 0===n.mesh)return null;const i=t.meshes[n.mesh];for(const p of i.primitives)if(p.mode!==In.TRIANGLES&&p.mode!==In.TRIANGLE_STRIP&&p.mode!==In.TRIANGLE_FAN&&void 0!==p.mode)return null;const c=n.extensions[this.name].attributes,u=[],d={};for(const p in c)u.push(this.parser.getDependency("accessor",c[p]).then(v=>(d[p]=v,d[p])));return u.length<1?null:(u.push(this.parser.createNodeMesh(e)),Promise.all(u).then(p=>{const v=p.pop(),_=v.isGroup?v.children:[v],M=p[0].count,b=[];for(const A of _){const P=new Yt,R=new Q,T=new _r,U=new Q(1,1,1),F=new bp(A.geometry,A.material,M);for(let V=0;V<M;V++)d.TRANSLATION&&R.fromBufferAttribute(d.TRANSLATION,V),d.ROTATION&&T.fromBufferAttribute(d.ROTATION,V),d.SCALE&&U.fromBufferAttribute(d.SCALE,V),F.setMatrixAt(V,P.compose(R,T,U));for(const V in d)"TRANSLATION"!==V&&"ROTATION"!==V&&"SCALE"!==V&&A.geometry.setAttribute(V,d[V]);xr.prototype.copy.call(F,A),this.parser.assignFinalMaterial(F),b.push(F)}return v.isGroup?(v.clear(),v.add(...b),v):b[0]}))}}const W="glTF";class ge{constructor(e){this.name=bi.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12),n=new TextDecoder;if(this.header={magic:n.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==W)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const i=this.header.length-12,a=new DataView(e,12);let c=0;for(;c<i;){const u=a.getUint32(c,!0);c+=4;const d=a.getUint32(c,!0);if(c+=4,1313821514===d){const p=new Uint8Array(e,12+c,u);this.content=n.decode(p)}else if(5130562===d){const p=12+c;this.body=e.slice(p,p+u)}c+=u}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Ve{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=bi.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,i=this.dracoLoader,a=e.extensions[this.name].bufferView,c=e.extensions[this.name].attributes,u={},d={},p={};for(const v in c){const _=Af[v]||v.toLowerCase();u[_]=c[v]}for(const v in e.attributes){const _=Af[v]||v.toLowerCase();if(void 0!==c[v]){const M=n.accessors[e.attributes[v]];p[_]=mi[M.componentType].name,d[_]=!0===M.normalized}}return t.getDependency("bufferView",a).then(function(v){return new Promise(function(_){i.decodeDracoFile(v,function(M){for(const b in M.attributes){const A=M.attributes[b],P=d[b];void 0!==P&&(A.normalized=P)}_(M)},u,p)})})}}class at{constructor(){this.name=bi.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(void 0===t.texCoord||t.texCoord===e.channel)&&void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class Rt{constructor(){this.name=bi.KHR_MESH_QUANTIZATION}}class Wt extends Wl{constructor(e,t,n,i){super(e,t,n,i)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,a=e*i*3+i;for(let c=0;c!==i;c++)t[c]=n[a+c];return t}interpolate_(e,t,n,i){const a=this.resultBuffer,c=this.sampleValues,u=this.valueSize,d=2*u,p=3*u,v=i-t,_=(n-t)/v,M=_*_,b=M*_,A=e*p,P=A-p,R=-2*b+3*M,T=b-M,U=1-R,F=T-M+_;for(let V=0;V!==u;V++)a[V]=U*c[P+V+u]+F*(c[P+V+d]*v)+R*c[A+V+u]+T*(c[A+V]*v);return a}}const Xe=new _r;class _n extends Wt{interpolate_(e,t,n,i){const a=super.interpolate_(e,t,n,i);return Xe.fromArray(a).normalize().toArray(a),a}}const In={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},mi={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},ho={9728:Fi,9729:Ii,9984:1004,9985:1007,9986:1005,9987:Ms},kc={33071:ri,33648:1002,10497:$i},Sf={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Af={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},pl={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},ey={CUBICSPLINE:void 0,LINEAR:Yr,STEP:Za};function ty(o){return void 0===o.DefaultMaterial&&(o.DefaultMaterial=new Gp({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:0})),o.DefaultMaterial}function Kl(o,e,t){for(const n in t.extensions)void 0===o[n]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=t.extensions[n])}function ml(o,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(o.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function WA(o,e){if(o.updateMorphTargets(),void 0!==e.weights)for(let t=0,n=e.weights.length;t<n;t++)o.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(o.morphTargetInfluences.length===t.length){o.morphTargetDictionary={};for(let n=0,i=t.length;n<i;n++)o.morphTargetDictionary[t[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function jA(o){let e;const t=o.extensions&&o.extensions[bi.KHR_DRACO_MESH_COMPRESSION];if(e=t?"draco:"+t.bufferView+":"+t.indices+":"+cE(t.attributes):o.indices+":"+cE(o.attributes)+":"+o.mode,void 0!==o.targets)for(let n=0,i=o.targets.length;n<i;n++)e+=":"+cE(o.targets[n]);return e}function cE(o){let e="";const t=Object.keys(o).sort();for(let n=0,i=t.length;n<i;n++)e+=t[n]+":"+o[t[n]]+";";return e}function uE(o){switch(o){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const XA=new Yt;class qA{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new lA,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,i=!1,a=-1;"undefined"!=typeof navigator&&(n=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),i=navigator.userAgent.indexOf("Firefox")>-1,a=i?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),this.textureLoader="undefined"==typeof createImageBitmap||n||i&&a<98?new _v(this.options.manager):new aw(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new hl(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,i=this.json,a=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(c){return c._markDefs&&c._markDefs()}),Promise.all(this._invokeAll(function(c){return c.beforeRoot&&c.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(c){const u={scene:c[0][i.scene||0],scenes:c[0],animations:c[1],cameras:c[2],asset:i.asset,parser:n,userData:{}};Kl(a,u,i),ml(u,i),Promise.all(n._invokeAll(function(d){return d.afterRoot&&d.afterRoot(u)})).then(function(){e(u)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let i=0,a=t.length;i<a;i++){const c=t[i].joints;for(let u=0,d=c.length;u<d;u++)e[c[u]].isBone=!0}for(let i=0,a=e.length;i<a;i++){const c=e[i];void 0!==c.mesh&&(this._addNodeRef(this.meshCache,c.mesh),void 0!==c.skin&&(n[c.mesh].isSkinnedMesh=!0)),void 0!==c.camera&&this._addNodeRef(this.cameraCache,c.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const i=n.clone(),a=(c,u)=>{const d=this.associations.get(c);null!=d&&this.associations.set(u,d);for(const[p,v]of c.children.entries())a(v,u.children[p])};return a(n,i),i.name+="_instance_"+e.uses[t]++,i}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const i=e(t[n]);if(i)return i}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let i=0;i<t.length;i++){const a=e(t[i]);a&&n.push(a)}return n}getDependency(e,t){const n=e+":"+t;let i=this.cache.get(n);if(!i){switch(e){case"scene":i=this.loadScene(t);break;case"node":i=this._invokeOne(function(a){return a.loadNode&&a.loadNode(t)});break;case"mesh":i=this._invokeOne(function(a){return a.loadMesh&&a.loadMesh(t)});break;case"accessor":i=this.loadAccessor(t);break;case"bufferView":i=this._invokeOne(function(a){return a.loadBufferView&&a.loadBufferView(t)});break;case"buffer":i=this.loadBuffer(t);break;case"material":i=this._invokeOne(function(a){return a.loadMaterial&&a.loadMaterial(t)});break;case"texture":i=this._invokeOne(function(a){return a.loadTexture&&a.loadTexture(t)});break;case"skin":i=this.loadSkin(t);break;case"animation":i=this._invokeOne(function(a){return a.loadAnimation&&a.loadAnimation(t)});break;case"camera":i=this.loadCamera(t);break;default:if(i=this._invokeOne(function(a){return a!=this&&a.getDependency&&a.getDependency(e,t)}),!i)throw new Error("Unknown type: "+e)}this.cache.add(n,i)}return i}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(a,c){return n.getDependency(e,c)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[bi.KHR_BINARY_GLTF].body);const i=this.options;return new Promise(function(a,c){n.load(Hh.resolveURL(t.uri,i.path),a,void 0,function(){c(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(n){const a=t.byteOffset||0;return n.slice(a,a+(t.byteLength||0))})}loadAccessor(e){const t=this,n=this.json,i=this.json.accessors[e];if(void 0===i.bufferView&&void 0===i.sparse){const c=Sf[i.type],d=!0===i.normalized,p=new(0,mi[i.componentType])(i.count*c);return Promise.resolve(new sr(p,c,d))}const a=[];return a.push(void 0!==i.bufferView?this.getDependency("bufferView",i.bufferView):null),void 0!==i.sparse&&(a.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),a.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(a).then(function(c){const u=c[0],d=Sf[i.type],p=mi[i.componentType],v=p.BYTES_PER_ELEMENT,M=i.byteOffset||0,b=void 0!==i.bufferView?n.bufferViews[i.bufferView].byteStride:void 0,A=!0===i.normalized;let P,R;if(b&&b!==v*d){const T=Math.floor(M/b),U="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+T+":"+i.count;let F=t.cache.get(U);F||(P=new p(u,T*b,i.count*b/v),F=new Fd(P,b/v),t.cache.add(U,F)),R=new Rh(F,d,M%b/v,A)}else P=null===u?new p(i.count*d):new p(u,M,i.count*d),R=new sr(P,d,A);if(void 0!==i.sparse){const V=i.sparse.values.byteOffset||0,X=new(0,mi[i.sparse.indices.componentType])(c[1],i.sparse.indices.byteOffset||0,i.sparse.count*Sf.SCALAR),Z=new p(c[2],V,i.sparse.count*d);null!==u&&(R=new sr(R.array.slice(),R.itemSize,R.normalized));for(let q=0,ee=X.length;q<ee;q++){const j=X[q];if(R.setX(j,Z[q*d]),d>=2&&R.setY(j,Z[q*d+1]),d>=3&&R.setZ(j,Z[q*d+2]),d>=4&&R.setW(j,Z[q*d+3]),d>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return R})}loadTexture(e){const t=this.json,a=t.textures[e].source,c=t.images[a];let u=this.textureLoader;if(c.uri){const d=this.options.manager.getHandler(c.uri);null!==d&&(u=d)}return this.loadTextureImage(e,a,u)}loadTextureImage(e,t,n){const i=this,a=this.json,c=a.textures[e],u=a.images[t],d=(u.uri||u.bufferView)+":"+c.sampler;if(this.textureCache[d])return this.textureCache[d];const p=this.loadImageSource(t,n).then(function(v){v.flipY=!1,v.name=c.name||u.name||"",""===v.name&&"string"==typeof u.uri&&!1===u.uri.startsWith("data:image/")&&(v.name=u.uri);const M=(a.samplers||{})[c.sampler]||{};return v.magFilter=ho[M.magFilter]||Ii,v.minFilter=ho[M.minFilter]||Ms,v.wrapS=kc[M.wrapS]||$i,v.wrapT=kc[M.wrapT]||$i,i.associations.set(v,{textures:e}),v}).catch(function(){return null});return this.textureCache[d]=p,p}loadImageSource(e,t){const i=this.json,a=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(_=>_.clone());const c=i.images[e],u=self.URL||self.webkitURL;let d=c.uri||"",p=!1;if(void 0!==c.bufferView)d=this.getDependency("bufferView",c.bufferView).then(function(_){p=!0;const M=new Blob([_],{type:c.mimeType});return d=u.createObjectURL(M),d});else if(void 0===c.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const v=Promise.resolve(d).then(function(_){return new Promise(function(M,b){let A=M;!0===t.isImageBitmapLoader&&(A=function(P){const R=new Ss(P);R.needsUpdate=!0,M(R)}),t.load(Hh.resolveURL(_,a.path),A,void 0,b)})}).then(function(_){return!0===p&&u.revokeObjectURL(d),_.userData.mimeType=c.mimeType||function $A(o){return o.search(/\.jpe?g($|\?)/i)>0||0===o.search(/^data\:image\/jpeg/)?"image/jpeg":o.search(/\.webp($|\?)/i)>0||0===o.search(/^data\:image\/webp/)?"image/webp":"image/png"}(c.uri),_}).catch(function(_){throw console.error("THREE.GLTFLoader: Couldn't load texture",d),_});return this.sourceCache[e]=v,v}assignTexture(e,t,n,i){const a=this;return this.getDependency("texture",n.index).then(function(c){if(!c)return null;if(void 0!==n.texCoord&&n.texCoord>0&&((c=c.clone()).channel=n.texCoord),a.extensions[bi.KHR_TEXTURE_TRANSFORM]){const u=void 0!==n.extensions?n.extensions[bi.KHR_TEXTURE_TRANSFORM]:void 0;if(u){const d=a.associations.get(c);c=a.extensions[bi.KHR_TEXTURE_TRANSFORM].extendTexture(c,u),a.associations.set(c,d)}}return void 0!==i&&(c.colorSpace=i),e[t]=c,c})}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const i=void 0===t.attributes.tangent,a=void 0!==t.attributes.color,c=void 0===t.attributes.normal;if(e.isPoints){const u="PointsMaterial:"+n.uuid;let d=this.cache.get(u);d||(d=new Sp,lo.prototype.copy.call(d,n),d.color.copy(n.color),d.map=n.map,d.sizeAttenuation=!1,this.cache.add(u,d)),n=d}else if(e.isLine){const u="LineBasicMaterial:"+n.uuid;let d=this.cache.get(u);d||(d=new Vs,lo.prototype.copy.call(d,n),d.color.copy(n.color),d.map=n.map,this.cache.add(u,d)),n=d}if(i||a||c){let u="ClonedMaterial:"+n.uuid+":";i&&(u+="derivative-tangents:"),a&&(u+="vertex-colors:"),c&&(u+="flat-shading:");let d=this.cache.get(u);d||(d=n.clone(),a&&(d.vertexColors=!0),c&&(d.flatShading=!0),i&&(d.normalScale&&(d.normalScale.y*=-1),d.clearcoatNormalScale&&(d.clearcoatNormalScale.y*=-1)),this.cache.add(u,d),this.associations.set(d,this.associations.get(n))),n=d}e.material=n}getMaterialType(){return Gp}loadMaterial(e){const t=this,i=this.extensions,a=this.json.materials[e];let c;const u={},p=[];if((a.extensions||{})[bi.KHR_MATERIALS_UNLIT]){const _=i[bi.KHR_MATERIALS_UNLIT];c=_.getMaterialType(),p.push(_.extendParams(u,a,t))}else{const _=a.pbrMetallicRoughness||{};if(u.color=new ut(1,1,1),u.opacity=1,Array.isArray(_.baseColorFactor)){const M=_.baseColorFactor;u.color.fromArray(M),u.opacity=M[3]}void 0!==_.baseColorTexture&&p.push(t.assignTexture(u,"map",_.baseColorTexture,vn)),u.metalness=void 0!==_.metallicFactor?_.metallicFactor:1,u.roughness=void 0!==_.roughnessFactor?_.roughnessFactor:1,void 0!==_.metallicRoughnessTexture&&(p.push(t.assignTexture(u,"metalnessMap",_.metallicRoughnessTexture)),p.push(t.assignTexture(u,"roughnessMap",_.metallicRoughnessTexture))),c=this._invokeOne(function(M){return M.getMaterialType&&M.getMaterialType(e)}),p.push(Promise.all(this._invokeAll(function(M){return M.extendMaterialParams&&M.extendMaterialParams(e,u)})))}!0===a.doubleSided&&(u.side=2);const v=a.alphaMode||"OPAQUE";if("BLEND"===v?(u.transparent=!0,u.depthWrite=!1):(u.transparent=!1,"MASK"===v&&(u.alphaTest=void 0!==a.alphaCutoff?a.alphaCutoff:.5)),void 0!==a.normalTexture&&c!==Ts&&(p.push(t.assignTexture(u,"normalMap",a.normalTexture)),u.normalScale=new Be(1,1),void 0!==a.normalTexture.scale)){const _=a.normalTexture.scale;u.normalScale.set(_,_)}return void 0!==a.occlusionTexture&&c!==Ts&&(p.push(t.assignTexture(u,"aoMap",a.occlusionTexture)),void 0!==a.occlusionTexture.strength&&(u.aoMapIntensity=a.occlusionTexture.strength)),void 0!==a.emissiveFactor&&c!==Ts&&(u.emissive=(new ut).fromArray(a.emissiveFactor)),void 0!==a.emissiveTexture&&c!==Ts&&p.push(t.assignTexture(u,"emissiveMap",a.emissiveTexture,vn)),Promise.all(p).then(function(){const _=new c(u);return a.name&&(_.name=a.name),ml(_,a),t.associations.set(_,{materials:e}),a.extensions&&Kl(i,_,a),_})}createUniqueName(e){const t=Mi.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,n=this.extensions,i=this.primitiveCache;function a(u){return n[bi.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(u,t).then(function(d){return pA(d,u,t)})}const c=[];for(let u=0,d=e.length;u<d;u++){const p=e[u],v=jA(p),_=i[v];if(_)c.push(_.promise);else{let M;M=p.extensions&&p.extensions[bi.KHR_DRACO_MESH_COMPRESSION]?a(p):pA(new Un,p,t),i[v]={primitive:p,promise:M},c.push(M)}}return Promise.all(c)}loadMesh(e){const t=this,i=this.extensions,a=this.json.meshes[e],c=a.primitives,u=[];for(let d=0,p=c.length;d<p;d++){const v=void 0===c[d].material?ty(this.cache):this.getDependency("material",c[d].material);u.push(v)}return u.push(t.loadGeometries(c)),Promise.all(u).then(function(d){const p=d.slice(0,d.length-1),v=d[d.length-1],_=[];for(let b=0,A=v.length;b<A;b++){const P=v[b],R=c[b];let T;const U=p[b];if(R.mode===In.TRIANGLES||R.mode===In.TRIANGLE_STRIP||R.mode===In.TRIANGLE_FAN||void 0===R.mode)T=!0===a.isSkinnedMesh?new wu(P,U):new Ji(P,U),!0===T.isSkinnedMesh&&T.normalizeSkinWeights(),R.mode===In.TRIANGLE_STRIP?T.geometry=Mx(T.geometry,1):R.mode===In.TRIANGLE_FAN&&(T.geometry=Mx(T.geometry,2));else if(R.mode===In.LINES)T=new $d(P,U);else if(R.mode===In.LINE_STRIP)T=new zl(P,U);else if(R.mode===In.LINE_LOOP)T=new ev(P,U);else{if(R.mode!==In.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+R.mode);T=new nv(P,U)}Object.keys(T.geometry.morphAttributes).length>0&&WA(T,a),T.name=t.createUniqueName(a.name||"mesh_"+e),ml(T,a),R.extensions&&Kl(i,T,R),t.assignFinalMaterial(T),_.push(T)}for(let b=0,A=_.length;b<A;b++)t.associations.set(_[b],{meshes:e,primitives:b});if(1===_.length)return a.extensions&&Kl(i,_[0],a),_[0];const M=new ol;a.extensions&&Kl(i,M,a),t.associations.set(M,{meshes:e});for(let b=0,A=_.length;b<A;b++)M.add(_[b]);return M})}loadCamera(e){let t;const n=this.json.cameras[e],i=n[n.type];if(i)return"perspective"===n.type?t=new ts(Co_radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):"orthographic"===n.type&&(t=new yh(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),ml(t,n),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],n=[];for(let i=0,a=t.joints.length;i<a;i++)n.push(this._loadNodeShallow(t.joints[i]));return n.push(void 0!==t.inverseBindMatrices?this.getDependency("accessor",t.inverseBindMatrices):null),Promise.all(n).then(function(i){const a=i.pop(),c=i,u=[],d=[];for(let p=0,v=c.length;p<v;p++){const _=c[p];if(_){u.push(_);const M=new Yt;null!==a&&M.fromArray(a.array,16*p),d.push(M)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[p])}return new Ac(u,d)})}loadAnimation(e){const n=this,i=this.json.animations[e],a=i.name?i.name:"animation_"+e,c=[],u=[],d=[],p=[],v=[];for(let _=0,M=i.channels.length;_<M;_++){const b=i.channels[_],A=i.samplers[b.sampler],P=b.target,R=P.node,T=void 0!==i.parameters?i.parameters[A.input]:A.input,U=void 0!==i.parameters?i.parameters[A.output]:A.output;void 0!==P.node&&(c.push(this.getDependency("node",R)),u.push(this.getDependency("accessor",T)),d.push(this.getDependency("accessor",U)),p.push(A),v.push(P))}return Promise.all([Promise.all(c),Promise.all(u),Promise.all(d),Promise.all(p),Promise.all(v)]).then(function(_){const M=_[0],b=_[1],A=_[2],P=_[3],R=_[4],T=[];for(let U=0,F=M.length;U<F;U++){const V=M[U],X=b[U],Z=A[U],q=P[U],ee=R[U];if(void 0===V)continue;V.updateMatrix&&V.updateMatrix();const j=n._createAnimationTracks(V,X,Z,q,ee);if(j)for(let K=0;K<j.length;K++)T.push(j[K])}return new Vh(a,void 0,T)})}createNodeMesh(e){const n=this,i=this.json.nodes[e];return void 0===i.mesh?null:n.getDependency("mesh",i.mesh).then(function(a){const c=n._getNodeRef(n.meshCache,i.mesh,a);return void 0!==i.weights&&c.traverse(function(u){if(u.isMesh)for(let d=0,p=i.weights.length;d<p;d++)u.morphTargetInfluences[d]=i.weights[d]}),c})}loadNode(e){const n=this,i=this.json.nodes[e],a=n._loadNodeShallow(e),c=[],u=i.children||[];for(let p=0,v=u.length;p<v;p++)c.push(n.getDependency("node",u[p]));const d=void 0===i.skin?Promise.resolve(null):n.getDependency("skin",i.skin);return Promise.all([a,Promise.all(c),d]).then(function(p){const v=p[0],_=p[1],M=p[2];null!==M&&v.traverse(function(b){!b.isSkinnedMesh||b.bind(M,XA)});for(let b=0,A=_.length;b<A;b++)v.add(_[b]);return v})}_loadNodeShallow(e){const n=this.extensions,i=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];const a=this.json.nodes[e],c=a.name?i.createUniqueName(a.name):"",u=[],d=i._invokeOne(function(p){return p.createNodeMesh&&p.createNodeMesh(e)});return d&&u.push(d),void 0!==a.camera&&u.push(i.getDependency("camera",a.camera).then(function(p){return i._getNodeRef(i.cameraCache,a.camera,p)})),i._invokeAll(function(p){return p.createNodeAttachment&&p.createNodeAttachment(e)}).forEach(function(p){u.push(p)}),this.nodeCache[e]=Promise.all(u).then(function(p){let v;if(v=!0===a.isBone?new Ph:p.length>1?new ol:1===p.length?p[0]:new xr,v!==p[0])for(let _=0,M=p.length;_<M;_++)v.add(p[_]);if(a.name&&(v.userData.name=a.name,v.name=c),ml(v,a),a.extensions&&Kl(n,v,a),void 0!==a.matrix){const _=new Yt;_.fromArray(a.matrix),v.applyMatrix4(_)}else void 0!==a.translation&&v.position.fromArray(a.translation),void 0!==a.rotation&&v.quaternion.fromArray(a.rotation),void 0!==a.scale&&v.scale.fromArray(a.scale);return i.associations.has(v)||i.associations.set(v,{}),i.associations.get(v).nodes=e,v}),this.nodeCache[e]}loadScene(e){const t=this.extensions,n=this.json.scenes[e],i=this,a=new ol;n.name&&(a.name=i.createUniqueName(n.name)),ml(a,n),n.extensions&&Kl(t,a,n);const c=n.nodes||[],u=[];for(let d=0,p=c.length;d<p;d++)u.push(i.getDependency("node",c[d]));return Promise.all(u).then(function(d){for(let v=0,_=d.length;v<_;v++)a.add(d[v]);return i.associations=(v=>{const _=new Map;for(const[M,b]of i.associations)(M instanceof lo||M instanceof Ss)&&_.set(M,b);return v.traverse(M=>{const b=i.associations.get(M);null!=b&&_.set(M,b)}),_})(a),a})}_createAnimationTracks(e,t,n,i,a){const c=[],u=e.name?e.name:e.uuid,d=[];let p;switch(pl[a.path]===pl.weights?e.traverse(function(M){M.morphTargetInfluences&&d.push(M.name?M.name:M.uuid)}):d.push(u),pl[a.path]){case pl.weights:p=Dc;break;case pl.rotation:p=sa;break;case pl.position:case pl.scale:p=Pu;break;default:p=1===n.itemSize?Dc:Pu}const v=void 0!==i.interpolation?ey[i.interpolation]:Yr,_=this._getArrayFromAccessor(n);for(let M=0,b=d.length;M<b;M++){const A=new p(d[M]+"."+pl[a.path],t.array,_,v);"CUBICSPLINE"===i.interpolation&&this._createCubicSplineTrackInterpolant(A),c.push(A)}return c}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const n=uE(t.constructor),i=new Float32Array(t.length);for(let a=0,c=t.length;a<c;a++)i[a]=t[a]*n;t=i}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(n){return new(this instanceof sa?_n:Wt)(this.times,this.values,this.getValueSize()/3,n)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function pA(o,e,t){const n=e.attributes,i=[];function a(c,u){return t.getDependency("accessor",c).then(function(d){o.setAttribute(u,d)})}for(const c in n){const u=Af[c]||c.toLowerCase();u in o.attributes||i.push(a(n[c],u))}if(void 0!==e.indices&&!o.index){const c=t.getDependency("accessor",e.indices).then(function(u){o.setIndex(u)});i.push(c)}return ml(o,e),function YA(o,e,t){const n=e.attributes,i=new tl;if(void 0===n.POSITION)return;{const u=t.json.accessors[n.POSITION],d=u.min,p=u.max;if(void 0===d||void 0===p)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(i.set(new Q(d[0],d[1],d[2]),new Q(p[0],p[1],p[2])),u.normalized){const v=uE(mi[u.componentType]);i.min.multiplyScalar(v),i.max.multiplyScalar(v)}}const a=e.targets;if(void 0!==a){const u=new Q,d=new Q;for(let p=0,v=a.length;p<v;p++){const _=a[p];if(void 0!==_.POSITION){const M=t.json.accessors[_.POSITION],b=M.min,A=M.max;if(void 0!==b&&void 0!==A){if(d.setX(Math.max(Math.abs(b[0]),Math.abs(A[0]))),d.setY(Math.max(Math.abs(b[1]),Math.abs(A[1]))),d.setZ(Math.max(Math.abs(b[2]),Math.abs(A[2]))),M.normalized){const P=uE(mi[M.componentType]);d.multiplyScalar(P)}u.max(d)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}i.expandByVector(u)}o.boundingBox=i;const c=new Yo;i.getCenter(c.center),c.radius=i.min.distanceTo(i.max)/2,o.boundingSphere=c}(o,e,t),Promise.all(i).then(function(){return void 0!==e.targets?function ny(o,e,t){let n=!1,i=!1,a=!1;for(let p=0,v=e.length;p<v;p++){const _=e[p];if(void 0!==_.POSITION&&(n=!0),void 0!==_.NORMAL&&(i=!0),void 0!==_.COLOR_0&&(a=!0),n&&i&&a)break}if(!n&&!i&&!a)return Promise.resolve(o);const c=[],u=[],d=[];for(let p=0,v=e.length;p<v;p++){const _=e[p];if(n){const M=void 0!==_.POSITION?t.getDependency("accessor",_.POSITION):o.attributes.position;c.push(M)}if(i){const M=void 0!==_.NORMAL?t.getDependency("accessor",_.NORMAL):o.attributes.normal;u.push(M)}if(a){const M=void 0!==_.COLOR_0?t.getDependency("accessor",_.COLOR_0):o.attributes.color;d.push(M)}}return Promise.all([Promise.all(c),Promise.all(u),Promise.all(d)]).then(function(p){const _=p[1],M=p[2];return n&&(o.morphAttributes.position=p[0]),i&&(o.morphAttributes.normal=_),a&&(o.morphAttributes.color=M),o.morphTargetsRelative=!0,o})}(o,e.targets,t):o})}const mA={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor = opacity * texel;\n\n\n\t\t}"};class iy{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const ZA=new yh(-1,1,1,-1,0,1),hE=new Un;hE.setAttribute("position",new qt([-1,3,0,-1,-1,0,3,-1,0],3)),hE.setAttribute("uv",new qt([0,2,0,0,2,0],2));class gA{constructor(e){this._mesh=new Ji(hE,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,ZA)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class KA extends iy{constructor(e,t){super(),this.textureID=void 0!==t?t:"tDiffuse",e instanceof es?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=xc.clone(e.uniforms),this.material=new es({name:void 0!==e.name?e.name:"unspecified",defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new gA(this.material)}render(e,t,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class vA extends iy{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,n){const i=e.getContext(),a=e.state;let c,u;a.buffers.color.setMask(!1),a.buffers.depth.setMask(!1),a.buffers.color.setLocked(!0),a.buffers.depth.setLocked(!0),this.inverse?(c=0,u=1):(c=1,u=0),a.buffers.stencil.setTest(!0),a.buffers.stencil.setOp(i.REPLACE,i.REPLACE,i.REPLACE),a.buffers.stencil.setFunc(i.ALWAYS,c,4294967295),a.buffers.stencil.setClear(u),a.buffers.stencil.setLocked(!0),e.setRenderTarget(n),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),a.buffers.color.setLocked(!1),a.buffers.depth.setLocked(!1),a.buffers.color.setMask(!0),a.buffers.depth.setMask(!0),a.buffers.stencil.setLocked(!1),a.buffers.stencil.setFunc(i.EQUAL,1,4294967295),a.buffers.stencil.setOp(i.KEEP,i.KEEP,i.KEEP),a.buffers.stencil.setLocked(!0)}}class JA extends iy{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class QA{constructor(e,t){if(this.renderer=e,this._pixelRatio=e.getPixelRatio(),void 0===t){const n=e.getSize(new Be);this._width=n.width,this._height=n.height,(t=new ba(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:_o})).texture.name="EffectComposer.rt1"}else this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new KA(mA),this.copyPass.material.blending=0,this.clock=new em}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);-1!==t&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){void 0===e&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let n=!1;for(let i=0,a=this.passes.length;i<a;i++){const c=this.passes[i];if(!1!==c.enabled){if(c.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(i),c.render(this.renderer,this.writeBuffer,this.readBuffer,e,n),c.needsSwap){if(n){const u=this.renderer.getContext(),d=this.renderer.state.buffers.stencil;d.setFunc(u.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),d.setFunc(u.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==vA&&(c instanceof vA?n=!0:c instanceof JA&&(n=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(void 0===e){const t=this.renderer.getSize(new Be);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const n=this._width*this._pixelRatio,i=this._height*this._pixelRatio;this.renderTarget1.setSize(n,i),this.renderTarget2.setSize(n,i);for(let a=0;a<this.passes.length;a++)this.passes[a].setSize(n,i)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}class eT extends iy{constructor(e,t,n,i,a){super(),this.scene=e,this.camera=t,this.overrideMaterial=n,this.clearColor=i,this.clearAlpha=void 0!==a?a:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new ut}render(e,t,n){const i=e.autoClear;let a,c;e.autoClear=!1,void 0!==this.overrideMaterial&&(c=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(e.getClearColor(this._oldClearColor),a=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:n),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(this._oldClearColor,a),void 0!==this.overrideMaterial&&(this.scene.overrideMaterial=c),e.autoClear=i}}const tT={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new ut(0)},defaultOpacity:{value:0}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform vec3 defaultColor;\n\t\tuniform float defaultOpacity;\n\t\tuniform float luminosityThreshold;\n\t\tuniform float smoothWidth;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\n\t\t\tvec3 luma = vec3( 0.299, 0.587, 0.114 );\n\n\t\t\tfloat v = dot( texel.xyz, luma );\n\n\t\t\tvec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );\n\n\t\t\tfloat alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );\n\n\t\t\tgl_FragColor = mix( outputColor, texel, alpha );\n\n\t\t}"};class Rm extends iy{constructor(e,t,n,i){super(),this.strength=void 0!==t?t:1,this.radius=n,this.threshold=i,this.resolution=void 0!==e?new Be(e.x,e.y):new Be(256,256),this.clearColor=new ut(0,0,0),this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let a=Math.round(this.resolution.x/2),c=Math.round(this.resolution.y/2);this.renderTargetBright=new ba(a,c,{type:_o}),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let _=0;_<this.nMips;_++){const M=new ba(a,c,{type:_o});M.texture.name="UnrealBloomPass.h"+_,M.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(M);const b=new ba(a,c,{type:_o});b.texture.name="UnrealBloomPass.v"+_,b.texture.generateMipmaps=!1,this.renderTargetsVertical.push(b),a=Math.round(a/2),c=Math.round(c/2)}const u=tT;this.highPassUniforms=xc.clone(u.uniforms),this.highPassUniforms.luminosityThreshold.value=i,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new es({uniforms:this.highPassUniforms,vertexShader:u.vertexShader,fragmentShader:u.fragmentShader}),this.separableBlurMaterials=[];const d=[3,5,7,9,11];a=Math.round(this.resolution.x/2),c=Math.round(this.resolution.y/2);for(let _=0;_<this.nMips;_++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(d[_])),this.separableBlurMaterials[_].uniforms.invSize.value=new Be(1/a,1/c),a=Math.round(a/2),c=Math.round(c/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=t,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],this.bloomTintColors=[new Q(1,1,1),new Q(1,1,1),new Q(1,1,1),new Q(1,1,1),new Q(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors;const v=mA;this.copyUniforms=xc.clone(v.uniforms),this.blendMaterial=new es({uniforms:this.copyUniforms,vertexShader:v.vertexShader,fragmentShader:v.fragmentShader,blending:2,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new ut,this.oldClearAlpha=1,this.basic=new Ts,this.fsQuad=new gA(null)}dispose(){for(let e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(let e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose();for(let e=0;e<this.separableBlurMaterials.length;e++)this.separableBlurMaterials[e].dispose();this.compositeMaterial.dispose(),this.blendMaterial.dispose(),this.basic.dispose(),this.fsQuad.dispose()}setSize(e,t){let n=Math.round(e/2),i=Math.round(t/2);this.renderTargetBright.setSize(n,i);for(let a=0;a<this.nMips;a++)this.renderTargetsHorizontal[a].setSize(n,i),this.renderTargetsVertical[a].setSize(n,i),this.separableBlurMaterials[a].uniforms.invSize.value=new Be(1/n,1/i),n=Math.round(n/2),i=Math.round(i/2)}render(e,t,n,i,a){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const c=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),a&&e.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=n.texture,e.setRenderTarget(null),e.clear(),this.fsQuad.render(e)),this.highPassUniforms.tDiffuse.value=n.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,e.setRenderTarget(this.renderTargetBright),e.clear(),this.fsQuad.render(e);let u=this.renderTargetBright;for(let d=0;d<this.nMips;d++)this.fsQuad.material=this.separableBlurMaterials[d],this.separableBlurMaterials[d].uniforms.colorTexture.value=u.texture,this.separableBlurMaterials[d].uniforms.direction.value=Rm.BlurDirectionX,e.setRenderTarget(this.renderTargetsHorizontal[d]),e.clear(),this.fsQuad.render(e),this.separableBlurMaterials[d].uniforms.colorTexture.value=this.renderTargetsHorizontal[d].texture,this.separableBlurMaterials[d].uniforms.direction.value=Rm.BlurDirectionY,e.setRenderTarget(this.renderTargetsVertical[d]),e.clear(),this.fsQuad.render(e),u=this.renderTargetsVertical[d];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.setRenderTarget(this.renderTargetsHorizontal[0]),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.blendMaterial,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,a&&e.state.buffers.stencil.setTest(!0),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(n),this.fsQuad.render(e)),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=c}getSeperableBlurMaterial(e){const t=[];for(let n=0;n<e;n++)t.push(.39894*Math.exp(-.5*n*n/(e*e))/e);return new es({defines:{KERNEL_RADIUS:e},uniforms:{colorTexture:{value:null},invSize:{value:new Be(.5,.5)},direction:{value:new Be(.5,.5)},gaussianCoefficients:{value:t}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 invSize;\n\t\t\t\tuniform vec2 direction;\n\t\t\t\tuniform float gaussianCoefficients[KERNEL_RADIUS];\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tfloat weightSum = gaussianCoefficients[0];\n\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv ).rgb * weightSum;\n\t\t\t\t\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\n\t\t\t\t\t\tfloat x = float(i);\n\t\t\t\t\t\tfloat w = gaussianCoefficients[i];\n\t\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\n\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset ).rgb;\n\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset ).rgb;\n\t\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\n\t\t\t\t\t\tweightSum += 2.0 * w;\n\t\t\t\t\t}\n\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n\t\t\t\t}"})}getCompositeMaterial(e){return new es({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\t\t\t\tuniform sampler2D blurTexture1;\n\t\t\t\tuniform sampler2D blurTexture2;\n\t\t\t\tuniform sampler2D blurTexture3;\n\t\t\t\tuniform sampler2D blurTexture4;\n\t\t\t\tuniform sampler2D blurTexture5;\n\t\t\t\tuniform float bloomStrength;\n\t\t\t\tuniform float bloomRadius;\n\t\t\t\tuniform float bloomFactors[NUM_MIPS];\n\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\n\n\t\t\t\tfloat lerpBloomFactor(const in float factor) {\n\t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\n\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tgl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\n\t\t\t\t}"})}}Rm.BlurDirectionX=new Be(1,0),Rm.BlurDirectionY=new Be(0,1);const nT=[{path:"",component:cr,children:[{path:"star",component:bw},{path:"cube",component:Ew},{path:"shanghai",component:Tm},{path:"room",component:vx},{path:"gltf",component:(()=>{class o{constructor(t){this.threeService=t}ngOnInit(){const{scene:t,camera:n,renderer:i,orbit_controls:a,clock:c}=this.threeService.init();this.scene=t,this.camera=n,this.renderer=i,this.orbit_controls=a,this.clock=c,this.updaetScene(),this.renderer.render(this.scene,this.camera),this.orbit_controls.update(),this.renderer.setClearColor(4386,1),this.renderer.setPixelRatio(window.devicePixelRatio)}updaetScene(){var t;const n=new aA;n.load("assets/model/gltf/road.glb",a=>{this.scene.add(a.scene)}),n.load("assets/model/gltf/building_A.glb",a=>{this.scene.add(a.scene)}),n.load("assets/model/gltf/building_B.glb",a=>{this.scene.add(a.scene)}),n.load("assets/model/gltf/building_C.glb",a=>{this.scene.add(a.scene)}),n.load("assets/model/gltf/building_D.glb",a=>{this.scene.add(a.scene)}),n.load("assets/model/gltf/building_Park.glb",a=>{this.scene.add(a.scene)}),n.load("assets/model/gltf/other_building.glb",a=>{const c=a.scene.getObjectByName("\u5176\u4f59\u5efa\u7b51003");c.position.set(17,0,-30);const u=c.clone();u.position.set(-17,0,-30);const d=c.clone();d.position.set(40,0,-30);const p=c.clone();p.position.set(-40,0,-30),a.scene.add(u,d,p),this.scene.add(a.scene)}),n.load("assets/model/gltf/tree.glb",a=>{this.scene.add(a.scene)}),n.load("assets/model/gltf/\u8def\u706f.glb",a=>{this.scene.add(a.scene)}),n.load("assets/model/gltf/\u8f66\u4f4d\u8f66\u8f86.glb",a=>{this.scene.add(a.scene),new Zv({angle:0}).to({angle:.75*Math.PI},8e3).onUpdate(d=>{this.camera.position.x=50*Math.cos(d.angle),this.camera.position.z=50*Math.sin(d.angle),this.camera.lookAt(0,0,0)}).start(),this.initBloom()});const i=new Jp(16777215,.4);this.scene.add(i),this.camera.position.set(100,50,0),this.camera.lookAt(new Q(0,0,0)),this.orbit_controls.enablePan=!1,this.camera.updateProjectionMatrix(),null===(t=document.getElementById("park"))||void 0===t||t.appendChild(this.renderer.domElement),this.renderer.setAnimationLoop(this.animation.bind(this))}animation(){this.orbit_controls&&this.orbit_controls.update(),Dm(),this.composer?this.composer.render():this.renderer.render(this.scene,this.camera)}initBloom(){const t=new eT(this.scene,this.camera),n=new Rm(new Be(window.innerWidth,window.innerHeight),1.5,.4,.85);n.threshold=.6,n.strength=1.5,n.radius=.4,this.composer=new QA(this.renderer),this.composer.addPass(t),this.composer.addPass(n)}}return o.\u0275fac=function(t){return new(t||o)(I.Y36(co))},o.\u0275cmp=I.Xpm({type:o,selectors:[["app-gltf"]],decls:1,vars:0,consts:[["id","park"]],template:function(t,n){1&t&&I._UZ(0,"div",0)},styles:[""]}),o})()}]}];let iT=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=I.oAB({type:o}),o.\u0275inj=I.cJS({imports:[[ro.Bz.forChild(nT)],ro.Bz]}),o})(),rT=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=I.oAB({type:o}),o.\u0275inj=I.cJS({providers:[co],imports:[[G.ez,iT,$r,io.forRoot({loader:vr})]]}),o})()},8830:(an,Je,ie)=>{var G=ie(2313),I=ie(1223),Te=ie(6324),et={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0},Ge={duration:1e3,delay:0,endDelay:0,easing:"easeOutElastic(1, .5)",round:0},kt=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],mt={CSS:{},springs:{}};function It(E,S,m){return Math.min(Math.max(E,S),m)}function zt(E,S){return E.indexOf(S)>-1}function rt(E,S){return E.apply(null,S)}var ye={arr:function(E){return Array.isArray(E)},obj:function(E){return zt(Object.prototype.toString.call(E),"Object")},pth:function(E){return ye.obj(E)&&E.hasOwnProperty("totalLength")},svg:function(E){return E instanceof SVGElement},inp:function(E){return E instanceof HTMLInputElement},dom:function(E){return E.nodeType||ye.svg(E)},str:function(E){return"string"==typeof E},fnc:function(E){return"function"==typeof E},und:function(E){return void 0===E},nil:function(E){return ye.und(E)||null===E},hex:function(E){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(E)},rgb:function(E){return/^rgb/.test(E)},hsl:function(E){return/^hsl/.test(E)},col:function(E){return ye.hex(E)||ye.rgb(E)||ye.hsl(E)},key:function(E){return!et.hasOwnProperty(E)&&!Ge.hasOwnProperty(E)&&"targets"!==E&&"keyframes"!==E}};function gt(E){var S=/\(([^)]+)\)/.exec(E);return S?S[1].split(",").map(function(m){return parseFloat(m)}):[]}function zn(E,S){var m=gt(E),g=It(ye.und(m[0])?1:m[0],.1,100),x=It(ye.und(m[1])?100:m[1],.1,100),C=It(ye.und(m[2])?10:m[2],.1,100),O=It(ye.und(m[3])?0:m[3],.1,100),z=Math.sqrt(x/g),H=C/(2*Math.sqrt(x*g)),ne=H<1?z*Math.sqrt(1-H*H):0,Ie=H<1?(H*z-O)/ne:-O+z;function yt(Jt){var $t=S?S*Jt/1e3:Jt;return $t=H<1?Math.exp(-$t*H*z)*(1*Math.cos(ne*$t)+Ie*Math.sin(ne*$t)):(1+Ie*$t)*Math.exp(-$t*z),0===Jt||1===Jt?Jt:1-$t}return S?yt:function Et(){var Jt=mt.springs[E];if(Jt)return Jt;for(var $t=1/6,Gn=0,Ti=0;;)if(1===yt(Gn+=$t)){if(++Ti>=16)break}else Ti=0;var yr=Gn*$t*1e3;return mt.springs[E]=yr,yr}}function st(E){return void 0===E&&(E=10),function(S){return Math.ceil(It(S,1e-6,1)*E)*(1/E)}}var E,S,Jn=function(){var S=.1;function m(ue,Ie){return 1-3*Ie+3*ue}function g(ue,Ie){return 3*Ie-6*ue}function x(ue){return 3*ue}function C(ue,Ie,yt){return((m(Ie,yt)*ue+g(Ie,yt))*ue+x(Ie))*ue}function O(ue,Ie,yt){return 3*m(Ie,yt)*ue*ue+2*g(Ie,yt)*ue+x(Ie)}return function ne(ue,Ie,yt,Et){if(0<=ue&&ue<=1&&0<=yt&&yt<=1){var Jt=new Float32Array(11);if(ue!==Ie||yt!==Et)for(var $t=0;$t<11;++$t)Jt[$t]=C($t*S,ue,yt);return function(Ti){return ue===Ie&&yt===Et||0===Ti||1===Ti?Ti:C(function Gn(Ti){for(var yr=0,Cn=1;10!==Cn&&Jt[Cn]<=Ti;++Cn)yr+=S;--Cn;var ws=yr+(Ti-Jt[Cn])/(Jt[Cn+1]-Jt[Cn])*S,Xi=O(ws,ue,yt);return Xi>=.001?function H(ue,Ie,yt,Et){for(var Jt=0;Jt<4;++Jt){var $t=O(Ie,yt,Et);if(0===$t)return Ie;Ie-=(C(Ie,yt,Et)-ue)/$t}return Ie}(Ti,ws,ue,yt):0===Xi?ws:function z(ue,Ie,yt,Et,Jt){var $t,Gn,Ti=0;do{($t=C(Gn=Ie+(yt-Ie)/2,Et,Jt)-ue)>0?yt=Gn:Ie=Gn}while(Math.abs($t)>1e-7&&++Ti<10);return Gn}(Ti,yr,yr+S,ue,yt)}(Ti),Ie,Et)}}}}(),Qe=(E={linear:function(){return function(g){return g}}},S={Sine:function(){return function(g){return 1-Math.cos(g*Math.PI/2)}},Circ:function(){return function(g){return 1-Math.sqrt(1-g*g)}},Back:function(){return function(g){return g*g*(3*g-2)}},Bounce:function(){return function(g){for(var x,C=4;g<((x=Math.pow(2,--C))-1)/11;);return 1/Math.pow(4,3-C)-7.5625*Math.pow((3*x-2)/22-g,2)}},Elastic:function(g,x){void 0===g&&(g=1),void 0===x&&(x=.5);var C=It(g,1,10),O=It(x,.1,2);return function(z){return 0===z||1===z?z:-C*Math.pow(2,10*(z-1))*Math.sin((z-1-O/(2*Math.PI)*Math.asin(1/C))*(2*Math.PI)/O)}}},["Quad","Cubic","Quart","Quint","Expo"].forEach(function(g,x){S[g]=function(){return function(C){return Math.pow(C,x+2)}}}),Object.keys(S).forEach(function(g){var x=S[g];E["easeIn"+g]=x,E["easeOut"+g]=function(C,O){return function(z){return 1-x(C,O)(1-z)}},E["easeInOut"+g]=function(C,O){return function(z){return z<.5?x(C,O)(2*z)/2:1-x(C,O)(-2*z+2)/2}},E["easeOutIn"+g]=function(C,O){return function(z){return z<.5?(1-x(C,O)(1-2*z))/2:(x(C,O)(2*z-1)+1)/2}}}),E);function pn(E,S){if(ye.fnc(E))return E;var m=E.split("(")[0],g=Qe[m],x=gt(E);switch(m){case"spring":return zn(E,S);case"cubicBezier":return rt(Jn,x);case"steps":return rt(st,x);default:return rt(g,x)}}function Xn(E){try{return document.querySelectorAll(E)}catch(m){return}}function Fn(E,S){for(var m=E.length,g=arguments.length>=2?arguments[1]:void 0,x=[],C=0;C<m;C++)if(C in E){var O=E[C];S.call(g,O,C,E)&&x.push(O)}return x}function Pt(E){return E.reduce(function(S,m){return S.concat(ye.arr(m)?Pt(m):m)},[])}function Ot(E){return ye.arr(E)?E:(ye.str(E)&&(E=Xn(E)||E),E instanceof NodeList||E instanceof HTMLCollection?[].slice.call(E):[E])}function dt(E,S){return E.some(function(m){return m===S})}function vt(E){var S={};for(var m in E)S[m]=E[m];return S}function jn(E,S){var m=vt(E);for(var g in E)m[g]=S.hasOwnProperty(g)?S[g]:E[g];return m}function qe(E,S){var m=vt(E);for(var g in S)m[g]=ye.und(E[g])?S[g]:E[g];return m}function Dt(E){var S=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(E);if(S)return S[1]}function en(E,S){return ye.fnc(E)?E(S.target,S.id,S.total):E}function Sr(E,S){return E.getAttribute(S)}function rn(E,S,m){if(dt([m,"deg","rad","turn"],Dt(S)))return S;var x=mt.CSS[S+m];if(!ye.und(x))return x;var O=document.createElement(E.tagName),z=E.parentNode&&E.parentNode!==document?E.parentNode:document.body;z.appendChild(O),O.style.position="absolute",O.style.width=100+m;var H=100/O.offsetWidth;z.removeChild(O);var ne=H*parseFloat(S);return mt.CSS[S+m]=ne,ne}function Tt(E,S,m){if(S in E.style){var g=S.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),x=E.style[S]||getComputedStyle(E).getPropertyValue(g)||"0";return m?rn(E,x,m):x}}function Ee(E,S){return ye.dom(E)&&!ye.inp(E)&&(!ye.nil(Sr(E,S))||ye.svg(E)&&E[S])?"attribute":ye.dom(E)&&dt(kt,S)?"transform":ye.dom(E)&&"transform"!==S&&Tt(E,S)?"css":null!=E[S]?"object":void 0}function Ae(E){if(ye.dom(E)){for(var x,S=E.style.transform||"",m=/(\w+)\(([^)]*)\)/g,g=new Map;x=m.exec(S);)g.set(x[1],x[2]);return g}}function Ue(E,S,m,g){switch(Ee(E,S)){case"transform":return function ke(E,S,m,g){var x=zt(S,"scale")?1:0+function gn(E){return zt(E,"translate")||"perspective"===E?"px":zt(E,"rotate")||zt(E,"skew")?"deg":void 0}(S),C=Ae(E).get(S)||x;return m&&(m.transforms.list.set(S,C),m.transforms.last=S),g?rn(E,C,g):C}(E,S,g,m);case"css":return Tt(E,S,m);case"attribute":return Sr(E,S);default:return E[S]||0}}function Mt(E,S){var m=/^(\*=|\+=|-=)/.exec(E);if(!m)return E;var g=Dt(E)||0,x=parseFloat(S),C=parseFloat(E.replace(m[0],""));switch(m[0][0]){case"+":return x+C+g;case"-":return x-C+g;case"*":return x*C+g}}function ot(E,S){if(ye.col(E))return function $n(E){return ye.rgb(E)?function Ft(E){var S=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(E);return S?"rgba("+S[1]+",1)":E}(E):ye.hex(E)?function cn(E){var m=E.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(z,H,ne,ue){return H+H+ne+ne+ue+ue}),g=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(m);return"rgba("+parseInt(g[1],16)+","+parseInt(g[2],16)+","+parseInt(g[3],16)+",1)"}(E):ye.hsl(E)?function mn(E){var z,H,ne,S=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(E)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(E),m=parseInt(S[1],10)/360,g=parseInt(S[2],10)/100,x=parseInt(S[3],10)/100,C=S[4]||1;function O(yt,Et,Jt){return Jt<0&&(Jt+=1),Jt>1&&(Jt-=1),Jt<1/6?yt+6*(Et-yt)*Jt:Jt<.5?Et:Jt<2/3?yt+(Et-yt)*(2/3-Jt)*6:yt}if(0==g)z=H=ne=x;else{var ue=x<.5?x*(1+g):x+g-x*g,Ie=2*x-ue;z=O(Ie,ue,m+1/3),H=O(Ie,ue,m),ne=O(Ie,ue,m-1/3)}return"rgba("+255*z+","+255*H+","+255*ne+","+C+")"}(E):void 0}(E);if(/\s/g.test(E))return E;var m=Dt(E),g=m?E.substr(0,E.length-m.length):E;return S?g+S:g}function Kt(E,S){return Math.sqrt(Math.pow(S.x-E.x,2)+Math.pow(S.y-E.y,2))}function Nt(E){for(var g,S=E.points,m=0,x=0;x<S.numberOfItems;x++){var C=S.getItem(x);x>0&&(m+=Kt(g,C)),g=C}return m}function hi(E){if(E.getTotalLength)return E.getTotalLength();switch(E.tagName.toLowerCase()){case"circle":return function Dn(E){return 2*Math.PI*Sr(E,"r")}(E);case"rect":return function un(E){return 2*Sr(E,"width")+2*Sr(E,"height")}(E);case"line":return function lt(E){return Kt({x:Sr(E,"x1"),y:Sr(E,"y1")},{x:Sr(E,"x2"),y:Sr(E,"y2")})}(E);case"polyline":return Nt(E);case"polygon":return function Si(E){var S=E.points;return Nt(E)+Kt(S.getItem(S.numberOfItems-1),S.getItem(0))}(E)}}function ar(E,S){var m=S||{},g=m.el||function Or(E){for(var S=E.parentNode;ye.svg(S)&&ye.svg(S.parentNode);)S=S.parentNode;return S}(E),x=g.getBoundingClientRect(),C=Sr(g,"viewBox"),O=x.width,z=x.height,H=m.viewBox||(C?C.split(" "):[0,0,O,z]);return{el:g,viewBox:H,x:H[0]/1,y:H[1]/1,w:O,h:z,vW:H[2],vH:H[3]}}function Hs(E,S,m){function g(ue){return void 0===ue&&(ue=0),E.el.getPointAtLength(S+ue>=1?S+ue:0)}var x=ar(E.el,E.svg),C=g(),O=g(-1),z=g(1),H=m?1:x.w/x.vW,ne=m?1:x.h/x.vH;switch(E.property){case"x":return(C.x-x.x)*H;case"y":return(C.y-x.y)*ne;case"angle":return 180*Math.atan2(z.y-O.y,z.x-O.x)/Math.PI}}function Bc(E,S){var m=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,g=ot(ye.pth(E)?E.totalLength:E,S)+"";return{original:g,numbers:g.match(m)?g.match(m).map(Number):[0],strings:ye.str(E)||S?g.split(m):[]}}function Zi(E){return Fn(E?Pt(ye.arr(E)?E.map(Ot):Ot(E)):[],function(m,g,x){return x.indexOf(m)===g})}function fo(E){var S=Zi(E);return S.map(function(m,g){return{target:m,id:g,total:S.length,transforms:{list:Ae(m)}}})}function Fo(E,S){var m=vt(S);if(/^spring/.test(m.easing)&&(m.duration=zn(m.easing)),ye.arr(E)){var g=E.length;2!==g||ye.obj(E[0])?ye.fnc(S.duration)||(m.duration=S.duration/g):E={value:E}}var C=ye.arr(E)?E:[E];return C.map(function(O,z){var H=ye.obj(O)&&!ye.pth(O)?O:{value:O};return ye.und(H.delay)&&(H.delay=z?0:S.delay),ye.und(H.endDelay)&&(H.endDelay=z===C.length-1?S.endDelay:0),H}).map(function(O){return qe(O,m)})}var Fr={css:function(E,S,m){return E.style[S]=m},attribute:function(E,S,m){return E.setAttribute(S,m)},object:function(E,S,m){return E[S]=m},transform:function(E,S,m,g,x){if(g.list.set(S,m),S===g.last||x){var C="";g.list.forEach(function(O,z){C+=z+"("+O+") "}),E.style.transform=C}}};function oi(E,S){fo(E).forEach(function(g){for(var x in S){var C=en(S[x],g),O=g.target,z=Dt(C),H=Ue(O,x,z,g),ue=Mt(ot(C,z||Dt(H)),H),Ie=Ee(O,x);Fr[Ie](O,x,ue,g.transforms,!0)}})}function _t(E,S){return Fn(Pt(E.map(function(m){return S.map(function(g){return function tn(E,S){var m=Ee(E.target,S.name);if(m){var g=function hn(E,S){var m;return E.tweens.map(function(g){var x=function Jl(E,S){var m={};for(var g in E){var x=en(E[g],S);ye.arr(x)&&1===(x=x.map(function(C){return en(C,S)})).length&&(x=x[0]),m[g]=x}return m.duration=parseFloat(m.duration),m.delay=parseFloat(m.delay),m}(g,S),C=x.value,O=ye.arr(C)?C[1]:C,z=Dt(O),H=Ue(S.target,E.name,z,S),ne=m?m.to.original:H,ue=ye.arr(C)?C[0]:ne,Ie=Dt(ue)||Dt(H),yt=z||Ie;return ye.und(O)&&(O=ne),x.from=Bc(ue,yt),x.to=Bc(Mt(O,ue),yt),x.start=m?m.end:0,x.end=x.start+x.delay+x.duration+x.endDelay,x.easing=pn(x.easing,x.duration),x.isPath=ye.pth(C),x.isPathTargetInsideSVG=x.isPath&&ye.svg(S.target),x.isColor=ye.col(x.from.original),x.isColor&&(x.round=1),m=x,x})}(S,E),x=g[g.length-1];return{type:m,property:S.name,animatable:E,tweens:g,duration:x.end,delay:g[0].delay,endDelay:x.endDelay}}}(m,g)})})),function(m){return!ye.und(m)})}function za(E,S){var m=E.length,g=function(C){return C.timelineOffset?C.timelineOffset:0},x={};return x.duration=m?Math.max.apply(Math,E.map(function(C){return g(C)+C.duration})):S.duration,x.delay=m?Math.min.apply(Math,E.map(function(C){return g(C)+C.delay})):S.delay,x.endDelay=m?x.duration-Math.max.apply(Math,E.map(function(C){return g(C)+C.duration-C.endDelay})):S.endDelay,x}var er=0,lr=[],Wi=function(){var E;function m(x){for(var C=lr.length,O=0;O<C;){var z=lr[O];z.paused?(lr.splice(O,1),C--):(z.tick(x),O++)}E=O>0?requestAnimationFrame(m):void 0}return"undefined"!=typeof document&&document.addEventListener("visibilitychange",function g(){!An.suspendWhenDocumentHidden||(Is()?E=cancelAnimationFrame(E):(lr.forEach(function(x){return x._onDocumentVisibility()}),Wi()))}),function S(){!E&&(!Is()||!An.suspendWhenDocumentHidden)&&lr.length>0&&(E=requestAnimationFrame(m))}}();function Is(){return!!document&&document.hidden}function An(E){void 0===E&&(E={});var x,S=0,m=0,g=0,C=0,O=null;function z(Cn){var Rn=window.Promise&&new Promise(function(Zr){return O=Zr});return Cn.finished=Rn,Rn}var H=function ki(E){var S=jn(et,E),m=jn(Ge,E),g=function Va(E,S){var m=[],g=S.keyframes;for(var x in g&&(S=qe(function No(E){for(var S=Fn(Pt(E.map(function(C){return Object.keys(C)})),function(C){return ye.key(C)}).reduce(function(C,O){return C.indexOf(O)<0&&C.push(O),C},[]),m={},g=function(C){var O=S[C];m[O]=E.map(function(z){var H={};for(var ne in z)ye.key(ne)?ne==O&&(H.value=z[ne]):H[ne]=z[ne];return H})},x=0;x<S.length;x++)g(x);return m}(g),S)),S)ye.key(x)&&m.push({name:x,tweens:Fo(S[x],E)});return m}(m,E),x=fo(E.targets),C=_t(x,g),O=za(C,m),z=er;return er++,qe(S,{id:z,children:[],animatables:x,animations:C,duration:O.duration,delay:O.delay,endDelay:O.endDelay})}(E);function ue(){var Cn=H.direction;"alternate"!==Cn&&(H.direction="normal"!==Cn?"normal":"reverse"),H.reversed=!H.reversed,x.forEach(function(Rn){return Rn.reversed=H.reversed})}function Ie(Cn){return H.reversed?H.duration-Cn:Cn}function yt(){S=0,m=Ie(H.currentTime)*(1/An.speed)}function Et(Cn,Rn){Rn&&Rn.seek(Cn-Rn.timelineOffset)}function $t(Cn){for(var Rn=0,Zr=H.animations,ws=Zr.length;Rn<ws;){var Xi=Zr[Rn],eu=Xi.animatable,Ka=Xi.tweens,jo=Ka.length-1,qi=Ka[jo];jo&&(qi=Fn(Ka,function(dr){return Cn<dr.end})[0]||qi);for(var Ja=It(Cn-qi.start-qi.delay,0,qi.duration)/qi.duration,Ma=isNaN(Ja)?1:qi.easing(Ja),tu=qi.to.strings,Cl=qi.round,Pm=[],Pf=qi.to.numbers.length,Pi=void 0,qs=0;qs<Pf;qs++){var Dl=void 0,Rl=qi.to.numbers[qs],cs=qi.from.numbers[qs]||0;Dl=qi.isPath?Hs(qi.value,Ma*Rl,qi.isPathTargetInsideSVG):cs+Ma*(Rl-cs),Cl&&(qi.isColor&&qs>2||(Dl=Math.round(Dl*Cl)/Cl)),Pm.push(Dl)}var Lf=tu.length;if(Lf){Pi=tu[0];for(var $o=0;$o<Lf;$o++){var Hr=tu[$o+1],Ki=Pm[$o];isNaN(Ki)||(Pi+=Hr?Ki+Hr:Ki+" ")}}else Pi=Pm[0];Fr[Xi.type](eu.target,Xi.property,Pi,eu.transforms),Xi.currentValue=Pi,Rn++}}function Gn(Cn){H[Cn]&&!H.passThrough&&H[Cn](H)}function yr(Cn){var Rn=H.duration,Zr=H.delay,ws=Rn-H.endDelay,Xi=Ie(Cn);H.progress=It(Xi/Rn*100,0,100),H.reversePlayback=Xi<H.currentTime,x&&function Jt(Cn){if(H.reversePlayback)for(var Zr=C;Zr--;)Et(Cn,x[Zr]);else for(var Rn=0;Rn<C;Rn++)Et(Cn,x[Rn])}(Xi),!H.began&&H.currentTime>0&&(H.began=!0,Gn("begin")),!H.loopBegan&&H.currentTime>0&&(H.loopBegan=!0,Gn("loopBegin")),Xi<=Zr&&0!==H.currentTime&&$t(0),(Xi>=ws&&H.currentTime!==Rn||!Rn)&&$t(Rn),Xi>Zr&&Xi<ws?(H.changeBegan||(H.changeBegan=!0,H.changeCompleted=!1,Gn("changeBegin")),Gn("change"),$t(Xi)):H.changeBegan&&(H.changeCompleted=!0,H.changeBegan=!1,Gn("changeComplete")),H.currentTime=It(Xi,0,Rn),H.began&&Gn("update"),Cn>=Rn&&(m=0,function Ti(){H.remaining&&!0!==H.remaining&&H.remaining--}(),H.remaining?(S=g,Gn("loopComplete"),H.loopBegan=!1,"alternate"===H.direction&&ue()):(H.paused=!0,H.completed||(H.completed=!0,Gn("loopComplete"),Gn("complete"),!H.passThrough&&"Promise"in window&&(O(),z(H)))))}return z(H),H.reset=function(){var Cn=H.direction;H.passThrough=!1,H.currentTime=0,H.progress=0,H.paused=!0,H.began=!1,H.loopBegan=!1,H.changeBegan=!1,H.completed=!1,H.changeCompleted=!1,H.reversePlayback=!1,H.reversed="reverse"===Cn,H.remaining=H.loop;for(var Rn=C=(x=H.children).length;Rn--;)H.children[Rn].reset();(H.reversed&&!0!==H.loop||"alternate"===Cn&&1===H.loop)&&H.remaining++,$t(H.reversed?H.duration:0)},H._onDocumentVisibility=yt,H.set=function(Cn,Rn){return oi(Cn,Rn),H},H.tick=function(Cn){g=Cn,S||(S=g),yr((g+(m-S))*An.speed)},H.seek=function(Cn){yr(Ie(Cn))},H.pause=function(){H.paused=!0,yt()},H.play=function(){!H.paused||(H.completed&&H.reset(),H.paused=!1,lr.push(H),yt(),Wi())},H.reverse=function(){ue(),H.completed=!H.reversed,yt()},H.restart=function(){H.reset(),H.play()},H.remove=function(Cn){ai(Zi(Cn),H)},H.reset(),H.autoplay&&H.play(),H}function is(E,S){for(var m=S.length;m--;)dt(E,S[m].animatable.target)&&S.splice(m,1)}function ai(E,S){var m=S.animations,g=S.children;is(E,m);for(var x=g.length;x--;){var C=g[x],O=C.animations;is(E,O),!O.length&&!C.children.length&&g.splice(x,1)}!m.length&&!g.length&&S.pause()}An.version="3.2.1",An.speed=1,An.suspendWhenDocumentHidden=!0,An.running=lr,An.remove=function vl(E){for(var S=Zi(E),m=lr.length;m--;)ai(S,lr[m])},An.get=Ue,An.set=oi,An.convertPx=rn,An.path=function fs(E,S){var m=ye.str(E)?Xn(E)[0]:E,g=S||100;return function(x){return{property:x,el:m,svg:ar(m),totalLength:hi(m)*(g/100)}}},An.setDashoffset=function di(E){var S=hi(E);return E.setAttribute("stroke-dasharray",S),S},An.stagger=function fi(E,S){void 0===S&&(S={});var m=S.direction||"normal",g=S.easing?pn(S.easing):null,x=S.grid,C=S.axis,O=S.from||0,z="first"===O,H="center"===O,ne="last"===O,ue=ye.arr(E),Ie=parseFloat(ue?E[0]:E),yt=ue?parseFloat(E[1]):0,Et=Dt(ue?E[1]:E)||0,Jt=S.start||0+(ue?Ie:0),$t=[],Gn=0;return function(Ti,yr,Cn){if(z&&(O=0),H&&(O=(Cn-1)/2),ne&&(O=Cn-1),!$t.length){for(var Rn=0;Rn<Cn;Rn++){if(x){var Zr=H?(x[0]-1)/2:O%x[0],ws=H?(x[1]-1)/2:Math.floor(O/x[0]),Ka=Zr-Rn%x[0],jo=ws-Math.floor(Rn/x[0]),qi=Math.sqrt(Ka*Ka+jo*jo);"x"===C&&(qi=-Ka),"y"===C&&(qi=-jo),$t.push(qi)}else $t.push(Math.abs(O-Rn));Gn=Math.max.apply(Math,$t)}g&&($t=$t.map(function(Ma){return g(Ma/Gn)*Gn})),"reverse"===m&&($t=$t.map(function(Ma){return C?Ma<0?-1*Ma:-Ma:Math.abs(Gn-Ma)}))}return Jt+(ue?(yt-Ie)/Gn:Ie)*(Math.round(100*$t[yr])/100)+Et}},An.timeline=function Gu(E){void 0===E&&(E={});var S=An(E);return S.duration=0,S.add=function(m,g){var x=lr.indexOf(S),C=S.children;function O(yt){yt.passThrough=!0}x>-1&&lr.splice(x,1);for(var z=0;z<C.length;z++)O(C[z]);var H=qe(m,jn(Ge,E));H.targets=H.targets||E.targets;var ne=S.duration;H.autoplay=!1,H.direction=S.direction,H.timelineOffset=ye.und(g)?ne:Mt(g,ne),O(S),S.seek(H.timelineOffset);var ue=An(H);O(ue),C.push(ue);var Ie=za(C,E);return S.delay=Ie.delay,S.endDelay=Ie.endDelay,S.duration=Ie.duration,S.seek(0),S.reset(),S.autoplay&&S.play(),S},S},An.easing=pn,An.penner=Qe,An.random=function(E,S){return Math.floor(Math.random()*(S-E+1))+E};const Li=An,ti=[{path:"",redirectTo:"index",pathMatch:"full"},{path:"index",component:(()=>{class E{constructor(m){this.router=m}ngOnInit(){Li({targets:".twitter",translateX:100,direction:"alternate",easing:"easeInOutQuad"})}}return E.\u0275fac=function(m){return new(m||E)(I.Y36(Te.F0))},E.\u0275cmp=I.Xpm({type:E,selectors:[["app-index"]],decls:83,vars:0,consts:[["role","banner",1,"toolbar"],["aria-label","Angular on YouTube","target","_blank","rel","noopener","href","https://youtube.com","title","YouTube"],["id","youtube-logo","height","24","width","24","data-name","Logo","xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","#fff"],["d","M0 0h24v24H0V0z","fill","none"],["d","M21.58 7.19c-.23-.86-.91-1.54-1.77-1.77C18.25 5 12 5 12 5s-6.25 0-7.81.42c-.86.23-1.54.91-1.77 1.77C2 8.75 2 12 2 12s0 3.25.42 4.81c.23.86.91 1.54 1.77 1.77C5.75 19 12 19 12 19s6.25 0 7.81-.42c.86-.23 1.54-.91 1.77-1.77C22 15.25 22 12 22 12s0-3.25-.42-4.81zM10 15V9l5.2 3-5.2 3z"],["aria-label","Angular on twitter","target","_blank","rel","noopener","href","https://twitter.com","title","Twitter",1,"twitter"],["id","twitter-logo","height","24","data-name","Logo","xmlns","http://www.w3.org/2000/svg","viewBox","0 0 400 400"],["width","400","height","400","fill","none"],["d","M153.62,301.59c94.34,0,145.94-78.16,145.94-145.94,0-2.22,0-4.43-.15-6.63A104.36,104.36,0,0,0,325,122.47a102.38,102.38,0,0,1-29.46,8.07,51.47,51.47,0,0,0,22.55-28.37,102.79,102.79,0,0,1-32.57,12.45,51.34,51.34,0,0,0-87.41,46.78A145.62,145.62,0,0,1,92.4,107.81a51.33,51.33,0,0,0,15.88,68.47A50.91,50.91,0,0,1,85,169.86c0,.21,0,.43,0,.65a51.31,51.31,0,0,0,41.15,50.28,51.21,51.21,0,0,1-23.16.88,51.35,51.35,0,0,0,47.92,35.62,102.92,102.92,0,0,1-63.7,22A104.41,104.41,0,0,1,75,278.55a145.21,145.21,0,0,0,78.62,23","fill","#fff"],[1,"spacer"],[1,"tips"],["role","main",1,"content"],[1,"card","highlight-card","card-small"],["id","rocket-smoke","xmlns","http://www.w3.org/2000/svg","width","516.119","height","1083.632","viewBox","0 0 516.119 1083.632"],["id","Path_40","data-name","Path 40","d","M644.6,141S143.02,215.537,147.049,870.207s342.774,201.755,342.774,201.755S404.659,847.213,388.815,762.2c-27.116-145.51-11.551-384.124,271.9-609.1C671.15,139.365,644.6,141,644.6,141Z","transform","translate(-147.025 -140.939)","fill","#f5f5f5"],[1,"card-container"],["rel","noopener","routerLink","/shader/gltf",1,"card"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24",1,"material-icons"],["d","M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"],["d","M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"],["target","_blank","rel","noopener","href","https://angular.io/tutorial",1,"card"],["d","M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82zM12 3L1 9l11 6 9-4.91V17h2V9L12 3z"],["target","_blank","rel","noopener","href","https://material.angular.io",1,"card"],["xmlns","http://www.w3.org/2000/svg","width","21.813","height","23.453","viewBox","0 0 21.813 23.453",2,"margin-right","8px"],["d","M4099.584,972.736h0l-10.882,3.9,1.637,14.4,9.245,5.153,9.245-5.153,1.686-14.4Z","transform","translate(-4088.702 -972.736)","fill","#808080"],["d","M4181.516,972.736v23.453l9.245-5.153,1.686-14.4Z","transform","translate(-4170.633 -972.736)","fill","#808080"],["d","M4137.529,1076.127l-7.7-3.723,4.417-2.721,7.753,3.723Z","transform","translate(-4125.003 -1058.315)","fill","#ffe0b2"],["d","M4137.529,1051.705l-7.7-3.723,4.417-2.721,7.753,3.723Z","transform","translate(-4125.003 -1036.757)","fill","#fff3e0"],["d","M4137.529,1027.283l-7.7-3.723,4.417-2.721,7.753,3.723Z","transform","translate(-4125.003 -1015.199)","fill","#fff"],["target","_blank","rel","noopener","href","https://blog.angular.io/",1,"card"],["d","M13.5.67s.74 2.65.74 4.8c0 2.06-1.35 3.73-3.41 3.73-2.07 0-3.63-1.67-3.63-3.73l.03-.36C5.21 7.51 4 10.62 4 14c0 4.42 3.58 8 8 8s8-3.58 8-8C20 8.61 17.41 3.8 13.5.67zM11.71 19c-1.78 0-3.22-1.4-3.22-3.14 0-1.62 1.05-2.76 2.81-3.12 1.77-.36 3.6-1.21 4.62-2.58.39 1.29.59 2.65.59 4.04 0 2.65-2.15 4.8-4.8 4.8z"],["target","_blank","rel","noopener","href","https://angular.io/devtools/",1,"card"],["xmlns","http://www.w3.org/2000/svg","enable-background","new 0 0 24 24","height","24px","viewBox","0 0 24 24","width","24px","fill","#000000",1,"material-icons"],["fill","none","height","24","width","24"],["d","M14.73,13.31C15.52,12.24,16,10.93,16,9.5C16,5.91,13.09,3,9.5,3S3,5.91,3,9.5C3,13.09,5.91,16,9.5,16 c1.43,0,2.74-0.48,3.81-1.27L19.59,21L21,19.59L14.73,13.31z M9.5,14C7.01,14,5,11.99,5,9.5S7.01,5,9.5,5S14,7.01,14,9.5 S11.99,14,9.5,14z"],["points","10.29,8.44 9.5,6 8.71,8.44 6.25,8.44 8.26,10.03 7.49,12.5 9.5,10.97 11.51,12.5 10.74,10.03 12.75,8.44"],["href","https://github.com/February3O","target","_blank","rel","noopener"],[1,"github-star-badge"],["d","M0 0h24v24H0z","fill","none"],["d","M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"],["d","M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z","fill","#1976d2"],["id","clouds","xmlns","http://www.w3.org/2000/svg","width","2611.084","height","485.677","viewBox","0 0 2611.084 485.677"],["id","Path_39","data-name","Path 39","d","M2379.709,863.793c10-93-77-171-168-149-52-114-225-105-264,15-75,3-140,59-152,133-30,2.83-66.725,9.829-93.5,26.25-26.771-16.421-63.5-23.42-93.5-26.25-12-74-77-130-152-133-39-120-212-129-264-15-54.084-13.075-106.753,9.173-138.488,48.9-31.734-39.726-84.4-61.974-138.487-48.9-52-114-225-105-264,15a162.027,162.027,0,0,0-103.147,43.044c-30.633-45.365-87.1-72.091-145.206-58.044-52-114-225-105-264,15-75,3-140,59-152,133-53,5-127,23-130,83-2,42,35,72,70,86,49,20,106,18,157,5a165.625,165.625,0,0,0,120,0c47,94,178,113,251,33,61.112,8.015,113.854-5.72,150.492-29.764a165.62,165.62,0,0,0,110.861-3.236c47,94,178,113,251,33,31.385,4.116,60.563,2.495,86.487-3.311,25.924,5.806,55.1,7.427,86.488,3.311,73,80,204,61,251-33a165.625,165.625,0,0,0,120,0c51,13,108,15,157-5a147.188,147.188,0,0,0,33.5-18.694,147.217,147.217,0,0,0,33.5,18.694c49,20,106,18,157,5a165.625,165.625,0,0,0,120,0c47,94,178,113,251,33C2446.709,1093.793,2554.709,922.793,2379.709,863.793Z","transform","translate(142.69 -634.312)","fill","#eee"]],template:function(m,g){1&m&&(I.TgZ(0,"div",0)(1,"a",1),I.O4$(),I.TgZ(2,"svg",2),I._UZ(3,"path",3)(4,"path",4),I.qZA()(),I.kcU(),I.TgZ(5,"a",5),I.O4$(),I.TgZ(6,"svg",6),I._UZ(7,"rect",7)(8,"path",8),I.qZA()(),I.kcU(),I._UZ(9,"div",9),I.TgZ(10,"span",10),I._uU(11,"Welcome"),I.qZA()(),I.TgZ(12,"div",11)(13,"div",12)(14,"span"),I._uU(15,"hello world!"),I.qZA(),I.O4$(),I.TgZ(16,"svg",13)(17,"title"),I._uU(18,"Rocket Ship Smoke"),I.qZA(),I._UZ(19,"path",14),I.qZA()(),I.kcU(),I.TgZ(20,"div",15)(21,"a",16),I.O4$(),I.TgZ(22,"svg",17),I._UZ(23,"path",18),I.qZA(),I.kcU(),I.TgZ(24,"span"),I._uU(25,"Shader"),I.qZA(),I.O4$(),I.TgZ(26,"svg",17),I._UZ(27,"path",19),I.qZA()(),I.kcU(),I.TgZ(28,"a",20),I.O4$(),I.TgZ(29,"svg",17),I._UZ(30,"path",21),I.qZA(),I.kcU(),I.TgZ(31,"span"),I._uU(32,"Learn"),I.qZA(),I.O4$(),I.TgZ(33,"svg",17),I._UZ(34,"path",19),I.qZA()(),I.kcU(),I.TgZ(35,"a",22),I.O4$(),I.TgZ(36,"svg",23),I._UZ(37,"path",24)(38,"path",25)(39,"path",26)(40,"path",27)(41,"path",28),I.qZA(),I.kcU(),I.TgZ(42,"span"),I._uU(43,"Material"),I.qZA(),I.O4$(),I.TgZ(44,"svg",17),I._UZ(45,"path",19),I.qZA()(),I.kcU(),I.TgZ(46,"a",29),I.O4$(),I.TgZ(47,"svg",17),I._UZ(48,"path",30),I.qZA(),I.kcU(),I.TgZ(49,"span"),I._uU(50,"Blog"),I.qZA(),I.O4$(),I.TgZ(51,"svg",17),I._UZ(52,"path",19),I.qZA()(),I.kcU(),I.TgZ(53,"a",31),I.O4$(),I.TgZ(54,"svg",32)(55,"g"),I._UZ(56,"rect",33),I.qZA(),I.TgZ(57,"g")(58,"g"),I._UZ(59,"path",34)(60,"polygon",35),I.qZA()()(),I.kcU(),I.TgZ(61,"span"),I._uU(62,"DevTools"),I.qZA(),I.O4$(),I.TgZ(63,"svg",17),I._UZ(64,"path",19),I.qZA()()(),I.kcU(),I._UZ(65,"div",15)(66,"div",15),I.TgZ(67,"footer"),I._uU(68," GitHub?\xa0 "),I.TgZ(69,"a",36)(70,"div",37),I.O4$(),I.TgZ(71,"svg",17),I._UZ(72,"path",38)(73,"path",39),I.qZA(),I._uU(74," Star "),I.qZA()(),I.kcU(),I.TgZ(75,"a",36),I.O4$(),I.TgZ(76,"svg",17),I._UZ(77,"path",40)(78,"path",38),I.qZA()()(),I.TgZ(79,"svg",41)(80,"title"),I._uU(81,"Gray Clouds Background"),I.qZA(),I._UZ(82,"path",42),I.qZA()())},directives:[Te.yS],styles:["",""]}),E})()},{path:"shader",loadChildren:()=>Promise.resolve().then(ie.bind(ie,3890)).then(E=>E.ShaderModule)}];let Gs=(()=>{class E{}return E.\u0275fac=function(m){return new(m||E)},E.\u0275mod=I.oAB({type:E}),E.\u0275inj=I.cJS({imports:[[Te.Bz.forRoot(ti,{useHash:!0})],Te.Bz]}),E})(),ps=(()=>{class E{constructor(){this.title="docs"}ngOnInit(){}}return E.\u0275fac=function(m){return new(m||E)},E.\u0275cmp=I.Xpm({type:E,selectors:[["app-root"]],decls:1,vars:0,template:function(m,g){1&m&&I._UZ(0,"router-outlet")},directives:[Te.lC],styles:[""]}),E})();var Ps=ie(3890),Ks=ie(9808);ie(2076),ie(8306),ie(4742),ie(8421),ie(7669),ie(5403),ie(3268),ie(1810),ie(4004);let Cr=(()=>{class E{}return E.\u0275fac=function(m){return new(m||E)},E.\u0275mod=I.oAB({type:E}),E.\u0275inj=I.cJS({}),E})(),Tl=(()=>{class E{}return E.\u0275fac=function(m){return new(m||E)},E.\u0275mod=I.oAB({type:E}),E.\u0275inj=I.cJS({imports:[[Cr]]}),E})(),Wo=(()=>{class E{}return E.\u0275fac=function(m){return new(m||E)},E.\u0275mod=I.oAB({type:E}),E.\u0275inj=I.cJS({imports:[Tl]}),E})(),mc=(()=>{class E{}return E.\u0275fac=function(m){return new(m||E)},E.\u0275mod=I.oAB({type:E,bootstrap:[ps]}),E.\u0275inj=I.cJS({providers:[],imports:[[G.b2,Ks.ez,Wo,Gs,Ps.ShaderModule]]}),E})();(0,I.G48)(),G.q6().bootstrapModule(mc).catch(E=>console.error(E))},8306:(an,Je,ie)=>{ie.d(Je,{y:()=>rt});var G=ie(2961),I=ie(727),Te=ie(8822),et=ie(4671);var mt=ie(2416),It=ie(576),zt=ie(2806);let rt=(()=>{class st{constructor(Qe){Qe&&(this._subscribe=Qe)}lift(Qe){const pn=new st;return pn.source=this,pn.operator=Qe,pn}subscribe(Qe,pn,Xn){const Fn=function zn(st){return st&&st instanceof G.Lv||function gt(st){return st&&(0,It.m)(st.next)&&(0,It.m)(st.error)&&(0,It.m)(st.complete)}(st)&&(0,I.Nn)(st)}(Qe)?Qe:new G.Hp(Qe,pn,Xn);return(0,zt.x)(()=>{const{operator:Pt,source:Ot}=this;Fn.add(Pt?Pt.call(Fn,Ot):Ot?this._subscribe(Fn):this._trySubscribe(Fn))}),Fn}_trySubscribe(Qe){try{return this._subscribe(Qe)}catch(pn){Qe.error(pn)}}forEach(Qe,pn){return new(pn=ye(pn))((Xn,Fn)=>{const Pt=new G.Hp({next:Ot=>{try{Qe(Ot)}catch(dt){Fn(dt),Pt.unsubscribe()}},error:Fn,complete:Xn});this.subscribe(Pt)})}_subscribe(Qe){var pn;return null===(pn=this.source)||void 0===pn?void 0:pn.subscribe(Qe)}[Te.L](){return this}pipe(...Qe){return function kt(st){return 0===st.length?et.y:1===st.length?st[0]:function(Qe){return st.reduce((pn,Xn)=>Xn(pn),Qe)}}(Qe)(this)}toPromise(Qe){return new(Qe=ye(Qe))((pn,Xn)=>{let Fn;this.subscribe(Pt=>Fn=Pt,Pt=>Xn(Pt),()=>pn(Fn))})}}return st.create=Jn=>new st(Jn),st})();function ye(st){var Jn;return null!==(Jn=null!=st?st:mt.v.Promise)&&void 0!==Jn?Jn:Promise}},7579:(an,Je,ie)=>{ie.d(Je,{x:()=>mt});var G=ie(8306),I=ie(727);const et=(0,ie(3888).d)(zt=>function(){zt(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Ge=ie(8737),kt=ie(2806);let mt=(()=>{class zt extends G.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(ye){const gt=new It(this,this);return gt.operator=ye,gt}_throwIfClosed(){if(this.closed)throw new et}next(ye){(0,kt.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const gt of this.currentObservers)gt.next(ye)}})}error(ye){(0,kt.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=ye;const{observers:gt}=this;for(;gt.length;)gt.shift().error(ye)}})}complete(){(0,kt.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:ye}=this;for(;ye.length;)ye.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var ye;return(null===(ye=this.observers)||void 0===ye?void 0:ye.length)>0}_trySubscribe(ye){return this._throwIfClosed(),super._trySubscribe(ye)}_subscribe(ye){return this._throwIfClosed(),this._checkFinalizedStatuses(ye),this._innerSubscribe(ye)}_innerSubscribe(ye){const{hasError:gt,isStopped:zn,observers:st}=this;return gt||zn?I.Lc:(this.currentObservers=null,st.push(ye),new I.w0(()=>{this.currentObservers=null,(0,Ge.P)(st,ye)}))}_checkFinalizedStatuses(ye){const{hasError:gt,thrownError:zn,isStopped:st}=this;gt?ye.error(zn):st&&ye.complete()}asObservable(){const ye=new G.y;return ye.source=this,ye}}return zt.create=(rt,ye)=>new It(rt,ye),zt})();class It extends mt{constructor(rt,ye){super(),this.destination=rt,this.source=ye}next(rt){var ye,gt;null===(gt=null===(ye=this.destination)||void 0===ye?void 0:ye.next)||void 0===gt||gt.call(ye,rt)}error(rt){var ye,gt;null===(gt=null===(ye=this.destination)||void 0===ye?void 0:ye.error)||void 0===gt||gt.call(ye,rt)}complete(){var rt,ye;null===(ye=null===(rt=this.destination)||void 0===rt?void 0:rt.complete)||void 0===ye||ye.call(rt)}_subscribe(rt){var ye,gt;return null!==(gt=null===(ye=this.source)||void 0===ye?void 0:ye.subscribe(rt))&&void 0!==gt?gt:I.Lc}}},2961:(an,Je,ie)=>{ie.d(Je,{Hp:()=>Qe,Lv:()=>gt});var G=ie(576),I=ie(727),Te=ie(2416),et=ie(7849);function Ge(){}const kt=zt("C",void 0,void 0);function zt(Ot,dt,vt){return{kind:Ot,value:dt,error:vt}}var rt=ie(3410),ye=ie(2806);class gt extends I.w0{constructor(dt){super(),this.isStopped=!1,dt?(this.destination=dt,(0,I.Nn)(dt)&&dt.add(this)):this.destination=Pt}static create(dt,vt,jn){return new Qe(dt,vt,jn)}next(dt){this.isStopped?Fn(function It(Ot){return zt("N",Ot,void 0)}(dt),this):this._next(dt)}error(dt){this.isStopped?Fn(function mt(Ot){return zt("E",void 0,Ot)}(dt),this):(this.isStopped=!0,this._error(dt))}complete(){this.isStopped?Fn(kt,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(dt){this.destination.next(dt)}_error(dt){try{this.destination.error(dt)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const zn=Function.prototype.bind;function st(Ot,dt){return zn.call(Ot,dt)}class Jn{constructor(dt){this.partialObserver=dt}next(dt){const{partialObserver:vt}=this;if(vt.next)try{vt.next(dt)}catch(jn){pn(jn)}}error(dt){const{partialObserver:vt}=this;if(vt.error)try{vt.error(dt)}catch(jn){pn(jn)}else pn(dt)}complete(){const{partialObserver:dt}=this;if(dt.complete)try{dt.complete()}catch(vt){pn(vt)}}}class Qe extends gt{constructor(dt,vt,jn){let qe;if(super(),(0,G.m)(dt)||!dt)qe={next:null!=dt?dt:void 0,error:null!=vt?vt:void 0,complete:null!=jn?jn:void 0};else{let Ft;this&&Te.v.useDeprecatedNextContext?(Ft=Object.create(dt),Ft.unsubscribe=()=>this.unsubscribe(),qe={next:dt.next&&st(dt.next,Ft),error:dt.error&&st(dt.error,Ft),complete:dt.complete&&st(dt.complete,Ft)}):qe=dt}this.destination=new Jn(qe)}}function pn(Ot){Te.v.useDeprecatedSynchronousErrorHandling?(0,ye.O)(Ot):(0,et.h)(Ot)}function Fn(Ot,dt){const{onStoppedNotification:vt}=Te.v;vt&&rt.z.setTimeout(()=>vt(Ot,dt))}const Pt={closed:!0,next:Ge,error:function Xn(Ot){throw Ot},complete:Ge}},727:(an,Je,ie)=>{ie.d(Je,{Lc:()=>kt,w0:()=>Ge,Nn:()=>mt});var G=ie(576);const Te=(0,ie(3888).d)(zt=>function(ye){zt(this),this.message=ye?`${ye.length} errors occurred during unsubscription:\n${ye.map((gt,zn)=>`${zn+1}) ${gt.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=ye});var et=ie(8737);class Ge{constructor(rt){this.initialTeardown=rt,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let rt;if(!this.closed){this.closed=!0;const{_parentage:ye}=this;if(ye)if(this._parentage=null,Array.isArray(ye))for(const st of ye)st.remove(this);else ye.remove(this);const{initialTeardown:gt}=this;if((0,G.m)(gt))try{gt()}catch(st){rt=st instanceof Te?st.errors:[st]}const{_finalizers:zn}=this;if(zn){this._finalizers=null;for(const st of zn)try{It(st)}catch(Jn){rt=null!=rt?rt:[],Jn instanceof Te?rt=[...rt,...Jn.errors]:rt.push(Jn)}}if(rt)throw new Te(rt)}}add(rt){var ye;if(rt&&rt!==this)if(this.closed)It(rt);else{if(rt instanceof Ge){if(rt.closed||rt._hasParent(this))return;rt._addParent(this)}(this._finalizers=null!==(ye=this._finalizers)&&void 0!==ye?ye:[]).push(rt)}}_hasParent(rt){const{_parentage:ye}=this;return ye===rt||Array.isArray(ye)&&ye.includes(rt)}_addParent(rt){const{_parentage:ye}=this;this._parentage=Array.isArray(ye)?(ye.push(rt),ye):ye?[ye,rt]:rt}_removeParent(rt){const{_parentage:ye}=this;ye===rt?this._parentage=null:Array.isArray(ye)&&(0,et.P)(ye,rt)}remove(rt){const{_finalizers:ye}=this;ye&&(0,et.P)(ye,rt),rt instanceof Ge&&rt._removeParent(this)}}Ge.EMPTY=(()=>{const zt=new Ge;return zt.closed=!0,zt})();const kt=Ge.EMPTY;function mt(zt){return zt instanceof Ge||zt&&"closed"in zt&&(0,G.m)(zt.remove)&&(0,G.m)(zt.add)&&(0,G.m)(zt.unsubscribe)}function It(zt){(0,G.m)(zt)?zt():zt.unsubscribe()}},2416:(an,Je,ie)=>{ie.d(Je,{v:()=>G});const G={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},515:(an,Je,ie)=>{ie.d(Je,{E:()=>I});const I=new(ie(8306).y)(Ge=>Ge.complete())},2076:(an,Je,ie)=>{ie.d(Je,{D:()=>jn});var G=ie(8421),I=ie(9672),Te=ie(4482),et=ie(5403);function Ge(qe,Ft=0){return(0,Te.e)((cn,mn)=>{cn.subscribe((0,et.x)(mn,$n=>(0,I.f)(mn,qe,()=>mn.next($n),Ft),()=>(0,I.f)(mn,qe,()=>mn.complete(),Ft),$n=>(0,I.f)(mn,qe,()=>mn.error($n),Ft)))})}function kt(qe,Ft=0){return(0,Te.e)((cn,mn)=>{mn.add(qe.schedule(()=>cn.subscribe(mn),Ft))})}var zt=ie(8306),ye=ie(2202),gt=ie(576);function st(qe,Ft){if(!qe)throw new Error("Iterable cannot be null");return new zt.y(cn=>{(0,I.f)(cn,Ft,()=>{const mn=qe[Symbol.asyncIterator]();(0,I.f)(cn,Ft,()=>{mn.next().then($n=>{$n.done?cn.complete():cn.next($n.value)})},0,!0)})})}var Jn=ie(3670),Qe=ie(8239),pn=ie(1144),Xn=ie(6495),Fn=ie(2206),Pt=ie(4532),Ot=ie(3260);function jn(qe,Ft){return Ft?function vt(qe,Ft){if(null!=qe){if((0,Jn.c)(qe))return function mt(qe,Ft){return(0,G.Xf)(qe).pipe(kt(Ft),Ge(Ft))}(qe,Ft);if((0,pn.z)(qe))return function rt(qe,Ft){return new zt.y(cn=>{let mn=0;return Ft.schedule(function(){mn===qe.length?cn.complete():(cn.next(qe[mn++]),cn.closed||this.schedule())})})}(qe,Ft);if((0,Qe.t)(qe))return function It(qe,Ft){return(0,G.Xf)(qe).pipe(kt(Ft),Ge(Ft))}(qe,Ft);if((0,Fn.D)(qe))return st(qe,Ft);if((0,Xn.T)(qe))return function zn(qe,Ft){return new zt.y(cn=>{let mn;return(0,I.f)(cn,Ft,()=>{mn=qe[ye.h](),(0,I.f)(cn,Ft,()=>{let $n,Dt;try{({value:$n,done:Dt}=mn.next())}catch(gn){return void cn.error(gn)}Dt?cn.complete():cn.next($n)},0,!0)}),()=>(0,gt.m)(null==mn?void 0:mn.return)&&mn.return()})}(qe,Ft);if((0,Ot.L)(qe))return function dt(qe,Ft){return st((0,Ot.Q)(qe),Ft)}(qe,Ft)}throw(0,Pt.z)(qe)}(qe,Ft):(0,G.Xf)(qe)}},8421:(an,Je,ie)=>{ie.d(Je,{Xf:()=>zn});var G=ie(7582),I=ie(1144),Te=ie(8239),et=ie(8306),Ge=ie(3670),kt=ie(2206),mt=ie(4532),It=ie(6495),zt=ie(3260),rt=ie(576),ye=ie(7849),gt=ie(8822);function zn(Ot){if(Ot instanceof et.y)return Ot;if(null!=Ot){if((0,Ge.c)(Ot))return function st(Ot){return new et.y(dt=>{const vt=Ot[gt.L]();if((0,rt.m)(vt.subscribe))return vt.subscribe(dt);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(Ot);if((0,I.z)(Ot))return function Jn(Ot){return new et.y(dt=>{for(let vt=0;vt<Ot.length&&!dt.closed;vt++)dt.next(Ot[vt]);dt.complete()})}(Ot);if((0,Te.t)(Ot))return function Qe(Ot){return new et.y(dt=>{Ot.then(vt=>{dt.closed||(dt.next(vt),dt.complete())},vt=>dt.error(vt)).then(null,ye.h)})}(Ot);if((0,kt.D)(Ot))return Xn(Ot);if((0,It.T)(Ot))return function pn(Ot){return new et.y(dt=>{for(const vt of Ot)if(dt.next(vt),dt.closed)return;dt.complete()})}(Ot);if((0,zt.L)(Ot))return function Fn(Ot){return Xn((0,zt.Q)(Ot))}(Ot)}throw(0,mt.z)(Ot)}function Xn(Ot){return new et.y(dt=>{(function Pt(Ot,dt){var vt,jn,qe,Ft;return(0,G.mG)(this,void 0,void 0,function*(){try{for(vt=(0,G.KL)(Ot);!(jn=yield vt.next()).done;)if(dt.next(jn.value),dt.closed)return}catch(cn){qe={error:cn}}finally{try{jn&&!jn.done&&(Ft=vt.return)&&(yield Ft.call(vt))}finally{if(qe)throw qe.error}}dt.complete()})})(Ot,dt).catch(vt=>dt.error(vt))})}},9646:(an,Je,ie)=>{ie.d(Je,{of:()=>Te});var G=ie(7669),I=ie(2076);function Te(...et){const Ge=(0,G.yG)(et);return(0,I.D)(et,Ge)}},5403:(an,Je,ie)=>{ie.d(Je,{x:()=>I});var G=ie(2961);function I(et,Ge,kt,mt,It){return new Te(et,Ge,kt,mt,It)}class Te extends G.Lv{constructor(Ge,kt,mt,It,zt,rt){super(Ge),this.onFinalize=zt,this.shouldUnsubscribe=rt,this._next=kt?function(ye){try{kt(ye)}catch(gt){Ge.error(gt)}}:super._next,this._error=It?function(ye){try{It(ye)}catch(gt){Ge.error(gt)}finally{this.unsubscribe()}}:super._error,this._complete=mt?function(){try{mt()}catch(ye){Ge.error(ye)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var Ge;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:kt}=this;super.unsubscribe(),!kt&&(null===(Ge=this.onFinalize)||void 0===Ge||Ge.call(this))}}}},4351:(an,Je,ie)=>{ie.d(Je,{b:()=>Te});var G=ie(5577),I=ie(576);function Te(et,Ge){return(0,I.m)(Ge)?(0,G.z)(et,Ge,1):(0,G.z)(et,1)}},6590:(an,Je,ie)=>{ie.d(Je,{d:()=>Te});var G=ie(4482),I=ie(5403);function Te(et){return(0,G.e)((Ge,kt)=>{let mt=!1;Ge.subscribe((0,I.x)(kt,It=>{mt=!0,kt.next(It)},()=>{mt||kt.next(et),kt.complete()}))})}},9300:(an,Je,ie)=>{ie.d(Je,{h:()=>Te});var G=ie(4482),I=ie(5403);function Te(et,Ge){return(0,G.e)((kt,mt)=>{let It=0;kt.subscribe((0,I.x)(mt,zt=>et.call(Ge,zt,It++)&&mt.next(zt)))})}},590:(an,Je,ie)=>{ie.d(Je,{P:()=>mt});var G=ie(6805),I=ie(9300),Te=ie(5698),et=ie(6590),Ge=ie(8068),kt=ie(4671);function mt(It,zt){const rt=arguments.length>=2;return ye=>ye.pipe(It?(0,I.h)((gt,zn)=>It(gt,zn,ye)):kt.y,(0,Te.q)(1),rt?(0,et.d)(zt):(0,Ge.T)(()=>new G.K))}},4004:(an,Je,ie)=>{ie.d(Je,{U:()=>Te});var G=ie(4482),I=ie(5403);function Te(et,Ge){return(0,G.e)((kt,mt)=>{let It=0;kt.subscribe((0,I.x)(mt,zt=>{mt.next(et.call(Ge,zt,It++))}))})}},8189:(an,Je,ie)=>{ie.d(Je,{J:()=>Te});var G=ie(5577),I=ie(4671);function Te(et=1/0){return(0,G.z)(I.y,et)}},5577:(an,Je,ie)=>{ie.d(Je,{z:()=>It});var G=ie(4004),I=ie(8421),Te=ie(4482),et=ie(9672),Ge=ie(5403),mt=ie(576);function It(zt,rt,ye=1/0){return(0,mt.m)(rt)?It((gt,zn)=>(0,G.U)((st,Jn)=>rt(gt,st,zn,Jn))((0,I.Xf)(zt(gt,zn))),ye):("number"==typeof rt&&(ye=rt),(0,Te.e)((gt,zn)=>function kt(zt,rt,ye,gt,zn,st,Jn,Qe){const pn=[];let Xn=0,Fn=0,Pt=!1;const Ot=()=>{Pt&&!pn.length&&!Xn&&rt.complete()},dt=jn=>Xn<gt?vt(jn):pn.push(jn),vt=jn=>{st&&rt.next(jn),Xn++;let qe=!1;(0,I.Xf)(ye(jn,Fn++)).subscribe((0,Ge.x)(rt,Ft=>{null==zn||zn(Ft),st?dt(Ft):rt.next(Ft)},()=>{qe=!0},void 0,()=>{if(qe)try{for(Xn--;pn.length&&Xn<gt;){const Ft=pn.shift();Jn?(0,et.f)(rt,Jn,()=>vt(Ft)):vt(Ft)}Ot()}catch(Ft){rt.error(Ft)}}))};return zt.subscribe((0,Ge.x)(rt,dt,()=>{Pt=!0,Ot()})),()=>{null==Qe||Qe()}}(gt,zn,zt,ye)))}},5698:(an,Je,ie)=>{ie.d(Je,{q:()=>et});var G=ie(515),I=ie(4482),Te=ie(5403);function et(Ge){return Ge<=0?()=>G.E:(0,I.e)((kt,mt)=>{let It=0;kt.subscribe((0,Te.x)(mt,zt=>{++It<=Ge&&(mt.next(zt),Ge<=It&&mt.complete())}))})}},8068:(an,Je,ie)=>{ie.d(Je,{T:()=>et});var G=ie(6805),I=ie(4482),Te=ie(5403);function et(kt=Ge){return(0,I.e)((mt,It)=>{let zt=!1;mt.subscribe((0,Te.x)(It,rt=>{zt=!0,It.next(rt)},()=>zt?It.complete():It.error(kt())))})}function Ge(){return new G.K}},3410:(an,Je,ie)=>{ie.d(Je,{z:()=>G});const G={setTimeout(I,Te,...et){const{delegate:Ge}=G;return(null==Ge?void 0:Ge.setTimeout)?Ge.setTimeout(I,Te,...et):setTimeout(I,Te,...et)},clearTimeout(I){const{delegate:Te}=G;return((null==Te?void 0:Te.clearTimeout)||clearTimeout)(I)},delegate:void 0}},2202:(an,Je,ie)=>{ie.d(Je,{h:()=>I});const I=function G(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(an,Je,ie)=>{ie.d(Je,{L:()=>G});const G="function"==typeof Symbol&&Symbol.observable||"@@observable"},6805:(an,Je,ie)=>{ie.d(Je,{K:()=>I});const I=(0,ie(3888).d)(Te=>function(){Te(this),this.name="EmptyError",this.message="no elements in sequence"})},7669:(an,Je,ie)=>{ie.d(Je,{_6:()=>kt,jO:()=>et,yG:()=>Ge});var G=ie(576);function Te(mt){return mt[mt.length-1]}function et(mt){return(0,G.m)(Te(mt))?mt.pop():void 0}function Ge(mt){return function I(mt){return mt&&(0,G.m)(mt.schedule)}(Te(mt))?mt.pop():void 0}function kt(mt,It){return"number"==typeof Te(mt)?mt.pop():It}},4742:(an,Je,ie)=>{ie.d(Je,{D:()=>Ge});const{isArray:G}=Array,{getPrototypeOf:I,prototype:Te,keys:et}=Object;function Ge(mt){if(1===mt.length){const It=mt[0];if(G(It))return{args:It,keys:null};if(function kt(mt){return mt&&"object"==typeof mt&&I(mt)===Te}(It)){const zt=et(It);return{args:zt.map(rt=>It[rt]),keys:zt}}}return{args:mt,keys:null}}},8737:(an,Je,ie)=>{function G(I,Te){if(I){const et=I.indexOf(Te);0<=et&&I.splice(et,1)}}ie.d(Je,{P:()=>G})},3888:(an,Je,ie)=>{function G(I){const et=I(Ge=>{Error.call(Ge),Ge.stack=(new Error).stack});return et.prototype=Object.create(Error.prototype),et.prototype.constructor=et,et}ie.d(Je,{d:()=>G})},1810:(an,Je,ie)=>{function G(I,Te){return I.reduce((et,Ge,kt)=>(et[Ge]=Te[kt],et),{})}ie.d(Je,{n:()=>G})},2806:(an,Je,ie)=>{ie.d(Je,{O:()=>et,x:()=>Te});var G=ie(2416);let I=null;function Te(Ge){if(G.v.useDeprecatedSynchronousErrorHandling){const kt=!I;if(kt&&(I={errorThrown:!1,error:null}),Ge(),kt){const{errorThrown:mt,error:It}=I;if(I=null,mt)throw It}}else Ge()}function et(Ge){G.v.useDeprecatedSynchronousErrorHandling&&I&&(I.errorThrown=!0,I.error=Ge)}},9672:(an,Je,ie)=>{function G(I,Te,et,Ge=0,kt=!1){const mt=Te.schedule(function(){et(),kt?I.add(this.schedule(null,Ge)):this.unsubscribe()},Ge);if(I.add(mt),!kt)return mt}ie.d(Je,{f:()=>G})},4671:(an,Je,ie)=>{function G(I){return I}ie.d(Je,{y:()=>G})},1144:(an,Je,ie)=>{ie.d(Je,{z:()=>G});const G=I=>I&&"number"==typeof I.length&&"function"!=typeof I},2206:(an,Je,ie)=>{ie.d(Je,{D:()=>I});var G=ie(576);function I(Te){return Symbol.asyncIterator&&(0,G.m)(null==Te?void 0:Te[Symbol.asyncIterator])}},576:(an,Je,ie)=>{function G(I){return"function"==typeof I}ie.d(Je,{m:()=>G})},3670:(an,Je,ie)=>{ie.d(Je,{c:()=>Te});var G=ie(8822),I=ie(576);function Te(et){return(0,I.m)(et[G.L])}},6495:(an,Je,ie)=>{ie.d(Je,{T:()=>Te});var G=ie(2202),I=ie(576);function Te(et){return(0,I.m)(null==et?void 0:et[G.h])}},8239:(an,Je,ie)=>{ie.d(Je,{t:()=>I});var G=ie(576);function I(Te){return(0,G.m)(null==Te?void 0:Te.then)}},3260:(an,Je,ie)=>{ie.d(Je,{L:()=>et,Q:()=>Te});var G=ie(7582),I=ie(576);function Te(Ge){return(0,G.FC)(this,arguments,function*(){const mt=Ge.getReader();try{for(;;){const{value:It,done:zt}=yield(0,G.qq)(mt.read());if(zt)return yield(0,G.qq)(void 0);yield yield(0,G.qq)(It)}}finally{mt.releaseLock()}})}function et(Ge){return(0,I.m)(null==Ge?void 0:Ge.getReader)}},4482:(an,Je,ie)=>{ie.d(Je,{A:()=>I,e:()=>Te});var G=ie(576);function I(et){return(0,G.m)(null==et?void 0:et.lift)}function Te(et){return Ge=>{if(I(Ge))return Ge.lift(function(kt){try{return et(kt,this)}catch(mt){this.error(mt)}});throw new TypeError("Unable to lift unknown Observable type")}}},3268:(an,Je,ie)=>{ie.d(Je,{Z:()=>et});var G=ie(4004);const{isArray:I}=Array;function et(Ge){return(0,G.U)(kt=>function Te(Ge,kt){return I(kt)?Ge(...kt):Ge(kt)}(Ge,kt))}},7849:(an,Je,ie)=>{ie.d(Je,{h:()=>Te});var G=ie(2416),I=ie(3410);function Te(et){I.z.setTimeout(()=>{const{onUnhandledError:Ge}=G.v;if(!Ge)throw et;Ge(et)})}},4532:(an,Je,ie)=>{function G(I){return new TypeError(`You provided ${null!==I&&"object"==typeof I?"an invalid object":`'${I}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}ie.d(Je,{z:()=>G})},9808:(an,Je,ie)=>{ie.d(Je,{Do:()=>Ot,EM:()=>ic,HT:()=>Ge,JF:()=>sc,K0:()=>mt,Mx:()=>Ur,NF:()=>tc,S$:()=>pn,V_:()=>rt,Ye:()=>dt,b0:()=>Pt,bD:()=>ys,ez:()=>ec,lw:()=>It,mr:()=>Fn,q:()=>Te,sg:()=>Ri,w_:()=>kt});var G=ie(1223);let I=null;function Te(){return I}function Ge(N){I||(I=N)}class kt{}const mt=new G.OlP("DocumentToken");let It=(()=>{class N{historyGo(k){throw new Error("Not implemented")}}return N.\u0275fac=function(k){return new(k||N)},N.\u0275prov=G.Yz7({token:N,factory:function(){return function zt(){return(0,G.LFG)(ye)}()},providedIn:"platform"}),N})();const rt=new G.OlP("Location Initialized");let ye=(()=>{class N extends It{constructor(k){super(),this._doc=k,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Te().getBaseHref(this._doc)}onPopState(k){const Y=Te().getGlobalEventTarget(this._doc,"window");return Y.addEventListener("popstate",k,!1),()=>Y.removeEventListener("popstate",k)}onHashChange(k){const Y=Te().getGlobalEventTarget(this._doc,"window");return Y.addEventListener("hashchange",k,!1),()=>Y.removeEventListener("hashchange",k)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(k){this.location.pathname=k}pushState(k,Y,le){gt()?this._history.pushState(k,Y,le):this.location.hash=le}replaceState(k,Y,le){gt()?this._history.replaceState(k,Y,le):this.location.hash=le}forward(){this._history.forward()}back(){this._history.back()}historyGo(k=0){this._history.go(k)}getState(){return this._history.state}}return N.\u0275fac=function(k){return new(k||N)(G.LFG(mt))},N.\u0275prov=G.Yz7({token:N,factory:function(){return function zn(){return new ye((0,G.LFG)(mt))}()},providedIn:"platform"}),N})();function gt(){return!!window.history.pushState}function st(N,$){if(0==N.length)return $;if(0==$.length)return N;let k=0;return N.endsWith("/")&&k++,$.startsWith("/")&&k++,2==k?N+$.substring(1):1==k?N+$:N+"/"+$}function Jn(N){const $=N.match(/#|\?|$/),k=$&&$.index||N.length;return N.slice(0,k-("/"===N[k-1]?1:0))+N.slice(k)}function Qe(N){return N&&"?"!==N[0]?"?"+N:N}let pn=(()=>{class N{historyGo(k){throw new Error("Not implemented")}}return N.\u0275fac=function(k){return new(k||N)},N.\u0275prov=G.Yz7({token:N,factory:function(){return function Xn(N){const $=(0,G.LFG)(mt).location;return new Pt((0,G.LFG)(It),$&&$.origin||"")}()},providedIn:"root"}),N})();const Fn=new G.OlP("appBaseHref");let Pt=(()=>{class N extends pn{constructor(k,Y){if(super(),this._platformLocation=k,this._removeListenerFns=[],null==Y&&(Y=this._platformLocation.getBaseHrefFromDOM()),null==Y)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=Y}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(k){this._removeListenerFns.push(this._platformLocation.onPopState(k),this._platformLocation.onHashChange(k))}getBaseHref(){return this._baseHref}prepareExternalUrl(k){return st(this._baseHref,k)}path(k=!1){const Y=this._platformLocation.pathname+Qe(this._platformLocation.search),le=this._platformLocation.hash;return le&&k?`${Y}${le}`:Y}pushState(k,Y,le,Oe){const tt=this.prepareExternalUrl(le+Qe(Oe));this._platformLocation.pushState(k,Y,tt)}replaceState(k,Y,le,Oe){const tt=this.prepareExternalUrl(le+Qe(Oe));this._platformLocation.replaceState(k,Y,tt)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(k=0){var Y,le;null===(le=(Y=this._platformLocation).historyGo)||void 0===le||le.call(Y,k)}}return N.\u0275fac=function(k){return new(k||N)(G.LFG(It),G.LFG(Fn,8))},N.\u0275prov=G.Yz7({token:N,factory:N.\u0275fac}),N})(),Ot=(()=>{class N extends pn{constructor(k,Y){super(),this._platformLocation=k,this._baseHref="",this._removeListenerFns=[],null!=Y&&(this._baseHref=Y)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(k){this._removeListenerFns.push(this._platformLocation.onPopState(k),this._platformLocation.onHashChange(k))}getBaseHref(){return this._baseHref}path(k=!1){let Y=this._platformLocation.hash;return null==Y&&(Y="#"),Y.length>0?Y.substring(1):Y}prepareExternalUrl(k){const Y=st(this._baseHref,k);return Y.length>0?"#"+Y:Y}pushState(k,Y,le,Oe){let tt=this.prepareExternalUrl(le+Qe(Oe));0==tt.length&&(tt=this._platformLocation.pathname),this._platformLocation.pushState(k,Y,tt)}replaceState(k,Y,le,Oe){let tt=this.prepareExternalUrl(le+Qe(Oe));0==tt.length&&(tt=this._platformLocation.pathname),this._platformLocation.replaceState(k,Y,tt)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(k=0){var Y,le;null===(le=(Y=this._platformLocation).historyGo)||void 0===le||le.call(Y,k)}}return N.\u0275fac=function(k){return new(k||N)(G.LFG(It),G.LFG(Fn,8))},N.\u0275prov=G.Yz7({token:N,factory:N.\u0275fac}),N})(),dt=(()=>{class N{constructor(k,Y){this._subject=new G.vpe,this._urlChangeListeners=[],this._platformStrategy=k;const le=this._platformStrategy.getBaseHref();this._platformLocation=Y,this._baseHref=Jn(qe(le)),this._platformStrategy.onPopState(Oe=>{this._subject.emit({url:this.path(!0),pop:!0,state:Oe.state,type:Oe.type})})}path(k=!1){return this.normalize(this._platformStrategy.path(k))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(k,Y=""){return this.path()==this.normalize(k+Qe(Y))}normalize(k){return N.stripTrailingSlash(function jn(N,$){return N&&$.startsWith(N)?$.substring(N.length):$}(this._baseHref,qe(k)))}prepareExternalUrl(k){return k&&"/"!==k[0]&&(k="/"+k),this._platformStrategy.prepareExternalUrl(k)}go(k,Y="",le=null){this._platformStrategy.pushState(le,"",k,Y),this._notifyUrlChangeListeners(this.prepareExternalUrl(k+Qe(Y)),le)}replaceState(k,Y="",le=null){this._platformStrategy.replaceState(le,"",k,Y),this._notifyUrlChangeListeners(this.prepareExternalUrl(k+Qe(Y)),le)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(k=0){var Y,le;null===(le=(Y=this._platformStrategy).historyGo)||void 0===le||le.call(Y,k)}onUrlChange(k){this._urlChangeListeners.push(k),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(Y=>{this._notifyUrlChangeListeners(Y.url,Y.state)}))}_notifyUrlChangeListeners(k="",Y){this._urlChangeListeners.forEach(le=>le(k,Y))}subscribe(k,Y,le){return this._subject.subscribe({next:k,error:Y,complete:le})}}return N.normalizeQueryParams=Qe,N.joinWithSlash=st,N.stripTrailingSlash=Jn,N.\u0275fac=function(k){return new(k||N)(G.LFG(pn),G.LFG(It))},N.\u0275prov=G.Yz7({token:N,factory:function(){return function vt(){return new dt((0,G.LFG)(pn),(0,G.LFG)(It))}()},providedIn:"root"}),N})();function qe(N){return N.replace(/\/index.html$/,"")}function Ur(N,$){$=encodeURIComponent($);for(const k of N.split(";")){const Y=k.indexOf("="),[le,Oe]=-1==Y?[k,""]:[k.slice(0,Y),k.slice(Y+1)];if(le.trim()===$)return decodeURIComponent(Oe)}return null}class rs{constructor($,k,Y,le){this.$implicit=$,this.ngForOf=k,this.index=Y,this.count=le}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Ri=(()=>{class N{constructor(k,Y,le){this._viewContainer=k,this._template=Y,this._differs=le,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(k){this._ngForOf=k,this._ngForOfDirty=!0}set ngForTrackBy(k){this._trackByFn=k}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(k){k&&(this._template=k)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const k=this._ngForOf;!this._differ&&k&&(this._differ=this._differs.find(k).create(this.ngForTrackBy))}if(this._differ){const k=this._differ.diff(this._ngForOf);k&&this._applyChanges(k)}}_applyChanges(k){const Y=this._viewContainer;k.forEachOperation((le,Oe,tt)=>{if(null==le.previousIndex)Y.createEmbeddedView(this._template,new rs(le.item,this._ngForOf,-1,-1),null===tt?void 0:tt);else if(null==tt)Y.remove(null===Oe?void 0:Oe);else if(null!==Oe){const bt=Y.get(Oe);Y.move(bt,tt),gs(bt,le)}});for(let le=0,Oe=Y.length;le<Oe;le++){const bt=Y.get(le).context;bt.index=le,bt.count=Oe,bt.ngForOf=this._ngForOf}k.forEachIdentityChange(le=>{gs(Y.get(le.currentIndex),le)})}static ngTemplateContextGuard(k,Y){return!0}}return N.\u0275fac=function(k){return new(k||N)(G.Y36(G.s_b),G.Y36(G.Rgc),G.Y36(G.ZZ4))},N.\u0275dir=G.lG2({type:N,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),N})();function gs(N,$){N.context.$implicit=$.item}let ec=(()=>{class N{}return N.\u0275fac=function(k){return new(k||N)},N.\u0275mod=G.oAB({type:N}),N.\u0275inj=G.cJS({}),N})();const ys="browser";function tc(N){return N===ys}let ic=(()=>{class N{}return N.\u0275prov=(0,G.Yz7)({token:N,providedIn:"root",factory:()=>new vo((0,G.LFG)(mt),window)}),N})();class vo{constructor($,k){this.document=$,this.window=k,this.offset=()=>[0,0]}setOffset($){this.offset=Array.isArray($)?()=>$:$}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition($){this.supportsScrolling()&&this.window.scrollTo($[0],$[1])}scrollToAnchor($){if(!this.supportsScrolling())return;const k=function as(N,$){const k=N.getElementById($)||N.getElementsByName($)[0];if(k)return k;if("function"==typeof N.createTreeWalker&&N.body&&(N.body.createShadowRoot||N.body.attachShadow)){const Y=N.createTreeWalker(N.body,NodeFilter.SHOW_ELEMENT);let le=Y.currentNode;for(;le;){const Oe=le.shadowRoot;if(Oe){const tt=Oe.getElementById($)||Oe.querySelector(`[name="${$}"]`);if(tt)return tt}le=Y.nextNode()}}return null}(this.document,$);k&&(this.scrollToElement(k),k.focus())}setHistoryScrollRestoration($){if(this.supportScrollRestoration()){const k=this.window.history;k&&k.scrollRestoration&&(k.scrollRestoration=$)}}scrollToElement($){const k=$.getBoundingClientRect(),Y=k.left+this.window.pageXOffset,le=k.top+this.window.pageYOffset,Oe=this.offset();this.window.scrollTo(Y-Oe[0],le-Oe[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const $=yo(this.window.history)||yo(Object.getPrototypeOf(this.window.history));return!(!$||!$.writable&&!$.set)}catch($){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch($){return!1}}}function yo(N){return Object.getOwnPropertyDescriptor(N,"scrollRestoration")}class sc{}},1223:(an,Je,ie)=>{ie.d(Je,{deG:()=>qs,tb:()=>kw,AFp:()=>Ow,ip1:()=>Lw,CZH:()=>wm,hGG:()=>oA,z2F:()=>$v,sBO:()=>Qh,Sil:()=>Bw,_Vd:()=>nm,EJc:()=>Uw,SBq:()=>Mi,qLn:()=>np,vpe:()=>co,tBr:()=>eh,XFs:()=>hn,OlP:()=>Pi,zs3:()=>rl,ZZ4:()=>yx,aQg:()=>xx,soG:()=>Mf,YKP:()=>im,h0i:()=>Yl,PXZ:()=>$w,R0b:()=>uo,FiY:()=>Uf,Lbi:()=>BS,g9A:()=>Nw,Qsj:()=>SS,FYo:()=>D_,JOm:()=>qo,q3G:()=>Rr,tp0:()=>Bf,Rgc:()=>Bu,dDg:()=>Gw,GfV:()=>dw,s_b:()=>Fa,ifc:()=>Is,eFA:()=>qw,G48:()=>Qw,Gpc:()=>Fn,_c5:()=>sA,VLi:()=>XS,c2e:()=>Wv,zSh:()=>Tg,wAp:()=>wn,vHH:()=>vt,EiD:()=>Ay,mCW:()=>Qr,qzn:()=>kl,JVY:()=>Zf,pB0:()=>_y,eBb:()=>vy,L6k:()=>Kf,LAX:()=>yy,cg1:()=>tf,kL8:()=>Hp,yhl:()=>xd,dqk:()=>fi,sIi:()=>Pd,CqO:()=>Zg,QGY:()=>bp,F4k:()=>Vs,RDi:()=>le,AaK:()=>Qe,z3N:()=>Ca,qOj:()=>Ng,TTD:()=>Bo,_Bn:()=>A_,xp6:()=>Oy,uIk:()=>Bg,ekj:()=>Cp,Suo:()=>ff,Xpm:()=>de,lG2:()=>ms,Yz7:()=>di,cJS:()=>ar,oAB:()=>Hn,Yjl:()=>kr,Y36:()=>wu,_UZ:()=>Cc,qZA:()=>Tc,TgZ:()=>Ac,EpF:()=>Oh,n5z:()=>Xi,LFG:()=>Es,$8M:()=>Ka,$Z:()=>Ph,NdJ:()=>wp,CRH:()=>Yh,kcU:()=>dc,O4$:()=>Ya,oxw:()=>Qg,ALo:()=>Iv,xi3:()=>Pv,Hsn:()=>Sp,F$t:()=>ev,Q6J:()=>Eu,iGM:()=>df,CHM:()=>_o,LSH:()=>tg,YNc:()=>R0,_uU:()=>$0,Oqu:()=>Fp});var G=ie(7579),I=ie(727),Te=ie(8306),et=ie(8189),Ge=ie(8421),kt=ie(515),mt=ie(7669),It=ie(2076),rt=ie(2961),ye=ie(4482);function zn(r,s,...l){if(!0===s)return void r();if(!1===s)return;const h=new rt.Hp({next:()=>{h.unsubscribe(),r()}});return s(...l).subscribe(h)}function st(r){for(let s in r)if(r[s]===st)return s;throw Error("Could not find renamed property on target object.")}function Jn(r,s){for(const l in s)s.hasOwnProperty(l)&&!r.hasOwnProperty(l)&&(r[l]=s[l])}function Qe(r){if("string"==typeof r)return r;if(Array.isArray(r))return"["+r.map(Qe).join(", ")+"]";if(null==r)return""+r;if(r.overriddenName)return`${r.overriddenName}`;if(r.name)return`${r.name}`;const s=r.toString();if(null==s)return""+s;const l=s.indexOf("\n");return-1===l?s:s.substring(0,l)}function pn(r,s){return null==r||""===r?null===s?"":s:null==s||""===s?r:r+" "+s}const Xn=st({__forward_ref__:st});function Fn(r){return r.__forward_ref__=Fn,r.toString=function(){return Qe(this())},r}function Pt(r){return Ot(r)?r():r}function Ot(r){return"function"==typeof r&&r.hasOwnProperty(Xn)&&r.__forward_ref__===Fn}class vt extends Error{constructor(s,l){super(function jn(r,s){return`NG0${Math.abs(r)}${s?": "+s:""}`}(s,l)),this.code=s}}function qe(r){return"string"==typeof r?r:null==r?"":String(r)}function Ft(r){return"function"==typeof r?r.name||r.toString():"object"==typeof r&&null!=r&&"function"==typeof r.type?r.type.name||r.type.toString():qe(r)}function Dt(r,s){const l=s?` in ${s}`:"";throw new vt(-201,`No provider for ${Ft(r)} found${l}`)}function un(r,s){null==r&&function lt(r,s,l,h){throw new Error(`ASSERTION ERROR: ${r}`+(null==h?"":` [Expected=> ${l} ${h} ${s} <=Actual]`))}(s,r,null,"!=")}function di(r){return{token:r.token,providedIn:r.providedIn||null,factory:r.factory,value:void 0}}function ar(r){return{providers:r.providers||[],imports:r.imports||[]}}function fs(r){return Hs(r,Fo)||Hs(r,Va)}function Hs(r,s){return r.hasOwnProperty(s)?r[s]:null}function fo(r){return r&&(r.hasOwnProperty(No)||r.hasOwnProperty(Jl))?r[No]:null}const Fo=st({\u0275prov:st}),No=st({\u0275inj:st}),Va=st({ngInjectableDef:st}),Jl=st({ngInjectorDef:st});var hn=(()=>((hn=hn||{})[hn.Default=0]="Default",hn[hn.Host=1]="Host",hn[hn.Self=2]="Self",hn[hn.SkipSelf=4]="SkipSelf",hn[hn.Optional=8]="Optional",hn))();let Fr;function tn(r){const s=Fr;return Fr=r,s}function _t(r,s,l){const h=fs(r);return h&&"root"==h.providedIn?void 0===h.value?h.value=h.factory():h.value:l&hn.Optional?null:void 0!==s?s:void Dt(Qe(r),"Injector")}function er(r){return{toString:r}.toString()}var ki=(()=>((ki=ki||{})[ki.OnPush=0]="OnPush",ki[ki.Default=1]="Default",ki))(),Is=(()=>{return(r=Is||(Is={}))[r.Emulated=0]="Emulated",r[r.None=2]="None",r[r.ShadowDom=3]="ShadowDom",Is;var r})();const An="undefined"!=typeof globalThis&&globalThis,is="undefined"!=typeof window&&window,ai="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,fi=An||"undefined"!=typeof global&&global||is||ai,qn={},ti=[],Gs=st({\u0275cmp:st}),ps=st({\u0275dir:st}),Ps=st({\u0275pipe:st}),Ks=st({\u0275mod:st}),vr=st({\u0275fac:st}),po=st({__NG_ELEMENT_ID__:st});let be=0;function de(r){return er(()=>{const l={},h={type:r.type,providersResolver:null,decls:r.decls,vars:r.vars,factory:null,template:r.template||null,consts:r.consts||null,ngContentSelectors:r.ngContentSelectors,hostBindings:r.hostBindings||null,hostVars:r.hostVars||0,hostAttrs:r.hostAttrs||null,contentQueries:r.contentQueries||null,declaredInputs:l,inputs:null,outputs:null,exportAs:r.exportAs||null,onPush:r.changeDetection===ki.OnPush,directiveDefs:null,pipeDefs:null,selectors:r.selectors||ti,viewQuery:r.viewQuery||null,features:r.features||null,data:r.data||{},encapsulation:r.encapsulation||Is.Emulated,id:"c",styles:r.styles||ti,_:null,setInput:null,schemas:r.schemas||null,tView:null},f=r.directives,y=r.features,w=r.pipes;return h.id+=be++,h.inputs=Nr(r.inputs,l),h.outputs=Nr(r.outputs),y&&y.forEach(D=>D(h)),h.directiveDefs=f?()=>("function"==typeof f?f():f).map(ve):null,h.pipeDefs=w?()=>("function"==typeof w?w():w).map(Ce):null,h})}function ve(r){return tr(r)||function jr(r){return r[ps]||null}(r)}function Ce(r){return function Ar(r){return r[Ps]||null}(r)}const dn={};function Hn(r){return er(()=>{const s={type:r.type,bootstrap:r.bootstrap||ti,declarations:r.declarations||ti,imports:r.imports||ti,exports:r.exports||ti,transitiveCompileScopes:null,schemas:r.schemas||null,id:r.id||null};return null!=r.id&&(dn[r.id]=r.type),s})}function Nr(r,s){if(null==r)return qn;const l={};for(const h in r)if(r.hasOwnProperty(h)){let f=r[h],y=f;Array.isArray(f)&&(y=f[1],f=f[0]),l[f]=h,s&&(s[f]=y)}return l}const ms=de;function kr(r){return{type:r.type,name:r.name,factory:null,pure:!1!==r.pure,onDestroy:r.type.prototype.ngOnDestroy||null}}function tr(r){return r[Gs]||null}function Tr(r,s){const l=r[Ks]||null;if(!l&&!0===s)throw new Error(`Type ${Qe(r)} does not have '\u0275mod' property.`);return l}function ir(r){return Array.isArray(r)&&"object"==typeof r[1]}function ni(r){return Array.isArray(r)&&!0===r[1]}function Ga(r){return 0!=(8&r.flags)}function Ls(r){return 2==(2&r.flags)}function ha(r){return 1==(1&r.flags)}function ur(r){return null!==r.template}function Br(r){return 0!=(512&r[2])}function os(r,s){return r.hasOwnProperty(vr)?r[vr]:null}class _s{constructor(s,l,h){this.previousValue=s,this.currentValue=l,this.firstChange=h}isFirstChange(){return this.firstChange}}function Bo(){return tc}function tc(r){return r.type.prototype.ngOnChanges&&(r.setInput=Ml),nc}function nc(){const r=pa(this),s=null==r?void 0:r.current;if(s){const l=r.previous;if(l===qn)r.previous=s;else for(let h in s)l[h]=s[h];r.current=null,this.ngOnChanges(s)}}function Ml(r,s,l,h){const f=pa(r)||function ic(r,s){return r[fa]=s}(r,{previous:qn,current:null}),y=f.current||(f.current={}),w=f.previous,D=this.declaredInputs[l],L=w[D];y[D]=new _s(L&&L.currentValue,s,w===qn),r[h]=s}Bo.ngInherit=!0;const fa="__ngSimpleChanges__";function pa(r){return r[fa]||null}const N="math";let Y;function le(r){Y=r}function bt(r){return!!r.listen}const yi={createRenderer:(r,s)=>function Oe(){return void 0!==Y?Y:"undefined"!=typeof document?document:void 0}()};function Mn(r){for(;Array.isArray(r);)r=r[0];return r}function ii(r,s){return Mn(s[r])}function Qn(r,s){return Mn(s[r.index])}function $i(r,s){return r.data[s]}function Ai(r,s){const l=s[r];return ir(l)?l:l[0]}function Fi(r){return 4==(4&r[2])}function Fs(r){return 128==(128&r[2])}function xs(r,s){return null==s?null:r[s]}function $u(r){r[18]=0}function Ii(r,s){r[5]+=s;let l=r,h=r[3];for(;null!==h&&(1===s&&1===l[5]||-1===s&&0===l[5]);)h[5]+=s,l=h,h=h[3]}const En={lFrame:qc(null),bindingsEnabled:!0};function oc(){return En.bindingsEnabled}function Ze(){return En.lFrame.lView}function Tn(){return En.lFrame.tView}function _o(r){return En.lFrame.contextLView=r,r[8]}function rr(){let r=ac();for(;null!==r&&64===r.type;)r=r.parent;return r}function ac(){return En.lFrame.currentTNode}function $s(r,s){const l=En.lFrame;l.currentTNode=r,l.isParent=s}function qr(){return En.lFrame.isParent}function Gc(){En.lFrame.isParent=!1}function ma(){return En.lFrame.bindingIndex++}function wl(r,s){const l=En.lFrame;l.bindingIndex=l.bindingRootIndex=r,ga(s)}function ga(r){En.lFrame.currentDirectiveIndex=r}function El(){return En.lFrame.currentQueryIndex}function Xc(r){En.lFrame.currentQueryIndex=r}function uc(r){const s=r[1];return 2===s.type?s.declTNode:1===s.type?r[6]:null}function Sl(r,s,l){if(l&hn.SkipSelf){let f=s,y=r;for(;!(f=f.parent,null!==f||l&hn.Host||(f=uc(y),null===f||(y=y[15],10&f.type))););if(null===f)return!1;s=f,r=y}const h=En.lFrame=qa();return h.currentTNode=s,h.lView=r,!0}function Al(r){const s=qa(),l=r[1];En.lFrame=s,s.currentTNode=l.firstChild,s.lView=r,s.tView=l,s.contextLView=r,s.bindingIndex=l.bindingStartIndex,s.inI18n=!1}function qa(){const r=En.lFrame,s=null===r?null:r.child;return null===s?qc(r):s}function qc(r){const s={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:r,child:null,inI18n:!1};return null!==r&&(r.child=s),s}function hc(){const r=En.lFrame;return En.lFrame=r.parent,r.currentTNode=null,r.lView=null,r}const Yc=hc;function Mo(){const r=hc();r.isParent=!0,r.tView=null,r.selectedIndex=-1,r.contextLView=null,r.elementDepthCount=0,r.currentDirectiveIndex=-1,r.currentNamespace=null,r.bindingRootIndex=-1,r.bindingIndex=-1,r.currentQueryIndex=0}function Dr(){return En.lFrame.selectedIndex}function bo(r){En.lFrame.selectedIndex=r}function zi(){const r=En.lFrame;return $i(r.tView,r.selectedIndex)}function Ya(){En.lFrame.currentNamespace="svg"}function dc(){!function zr(){En.lFrame.currentNamespace=null}()}function va(r,s){for(let l=s.directiveStart,h=s.directiveEnd;l<h;l++){const y=r.data[l].type.prototype,{ngAfterContentInit:w,ngAfterContentChecked:D,ngAfterViewInit:L,ngAfterViewChecked:B,ngOnDestroy:W}=y;w&&(r.contentHooks||(r.contentHooks=[])).push(-l,w),D&&((r.contentHooks||(r.contentHooks=[])).push(l,D),(r.contentCheckHooks||(r.contentCheckHooks=[])).push(l,D)),L&&(r.viewHooks||(r.viewHooks=[])).push(-l,L),B&&((r.viewHooks||(r.viewHooks=[])).push(l,B),(r.viewCheckHooks||(r.viewCheckHooks=[])).push(l,B)),null!=W&&(r.destroyHooks||(r.destroyHooks=[])).push(l,W)}}function Eo(r,s,l){Zu(r,s,3,l)}function So(r,s,l,h){(3&r[2])===l&&Zu(r,s,l,h)}function fc(r,s){let l=r[2];(3&l)===s&&(l&=2047,l+=1,r[2]=l)}function Zu(r,s,l,h){const y=null!=h?h:-1,w=s.length-1;let D=0;for(let L=void 0!==h?65535&r[18]:0;L<w;L++)if("number"==typeof s[L+1]){if(D=s[L],null!=h&&D>=h)break}else s[L]<0&&(r[18]+=65536),(D<y||-1==y)&&(Za(r,l,s,L),r[18]=(4294901760&r[18])+L+2),L++}function Za(r,s,l,h){const f=l[h]<0,y=l[h+1],D=r[f?-l[h]:l[h]];if(f){if(r[2]>>11<r[18]>>16&&(3&r[2])===s){r[2]+=2048;try{y.call(D)}finally{}}}else try{y.call(D)}finally{}}class Ao{constructor(s,l,h){this.factory=s,this.resolving=!1,this.canSeeViewProviders=l,this.injectImpl=h}}function pc(r,s,l){const h=bt(r);let f=0;for(;f<l.length;){const y=l[f];if("number"==typeof y){if(0!==y)break;f++;const w=l[f++],D=l[f++],L=l[f++];h?r.setAttribute(s,D,L,w):s.setAttributeNS(w,D,L)}else{const w=y,D=l[++f];Ju(w)?h&&r.setProperty(s,w,D):h?r.setAttribute(s,w,D):s.setAttribute(w,D),f++}}return f}function xa(r){return 3===r||4===r||6===r}function Ju(r){return 64===r.charCodeAt(0)}function Tl(r,s){if(null!==s&&0!==s.length)if(null===r||0===r.length)r=s.slice();else{let l=-1;for(let h=0;h<s.length;h++){const f=s[h];"number"==typeof f?l=f:0===l||Wo(r,l,f,null,-1===l||2===l?s[++h]:null)}}return r}function Wo(r,s,l,h,f){let y=0,w=r.length;if(-1===s)w=-1;else for(;y<r.length;){const D=r[y++];if("number"==typeof D){if(D===s){w=-1;break}if(D>s){w=y-1;break}}}for(;y<r.length;){const D=r[y];if("number"==typeof D)break;if(D===l){if(null===h)return void(null!==f&&(r[y+1]=f));if(h===r[y+1])return void(r[y+2]=f)}y++,null!==h&&y++,null!==f&&y++}-1!==w&&(r.splice(w,0,s),y=w+1),r.splice(y++,0,l),null!==h&&r.splice(y++,0,h),null!==f&&r.splice(y++,0,f)}function od(r){return-1!==r}function Xs(r){return 32767&r}function ls(r,s){let l=function vn(r){return r>>16}(r),h=s;for(;l>0;)h=h[15],l--;return h}let mc=!0;function Qc(r){const s=mc;return mc=r,s}let g=0;function C(r,s){const l=z(r,s);if(-1!==l)return l;const h=s[1];h.firstCreatePass&&(r.injectorIndex=s.length,O(h.data,r),O(s,null),O(h.blueprint,null));const f=H(r,s),y=r.injectorIndex;if(od(f)){const w=Xs(f),D=ls(f,s),L=D[1].data;for(let B=0;B<8;B++)s[y+B]=D[w+B]|L[w+B]}return s[y+8]=f,y}function O(r,s){r.push(0,0,0,0,0,0,0,0,s)}function z(r,s){return-1===r.injectorIndex||r.parent&&r.parent.injectorIndex===r.injectorIndex||null===s[r.injectorIndex+8]?-1:r.injectorIndex}function H(r,s){if(r.parent&&-1!==r.parent.injectorIndex)return r.parent.injectorIndex;let l=0,h=null,f=s;for(;null!==f;){const y=f[1],w=y.type;if(h=2===w?y.declTNode:1===w?f[6]:null,null===h)return-1;if(l++,f=f[15],-1!==h.injectorIndex)return h.injectorIndex|l<<16}return-1}function ne(r,s,l){!function x(r,s,l){let h;"string"==typeof l?h=l.charCodeAt(0)||0:l.hasOwnProperty(po)&&(h=l[po]),null==h&&(h=l[po]=g++);const f=255&h;s.data[r+(f>>5)]|=1<<f}(r,s,l)}function Ie(r,s,l){if(l&hn.Optional)return r;Dt(s,"NodeInjector")}function yt(r,s,l,h){if(l&hn.Optional&&void 0===h&&(h=null),0==(l&(hn.Self|hn.Host))){const f=r[9],y=tn(void 0);try{return f?f.get(s,h,l&hn.Optional):_t(s,h,l&hn.Optional)}finally{tn(y)}}return Ie(h,s,l)}function Et(r,s,l,h=hn.Default,f){if(null!==r){const y=function Cn(r){if("string"==typeof r)return r.charCodeAt(0)||0;const s=r.hasOwnProperty(po)?r[po]:void 0;return"number"==typeof s?s>=0?255&s:$t:s}(l);if("function"==typeof y){if(!Sl(s,r,h))return h&hn.Host?Ie(f,l,h):yt(s,l,h,f);try{const w=y(h);if(null!=w||h&hn.Optional)return w;Dt(l)}finally{Yc()}}else if("number"==typeof y){let w=null,D=z(r,s),L=-1,B=h&hn.Host?s[16][6]:null;for((-1===D||h&hn.SkipSelf)&&(L=-1===D?H(r,s):s[D+8],-1!==L&&Zr(h,!1)?(w=s[1],D=Xs(L),s=ls(L,s)):D=-1);-1!==D;){const W=s[1];if(Rn(y,D,W.data)){const te=Gn(D,s,l,w,h,B);if(te!==Jt)return te}L=s[D+8],-1!==L&&Zr(h,s[1].data[D+8]===B)&&Rn(y,D,s)?(w=W,D=Xs(L),s=ls(L,s)):D=-1}}}return yt(s,l,h,f)}const Jt={};function $t(){return new ws(rr(),Ze())}function Gn(r,s,l,h,f,y){const w=s[1],D=w.data[r+8],W=Ti(D,w,l,null==h?Ls(D)&&mc:h!=w&&0!=(3&D.type),f&hn.Host&&y===D);return null!==W?yr(s,w,W,D):Jt}function Ti(r,s,l,h,f){const y=r.providerIndexes,w=s.data,D=1048575&y,L=r.directiveStart,W=y>>20,ae=f?D+W:r.directiveEnd;for(let ge=h?D:D+W;ge<ae;ge++){const Ve=w[ge];if(ge<L&&l===Ve||ge>=L&&Ve.type===l)return ge}if(f){const ge=w[L];if(ge&&ur(ge)&&ge.type===l)return L}return null}function yr(r,s,l,h){let f=r[l];const y=s.data;if(function ya(r){return r instanceof Ao}(f)){const w=f;w.resolving&&function cn(r,s){const l=s?`. Dependency path: ${s.join(" > ")} > ${r}`:"";throw new vt(-200,`Circular dependency in DI detected for ${r}${l}`)}(Ft(y[l]));const D=Qc(w.canSeeViewProviders);w.resolving=!0;const L=w.injectImpl?tn(w.injectImpl):null;Sl(r,h,hn.Default);try{f=r[l]=w.factory(void 0,y,r,h),s.firstCreatePass&&l>=h.directiveStart&&function wo(r,s,l){const{ngOnChanges:h,ngOnInit:f,ngDoCheck:y}=s.type.prototype;if(h){const w=tc(s);(l.preOrderHooks||(l.preOrderHooks=[])).push(r,w),(l.preOrderCheckHooks||(l.preOrderCheckHooks=[])).push(r,w)}f&&(l.preOrderHooks||(l.preOrderHooks=[])).push(0-r,f),y&&((l.preOrderHooks||(l.preOrderHooks=[])).push(r,y),(l.preOrderCheckHooks||(l.preOrderCheckHooks=[])).push(r,y))}(l,y[l],s)}finally{null!==L&&tn(L),Qc(D),w.resolving=!1,Yc()}}return f}function Rn(r,s,l){return!!(l[s+(r>>5)]&1<<r)}function Zr(r,s){return!(r&hn.Self||r&hn.Host&&s)}class ws{constructor(s,l){this._tNode=s,this._lView=l}get(s,l,h){return Et(this._tNode,this._lView,s,h,l)}}function Xi(r){return er(()=>{const s=r.prototype.constructor,l=s[vr]||eu(s),h=Object.prototype;let f=Object.getPrototypeOf(r.prototype).constructor;for(;f&&f!==h;){const y=f[vr]||eu(f);if(y&&y!==l)return y;f=Object.getPrototypeOf(f)}return y=>new y})}function eu(r){return Ot(r)?()=>{const s=eu(Pt(r));return s&&s()}:os(r)}function Ka(r){return function ue(r,s){if("class"===s)return r.classes;if("style"===s)return r.styles;const l=r.attrs;if(l){const h=l.length;let f=0;for(;f<h;){const y=l[f];if(xa(y))break;if(0===y)f+=2;else if("number"==typeof y)for(f++;f<h&&"string"==typeof l[f];)f++;else{if(y===s)return l[f+1];f+=2}}}return null}(rr(),r)}const qi="__parameters__";function Cl(r,s,l){return er(()=>{const h=function tu(r){return function(...l){if(r){const h=r(...l);for(const f in h)this[f]=h[f]}}}(s);function f(...y){if(this instanceof f)return h.apply(this,y),this;const w=new f(...y);return D.annotation=w,D;function D(L,B,W){const te=L.hasOwnProperty(qi)?L[qi]:Object.defineProperty(L,qi,{value:[]})[qi];for(;te.length<=W;)te.push(null);return(te[W]=te[W]||[]).push(w),L}}return l&&(f.prototype=Object.create(l.prototype)),f.prototype.ngMetadataName=r,f.annotationCls=f,f})}class Pi{constructor(s,l){this._desc=s,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof l?this.__NG_ELEMENT_ID__=l:void 0!==l&&(this.\u0275prov=di({token:this,providedIn:l.providedIn||"root",factory:l.factory}))}toString(){return`InjectionToken ${this._desc}`}}const qs=new Pi("AnalyzeForEntryComponents");function Xo(r,s){void 0===s&&(s=r);for(let l=0;l<r.length;l++){let h=r[l];Array.isArray(h)?(s===r&&(s=r.slice(0,l)),Xo(h,s)):s!==r&&s.push(h)}return s}function Qa(r,s){r.forEach(l=>Array.isArray(l)?Qa(l,s):s(l))}function sy(r,s,l){s>=r.length?r.push(l):r.splice(s,0,l)}function Ff(r,s){return s>=r.length-1?r.pop():r.splice(s,1)[0]}function ld(r,s){const l=[];for(let h=0;h<r;h++)l.push(s);return l}function ks(r,s,l){let h=Kr(r,s);return h>=0?r[1|h]=l:(h=~h,function Ax(r,s,l,h){let f=r.length;if(f==s)r.push(l,h);else if(1===f)r.push(h,r[0]),r[0]=l;else{for(f--,r.push(r[f-1],r[f]);f>s;)r[f]=r[f-2],f--;r[s]=l,r[s+1]=h}}(r,h,s,l)),h}function Fm(r,s){const l=Kr(r,s);if(l>=0)return r[1|l]}function Kr(r,s){return function Co(r,s,l){let h=0,f=r.length>>l;for(;f!==h;){const y=h+(f-h>>1),w=r[y<<l];if(s===w)return y<<l;w>s?f=y:h=y+1}return~(f<<l)}(r,s,1)}const el={},ud="__NG_DI_FLAG__",kf="ngTempTokenPath",Dx=/\n/gm,cy="__source",Ix=st({provide:String,useValue:st});let Ys;function ru(r){const s=Ys;return Ys=r,s}function uy(r,s=hn.Default){if(void 0===Ys)throw new vt(203,"");return null===Ys?_t(r,void 0,s):Ys.get(r,s&hn.Optional?null:void 0,s)}function Es(r,s=hn.Default){return(function oi(){return Fr}()||uy)(Pt(r),s)}const km=Es;function Um(r){const s=[];for(let l=0;l<r.length;l++){const h=Pt(r[l]);if(Array.isArray(h)){if(0===h.length)throw new vt(900,"");let f,y=hn.Default;for(let w=0;w<h.length;w++){const D=h[w],L=Ci(D);"number"==typeof L?-1===L?f=D.token:y|=L:f=D}s.push(Es(f,y))}else s.push(Es(h))}return s}function Ss(r,s){return r[ud]=s,r.prototype[ud]=s,r}function Ci(r){return r[ud]}const eh=Ss(Cl("Inject",r=>({token:r})),-1),Uf=Ss(Cl("Optional"),8),Bf=Ss(Cl("SkipSelf"),4);var qo=(()=>((qo=qo||{})[qo.Important=1]="Important",qo[qo.DashCase=2]="DashCase",qo))();const Pl="__ngContext__";function us(r,s){r[Pl]=s}function gd(r){const s=function vc(r){return r[Pl]||null}(r);return s?Array.isArray(s)?s:s.lView:null}function Wf(r,s){return undefined(r,s)}function vd(r){const s=r[3];return ni(s)?s[3]:s}function Ea(r){return oh(r[13])}function sh(r){return oh(r[4])}function oh(r){for(;null!==r&&!ni(r);)r=r[4];return r}function ah(r,s,l,h,f){if(null!=h){let y,w=!1;ni(h)?y=h:ir(h)&&(w=!0,h=h[0]);const D=Mn(h);0===r&&null!==l?null==f?lo(s,l,D):du(s,l,D,f||null,!0):1===r&&null!==l?du(s,l,D,f||null,!0):2===r?function lh(r,s,l){const h=fu(r,s);h&&function Aa(r,s,l,h){bt(r)?r.removeChild(s,l,h):s.removeChild(l)}(r,h,s,l)}(s,D,w):3===r&&s.destroyNode(D),null!=y&&function ME(r,s,l,h,f){const y=l[7];y!==Mn(l)&&ah(s,r,h,y,f);for(let D=10;D<l.length;D++){const L=l[D];Xf(L[1],L,r,s,h,y)}}(s,r,y,l,f)}}function Wm(r,s,l){if(bt(r))return r.createElement(s,l);{const h=null!==l?function k(r){const s=r.toLowerCase();return"svg"===s?"http://www.w3.org/2000/svg":s===N?"http://www.w3.org/1998/MathML/":null}(l):null;return null===h?r.createElement(s):r.createElementNS(h,s)}}function hu(r,s){const l=r[9],h=l.indexOf(s),f=s[3];1024&s[2]&&(s[2]&=-1025,Ii(f,-1)),l.splice(h,1)}function yc(r,s){if(r.length<=10)return;const l=10+s,h=r[l];if(h){const f=h[17];null!==f&&f!==r&&hu(f,h),s>0&&(r[l-1][4]=h[4]);const y=Ff(r,10+s);!function fy(r,s){Xf(r,s,s[11],2,null,null),s[0]=null,s[6]=null}(h[1],h);const w=y[19];null!==w&&w.detachView(y[1]),h[3]=null,h[4]=null,h[2]&=-129}return h}function $m(r,s){if(!(256&s[2])){const l=s[11];bt(l)&&l.destroyNode&&Xf(r,s,l,3,null,null),function Fl(r){let s=r[13];if(!s)return yd(r[1],r);for(;s;){let l=null;if(ir(s))l=s[13];else{const h=s[10];h&&(l=h)}if(!l){for(;s&&!s[4]&&s!==r;)ir(s)&&yd(s[1],s),s=s[3];null===s&&(s=r),ir(s)&&yd(s[1],s),l=s&&s[4]}s=l}}(s)}}function yd(r,s){if(!(256&s[2])){s[2]&=-129,s[2]|=256,function qm(r,s){let l;if(null!=r&&null!=(l=r.destroyHooks))for(let h=0;h<l.length;h+=2){const f=s[l[h]];if(!(f instanceof Ao)){const y=l[h+1];if(Array.isArray(y))for(let w=0;w<y.length;w+=2){const D=f[y[w]],L=y[w+1];try{L.call(D)}finally{}}else try{y.call(f)}finally{}}}}(r,s),function Xm(r,s){const l=r.cleanup,h=s[7];let f=-1;if(null!==l)for(let y=0;y<l.length-1;y+=2)if("string"==typeof l[y]){const w=l[y+1],D="function"==typeof w?w(s):Mn(s[w]),L=h[f=l[y+2]],B=l[y+3];"boolean"==typeof B?D.removeEventListener(l[y],L,B):B>=0?h[f=B]():h[f=-B].unsubscribe(),y+=2}else{const w=h[f=l[y+1]];l[y].call(w)}if(null!==h){for(let y=f+1;y<h.length;y++)h[y]();s[7]=null}}(r,s),1===s[1].type&&bt(s[11])&&s[11].destroy();const l=s[17];if(null!==l&&ni(s[3])){l!==s[3]&&hu(l,s);const h=s[19];null!==h&&h.detachView(r)}}}function _d(r,s,l){return function ao(r,s,l){let h=s;for(;null!==h&&40&h.type;)h=(s=h).parent;if(null===h)return l[0];if(2&h.flags){const f=r.data[h.directiveStart].encapsulation;if(f===Is.None||f===Is.Emulated)return null}return Qn(h,l)}(r,s.parent,l)}function du(r,s,l,h,f){bt(r)?r.insertBefore(s,l,h,f):s.insertBefore(l,h,f)}function lo(r,s,l){bt(r)?r.appendChild(s,l):s.appendChild(l)}function Ym(r,s,l,h,f){null!==h?du(r,s,l,h,f):lo(r,s,l)}function fu(r,s){return bt(r)?r.parentNode(s):s.parentNode}function ut(r,s,l){return Ts(r,s,l)}let Jm,Ts=function As(r,s,l){return 40&r.type?Qn(r,l):null};function Cs(r,s,l,h){const f=_d(r,h,s),y=s[11],D=ut(h.parent||s[6],h,s);if(null!=f)if(Array.isArray(l))for(let L=0;L<l.length;L++)Ym(y,f,l[L],D,!1);else Ym(y,f,l,D,!1)}function _c(r,s){if(null!==s){const l=s.type;if(3&l)return Qn(s,r);if(4&l)return Mr(-1,r[s.index]);if(8&l){const h=s.child;if(null!==h)return _c(r,h);{const f=r[s.index];return ni(f)?Mr(-1,f):Mn(f)}}if(32&l)return Wf(s,r)()||Mn(r[s.index]);{const h=Fx(r,s);return null!==h?Array.isArray(h)?h[0]:_c(vd(r[16]),h):_c(r,s.next)}}return null}function Fx(r,s){return null!==s?r[16][6].projection[s.projection]:null}function Mr(r,s){const l=10+r+1;if(l<s.length){const h=s[l],f=h[1].firstChild;if(null!==f)return _c(h,f)}return s[7]}function sr(r,s,l,h,f,y,w){for(;null!=l;){const D=h[l.index],L=l.type;if(w&&0===s&&(D&&us(Mn(D),h),l.flags|=4),64!=(64&l.flags))if(8&L)sr(r,s,l.child,h,f,y,!1),ah(s,r,f,D,y);else if(32&L){const B=Wf(l,h);let W;for(;W=B();)ah(s,r,f,W,y);ah(s,r,f,D,y)}else 16&L?Nx(r,s,h,l,f,y):ah(s,r,f,D,y);l=w?l.projectionNext:l.next}}function Xf(r,s,l,h,f,y){sr(l,h,r.firstChild,s,f,y,!1)}function Nx(r,s,l,h,f,y){const w=l[16],L=w[6].projection[h.projection];if(Array.isArray(L))for(let B=0;B<L.length;B++)ah(s,r,f,L[B],y);else sr(r,s,L,w[3],f,y,!0)}function kx(r,s,l){bt(r)?r.setAttribute(s,"style",l):s.style.cssText=l}function qf(r,s,l){bt(r)?""===l?r.removeAttribute(s,"class"):r.setAttribute(s,"class",l):s.className=l}function ch(r){var s;return(null===(s=function qt(){if(void 0===Jm&&(Jm=null,fi.trustedTypes))try{Jm=fi.trustedTypes.createPolicy("angular",{createHTML:r=>r,createScript:r=>r,createScriptURL:r=>r})}catch(r){}return Jm}())||void 0===s?void 0:s.createHTML(r))||r}class Ro{constructor(s){this.changingThisBreaksApplicationSecurity=s}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class Yf extends Ro{getTypeName(){return"HTML"}}class gy extends Ro{getTypeName(){return"Style"}}class hh extends Ro{getTypeName(){return"Script"}}class dh extends Ro{getTypeName(){return"URL"}}class fh extends Ro{getTypeName(){return"ResourceURL"}}function Ca(r){return r instanceof Ro?r.changingThisBreaksApplicationSecurity:r}function kl(r,s){const l=xd(r);if(null!=l&&l!==s){if("ResourceURL"===l&&"URL"===s)return!0;throw new Error(`Required a safe ${s}, got a ${l} (see https://g.co/ng/security#xss)`)}return l===s}function xd(r){return r instanceof Ro&&r.getTypeName()||null}function Zf(r){return new Yf(r)}function Kf(r){return new gy(r)}function vy(r){return new hh(r)}function yy(r){return new dh(r)}function _y(r){return new fh(r)}class Jf{constructor(s){this.inertDocumentHelper=s}getInertBodyElement(s){s="<body><remove></remove>"+s;try{const l=(new window.DOMParser).parseFromString(ch(s),"text/html").body;return null===l?this.inertDocumentHelper.getInertBodyElement(s):(l.removeChild(l.firstChild),l)}catch(l){return null}}}class Ji{constructor(s){if(this.defaultDoc=s,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const l=this.inertDocument.createElement("html");this.inertDocument.appendChild(l);const h=this.inertDocument.createElement("body");l.appendChild(h)}}getInertBodyElement(s){const l=this.inertDocument.createElement("template");if("content"in l)return l.innerHTML=ch(s),l;const h=this.inertDocument.createElement("body");return h.innerHTML=ch(s),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(h),h}stripCustomNsAttrs(s){const l=s.attributes;for(let f=l.length-1;0<f;f--){const w=l.item(f).name;("xmlns:ns1"===w||0===w.indexOf("ns1:"))&&s.removeAttribute(w)}let h=s.firstChild;for(;h;)h.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(h),h=h.nextSibling}}const Qf=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,mh=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Qr(r){return(r=String(r)).match(Qf)||r.match(mh)?r:"unsafe:"+r}function Da(r){const s={};for(const l of r.split(","))s[l]=!0;return s}function xc(...r){const s={};for(const l of r)for(const h in l)l.hasOwnProperty(h)&&(s[h]=!0);return s}const My=Da("area,br,col,hr,img,wbr"),by=Da("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),es=Da("rp,rt"),Mc=xc(My,xc(by,Da("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),xc(es,Da("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),xc(es,by)),eg=Da("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),gh=Da("srcset"),Sy=xc(eg,gh,Da("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Da("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),Vx=Da("script,style,template");class bc{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(s){let l=s.firstChild,h=!0;for(;l;)if(l.nodeType===Node.ELEMENT_NODE?h=this.startElement(l):l.nodeType===Node.TEXT_NODE?this.chars(l.nodeValue):this.sanitizedSomething=!0,h&&l.firstChild)l=l.firstChild;else for(;l;){l.nodeType===Node.ELEMENT_NODE&&this.endElement(l);let f=this.checkClobberedElement(l,l.nextSibling);if(f){l=f;break}l=this.checkClobberedElement(l,l.parentNode)}return this.buf.join("")}startElement(s){const l=s.nodeName.toLowerCase();if(!Mc.hasOwnProperty(l))return this.sanitizedSomething=!0,!Vx.hasOwnProperty(l);this.buf.push("<"),this.buf.push(l);const h=s.attributes;for(let f=0;f<h.length;f++){const y=h.item(f),w=y.name,D=w.toLowerCase();if(!Sy.hasOwnProperty(D)){this.sanitizedSomething=!0;continue}let L=y.value;eg[D]&&(L=Qr(L)),gh[D]&&(r=L,L=(r=String(r)).split(",").map(s=>Qr(s.trim())).join(", ")),this.buf.push(" ",w,'="',tp(L),'"')}var r;return this.buf.push(">"),!0}endElement(s){const l=s.nodeName.toLowerCase();Mc.hasOwnProperty(l)&&!My.hasOwnProperty(l)&&(this.buf.push("</"),this.buf.push(l),this.buf.push(">"))}chars(s){this.buf.push(tp(s))}checkClobberedElement(s,l){if(l&&(s.compareDocumentPosition(l)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${s.outerHTML}`);return l}}const mu=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,ep=/([^\#-~ |!])/g;function tp(r){return r.replace(/&/g,"&amp;").replace(mu,function(s){return"&#"+(1024*(s.charCodeAt(0)-55296)+(s.charCodeAt(1)-56320)+65536)+";"}).replace(ep,function(s){return"&#"+s.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let wd;function Ay(r,s){let l=null;try{wd=wd||function Md(r){const s=new Ji(r);return function Bx(){try{return!!(new window.DOMParser).parseFromString(ch(""),"text/html")}catch(r){return!1}}()?new Jf(s):s}(r);let h=s?String(s):"";l=wd.getInertBodyElement(h);let f=5,y=h;do{if(0===f)throw new Error("Failed to sanitize html because the input is unstable");f--,h=y,y=l.innerHTML,l=wd.getInertBodyElement(h)}while(h!==y);return ch((new bc).sanitizeChildren(Ul(l)||l))}finally{if(l){const h=Ul(l)||l;for(;h.firstChild;)h.removeChild(h.firstChild)}}}function Ul(r){return"content"in r&&function zx(r){return r.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===r.nodeName}(r)?r.content:null}var Rr=(()=>((Rr=Rr||{})[Rr.NONE=0]="NONE",Rr[Rr.HTML=1]="HTML",Rr[Rr.STYLE=2]="STYLE",Rr[Rr.SCRIPT=3]="SCRIPT",Rr[Rr.URL=4]="URL",Rr[Rr.RESOURCE_URL=5]="RESOURCE_URL",Rr))();function tg(r){const s=function Ed(){const r=Ze();return r&&r[12]}();return s?s.sanitize(Rr.URL,r)||"":kl(r,"URL")?Ca(r):Qr(qe(r))}function ig(r){return r.ngOriginalError}function Jx(r,...s){r.error(...s)}class np{constructor(){this._console=console}handleError(s){const l=this._findOriginalError(s),h=function Kx(r){return r&&r.ngErrorLogger||Jx}(s);h(this._console,"ERROR",s),l&&h(this._console,"ORIGINAL ERROR",l)}_findOriginalError(s){let l=s&&ig(s);for(;l&&ig(l);)l=ig(l);return l||null}}const sM=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(fi))();function il(r){return r instanceof Function?r():r}function Dy(r,s,l){let h=r.length;for(;;){const f=r.indexOf(s,l);if(-1===f)return f;if(0===f||r.charCodeAt(f-1)<=32){const y=s.length;if(f+y===h||r.charCodeAt(f+y)<=32)return f}l=f+1}}const Ry="ng-template";function cM(r,s,l){let h=0;for(;h<r.length;){let f=r[h++];if(l&&"class"===f){if(f=r[h],-1!==Dy(f.toLowerCase(),s,0))return!0}else if(1===f){for(;h<r.length&&"string"==typeof(f=r[h++]);)if(f.toLowerCase()===s)return!0;return!1}}return!1}function Iy(r){return 4===r.type&&r.value!==Ry}function uM(r,s,l){return s===(4!==r.type||l?r.value:Ry)}function hM(r,s,l){let h=4;const f=r.attrs||[],y=function pM(r){for(let s=0;s<r.length;s++)if(xa(r[s]))return s;return r.length}(f);let w=!1;for(let D=0;D<s.length;D++){const L=s[D];if("number"!=typeof L){if(!w)if(4&h){if(h=2|1&h,""!==L&&!uM(r,L,l)||""===L&&1===s.length){if(Ra(h))return!1;w=!0}}else{const B=8&h?L:s[++D];if(8&h&&null!==r.attrs){if(!cM(r.attrs,B,l)){if(Ra(h))return!1;w=!0}continue}const te=dM(8&h?"class":L,f,Iy(r),l);if(-1===te){if(Ra(h))return!1;w=!0;continue}if(""!==B){let ae;ae=te>y?"":f[te+1].toLowerCase();const ge=8&h?ae:null;if(ge&&-1!==Dy(ge,B,0)||2&h&&B!==ae){if(Ra(h))return!1;w=!0}}}}else{if(!w&&!Ra(h)&&!Ra(L))return!1;if(w&&Ra(L))continue;w=!1,h=L|1&h}}return Ra(h)||w}function Ra(r){return 0==(1&r)}function dM(r,s,l,h){if(null===s)return-1;let f=0;if(h||!l){let y=!1;for(;f<s.length;){const w=s[f];if(w===r)return f;if(3===w||6===w)y=!0;else{if(1===w||2===w){let D=s[++f];for(;"string"==typeof D;)D=s[++f];continue}if(4===w)break;if(0===w){f+=4;continue}}f+=y?1:2}return-1}return function mM(r,s){let l=r.indexOf(4);if(l>-1)for(l++;l<r.length;){const h=r[l];if("number"==typeof h)return-1;if(h===s)return l;l++}return-1}(s,r)}function Py(r,s,l=!1){for(let h=0;h<s.length;h++)if(hM(r,s[h],l))return!0;return!1}function gM(r,s){e:for(let l=0;l<s.length;l++){const h=s[l];if(r.length===h.length){for(let f=0;f<r.length;f++)if(r[f]!==h[f])continue e;return!0}}return!1}function Ly(r,s){return r?":not("+s.trim()+")":s}function vM(r){let s=r[0],l=1,h=2,f="",y=!1;for(;l<r.length;){let w=r[l];if("string"==typeof w)if(2&h){const D=r[++l];f+="["+w+(D.length>0?'="'+D+'"':"")+"]"}else 8&h?f+="."+w:4&h&&(f+=" "+w);else""!==f&&!Ra(w)&&(s+=Ly(y,f),f=""),h=w,y=y||!Ra(h);l++}return""!==f&&(s+=Ly(y,f)),s}const Nn={};function Oy(r){Fy(Tn(),Ze(),Dr()+r,!1)}function Fy(r,s,l,h){if(!h)if(3==(3&s[2])){const y=r.preOrderCheckHooks;null!==y&&Eo(s,y,l)}else{const y=r.preOrderHooks;null!==y&&So(s,y,0,l)}bo(l)}function ip(r,s){return r<<17|s<<2}function Ia(r){return r>>17&32767}function rg(r){return 2|r}function Bl(r){return(131068&r)>>2}function sg(r,s){return-131069&r|s<<2}function og(r){return 1|r}function DM(r,s){const l=r.contentQueries;if(null!==l)for(let h=0;h<l.length;h+=2){const f=l[h],y=l[h+1];if(-1!==y){const w=r.data[y];Xc(f),w.contentQueries(2,s[y],y)}}}function op(r,s,l,h,f,y,w,D,L,B){const W=s.blueprint.slice();return W[0]=f,W[2]=140|h,$u(W),W[3]=W[15]=r,W[8]=l,W[10]=w||r&&r[10],W[11]=D||r&&r[11],W[12]=L||r&&r[12]||null,W[9]=B||r&&r[9]||null,W[6]=y,W[16]=2==s.type?r[16]:W,W}function Sd(r,s,l,h,f){let y=r.data[s];if(null===y)y=function Xy(r,s,l,h,f){const y=ac(),w=qr(),L=r.data[s]=function KE(r,s,l,h,f,y){return{type:l,index:h,insertBeforeIndex:null,injectorIndex:s?s.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:f,attrs:y,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:s,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,w?y:y&&y.parent,l,s,h,f);return null===r.firstChild&&(r.firstChild=L),null!==y&&(w?null==y.child&&null!==L.parent&&(y.child=L):null===y.next&&(y.next=L)),L}(r,s,l,h,f),function jc(){return En.lFrame.inI18n}()&&(y.flags|=64);else if(64&y.type){y.type=l,y.value=h,y.attrs=f;const w=function js(){const r=En.lFrame,s=r.currentTNode;return r.isParent?s:s.parent}();y.injectorIndex=null===w?-1:w.injectorIndex}return $s(y,!0),y}function Ad(r,s,l,h){if(0===l)return-1;const f=s.length;for(let y=0;y<l;y++)s.push(h),r.blueprint.push(h),r.data.push(null);return f}function ap(r,s,l){Al(s);try{const h=r.viewQuery;null!==h&&hp(1,h,l);const f=r.template;null!==f&&RM(r,s,f,1,l),r.firstCreatePass&&(r.firstCreatePass=!1),r.staticContentQueries&&DM(r,s),r.staticViewQueries&&hp(2,r.viewQuery,l);const y=r.components;null!==y&&function qE(r,s){for(let l=0;l<s.length;l++)zM(r,s[l])}(s,y)}catch(h){throw r.firstCreatePass&&(r.incompleteFirstPass=!0,r.firstCreatePass=!1),h}finally{s[2]&=-5,Mo()}}function Td(r,s,l,h){const f=s[2];if(256!=(256&f)){Al(s);try{$u(s),function lc(r){return En.lFrame.bindingIndex=r}(r.bindingStartIndex),null!==l&&RM(r,s,l,2,h);const w=3==(3&f);if(w){const B=r.preOrderCheckHooks;null!==B&&Eo(s,B,null)}else{const B=r.preOrderHooks;null!==B&&So(s,B,0,null),fc(s,0)}if(function n0(r){for(let s=Ea(r);null!==s;s=sh(s)){if(!s[2])continue;const l=s[9];for(let h=0;h<l.length;h++){const f=l[h],y=f[3];0==(1024&f[2])&&Ii(y,1),f[2]|=1024}}}(s),function t0(r){for(let s=Ea(r);null!==s;s=sh(s))for(let l=10;l<s.length;l++){const h=s[l],f=h[1];Fs(h)&&Td(f,h,f.template,h[8])}}(s),null!==r.contentQueries&&DM(r,s),w){const B=r.contentCheckHooks;null!==B&&Eo(s,B)}else{const B=r.contentHooks;null!==B&&So(s,B,1),fc(s,1)}!function $E(r,s){const l=r.hostBindingOpCodes;if(null!==l)try{for(let h=0;h<l.length;h++){const f=l[h];if(f<0)bo(~f);else{const y=f,w=l[++h],D=l[++h];wl(w,y),D(2,s[y])}}}finally{bo(-1)}}(r,s);const D=r.components;null!==D&&function XE(r,s){for(let l=0;l<s.length;l++)vg(r,s[l])}(s,D);const L=r.viewQuery;if(null!==L&&hp(2,L,h),w){const B=r.viewCheckHooks;null!==B&&Eo(s,B)}else{const B=r.viewHooks;null!==B&&So(s,B,2),fc(s,2)}!0===r.firstUpdatePass&&(r.firstUpdatePass=!1),s[2]&=-73,1024&s[2]&&(s[2]&=-1025,Ii(s[3],-1))}finally{Mo()}}}function YE(r,s,l,h){const f=s[10],w=Fi(s);try{!w&&f.begin&&f.begin(),w&&ap(r,s,h),Td(r,s,l,h)}finally{!w&&f.end&&f.end()}}function RM(r,s,l,h,f){const y=Dr(),w=2&h;try{bo(-1),w&&s.length>20&&Fy(r,s,20,!1),l(h,f)}finally{bo(y)}}function qy(r,s,l){!oc()||(function BM(r,s,l,h){const f=l.directiveStart,y=l.directiveEnd;r.firstCreatePass||C(l,s),us(h,s);const w=l.initialInputs;for(let D=f;D<y;D++){const L=r.data[D],B=ur(L);B&&_h(s,l,L);const W=yr(s,r,D,l);us(W,s),null!==w&&VM(0,D-f,W,L,0,w),B&&(Ai(l.index,s)[8]=W)}}(r,s,l,Qn(l,s)),128==(128&l.flags)&&function yh(r,s,l){const h=l.directiveStart,f=l.directiveEnd,w=l.index,D=function $c(){return En.lFrame.currentDirectiveIndex}();try{bo(w);for(let L=h;L<f;L++){const B=r.data[L],W=s[L];ga(L),(null!==B.hostBindings||0!==B.hostVars||null!==B.hostAttrs)&&vu(B,W)}}finally{bo(-1),ga(D)}}(r,s,l))}function Yy(r,s,l=Qn){const h=s.localNames;if(null!==h){let f=s.index+1;for(let y=0;y<h.length;y+=2){const w=h[y+1],D=-1===w?l(s,r):r[w];r[f++]=D}}}function PM(r){const s=r.tView;return null===s||s.incompleteFirstPass?r.tView=fg(1,null,r.template,r.decls,r.vars,r.directiveDefs,r.pipeDefs,r.viewQuery,r.schemas,r.consts):s}function fg(r,s,l,h,f,y,w,D,L,B){const W=20+h,te=W+f,ae=function ZE(r,s){const l=[];for(let h=0;h<s;h++)l.push(h<r?null:Nn);return l}(W,te),ge="function"==typeof B?B():B;return ae[1]={type:r,blueprint:ae,template:l,queries:null,viewQuery:D,declTNode:s,data:ae.slice().fill(null,W),bindingStartIndex:W,expandoStartIndex:te,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof y?y():y,pipeRegistry:"function"==typeof w?w():w,firstChild:null,schemas:L,consts:ge,incompleteFirstPass:!1}}function FM(r,s,l,h){const f=bg(s);null===l?f.push(h):(f.push(l),r.firstCreatePass&&wg(r).push(h,f.length-1))}function NM(r,s,l){for(let h in r)if(r.hasOwnProperty(h)){const f=r[h];(l=null===l?{}:l).hasOwnProperty(h)?l[h].push(s,f):l[h]=[s,f]}return l}function pg(r,s,l,h){let f=!1;if(oc()){const y=function Ky(r,s,l){const h=r.directiveRegistry;let f=null;if(h)for(let y=0;y<h.length;y++){const w=h[y];Py(l,w.selectors,!1)&&(f||(f=[]),ne(C(l,s),r,w.type),ur(w)?(Ec(r,l),f.unshift(w)):f.push(w))}return f}(r,s,l),w=null===h?null:{"":-1};if(null!==y){f=!0,lp(l,r.data.length,y.length);for(let W=0;W<y.length;W++){const te=y[W];te.providersResolver&&te.providersResolver(te)}let D=!1,L=!1,B=Ad(r,s,y.length,null);for(let W=0;W<y.length;W++){const te=y[W];l.mergedAttrs=Tl(l.mergedAttrs,te.hostAttrs),Sc(r,l,s,B,te),Jy(B,te,w),null!==te.contentQueries&&(l.flags|=8),(null!==te.hostBindings||null!==te.hostAttrs||0!==te.hostVars)&&(l.flags|=128);const ae=te.type.prototype;!D&&(ae.ngOnChanges||ae.ngOnInit||ae.ngDoCheck)&&((r.preOrderHooks||(r.preOrderHooks=[])).push(l.index),D=!0),!L&&(ae.ngOnChanges||ae.ngDoCheck)&&((r.preOrderCheckHooks||(r.preOrderCheckHooks=[])).push(l.index),L=!0),B++}!function JE(r,s){const h=s.directiveEnd,f=r.data,y=s.attrs,w=[];let D=null,L=null;for(let B=s.directiveStart;B<h;B++){const W=f[B],te=W.inputs,ae=null===y||Iy(s)?null:Qy(te,y);w.push(ae),D=NM(te,B,D),L=NM(W.outputs,B,L)}null!==D&&(D.hasOwnProperty("class")&&(s.flags|=16),D.hasOwnProperty("style")&&(s.flags|=32)),s.initialInputs=w,s.inputs=D,s.outputs=L}(r,l)}w&&function mg(r,s,l){if(s){const h=r.localNames=[];for(let f=0;f<s.length;f+=2){const y=l[s[f+1]];if(null==y)throw new vt(-301,!1);h.push(s[f],y)}}}(l,h,w)}return l.mergedAttrs=Tl(l.mergedAttrs,l.attrs),f}function Zy(r,s,l,h,f,y){const w=y.hostBindings;if(w){let D=r.hostBindingOpCodes;null===D&&(D=r.hostBindingOpCodes=[]);const L=~s.index;(function UM(r){let s=r.length;for(;s>0;){const l=r[--s];if("number"==typeof l&&l<0)return l}return 0})(D)!=L&&D.push(L),D.push(h,f,w)}}function vu(r,s){null!==r.hostBindings&&r.hostBindings(1,s)}function Ec(r,s){s.flags|=2,(r.components||(r.components=[])).push(s.index)}function Jy(r,s,l){if(l){if(s.exportAs)for(let h=0;h<s.exportAs.length;h++)l[s.exportAs[h]]=r;ur(s)&&(l[""]=r)}}function lp(r,s,l){r.flags|=1,r.directiveStart=s,r.directiveEnd=s+l,r.providerIndexes=s}function Sc(r,s,l,h,f){r.data[h]=f;const y=f.factory||(f.factory=os(f.type)),w=new Ao(y,ur(f),null);r.blueprint[h]=w,l[h]=w,Zy(r,s,0,h,Ad(r,l,f.hostVars,Nn),f)}function _h(r,s,l){const h=Qn(s,r),f=PM(l),y=r[10],w=up(r,op(r,f,null,l.onPush?64:16,h,s,y,y.createRenderer(h,l),null,null));r[s.index]=w}function Pa(r,s,l,h,f,y){const w=Qn(r,s);!function cp(r,s,l,h,f,y,w){if(null==y)bt(r)?r.removeAttribute(s,f,l):s.removeAttribute(f);else{const D=null==w?qe(y):w(y,h||"",f);bt(r)?r.setAttribute(s,f,D,l):l?s.setAttributeNS(l,f,D):s.setAttribute(f,D)}}(s[11],w,y,r.value,l,h,f)}function VM(r,s,l,h,f,y){const w=y[s];if(null!==w){const D=h.setInput;for(let L=0;L<w.length;){const B=w[L++],W=w[L++],te=w[L++];null!==D?h.setInput(l,te,B,W):l[W]=te}}}function Qy(r,s){let l=null,h=0;for(;h<s.length;){const f=s[h];if(0!==f)if(5!==f){if("number"==typeof f)break;r.hasOwnProperty(f)&&(null===l&&(l=[]),l.push(f,r[f],s[h+1])),h+=2}else h+=2;else h+=4}return l}function e0(r,s,l,h){return new Array(r,!0,!1,s,null,0,h,l,null,null)}function vg(r,s){const l=Ai(s,r);if(Fs(l)){const h=l[1];80&l[2]?Td(h,l,h.template,l[8]):l[5]>0&&yg(l)}}function yg(r){for(let h=Ea(r);null!==h;h=sh(h))for(let f=10;f<h.length;f++){const y=h[f];if(1024&y[2]){const w=y[1];Td(w,y,w.template,y[8])}else y[5]>0&&yg(y)}const l=r[1].components;if(null!==l)for(let h=0;h<l.length;h++){const f=Ai(l[h],r);Fs(f)&&f[5]>0&&yg(f)}}function zM(r,s){const l=Ai(s,r),h=l[1];(function HM(r,s){for(let l=s.length;l<r.blueprint.length;l++)s.push(r.blueprint[l])})(h,l),ap(h,l,l[8])}function up(r,s){return r[13]?r[14][4]=s:r[13]=s,r[14]=s,s}function _g(r){for(;r;){r[2]|=64;const s=vd(r);if(Br(r)&&!s)return r;r=s}return null}function r0(r){!function xg(r){for(let s=0;s<r.components.length;s++){const l=r.components[s],h=gd(l),f=h[1];YE(f,h,f.template,l)}}(r[8])}function hp(r,s,l){Xc(0),s(r,l)}const s0=(()=>Promise.resolve(null))();function bg(r){return r[7]||(r[7]=[])}function wg(r){return r.cleanup||(r.cleanup=[])}function Sg(r,s){const l=r[9],h=l?l.get(np,null):null;h&&h.handleError(s)}function yu(r,s,l,h,f){for(let y=0;y<l.length;){const w=l[y++],D=l[y++],L=s[w],B=r.data[w];null!==B.setInput?B.setInput(L,f,h,D):L[D]=f}}function Hi(r,s,l){const h=ii(s,r);!function Gm(r,s,l){bt(r)?r.setValue(s,l):s.textContent=l}(r[11],h,l)}function br(r,s,l){let h=l?r.styles:null,f=l?r.classes:null,y=0;if(null!==s)for(let w=0;w<s.length;w++){const D=s[w];"number"==typeof D?y=D:1==y?f=pn(f,D):2==y&&(h=pn(h,D+": "+s[++w]+";"))}l?r.styles=h:r.stylesWithoutHost=h,l?r.classes=f:r.classesWithoutHost=f}const Ag=new Pi("INJECTOR",-1);class o0{get(s,l=el){if(l===el){const h=new Error(`NullInjectorError: No provider for ${Qe(s)}!`);throw h.name="NullInjectorError",h}return l}}const Tg=new Pi("Set Injector scope."),Dd={},qM={};let Cg;function a0(){return void 0===Cg&&(Cg=new o0),Cg}function l0(r,s=null,l=null,h){const f=c0(r,s,l,h);return f._resolveInjectorDefTypes(),f}function c0(r,s=null,l=null,h){return new YM(r,l,s||a0(),h)}class YM{constructor(s,l,h,f=null){this.parent=h,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const y=[];l&&Qa(l,D=>this.processProvider(D,s,l)),Qa([s],D=>this.processInjectorType(D,[],y)),this.records.set(Ag,xh(void 0,this));const w=this.records.get(Tg);this.scope=null!=w?w.value:null,this.source=f||("object"==typeof s?null:Qe(s))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(s=>s.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(s,l=el,h=hn.Default){this.assertNotDestroyed();const f=ru(this),y=tn(void 0);try{if(!(h&hn.SkipSelf)){let D=this.records.get(s);if(void 0===D){const L=function ib(r){return"function"==typeof r||"object"==typeof r&&r instanceof Pi}(s)&&fs(s);D=L&&this.injectableDefInScope(L)?xh(Dg(s),Dd):null,this.records.set(s,D)}if(null!=D)return this.hydrate(s,D)}return(h&hn.Self?a0():this.parent).get(s,l=h&hn.Optional&&l===el?null:l)}catch(w){if("NullInjectorError"===w.name){if((w[kf]=w[kf]||[]).unshift(Qe(s)),f)throw w;return function Px(r,s,l,h){const f=r[kf];throw s[cy]&&f.unshift(s[cy]),r.message=function ba(r,s,l,h=null){r=r&&"\n"===r.charAt(0)&&"\u0275"==r.charAt(1)?r.substr(2):r;let f=Qe(s);if(Array.isArray(s))f=s.map(Qe).join(" -> ");else if("object"==typeof s){let y=[];for(let w in s)if(s.hasOwnProperty(w)){let D=s[w];y.push(w+":"+("string"==typeof D?JSON.stringify(D):Qe(D)))}f=`{${y.join(", ")}}`}return`${l}${h?"("+h+")":""}[${f}]: ${r.replace(Dx,"\n  ")}`}("\n"+r.message,f,l,h),r.ngTokenPath=f,r[kf]=null,r}(w,s,"R3InjectorError",this.source)}throw w}finally{tn(y),ru(f)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(s=>this.get(s))}toString(){const s=[];return this.records.forEach((h,f)=>s.push(Qe(f))),`R3Injector[${s.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new vt(205,!1)}processInjectorType(s,l,h){if(!(s=Pt(s)))return!1;let f=fo(s);const y=null==f&&s.ngModule||void 0,w=void 0===y?s:y,D=-1!==h.indexOf(w);if(void 0!==y&&(f=fo(y)),null==f)return!1;if(null!=f.imports&&!D){let W;h.push(w);try{Qa(f.imports,te=>{this.processInjectorType(te,l,h)&&(void 0===W&&(W=[]),W.push(te))})}finally{}if(void 0!==W)for(let te=0;te<W.length;te++){const{ngModule:ae,providers:ge}=W[te];Qa(ge,Ve=>this.processProvider(Ve,ae,ge||ti))}}this.injectorDefTypes.add(w);const L=os(w)||(()=>new w);this.records.set(w,xh(L,Dd));const B=f.providers;if(null!=B&&!D){const W=s;Qa(B,te=>this.processProvider(te,W,B))}return void 0!==y&&void 0!==s.providers}processProvider(s,l,h){let f=Mh(s=Pt(s))?s:Pt(s&&s.provide);const y=function KM(r,s,l){return h0(r)?xh(void 0,r.useValue):xh(u0(r),Dd)}(s);if(Mh(s)||!0!==s.multi)this.records.get(f);else{let w=this.records.get(f);w||(w=xh(void 0,Dd,!0),w.factory=()=>Um(w.multi),this.records.set(f,w)),f=s,w.multi.push(s)}this.records.set(f,y)}hydrate(s,l){return l.value===Dd&&(l.value=qM,l.value=l.factory()),"object"==typeof l.value&&l.value&&function nb(r){return null!==r&&"object"==typeof r&&"function"==typeof r.ngOnDestroy}(l.value)&&this.onDestroy.add(l.value),l.value}injectableDefInScope(s){if(!s.providedIn)return!1;const l=Pt(s.providedIn);return"string"==typeof l?"any"===l||l===this.scope:this.injectorDefTypes.has(l)}}function Dg(r){const s=fs(r),l=null!==s?s.factory:os(r);if(null!==l)return l;if(r instanceof Pi)throw new vt(204,!1);if(r instanceof Function)return function ZM(r){const s=r.length;if(s>0)throw ld(s,"?"),new vt(204,!1);const l=function Bc(r){const s=r&&(r[Fo]||r[Va]);if(s){const l=function Zi(r){if(r.hasOwnProperty("name"))return r.name;const s=(""+r).match(/^function\s*([^\s(]+)/);return null===s?"":s[1]}(r);return console.warn(`DEPRECATED: DI is instantiating a token "${l}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${l}" class.`),s}return null}(r);return null!==l?()=>l.factory(r):()=>new r}(r);throw new vt(204,!1)}function u0(r,s,l){let h;if(Mh(r)){const f=Pt(r);return os(f)||Dg(f)}if(h0(r))h=()=>Pt(r.useValue);else if(function QM(r){return!(!r||!r.useFactory)}(r))h=()=>r.useFactory(...Um(r.deps||[]));else if(function JM(r){return!(!r||!r.useExisting)}(r))h=()=>Es(Pt(r.useExisting));else{const f=Pt(r&&(r.useClass||r.provide));if(!function tb(r){return!!r.deps}(r))return os(f)||Dg(f);h=()=>new f(...Um(r.deps))}return h}function xh(r,s,l=!1){return{factory:r,value:s,multi:l?[]:void 0}}function h0(r){return null!==r&&"object"==typeof r&&Ix in r}function Mh(r){return"function"==typeof r}let rl=(()=>{class r{static create(l,h){var f;if(Array.isArray(l))return l0({name:""},h,l,"");{const y=null!==(f=l.name)&&void 0!==f?f:"";return l0({name:y},l.parent,l.providers,y)}}}return r.THROW_IF_NOT_FOUND=el,r.NULL=new o0,r.\u0275prov=di({token:r,providedIn:"any",factory:()=>Es(Ag)}),r.__NG_ELEMENT_ID__=-1,r})();function ub(r,s){va(gd(r)[1],rr())}function Ng(r){let s=function M0(r){return Object.getPrototypeOf(r.prototype).constructor}(r.type),l=!0;const h=[r];for(;s;){let f;if(ur(r))f=s.\u0275cmp||s.\u0275dir;else{if(s.\u0275cmp)throw new vt(903,"");f=s.\u0275dir}if(f){if(l){h.push(f);const w=r;w.inputs=fp(r.inputs),w.declaredInputs=fp(r.declaredInputs),w.outputs=fp(r.outputs);const D=f.hostBindings;D&&kg(r,D);const L=f.viewQuery,B=f.contentQueries;if(L&&b0(r,L),B&&hb(r,B),Jn(r.inputs,f.inputs),Jn(r.declaredInputs,f.declaredInputs),Jn(r.outputs,f.outputs),ur(f)&&f.data.animation){const W=r.data;W.animation=(W.animation||[]).concat(f.data.animation)}}const y=f.features;if(y)for(let w=0;w<y.length;w++){const D=y[w];D&&D.ngInherit&&D(r),D===Ng&&(l=!1)}}s=Object.getPrototypeOf(s)}!function Rd(r){let s=0,l=null;for(let h=r.length-1;h>=0;h--){const f=r[h];f.hostVars=s+=f.hostVars,f.hostAttrs=Tl(f.hostAttrs,l=Tl(l,f.hostAttrs))}}(h)}function fp(r){return r===qn?{}:r===ti?[]:r}function b0(r,s){const l=r.viewQuery;r.viewQuery=l?(h,f)=>{s(h,f),l(h,f)}:s}function hb(r,s){const l=r.contentQueries;r.contentQueries=l?(h,f,y)=>{s(h,f,y),l(h,f,y)}:s}function kg(r,s){const l=r.hostBindings;r.hostBindings=l?(h,f)=>{s(h,f),l(h,f)}:s}let Id=null;function bh(){if(!Id){const r=fi.Symbol;if(r&&r.iterator)Id=r.iterator;else{const s=Object.getOwnPropertyNames(Map.prototype);for(let l=0;l<s.length;++l){const h=s[l];"entries"!==h&&"size"!==h&&Map.prototype[h]===Map.prototype.entries&&(Id=h)}}}return Id}function Pd(r){return!!Ug(r)&&(Array.isArray(r)||!(r instanceof Map)&&bh()in r)}function Ug(r){return null!==r&&("function"==typeof r||"object"==typeof r)}function Bs(r,s,l){return!Object.is(r[s],l)&&(r[s]=l,!0)}function Bg(r,s,l,h){const f=Ze();return Bs(f,ma(),s)&&(Tn(),Pa(zi(),f,r,s,l,h)),Bg}function R0(r,s,l,h,f,y,w,D){const L=Ze(),B=Tn(),W=r+20,te=B.firstCreatePass?function vb(r,s,l,h,f,y,w,D,L){const B=s.consts,W=Sd(s,r,4,w||null,xs(B,D));pg(s,l,W,xs(B,L)),va(s,W);const te=W.tViews=fg(2,W,h,f,y,s.directiveRegistry,s.pipeRegistry,null,s.schemas,B);return null!==s.queries&&(s.queries.template(s,W),te.queries=s.queries.embeddedTView(W)),W}(W,B,L,s,l,h,f,y,w):B.data[W];$s(te,!1);const ae=L[11].createComment("");Cs(B,L,ae,te),us(ae,L),up(L,L[W]=e0(ae,L,ae,te)),ha(te)&&qy(B,L,te),null!=w&&Yy(L,te,D)}function wu(r,s=hn.Default){const l=Ze();return null===l?Es(r,s):Et(rr(),l,Pt(r),s)}function Ph(){throw new Error("invalid")}function Eu(r,s,l){const h=Ze();return Bs(h,ma(),s)&&function Ko(r,s,l,h,f,y,w,D){const L=Qn(s,l);let W,B=s.inputs;!D&&null!=B&&(W=B[h])?(yu(r,l,W,h,f),Ls(s)&&function eS(r,s){const l=Ai(s,r);16&l[2]||(l[2]|=64)}(l,s.index)):3&s.type&&(h=function QE(r){return"class"===r?"className":"for"===r?"htmlFor":"formaction"===r?"formAction":"innerHtml"===r?"innerHTML":"readonly"===r?"readOnly":"tabindex"===r?"tabIndex":r}(h),f=null!=w?w(f,s.value||"",h):f,bt(y)?y.setProperty(L,h,f):Ju(h)||(L.setProperty?L.setProperty(h,f):L[h]=f))}(Tn(),zi(),h,r,s,h[11],l,!1),Eu}function _p(r,s,l,h,f){const w=f?"class":"style";yu(r,l,s.inputs[w],w,h)}function Ac(r,s,l,h){const f=Ze(),y=Tn(),w=20+r,D=f[11],L=f[w]=Wm(D,s,function Yu(){return En.lFrame.currentNamespace}()),B=y.firstCreatePass?function Ab(r,s,l,h,f,y,w){const D=s.consts,B=Sd(s,r,2,f,xs(D,y));return pg(s,l,B,xs(D,w)),null!==B.attrs&&br(B,B.attrs,!1),null!==B.mergedAttrs&&br(B,B.mergedAttrs,!0),null!==s.queries&&s.queries.elementStart(s,B),B}(w,y,f,0,s,l,h):y.data[w];$s(B,!0);const W=B.mergedAttrs;null!==W&&pc(D,L,W);const te=B.classes;null!==te&&qf(D,L,te);const ae=B.styles;return null!==ae&&kx(D,L,ae),64!=(64&B.flags)&&Cs(y,f,L,B),0===function Rf(){return En.lFrame.elementDepthCount}()&&us(L,f),function Vo(){En.lFrame.elementDepthCount++}(),ha(B)&&(qy(y,f,B),function IM(r,s,l){if(Ga(s)){const f=s.directiveEnd;for(let y=s.directiveStart;y<f;y++){const w=r.data[y];w.contentQueries&&w.contentQueries(1,l[y],y)}}}(y,B,f)),null!==h&&Yy(f,B),Ac}function Tc(){let r=rr();qr()?Gc():(r=r.parent,$s(r,!1));const s=r;!function zo(){En.lFrame.elementDepthCount--}();const l=Tn();return l.firstCreatePass&&(va(l,r),Ga(r)&&l.queries.elementEnd(r)),null!=s.classesWithoutHost&&function Kc(r){return 0!=(16&r.flags)}(s)&&_p(l,s,Ze(),s.classesWithoutHost,!0),null!=s.stylesWithoutHost&&function Ku(r){return 0!=(32&r.flags)}(s)&&_p(l,s,Ze(),s.stylesWithoutHost,!1),Tc}function Cc(r,s,l,h){return Ac(r,s,l,h),Tc(),Cc}function Oh(){return Ze()}function bp(r){return!!r&&"function"==typeof r.then}function Vs(r){return!!r&&"function"==typeof r.subscribe}const Zg=Vs;function wp(r,s,l,h){const f=Ze(),y=Tn(),w=rr();return function jd(r,s,l,h,f,y,w,D){const L=ha(h),W=r.firstCreatePass&&wg(r),te=s[8],ae=bg(s);let ge=!0;if(3&h.type||D){const Rt=Qn(h,s),Wt=D?D(Rt):Rt,Xe=ae.length,_n=D?In=>D(Mn(In[h.index])):h.index;if(bt(l)){let In=null;if(!D&&L&&(In=function Jg(r,s,l,h){const f=r.cleanup;if(null!=f)for(let y=0;y<f.length-1;y+=2){const w=f[y];if(w===l&&f[y+1]===h){const D=s[7],L=f[y+2];return D.length>L?D[L]:null}"string"==typeof w&&(y+=2)}return null}(r,s,f,h.index)),null!==In)(In.__ngLastListenerFn__||In).__ngNextListenerFn__=y,In.__ngLastListenerFn__=y,ge=!1;else{y=Ep(h,s,te,y,!1);const mi=l.listen(Wt,f,y);ae.push(y,mi),W&&W.push(f,_n,Xe,Xe+1)}}else y=Ep(h,s,te,y,!0),Wt.addEventListener(f,y,w),ae.push(y),W&&W.push(f,_n,Xe,w)}else y=Ep(h,s,te,y,!1);const Ve=h.outputs;let at;if(ge&&null!==Ve&&(at=Ve[f])){const Rt=at.length;if(Rt)for(let Wt=0;Wt<Rt;Wt+=2){const ho=s[at[Wt]][at[Wt+1]].subscribe(y),kc=ae.length;ae.push(y,ho),W&&W.push(f,h.index,kc,-(kc+1))}}}(y,f,f[11],w,r,s,!!l,h),wp}function zl(r,s,l,h){try{return!1!==l(h)}catch(f){return Sg(r,f),!1}}function Ep(r,s,l,h,f){return function y(w){if(w===Function)return h;const D=2&r.flags?Ai(r.index,s):s;0==(32&s[2])&&_g(D);let L=zl(s,0,h,w),B=y.__ngNextListenerFn__;for(;B;)L=zl(s,0,B,w)&&L,B=B.__ngNextListenerFn__;return f&&!1===L&&(w.preventDefault(),w.returnValue=!1),L}}function Qg(r=1){return function Zc(r){return(En.lFrame.contextLView=function Xu(r,s){for(;r>0;)s=s[15],r--;return s}(r,En.lFrame.contextLView))[8]}(r)}function $d(r,s){let l=null;const h=function fM(r){const s=r.attrs;if(null!=s){const l=s.indexOf(5);if(0==(1&l))return s[l+1]}return null}(r);for(let f=0;f<s.length;f++){const y=s[f];if("*"!==y){if(null===h?Py(r,y,!0):gM(h,y))return f}else l=f}return l}function ev(r){const s=Ze()[16][6];if(!s.projection){const h=s.projection=ld(r?r.length:1,null),f=h.slice();let y=s.child;for(;null!==y;){const w=r?$d(y,r):0;null!==w&&(f[w]?f[w].projectionNext=y:h[w]=y,f[w]=y),y=y.next}}}function Sp(r,s=0,l){const h=Ze(),f=Tn(),y=Sd(f,20+r,16,null,l||null);null===y.projection&&(y.projection=s),Gc(),64!=(64&y.flags)&&function xE(r,s,l){Nx(s[11],0,s,l,_d(r,l,s),ut(l.parent||s[6],l,s))}(f,h,y)}function Ap(r,s,l,h,f){const y=r[l+1],w=null===s;let D=h?Ia(y):Bl(y),L=!1;for(;0!==D&&(!1===L||w);){const W=r[D+1];Ib(r[D],s)&&(L=!0,r[D+1]=h?og(W):rg(W)),D=h?Ia(W):Bl(W)}L&&(r[l+1]=h?rg(y):og(y))}function Ib(r,s){return null===r||null==s||(Array.isArray(r)?r[1]:r)===s||!(!Array.isArray(r)||"string"!=typeof s)&&Kr(r,s)>=0}function Cp(r,s){return function ea(r,s,l,h){const f=Ze(),y=Tn(),w=function bs(r){const s=En.lFrame,l=s.bindingIndex;return s.bindingIndex=s.bindingIndex+r,l}(2);y.firstUpdatePass&&function W0(r,s,l,h){const f=r.data;if(null===f[l+1]){const y=f[Dr()],w=function Dp(r,s){return s>=r.expandoStartIndex}(r,l);(function Du(r,s){return 0!=(r.flags&(s?16:32))})(y,h)&&null===s&&!w&&(s=!1),s=function Rp(r,s,l,h){const f=function cc(r){const s=En.lFrame.currentDirectiveIndex;return-1===s?null:r[s]}(r);let y=h?s.residualClasses:s.residualStyles;if(null===f)0===(h?s.classBindings:s.styleBindings)&&(l=Au(l=Su(null,r,s,l,h),s.attrs,h),y=null);else{const w=s.directiveStylingLast;if(-1===w||r[w]!==f)if(l=Su(f,r,s,l,h),null===y){let L=function Ip(r,s,l){const h=l?s.classBindings:s.styleBindings;if(0!==Bl(h))return r[Ia(h)]}(r,s,h);void 0!==L&&Array.isArray(L)&&(L=Su(null,r,s,L[1],h),L=Au(L,s.attrs,h),function lv(r,s,l,h){r[Ia(l?s.classBindings:s.styleBindings)]=h}(r,s,h,L))}else y=function cv(r,s,l){let h;const f=s.directiveEnd;for(let y=1+s.directiveStylingLast;y<f;y++)h=Au(h,r[y].hostAttrs,l);return Au(h,s.attrs,l)}(r,s,h)}return void 0!==y&&(h?s.residualClasses=y:s.residualStyles=y),l}(f,y,s,h),function cS(r,s,l,h,f,y){let w=y?s.classBindings:s.styleBindings,D=Ia(w),L=Bl(w);r[h]=l;let W,B=!1;if(Array.isArray(l)){const te=l;W=te[1],(null===W||Kr(te,W)>0)&&(B=!0)}else W=l;if(f)if(0!==L){const ae=Ia(r[D+1]);r[h+1]=ip(ae,D),0!==ae&&(r[ae+1]=sg(r[ae+1],h)),r[D+1]=function xM(r,s){return 131071&r|s<<17}(r[D+1],h)}else r[h+1]=ip(D,0),0!==D&&(r[D+1]=sg(r[D+1],h)),D=h;else r[h+1]=ip(L,0),0===D?D=h:r[L+1]=sg(r[L+1],h),L=h;B&&(r[h+1]=rg(r[h+1])),Ap(r,W,h,!0),Ap(r,W,h,!1),function La(r,s,l,h,f){const y=f?r.residualClasses:r.residualStyles;null!=y&&"string"==typeof s&&Kr(y,s)>=0&&(l[h+1]=og(l[h+1]))}(s,W,r,h,y),w=ip(D,L),y?s.classBindings=w:s.styleBindings=w}(f,y,s,l,w,h)}}(y,r,w,h),s!==Nn&&Bs(f,w,s)&&function Jd(r,s,l,h,f,y,w,D){if(!(3&s.type))return;const L=r.data,B=L[D+1];Cu(function Uy(r){return 1==(1&r)}(B)?Op(L,s,l,f,Bl(B),w):void 0)||(Cu(y)||function ky(r){return 2==(2&r)}(B)&&(y=Op(L,null,l,f,D,w)),function Km(r,s,l,h,f){const y=bt(r);if(s)f?y?r.addClass(l,h):l.classList.add(h):y?r.removeClass(l,h):l.classList.remove(h);else{let w=-1===h.indexOf("-")?void 0:qo.DashCase;if(null==f)y?r.removeStyle(l,h,w):l.style.removeProperty(h);else{const D="string"==typeof f&&f.endsWith("!important");D&&(f=f.slice(0,-10),w|=qo.Important),y?r.setStyle(l,h,f,w):l.style.setProperty(h,f,D?"important":"")}}}(h,w,ii(Dr(),l),f,y))}(y,y.data[Dr()],f,f[11],r,f[w+1]=function j0(r,s){return null==r||("string"==typeof s?r+=s:"object"==typeof r&&(r=Qe(Ca(r)))),r}(s,l),h,w)}(r,s,null,!0),Cp}function Su(r,s,l,h,f){let y=null;const w=l.directiveEnd;let D=l.directiveStylingLast;for(-1===D?D=l.directiveStart:D++;D<w&&(y=s[D],h=Au(h,y.hostAttrs,f),y!==r);)D++;return null!==r&&(l.directiveStylingLast=D),h}function Au(r,s,l){const h=l?1:2;let f=-1;if(null!==s)for(let y=0;y<s.length;y++){const w=s[y];"number"==typeof w?f=w:f===h&&(Array.isArray(r)||(r=void 0===r?[]:["",r]),ks(r,w,!!l||s[++y]))}return void 0===r?null:r}function Op(r,s,l,h,f,y){const w=null===s;let D;for(;f>0;){const L=r[f],B=Array.isArray(L),W=B?L[1]:L,te=null===W;let ae=l[f+1];ae===Nn&&(ae=te?ti:void 0);let ge=te?Fm(ae,h):W===h?ae:void 0;if(B&&!Cu(ge)&&(ge=Fm(L,h)),Cu(ge)&&(D=ge,w))return D;const Ve=r[f+1];f=w?Ia(Ve):Bl(Ve)}if(null!==s){let L=y?s.residualClasses:s.residualStyles;null!=L&&(D=Fm(L,h))}return D}function Cu(r){return void 0!==r}function $0(r,s=""){const l=Ze(),h=Tn(),f=r+20,y=h.firstCreatePass?Sd(h,f,1,s,null):h.data[f],w=l[f]=function $f(r,s){return bt(r)?r.createText(s):r.createTextNode(s)}(l[11],s);Cs(h,l,w,y),$s(y,!1)}function Fp(r){return Hl("",r,""),Fp}function Hl(r,s,l){const h=Ze(),f=function xu(r,s,l,h){return Bs(r,ma(),l)?s+qe(l)+h:Nn}(h,r,s,l);return f!==Nn&&Hi(h,Dr(),f),Hl}const Gl=void 0;var Wb=["en",[["a","p"],["AM","PM"],Gl],[["AM","PM"],Gl,Gl],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Gl,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Gl,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Gl,"{1} 'at' {0}",Gl],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function fv(r){const l=Math.floor(Math.abs(r)),h=r.toString().replace(/^[^.]*\.?/,"").length;return 1===l&&0===h?1:5}];let na={};function tf(r){const s=function $b(r){return r.toLowerCase().replace(/_/g,"-")}(r);let l=l_(s);if(l)return l;const h=s.split("-")[0];if(l=l_(h),l)return l;if("en"===h)return Wb;throw new Error(`Missing locale data for the locale "${r}".`)}function Hp(r){return tf(r)[wn.PluralCase]}function l_(r){return r in na||(na[r]=fi.ng&&fi.ng.common&&fi.ng.common.locales&&fi.ng.common.locales[r]),na[r]}var wn=(()=>((wn=wn||{})[wn.LocaleId=0]="LocaleId",wn[wn.DayPeriodsFormat=1]="DayPeriodsFormat",wn[wn.DayPeriodsStandalone=2]="DayPeriodsStandalone",wn[wn.DaysFormat=3]="DaysFormat",wn[wn.DaysStandalone=4]="DaysStandalone",wn[wn.MonthsFormat=5]="MonthsFormat",wn[wn.MonthsStandalone=6]="MonthsStandalone",wn[wn.Eras=7]="Eras",wn[wn.FirstDayOfWeek=8]="FirstDayOfWeek",wn[wn.WeekendRange=9]="WeekendRange",wn[wn.DateFormat=10]="DateFormat",wn[wn.TimeFormat=11]="TimeFormat",wn[wn.DateTimeFormat=12]="DateTimeFormat",wn[wn.NumberSymbols=13]="NumberSymbols",wn[wn.NumberFormats=14]="NumberFormats",wn[wn.CurrencyCode=15]="CurrencyCode",wn[wn.CurrencySymbol=16]="CurrencySymbol",wn[wn.CurrencyName=17]="CurrencyName",wn[wn.Currencies=18]="Currencies",wn[wn.Directionality=19]="Directionality",wn[wn.PluralCase=20]="PluralCase",wn[wn.ExtraData=21]="ExtraData",wn))();const ia="en-US";let c_=ia;function Xl(r,s,l,h,f){if(r=Pt(r),Array.isArray(r))for(let y=0;y<r.length;y++)Xl(r[y],s,l,h,f);else{const y=Tn(),w=Ze();let D=Mh(r)?r:Pt(r.provide),L=u0(r);const B=rr(),W=1048575&B.providerIndexes,te=B.directiveStart,ae=B.providerIndexes>>20;if(Mh(r)||!r.multi){const ge=new Ao(L,f,wu),Ve=ql(D,s,f?W:W+ae,te);-1===Ve?(ne(C(B,w),y,D),tm(y,r,s.length),s.push(D),B.directiveStart++,B.directiveEnd++,f&&(B.providerIndexes+=1048576),l.push(ge),w.push(ge)):(l[Ve]=ge,w[Ve]=ge)}else{const ge=ql(D,s,W+ae,te),Ve=ql(D,s,W,W+ae),at=ge>=0&&l[ge],Rt=Ve>=0&&l[Ve];if(f&&!Rt||!f&&!at){ne(C(B,w),y,D);const Wt=function Av(r,s,l,h,f){const y=new Ao(r,l,wu);return y.multi=[],y.index=s,y.componentProviders=0,S_(y,f,h&&!l),y}(f?MS:xS,l.length,f,h,L);!f&&Rt&&(l[Ve].providerFactory=Wt),tm(y,r,s.length,0),s.push(D),B.directiveStart++,B.directiveEnd++,f&&(B.providerIndexes+=1048576),l.push(Wt),w.push(Wt)}else tm(y,r,ge>-1?ge:Ve,S_(l[f?Ve:ge],L,!f&&h));!f&&h&&Rt&&l[Ve].componentProviders++}}}function tm(r,s,l,h){const f=Mh(s),y=function eb(r){return!!r.useClass}(s);if(f||y){const L=(y?Pt(s.useClass):s).prototype.ngOnDestroy;if(L){const B=r.destroyHooks||(r.destroyHooks=[]);if(!f&&s.multi){const W=B.indexOf(l);-1===W?B.push(l,[h,L]):B[W+1].push(h,L)}else B.push(l,L)}}}function S_(r,s,l){return l&&r.componentProviders++,r.multi.push(s)-1}function ql(r,s,l,h){for(let f=l;f<h;f++)if(s[f]===r)return f;return-1}function xS(r,s,l,h){return Sv(this.multi,[])}function MS(r,s,l,h){const f=this.multi;let y;if(this.providerFactory){const w=this.providerFactory.componentProviders,D=yr(l,l[1],this.providerFactory.index,h);y=D.slice(0,w),Sv(f,y);for(let L=w;L<D.length;L++)y.push(D[L])}else y=[],Sv(f,y);return y}function Sv(r,s){for(let l=0;l<r.length;l++)s.push((0,r[l])());return s}function A_(r,s=[]){return l=>{l.providersResolver=(h,f)=>function _S(r,s,l){const h=Tn();if(h.firstCreatePass){const f=ur(r);Xl(l,h.data,h.blueprint,f,!0),Xl(s,h.data,h.blueprint,f,!1)}}(h,f?f(r):r,s)}}class T_{}class cw{resolveComponentFactory(s){throw function lw(r){const s=Error(`No component factory found for ${Qe(r)}. Did you add it to @NgModule.entryComponents?`);return s.ngComponent=r,s}(s)}}let nm=(()=>{class r{}return r.NULL=new cw,r})();function uw(){return Gh(rr(),Ze())}function Gh(r,s){return new Mi(Qn(r,s))}let Mi=(()=>{class r{constructor(l){this.nativeElement=l}}return r.__NG_ELEMENT_ID__=uw,r})();function wS(r){return r instanceof Mi?r.nativeElement:r}class D_{}let SS=(()=>{class r{}return r.__NG_ELEMENT_ID__=()=>function hw(){const r=Ze(),l=Ai(rr().index,r);return function R_(r){return r[11]}(ir(l)?l:r)}(),r})(),AS=(()=>{class r{}return r.\u0275prov=di({token:r,providedIn:"root",factory:()=>null}),r})();class dw{constructor(s){this.full=s,this.major=s.split(".")[0],this.minor=s.split(".")[1],this.patch=s.split(".").slice(2).join(".")}}const TS=new dw("13.3.12"),I_={};function af(r,s,l,h,f=!1){for(;null!==l;){const y=s[l.index];if(null!==y&&h.push(Mn(y)),ni(y))for(let D=10;D<y.length;D++){const L=y[D],B=L[1].firstChild;null!==B&&af(L[1],L,B,h)}const w=l.type;if(8&w)af(r,s,l.child,h);else if(32&w){const D=Wf(l,s);let L;for(;L=D();)h.push(L)}else if(16&w){const D=Fx(s,l);if(Array.isArray(D))h.push(...D);else{const L=vd(s[16]);af(L[1],L,D,h,!0)}}l=f?l.projectionNext:l.next}return h}class Uu{constructor(s,l){this._lView=s,this._cdRefInjectingView=l,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const s=this._lView,l=s[1];return af(l,s,l.firstChild,[])}get context(){return this._lView[8]}set context(s){this._lView[8]=s}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const s=this._lView[3];if(ni(s)){const l=s[8],h=l?l.indexOf(this):-1;h>-1&&(yc(s,h),Ff(l,h))}this._attachedToViewContainer=!1}$m(this._lView[1],this._lView)}onDestroy(s){FM(this._lView[1],this._lView,null,s)}markForCheck(){_g(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){!function Mg(r,s,l){const h=s[10];h.begin&&h.begin();try{Td(r,s,r.template,l)}catch(f){throw Sg(s,f),f}finally{h.end&&h.end()}}(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new vt(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Sa(r,s){Xf(r,s,s[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(s){if(this._attachedToViewContainer)throw new vt(902,"");this._appRef=s}}class P_ extends Uu{constructor(s){super(s),this._view=s}detectChanges(){r0(this._view)}checkNoChanges(){}get context(){return null}}class fw extends nm{constructor(s){super(),this.ngModule=s}resolveComponentFactory(s){const l=tr(s);return new Wh(l,this.ngModule)}}function Cv(r){const s=[];for(let l in r)r.hasOwnProperty(l)&&s.push({propName:r[l],templateName:l});return s}class Wh extends T_{constructor(s,l){super(),this.componentDef=s,this.ngModule=l,this.componentType=s.type,this.selector=function yM(r){return r.map(vM).join(",")}(s.selectors),this.ngContentSelectors=s.ngContentSelectors?s.ngContentSelectors:[],this.isBoundToModule=!!l}get inputs(){return Cv(this.componentDef.inputs)}get outputs(){return Cv(this.componentDef.outputs)}create(s,l,h,f){const y=(f=f||this.ngModule)?function L_(r,s){return{get:(l,h,f)=>{const y=r.get(l,I_,f);return y!==I_||h===I_?y:s.get(l,h,f)}}}(s,f.injector):s,w=y.get(D_,yi),D=y.get(AS,null),L=w.createRenderer(null,this.componentDef),B=this.componentDef.selectors[0][0]||"div",W=h?function OM(r,s,l){if(bt(r))return r.selectRootElement(s,l===Is.ShadowDom);let h="string"==typeof s?r.querySelector(s):s;return h.textContent="",h}(L,h,this.componentDef.encapsulation):Wm(w.createRenderer(null,this.componentDef),B,function CS(r){const s=r.toLowerCase();return"svg"===s?"svg":"math"===s?N:null}(B)),te=this.componentDef.onPush?576:528,ae=function x0(r,s){return{components:[],scheduler:r||sM,clean:s0,playerHandler:s||null,flags:0}}(),ge=fg(0,null,null,1,0,null,null,null,null,null),Ve=op(null,ge,ae,te,null,null,w,L,D,y);let at,Rt;Al(Ve);try{const Wt=function _0(r,s,l,h,f,y){const w=l[1];l[20]=r;const L=Sd(w,20,2,"#host",null),B=L.mergedAttrs=s.hostAttrs;null!==B&&(br(L,B,!0),null!==r&&(pc(f,r,B),null!==L.classes&&qf(f,r,L.classes),null!==L.styles&&kx(f,r,L.styles)));const W=h.createRenderer(r,s),te=op(l,PM(s),null,s.onPush?64:16,l[20],L,h,W,y||null,null);return w.firstCreatePass&&(ne(C(L,l),w,s.type),Ec(w,L),lp(L,l.length,1)),up(l,te),l[20]=te}(W,this.componentDef,Ve,w,L);if(W)if(h)pc(L,W,["ng-version",TS.full]);else{const{attrs:Xe,classes:_n}=function _M(r){const s=[],l=[];let h=1,f=2;for(;h<r.length;){let y=r[h];if("string"==typeof y)2===f?""!==y&&s.push(y,r[++h]):8===f&&l.push(y);else{if(!Ra(f))break;f=y}h++}return{attrs:s,classes:l}}(this.componentDef.selectors[0]);Xe&&pc(L,W,Xe),_n&&_n.length>0&&qf(L,W,_n.join(" "))}if(Rt=$i(ge,20),void 0!==l){const Xe=Rt.projection=[];for(let _n=0;_n<this.ngContentSelectors.length;_n++){const In=l[_n];Xe.push(null!=In?Array.from(In):null)}}at=function Fg(r,s,l,h,f){const y=l[1],w=function kM(r,s,l){const h=rr();r.firstCreatePass&&(l.providersResolver&&l.providersResolver(l),Sc(r,h,s,Ad(r,s,1,null),l));const f=yr(s,r,h.directiveStart,h);us(f,s);const y=Qn(h,s);return y&&us(y,s),f}(y,l,s);if(h.components.push(w),r[8]=w,f&&f.forEach(L=>L(w,s)),s.contentQueries){const L=rr();s.contentQueries(1,w,L.directiveStart)}const D=rr();return!y.firstCreatePass||null===s.hostBindings&&null===s.hostAttrs||(bo(D.index),Zy(l[1],D,0,D.directiveStart,D.directiveEnd,s),vu(s,w)),w}(Wt,this.componentDef,Ve,ae,[ub]),ap(ge,Ve,null)}finally{Mo()}return new RS(this.componentType,at,Gh(Rt,Ve),Ve,Rt)}}class RS extends class Tv{}{constructor(s,l,h,f,y){super(),this.location=h,this._rootLView=f,this._tNode=y,this.instance=l,this.hostView=this.changeDetectorRef=new P_(f),this.componentType=s}get injector(){return new ws(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(s){this.hostView.onDestroy(s)}}class Yl{}class im{}const lf=new Map;class _w extends Yl{constructor(s,l){super(),this._parent=l,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new fw(this);const h=Tr(s);this._bootstrapComponents=il(h.bootstrap),this._r3Injector=c0(s,l,[{provide:Yl,useValue:this},{provide:nm,useValue:this.componentFactoryResolver}],Qe(s)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(s)}get(s,l=rl.THROW_IF_NOT_FOUND,h=hn.Default){return s===rl||s===Yl||s===Ag?this:this._r3Injector.get(s,l,h)}destroy(){const s=this._r3Injector;!s.destroyed&&s.destroy(),this.destroyCbs.forEach(l=>l()),this.destroyCbs=null}onDestroy(s){this.destroyCbs.push(s)}}class O_ extends im{constructor(s){super(),this.moduleType=s,null!==Tr(s)&&function vw(r){const s=new Set;!function l(h){const f=Tr(h,!0),y=f.id;null!==y&&(function gw(r,s,l){if(s&&s!==l)throw new Error(`Duplicate module registered for ${r} - ${Qe(s)} vs ${Qe(s.name)}`)}(y,lf.get(y),h),lf.set(y,h));const w=il(f.imports);for(const D of w)s.has(D)||(s.add(D),l(D))}(r)}(s)}create(s){return new _w(this.moduleType,s)}}function Rv(r,s,l,h,f,y,w){const D=s+l;return function _u(r,s,l,h){const f=Bs(r,s,l);return Bs(r,s+1,h)||f}(r,D,f,y)?function sl(r,s,l){return r[s]=l}(r,D+2,w?h.call(w,f,y):h(f,y)):function am(r,s){const l=r[s];return l===Nn?void 0:l}(r,D+2)}function Iv(r,s){const l=Tn();let h;const f=r+20;l.firstCreatePass?(h=function LS(r,s){if(s)for(let l=s.length-1;l>=0;l--){const h=s[l];if(r===h.name)return h}}(s,l.pipeRegistry),l.data[f]=h,h.onDestroy&&(l.destroyHooks||(l.destroyHooks=[])).push(f,h.onDestroy)):h=l.data[f];const y=h.factory||(h.factory=os(h.type)),w=tn(wu);try{const D=Qc(!1),L=y();return Qc(D),function ol(r,s,l,h){l>=r.data.length&&(r.data[l]=null,r.blueprint[l]=null),s[l]=h}(l,Ze(),f,L),L}finally{tn(w)}}function Pv(r,s,l,h){const f=r+20,y=Ze(),w=function ri(r,s){return r[s]}(y,f);return function jh(r,s){return r[1].data[s].pure}(y,f)?Rv(y,function Cr(){const r=En.lFrame;let s=r.bindingRootIndex;return-1===s&&(s=r.bindingRootIndex=r.tView.bindingStartIndex),s}(),s,w.transform,l,h,w):w.transform(l,h)}function Ov(r){return s=>{setTimeout(r,void 0,s)}}const co=class ww extends G.x{constructor(s=!1){super(),this.__isAsync=s}emit(s){super.next(s)}subscribe(s,l,h){var f,y,w;let D=s,L=l||(()=>null),B=h;if(s&&"object"==typeof s){const te=s;D=null===(f=te.next)||void 0===f?void 0:f.bind(te),L=null===(y=te.error)||void 0===y?void 0:y.bind(te),B=null===(w=te.complete)||void 0===w?void 0:w.bind(te)}this.__isAsync&&(L=Ov(L),D&&(D=Ov(D)),B&&(B=Ov(B)));const W=super.subscribe({next:D,error:L,complete:B});return s instanceof I.w0&&s.add(W),W}};function Ew(){return this._results[bh()]()}class um{constructor(s=!1){this._emitDistinctChangesOnly=s,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const l=bh(),h=um.prototype;h[l]||(h[l]=Ew)}get changes(){return this._changes||(this._changes=new co)}get(s){return this._results[s]}map(s){return this._results.map(s)}filter(s){return this._results.filter(s)}find(s){return this._results.find(s)}reduce(s,l){return this._results.reduce(s,l)}forEach(s){this._results.forEach(s)}some(s){return this._results.some(s)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(s,l){const h=this;h.dirty=!1;const f=Xo(s);(this._changesDetected=!function Ex(r,s,l){if(r.length!==s.length)return!1;for(let h=0;h<r.length;h++){let f=r[h],y=s[h];if(l&&(f=l(f),y=l(y)),y!==f)return!1}return!0}(h._results,f,l))&&(h._results=f,h.length=f.length,h.last=f[this.length-1],h.first=f[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let Bu=(()=>{class r{}return r.__NG_ELEMENT_ID__=Bi,r})();const B_=Bu,Sw=class extends B_{constructor(s,l,h){super(),this._declarationLView=s,this._declarationTContainer=l,this.elementRef=h}createEmbeddedView(s){const l=this._declarationTContainer.tViews,h=op(this._declarationLView,l,s,16,null,l.declTNode,null,null,null,null);h[17]=this._declarationLView[this._declarationTContainer.index];const y=this._declarationLView[19];return null!==y&&(h[19]=y.createEmbeddedView(l)),ap(l,h,s),new Uu(h)}};function Bi(){return Lr(rr(),Ze())}function Lr(r,s){return 4&r.type?new Sw(s,r,Gh(r,s)):null}let Fa=(()=>{class r{}return r.__NG_ELEMENT_ID__=$h,r})();function $h(){return dm(rr(),Ze())}const Xh=Fa,qh=class extends Xh{constructor(s,l,h){super(),this._lContainer=s,this._hostTNode=l,this._hostLView=h}get element(){return Gh(this._hostTNode,this._hostLView)}get injector(){return new ws(this._hostTNode,this._hostLView)}get parentInjector(){const s=H(this._hostTNode,this._hostLView);if(od(s)){const l=ls(s,this._hostLView),h=Xs(s);return new ws(l[1].data[h+8],l)}return new ws(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(s){const l=Fv(this._lContainer);return null!==l&&l[s]||null}get length(){return this._lContainer.length-10}createEmbeddedView(s,l,h){const f=s.createEmbeddedView(l||{});return this.insert(f,h),f}createComponent(s,l,h,f,y){const w=s&&!function ad(r){return"function"==typeof r}(s);let D;if(w)D=l;else{const te=l||{};D=te.index,h=te.injector,f=te.projectableNodes,y=te.ngModuleRef}const L=w?s:new Wh(tr(s)),B=h||this.parentInjector;if(!y&&null==L.ngModule){const ae=(w?B:this.parentInjector).get(Yl,null);ae&&(y=ae)}const W=L.create(B,f,void 0,y);return this.insert(W.hostView,D),W}insert(s,l){const h=s._lView,f=h[1];if(function zc(r){return ni(r[3])}(h)){const W=this.indexOf(s);if(-1!==W)this.detach(W);else{const te=h[3],ae=new qh(te,te[6],te[3]);ae.detach(ae.indexOf(s))}}const y=this._adjustIndex(l),w=this._lContainer;!function jm(r,s,l,h){const f=10+h,y=l.length;h>0&&(l[f-1][4]=s),h<y-10?(s[4]=l[f],sy(l,10+h,s)):(l.push(s),s[4]=null),s[3]=l;const w=s[17];null!==w&&l!==w&&function Nl(r,s){const l=r[9];s[16]!==s[3][3][16]&&(r[2]=!0),null===l?r[9]=[s]:l.push(s)}(w,s);const D=s[19];null!==D&&D.insertView(r),s[2]|=128}(f,h,w,y);const D=Mr(y,w),L=h[11],B=fu(L,w[7]);return null!==B&&function xr(r,s,l,h,f,y){h[0]=f,h[6]=s,Xf(r,h,l,1,f,y)}(f,w[6],L,h,B,D),s.attachToViewContainerRef(),sy(hm(w),y,s),s}move(s,l){return this.insert(s,l)}indexOf(s){const l=Fv(this._lContainer);return null!==l?l.indexOf(s):-1}remove(s){const l=this._adjustIndex(s,-1),h=yc(this._lContainer,l);h&&(Ff(hm(this._lContainer),l),$m(h[1],h))}detach(s){const l=this._adjustIndex(s,-1),h=yc(this._lContainer,l);return h&&null!=Ff(hm(this._lContainer),l)?new Uu(h):null}_adjustIndex(s,l=0){return null==s?this.length+l:s}};function Fv(r){return r[8]}function hm(r){return r[8]||(r[8]=[])}function dm(r,s){let l;const h=s[r.index];if(ni(h))l=h;else{let f;if(8&r.type)f=Mn(h);else{const y=s[11];f=y.createComment("");const w=Qn(r,s);du(y,fu(y,w),f,function Zm(r,s){return bt(r)?r.nextSibling(s):s.nextSibling}(y,w),!1)}s[r.index]=l=e0(h,s,f,r),up(s,l)}return new qh(l,r,s)}class uf{constructor(s){this.queryList=s,this.matches=null}clone(){return new uf(this.queryList)}setDirty(){this.queryList.setDirty()}}class Vu{constructor(s=[]){this.queries=s}createEmbeddedView(s){const l=s.queries;if(null!==l){const h=null!==s.contentQueries?s.contentQueries[0]:l.length,f=[];for(let y=0;y<h;y++){const w=l.getByIndex(y);f.push(this.queries[w.indexInDeclarationView].clone())}return new Vu(f)}return null}insertView(s){this.dirtyQueriesWithMatches(s)}detachView(s){this.dirtyQueriesWithMatches(s)}dirtyQueriesWithMatches(s){for(let l=0;l<this.queries.length;l++)null!==mf(s,l).matches&&this.queries[l].setDirty()}}class Yi{constructor(s,l,h=null){this.predicate=s,this.flags=l,this.read=h}}class dl{constructor(s=[]){this.queries=s}elementStart(s,l){for(let h=0;h<this.queries.length;h++)this.queries[h].elementStart(s,l)}elementEnd(s){for(let l=0;l<this.queries.length;l++)this.queries[l].elementEnd(s)}embeddedTView(s){let l=null;for(let h=0;h<this.length;h++){const f=null!==l?l.length:0,y=this.getByIndex(h).embeddedTView(s,f);y&&(y.indexInDeclarationView=h,null!==l?l.push(y):l=[y])}return null!==l?new dl(l):null}template(s,l){for(let h=0;h<this.queries.length;h++)this.queries[h].template(s,l)}getByIndex(s){return this.queries[s]}get length(){return this.queries.length}track(s){this.queries.push(s)}}class oa{constructor(s,l=-1){this.metadata=s,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=l}elementStart(s,l){this.isApplyingToNode(l)&&this.matchTNode(s,l)}elementEnd(s){this._declarationNodeIndex===s.index&&(this._appliesToNextNode=!1)}template(s,l){this.elementStart(s,l)}embeddedTView(s,l){return this.isApplyingToNode(s)?(this.crossesNgTemplate=!0,this.addMatch(-s.index,l),new oa(this.metadata)):null}isApplyingToNode(s){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const l=this._declarationNodeIndex;let h=s.parent;for(;null!==h&&8&h.type&&h.index!==l;)h=h.parent;return l===(null!==h?h.index:-1)}return this._appliesToNextNode}matchTNode(s,l){const h=this.metadata.predicate;if(Array.isArray(h))for(let f=0;f<h.length;f++){const y=h[f];this.matchTNodeWithReadOption(s,l,Ic(l,y)),this.matchTNodeWithReadOption(s,l,Ti(l,s,y,!1,!1))}else h===Bu?4&l.type&&this.matchTNodeWithReadOption(s,l,-1):this.matchTNodeWithReadOption(s,l,Ti(l,s,h,!1,!1))}matchTNodeWithReadOption(s,l,h){if(null!==h){const f=this.metadata.read;if(null!==f)if(f===Mi||f===Fa||f===Bu&&4&l.type)this.addMatch(l.index,-2);else{const y=Ti(l,s,f,!1,!1);null!==y&&this.addMatch(l.index,y)}else this.addMatch(l.index,h)}}addMatch(s,l){null===this.matches?this.matches=[s,l]:this.matches.push(s,l)}}function Ic(r,s){const l=r.localNames;if(null!==l)for(let h=0;h<l.length;h+=2)if(l[h]===s)return l[h+1];return null}function z_(r,s,l,h){return-1===l?function hf(r,s){return 11&r.type?Gh(r,s):4&r.type?Lr(r,s):null}(s,r):-2===l?function H_(r,s,l){return l===Mi?Gh(s,r):l===Bu?Lr(s,r):l===Fa?dm(s,r):void 0}(r,s,h):yr(r,r[1],l,s)}function Nv(r,s,l,h){const f=s[19].queries[h];if(null===f.matches){const y=r.data,w=l.matches,D=[];for(let L=0;L<w.length;L+=2){const B=w[L];D.push(B<0?null:z_(s,y[B],w[L+1],l.metadata.read))}f.matches=D}return f.matches}function pm(r,s,l,h){const f=r.queries.getByIndex(l),y=f.matches;if(null!==y){const w=Nv(r,s,f,l);for(let D=0;D<y.length;D+=2){const L=y[D];if(L>0)h.push(w[D/2]);else{const B=y[D+1],W=s[-L];for(let te=10;te<W.length;te++){const ae=W[te];ae[17]===ae[3]&&pm(ae[1],ae,B,h)}if(null!==W[9]){const te=W[9];for(let ae=0;ae<te.length;ae++){const ge=te[ae];pm(ge[1],ge,B,h)}}}}}return h}function df(r){const s=Ze(),l=Tn(),h=El();Xc(h+1);const f=mf(l,h);if(r.dirty&&Fi(s)===(2==(2&f.metadata.flags))){if(null===f.matches)r.reset([]);else{const y=f.crossesNgTemplate?pm(l,s,h,[]):Nv(l,s,f,h);r.reset(y,wS),r.notifyOnChanges()}return!0}return!1}function ff(r,s,l,h){const f=Tn();if(f.firstCreatePass){const y=rr();(function Na(r,s,l){null===r.queries&&(r.queries=new dl),r.queries.track(new oa(s,l))})(f,new Yi(s,l,h),y.index),function Zh(r,s){const l=r.contentQueries||(r.contentQueries=[]);s!==(l.length?l[l.length-1]:-1)&&l.push(r.queries.length-1,s)}(f,r),2==(2&l)&&(f.staticContentQueries=!0)}!function pf(r,s,l){const h=new um(4==(4&l));FM(r,s,h,h.destroy),null===s[19]&&(s[19]=new Vu),s[19].queries.push(new uf(h))}(f,Ze(),l)}function Yh(){return function Pc(r,s){return r[19].queries[s].queryList}(Ze(),El())}function mf(r,s){return r.queries.getByIndex(s)}function Gv(...r){}const Lw=new Pi("Application Initializer");let wm=(()=>{class r{constructor(l){this.appInits=l,this.resolve=Gv,this.reject=Gv,this.initialized=!1,this.done=!1,this.donePromise=new Promise((h,f)=>{this.resolve=h,this.reject=f})}runInitializers(){if(this.initialized)return;const l=[],h=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let f=0;f<this.appInits.length;f++){const y=this.appInits[f]();if(bp(y))l.push(y);else if(Zg(y)){const w=new Promise((D,L)=>{y.subscribe({complete:D,error:L})});l.push(w)}}Promise.all(l).then(()=>{h()}).catch(f=>{this.reject(f)}),0===l.length&&h(),this.initialized=!0}}return r.\u0275fac=function(l){return new(l||r)(Es(Lw,8))},r.\u0275prov=di({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();const Ow=new Pi("AppId",{providedIn:"root",factory:function Fw(){return`${Jh()}${Jh()}${Jh()}`}});function Jh(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const Nw=new Pi("Platform Initializer"),BS=new Pi("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),kw=new Pi("appBootstrapListener");let Wv=(()=>{class r{log(l){console.log(l)}warn(l){console.warn(l)}}return r.\u0275fac=function(l){return new(l||r)},r.\u0275prov=di({token:r,factory:r.\u0275fac,providedIn:"platform"}),r})();const Mf=new Pi("LocaleId",{providedIn:"root",factory:()=>km(Mf,hn.Optional|hn.SkipSelf)||function ex(){return"undefined"!=typeof $localize&&$localize.locale||ia}()}),Uw=new Pi("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});class Em{constructor(s,l){this.ngModuleFactory=s,this.componentFactories=l}}let Bw=(()=>{class r{compileModuleSync(l){return new O_(l)}compileModuleAsync(l){return Promise.resolve(this.compileModuleSync(l))}compileModuleAndAllComponentsSync(l){const h=this.compileModuleSync(l),y=il(Tr(l).declarations).reduce((w,D)=>{const L=tr(D);return L&&w.push(new Wh(L)),w},[]);return new Em(h,y)}compileModuleAndAllComponentsAsync(l){return Promise.resolve(this.compileModuleAndAllComponentsSync(l))}clearCache(){}clearCacheFor(l){}getModuleId(l){}}return r.\u0275fac=function(l){return new(l||r)},r.\u0275prov=di({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();const tx=(()=>Promise.resolve(0))();function jv(r){"undefined"==typeof Zone?tx.then(()=>{r&&r.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",r)}class uo{constructor({enableLongStackTrace:s=!1,shouldCoalesceEventChangeDetection:l=!1,shouldCoalesceRunChangeDetection:h=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new co(!1),this.onMicrotaskEmpty=new co(!1),this.onStable=new co(!1),this.onError=new co(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const f=this;f._nesting=0,f._outer=f._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(f._inner=f._inner.fork(new Zone.TaskTrackingZoneSpec)),s&&Zone.longStackTraceZoneSpec&&(f._inner=f._inner.fork(Zone.longStackTraceZoneSpec)),f.shouldCoalesceEventChangeDetection=!h&&l,f.shouldCoalesceRunChangeDetection=h,f.lastRequestAnimationFrameId=-1,f.nativeRequestAnimationFrame=function bf(){let r=fi.requestAnimationFrame,s=fi.cancelAnimationFrame;if("undefined"!=typeof Zone&&r&&s){const l=r[Zone.__symbol__("OriginalDelegate")];l&&(r=l);const h=s[Zone.__symbol__("OriginalDelegate")];h&&(s=h)}return{nativeRequestAnimationFrame:r,nativeCancelAnimationFrame:s}}().nativeRequestAnimationFrame,function GS(r){const s=()=>{!function HS(r){r.isCheckStableRunning||-1!==r.lastRequestAnimationFrameId||(r.lastRequestAnimationFrameId=r.nativeRequestAnimationFrame.call(fi,()=>{r.fakeTopEventTask||(r.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{r.lastRequestAnimationFrameId=-1,rx(r),r.isCheckStableRunning=!0,ix(r),r.isCheckStableRunning=!1},void 0,()=>{},()=>{})),r.fakeTopEventTask.invoke()}),rx(r))}(r)};r._inner=r._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(l,h,f,y,w,D)=>{try{return zw(r),l.invokeTask(f,y,w,D)}finally{(r.shouldCoalesceEventChangeDetection&&"eventTask"===y.type||r.shouldCoalesceRunChangeDetection)&&s(),Hw(r)}},onInvoke:(l,h,f,y,w,D,L)=>{try{return zw(r),l.invoke(f,y,w,D,L)}finally{r.shouldCoalesceRunChangeDetection&&s(),Hw(r)}},onHasTask:(l,h,f,y)=>{l.hasTask(f,y),h===f&&("microTask"==y.change?(r._hasPendingMicrotasks=y.microTask,rx(r),ix(r)):"macroTask"==y.change&&(r.hasPendingMacrotasks=y.macroTask))},onHandleError:(l,h,f,y)=>(l.handleError(f,y),r.runOutsideAngular(()=>r.onError.emit(y)),!1)})}(f)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!uo.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(uo.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(s,l,h){return this._inner.run(s,l,h)}runTask(s,l,h,f){const y=this._inner,w=y.scheduleEventTask("NgZoneEvent: "+f,s,nx,Gv,Gv);try{return y.runTask(w,l,h)}finally{y.cancelTask(w)}}runGuarded(s,l,h){return this._inner.runGuarded(s,l,h)}runOutsideAngular(s){return this._outer.run(s)}}const nx={};function ix(r){if(0==r._nesting&&!r.hasPendingMicrotasks&&!r.isStable)try{r._nesting++,r.onMicrotaskEmpty.emit(null)}finally{if(r._nesting--,!r.hasPendingMicrotasks)try{r.runOutsideAngular(()=>r.onStable.emit(null))}finally{r.isStable=!0}}}function rx(r){r.hasPendingMicrotasks=!!(r._hasPendingMicrotasks||(r.shouldCoalesceEventChangeDetection||r.shouldCoalesceRunChangeDetection)&&-1!==r.lastRequestAnimationFrameId)}function zw(r){r._nesting++,r.isStable&&(r.isStable=!1,r.onUnstable.emit(null))}function Hw(r){r._nesting--,ix(r)}class WS{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new co,this.onMicrotaskEmpty=new co,this.onStable=new co,this.onError=new co}run(s,l,h){return s.apply(l,h)}runGuarded(s,l,h){return s.apply(l,h)}runOutsideAngular(s){return s()}runTask(s,l,h,f){return s.apply(l,h)}}let Gw=(()=>{class r{constructor(l){this._ngZone=l,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),l.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{uo.assertNotInAngularZone(),jv(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())jv(()=>{for(;0!==this._callbacks.length;){let l=this._callbacks.pop();clearTimeout(l.timeoutId),l.doneCb(this._didWork)}this._didWork=!1});else{let l=this.getPendingTasks();this._callbacks=this._callbacks.filter(h=>!h.updateCb||!h.updateCb(l)||(clearTimeout(h.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(l=>({source:l.source,creationLocation:l.creationLocation,data:l.data})):[]}addCallback(l,h,f){let y=-1;h&&h>0&&(y=setTimeout(()=>{this._callbacks=this._callbacks.filter(w=>w.timeoutId!==y),l(this._didWork,this.getPendingTasks())},h)),this._callbacks.push({doneCb:l,timeoutId:y,updateCb:f})}whenStable(l,h,f){if(f&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(l,h,f),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(l,h,f){return[]}}return r.\u0275fac=function(l){return new(l||r)(Es(uo))},r.\u0275prov=di({token:r,factory:r.\u0275fac}),r})(),jS=(()=>{class r{constructor(){this._applications=new Map,sx.addToWindow(this)}registerApplication(l,h){this._applications.set(l,h)}unregisterApplication(l){this._applications.delete(l)}unregisterAllApplications(){this._applications.clear()}getTestability(l){return this._applications.get(l)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(l,h=!0){return sx.findTestabilityInTree(this,l,h)}}return r.\u0275fac=function(l){return new(l||r)},r.\u0275prov=di({token:r,factory:r.\u0275fac,providedIn:"platform"}),r})();class $S{addToWindow(s){}findTestabilityInTree(s,l,h){return null}}function XS(r){sx=r}let sx=new $S,fl=null;const Sm=new Pi("AllowMultipleToken"),ox=new Pi("PlatformOnDestroy");class $w{constructor(s,l){this.name=s,this.token=l}}function qw(r,s,l=[]){const h=`Platform: ${s}`,f=new Pi(h);return(y=[])=>{let w=zs();if(!w||w.injector.get(Sm,!1)){const D=[...l,...y,{provide:f,useValue:!0}];r?r(D):function Xw(r){if(fl&&!fl.get(Sm,!1))throw new vt(400,"");fl=r;const s=r.get(ax),l=r.get(Nw,null);l&&l.forEach(h=>h())}(function si(r=[],s){return rl.create({name:s,providers:[{provide:Tg,useValue:"platform"},{provide:ox,useValue:()=>fl=null},...r]})}(D,h))}return function Yw(r){const s=zs();if(!s)throw new vt(401,"");return s}()}}function zs(){var r;return null!==(r=null==fl?void 0:fl.get(ax))&&void 0!==r?r:null}let ax=(()=>{class r{constructor(l){this._injector=l,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(l,h){const D=function Zw(r,s){let l;return l="noop"===r?new WS:("zone.js"===r?void 0:r)||new uo({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==s?void 0:s.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==s?void 0:s.ngZoneRunCoalescing)}),l}(h?h.ngZone:void 0,{ngZoneEventCoalescing:h&&h.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:h&&h.ngZoneRunCoalescing||!1}),L=[{provide:uo,useValue:D}];return D.run(()=>{const B=rl.create({providers:L,parent:this.injector,name:l.moduleType.name}),W=l.create(B),te=W.injector.get(np,null);if(!te)throw new vt(402,"");return D.runOutsideAngular(()=>{const ae=D.onError.subscribe({next:ge=>{te.handleError(ge)}});W.onDestroy(()=>{Xv(this._modules,W),ae.unsubscribe()})}),function Kw(r,s,l){try{const h=l();return bp(h)?h.catch(f=>{throw s.runOutsideAngular(()=>r.handleError(f)),f}):h}catch(h){throw s.runOutsideAngular(()=>r.handleError(h)),h}}(te,D,()=>{const ae=W.injector.get(wm);return ae.runInitializers(),ae.donePromise.then(()=>(function ra(r){un(r,"Expected localeId to be defined"),"string"==typeof r&&(c_=r.toLowerCase().replace(/_/g,"-"))}(W.injector.get(Mf,ia)||ia),this._moduleDoBootstrap(W),W))})})}bootstrapModule(l,h=[]){const f=lx({},h);return function Ww(r,s,l){const h=new O_(l);return Promise.resolve(h)}(0,0,l).then(y=>this.bootstrapModuleFactory(y,f))}_moduleDoBootstrap(l){const h=l.injector.get($v);if(l._bootstrapComponents.length>0)l._bootstrapComponents.forEach(f=>h.bootstrap(f));else{if(!l.instance.ngDoBootstrap)throw new vt(403,"");l.instance.ngDoBootstrap(h)}this._modules.push(l)}onDestroy(l){this._destroyListeners.push(l)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new vt(404,"");this._modules.slice().forEach(h=>h.destroy()),this._destroyListeners.forEach(h=>h());const l=this._injector.get(ox,null);null==l||l(),this._destroyed=!0}get destroyed(){return this._destroyed}}return r.\u0275fac=function(l){return new(l||r)(Es(rl))},r.\u0275prov=di({token:r,factory:r.\u0275fac,providedIn:"platform"}),r})();function lx(r,s){return Array.isArray(s)?s.reduce(lx,r):Object.assign(Object.assign({},r),s)}let $v=(()=>{class r{constructor(l,h,f,y){this._zone=l,this._injector=h,this._exceptionHandler=f,this._initStatus=y,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const w=new Te.y(L=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{L.next(this._stable),L.complete()})}),D=new Te.y(L=>{let B;this._zone.runOutsideAngular(()=>{B=this._zone.onStable.subscribe(()=>{uo.assertNotInAngularZone(),jv(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,L.next(!0))})})});const W=this._zone.onUnstable.subscribe(()=>{uo.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{L.next(!1)}))});return()=>{B.unsubscribe(),W.unsubscribe()}});this.isStable=function zt(...r){const s=(0,mt.yG)(r),l=(0,mt._6)(r,1/0),h=r;return h.length?1===h.length?(0,Ge.Xf)(h[0]):(0,et.J)(l)((0,It.D)(h,s)):kt.E}(w,D.pipe(function gt(r={}){const{connector:s=(()=>new G.x),resetOnError:l=!0,resetOnComplete:h=!0,resetOnRefCountZero:f=!0}=r;return y=>{let w,D,L,B=0,W=!1,te=!1;const ae=()=>{null==D||D.unsubscribe(),D=void 0},ge=()=>{ae(),w=L=void 0,W=te=!1},Ve=()=>{const at=w;ge(),null==at||at.unsubscribe()};return(0,ye.e)((at,Rt)=>{B++,!te&&!W&&ae();const Wt=L=null!=L?L:s();Rt.add(()=>{B--,0===B&&!te&&!W&&(D=zn(Ve,f))}),Wt.subscribe(Rt),!w&&B>0&&(w=new rt.Hp({next:Xe=>Wt.next(Xe),error:Xe=>{te=!0,ae(),D=zn(ge,l,Xe),Wt.error(Xe)},complete:()=>{W=!0,ae(),D=zn(ge,h),Wt.complete()}}),(0,Ge.Xf)(at).subscribe(w))})(y)}}()))}bootstrap(l,h){if(!this._initStatus.done)throw new vt(405,"");let f;f=l instanceof T_?l:this._injector.get(nm).resolveComponentFactory(l),this.componentTypes.push(f.componentType);const y=function jw(r){return r.isBoundToModule}(f)?void 0:this._injector.get(Yl),D=f.create(rl.NULL,[],h||f.selector,y),L=D.location.nativeElement,B=D.injector.get(Gw,null),W=B&&D.injector.get(jS);return B&&W&&W.registerApplication(L,B),D.onDestroy(()=>{this.detachView(D.hostView),Xv(this.components,D),W&&W.unregisterApplication(L)}),this._loadComponent(D),D}tick(){if(this._runningTick)throw new vt(101,"");try{this._runningTick=!0;for(let l of this._views)l.detectChanges()}catch(l){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(l))}finally{this._runningTick=!1}}attachView(l){const h=l;this._views.push(h),h.attachToAppRef(this)}detachView(l){const h=l;Xv(this._views,h),h.detachFromAppRef()}_loadComponent(l){this.attachView(l.hostView),this.tick(),this.components.push(l),this._injector.get(kw,[]).concat(this._bootstrapListeners).forEach(f=>f(l))}ngOnDestroy(){this._views.slice().forEach(l=>l.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return r.\u0275fac=function(l){return new(l||r)(Es(uo),Es(rl),Es(np),Es(wm))},r.\u0275prov=di({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();function Xv(r,s){const l=r.indexOf(s);l>-1&&r.splice(l,1)}let ux=!0;function Qw(){ux=!1}let Qh=(()=>{class r{}return r.__NG_ELEMENT_ID__=dx,r})();function dx(r){return function fx(r,s,l){if(Ls(r)&&!l){const h=Ai(r.index,s);return new Uu(h,h)}return 47&r.type?new Uu(s[16],s):null}(rr(),Ze(),16==(16&r))}class Dm{constructor(){}supports(s){return Pd(s)}create(s){return new iA(s)}}const nA=(r,s)=>s;class iA{constructor(s){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=s||nA}forEachItem(s){let l;for(l=this._itHead;null!==l;l=l._next)s(l)}forEachOperation(s){let l=this._itHead,h=this._removalsHead,f=0,y=null;for(;l||h;){const w=!h||l&&l.currentIndex<vx(h,f,y)?l:h,D=vx(w,f,y),L=w.currentIndex;if(w===h)f--,h=h._nextRemoved;else if(l=l._next,null==w.previousIndex)f++;else{y||(y=[]);const B=D-f,W=L-f;if(B!=W){for(let ae=0;ae<B;ae++){const ge=ae<y.length?y[ae]:y[ae]=0,Ve=ge+ae;W<=Ve&&Ve<B&&(y[ae]=ge+1)}y[w.previousIndex]=W-B}}D!==L&&s(w,D,L)}}forEachPreviousItem(s){let l;for(l=this._previousItHead;null!==l;l=l._nextPrevious)s(l)}forEachAddedItem(s){let l;for(l=this._additionsHead;null!==l;l=l._nextAdded)s(l)}forEachMovedItem(s){let l;for(l=this._movesHead;null!==l;l=l._nextMoved)s(l)}forEachRemovedItem(s){let l;for(l=this._removalsHead;null!==l;l=l._nextRemoved)s(l)}forEachIdentityChange(s){let l;for(l=this._identityChangesHead;null!==l;l=l._nextIdentityChange)s(l)}diff(s){if(null==s&&(s=[]),!Pd(s))throw new vt(900,"");return this.check(s)?this:null}onDestroy(){}check(s){this._reset();let f,y,w,l=this._itHead,h=!1;if(Array.isArray(s)){this.length=s.length;for(let D=0;D<this.length;D++)y=s[D],w=this._trackByFn(D,y),null!==l&&Object.is(l.trackById,w)?(h&&(l=this._verifyReinsertion(l,y,w,D)),Object.is(l.item,y)||this._addIdentityChange(l,y)):(l=this._mismatch(l,y,w,D),h=!0),l=l._next}else f=0,function gb(r,s){if(Array.isArray(r))for(let l=0;l<r.length;l++)s(r[l]);else{const l=r[bh()]();let h;for(;!(h=l.next()).done;)s(h.value)}}(s,D=>{w=this._trackByFn(f,D),null!==l&&Object.is(l.trackById,w)?(h&&(l=this._verifyReinsertion(l,D,w,f)),Object.is(l.item,D)||this._addIdentityChange(l,D)):(l=this._mismatch(l,D,w,f),h=!0),l=l._next,f++}),this.length=f;return this._truncate(l),this.collection=s,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let s;for(s=this._previousItHead=this._itHead;null!==s;s=s._next)s._nextPrevious=s._next;for(s=this._additionsHead;null!==s;s=s._nextAdded)s.previousIndex=s.currentIndex;for(this._additionsHead=this._additionsTail=null,s=this._movesHead;null!==s;s=s._nextMoved)s.previousIndex=s.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(s,l,h,f){let y;return null===s?y=this._itTail:(y=s._prev,this._remove(s)),null!==(s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(h,null))?(Object.is(s.item,l)||this._addIdentityChange(s,l),this._reinsertAfter(s,y,f)):null!==(s=null===this._linkedRecords?null:this._linkedRecords.get(h,f))?(Object.is(s.item,l)||this._addIdentityChange(s,l),this._moveAfter(s,y,f)):s=this._addAfter(new nE(l,h),y,f),s}_verifyReinsertion(s,l,h,f){let y=null===this._unlinkedRecords?null:this._unlinkedRecords.get(h,null);return null!==y?s=this._reinsertAfter(y,s._prev,f):s.currentIndex!=f&&(s.currentIndex=f,this._addToMoves(s,f)),s}_truncate(s){for(;null!==s;){const l=s._next;this._addToRemovals(this._unlink(s)),s=l}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(s,l,h){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(s);const f=s._prevRemoved,y=s._nextRemoved;return null===f?this._removalsHead=y:f._nextRemoved=y,null===y?this._removalsTail=f:y._prevRemoved=f,this._insertAfter(s,l,h),this._addToMoves(s,h),s}_moveAfter(s,l,h){return this._unlink(s),this._insertAfter(s,l,h),this._addToMoves(s,h),s}_addAfter(s,l,h){return this._insertAfter(s,l,h),this._additionsTail=null===this._additionsTail?this._additionsHead=s:this._additionsTail._nextAdded=s,s}_insertAfter(s,l,h){const f=null===l?this._itHead:l._next;return s._next=f,s._prev=l,null===f?this._itTail=s:f._prev=s,null===l?this._itHead=s:l._next=s,null===this._linkedRecords&&(this._linkedRecords=new gx),this._linkedRecords.put(s),s.currentIndex=h,s}_remove(s){return this._addToRemovals(this._unlink(s))}_unlink(s){null!==this._linkedRecords&&this._linkedRecords.remove(s);const l=s._prev,h=s._next;return null===l?this._itHead=h:l._next=h,null===h?this._itTail=l:h._prev=l,s}_addToMoves(s,l){return s.previousIndex===l||(this._movesTail=null===this._movesTail?this._movesHead=s:this._movesTail._nextMoved=s),s}_addToRemovals(s){return null===this._unlinkedRecords&&(this._unlinkedRecords=new gx),this._unlinkedRecords.put(s),s.currentIndex=null,s._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=s,s._prevRemoved=null):(s._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=s),s}_addIdentityChange(s,l){return s.item=l,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=s:this._identityChangesTail._nextIdentityChange=s,s}}class nE{constructor(s,l){this.item=s,this.trackById=l,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class iE{constructor(){this._head=null,this._tail=null}add(s){null===this._head?(this._head=this._tail=s,s._nextDup=null,s._prevDup=null):(this._tail._nextDup=s,s._prevDup=this._tail,s._nextDup=null,this._tail=s)}get(s,l){let h;for(h=this._head;null!==h;h=h._nextDup)if((null===l||l<=h.currentIndex)&&Object.is(h.trackById,s))return h;return null}remove(s){const l=s._prevDup,h=s._nextDup;return null===l?this._head=h:l._nextDup=h,null===h?this._tail=l:h._prevDup=l,null===this._head}}class gx{constructor(){this.map=new Map}put(s){const l=s.trackById;let h=this.map.get(l);h||(h=new iE,this.map.set(l,h)),h.add(s)}get(s,l){const f=this.map.get(s);return f?f.get(s,l):null}remove(s){const l=s.trackById;return this.map.get(l).remove(s)&&this.map.delete(l),s}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function vx(r,s,l){const h=r.previousIndex;if(null===h)return h;let f=0;return l&&h<l.length&&(f=l[h]),h+s+f}class rE{constructor(){}supports(s){return s instanceof Map||Ug(s)}create(){return new sE}}class sE{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(s){let l;for(l=this._mapHead;null!==l;l=l._next)s(l)}forEachPreviousItem(s){let l;for(l=this._previousMapHead;null!==l;l=l._nextPrevious)s(l)}forEachChangedItem(s){let l;for(l=this._changesHead;null!==l;l=l._nextChanged)s(l)}forEachAddedItem(s){let l;for(l=this._additionsHead;null!==l;l=l._nextAdded)s(l)}forEachRemovedItem(s){let l;for(l=this._removalsHead;null!==l;l=l._nextRemoved)s(l)}diff(s){if(s){if(!(s instanceof Map||Ug(s)))throw new vt(900,"")}else s=new Map;return this.check(s)?this:null}onDestroy(){}check(s){this._reset();let l=this._mapHead;if(this._appendAfter=null,this._forEach(s,(h,f)=>{if(l&&l.key===f)this._maybeAddToChanges(l,h),this._appendAfter=l,l=l._next;else{const y=this._getOrCreateRecordForKey(f,h);l=this._insertBeforeOrAppend(l,y)}}),l){l._prev&&(l._prev._next=null),this._removalsHead=l;for(let h=l;null!==h;h=h._nextRemoved)h===this._mapHead&&(this._mapHead=null),this._records.delete(h.key),h._nextRemoved=h._next,h.previousValue=h.currentValue,h.currentValue=null,h._prev=null,h._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(s,l){if(s){const h=s._prev;return l._next=s,l._prev=h,s._prev=l,h&&(h._next=l),s===this._mapHead&&(this._mapHead=l),this._appendAfter=s,s}return this._appendAfter?(this._appendAfter._next=l,l._prev=this._appendAfter):this._mapHead=l,this._appendAfter=l,null}_getOrCreateRecordForKey(s,l){if(this._records.has(s)){const f=this._records.get(s);this._maybeAddToChanges(f,l);const y=f._prev,w=f._next;return y&&(y._next=w),w&&(w._prev=y),f._next=null,f._prev=null,f}const h=new Qv(s);return this._records.set(s,h),h.currentValue=l,this._addToAdditions(h),h}_reset(){if(this.isDirty){let s;for(this._previousMapHead=this._mapHead,s=this._previousMapHead;null!==s;s=s._next)s._nextPrevious=s._next;for(s=this._changesHead;null!==s;s=s._nextChanged)s.previousValue=s.currentValue;for(s=this._additionsHead;null!=s;s=s._nextAdded)s.previousValue=s.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(s,l){Object.is(l,s.currentValue)||(s.previousValue=s.currentValue,s.currentValue=l,this._addToChanges(s))}_addToAdditions(s){null===this._additionsHead?this._additionsHead=this._additionsTail=s:(this._additionsTail._nextAdded=s,this._additionsTail=s)}_addToChanges(s){null===this._changesHead?this._changesHead=this._changesTail=s:(this._changesTail._nextChanged=s,this._changesTail=s)}_forEach(s,l){s instanceof Map?s.forEach(l):Object.keys(s).forEach(h=>l(s[h],h))}}class Qv{constructor(s){this.key=s,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function oE(){return new yx([new Dm])}let yx=(()=>{class r{constructor(l){this.factories=l}static create(l,h){if(null!=h){const f=h.factories.slice();l=l.concat(f)}return new r(l)}static extend(l){return{provide:r,useFactory:h=>r.create(l,h||oE()),deps:[[r,new Bf,new Uf]]}}find(l){const h=this.factories.find(f=>f.supports(l));if(null!=h)return h;throw new vt(901,"")}}return r.\u0275prov=di({token:r,providedIn:"root",factory:oE}),r})();function aE(){return new xx([new rE])}let xx=(()=>{class r{constructor(l){this.factories=l}static create(l,h){if(h){const f=h.factories.slice();l=l.concat(f)}return new r(l)}static extend(l){return{provide:r,useFactory:h=>r.create(l,h||aE()),deps:[[r,new Bf,new Uf]]}}find(l){const h=this.factories.find(y=>y.supports(l));if(h)return h;throw new vt(901,"")}}return r.\u0275prov=di({token:r,providedIn:"root",factory:aE}),r})();const sA=qw(null,"core",[]);let oA=(()=>{class r{constructor(l){}}return r.\u0275fac=function(l){return new(l||r)(Es($v))},r.\u0275mod=Hn({type:r}),r.\u0275inj=ar({}),r})()},2313:(an,Je,ie)=>{ie.d(Je,{H7:()=>Ps,b2:()=>ar,q6:()=>di});var G=ie(9808),I=ie(1223);class Te extends G.w_{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class et extends Te{static makeCurrent(){(0,G.HT)(new et)}onAndCancel(de,se,ve){return de.addEventListener(se,ve,!1),()=>{de.removeEventListener(se,ve,!1)}}dispatchEvent(de,se){de.dispatchEvent(se)}remove(de){de.parentNode&&de.parentNode.removeChild(de)}createElement(de,se){return(se=se||this.getDefaultDocument()).createElement(de)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(de){return de.nodeType===Node.ELEMENT_NODE}isShadowRoot(de){return de instanceof DocumentFragment}getGlobalEventTarget(de,se){return"window"===se?window:"document"===se?de:"body"===se?de.body:null}getBaseHref(de){const se=function kt(){return Ge=Ge||document.querySelector("base"),Ge?Ge.getAttribute("href"):null}();return null==se?null:function It(be){mt=mt||document.createElement("a"),mt.setAttribute("href",be);const de=mt.pathname;return"/"===de.charAt(0)?de:`/${de}`}(se)}resetBaseElement(){Ge=null}getUserAgent(){return window.navigator.userAgent}getCookie(de){return(0,G.Mx)(document.cookie,de)}}let mt,Ge=null;const zt=new I.OlP("TRANSITION_ID"),ye=[{provide:I.ip1,useFactory:function rt(be,de,se){return()=>{se.get(I.CZH).donePromise.then(()=>{const ve=(0,G.q)(),Ce=de.querySelectorAll(`style[ng-transition="${be}"]`);for(let dn=0;dn<Ce.length;dn++)ve.remove(Ce[dn])})}},deps:[zt,G.K0,I.zs3],multi:!0}];class gt{static init(){(0,I.VLi)(new gt)}addToWindow(de){I.dqk.getAngularTestability=(ve,Ce=!0)=>{const dn=de.findTestabilityInTree(ve,Ce);if(null==dn)throw new Error("Could not find testability for element.");return dn},I.dqk.getAllAngularTestabilities=()=>de.getAllTestabilities(),I.dqk.getAllAngularRootElements=()=>de.getAllRootElements(),I.dqk.frameworkStabilizers||(I.dqk.frameworkStabilizers=[]),I.dqk.frameworkStabilizers.push(ve=>{const Ce=I.dqk.getAllAngularTestabilities();let dn=Ce.length,Hn=!1;const Oi=function(Nr){Hn=Hn||Nr,dn--,0==dn&&ve(Hn)};Ce.forEach(function(Nr){Nr.whenStable(Oi)})})}findTestabilityInTree(de,se,ve){if(null==se)return null;const Ce=de.getTestability(se);return null!=Ce?Ce:ve?(0,G.q)().isShadowRoot(se)?this.findTestabilityInTree(de,se.host,!0):this.findTestabilityInTree(de,se.parentElement,!0):null}}let zn=(()=>{class be{build(){return new XMLHttpRequest}}return be.\u0275fac=function(se){return new(se||be)},be.\u0275prov=I.Yz7({token:be,factory:be.\u0275fac}),be})();const st=new I.OlP("EventManagerPlugins");let Jn=(()=>{class be{constructor(se,ve){this._zone=ve,this._eventNameToPlugin=new Map,se.forEach(Ce=>Ce.manager=this),this._plugins=se.slice().reverse()}addEventListener(se,ve,Ce){return this._findPluginFor(ve).addEventListener(se,ve,Ce)}addGlobalEventListener(se,ve,Ce){return this._findPluginFor(ve).addGlobalEventListener(se,ve,Ce)}getZone(){return this._zone}_findPluginFor(se){const ve=this._eventNameToPlugin.get(se);if(ve)return ve;const Ce=this._plugins;for(let dn=0;dn<Ce.length;dn++){const Hn=Ce[dn];if(Hn.supports(se))return this._eventNameToPlugin.set(se,Hn),Hn}throw new Error(`No event manager plugin found for event ${se}`)}}return be.\u0275fac=function(se){return new(se||be)(I.LFG(st),I.LFG(I.R0b))},be.\u0275prov=I.Yz7({token:be,factory:be.\u0275fac}),be})();class Qe{constructor(de){this._doc=de}addGlobalEventListener(de,se,ve){const Ce=(0,G.q)().getGlobalEventTarget(this._doc,de);if(!Ce)throw new Error(`Unsupported event target ${Ce} for event ${se}`);return this.addEventListener(Ce,se,ve)}}let pn=(()=>{class be{constructor(){this._stylesSet=new Set}addStyles(se){const ve=new Set;se.forEach(Ce=>{this._stylesSet.has(Ce)||(this._stylesSet.add(Ce),ve.add(Ce))}),this.onStylesAdded(ve)}onStylesAdded(se){}getAllStyles(){return Array.from(this._stylesSet)}}return be.\u0275fac=function(se){return new(se||be)},be.\u0275prov=I.Yz7({token:be,factory:be.\u0275fac}),be})(),Xn=(()=>{class be extends pn{constructor(se){super(),this._doc=se,this._hostNodes=new Map,this._hostNodes.set(se.head,[])}_addStylesToHost(se,ve,Ce){se.forEach(dn=>{const Hn=this._doc.createElement("style");Hn.textContent=dn,Ce.push(ve.appendChild(Hn))})}addHost(se){const ve=[];this._addStylesToHost(this._stylesSet,se,ve),this._hostNodes.set(se,ve)}removeHost(se){const ve=this._hostNodes.get(se);ve&&ve.forEach(Fn),this._hostNodes.delete(se)}onStylesAdded(se){this._hostNodes.forEach((ve,Ce)=>{this._addStylesToHost(se,Ce,ve)})}ngOnDestroy(){this._hostNodes.forEach(se=>se.forEach(Fn))}}return be.\u0275fac=function(se){return new(se||be)(I.LFG(G.K0))},be.\u0275prov=I.Yz7({token:be,factory:be.\u0275fac}),be})();function Fn(be){(0,G.q)().remove(be)}const Pt={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Ot=/%COMP%/g;function mn(be,de,se){for(let ve=0;ve<de.length;ve++){let Ce=de[ve];Array.isArray(Ce)?mn(be,Ce,se):(Ce=Ce.replace(Ot,be),se.push(Ce))}return se}function $n(be){return de=>{if("__ngUnwrap__"===de)return be;!1===be(de)&&(de.preventDefault(),de.returnValue=!1)}}let gn=(()=>{class be{constructor(se,ve,Ce){this.eventManager=se,this.sharedStylesHost=ve,this.appId=Ce,this.rendererByCompId=new Map,this.defaultRenderer=new en(se)}createRenderer(se,ve){if(!se||!ve)return this.defaultRenderer;switch(ve.encapsulation){case I.ifc.Emulated:{let Ce=this.rendererByCompId.get(ve.id);return Ce||(Ce=new Tt(this.eventManager,this.sharedStylesHost,ve,this.appId),this.rendererByCompId.set(ve.id,Ce)),Ce.applyToHost(se),Ce}case 1:case I.ifc.ShadowDom:return new Ee(this.eventManager,this.sharedStylesHost,se,ve);default:if(!this.rendererByCompId.has(ve.id)){const Ce=mn(ve.id,ve.styles,[]);this.sharedStylesHost.addStyles(Ce),this.rendererByCompId.set(ve.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return be.\u0275fac=function(se){return new(se||be)(I.LFG(Jn),I.LFG(Xn),I.LFG(I.AFp))},be.\u0275prov=I.Yz7({token:be,factory:be.\u0275fac}),be})();class en{constructor(de){this.eventManager=de,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(de,se){return se?document.createElementNS(Pt[se]||se,de):document.createElement(de)}createComment(de){return document.createComment(de)}createText(de){return document.createTextNode(de)}appendChild(de,se){de.appendChild(se)}insertBefore(de,se,ve){de&&de.insertBefore(se,ve)}removeChild(de,se){de&&de.removeChild(se)}selectRootElement(de,se){let ve="string"==typeof de?document.querySelector(de):de;if(!ve)throw new Error(`The selector "${de}" did not match any elements`);return se||(ve.textContent=""),ve}parentNode(de){return de.parentNode}nextSibling(de){return de.nextSibling}setAttribute(de,se,ve,Ce){if(Ce){se=Ce+":"+se;const dn=Pt[Ce];dn?de.setAttributeNS(dn,se,ve):de.setAttribute(se,ve)}else de.setAttribute(se,ve)}removeAttribute(de,se,ve){if(ve){const Ce=Pt[ve];Ce?de.removeAttributeNS(Ce,se):de.removeAttribute(`${ve}:${se}`)}else de.removeAttribute(se)}addClass(de,se){de.classList.add(se)}removeClass(de,se){de.classList.remove(se)}setStyle(de,se,ve,Ce){Ce&(I.JOm.DashCase|I.JOm.Important)?de.style.setProperty(se,ve,Ce&I.JOm.Important?"important":""):de.style[se]=ve}removeStyle(de,se,ve){ve&I.JOm.DashCase?de.style.removeProperty(se):de.style[se]=""}setProperty(de,se,ve){de[se]=ve}setValue(de,se){de.nodeValue=se}listen(de,se,ve){return"string"==typeof de?this.eventManager.addGlobalEventListener(de,se,$n(ve)):this.eventManager.addEventListener(de,se,$n(ve))}}class Tt extends en{constructor(de,se,ve,Ce){super(de),this.component=ve;const dn=mn(Ce+"-"+ve.id,ve.styles,[]);se.addStyles(dn),this.contentAttr=function Ft(be){return"_ngcontent-%COMP%".replace(Ot,be)}(Ce+"-"+ve.id),this.hostAttr=function cn(be){return"_nghost-%COMP%".replace(Ot,be)}(Ce+"-"+ve.id)}applyToHost(de){super.setAttribute(de,this.hostAttr,"")}createElement(de,se){const ve=super.createElement(de,se);return super.setAttribute(ve,this.contentAttr,""),ve}}class Ee extends en{constructor(de,se,ve,Ce){super(de),this.sharedStylesHost=se,this.hostEl=ve,this.shadowRoot=ve.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const dn=mn(Ce.id,Ce.styles,[]);for(let Hn=0;Hn<dn.length;Hn++){const Oi=document.createElement("style");Oi.textContent=dn[Hn],this.shadowRoot.appendChild(Oi)}}nodeOrShadowRoot(de){return de===this.hostEl?this.shadowRoot:de}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(de,se){return super.appendChild(this.nodeOrShadowRoot(de),se)}insertBefore(de,se,ve){return super.insertBefore(this.nodeOrShadowRoot(de),se,ve)}removeChild(de,se){return super.removeChild(this.nodeOrShadowRoot(de),se)}parentNode(de){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(de)))}}let Ae=(()=>{class be extends Qe{constructor(se){super(se)}supports(se){return!0}addEventListener(se,ve,Ce){return se.addEventListener(ve,Ce,!1),()=>this.removeEventListener(se,ve,Ce)}removeEventListener(se,ve,Ce){return se.removeEventListener(ve,Ce)}}return be.\u0275fac=function(se){return new(se||be)(I.LFG(G.K0))},be.\u0275prov=I.Yz7({token:be,factory:be.\u0275fac}),be})();const ke=["alt","control","meta","shift"],Mt={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},ot={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Kt={alt:be=>be.altKey,control:be=>be.ctrlKey,meta:be=>be.metaKey,shift:be=>be.shiftKey};let Dn=(()=>{class be extends Qe{constructor(se){super(se)}supports(se){return null!=be.parseEventName(se)}addEventListener(se,ve,Ce){const dn=be.parseEventName(ve),Hn=be.eventCallback(dn.fullKey,Ce,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>(0,G.q)().onAndCancel(se,dn.domEventName,Hn))}static parseEventName(se){const ve=se.toLowerCase().split("."),Ce=ve.shift();if(0===ve.length||"keydown"!==Ce&&"keyup"!==Ce)return null;const dn=be._normalizeKey(ve.pop());let Hn="";if(ke.forEach(Nr=>{const ms=ve.indexOf(Nr);ms>-1&&(ve.splice(ms,1),Hn+=Nr+".")}),Hn+=dn,0!=ve.length||0===dn.length)return null;const Oi={};return Oi.domEventName=Ce,Oi.fullKey=Hn,Oi}static getEventFullKey(se){let ve="",Ce=function un(be){let de=be.key;if(null==de){if(de=be.keyIdentifier,null==de)return"Unidentified";de.startsWith("U+")&&(de=String.fromCharCode(parseInt(de.substring(2),16)),3===be.location&&ot.hasOwnProperty(de)&&(de=ot[de]))}return Mt[de]||de}(se);return Ce=Ce.toLowerCase()," "===Ce?Ce="space":"."===Ce&&(Ce="dot"),ke.forEach(dn=>{dn!=Ce&&Kt[dn](se)&&(ve+=dn+".")}),ve+=Ce,ve}static eventCallback(se,ve,Ce){return dn=>{be.getEventFullKey(dn)===se&&Ce.runGuarded(()=>ve(dn))}}static _normalizeKey(se){return"esc"===se?"escape":se}}return be.\u0275fac=function(se){return new(se||be)(I.LFG(G.K0))},be.\u0275prov=I.Yz7({token:be,factory:be.\u0275fac}),be})();const di=(0,I.eFA)(I._c5,"browser",[{provide:I.Lbi,useValue:G.bD},{provide:I.g9A,useValue:function lt(){et.makeCurrent(),gt.init()},multi:!0},{provide:G.K0,useFactory:function Si(){return(0,I.RDi)(document),document},deps:[]}]),Or=[{provide:I.zSh,useValue:"root"},{provide:I.qLn,useFactory:function Nt(){return new I.qLn},deps:[]},{provide:st,useClass:Ae,multi:!0,deps:[G.K0,I.R0b,I.Lbi]},{provide:st,useClass:Dn,multi:!0,deps:[G.K0]},{provide:gn,useClass:gn,deps:[Jn,Xn,I.AFp]},{provide:I.FYo,useExisting:gn},{provide:pn,useExisting:Xn},{provide:Xn,useClass:Xn,deps:[G.K0]},{provide:I.dDg,useClass:I.dDg,deps:[I.R0b]},{provide:Jn,useClass:Jn,deps:[st,I.R0b]},{provide:G.JF,useClass:zn,deps:[]}];let ar=(()=>{class be{constructor(se){if(se)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(se){return{ngModule:be,providers:[{provide:I.AFp,useValue:se.appId},{provide:zt,useExisting:I.AFp},ye]}}}return be.\u0275fac=function(se){return new(se||be)(I.LFG(be,12))},be.\u0275mod=I.oAB({type:be}),be.\u0275inj=I.cJS({providers:Or,imports:[G.ez,I.hGG]}),be})();"undefined"!=typeof window&&window;let Ps=(()=>{class be{}return be.\u0275fac=function(se){return new(se||be)},be.\u0275prov=I.Yz7({token:be,factory:function(se){let ve=null;return ve=se?new(se||be):I.LFG(vr),ve},providedIn:"root"}),be})(),vr=(()=>{class be extends Ps{constructor(se){super(),this._doc=se}sanitize(se,ve){if(null==ve)return null;switch(se){case I.q3G.NONE:return ve;case I.q3G.HTML:return(0,I.qzn)(ve,"HTML")?(0,I.z3N)(ve):(0,I.EiD)(this._doc,String(ve)).toString();case I.q3G.STYLE:return(0,I.qzn)(ve,"Style")?(0,I.z3N)(ve):ve;case I.q3G.SCRIPT:if((0,I.qzn)(ve,"Script"))return(0,I.z3N)(ve);throw new Error("unsafe value used in a script context");case I.q3G.URL:return(0,I.yhl)(ve),(0,I.qzn)(ve,"URL")?(0,I.z3N)(ve):(0,I.mCW)(String(ve));case I.q3G.RESOURCE_URL:if((0,I.qzn)(ve,"ResourceURL"))return(0,I.z3N)(ve);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${se} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(se){return(0,I.JVY)(se)}bypassSecurityTrustStyle(se){return(0,I.L6k)(se)}bypassSecurityTrustScript(se){return(0,I.eBb)(se)}bypassSecurityTrustUrl(se){return(0,I.LAX)(se)}bypassSecurityTrustResourceUrl(se){return(0,I.pB0)(se)}}return be.\u0275fac=function(se){return new(se||be)(I.LFG(G.K0))},be.\u0275prov=I.Yz7({token:be,factory:function(se){let ve=null;return ve=se?new se:function Ks(be){return new vr(be.get(G.K0))}(I.LFG(I.zs3)),ve},providedIn:"root"}),be})()},6324:(an,Je,ie)=>{ie.d(Je,{F0:()=>zr,yS:()=>Eo,Bz:()=>Jc,lC:()=>yo});var G=ie(1223),I=ie(2076),Te=ie(9646),et=ie(7579);class Ge extends et.x{constructor(g){super(),this._value=g}get value(){return this.getValue()}_subscribe(g){const x=super._subscribe(g);return!x.closed&&g.next(this._value),x}getValue(){const{hasError:g,thrownError:x,_value:C}=this;if(g)throw x;return this._throwIfClosed(),C}next(g){super.next(this._value=g)}}var kt=ie(8306),mt=ie(4742),It=ie(4671),zt=ie(3268),rt=ie(7669),ye=ie(1810),gt=ie(5403),zn=ie(9672);function Qe(m,g,x){m?(0,zn.f)(x,m,g):g()}var pn=ie(576);function Xn(m,g){const x=(0,pn.m)(m)?m:()=>m,C=O=>O.error(x());return new kt.y(g?O=>g.schedule(C,0,O):C)}var Fn=ie(6805),Pt=ie(8189);function dt(...m){return function Ot(){return(0,Pt.J)(1)}()((0,I.D)(m,(0,rt.yG)(m)))}var vt=ie(8421);function jn(m){return new kt.y(g=>{(0,vt.Xf)(m()).subscribe(g)})}var qe=ie(515),Ft=ie(727),cn=ie(4482);function mn(){return(0,cn.e)((m,g)=>{let x=null;m._refCount++;const C=(0,gt.x)(g,void 0,void 0,void 0,()=>{if(!m||m._refCount<=0||0<--m._refCount)return void(x=null);const O=m._connection,z=x;x=null,O&&(!z||O===z)&&O.unsubscribe(),g.unsubscribe()});m.subscribe(C),C.closed||(x=m.connect())})}class $n extends kt.y{constructor(g,x){super(),this.source=g,this.subjectFactory=x,this._subject=null,this._refCount=0,this._connection=null,(0,cn.A)(g)&&(this.lift=g.lift)}_subscribe(g){return this.getSubject().subscribe(g)}getSubject(){const g=this._subject;return(!g||g.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:g}=this;this._subject=this._connection=null,null==g||g.unsubscribe()}connect(){let g=this._connection;if(!g){g=this._connection=new Ft.w0;const x=this.getSubject();g.add(this.source.subscribe((0,gt.x)(x,void 0,()=>{this._teardown(),x.complete()},C=>{this._teardown(),x.error(C)},()=>this._teardown()))),g.closed&&(this._connection=null,g=Ft.w0.EMPTY)}return g}refCount(){return mn()(this)}}var Dt=ie(4004);function gn(m,g){return(0,cn.e)((x,C)=>{let O=null,z=0,H=!1;const ne=()=>H&&!O&&C.complete();x.subscribe((0,gt.x)(C,ue=>{null==O||O.unsubscribe();let Ie=0;const yt=z++;(0,vt.Xf)(m(ue,yt)).subscribe(O=(0,gt.x)(C,Et=>C.next(g?g(ue,Et,yt,Ie++):Et),()=>{O=null,ne()}))},()=>{H=!0,ne()}))})}var en=ie(5698);function rn(m,g,x,C,O){return(z,H)=>{let ne=x,ue=g,Ie=0;z.subscribe((0,gt.x)(H,yt=>{const Et=Ie++;ue=ne?m(ue,yt,Et):(ne=!0,yt),C&&H.next(ue)},O&&(()=>{ne&&H.next(ue),H.complete()})))}}function Tt(m,g){return(0,cn.e)(rn(m,g,arguments.length>=2,!0))}var Ee=ie(9300);function Ae(m){return(0,cn.e)((g,x)=>{let z,C=null,O=!1;C=g.subscribe((0,gt.x)(x,void 0,void 0,H=>{z=(0,vt.Xf)(m(H,Ae(m)(g))),C?(C.unsubscribe(),C=null,z.subscribe(x)):O=!0})),O&&(C.unsubscribe(),C=null,z.subscribe(x))})}var ke=ie(4351);function Ue(m){return m<=0?()=>qe.E:(0,cn.e)((g,x)=>{let C=[];g.subscribe((0,gt.x)(x,O=>{C.push(O),m<C.length&&C.shift()},()=>{for(const O of C)x.next(O);x.complete()},void 0,()=>{C=null}))})}var Mt=ie(8068),ot=ie(6590),Dn=ie(590),un=ie(5577);function lt(m,g,x){const C=(0,pn.m)(m)||g||x?{next:m,error:g,complete:x}:m;return C?(0,cn.e)((O,z)=>{var H;null===(H=C.subscribe)||void 0===H||H.call(C);let ne=!0;O.subscribe((0,gt.x)(z,ue=>{var Ie;null===(Ie=C.next)||void 0===Ie||Ie.call(C,ue),z.next(ue)},()=>{var ue;ne=!1,null===(ue=C.complete)||void 0===ue||ue.call(C),z.complete()},ue=>{var Ie;ne=!1,null===(Ie=C.error)||void 0===Ie||Ie.call(C,ue),z.error(ue)},()=>{var ue,Ie;ne&&(null===(ue=C.unsubscribe)||void 0===ue||ue.call(C)),null===(Ie=C.finalize)||void 0===Ie||Ie.call(C)}))}):It.y}var Si=ie(9808);class hi{constructor(g,x){this.id=g,this.url=x}}class di extends hi{constructor(g,x,C="imperative",O=null){super(g,x),this.navigationTrigger=C,this.restoredState=O}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Or extends hi{constructor(g,x,C){super(g,x),this.urlAfterRedirects=C}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class ar extends hi{constructor(g,x,C){super(g,x),this.reason=C}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class fs extends hi{constructor(g,x,C){super(g,x),this.error=C}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Hs extends hi{constructor(g,x,C,O){super(g,x),this.urlAfterRedirects=C,this.state=O}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Bc extends hi{constructor(g,x,C,O){super(g,x),this.urlAfterRedirects=C,this.state=O}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Zi extends hi{constructor(g,x,C,O,z){super(g,x),this.urlAfterRedirects=C,this.state=O,this.shouldActivate=z}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class fo extends hi{constructor(g,x,C,O){super(g,x),this.urlAfterRedirects=C,this.state=O}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Fo extends hi{constructor(g,x,C,O){super(g,x),this.urlAfterRedirects=C,this.state=O}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class No{constructor(g){this.route=g}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Va{constructor(g){this.route=g}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Jl{constructor(g){this.snapshot=g}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class hn{constructor(g){this.snapshot=g}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Fr{constructor(g){this.snapshot=g}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class oi{constructor(g){this.snapshot=g}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class tn{constructor(g,x,C){this.routerEvent=g,this.position=x,this.anchor=C}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const _t="primary";class za{constructor(g){this.params=g||{}}has(g){return Object.prototype.hasOwnProperty.call(this.params,g)}get(g){if(this.has(g)){const x=this.params[g];return Array.isArray(x)?x[0]:x}return null}getAll(g){if(this.has(g)){const x=this.params[g];return Array.isArray(x)?x:[x]}return[]}get keys(){return Object.keys(this.params)}}function er(m){return new za(m)}const ki="ngNavigationCancelingError";function lr(m){const g=Error("NavigationCancelingError: "+m);return g[ki]=!0,g}function Is(m,g,x){const C=x.path.split("/");if(C.length>m.length||"full"===x.pathMatch&&(g.hasChildren()||C.length<m.length))return null;const O={};for(let z=0;z<C.length;z++){const H=C[z],ne=m[z];if(H.startsWith(":"))O[H.substring(1)]=ne;else if(H!==ne.path)return null}return{consumed:m.slice(0,C.length),posParams:O}}function is(m,g){const x=m?Object.keys(m):void 0,C=g?Object.keys(g):void 0;if(!x||!C||x.length!=C.length)return!1;let O;for(let z=0;z<x.length;z++)if(O=x[z],!ai(m[O],g[O]))return!1;return!0}function ai(m,g){if(Array.isArray(m)&&Array.isArray(g)){if(m.length!==g.length)return!1;const x=[...m].sort(),C=[...g].sort();return x.every((O,z)=>C[z]===O)}return m===g}function vl(m){return Array.prototype.concat.apply([],m)}function fi(m){return m.length>0?m[m.length-1]:null}function Li(m,g){for(const x in m)m.hasOwnProperty(x)&&g(m[x],x)}function qn(m){return(0,G.CqO)(m)?m:(0,G.QGY)(m)?(0,I.D)(Promise.resolve(m)):(0,Te.of)(m)}const Gs={exact:function vr(m,g,x){if(!Oi(m.segments,g.segments)||!se(m.segments,g.segments,x)||m.numberOfChildren!==g.numberOfChildren)return!1;for(const C in g.children)if(!m.children[C]||!vr(m.children[C],g.children[C],x))return!1;return!0},subset:be},ps={exact:function Ks(m,g){return is(m,g)},subset:function po(m,g){return Object.keys(g).length<=Object.keys(m).length&&Object.keys(g).every(x=>ai(m[x],g[x]))},ignored:()=>!0};function Ps(m,g,x){return Gs[x.paths](m.root,g.root,x.matrixParams)&&ps[x.queryParams](m.queryParams,g.queryParams)&&!("exact"===x.fragment&&m.fragment!==g.fragment)}function be(m,g,x){return de(m,g,g.segments,x)}function de(m,g,x,C){if(m.segments.length>x.length){const O=m.segments.slice(0,x.length);return!(!Oi(O,x)||g.hasChildren()||!se(O,x,C))}if(m.segments.length===x.length){if(!Oi(m.segments,x)||!se(m.segments,x,C))return!1;for(const O in g.children)if(!m.children[O]||!be(m.children[O],g.children[O],C))return!1;return!0}{const O=x.slice(0,m.segments.length),z=x.slice(m.segments.length);return!!(Oi(m.segments,O)&&se(m.segments,O,C)&&m.children[_t])&&de(m.children[_t],g,z,C)}}function se(m,g,x){return g.every((C,O)=>ps[x](m[O].parameters,C.parameters))}class ve{constructor(g,x,C){this.root=g,this.queryParams=x,this.fragment=C}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=er(this.queryParams)),this._queryParamMap}toString(){return tr.serialize(this)}}class Ce{constructor(g,x){this.segments=g,this.children=x,this.parent=null,Li(x,(C,O)=>C.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return jr(this)}}class dn{constructor(g,x){this.path=g,this.parameters=x}get parameterMap(){return this._parameterMap||(this._parameterMap=er(this.parameters)),this._parameterMap}toString(){return Ni(this)}}function Oi(m,g){return m.length===g.length&&m.every((x,C)=>x.path===g[C].path)}class ms{}class kr{parse(g){const x=new rs(g);return new ve(x.parseRootSegment(),x.parseQueryParams(),x.parseFragment())}serialize(g){const x=`/${Ar(g.root,!0)}`,C=function $r(m){const g=Object.keys(m).map(x=>{const C=m[x];return Array.isArray(C)?C.map(O=>`${Js(x)}=${Js(O)}`).join("&"):`${Js(x)}=${Js(C)}`}).filter(x=>!!x);return g.length?`?${g.join("&")}`:""}(g.queryParams);return`${x}${C}${"string"==typeof g.fragment?`#${function ca(m){return encodeURI(m)}(g.fragment)}`:""}`}}const tr=new kr;function jr(m){return m.segments.map(g=>Ni(g)).join("/")}function Ar(m,g){if(!m.hasChildren())return jr(m);if(g){const x=m.children[_t]?Ar(m.children[_t],!1):"",C=[];return Li(m.children,(O,z)=>{z!==_t&&C.push(`${z}:${Ar(O,!1)}`)}),C.length>0?`${x}(${C.join("//")})`:x}{const x=function Nr(m,g){let x=[];return Li(m.children,(C,O)=>{O===_t&&(x=x.concat(g(C,O)))}),Li(m.children,(C,O)=>{O!==_t&&(x=x.concat(g(C,O)))}),x}(m,(C,O)=>O===_t?[Ar(m.children[_t],!1)]:[`${O}:${Ar(C,!1)}`]);return 1===Object.keys(m.children).length&&null!=m.children[_t]?`${jr(m)}/${x[0]}`:`${jr(m)}/(${x.join("//")})`}}function Tr(m){return encodeURIComponent(m).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Js(m){return Tr(m).replace(/%3B/gi,";")}function nr(m){return Tr(m).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Qs(m){return decodeURIComponent(m)}function Ui(m){return Qs(m.replace(/\+/g,"%20"))}function Ni(m){return`${nr(m.path)}${function yl(m){return Object.keys(m).map(g=>`;${nr(g)}=${nr(m[g])}`).join("")}(m.parameters)}`}const Ut=/^[^\/()?;=#]+/;function Ln(m){const g=m.match(Ut);return g?g[0]:""}const Di=/^[^=?&#]+/,mo=/^[^&#]+/;class rs{constructor(g){this.url=g,this.remaining=g}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ce([],{}):new Ce([],this.parseChildren())}parseQueryParams(){const g={};if(this.consumeOptional("?"))do{this.parseQueryParam(g)}while(this.consumeOptional("&"));return g}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const g=[];for(this.peekStartsWith("(")||g.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),g.push(this.parseSegment());let x={};this.peekStartsWith("/(")&&(this.capture("/"),x=this.parseParens(!0));let C={};return this.peekStartsWith("(")&&(C=this.parseParens(!1)),(g.length>0||Object.keys(x).length>0)&&(C[_t]=new Ce(g,x)),C}parseSegment(){const g=Ln(this.remaining);if(""===g&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(g),new dn(Qs(g),this.parseMatrixParams())}parseMatrixParams(){const g={};for(;this.consumeOptional(";");)this.parseParam(g);return g}parseParam(g){const x=Ln(this.remaining);if(!x)return;this.capture(x);let C="";if(this.consumeOptional("=")){const O=Ln(this.remaining);O&&(C=O,this.capture(C))}g[Qs(x)]=Qs(C)}parseQueryParam(g){const x=function Ur(m){const g=m.match(Di);return g?g[0]:""}(this.remaining);if(!x)return;this.capture(x);let C="";if(this.consumeOptional("=")){const H=function Vi(m){const g=m.match(mo);return g?g[0]:""}(this.remaining);H&&(C=H,this.capture(C))}const O=Ui(x),z=Ui(C);if(g.hasOwnProperty(O)){let H=g[O];Array.isArray(H)||(H=[H],g[O]=H),H.push(z)}else g[O]=z}parseParens(g){const x={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const C=Ln(this.remaining),O=this.remaining[C.length];if("/"!==O&&")"!==O&&";"!==O)throw new Error(`Cannot parse url '${this.url}'`);let z;C.indexOf(":")>-1?(z=C.substr(0,C.indexOf(":")),this.capture(z),this.capture(":")):g&&(z=_t);const H=this.parseChildren();x[z]=1===Object.keys(H).length?H[_t]:new Ce([],H),this.consumeOptional("//")}return x}peekStartsWith(g){return this.remaining.startsWith(g)}consumeOptional(g){return!!this.peekStartsWith(g)&&(this.remaining=this.remaining.substring(g.length),!0)}capture(g){if(!this.consumeOptional(g))throw new Error(`Expected "${g}".`)}}class Ri{constructor(g){this._root=g}get root(){return this._root.value}parent(g){const x=this.pathFromRoot(g);return x.length>1?x[x.length-2]:null}children(g){const x=gs(g,this._root);return x?x.children.map(C=>C.value):[]}firstChild(g){const x=gs(g,this._root);return x&&x.children.length>0?x.children[0].value:null}siblings(g){const x=eo(g,this._root);return x.length<2?[]:x[x.length-2].children.map(O=>O.value).filter(O=>O!==g)}pathFromRoot(g){return eo(g,this._root).map(x=>x.value)}}function gs(m,g){if(m===g.value)return g;for(const x of g.children){const C=gs(m,x);if(C)return C}return null}function eo(m,g){if(m===g.value)return[g];for(const x of g.children){const C=eo(m,x);if(C.length)return C.unshift(g),C}return[]}class fn{constructor(g,x){this.value=g,this.children=x}toString(){return`TreeNode(${this.value})`}}function vs(m){const g={};return m&&m.children.forEach(x=>g[x.value.outlet]=x),g}class ss extends Ri{constructor(g,x){super(g),this.snapshot=x,Ha(this,g)}toString(){return this.snapshot.toString()}}function to(m,g){const x=function no(m,g){const H=new cr([],{},{},"",{},_t,g,null,m.root,-1,{});return new pi("",new fn(H,[]))}(m,g),C=new Ge([new dn("",{})]),O=new Ge({}),z=new Ge({}),H=new Ge({}),ne=new Ge(""),ue=new ji(C,O,H,ne,z,_t,g,x.root);return ue.snapshot=x.root,new ss(new fn(ue,[]),x)}class ji{constructor(g,x,C,O,z,H,ne,ue){this.url=g,this.params=x,this.queryParams=C,this.fragment=O,this.data=z,this.outlet=H,this.component=ne,this._futureSnapshot=ue}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,Dt.U)(g=>er(g)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,Dt.U)(g=>er(g)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function io(m,g="emptyOnly"){const x=m.pathFromRoot;let C=0;if("always"!==g)for(C=x.length-1;C>=1;){const O=x[C],z=x[C-1];if(O.routeConfig&&""===O.routeConfig.path)C--;else{if(z.component)break;C--}}return function ro(m){return m.reduce((g,x)=>({params:Object.assign(Object.assign({},g.params),x.params),data:Object.assign(Object.assign({},g.data),x.data),resolve:Object.assign(Object.assign({},g.resolve),x._resolvedData)}),{params:{},data:{},resolve:{}})}(x.slice(C))}class cr{constructor(g,x,C,O,z,H,ne,ue,Ie,yt,Et){this.url=g,this.params=x,this.queryParams=C,this.fragment=O,this.data=z,this.outlet=H,this.component=ne,this.routeConfig=ue,this._urlSegment=Ie,this._lastPathIndex=yt,this._resolve=Et}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=er(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=er(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(C=>C.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class pi extends Ri{constructor(g,x){super(x),this.url=g,Ha(this,x)}toString(){return ua(this._root)}}function Ha(m,g){g.value._routerState=m,g.children.forEach(x=>Ha(m,x))}function ua(m){const g=m.children.length>0?` { ${m.children.map(ua).join(", ")} } `:"";return`${m.value}${g}`}function ir(m){if(m.snapshot){const g=m.snapshot,x=m._futureSnapshot;m.snapshot=x,is(g.queryParams,x.queryParams)||m.queryParams.next(x.queryParams),g.fragment!==x.fragment&&m.fragment.next(x.fragment),is(g.params,x.params)||m.params.next(x.params),function An(m,g){if(m.length!==g.length)return!1;for(let x=0;x<m.length;++x)if(!is(m[x],g[x]))return!1;return!0}(g.url,x.url)||m.url.next(x.url),is(g.data,x.data)||m.data.next(x.data)}else m.snapshot=m._futureSnapshot,m.data.next(m._futureSnapshot.data)}function ni(m,g){const x=is(m.params,g.params)&&function Hn(m,g){return Oi(m,g)&&m.every((x,C)=>is(x.parameters,g[C].parameters))}(m.url,g.url);return x&&!(!m.parent!=!g.parent)&&(!m.parent||ni(m.parent,g.parent))}function Ls(m,g,x){if(x&&m.shouldReuseRoute(g.value,x.value.snapshot)){const C=x.value;C._futureSnapshot=g.value;const O=function ha(m,g,x){return g.children.map(C=>{for(const O of x.children)if(m.shouldReuseRoute(C.value,O.value.snapshot))return Ls(m,C,O);return Ls(m,C)})}(m,g,x);return new fn(C,O)}{if(m.shouldAttach(g.value)){const z=m.retrieve(g.value);if(null!==z){const H=z.route;return H.value._futureSnapshot=g.value,H.children=g.children.map(ne=>Ls(m,ne)),H}}const C=function ur(m){return new ji(new Ge(m.url),new Ge(m.params),new Ge(m.queryParams),new Ge(m.fragment),new Ge(m.data),m.outlet,m.component,m)}(g.value),O=g.children.map(z=>Ls(m,z));return new fn(C,O)}}function da(m){return"object"==typeof m&&null!=m&&!m.outlets&&!m.segmentPath}function Wa(m){return"object"==typeof m&&null!=m&&m.outlets}function Os(m,g,x,C,O){let z={};if(C&&Li(C,(ne,ue)=>{z[ue]=Array.isArray(ne)?ne.map(Ie=>`${Ie}`):`${ne}`}),m===g)return new ve(x,z,O);const H=Ws(m,g,x);return new ve(H,z,O)}function Ws(m,g,x){const C={};return Li(m.children,(O,z)=>{C[z]=O===g?x:Ws(O,g,x)}),new Ce(m.segments,C)}class hr{constructor(g,x,C){if(this.isAbsolute=g,this.numberOfDoubleDots=x,this.commands=C,g&&C.length>0&&da(C[0]))throw new Error("Root segment cannot have matrix parameters");const O=C.find(Wa);if(O&&O!==fi(C))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class ja{constructor(g,x,C){this.segmentGroup=g,this.processChildren=x,this.index=C}}function Vc(m,g,x){if(m||(m=new Ce([],{})),0===m.segments.length&&m.hasChildren())return _l(m,g,x);const C=function Wu(m,g,x){let C=0,O=g;const z={match:!1,pathIndex:0,commandIndex:0};for(;O<m.segments.length;){if(C>=x.length)return z;const H=m.segments[O],ne=x[C];if(Wa(ne))break;const ue=`${ne}`,Ie=C<x.length-1?x[C+1]:null;if(O>0&&void 0===ue)break;if(ue&&Ie&&"object"==typeof Ie&&void 0===Ie.outlets){if(!$a(ue,Ie,H))return z;C+=2}else{if(!$a(ue,{},H))return z;C++}O++}return{match:!0,pathIndex:O,commandIndex:C}}(m,g,x),O=x.slice(C.commandIndex);if(C.match&&C.pathIndex<m.segments.length){const z=new Ce(m.segments.slice(0,C.pathIndex),{});return z.children[_t]=new Ce(m.segments.slice(C.pathIndex),m.children),_l(z,0,O)}return C.match&&0===O.length?new Ce(m.segments,{}):C.match&&!m.hasChildren()?ko(m,g,x):C.match?_l(m,0,O):ko(m,g,x)}function _l(m,g,x){if(0===x.length)return new Ce(m.segments,{});{const C=function Ql(m){return Wa(m[0])?m[0].outlets:{[_t]:m}}(x),O={};return Li(C,(z,H)=>{"string"==typeof z&&(z=[z]),null!==z&&(O[H]=Vc(m.children[H],g,z))}),Li(m.children,(z,H)=>{void 0===C[H]&&(O[H]=z)}),new Ce(m.segments,O)}}function ko(m,g,x){const C=m.segments.slice(0,g);let O=0;for(;O<x.length;){const z=x[O];if(Wa(z)){const ue=nd(z.outlets);return new Ce(C,ue)}if(0===O&&da(x[0])){C.push(new dn(m.segments[g].path,ju(x[0]))),O++;continue}const H=Wa(z)?z.outlets[_t]:`${z}`,ne=O<x.length-1?x[O+1]:null;H&&ne&&da(ne)?(C.push(new dn(H,ju(ne))),O+=2):(C.push(new dn(H,{})),O++)}return new Ce(C,{})}function nd(m){const g={};return Li(m,(x,C)=>{"string"==typeof x&&(x=[x]),null!==x&&(g[C]=ko(new Ce([],{}),0,x))}),g}function ju(m){const g={};return Li(m,(x,C)=>g[C]=`${x}`),g}function $a(m,g,x){return m==x.path&&is(g,x.parameters)}class xl{constructor(g,x,C,O){this.routeReuseStrategy=g,this.futureState=x,this.currState=C,this.forwardEvent=O}activate(g){const x=this.futureState._root,C=this.currState?this.currState._root:null;this.deactivateChildRoutes(x,C,g),ir(this.futureState.root),this.activateChildRoutes(x,C,g)}deactivateChildRoutes(g,x,C){const O=vs(x);g.children.forEach(z=>{const H=z.value.outlet;this.deactivateRoutes(z,O[H],C),delete O[H]}),Li(O,(z,H)=>{this.deactivateRouteAndItsChildren(z,C)})}deactivateRoutes(g,x,C){const O=g.value,z=x?x.value:null;if(O===z)if(O.component){const H=C.getContext(O.outlet);H&&this.deactivateChildRoutes(g,x,H.children)}else this.deactivateChildRoutes(g,x,C);else z&&this.deactivateRouteAndItsChildren(x,C)}deactivateRouteAndItsChildren(g,x){g.value.component&&this.routeReuseStrategy.shouldDetach(g.value.snapshot)?this.detachAndStoreRouteSubtree(g,x):this.deactivateRouteAndOutlet(g,x)}detachAndStoreRouteSubtree(g,x){const C=x.getContext(g.value.outlet),O=C&&g.value.component?C.children:x,z=vs(g);for(const H of Object.keys(z))this.deactivateRouteAndItsChildren(z[H],O);if(C&&C.outlet){const H=C.outlet.detach(),ne=C.children.onOutletDeactivated();this.routeReuseStrategy.store(g.value.snapshot,{componentRef:H,route:g,contexts:ne})}}deactivateRouteAndOutlet(g,x){const C=x.getContext(g.value.outlet),O=C&&g.value.component?C.children:x,z=vs(g);for(const H of Object.keys(z))this.deactivateRouteAndItsChildren(z[H],O);C&&C.outlet&&(C.outlet.deactivate(),C.children.onOutletDeactivated(),C.attachRef=null,C.resolver=null,C.route=null)}activateChildRoutes(g,x,C){const O=vs(x);g.children.forEach(z=>{this.activateRoutes(z,O[z.value.outlet],C),this.forwardEvent(new oi(z.value.snapshot))}),g.children.length&&this.forwardEvent(new hn(g.value.snapshot))}activateRoutes(g,x,C){const O=g.value,z=x?x.value:null;if(ir(O),O===z)if(O.component){const H=C.getOrCreateContext(O.outlet);this.activateChildRoutes(g,x,H.children)}else this.activateChildRoutes(g,x,C);else if(O.component){const H=C.getOrCreateContext(O.outlet);if(this.routeReuseStrategy.shouldAttach(O.snapshot)){const ne=this.routeReuseStrategy.retrieve(O.snapshot);this.routeReuseStrategy.store(O.snapshot,null),H.children.onOutletReAttached(ne.contexts),H.attachRef=ne.componentRef,H.route=ne.route.value,H.outlet&&H.outlet.attach(ne.componentRef,ne.route.value),ir(ne.route.value),this.activateChildRoutes(g,null,H.children)}else{const ne=function id(m){for(let g=m.parent;g;g=g.parent){const x=g.routeConfig;if(x&&x._loadedConfig)return x._loadedConfig;if(x&&x.component)return null}return null}(O.snapshot),ue=ne?ne.module.componentFactoryResolver:null;H.attachRef=null,H.route=O,H.resolver=ue,H.outlet&&H.outlet.activateWith(O,ue),this.activateChildRoutes(g,null,H.children)}}else this.activateChildRoutes(g,null,C)}}class ec{constructor(g,x){this.routes=g,this.module=x}}function ys(m){return"function"==typeof m}function _s(m){return m instanceof ve}const fa=Symbol("INITIAL_VALUE");function pa(){return gn(m=>function st(...m){const g=(0,rt.yG)(m),x=(0,rt.jO)(m),{args:C,keys:O}=(0,mt.D)(m);if(0===C.length)return(0,I.D)([],g);const z=new kt.y(function Jn(m,g,x=It.y){return C=>{Qe(g,()=>{const{length:O}=m,z=new Array(O);let H=O,ne=O;for(let ue=0;ue<O;ue++)Qe(g,()=>{const Ie=(0,I.D)(m[ue],g);let yt=!1;Ie.subscribe((0,gt.x)(C,Et=>{z[ue]=Et,yt||(yt=!0,ne--),ne||C.next(x(z.slice()))},()=>{--H||C.complete()}))},C)},C)}}(C,g,O?H=>(0,ye.n)(O,H):It.y));return x?z.pipe((0,zt.Z)(x)):z}(m.map(g=>g.pipe((0,en.q)(1),function Sr(...m){const g=(0,rt.yG)(m);return(0,cn.e)((x,C)=>{(g?dt(m,x,g):dt(m,x)).subscribe(C)})}(fa)))).pipe(Tt((g,x)=>{let C=!1;return x.reduce((O,z,H)=>O!==fa?O:(z===fa&&(C=!0),C||!1!==z&&H!==x.length-1&&!_s(z)?O:z),g)},fa),(0,Ee.h)(g=>g!==fa),(0,Dt.U)(g=>_s(g)?g:!0===g),(0,en.q)(1)))}class ic{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new vo,this.attachRef=null}}class vo{constructor(){this.contexts=new Map}onChildOutletCreated(g,x){const C=this.getOrCreateContext(g);C.outlet=x,this.contexts.set(g,C)}onChildOutletDestroyed(g){const x=this.getContext(g);x&&(x.outlet=null,x.attachRef=null)}onOutletDeactivated(){const g=this.contexts;return this.contexts=new Map,g}onOutletReAttached(g){this.contexts=g}getOrCreateContext(g){let x=this.getContext(g);return x||(x=new ic,this.contexts.set(g,x)),x}getContext(g){return this.contexts.get(g)||null}}let yo=(()=>{class m{constructor(x,C,O,z,H){this.parentContexts=x,this.location=C,this.resolver=O,this.changeDetector=H,this.activated=null,this._activatedRoute=null,this.activateEvents=new G.vpe,this.deactivateEvents=new G.vpe,this.attachEvents=new G.vpe,this.detachEvents=new G.vpe,this.name=z||_t,x.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const x=this.parentContexts.getContext(this.name);x&&x.route&&(x.attachRef?this.attach(x.attachRef,x.route):this.activateWith(x.route,x.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const x=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(x.instance),x}attach(x,C){this.activated=x,this._activatedRoute=C,this.location.insert(x.hostView),this.attachEvents.emit(x.instance)}deactivate(){if(this.activated){const x=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(x)}}activateWith(x,C){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=x;const H=(C=C||this.resolver).resolveComponentFactory(x._futureSnapshot.routeConfig.component),ne=this.parentContexts.getOrCreateContext(this.name).children,ue=new as(x,ne,this.location.injector);this.activated=this.location.createComponent(H,this.location.length,ue),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return m.\u0275fac=function(x){return new(x||m)(G.Y36(vo),G.Y36(G.s_b),G.Y36(G._Vd),G.$8M("name"),G.Y36(G.sBO))},m.\u0275dir=G.lG2({type:m,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),m})();class as{constructor(g,x,C){this.route=g,this.childContexts=x,this.parent=C}get(g,x){return g===ji?this.route:g===vo?this.childContexts:this.parent.get(g,x)}}let rc=(()=>{class m{}return m.\u0275fac=function(x){return new(x||m)},m.\u0275cmp=G.Xpm({type:m,selectors:[["ng-component"]],decls:1,vars:0,template:function(x,C){1&x&&G._UZ(0,"router-outlet")},directives:[yo],encapsulation:2}),m})();function sc(m,g=""){for(let x=0;x<m.length;x++){const C=m[x];N(C,$(g,C))}}function N(m,g){m.children&&sc(m.children,g)}function $(m,g){return g?m||g.path?m&&!g.path?`${m}/`:!m&&g.path?g.path:`${m}/${g.path}`:"":m}function k(m){const g=m.children&&m.children.map(k),x=g?Object.assign(Object.assign({},m),{children:g}):Object.assign({},m);return!x.component&&(g||x.loadChildren)&&x.outlet&&x.outlet!==_t&&(x.component=rc),x}function Y(m){return m.outlet||_t}function le(m,g){const x=m.filter(C=>Y(C)===g);return x.push(...m.filter(C=>Y(C)!==g)),x}const Oe={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function tt(m,g,x){var C;if(""===g.path)return"full"===g.pathMatch&&(m.hasChildren()||x.length>0)?Object.assign({},Oe):{matched:!0,consumedSegments:[],remainingSegments:x,parameters:{},positionalParamSegments:{}};const z=(g.matcher||Is)(x,m,g);if(!z)return Object.assign({},Oe);const H={};Li(z.posParams,(ue,Ie)=>{H[Ie]=ue.path});const ne=z.consumed.length>0?Object.assign(Object.assign({},H),z.consumed[z.consumed.length-1].parameters):H;return{matched:!0,consumedSegments:z.consumed,remainingSegments:x.slice(z.consumed.length),parameters:ne,positionalParamSegments:null!==(C=z.posParams)&&void 0!==C?C:{}}}function bt(m,g,x,C,O="corrected"){if(x.length>0&&function Mn(m,g,x){return x.some(C=>xi(m,g,C)&&Y(C)!==_t)}(m,x,C)){const H=new Ce(g,function _i(m,g,x,C){const O={};O[_t]=C,C._sourceSegment=m,C._segmentIndexShift=g.length;for(const z of x)if(""===z.path&&Y(z)!==_t){const H=new Ce([],{});H._sourceSegment=m,H._segmentIndexShift=g.length,O[Y(z)]=H}return O}(m,g,C,new Ce(x,m.children)));return H._sourceSegment=m,H._segmentIndexShift=g.length,{segmentGroup:H,slicedSegments:[]}}if(0===x.length&&function Sn(m,g,x){return x.some(C=>xi(m,g,C))}(m,x,C)){const H=new Ce(m.segments,function yi(m,g,x,C,O,z){const H={};for(const ne of C)if(xi(m,x,ne)&&!O[Y(ne)]){const ue=new Ce([],{});ue._sourceSegment=m,ue._segmentIndexShift="legacy"===z?m.segments.length:g.length,H[Y(ne)]=ue}return Object.assign(Object.assign({},O),H)}(m,g,x,C,m.children,O));return H._sourceSegment=m,H._segmentIndexShift=g.length,{segmentGroup:H,slicedSegments:x}}const z=new Ce(m.segments,m.children);return z._sourceSegment=m,z._segmentIndexShift=g.length,{segmentGroup:z,slicedSegments:x}}function xi(m,g,x){return(!(m.hasChildren()||g.length>0)||"full"!==x.pathMatch)&&""===x.path}function ii(m,g,x,C){return!!(Y(m)===C||C!==_t&&xi(g,x,m))&&("**"===m.path||tt(g,m,x).matched)}function Qn(m,g,x){return 0===g.length&&!m.children[x]}class Xr{constructor(g){this.segmentGroup=g||null}}class $i{constructor(g){this.urlTree=g}}function ri(m){return Xn(new Xr(m))}function Ai(m){return Xn(new $i(m))}class xs{constructor(g,x,C,O,z){this.configLoader=x,this.urlSerializer=C,this.urlTree=O,this.config=z,this.allowRedirects=!0,this.ngModule=g.get(G.h0i)}apply(){const g=bt(this.urlTree.root,[],[],this.config).segmentGroup,x=new Ce(g.segments,g.children);return this.expandSegmentGroup(this.ngModule,this.config,x,_t).pipe((0,Dt.U)(z=>this.createUrlTree(Ii(z),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Ae(z=>{if(z instanceof $i)return this.allowRedirects=!1,this.match(z.urlTree);throw z instanceof Xr?this.noMatchError(z):z}))}match(g){return this.expandSegmentGroup(this.ngModule,this.config,g.root,_t).pipe((0,Dt.U)(O=>this.createUrlTree(Ii(O),g.queryParams,g.fragment))).pipe(Ae(O=>{throw O instanceof Xr?this.noMatchError(O):O}))}noMatchError(g){return new Error(`Cannot match any routes. URL Segment: '${g.segmentGroup}'`)}createUrlTree(g,x,C){const O=g.segments.length>0?new Ce([],{[_t]:g}):g;return new ve(O,x,C)}expandSegmentGroup(g,x,C,O){return 0===C.segments.length&&C.hasChildren()?this.expandChildren(g,x,C).pipe((0,Dt.U)(z=>new Ce([],z))):this.expandSegment(g,C,x,C.segments,O,!0)}expandChildren(g,x,C){const O=[];for(const z of Object.keys(C.children))"primary"===z?O.unshift(z):O.push(z);return(0,I.D)(O).pipe((0,ke.b)(z=>{const H=C.children[z],ne=le(x,z);return this.expandSegmentGroup(g,ne,H,z).pipe((0,Dt.U)(ue=>({segment:ue,outlet:z})))}),Tt((z,H)=>(z[H.outlet]=H.segment,z),{}),function Kt(m,g){const x=arguments.length>=2;return C=>C.pipe(m?(0,Ee.h)((O,z)=>m(O,z,C)):It.y,Ue(1),x?(0,ot.d)(g):(0,Mt.T)(()=>new Fn.K))}())}expandSegment(g,x,C,O,z,H){return(0,I.D)(C).pipe((0,ke.b)(ne=>this.expandSegmentAgainstRoute(g,x,C,ne,O,z,H).pipe(Ae(Ie=>{if(Ie instanceof Xr)return(0,Te.of)(null);throw Ie}))),(0,Dn.P)(ne=>!!ne),Ae((ne,ue)=>{if(ne instanceof Fn.K||"EmptyError"===ne.name)return Qn(x,O,z)?(0,Te.of)(new Ce([],{})):ri(x);throw ne}))}expandSegmentAgainstRoute(g,x,C,O,z,H,ne){return ii(O,x,z,H)?void 0===O.redirectTo?this.matchSegmentAgainstRoute(g,x,O,z,H):ne&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(g,x,C,O,z,H):ri(x):ri(x)}expandSegmentAgainstRouteUsingRedirect(g,x,C,O,z,H){return"**"===O.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(g,C,O,H):this.expandRegularSegmentAgainstRouteUsingRedirect(g,x,C,O,z,H)}expandWildCardWithParamsAgainstRouteUsingRedirect(g,x,C,O){const z=this.applyRedirectCommands([],C.redirectTo,{});return C.redirectTo.startsWith("/")?Ai(z):this.lineralizeSegments(C,z).pipe((0,un.z)(H=>{const ne=new Ce(H,{});return this.expandSegment(g,ne,x,H,O,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(g,x,C,O,z,H){const{matched:ne,consumedSegments:ue,remainingSegments:Ie,positionalParamSegments:yt}=tt(x,O,z);if(!ne)return ri(x);const Et=this.applyRedirectCommands(ue,O.redirectTo,yt);return O.redirectTo.startsWith("/")?Ai(Et):this.lineralizeSegments(O,Et).pipe((0,un.z)(Jt=>this.expandSegment(g,x,C,Jt.concat(Ie),H,!1)))}matchSegmentAgainstRoute(g,x,C,O,z){if("**"===C.path)return C.loadChildren?(C._loadedConfig?(0,Te.of)(C._loadedConfig):this.configLoader.load(g.injector,C)).pipe((0,Dt.U)(Et=>(C._loadedConfig=Et,new Ce(O,{})))):(0,Te.of)(new Ce(O,{}));const{matched:H,consumedSegments:ne,remainingSegments:ue}=tt(x,C,O);return H?this.getChildConfig(g,C,O).pipe((0,un.z)(yt=>{const Et=yt.module,Jt=yt.routes,{segmentGroup:$t,slicedSegments:Gn}=bt(x,ne,ue,Jt),Ti=new Ce($t.segments,$t.children);if(0===Gn.length&&Ti.hasChildren())return this.expandChildren(Et,Jt,Ti).pipe((0,Dt.U)(Zr=>new Ce(ne,Zr)));if(0===Jt.length&&0===Gn.length)return(0,Te.of)(new Ce(ne,{}));const yr=Y(C)===z;return this.expandSegment(Et,Ti,Jt,Gn,yr?_t:z,!0).pipe((0,Dt.U)(Rn=>new Ce(ne.concat(Rn.segments),Rn.children)))})):ri(x)}getChildConfig(g,x,C){return x.children?(0,Te.of)(new ec(x.children,g)):x.loadChildren?void 0!==x._loadedConfig?(0,Te.of)(x._loadedConfig):this.runCanLoadGuards(g.injector,x,C).pipe((0,un.z)(O=>O?this.configLoader.load(g.injector,x).pipe((0,Dt.U)(z=>(x._loadedConfig=z,z))):function Fs(m){return Xn(lr(`Cannot load children because the guard of the route "path: '${m.path}'" returned false`))}(x))):(0,Te.of)(new ec([],g))}runCanLoadGuards(g,x,C){const O=x.canLoad;if(!O||0===O.length)return(0,Te.of)(!0);const z=O.map(H=>{const ne=g.get(H);let ue;if(function Bo(m){return m&&ys(m.canLoad)}(ne))ue=ne.canLoad(x,C);else{if(!ys(ne))throw new Error("Invalid CanLoad guard");ue=ne(x,C)}return qn(ue)});return(0,Te.of)(z).pipe(pa(),lt(H=>{if(!_s(H))return;const ne=lr(`Redirecting to "${this.urlSerializer.serialize(H)}"`);throw ne.url=H,ne}),(0,Dt.U)(H=>!0===H))}lineralizeSegments(g,x){let C=[],O=x.root;for(;;){if(C=C.concat(O.segments),0===O.numberOfChildren)return(0,Te.of)(C);if(O.numberOfChildren>1||!O.children[_t])return Xn(new Error(`Only absolute redirects can have named outlets. redirectTo: '${g.redirectTo}'`));O=O.children[_t]}}applyRedirectCommands(g,x,C){return this.applyRedirectCreatreUrlTree(x,this.urlSerializer.parse(x),g,C)}applyRedirectCreatreUrlTree(g,x,C,O){const z=this.createSegmentGroup(g,x.root,C,O);return new ve(z,this.createQueryParams(x.queryParams,this.urlTree.queryParams),x.fragment)}createQueryParams(g,x){const C={};return Li(g,(O,z)=>{if("string"==typeof O&&O.startsWith(":")){const ne=O.substring(1);C[z]=x[ne]}else C[z]=O}),C}createSegmentGroup(g,x,C,O){const z=this.createSegments(g,x.segments,C,O);let H={};return Li(x.children,(ne,ue)=>{H[ue]=this.createSegmentGroup(g,ne,C,O)}),new Ce(z,H)}createSegments(g,x,C,O){return x.map(z=>z.path.startsWith(":")?this.findPosParam(g,z,O):this.findOrReturn(z,C))}findPosParam(g,x,C){const O=C[x.path.substring(1)];if(!O)throw new Error(`Cannot redirect to '${g}'. Cannot find '${x.path}'.`);return O}findOrReturn(g,x){let C=0;for(const O of x){if(O.path===g.path)return x.splice(C),O;C++}return g}}function Ii(m){const g={};for(const C of Object.keys(m.children)){const z=Ii(m.children[C]);(z.segments.length>0||z.hasChildren())&&(g[C]=z)}return function $u(m){if(1===m.numberOfChildren&&m.children[_t]){const g=m.children[_t];return new Ce(m.segments.concat(g.segments),g.children)}return m}(new Ce(m.segments,g))}class Hc{constructor(g){this.path=g,this.route=this.path[this.path.length-1]}}class Ms{constructor(g,x){this.component=g,this.route=x}}function Rf(m,g,x){const C=m._root;return Ho(C,g?g._root:null,x,[C.value])}function zo(m,g,x){const C=function oc(m){if(!m)return null;for(let g=m.parent;g;g=g.parent){const x=g.routeConfig;if(x&&x._loadedConfig)return x._loadedConfig}return null}(g);return(C?C.module.injector:x).get(m)}function Ho(m,g,x,C,O={canDeactivateChecks:[],canActivateChecks:[]}){const z=vs(g);return m.children.forEach(H=>{(function rd(m,g,x,C,O={canDeactivateChecks:[],canActivateChecks:[]}){const z=m.value,H=g?g.value:null,ne=x?x.getContext(m.value.outlet):null;if(H&&z.routeConfig===H.routeConfig){const ue=function Ze(m,g,x){if("function"==typeof x)return x(m,g);switch(x){case"pathParamsChange":return!Oi(m.url,g.url);case"pathParamsOrQueryParamsChange":return!Oi(m.url,g.url)||!is(m.queryParams,g.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!ni(m,g)||!is(m.queryParams,g.queryParams);default:return!ni(m,g)}}(H,z,z.routeConfig.runGuardsAndResolvers);ue?O.canActivateChecks.push(new Hc(C)):(z.data=H.data,z._resolvedData=H._resolvedData),Ho(m,g,z.component?ne?ne.children:null:x,C,O),ue&&ne&&ne.outlet&&ne.outlet.isActivated&&O.canDeactivateChecks.push(new Ms(ne.outlet.component,H))}else H&&Tn(g,ne,O),O.canActivateChecks.push(new Hc(C)),Ho(m,null,z.component?ne?ne.children:null:x,C,O)})(H,z[H.value.outlet],x,C.concat([H.value]),O),delete z[H.value.outlet]}),Li(z,(H,ne)=>Tn(H,x.getContext(ne),O)),O}function Tn(m,g,x){const C=vs(m),O=m.value;Li(C,(z,H)=>{Tn(z,O.component?g?g.children.getContext(H):null:g,x)}),x.canDeactivateChecks.push(new Ms(O.component&&g&&g.outlet&&g.outlet.isActivated?g.outlet.component:null,O))}class Go{}function Xa(m){return new kt.y(g=>g.error(m))}class Cr{constructor(g,x,C,O,z,H){this.rootComponentType=g,this.config=x,this.urlTree=C,this.url=O,this.paramsInheritanceStrategy=z,this.relativeLinkResolution=H}recognize(){const g=bt(this.urlTree.root,[],[],this.config.filter(H=>void 0===H.redirectTo),this.relativeLinkResolution).segmentGroup,x=this.processSegmentGroup(this.config,g,_t);if(null===x)return null;const C=new cr([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},_t,this.rootComponentType,null,this.urlTree.root,-1,{}),O=new fn(C,x),z=new pi(this.url,O);return this.inheritParamsAndData(z._root),z}inheritParamsAndData(g){const x=g.value,C=io(x,this.paramsInheritanceStrategy);x.params=Object.freeze(C.params),x.data=Object.freeze(C.data),g.children.forEach(O=>this.inheritParamsAndData(O))}processSegmentGroup(g,x,C){return 0===x.segments.length&&x.hasChildren()?this.processChildren(g,x):this.processSegment(g,x,x.segments,C)}processChildren(g,x){const C=[];for(const z of Object.keys(x.children)){const H=x.children[z],ne=le(g,z),ue=this.processSegmentGroup(ne,H,z);if(null===ue)return null;C.push(...ue)}const O=bs(C);return function xo(m){m.sort((g,x)=>g.value.outlet===_t?-1:x.value.outlet===_t?1:g.value.outlet.localeCompare(x.value.outlet))}(O),O}processSegment(g,x,C,O){for(const z of g){const H=this.processSegmentAgainstRoute(z,x,C,O);if(null!==H)return H}return Qn(x,C,O)?[]:null}processSegmentAgainstRoute(g,x,C,O){if(g.redirectTo||!ii(g,x,C,O))return null;let z,H=[],ne=[];if("**"===g.path){const $t=C.length>0?fi(C).parameters:{};z=new cr(C,$t,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,$c(g),Y(g),g.component,g,bl(x),wl(x)+C.length,ga(g))}else{const $t=tt(x,g,C);if(!$t.matched)return null;H=$t.consumedSegments,ne=$t.remainingSegments,z=new cr(H,$t.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,$c(g),Y(g),g.component,g,bl(x),wl(x)+H.length,ga(g))}const ue=function lc(m){return m.children?m.children:m.loadChildren?m._loadedConfig.routes:[]}(g),{segmentGroup:Ie,slicedSegments:yt}=bt(x,H,ne,ue.filter($t=>void 0===$t.redirectTo),this.relativeLinkResolution);if(0===yt.length&&Ie.hasChildren()){const $t=this.processChildren(ue,Ie);return null===$t?null:[new fn(z,$t)]}if(0===ue.length&&0===yt.length)return[new fn(z,[])];const Et=Y(g)===O,Jt=this.processSegment(ue,Ie,yt,Et?_t:O);return null===Jt?null:[new fn(z,Jt)]}}function ma(m){const g=m.value.routeConfig;return g&&""===g.path&&void 0===g.redirectTo}function bs(m){const g=[],x=new Set;for(const C of m){if(!ma(C)){g.push(C);continue}const O=g.find(z=>C.value.routeConfig===z.value.routeConfig);void 0!==O?(O.children.push(...C.children),x.add(O)):g.push(C)}for(const C of x){const O=bs(C.children);g.push(new fn(C.value,O))}return g.filter(C=>!x.has(C))}function bl(m){let g=m;for(;g._sourceSegment;)g=g._sourceSegment;return g}function wl(m){let g=m,x=g._segmentIndexShift?g._segmentIndexShift:0;for(;g._sourceSegment;)g=g._sourceSegment,x+=g._segmentIndexShift?g._segmentIndexShift:0;return x-1}function $c(m){return m.data||{}}function ga(m){return m.resolve||{}}function Sl(m){return[...Object.keys(m),...Object.getOwnPropertySymbols(m)]}function qa(m){return gn(g=>{const x=m(g);return x?(0,I.D)(x).pipe((0,Dt.U)(()=>g)):(0,Te.of)(g)})}class Yc extends class hc{shouldDetach(g){return!1}store(g,x){}shouldAttach(g){return!1}retrieve(g){return null}shouldReuseRoute(g,x){return g.routeConfig===x.routeConfig}}{}const Mo=new G.OlP("ROUTES");class Zc{constructor(g,x,C,O){this.injector=g,this.compiler=x,this.onLoadStartListener=C,this.onLoadEndListener=O}load(g,x){if(x._loader$)return x._loader$;this.onLoadStartListener&&this.onLoadStartListener(x);const O=this.loadModuleFactory(x.loadChildren).pipe((0,Dt.U)(z=>{this.onLoadEndListener&&this.onLoadEndListener(x);const H=z.create(g);return new ec(vl(H.injector.get(Mo,void 0,G.XFs.Self|G.XFs.Optional)).map(k),H)}),Ae(z=>{throw x._loader$=void 0,z}));return x._loader$=new $n(O,()=>new et.x).pipe(mn()),x._loader$}loadModuleFactory(g){return qn(g()).pipe((0,un.z)(x=>x instanceof G.YKP?(0,Te.of)(x):(0,I.D)(this.compiler.compileModuleAsync(x))))}}class Dr{shouldProcessUrl(g){return!0}extract(g){return g}merge(g,x){return g}}function bo(m){throw m}function zi(m,g,x){return g.parse("/")}function Ya(m,g){return(0,Te.of)(null)}const qu={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},dc={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let zr=(()=>{class m{constructor(x,C,O,z,H,ne,ue){this.rootComponentType=x,this.urlSerializer=C,this.rootContexts=O,this.location=z,this.config=ue,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new et.x,this.errorHandler=bo,this.malformedUriErrorHandler=zi,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:Ya,afterPreactivation:Ya},this.urlHandlingStrategy=new Dr,this.routeReuseStrategy=new Yc,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=H.get(G.h0i),this.console=H.get(G.c2e);const Et=H.get(G.R0b);this.isNgZoneEnabled=Et instanceof G.R0b&&G.R0b.isInAngularZone(),this.resetConfig(ue),this.currentUrlTree=function ti(){return new ve(new Ce([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new Zc(H,ne,Jt=>this.triggerEvent(new No(Jt)),Jt=>this.triggerEvent(new Va(Jt))),this.routerState=to(this.currentUrlTree,this.rootComponentType),this.transitions=new Ge({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var x;return null===(x=this.location.getState())||void 0===x?void 0:x.\u0275routerPageId}setupNavigations(x){const C=this.events;return x.pipe((0,Ee.h)(O=>0!==O.id),(0,Dt.U)(O=>Object.assign(Object.assign({},O),{extractedUrl:this.urlHandlingStrategy.extract(O.rawUrl)})),gn(O=>{let z=!1,H=!1;return(0,Te.of)(O).pipe(lt(ne=>{this.currentNavigation={id:ne.id,initialUrl:ne.currentRawUrl,extractedUrl:ne.extractedUrl,trigger:ne.source,extras:ne.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),gn(ne=>{const ue=this.browserUrlTree.toString(),Ie=!this.navigated||ne.extractedUrl.toString()!==ue||ue!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||Ie)&&this.urlHandlingStrategy.shouldProcessUrl(ne.rawUrl))return wo(ne.source)&&(this.browserUrlTree=ne.extractedUrl),(0,Te.of)(ne).pipe(gn(Et=>{const Jt=this.transitions.getValue();return C.next(new di(Et.id,this.serializeUrl(Et.extractedUrl),Et.source,Et.restoredState)),Jt!==this.transitions.getValue()?qe.E:Promise.resolve(Et)}),function En(m,g,x,C){return gn(O=>function zc(m,g,x,C,O){return new xs(m,g,x,C,O).apply()}(m,g,x,O.extractedUrl,C).pipe((0,Dt.U)(z=>Object.assign(Object.assign({},O),{urlAfterRedirects:z}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),lt(Et=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:Et.urlAfterRedirects})}),function cc(m,g,x,C,O){return(0,un.z)(z=>function Wc(m,g,x,C,O="emptyOnly",z="legacy"){try{const H=new Cr(m,g,x,C,O,z).recognize();return null===H?Xa(new Go):(0,Te.of)(H)}catch(H){return Xa(H)}}(m,g,z.urlAfterRedirects,x(z.urlAfterRedirects),C,O).pipe((0,Dt.U)(H=>Object.assign(Object.assign({},z),{targetSnapshot:H}))))}(this.rootComponentType,this.config,Et=>this.serializeUrl(Et),this.paramsInheritanceStrategy,this.relativeLinkResolution),lt(Et=>{if("eager"===this.urlUpdateStrategy){if(!Et.extras.skipLocationChange){const $t=this.urlHandlingStrategy.merge(Et.urlAfterRedirects,Et.rawUrl);this.setBrowserUrl($t,Et)}this.browserUrlTree=Et.urlAfterRedirects}const Jt=new Hs(Et.id,this.serializeUrl(Et.extractedUrl),this.serializeUrl(Et.urlAfterRedirects),Et.targetSnapshot);C.next(Jt)}));if(Ie&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:Jt,extractedUrl:$t,source:Gn,restoredState:Ti,extras:yr}=ne,Cn=new di(Jt,this.serializeUrl($t),Gn,Ti);C.next(Cn);const Rn=to($t,this.rootComponentType).snapshot;return(0,Te.of)(Object.assign(Object.assign({},ne),{targetSnapshot:Rn,urlAfterRedirects:$t,extras:Object.assign(Object.assign({},yr),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=ne.rawUrl,ne.resolve(null),qe.E}),qa(ne=>{const{targetSnapshot:ue,id:Ie,extractedUrl:yt,rawUrl:Et,extras:{skipLocationChange:Jt,replaceUrl:$t}}=ne;return this.hooks.beforePreactivation(ue,{navigationId:Ie,appliedUrlTree:yt,rawUrlTree:Et,skipLocationChange:!!Jt,replaceUrl:!!$t})}),lt(ne=>{const ue=new Bc(ne.id,this.serializeUrl(ne.extractedUrl),this.serializeUrl(ne.urlAfterRedirects),ne.targetSnapshot);this.triggerEvent(ue)}),(0,Dt.U)(ne=>Object.assign(Object.assign({},ne),{guards:Rf(ne.targetSnapshot,ne.currentSnapshot,this.rootContexts)})),function _o(m,g){return(0,un.z)(x=>{const{targetSnapshot:C,currentSnapshot:O,guards:{canActivateChecks:z,canDeactivateChecks:H}}=x;return 0===H.length&&0===z.length?(0,Te.of)(Object.assign(Object.assign({},x),{guardsResult:!0})):function rr(m,g,x,C){return(0,I.D)(m).pipe((0,un.z)(O=>function If(m,g,x,C,O){const z=g&&g.routeConfig?g.routeConfig.canDeactivate:null;if(!z||0===z.length)return(0,Te.of)(!0);const H=z.map(ne=>{const ue=zo(ne,g,O);let Ie;if(function Ml(m){return m&&ys(m.canDeactivate)}(ue))Ie=qn(ue.canDeactivate(m,g,x,C));else{if(!ys(ue))throw new Error("Invalid CanDeactivate guard");Ie=qn(ue(m,g,x,C))}return Ie.pipe((0,Dn.P)())});return(0,Te.of)(H).pipe(pa())}(O.component,O.route,x,g,C)),(0,Dn.P)(O=>!0!==O,!0))}(H,C,O,m).pipe((0,un.z)(ne=>ne&&function os(m){return"boolean"==typeof m}(ne)?function ac(m,g,x,C){return(0,I.D)(g).pipe((0,ke.b)(O=>dt(function $s(m,g){return null!==m&&g&&g(new Jl(m)),(0,Te.of)(!0)}(O.route.parent,C),function js(m,g){return null!==m&&g&&g(new Fr(m)),(0,Te.of)(!0)}(O.route,C),function Gc(m,g,x){const C=g[g.length-1],z=g.slice(0,g.length-1).reverse().map(H=>function Vo(m){const g=m.routeConfig?m.routeConfig.canActivateChild:null;return g&&0!==g.length?{node:m,guards:g}:null}(H)).filter(H=>null!==H).map(H=>jn(()=>{const ne=H.guards.map(ue=>{const Ie=zo(ue,H.node,x);let yt;if(function nc(m){return m&&ys(m.canActivateChild)}(Ie))yt=qn(Ie.canActivateChild(C,m));else{if(!ys(Ie))throw new Error("Invalid CanActivateChild guard");yt=qn(Ie(C,m))}return yt.pipe((0,Dn.P)())});return(0,Te.of)(ne).pipe(pa())}));return(0,Te.of)(z).pipe(pa())}(m,O.path,x),function qr(m,g,x){const C=g.routeConfig?g.routeConfig.canActivate:null;if(!C||0===C.length)return(0,Te.of)(!0);const O=C.map(z=>jn(()=>{const H=zo(z,g,x);let ne;if(function tc(m){return m&&ys(m.canActivate)}(H))ne=qn(H.canActivate(g,m));else{if(!ys(H))throw new Error("Invalid CanActivate guard");ne=qn(H(g,m))}return ne.pipe((0,Dn.P)())}));return(0,Te.of)(O).pipe(pa())}(m,O.route,x))),(0,Dn.P)(O=>!0!==O,!0))}(C,z,m,g):(0,Te.of)(ne)),(0,Dt.U)(ne=>Object.assign(Object.assign({},x),{guardsResult:ne})))})}(this.ngModule.injector,ne=>this.triggerEvent(ne)),lt(ne=>{if(_s(ne.guardsResult)){const Ie=lr(`Redirecting to "${this.serializeUrl(ne.guardsResult)}"`);throw Ie.url=ne.guardsResult,Ie}const ue=new Zi(ne.id,this.serializeUrl(ne.extractedUrl),this.serializeUrl(ne.urlAfterRedirects),ne.targetSnapshot,!!ne.guardsResult);this.triggerEvent(ue)}),(0,Ee.h)(ne=>!!ne.guardsResult||(this.restoreHistory(ne),this.cancelNavigationTransition(ne,""),!1)),qa(ne=>{if(ne.guards.canActivateChecks.length)return(0,Te.of)(ne).pipe(lt(ue=>{const Ie=new fo(ue.id,this.serializeUrl(ue.extractedUrl),this.serializeUrl(ue.urlAfterRedirects),ue.targetSnapshot);this.triggerEvent(Ie)}),gn(ue=>{let Ie=!1;return(0,Te.of)(ue).pipe(function El(m,g){return(0,un.z)(x=>{const{targetSnapshot:C,guards:{canActivateChecks:O}}=x;if(!O.length)return(0,Te.of)(x);let z=0;return(0,I.D)(O).pipe((0,ke.b)(H=>function Xc(m,g,x,C){return function uc(m,g,x,C){const O=Sl(m);if(0===O.length)return(0,Te.of)({});const z={};return(0,I.D)(O).pipe((0,un.z)(H=>function Al(m,g,x,C){const O=zo(m,g,C);return qn(O.resolve?O.resolve(g,x):O(g,x))}(m[H],g,x,C).pipe(lt(ne=>{z[H]=ne}))),Ue(1),(0,un.z)(()=>Sl(z).length===O.length?(0,Te.of)(z):qe.E))}(m._resolve,m,g,C).pipe((0,Dt.U)(z=>(m._resolvedData=z,m.data=Object.assign(Object.assign({},m.data),io(m,x).resolve),null)))}(H.route,C,m,g)),lt(()=>z++),Ue(1),(0,un.z)(H=>z===O.length?(0,Te.of)(x):qe.E))})}(this.paramsInheritanceStrategy,this.ngModule.injector),lt({next:()=>Ie=!0,complete:()=>{Ie||(this.restoreHistory(ue),this.cancelNavigationTransition(ue,"At least one route resolver didn't emit any value."))}}))}),lt(ue=>{const Ie=new Fo(ue.id,this.serializeUrl(ue.extractedUrl),this.serializeUrl(ue.urlAfterRedirects),ue.targetSnapshot);this.triggerEvent(Ie)}))}),qa(ne=>{const{targetSnapshot:ue,id:Ie,extractedUrl:yt,rawUrl:Et,extras:{skipLocationChange:Jt,replaceUrl:$t}}=ne;return this.hooks.afterPreactivation(ue,{navigationId:Ie,appliedUrlTree:yt,rawUrlTree:Et,skipLocationChange:!!Jt,replaceUrl:!!$t})}),(0,Dt.U)(ne=>{const ue=function Ga(m,g,x){const C=Ls(m,g._root,x?x._root:void 0);return new ss(C,g)}(this.routeReuseStrategy,ne.targetSnapshot,ne.currentRouterState);return Object.assign(Object.assign({},ne),{targetRouterState:ue})}),lt(ne=>{this.currentUrlTree=ne.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(ne.urlAfterRedirects,ne.rawUrl),this.routerState=ne.targetRouterState,"deferred"===this.urlUpdateStrategy&&(ne.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,ne),this.browserUrlTree=ne.urlAfterRedirects)}),((m,g,x)=>(0,Dt.U)(C=>(new xl(g,C.targetRouterState,C.currentRouterState,x).activate(m),C)))(this.rootContexts,this.routeReuseStrategy,ne=>this.triggerEvent(ne)),lt({next(){z=!0},complete(){z=!0}}),function Nt(m){return(0,cn.e)((g,x)=>{try{g.subscribe(x)}finally{x.add(m)}})}(()=>{var ne;z||H||this.cancelNavigationTransition(O,`Navigation ID ${O.id} is not equal to the current navigation id ${this.navigationId}`),(null===(ne=this.currentNavigation)||void 0===ne?void 0:ne.id)===O.id&&(this.currentNavigation=null)}),Ae(ne=>{if(H=!0,function Wi(m){return m&&m[ki]}(ne)){const ue=_s(ne.url);ue||(this.navigated=!0,this.restoreHistory(O,!0));const Ie=new ar(O.id,this.serializeUrl(O.extractedUrl),ne.message);C.next(Ie),ue?setTimeout(()=>{const yt=this.urlHandlingStrategy.merge(ne.url,this.rawUrlTree),Et={skipLocationChange:O.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||wo(O.source)};this.scheduleNavigation(yt,"imperative",null,Et,{resolve:O.resolve,reject:O.reject,promise:O.promise})},0):O.resolve(!1)}else{this.restoreHistory(O,!0);const ue=new fs(O.id,this.serializeUrl(O.extractedUrl),ne);C.next(ue);try{O.resolve(this.errorHandler(ne))}catch(Ie){O.reject(Ie)}}return qe.E}))}))}resetRootComponentType(x){this.rootComponentType=x,this.routerState.root.component=this.rootComponentType}setTransition(x){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),x))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(x=>{const C="popstate"===x.type?"popstate":"hashchange";"popstate"===C&&setTimeout(()=>{var O;const z={replaceUrl:!0},H=(null===(O=x.state)||void 0===O?void 0:O.navigationId)?x.state:null;if(H){const ue=Object.assign({},H);delete ue.navigationId,delete ue.\u0275routerPageId,0!==Object.keys(ue).length&&(z.state=ue)}const ne=this.parseUrl(x.url);this.scheduleNavigation(ne,C,H,z)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(x){this.events.next(x)}resetConfig(x){sc(x),this.config=x.map(k),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(x,C={}){const{relativeTo:O,queryParams:z,fragment:H,queryParamsHandling:ne,preserveFragment:ue}=C,Ie=O||this.routerState.root,yt=ue?this.currentUrlTree.fragment:H;let Et=null;switch(ne){case"merge":Et=Object.assign(Object.assign({},this.currentUrlTree.queryParams),z);break;case"preserve":Et=this.currentUrlTree.queryParams;break;default:Et=z||null}return null!==Et&&(Et=this.removeEmptyProps(Et)),function Br(m,g,x,C,O){if(0===x.length)return Os(g.root,g.root,g.root,C,O);const z=function Vr(m){if("string"==typeof m[0]&&1===m.length&&"/"===m[0])return new hr(!0,0,m);let g=0,x=!1;const C=m.reduce((O,z,H)=>{if("object"==typeof z&&null!=z){if(z.outlets){const ne={};return Li(z.outlets,(ue,Ie)=>{ne[Ie]="string"==typeof ue?ue.split("/"):ue}),[...O,{outlets:ne}]}if(z.segmentPath)return[...O,z.segmentPath]}return"string"!=typeof z?[...O,z]:0===H?(z.split("/").forEach((ne,ue)=>{0==ue&&"."===ne||(0==ue&&""===ne?x=!0:".."===ne?g++:""!=ne&&O.push(ne))}),O):[...O,z]},[]);return new hr(x,g,C)}(x);if(z.toRoot())return Os(g.root,g.root,new Ce([],{}),C,O);const H=function so(m,g,x){if(m.isAbsolute)return new ja(g.root,!0,0);if(-1===x.snapshot._lastPathIndex){const z=x.snapshot._urlSegment;return new ja(z,z===g.root,0)}const C=da(m.commands[0])?0:1;return function go(m,g,x){let C=m,O=g,z=x;for(;z>O;){if(z-=O,C=C.parent,!C)throw new Error("Invalid number of '../'");O=C.segments.length}return new ja(C,!1,O-z)}(x.snapshot._urlSegment,x.snapshot._lastPathIndex+C,m.numberOfDoubleDots)}(z,g,m),ne=H.processChildren?_l(H.segmentGroup,H.index,z.commands):Vc(H.segmentGroup,H.index,z.commands);return Os(g.root,H.segmentGroup,ne,C,O)}(Ie,this.currentUrlTree,x,Et,null!=yt?yt:null)}navigateByUrl(x,C={skipLocationChange:!1}){const O=_s(x)?x:this.parseUrl(x),z=this.urlHandlingStrategy.merge(O,this.rawUrlTree);return this.scheduleNavigation(z,"imperative",null,C)}navigate(x,C={skipLocationChange:!1}){return function Yu(m){for(let g=0;g<m.length;g++){const x=m[g];if(null==x)throw new Error(`The requested path contains ${x} segment at index ${g}`)}}(x),this.navigateByUrl(this.createUrlTree(x,C),C)}serializeUrl(x){return this.urlSerializer.serialize(x)}parseUrl(x){let C;try{C=this.urlSerializer.parse(x)}catch(O){C=this.malformedUriErrorHandler(O,this.urlSerializer,x)}return C}isActive(x,C){let O;if(O=!0===C?Object.assign({},qu):!1===C?Object.assign({},dc):C,_s(x))return Ps(this.currentUrlTree,x,O);const z=this.parseUrl(x);return Ps(this.currentUrlTree,z,O)}removeEmptyProps(x){return Object.keys(x).reduce((C,O)=>{const z=x[O];return null!=z&&(C[O]=z),C},{})}processNavigations(){this.navigations.subscribe(x=>{this.navigated=!0,this.lastSuccessfulId=x.id,this.currentPageId=x.targetPageId,this.events.next(new Or(x.id,this.serializeUrl(x.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,x.resolve(!0)},x=>{this.console.warn(`Unhandled Navigation Error: ${x}`)})}scheduleNavigation(x,C,O,z,H){var ne,ue;if(this.disposed)return Promise.resolve(!1);let Ie,yt,Et;H?(Ie=H.resolve,yt=H.reject,Et=H.promise):Et=new Promise((Gn,Ti)=>{Ie=Gn,yt=Ti});const Jt=++this.navigationId;let $t;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(O=this.location.getState()),$t=O&&O.\u0275routerPageId?O.\u0275routerPageId:z.replaceUrl||z.skipLocationChange?null!==(ne=this.browserPageId)&&void 0!==ne?ne:0:(null!==(ue=this.browserPageId)&&void 0!==ue?ue:0)+1):$t=0,this.setTransition({id:Jt,targetPageId:$t,source:C,restoredState:O,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:x,extras:z,resolve:Ie,reject:yt,promise:Et,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),Et.catch(Gn=>Promise.reject(Gn))}setBrowserUrl(x,C){const O=this.urlSerializer.serialize(x),z=Object.assign(Object.assign({},C.extras.state),this.generateNgRouterState(C.id,C.targetPageId));this.location.isCurrentPathEqualTo(O)||C.extras.replaceUrl?this.location.replaceState(O,"",z):this.location.go(O,"",z)}restoreHistory(x,C=!1){var O,z;if("computed"===this.canceledNavigationResolution){const H=this.currentPageId-x.targetPageId;"popstate"!==x.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(O=this.currentNavigation)||void 0===O?void 0:O.finalUrl)||0===H?this.currentUrlTree===(null===(z=this.currentNavigation)||void 0===z?void 0:z.finalUrl)&&0===H&&(this.resetState(x),this.browserUrlTree=x.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(H)}else"replace"===this.canceledNavigationResolution&&(C&&this.resetState(x),this.resetUrlToCurrentUrlTree())}resetState(x){this.routerState=x.currentRouterState,this.currentUrlTree=x.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,x.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(x,C){const O=new ar(x.id,this.serializeUrl(x.extractedUrl),C);this.triggerEvent(O),x.resolve(!1)}generateNgRouterState(x,C){return"computed"===this.canceledNavigationResolution?{navigationId:x,\u0275routerPageId:C}:{navigationId:x}}}return m.\u0275fac=function(x){G.$Z()},m.\u0275prov=G.Yz7({token:m,factory:m.\u0275fac}),m})();function wo(m){return"imperative"!==m}let Eo=(()=>{class m{constructor(x,C,O){this.router=x,this.route=C,this.locationStrategy=O,this.commands=null,this.href=null,this.onChanges=new et.x,this.subscription=x.events.subscribe(z=>{z instanceof Or&&this.updateTargetUrlAndHref()})}set routerLink(x){this.commands=null!=x?Array.isArray(x)?x:[x]:null}ngOnChanges(x){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(x,C,O,z,H){if(0!==x||C||O||z||H||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)return!0;const ne={skipLocationChange:So(this.skipLocationChange),replaceUrl:So(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,ne),!1}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:So(this.preserveFragment)})}}return m.\u0275fac=function(x){return new(x||m)(G.Y36(zr),G.Y36(ji),G.Y36(Si.S$))},m.\u0275dir=G.lG2({type:m,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(x,C){1&x&&G.NdJ("click",function(z){return C.onClick(z.button,z.ctrlKey,z.shiftKey,z.altKey,z.metaKey)}),2&x&&G.uIk("target",C.target)("href",C.href,G.LSH)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[G.TTD]}),m})();function So(m){return""===m||!!m}class Za{}class Ao{preload(g,x){return(0,Te.of)(null)}}let ya=(()=>{class m{constructor(x,C,O,z){this.router=x,this.injector=O,this.preloadingStrategy=z,this.loader=new Zc(O,C,ue=>x.triggerEvent(new No(ue)),ue=>x.triggerEvent(new Va(ue)))}setUpPreloading(){this.subscription=this.router.events.pipe((0,Ee.h)(x=>x instanceof Or),(0,ke.b)(()=>this.preload())).subscribe(()=>{})}preload(){const x=this.injector.get(G.h0i);return this.processRoutes(x,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(x,C){const O=[];for(const z of C)if(z.loadChildren&&!z.canLoad&&z._loadedConfig){const H=z._loadedConfig;O.push(this.processRoutes(H.module,H.routes))}else z.loadChildren&&!z.canLoad?O.push(this.preloadConfig(x,z)):z.children&&O.push(this.processRoutes(x,z.children));return(0,I.D)(O).pipe((0,Pt.J)(),(0,Dt.U)(z=>{}))}preloadConfig(x,C){return this.preloadingStrategy.preload(C,()=>(C._loadedConfig?(0,Te.of)(C._loadedConfig):this.loader.load(x.injector,C)).pipe((0,un.z)(z=>(C._loadedConfig=z,this.processRoutes(z.module,z.routes)))))}}return m.\u0275fac=function(x){return new(x||m)(G.LFG(zr),G.LFG(G.Sil),G.LFG(G.zs3),G.LFG(Za))},m.\u0275prov=G.Yz7({token:m,factory:m.\u0275fac}),m})(),To=(()=>{class m{constructor(x,C,O={}){this.router=x,this.viewportScroller=C,this.options=O,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},O.scrollPositionRestoration=O.scrollPositionRestoration||"disabled",O.anchorScrolling=O.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(x=>{x instanceof di?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=x.navigationTrigger,this.restoredId=x.restoredState?x.restoredState.navigationId:0):x instanceof Or&&(this.lastId=x.id,this.scheduleScrollEvent(x,this.router.parseUrl(x.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(x=>{x instanceof tn&&(x.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(x.position):x.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(x.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(x,C){this.router.triggerEvent(new tn(x,"popstate"===this.lastSource?this.store[this.restoredId]:null,C))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return m.\u0275fac=function(x){G.$Z()},m.\u0275prov=G.Yz7({token:m,factory:m.\u0275fac}),m})();const Ns=new G.OlP("ROUTER_CONFIGURATION"),Kc=new G.OlP("ROUTER_FORROOT_GUARD"),Ku=[Si.Ye,{provide:ms,useClass:kr},{provide:zr,useFactory:function Wo(m,g,x,C,O,z,H={},ne,ue){const Ie=new zr(null,m,g,x,C,O,vl(z));return ne&&(Ie.urlHandlingStrategy=ne),ue&&(Ie.routeReuseStrategy=ue),function od(m,g){m.errorHandler&&(g.errorHandler=m.errorHandler),m.malformedUriErrorHandler&&(g.malformedUriErrorHandler=m.malformedUriErrorHandler),m.onSameUrlNavigation&&(g.onSameUrlNavigation=m.onSameUrlNavigation),m.paramsInheritanceStrategy&&(g.paramsInheritanceStrategy=m.paramsInheritanceStrategy),m.relativeLinkResolution&&(g.relativeLinkResolution=m.relativeLinkResolution),m.urlUpdateStrategy&&(g.urlUpdateStrategy=m.urlUpdateStrategy),m.canceledNavigationResolution&&(g.canceledNavigationResolution=m.canceledNavigationResolution)}(H,Ie),H.enableTracing&&Ie.events.subscribe(yt=>{var Et,Jt;null===(Et=console.group)||void 0===Et||Et.call(console,`Router Event: ${yt.constructor.name}`),console.log(yt.toString()),console.log(yt),null===(Jt=console.groupEnd)||void 0===Jt||Jt.call(console)}),Ie},deps:[ms,vo,Si.Ye,G.zs3,G.Sil,Mo,Ns,[class Xu{},new G.FiY],[class qc{},new G.FiY]]},vo,{provide:ji,useFactory:function Xs(m){return m.routerState.root},deps:[zr]},ya,Ao,class Yr{preload(g,x){return x().pipe(Ae(()=>(0,Te.of)(null)))}},{provide:Ns,useValue:{enableTracing:!1}}];function sd(){return new G.PXZ("Router",zr)}let Jc=(()=>{class m{constructor(x,C){}static forRoot(x,C){return{ngModule:m,providers:[Ku,Tl(x),{provide:Kc,useFactory:Ju,deps:[[zr,new G.FiY,new G.tp0]]},{provide:Ns,useValue:C||{}},{provide:Si.S$,useFactory:xa,deps:[Si.lw,[new G.tBr(Si.mr),new G.FiY],Ns]},{provide:To,useFactory:pc,deps:[zr,Si.EM,Ns]},{provide:Za,useExisting:C&&C.preloadingStrategy?C.preloadingStrategy:Ao},{provide:G.PXZ,multi:!0,useFactory:sd},[vn,{provide:G.ip1,multi:!0,useFactory:ls,deps:[vn]},{provide:Qc,useFactory:mc,deps:[vn]},{provide:G.tb,multi:!0,useExisting:Qc}]]}}static forChild(x){return{ngModule:m,providers:[Tl(x)]}}}return m.\u0275fac=function(x){return new(x||m)(G.LFG(Kc,8),G.LFG(zr,8))},m.\u0275mod=G.oAB({type:m}),m.\u0275inj=G.cJS({}),m})();function pc(m,g,x){return x.scrollOffset&&g.setOffset(x.scrollOffset),new To(m,g,x)}function xa(m,g,x={}){return x.useHash?new Si.Do(m,g):new Si.b0(m,g)}function Ju(m){return"guarded"}function Tl(m){return[{provide:G.deG,multi:!0,useValue:m},{provide:Mo,multi:!0,useValue:m}]}let vn=(()=>{class m{constructor(x){this.injector=x,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new et.x}appInitializer(){return this.injector.get(Si.V_,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let C=null;const O=new Promise(ne=>C=ne),z=this.injector.get(zr),H=this.injector.get(Ns);return"disabled"===H.initialNavigation?(z.setUpLocationChangeListener(),C(!0)):"enabled"===H.initialNavigation||"enabledBlocking"===H.initialNavigation?(z.hooks.afterPreactivation=()=>this.initNavigation?(0,Te.of)(null):(this.initNavigation=!0,C(!0),this.resultOfPreactivationDone),z.initialNavigation()):C(!0),O})}bootstrapListener(x){const C=this.injector.get(Ns),O=this.injector.get(ya),z=this.injector.get(To),H=this.injector.get(zr),ne=this.injector.get(G.z2F);x===ne.components[0]&&(("enabledNonBlocking"===C.initialNavigation||void 0===C.initialNavigation)&&H.initialNavigation(),O.setUpPreloading(),z.init(),H.resetRootComponentType(ne.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return m.\u0275fac=function(x){return new(x||m)(G.LFG(G.zs3))},m.\u0275prov=G.Yz7({token:m,factory:m.\u0275fac}),m})();function ls(m){return m.appInitializer.bind(m)}function mc(m){return m.bootstrapListener.bind(m)}const Qc=new G.OlP("Router Initializer")},7582:(an,Je,ie)=>{function gt(Ee,Ae,ke,Ue){return new(ke||(ke=Promise))(function(ot,Kt){function Dn(Nt){try{lt(Ue.next(Nt))}catch(Si){Kt(Si)}}function un(Nt){try{lt(Ue.throw(Nt))}catch(Si){Kt(Si)}}function lt(Nt){Nt.done?ot(Nt.value):function Mt(ot){return ot instanceof ke?ot:new ke(function(Kt){Kt(ot)})}(Nt.value).then(Dn,un)}lt((Ue=Ue.apply(Ee,Ae||[])).next())})}function Ot(Ee){return this instanceof Ot?(this.v=Ee,this):new Ot(Ee)}function dt(Ee,Ae,ke){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Mt,Ue=ke.apply(Ee,Ae||[]),ot=[];return Mt={},Kt("next"),Kt("throw"),Kt("return"),Mt[Symbol.asyncIterator]=function(){return this},Mt;function Kt(hi){Ue[hi]&&(Mt[hi]=function(di){return new Promise(function(Or,ar){ot.push([hi,di,Or,ar])>1||Dn(hi,di)})})}function Dn(hi,di){try{!function un(hi){hi.value instanceof Ot?Promise.resolve(hi.value.v).then(lt,Nt):Si(ot[0][2],hi)}(Ue[hi](di))}catch(Or){Si(ot[0][3],Or)}}function lt(hi){Dn("next",hi)}function Nt(hi){Dn("throw",hi)}function Si(hi,di){hi(di),ot.shift(),ot.length&&Dn(ot[0][0],ot[0][1])}}function jn(Ee){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var ke,Ae=Ee[Symbol.asyncIterator];return Ae?Ae.call(Ee):(Ee=function Qe(Ee){var Ae="function"==typeof Symbol&&Symbol.iterator,ke=Ae&&Ee[Ae],Ue=0;if(ke)return ke.call(Ee);if(Ee&&"number"==typeof Ee.length)return{next:function(){return Ee&&Ue>=Ee.length&&(Ee=void 0),{value:Ee&&Ee[Ue++],done:!Ee}}};throw new TypeError(Ae?"Object is not iterable.":"Symbol.iterator is not defined.")}(Ee),ke={},Ue("next"),Ue("throw"),Ue("return"),ke[Symbol.asyncIterator]=function(){return this},ke);function Ue(ot){ke[ot]=Ee[ot]&&function(Kt){return new Promise(function(Dn,un){!function Mt(ot,Kt,Dn,un){Promise.resolve(un).then(function(lt){ot({value:lt,done:Dn})},Kt)}(Dn,un,(Kt=Ee[ot](Kt)).done,Kt.value)})}}}ie.d(Je,{FC:()=>dt,KL:()=>jn,mG:()=>gt,qq:()=>Ot}),"function"==typeof SuppressedError&&SuppressedError}},an=>{an(an.s=8830)}]);