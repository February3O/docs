"use strict";var VS=Object.defineProperty,zS=Object.defineProperties,HS=Object.getOwnPropertyDescriptors,yS=Object.getOwnPropertySymbols,GS=Object.prototype.hasOwnProperty,WS=Object.prototype.propertyIsEnumerable,bb=(zt,Be,Q)=>Be in zt?VS(zt,Be,{enumerable:!0,configurable:!0,writable:!0,value:Q}):zt[Be]=Q,Po=(zt,Be)=>{for(var Q in Be||(Be={}))GS.call(Be,Q)&&bb(zt,Q,Be[Q]);if(yS)for(var Q of yS(Be))WS.call(Be,Q)&&bb(zt,Q,Be[Q]);return zt},Wp=(zt,Be)=>zS(zt,HS(Be)),_S=(zt,Be,Q)=>(bb(zt,"symbol"!=typeof Be?Be+"":Be,Q),Q);(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[179],{9678:(zt,Be,Q)=>{Q.r(Be),Q.d(Be,{ShaderModule:()=>yb});var j=Q(9808),I=Q(1223);let ze={async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,hooks:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1};const xt=/[&<>"']/,Ke=new RegExp(xt.source,"g"),mt=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,Et=new RegExp(mt.source,"g"),je={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},me=a=>je[a];function Je(a,e){if(e){if(xt.test(a))return a.replace(Ke,me)}else if(mt.test(a))return a.replace(Et,me);return a}const _n=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function $e(a){return a.replace(_n,(e,t)=>"colon"===(t=t.toLowerCase())?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):"")}const In=/(^|[^\[])\^/g;function Ve(a,e){a="string"==typeof a?a:a.source,e=e||"";const t={replace:(n,s)=>(s=(s=s.source||s).replace(In,"$1"),a=a.replace(n,s),t),getRegex:()=>new RegExp(a,e)};return t}const Yt=/[^\w:]/g,Cn=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function pn(a,e,t){if(a){let n;try{n=decodeURIComponent($e(t)).replace(Yt,"").toLowerCase()}catch(s){return null}if(0===n.indexOf("javascript:")||0===n.indexOf("vbscript:")||0===n.indexOf("data:"))return null}e&&!Cn.test(t)&&(t=function bn(a,e){gt[" "+a]||(gt[" "+a]=vt.test(a)?a+"/":Gt(a,"/",!0));const t=-1===(a=gt[" "+a]).indexOf(":");return"//"===e.substring(0,2)?t?e:a.replace(Ze,"$1")+e:"/"===e.charAt(0)?t?e:a.replace(Qe,"$1")+e:a+e}(e,t));try{t=encodeURI(t).replace(/%25/g,"%")}catch(n){return null}return t}const gt={},vt=/^[^:]+:\/*[^/]*$/,Ze=/^([^:]+:)[\s\S]*$/,Qe=/^([^:]+:\/*[^/]*)[\s\S]*$/,Ne={exec:function(){}};function yt(a,e){const n=a.replace(/\|/g,(l,u,d)=>{let p=!1,g=u;for(;--g>=0&&"\\"===d[g];)p=!p;return p?"|":" |"}).split(/ \|/);let s=0;if(n[0].trim()||n.shift(),n.length>0&&!n[n.length-1].trim()&&n.pop(),n.length>e)n.splice(e);else for(;n.length<e;)n.push("");for(;s<n.length;s++)n[s]=n[s].trim().replace(/\\\|/g,"|");return n}function Gt(a,e,t){const n=a.length;if(0===n)return"";let s=0;for(;s<n;){const l=a.charAt(n-s-1);if(l!==e||t){if(l===e||!t)break;s++}else s++}return a.slice(0,n-s)}function ft(a,e){if(e<1)return"";let t="";for(;e>1;)1&e&&(t+=a),e>>=1,a+=a;return t+a}function Kt(a,e,t,n){const s=e.href,l=e.title?Je(e.title):null,u=a[1].replace(/\\([\[\]])/g,"$1");if("!"!==a[0].charAt(0)){n.state.inLink=!0;const d={type:"link",raw:t,href:s,title:l,text:u,tokens:n.inlineTokens(u)};return n.state.inLink=!1,d}return{type:"image",raw:t,href:s,title:l,text:Je(u)}}class Qi{constructor(e){this.options=e||ze}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const n=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?n:Gt(n,"\n")}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const n=t[0],s=function Nt(a,e){const t=a.match(/^(\s+)(?:```)/);if(null===t)return e;const n=t[1];return e.split("\n").map(s=>{const l=s.match(/^\s+/);if(null===l)return s;const[u]=l;return u.length>=n.length?s.slice(n.length):s}).join("\n")}(n,t[3]||"");return{type:"code",raw:n,lang:t[2]?t[2].trim().replace(this.rules.inline._escapes,"$1"):t[2],text:s}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let n=t[2].trim();if(/#$/.test(n)){const s=Gt(n,"#");(this.options.pedantic||!s||/ $/.test(s))&&(n=s.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){const n=t[0].replace(/^ *>[ \t]?/gm,""),s=this.lexer.state.top;this.lexer.state.top=!0;const l=this.lexer.blockTokens(n);return this.lexer.state.top=s,{type:"blockquote",raw:t[0],tokens:l,text:n}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n,s,l,u,d,p,g,_,M,w,E,D,F=t[1].trim();const P=F.length>1,R={type:"list",raw:"",ordered:P,start:P?+F.slice(0,-1):"",loose:!1,items:[]};F=P?`\\d{1,9}\\${F.slice(-1)}`:`\\${F}`,this.options.pedantic&&(F=P?F:"[*+-]");const V=new RegExp(`^( {0,3}${F})((?:[\t ][^\\n]*)?(?:\\n|$))`);for(;e&&(D=!1,(t=V.exec(e))&&!this.rules.block.hr.test(e));){if(n=t[0],e=e.substring(n.length),_=t[2].split("\n",1)[0].replace(/^\t+/,W=>" ".repeat(3*W.length)),M=e.split("\n",1)[0],this.options.pedantic?(u=2,E=_.trimLeft()):(u=t[2].search(/[^ ]/),u=u>4?1:u,E=_.slice(u),u+=t[1].length),p=!1,!_&&/^ *$/.test(M)&&(n+=M+"\n",e=e.substring(M.length+1),D=!0),!D){const W=new RegExp(`^ {0,${Math.min(3,u-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ \t][^\\n]*)?(?:\\n|$))`),i=new RegExp(`^ {0,${Math.min(3,u-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),r=new RegExp(`^ {0,${Math.min(3,u-1)}}(?:\`\`\`|~~~)`),o=new RegExp(`^ {0,${Math.min(3,u-1)}}#`);for(;e&&(w=e.split("\n",1)[0],M=w,this.options.pedantic&&(M=M.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!(r.test(M)||o.test(M)||W.test(M)||i.test(e)));){if(M.search(/[^ ]/)>=u||!M.trim())E+="\n"+M.slice(u);else{if(p||_.search(/[^ ]/)>=4||r.test(_)||o.test(_)||i.test(_))break;E+="\n"+M}!p&&!M.trim()&&(p=!0),n+=w+"\n",e=e.substring(w.length+1),_=M.slice(u)}}R.loose||(g?R.loose=!0:/\n *\n *$/.test(n)&&(g=!0)),this.options.gfm&&(s=/^\[[ xX]\] /.exec(E),s&&(l="[ ] "!==s[0],E=E.replace(/^\[[ xX]\] +/,""))),R.items.push({type:"list_item",raw:n,task:!!s,checked:l,loose:!1,text:E}),R.raw+=n}R.items[R.items.length-1].raw=n.trimRight(),R.items[R.items.length-1].text=E.trimRight(),R.raw=R.raw.trimRight();const k=R.items.length;for(d=0;d<k;d++)if(this.lexer.state.top=!1,R.items[d].tokens=this.lexer.blockTokens(R.items[d].text,[]),!R.loose){const W=R.items[d].tokens.filter(r=>"space"===r.type),i=W.length>0&&W.some(r=>/\n.*\n/.test(r.raw));R.loose=i}if(R.loose)for(d=0;d<k;d++)R.items[d].loose=!0;return R}}html(e){const t=this.rules.block.html.exec(e);if(t){const n={type:"html",raw:t[0],pre:!this.options.sanitizer&&("pre"===t[1]||"script"===t[1]||"style"===t[1]),text:t[0]};if(this.options.sanitize){const s=this.options.sanitizer?this.options.sanitizer(t[0]):Je(t[0]);n.type="paragraph",n.text=s,n.tokens=this.lexer.inline(s)}return n}}def(e){const t=this.rules.block.def.exec(e);if(t){const n=t[1].toLowerCase().replace(/\s+/g," "),s=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline._escapes,"$1"):"",l=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline._escapes,"$1"):t[3];return{type:"def",tag:n,raw:t[0],href:s,title:l}}}table(e){const t=this.rules.block.table.exec(e);if(t){const n={type:"table",header:yt(t[1]).map(s=>({text:s})),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split("\n"):[]};if(n.header.length===n.align.length){n.raw=t[0];let l,u,d,p,s=n.align.length;for(l=0;l<s;l++)n.align[l]=/^ *-+: *$/.test(n.align[l])?"right":/^ *:-+: *$/.test(n.align[l])?"center":/^ *:-+ *$/.test(n.align[l])?"left":null;for(s=n.rows.length,l=0;l<s;l++)n.rows[l]=yt(n.rows[l],n.header.length).map(g=>({text:g}));for(s=n.header.length,u=0;u<s;u++)n.header[u].tokens=this.lexer.inline(n.header[u].text);for(s=n.rows.length,u=0;u<s;u++)for(p=n.rows[u],d=0;d<p.length;d++)p[d].tokens=this.lexer.inline(p[d].text);return n}}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:"="===t[2].charAt(0)?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const n="\n"===t[1].charAt(t[1].length-1)?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:n,tokens:this.lexer.inline(n)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:Je(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(t[0]):Je(t[0]):t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const n=t[2].trim();if(!this.options.pedantic&&/^</.test(n)){if(!/>$/.test(n))return;const u=Gt(n.slice(0,-1),"\\");if((n.length-u.length)%2==0)return}else{const u=function Zt(a,e){if(-1===a.indexOf(e[1]))return-1;const t=a.length;let n=0,s=0;for(;s<t;s++)if("\\"===a[s])s++;else if(a[s]===e[0])n++;else if(a[s]===e[1]&&(n--,n<0))return s;return-1}(t[2],"()");if(u>-1){const p=(0===t[0].indexOf("!")?5:4)+t[1].length+u;t[2]=t[2].substring(0,u),t[0]=t[0].substring(0,p).trim(),t[3]=""}}let s=t[2],l="";if(this.options.pedantic){const u=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(s);u&&(s=u[1],l=u[3])}else l=t[3]?t[3].slice(1,-1):"";return s=s.trim(),/^</.test(s)&&(s=this.options.pedantic&&!/>$/.test(n)?s.slice(1):s.slice(1,-1)),Kt(t,{href:s&&s.replace(this.rules.inline._escapes,"$1"),title:l&&l.replace(this.rules.inline._escapes,"$1")},t[0],this.lexer)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){let s=(n[2]||n[1]).replace(/\s+/g," ");if(s=t[s.toLowerCase()],!s){const l=n[0].charAt(0);return{type:"text",raw:l,text:l}}return Kt(n,s,n[0],this.lexer)}}emStrong(e,t,n=""){let s=this.rules.inline.emStrong.lDelim.exec(e);if(!s||s[3]&&n.match(/[\p{L}\p{N}]/u))return;const l=s[1]||s[2]||"";if(!l||l&&(""===n||this.rules.inline.punctuation.exec(n))){const u=s[0].length-1;let d,p,g=u,_=0;const M="*"===s[0][0]?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(M.lastIndex=0,t=t.slice(-1*e.length+u);null!=(s=M.exec(t));){if(d=s[1]||s[2]||s[3]||s[4]||s[5]||s[6],!d)continue;if(p=d.length,s[3]||s[4]){g+=p;continue}if((s[5]||s[6])&&u%3&&!((u+p)%3)){_+=p;continue}if(g-=p,g>0)continue;p=Math.min(p,p+g+_);const w=e.slice(0,u+s.index+(s[0].length-d.length)+p);if(Math.min(u,p)%2){const D=w.slice(1,-1);return{type:"em",raw:w,text:D,tokens:this.lexer.inlineTokens(D)}}const E=w.slice(2,-2);return{type:"strong",raw:w,text:E,tokens:this.lexer.inlineTokens(E)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let n=t[2].replace(/\n/g," ");const s=/[^ ]/.test(n),l=/^ /.test(n)&&/ $/.test(n);return s&&l&&(n=n.substring(1,n.length-1)),n=Je(n,!0),{type:"codespan",raw:t[0],text:n}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e,t){const n=this.rules.inline.autolink.exec(e);if(n){let s,l;return"@"===n[2]?(s=Je(this.options.mangle?t(n[1]):n[1]),l="mailto:"+s):(s=Je(n[1]),l=s),{type:"link",raw:n[0],text:s,href:l,tokens:[{type:"text",raw:s,text:s}]}}}url(e,t){let n;if(n=this.rules.inline.url.exec(e)){let s,l;if("@"===n[2])s=Je(this.options.mangle?t(n[0]):n[0]),l="mailto:"+s;else{let u;do{u=n[0],n[0]=this.rules.inline._backpedal.exec(n[0])[0]}while(u!==n[0]);s=Je(n[0]),l="www."===n[1]?"http://"+n[0]:n[0]}return{type:"link",raw:n[0],text:s,href:l,tokens:[{type:"text",raw:s,text:s}]}}}inlineText(e,t){const n=this.rules.inline.text.exec(e);if(n){let s;return s=this.lexer.state.inRawBlock?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(n[0]):Je(n[0]):n[0]:Je(this.options.smartypants?t(n[0]):n[0]),{type:"text",raw:n[0],text:s}}}}const Ut={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:Ne,lheading:/^((?:.|\n(?!\n))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/,_label:/(?!\s*\])(?:\\.|[^\[\]\\])+/,_title:/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/};Ut.def=Ve(Ut.def).replace("label",Ut._label).replace("title",Ut._title).getRegex(),Ut.bullet=/(?:[*+-]|\d{1,9}[.)])/,Ut.listItemStart=Ve(/^( *)(bull) */).replace("bull",Ut.bullet).getRegex(),Ut.list=Ve(Ut.list).replace(/bull/g,Ut.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+Ut.def.source+")").getRegex(),Ut._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Ut._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,Ut.html=Ve(Ut.html,"i").replace("comment",Ut._comment).replace("tag",Ut._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Ut.paragraph=Ve(Ut._paragraph).replace("hr",Ut.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ut._tag).getRegex(),Ut.blockquote=Ve(Ut.blockquote).replace("paragraph",Ut.paragraph).getRegex(),Ut.normal=Po({},Ut),Ut.gfm=Wp(Po({},Ut.normal),{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),Ut.gfm.table=Ve(Ut.gfm.table).replace("hr",Ut.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ut._tag).getRegex(),Ut.gfm.paragraph=Ve(Ut._paragraph).replace("hr",Ut.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",Ut.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ut._tag).getRegex(),Ut.pedantic=Wp(Po({},Ut.normal),{html:Ve("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",Ut._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Ne,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Ve(Ut.normal._paragraph).replace("hr",Ut.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",Ut.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});const ht={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:Ne,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^(?:[^_*\\]|\\.)*?\_\_(?:[^_*\\]|\\.)*?\*(?:[^_*\\]|\\.)*?(?=\_\_)|(?:[^*\\]|\\.)+(?=[^*])|[punct_](\*+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|(?:[^punct*_\s\\]|\\.)(\*+)(?=[^punct*_\s])/,rDelimUnd:/^(?:[^_*\\]|\\.)*?\*\*(?:[^_*\\]|\\.)*?\_(?:[^_*\\]|\\.)*?(?=\*\*)|(?:[^_\\]|\\.)+(?=[^_])|[punct*](\_+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:Ne,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};function ye(a){return a.replace(/---/g,"\u2014").replace(/--/g,"\u2013").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1\u2018").replace(/'/g,"\u2019").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1\u201c").replace(/"/g,"\u201d").replace(/\.{3}/g,"\u2026")}function xe(a){let t,n,e="";const s=a.length;for(t=0;t<s;t++)n=a.charCodeAt(t),Math.random()>.5&&(n="x"+n.toString(16)),e+="&#"+n+";";return e}ht._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~",ht.punctuation=Ve(ht.punctuation).replace(/punctuation/g,ht._punctuation).getRegex(),ht.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,ht.escapedEmSt=/(?:^|[^\\])(?:\\\\)*\\[*_]/g,ht._comment=Ve(Ut._comment).replace("(?:--\x3e|$)","--\x3e").getRegex(),ht.emStrong.lDelim=Ve(ht.emStrong.lDelim).replace(/punct/g,ht._punctuation).getRegex(),ht.emStrong.rDelimAst=Ve(ht.emStrong.rDelimAst,"g").replace(/punct/g,ht._punctuation).getRegex(),ht.emStrong.rDelimUnd=Ve(ht.emStrong.rDelimUnd,"g").replace(/punct/g,ht._punctuation).getRegex(),ht._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,ht._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,ht._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,ht.autolink=Ve(ht.autolink).replace("scheme",ht._scheme).replace("email",ht._email).getRegex(),ht._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,ht.tag=Ve(ht.tag).replace("comment",ht._comment).replace("attribute",ht._attribute).getRegex(),ht._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,ht._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,ht._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,ht.link=Ve(ht.link).replace("label",ht._label).replace("href",ht._href).replace("title",ht._title).getRegex(),ht.reflink=Ve(ht.reflink).replace("label",ht._label).replace("ref",Ut._label).getRegex(),ht.nolink=Ve(ht.nolink).replace("ref",Ut._label).getRegex(),ht.reflinkSearch=Ve(ht.reflinkSearch,"g").replace("reflink",ht.reflink).replace("nolink",ht.nolink).getRegex(),ht.normal=Po({},ht),ht.pedantic=Wp(Po({},ht.normal),{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:Ve(/^!?\[(label)\]\((.*?)\)/).replace("label",ht._label).getRegex(),reflink:Ve(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",ht._label).getRegex()}),ht.gfm=Wp(Po({},ht.normal),{escape:Ve(ht.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),ht.gfm.url=Ve(ht.gfm.url,"i").replace("email",ht.gfm._extended_email).getRegex(),ht.breaks=Wp(Po({},ht.gfm),{br:Ve(ht.br).replace("{2,}","*").getRegex(),text:Ve(ht.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});class De{constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||ze,this.options.tokenizer=this.options.tokenizer||new Qi,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:Ut.normal,inline:ht.normal};this.options.pedantic?(t.block=Ut.pedantic,t.inline=ht.pedantic):this.options.gfm&&(t.block=Ut.gfm,t.inline=this.options.breaks?ht.breaks:ht.gfm),this.tokenizer.rules=t}static get rules(){return{block:Ut,inline:ht}}static lex(e,t){return new De(t).lex(e)}static lexInline(e,t){return new De(t).inlineTokens(e)}lex(e){let t;for(e=e.replace(/\r\n|\r/g,"\n"),this.blockTokens(e,this.tokens);t=this.inlineQueue.shift();)this.inlineTokens(t.src,t.tokens);return this.tokens}blockTokens(e,t=[]){let n,s,l,u;for(e=this.options.pedantic?e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e.replace(/^( *)(\t+)/gm,(d,p,g)=>p+"    ".repeat(g.length));e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(d=>!!(n=d.call({lexer:this},e,t))&&(e=e.substring(n.raw.length),t.push(n),!0)))){if(n=this.tokenizer.space(e)){e=e.substring(n.raw.length),1===n.raw.length&&t.length>0?t[t.length-1].raw+="\n":t.push(n);continue}if(n=this.tokenizer.code(e)){e=e.substring(n.raw.length),s=t[t.length-1],!s||"paragraph"!==s.type&&"text"!==s.type?t.push(n):(s.raw+="\n"+n.raw,s.text+="\n"+n.text,this.inlineQueue[this.inlineQueue.length-1].src=s.text);continue}if(n=this.tokenizer.fences(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.heading(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.hr(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.blockquote(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.list(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.html(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.def(e)){e=e.substring(n.raw.length),s=t[t.length-1],!s||"paragraph"!==s.type&&"text"!==s.type?this.tokens.links[n.tag]||(this.tokens.links[n.tag]={href:n.href,title:n.title}):(s.raw+="\n"+n.raw,s.text+="\n"+n.raw,this.inlineQueue[this.inlineQueue.length-1].src=s.text);continue}if(n=this.tokenizer.table(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.lheading(e)){e=e.substring(n.raw.length),t.push(n);continue}if(l=e,this.options.extensions&&this.options.extensions.startBlock){let d=1/0;const p=e.slice(1);let g;this.options.extensions.startBlock.forEach(function(_){g=_.call({lexer:this},p),"number"==typeof g&&g>=0&&(d=Math.min(d,g))}),d<1/0&&d>=0&&(l=e.substring(0,d+1))}if(this.state.top&&(n=this.tokenizer.paragraph(l))){s=t[t.length-1],u&&"paragraph"===s.type?(s.raw+="\n"+n.raw,s.text+="\n"+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=s.text):t.push(n),u=l.length!==e.length,e=e.substring(n.raw.length);continue}if(n=this.tokenizer.text(e)){e=e.substring(n.raw.length),s=t[t.length-1],s&&"text"===s.type?(s.raw+="\n"+n.raw,s.text+="\n"+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=s.text):t.push(n);continue}if(e){const d="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(d);break}throw new Error(d)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let n,s,l,d,p,g,u=e;if(this.tokens.links){const _=Object.keys(this.tokens.links);if(_.length>0)for(;null!=(d=this.tokenizer.rules.inline.reflinkSearch.exec(u));)_.includes(d[0].slice(d[0].lastIndexOf("[")+1,-1))&&(u=u.slice(0,d.index)+"["+ft("a",d[0].length-2)+"]"+u.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(d=this.tokenizer.rules.inline.blockSkip.exec(u));)u=u.slice(0,d.index)+"["+ft("a",d[0].length-2)+"]"+u.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(d=this.tokenizer.rules.inline.escapedEmSt.exec(u));)u=u.slice(0,d.index+d[0].length-2)+"++"+u.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex),this.tokenizer.rules.inline.escapedEmSt.lastIndex--;for(;e;)if(p||(g=""),p=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(_=>!!(n=_.call({lexer:this},e,t))&&(e=e.substring(n.raw.length),t.push(n),!0)))){if(n=this.tokenizer.escape(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.tag(e)){e=e.substring(n.raw.length),s=t[t.length-1],s&&"text"===n.type&&"text"===s.type?(s.raw+=n.raw,s.text+=n.text):t.push(n);continue}if(n=this.tokenizer.link(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(n.raw.length),s=t[t.length-1],s&&"text"===n.type&&"text"===s.type?(s.raw+=n.raw,s.text+=n.text):t.push(n);continue}if(n=this.tokenizer.emStrong(e,u,g)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.codespan(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.br(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.del(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.autolink(e,xe)){e=e.substring(n.raw.length),t.push(n);continue}if(!this.state.inLink&&(n=this.tokenizer.url(e,xe))){e=e.substring(n.raw.length),t.push(n);continue}if(l=e,this.options.extensions&&this.options.extensions.startInline){let _=1/0;const M=e.slice(1);let w;this.options.extensions.startInline.forEach(function(E){w=E.call({lexer:this},M),"number"==typeof w&&w>=0&&(_=Math.min(_,w))}),_<1/0&&_>=0&&(l=e.substring(0,_+1))}if(n=this.tokenizer.inlineText(l,ye)){e=e.substring(n.raw.length),"_"!==n.raw.slice(-1)&&(g=n.raw.slice(-1)),p=!0,s=t[t.length-1],s&&"text"===s.type?(s.raw+=n.raw,s.text+=n.text):t.push(n);continue}if(e){const _="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(_);break}throw new Error(_)}}return t}}class Re{constructor(e){this.options=e||ze}code(e,t,n){const s=(t||"").match(/\S*/)[0];if(this.options.highlight){const l=this.options.highlight(e,s);null!=l&&l!==e&&(n=!0,e=l)}return e=e.replace(/\n$/,"")+"\n",s?'<pre><code class="'+this.options.langPrefix+Je(s)+'">'+(n?e:Je(e,!0))+"</code></pre>\n":"<pre><code>"+(n?e:Je(e,!0))+"</code></pre>\n"}blockquote(e){return`<blockquote>\n${e}</blockquote>\n`}html(e){return e}heading(e,t,n,s){return this.options.headerIds?`<h${t} id="${this.options.headerPrefix+s.slug(n)}">${e}</h${t}>\n`:`<h${t}>${e}</h${t}>\n`}hr(){return this.options.xhtml?"<hr/>\n":"<hr>\n"}list(e,t,n){const s=t?"ol":"ul";return"<"+s+(t&&1!==n?' start="'+n+'"':"")+">\n"+e+"</"+s+">\n"}listitem(e){return`<li>${e}</li>\n`}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(e){return`<p>${e}</p>\n`}table(e,t){return t&&(t=`<tbody>${t}</tbody>`),"<table>\n<thead>\n"+e+"</thead>\n"+t+"</table>\n"}tablerow(e){return`<tr>\n${e}</tr>\n`}tablecell(e,t){const n=t.header?"th":"td";return(t.align?`<${n} align="${t.align}">`:`<${n}>`)+e+`</${n}>\n`}strong(e){return`<strong>${e}</strong>`}em(e){return`<em>${e}</em>`}codespan(e){return`<code>${e}</code>`}br(){return this.options.xhtml?"<br/>":"<br>"}del(e){return`<del>${e}</del>`}link(e,t,n){if(null===(e=pn(this.options.sanitize,this.options.baseUrl,e)))return n;let s='<a href="'+e+'"';return t&&(s+=' title="'+t+'"'),s+=">"+n+"</a>",s}image(e,t,n){if(null===(e=pn(this.options.sanitize,this.options.baseUrl,e)))return n;let s=`<img src="${e}" alt="${n}"`;return t&&(s+=` title="${t}"`),s+=this.options.xhtml?"/>":">",s}text(e){return e}}class rt{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,t,n){return""+n}image(e,t,n){return""+n}br(){return""}}class Xe{constructor(){this.seen={}}serialize(e){return e.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(e,t){let n=e,s=0;if(this.seen.hasOwnProperty(n)){s=this.seen[e];do{s++,n=e+"-"+s}while(this.seen.hasOwnProperty(n))}return t||(this.seen[e]=s,this.seen[n]=0),n}slug(e,t={}){const n=this.serialize(e);return this.getNextSafeSlug(n,t.dryrun)}}class Lt{constructor(e){this.options=e||ze,this.options.renderer=this.options.renderer||new Re,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new rt,this.slugger=new Xe}static parse(e,t){return new Lt(t).parse(e)}static parseInline(e,t){return new Lt(t).parseInline(e)}parse(e,t=!0){let s,l,u,d,p,g,_,M,w,E,D,F,P,R,V,k,W,i,r,n="";const o=e.length;for(s=0;s<o;s++)if(E=e[s],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[E.type]&&(r=this.options.extensions.renderers[E.type].call({parser:this},E),!1!==r||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(E.type)))n+=r||"";else switch(E.type){case"space":continue;case"hr":n+=this.renderer.hr();continue;case"heading":n+=this.renderer.heading(this.parseInline(E.tokens),E.depth,$e(this.parseInline(E.tokens,this.textRenderer)),this.slugger);continue;case"code":n+=this.renderer.code(E.text,E.lang,E.escaped);continue;case"table":for(M="",_="",d=E.header.length,l=0;l<d;l++)_+=this.renderer.tablecell(this.parseInline(E.header[l].tokens),{header:!0,align:E.align[l]});for(M+=this.renderer.tablerow(_),w="",d=E.rows.length,l=0;l<d;l++){for(g=E.rows[l],_="",p=g.length,u=0;u<p;u++)_+=this.renderer.tablecell(this.parseInline(g[u].tokens),{header:!1,align:E.align[u]});w+=this.renderer.tablerow(_)}n+=this.renderer.table(M,w);continue;case"blockquote":w=this.parse(E.tokens),n+=this.renderer.blockquote(w);continue;case"list":for(D=E.ordered,F=E.start,P=E.loose,d=E.items.length,w="",l=0;l<d;l++)V=E.items[l],k=V.checked,W=V.task,R="",V.task&&(i=this.renderer.checkbox(k),P?V.tokens.length>0&&"paragraph"===V.tokens[0].type?(V.tokens[0].text=i+" "+V.tokens[0].text,V.tokens[0].tokens&&V.tokens[0].tokens.length>0&&"text"===V.tokens[0].tokens[0].type&&(V.tokens[0].tokens[0].text=i+" "+V.tokens[0].tokens[0].text)):V.tokens.unshift({type:"text",text:i}):R+=i),R+=this.parse(V.tokens,P),w+=this.renderer.listitem(R,W,k);n+=this.renderer.list(w,D,F);continue;case"html":n+=this.renderer.html(E.text);continue;case"paragraph":n+=this.renderer.paragraph(this.parseInline(E.tokens));continue;case"text":for(w=E.tokens?this.parseInline(E.tokens):E.text;s+1<o&&"text"===e[s+1].type;)E=e[++s],w+="\n"+(E.tokens?this.parseInline(E.tokens):E.text);n+=t?this.renderer.paragraph(w):w;continue;default:{const c='Token with "'+E.type+'" type was not found.';if(this.options.silent)return void console.error(c);throw new Error(c)}}return n}parseInline(e,t){t=t||this.renderer;let s,l,u,n="";const d=e.length;for(s=0;s<d;s++)if(l=e[s],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[l.type]&&(u=this.options.extensions.renderers[l.type].call({parser:this},l),!1!==u||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(l.type)))n+=u||"";else switch(l.type){case"escape":case"text":n+=t.text(l.text);break;case"html":n+=t.html(l.text);break;case"link":n+=t.link(l.href,l.title,this.parseInline(l.tokens,t));break;case"image":n+=t.image(l.href,l.title,l.text);break;case"strong":n+=t.strong(this.parseInline(l.tokens,t));break;case"em":n+=t.em(this.parseInline(l.tokens,t));break;case"codespan":n+=t.codespan(l.text);break;case"br":n+=t.br();break;case"del":n+=t.del(this.parseInline(l.tokens,t));break;default:{const p='Token with "'+l.type+'" type was not found.';if(this.options.silent)return void console.error(p);throw new Error(p)}}return n}}class cn{constructor(e){this.options=e||ze}preprocess(e){return e}postprocess(e){return e}}function qe(a,e){return(t,n,s)=>{"function"==typeof n&&(s=n,n=null);const l=Po({},n),u=function Wt(a,e,t){return n=>{if(n.message+="\nPlease report this to https://github.com/markedjs/marked.",a){const s="<p>An error occurred:</p><pre>"+Je(n.message+"",!0)+"</pre>";return e?Promise.resolve(s):t?void t(null,s):s}if(e)return Promise.reject(n);if(!t)throw n;t(n)}}((n=Po(Po({},_t.defaults),l)).silent,n.async,s);if(null==t)return u(new Error("marked(): input parameter is undefined or null"));if("string"!=typeof t)return u(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));if(function En(a){a&&a.sanitize&&!a.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}(n),n.hooks&&(n.hooks.options=n),s){const d=n.highlight;let p;try{n.hooks&&(t=n.hooks.preprocess(t)),p=a(t,n)}catch(M){return u(M)}const g=function(M){let w;if(!M)try{n.walkTokens&&_t.walkTokens(p,n.walkTokens),w=e(p,n),n.hooks&&(w=n.hooks.postprocess(w))}catch(E){M=E}return n.highlight=d,M?u(M):s(null,w)};if(!d||d.length<3||(delete n.highlight,!p.length))return g();let _=0;return _t.walkTokens(p,function(M){"code"===M.type&&(_++,setTimeout(()=>{d(M.text,M.lang,function(w,E){if(w)return g(w);null!=E&&E!==M.text&&(M.text=E,M.escaped=!0),_--,0===_&&g()})},0))}),void(0===_&&g())}if(n.async)return Promise.resolve(n.hooks?n.hooks.preprocess(t):t).then(d=>a(d,n)).then(d=>n.walkTokens?Promise.all(_t.walkTokens(d,n.walkTokens)).then(()=>d):d).then(d=>e(d,n)).then(d=>n.hooks?n.hooks.postprocess(d):d).catch(u);try{n.hooks&&(t=n.hooks.preprocess(t));const d=a(t,n);n.walkTokens&&_t.walkTokens(d,n.walkTokens);let p=e(d,n);return n.hooks&&(p=n.hooks.postprocess(p)),p}catch(d){return u(d)}}}function _t(a,e,t){return qe(De.lex,Lt.parse)(a,e,t)}_S(cn,"passThroughHooks",new Set(["preprocess","postprocess"])),_t.options=_t.setOptions=function(a){return function Ie(a){ze=a}(_t.defaults=Po(Po({},_t.defaults),a)),_t},_t.getDefaults=function Me(){return{async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,hooks:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}},_t.defaults=ze,_t.use=function(...a){const e=_t.defaults.extensions||{renderers:{},childTokens:{}};a.forEach(t=>{const n=Po({},t);if(n.async=_t.defaults.async||n.async||!1,t.extensions&&(t.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if(s.renderer){const l=e.renderers[s.name];e.renderers[s.name]=l?function(...u){let d=s.renderer.apply(this,u);return!1===d&&(d=l.apply(this,u)),d}:s.renderer}if(s.tokenizer){if(!s.level||"block"!==s.level&&"inline"!==s.level)throw new Error("extension level must be 'block' or 'inline'");e[s.level]?e[s.level].unshift(s.tokenizer):e[s.level]=[s.tokenizer],s.start&&("block"===s.level?e.startBlock?e.startBlock.push(s.start):e.startBlock=[s.start]:"inline"===s.level&&(e.startInline?e.startInline.push(s.start):e.startInline=[s.start]))}s.childTokens&&(e.childTokens[s.name]=s.childTokens)}),n.extensions=e),t.renderer){const s=_t.defaults.renderer||new Re;for(const l in t.renderer){const u=s[l];s[l]=(...d)=>{let p=t.renderer[l].apply(s,d);return!1===p&&(p=u.apply(s,d)),p}}n.renderer=s}if(t.tokenizer){const s=_t.defaults.tokenizer||new Qi;for(const l in t.tokenizer){const u=s[l];s[l]=(...d)=>{let p=t.tokenizer[l].apply(s,d);return!1===p&&(p=u.apply(s,d)),p}}n.tokenizer=s}if(t.hooks){const s=_t.defaults.hooks||new cn;for(const l in t.hooks){const u=s[l];s[l]=cn.passThroughHooks.has(l)?d=>{if(_t.defaults.async)return Promise.resolve(t.hooks[l].call(s,d)).then(g=>u.call(s,g));const p=t.hooks[l].call(s,d);return u.call(s,p)}:(...d)=>{let p=t.hooks[l].apply(s,d);return!1===p&&(p=u.apply(s,d)),p}}n.hooks=s}if(t.walkTokens){const s=_t.defaults.walkTokens;n.walkTokens=function(l){let u=[];return u.push(t.walkTokens.call(this,l)),s&&(u=u.concat(s.call(this,l))),u}}_t.setOptions(n)})},_t.walkTokens=function(a,e){let t=[];for(const n of a)switch(t=t.concat(e.call(_t,n)),n.type){case"table":for(const s of n.header)t=t.concat(_t.walkTokens(s.tokens,e));for(const s of n.rows)for(const l of s)t=t.concat(_t.walkTokens(l.tokens,e));break;case"list":t=t.concat(_t.walkTokens(n.items,e));break;default:_t.defaults.extensions&&_t.defaults.extensions.childTokens&&_t.defaults.extensions.childTokens[n.type]?_t.defaults.extensions.childTokens[n.type].forEach(function(s){t=t.concat(_t.walkTokens(n[s],e))}):n.tokens&&(t=t.concat(_t.walkTokens(n.tokens,e)))}return t},_t.parseInline=qe(De.lexInline,Lt.parseInline),_t.Parser=Lt,_t.parser=Lt.parse,_t.Renderer=Re,_t.TextRenderer=rt,_t.Lexer=De,_t.lexer=De.lex,_t.Tokenizer=Qi,_t.Slugger=Xe,_t.Hooks=cn,_t.parse=_t;var Ci=Q(4004),oo=(Q(590),Q(9646)),ao=Q(8306),ha=Q(4351),yl=Q(9300);class jt{}class cr{}class Bn{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(t=>{const n=t.indexOf(":");if(n>0){const s=t.slice(0,n),l=s.toLowerCase(),u=t.slice(n+1).trim();this.maybeSetNormalizedName(s,l),this.headers.has(l)?this.headers.get(l).push(u):this.headers.set(l,[u])}})}:()=>{this.headers=new Map,Object.keys(e).forEach(t=>{let n=e[t];const s=t.toLowerCase();"string"==typeof n&&(n=[n]),n.length>0&&(this.headers.set(s,n),this.maybeSetNormalizedName(t,s))})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof Bn?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new Bn;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof Bn?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);const s=("a"===e.op?this.headers.get(t):void 0)||[];s.push(...n),this.headers.set(t,s);break;case"d":const l=e.value;if(l){let u=this.headers.get(t);if(!u)return;u=u.filter(d=>-1===l.indexOf(d)),0===u.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,u)}else this.headers.delete(t),this.normalizedNames.delete(t)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class kt{encodeKey(e){return pi(e)}encodeValue(e){return pi(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const da=/%(\d[a-f0-9])/gi,Di={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function pi(a){return encodeURIComponent(a).replace(da,(e,t)=>{var n;return null!==(n=Di[t])&&void 0!==n?n:e})}function Ni(a){return`${a}`}class Mi{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new kt,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function nt(a,e){const t=new Map;return a.length>0&&a.replace(/^\?/,"").split("&").forEach(s=>{const l=s.indexOf("="),[u,d]=-1==l?[e.decodeKey(s),""]:[e.decodeKey(s.slice(0,l)),e.decodeValue(s.slice(l+1))],p=t.get(u)||[];p.push(d),t.set(u,p)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const n=e.fromObject[t];this.map.set(t,Array.isArray(n)?n:[n])})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(n=>{const s=e[n];Array.isArray(s)?s.forEach(l=>{t.push({param:n,value:l,op:"a"})}):t.push({param:n,value:s,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(n=>t+"="+this.encoder.encodeValue(n)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new Mi({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(Ni(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let n=this.map.get(e.param)||[];const s=n.indexOf(Ni(e.value));-1!==s&&n.splice(s,1),n.length>0?this.map.set(e.param,n):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class on{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function Vn(a){return"undefined"!=typeof ArrayBuffer&&a instanceof ArrayBuffer}function ka(a){return"undefined"!=typeof Blob&&a instanceof Blob}function jn(a){return"undefined"!=typeof FormData&&a instanceof FormData}class ci{constructor(e,t,n,s){let l;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function Ir(a){switch(a){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||s?(this.body=void 0!==n?n:null,l=s):l=n,l&&(this.reportProgress=!!l.reportProgress,this.withCredentials=!!l.withCredentials,l.responseType&&(this.responseType=l.responseType),l.headers&&(this.headers=l.headers),l.context&&(this.context=l.context),l.params&&(this.params=l.params)),this.headers||(this.headers=new Bn),this.context||(this.context=new on),this.params){const u=this.params.toString();if(0===u.length)this.urlWithParams=t;else{const d=t.indexOf("?");this.urlWithParams=t+(-1===d?"?":d<t.length-1?"&":"")+u}}else this.params=new Mi,this.urlWithParams=t}serializeBody(){return null===this.body?null:Vn(this.body)||ka(this.body)||jn(this.body)||function cu(a){return"undefined"!=typeof URLSearchParams&&a instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Mi?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||jn(this.body)?null:ka(this.body)?this.body.type||null:Vn(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Mi?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){var t;const n=e.method||this.method,s=e.url||this.url,l=e.responseType||this.responseType,u=void 0!==e.body?e.body:this.body,d=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,p=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let g=e.headers||this.headers,_=e.params||this.params;const M=null!==(t=e.context)&&void 0!==t?t:this.context;return void 0!==e.setHeaders&&(g=Object.keys(e.setHeaders).reduce((w,E)=>w.set(E,e.setHeaders[E]),g)),e.setParams&&(_=Object.keys(e.setParams).reduce((w,E)=>w.set(E,e.setParams[E]),_)),new ci(n,s,u,{params:_,headers:g,context:M,reportProgress:p,responseType:l,withCredentials:d})}}var Tn=(()=>((Tn=Tn||{})[Tn.Sent=0]="Sent",Tn[Tn.UploadProgress=1]="UploadProgress",Tn[Tn.ResponseHeader=2]="ResponseHeader",Tn[Tn.DownloadProgress=3]="DownloadProgress",Tn[Tn.Response=4]="Response",Tn[Tn.User=5]="User",Tn))();class Fn{constructor(e,t=200,n="OK"){this.headers=e.headers||new Bn,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||n,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class ps extends Fn{constructor(e={}){super(e),this.type=Tn.ResponseHeader}clone(e={}){return new ps({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class Gr extends Fn{constructor(e={}){super(e),this.type=Tn.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new Gr({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class rs extends Fn{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function Ss(a,e){return{body:e,headers:a.headers,context:a.context,observe:a.observe,params:a.params,reportProgress:a.reportProgress,responseType:a.responseType,withCredentials:a.withCredentials}}let $i=(()=>{class a{constructor(t){this.handler=t}request(t,n,s={}){let l;if(t instanceof ci)l=t;else{let p,g;p=s.headers instanceof Bn?s.headers:new Bn(s.headers),s.params&&(g=s.params instanceof Mi?s.params:new Mi({fromObject:s.params})),l=new ci(t,n,void 0!==s.body?s.body:null,{headers:p,context:s.context,params:g,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials})}const u=(0,oo.of)(l).pipe((0,ha.b)(p=>this.handler.handle(p)));if(t instanceof ci||"events"===s.observe)return u;const d=u.pipe((0,yl.h)(p=>p instanceof Gr));switch(s.observe||"body"){case"body":switch(l.responseType){case"arraybuffer":return d.pipe((0,Ci.U)(p=>{if(null!==p.body&&!(p.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return p.body}));case"blob":return d.pipe((0,Ci.U)(p=>{if(null!==p.body&&!(p.body instanceof Blob))throw new Error("Response is not a Blob.");return p.body}));case"text":return d.pipe((0,Ci.U)(p=>{if(null!==p.body&&"string"!=typeof p.body)throw new Error("Response is not a string.");return p.body}));default:return d.pipe((0,Ci.U)(p=>p.body))}case"response":return d;default:throw new Error(`Unreachable: unhandled observe type ${s.observe}}`)}}delete(t,n={}){return this.request("DELETE",t,n)}get(t,n={}){return this.request("GET",t,n)}head(t,n={}){return this.request("HEAD",t,n)}jsonp(t,n){return this.request("JSONP",t,{params:(new Mi).append(n,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,n={}){return this.request("OPTIONS",t,n)}patch(t,n,s={}){return this.request("PATCH",t,Ss(s,n))}post(t,n,s={}){return this.request("POST",t,Ss(s,n))}put(t,n,s={}){return this.request("PUT",t,Ss(s,n))}}return a.\u0275fac=function(t){return new(t||a)(I.LFG(jt))},a.\u0275prov=I.Yz7({token:a,factory:a.\u0275fac}),a})();class Us{constructor(e,t){this.next=e,this.interceptor=t}handle(e){return this.interceptor.intercept(e,this.next)}}const ge=new I.OlP("HTTP_INTERCEPTORS");let ue=(()=>{class a{intercept(t,n){return n.handle(t)}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275prov=I.Yz7({token:a,factory:a.\u0275fac}),a})();const hr=/^\)\]\}',?\n/;let xr=(()=>{class a{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new ao.y(n=>{const s=this.xhrFactory.build();if(s.open(t.method,t.urlWithParams),t.withCredentials&&(s.withCredentials=!0),t.headers.forEach((E,D)=>s.setRequestHeader(E,D.join(","))),t.headers.has("Accept")||s.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const E=t.detectContentTypeHeader();null!==E&&s.setRequestHeader("Content-Type",E)}if(t.responseType){const E=t.responseType.toLowerCase();s.responseType="json"!==E?E:"text"}const l=t.serializeBody();let u=null;const d=()=>{if(null!==u)return u;const E=s.statusText||"OK",D=new Bn(s.getAllResponseHeaders()),F=function Ri(a){return"responseURL"in a&&a.responseURL?a.responseURL:/^X-Request-URL:/m.test(a.getAllResponseHeaders())?a.getResponseHeader("X-Request-URL"):null}(s)||t.url;return u=new ps({headers:D,status:s.status,statusText:E,url:F}),u},p=()=>{let{headers:E,status:D,statusText:F,url:P}=d(),R=null;204!==D&&(R=void 0===s.response?s.responseText:s.response),0===D&&(D=R?200:0);let V=D>=200&&D<300;if("json"===t.responseType&&"string"==typeof R){const k=R;R=R.replace(hr,"");try{R=""!==R?JSON.parse(R):null}catch(W){R=k,V&&(V=!1,R={error:W,text:R})}}V?(n.next(new Gr({body:R,headers:E,status:D,statusText:F,url:P||void 0})),n.complete()):n.error(new rs({error:R,headers:E,status:D,statusText:F,url:P||void 0}))},g=E=>{const{url:D}=d(),F=new rs({error:E,status:s.status||0,statusText:s.statusText||"Unknown Error",url:D||void 0});n.error(F)};let _=!1;const M=E=>{_||(n.next(d()),_=!0);let D={type:Tn.DownloadProgress,loaded:E.loaded};E.lengthComputable&&(D.total=E.total),"text"===t.responseType&&!!s.responseText&&(D.partialText=s.responseText),n.next(D)},w=E=>{let D={type:Tn.UploadProgress,loaded:E.loaded};E.lengthComputable&&(D.total=E.total),n.next(D)};return s.addEventListener("load",p),s.addEventListener("error",g),s.addEventListener("timeout",g),s.addEventListener("abort",g),t.reportProgress&&(s.addEventListener("progress",M),null!==l&&s.upload&&s.upload.addEventListener("progress",w)),s.send(l),n.next({type:Tn.Sent}),()=>{s.removeEventListener("error",g),s.removeEventListener("abort",g),s.removeEventListener("load",p),s.removeEventListener("timeout",g),t.reportProgress&&(s.removeEventListener("progress",M),null!==l&&s.upload&&s.upload.removeEventListener("progress",w)),s.readyState!==s.DONE&&s.abort()}})}}return a.\u0275fac=function(t){return new(t||a)(I.LFG(j.JF))},a.\u0275prov=I.Yz7({token:a,factory:a.\u0275fac}),a})();const er=new I.OlP("XSRF_COOKIE_NAME"),tr=new I.OlP("XSRF_HEADER_NAME");class Cs{}let Lo=(()=>{class a{constructor(t,n,s){this.doc=t,this.platform=n,this.cookieName=s,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=(0,j.Mx)(t,this.cookieName),this.lastCookieString=t),this.lastToken}}return a.\u0275fac=function(t){return new(t||a)(I.LFG(j.K0),I.LFG(I.Lbi),I.LFG(er))},a.\u0275prov=I.Yz7({token:a,factory:a.\u0275fac}),a})(),Ii=(()=>{class a{constructor(t,n){this.tokenService=t,this.headerName=n}intercept(t,n){const s=t.url.toLowerCase();if("GET"===t.method||"HEAD"===t.method||s.startsWith("http://")||s.startsWith("https://"))return n.handle(t);const l=this.tokenService.getToken();return null!==l&&!t.headers.has(this.headerName)&&(t=t.clone({headers:t.headers.set(this.headerName,l)})),n.handle(t)}}return a.\u0275fac=function(t){return new(t||a)(I.LFG(Cs),I.LFG(tr))},a.\u0275prov=I.Yz7({token:a,factory:a.\u0275fac}),a})(),Ts=(()=>{class a{constructor(t,n){this.backend=t,this.injector=n,this.chain=null}handle(t){if(null===this.chain){const n=this.injector.get(ge,[]);this.chain=n.reduceRight((s,l)=>new Us(s,l),this.backend)}return this.chain.handle(t)}}return a.\u0275fac=function(t){return new(t||a)(I.LFG(cr),I.LFG(I.zs3))},a.\u0275prov=I.Yz7({token:a,factory:a.\u0275fac}),a})(),Ua=(()=>{class a{static disable(){return{ngModule:a,providers:[{provide:Ii,useClass:ue}]}}static withOptions(t={}){return{ngModule:a,providers:[t.cookieName?{provide:er,useValue:t.cookieName}:[],t.headerName?{provide:tr,useValue:t.headerName}:[]]}}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=I.oAB({type:a}),a.\u0275inj=I.cJS({providers:[Ii,{provide:ge,useExisting:Ii,multi:!0},{provide:Cs,useClass:Lo},{provide:er,useValue:"XSRF-TOKEN"},{provide:tr,useValue:"X-XSRF-TOKEN"}]}),a})(),Mr=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=I.oAB({type:a}),a.\u0275inj=I.cJS({providers:[$i,{provide:jt,useClass:Ts},xr,{provide:cr,useExisting:xr}],imports:[[Ua.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),a})();var si=Q(2313);const dr=["*"];let vi=(()=>{class a{transform(t,n){return null==t&&(t=""),null==n&&(n=""),"string"!=typeof t?(console.error(`LanguagePipe has been invoked with an invalid value type [${typeof t}]`),t):"string"!=typeof n?(console.error(`LanguagePipe has been invoked with an invalid parameter [${typeof n}]`),t):"```"+n+"\n"+t+"\n```"}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275pipe=I.Yjl({name:"language",type:a,pure:!0}),a})();var Pr=(()=>{return(a=Pr||(Pr={})).CommandLine="command-line",a.LineHighlight="line-highlight",a.LineNumbers="line-numbers",Pr;var a})();class oi{}const $r=new I.OlP("SECURITY_CONTEXT");let Lr=(()=>{class a{constructor(t,n,s,l,u){this.platform=t,this.securityContext=n,this.http=s,this.sanitizer=u,this.initialMarkedOptions={renderer:new Re},this.options=l}get options(){return this._options}set options(t){this._options=Object.assign(Object.assign({},this.initialMarkedOptions),t)}get renderer(){return this.options.renderer}set renderer(t){this.options.renderer=t}compile(t,n=!1,s=!1,l=this.options){const u=this.trimIndentation(t),d=n?this.decodeHtml(u):u,g=_t(s?this.renderEmoji(d):d,l);return this.sanitizer.sanitize(this.securityContext,g)||""}getSource(t){if(!this.http)throw new Error("[ngx-markdown] When using the `src` attribute you *have to* pass the `HttpClient` as a parameter of the `forRoot` method. See README for more information");return this.http.get(t,{responseType:"text"}).pipe((0,Ci.U)(n=>this.handleExtension(t,n)))}highlight(t){if((0,j.NF)(this.platform)&&"undefined"!=typeof Prism){t||(t=document);const n=t.querySelectorAll('pre code:not([class*="language-"])');Array.prototype.forEach.call(n,s=>s.classList.add("language-none")),Prism.highlightAllUnder(t)}}renderKatex(t,n){if(!(0,j.NF)(this.platform))return t;if("undefined"==typeof katex||void 0===katex.renderToString)throw new Error("[ngx-markdown] When using the `katex` attribute you *have to* include KaTeX files to `angular.json` or use imports. See README for more information");return t.replace(/\$([^\s][^$]*?[^\s])\$/gm,(s,l)=>katex.renderToString(l,n))}decodeHtml(t){if(!(0,j.NF)(this.platform))return t;const n=document.createElement("textarea");return n.innerHTML=t,n.value}handleExtension(t,n){const s=t?t.split("?")[0].split(".").splice(-1).join():"";return"md"!==s?"```"+s+"\n"+n+"\n```":n}renderEmoji(t){if(!(0,j.NF)(this.platform))return t;if("undefined"==typeof joypixels||void 0===joypixels.shortnameToUnicode)throw new Error("[ngx-markdown] When using the `emoji` attribute you *have to* include Emoji-Toolkit files to `angular.json` or use imports. See README for more information");return joypixels.shortnameToUnicode(t)}trimIndentation(t){if(!t)return"";let n;return t.split("\n").map(s=>{let l=n;return s.length>0&&(l=isNaN(l)?s.search(/\S|$/):Math.min(s.search(/\S|$/),l)),isNaN(n)&&(n=l),l?s.substring(l):s}).join("\n")}}return a.\u0275fac=function(t){return new(t||a)(I.LFG(I.Lbi),I.LFG($r),I.LFG($i,8),I.LFG(oi,8),I.LFG(si.H7))},a.\u0275prov=I.Yz7({token:a,factory:a.\u0275fac}),a})(),Ds=(()=>{class a{constructor(t,n){this.element=t,this.markdownService=n,this.error=new I.vpe,this.load=new I.vpe,this.ready=new I.vpe,this._commandLine=!1,this._emoji=!1,this._katex=!1,this._lineHighlight=!1,this._lineNumbers=!1}get emoji(){return this._emoji}set emoji(t){this._emoji=this.coerceBooleanProperty(t)}get katex(){return this._katex}set katex(t){this._katex=this.coerceBooleanProperty(t)}get lineHighlight(){return this._lineHighlight}set lineHighlight(t){this._lineHighlight=this.coerceBooleanProperty(t)}get lineNumbers(){return this._lineNumbers}set lineNumbers(t){this._lineNumbers=this.coerceBooleanProperty(t)}get commandLine(){return this._commandLine}set commandLine(t){this._commandLine=this.coerceBooleanProperty(t)}ngOnChanges(){null==this.data?null==this.src||this.handleSrc():this.handleData()}ngAfterViewInit(){!this.data&&!this.src&&this.handleTransclusion()}render(t,n=!1){let s=this.markdownService.compile(t,n,this.emoji);s=this.katex?this.markdownService.renderKatex(s,this.katexOptions):s,this.element.nativeElement.innerHTML=s,this.handlePlugins(),this.markdownService.highlight(this.element.nativeElement),this.ready.emit()}coerceBooleanProperty(t){return null!=t&&"false"!=`${String(t)}`}handleData(){this.render(this.data)}handleSrc(){this.markdownService.getSource(this.src).subscribe(t=>{this.render(t),this.load.emit(t)},t=>this.error.emit(t))}handleTransclusion(){this.render(this.element.nativeElement.innerHTML,!0)}handlePlugins(){this.commandLine&&(this.setPluginClass(this.element.nativeElement,Pr.CommandLine),this.setPluginOptions(this.element.nativeElement,{dataFilterOutput:this.filterOutput,dataHost:this.host,dataPrompt:this.prompt,dataOutput:this.output,dataUser:this.user})),this.lineHighlight&&this.setPluginOptions(this.element.nativeElement,{dataLine:this.line,dataLineOffset:this.lineOffset}),this.lineNumbers&&(this.setPluginClass(this.element.nativeElement,Pr.LineNumbers),this.setPluginOptions(this.element.nativeElement,{dataStart:this.start}))}setPluginClass(t,n){const s=t.querySelectorAll("pre");for(let l=0;l<s.length;l++){const u=n instanceof Array?n:[n];s.item(l).classList.add(...u)}}setPluginOptions(t,n){const s=t.querySelectorAll("pre");for(let l=0;l<s.length;l++)Object.keys(n).forEach(u=>{const d=n[u];if(d){const p=this.toLispCase(u);s.item(l).setAttribute(p,d.toString())}})}toLispCase(t){const n=t.match(/([A-Z])/g);if(!n)return t;let s=t.toString();for(let l=0,u=n.length;l<u;l++)s=s.replace(new RegExp(n[l]),"-"+n[l].toLowerCase());return"-"===s.slice(0,1)&&(s=s.slice(1)),s}}return a.\u0275fac=function(t){return new(t||a)(I.Y36(I.SBq),I.Y36(Lr))},a.\u0275cmp=I.Xpm({type:a,selectors:[["markdown"],["","markdown",""]],inputs:{data:"data",src:"src",emoji:"emoji",katex:"katex",katexOptions:"katexOptions",lineHighlight:"lineHighlight",line:"line",lineOffset:"lineOffset",lineNumbers:"lineNumbers",start:"start",commandLine:"commandLine",filterOutput:"filterOutput",host:"host",prompt:"prompt",output:"output",user:"user"},outputs:{error:"error",load:"load",ready:"ready"},features:[I.TTD],ngContentSelectors:dr,decls:1,vars:0,template:function(t,n){1&t&&(I.F$t(),I.Hsn(0))},encapsulation:2}),a})(),Is=(()=>{class a{static forRoot(t){return{ngModule:a,providers:[Lr,t&&t.loader||[],t&&t.markedOptions||[],{provide:$r,useValue:t&&null!=t.sanitize?t.sanitize:I.q3G.HTML}]}}static forChild(){return{ngModule:a}}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=I.oAB({type:a}),a.\u0275inj=I.cJS({}),a})();var Ps=Q(6324);let ki=(()=>{class a{constructor(){}ngOnInit(){}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275cmp=I.Xpm({type:a,selectors:[["app-shader"]],decls:1,vars:0,template:function(t,n){1&t&&I._UZ(0,"router-outlet")},directives:[Ps.lC],styles:[""]}),a})();function $n(a,e,t,n,s,l,u){try{var d=a[l](u),p=d.value}catch(g){return void t(g)}d.done?e(p):Promise.resolve(p).then(n,s)}const Vi=1e3,zn=1001,di=1003,fi=1006,gs=1008,ho=1009,Ue=1014,an=1015,Ha=1016,vs=1020,Er=1023,mo=1026,ya=1027,Wo=3001,rn="srgb",Nr="srgb-linear",Ol="display-p3",S=7680,xs=2e3;class Ja{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const s=this._listeners[e];if(void 0!==s){const l=s.indexOf(t);-1!==l&&s.splice(l,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const n=this._listeners[e.type];if(void 0!==n){e.target=this;const s=n.slice(0);for(let l=0,u=s.length;l<u;l++)s[l].call(this,e);e.target=null}}}const kr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];const yo=Math.PI/180,yu=180/Math.PI;function mr(){const a=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(kr[255&a]+kr[a>>8&255]+kr[a>>16&255]+kr[a>>24&255]+"-"+kr[255&e]+kr[e>>8&255]+"-"+kr[e>>16&15|64]+kr[e>>24&255]+"-"+kr[63&t|128]+kr[t>>8&255]+"-"+kr[t>>16&255]+kr[t>>24&255]+kr[255&n]+kr[n>>8&255]+kr[n>>16&255]+kr[n>>24&255]).toLowerCase()}function Ti(a,e,t){return Math.max(e,Math.min(t,a))}function zi(a,e){return(a%e+e)%e}function Yd(a,e,t){return(1-t)*a+t*e}function yv(a){return 0==(a&a-1)&&0!==a}function qp(a){return Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))}function cs(a){return Math.pow(2,Math.floor(Math.log(a)/Math.LN2))}function Cr(a,e){switch(e.constructor){case Float32Array:return a;case Uint32Array:return a/4294967295;case Uint16Array:return a/65535;case Uint8Array:return a/255;case Int32Array:return Math.max(a/2147483647,-1);case Int16Array:return Math.max(a/32767,-1);case Int8Array:return Math.max(a/127,-1);default:throw new Error("Invalid component type.")}}function An(a,e){switch(e.constructor){case Float32Array:return a;case Uint32Array:return Math.round(4294967295*a);case Uint16Array:return Math.round(65535*a);case Uint8Array:return Math.round(255*a);case Int32Array:return Math.round(2147483647*a);case Int16Array:return Math.round(32767*a);case Int8Array:return Math.round(127*a);default:throw new Error("Invalid component type.")}}const xo_DEG2RAD=yo,xo_degToRad=function U_(a){return a*yo};class ke{constructor(e=0,t=0){ke.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6],this.y=s[1]*t+s[4]*n+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Ti(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),s=Math.sin(t),l=this.x-e.x,u=this.y-e.y;return this.x=l*n-u*s+e.x,this.y=l*s+u*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Dn{constructor(e,t,n,s,l,u,d,p,g){Dn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,n,s,l,u,d,p,g)}set(e,t,n,s,l,u,d,p,g){const _=this.elements;return _[0]=e,_[1]=s,_[2]=d,_[3]=t,_[4]=l,_[5]=p,_[6]=n,_[7]=u,_[8]=g,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,s=t.elements,l=this.elements,u=n[0],d=n[3],p=n[6],g=n[1],_=n[4],M=n[7],w=n[2],E=n[5],D=n[8],F=s[0],P=s[3],R=s[6],V=s[1],k=s[4],W=s[7],i=s[2],r=s[5],o=s[8];return l[0]=u*F+d*V+p*i,l[3]=u*P+d*k+p*r,l[6]=u*R+d*W+p*o,l[1]=g*F+_*V+M*i,l[4]=g*P+_*k+M*r,l[7]=g*R+_*W+M*o,l[2]=w*F+E*V+D*i,l[5]=w*P+E*k+D*r,l[8]=w*R+E*W+D*o,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],s=e[2],l=e[3],u=e[4],d=e[5],p=e[6],g=e[7],_=e[8];return t*u*_-t*d*g-n*l*_+n*d*p+s*l*g-s*u*p}invert(){const e=this.elements,t=e[0],n=e[1],s=e[2],l=e[3],u=e[4],d=e[5],p=e[6],g=e[7],_=e[8],M=_*u-d*g,w=d*p-_*l,E=g*l-u*p,D=t*M+n*w+s*E;if(0===D)return this.set(0,0,0,0,0,0,0,0,0);const F=1/D;return e[0]=M*F,e[1]=(s*g-_*n)*F,e[2]=(d*n-s*u)*F,e[3]=w*F,e[4]=(_*t-s*p)*F,e[5]=(s*l-d*t)*F,e[6]=E*F,e[7]=(n*p-g*t)*F,e[8]=(u*t-n*l)*F,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,s,l,u,d){const p=Math.cos(l),g=Math.sin(l);return this.set(n*p,n*g,-n*(p*u+g*d)+u+e,-s*g,s*p,-s*(-g*u+p*d)+d+t,0,0,1),this}scale(e,t){return this.premultiply(Zp.makeScale(e,t)),this}rotate(e){return this.premultiply(Zp.makeRotation(-e)),this}translate(e,t){return this.premultiply(Zp.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let s=0;s<9;s++)if(t[s]!==n[s])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const Zp=new Dn;function _v(a){for(let e=a.length-1;e>=0;--e)if(a[e]>=65535)return!0;return!1}function xc(a){return document.createElementNS("http://www.w3.org/1999/xhtml",a)}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const Sh={};function Kd(a){a in Sh||(Sh[a]=!0,console.warn(a))}function Ea(a){return a<.04045?.0773993808*a:Math.pow(.9478672986*a+.0521327014,2.4)}function Ch(a){return a<.0031308?12.92*a:1.055*Math.pow(a,.41666)-.055}const Jd=(new Dn).fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),V_=(new Dn).fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]),xv={[Nr]:a=>a,[rn]:a=>a.convertSRGBToLinear(),[Ol]:function z_(a){return a.convertSRGBToLinear().applyMatrix3(V_)}},G_={[Nr]:a=>a,[rn]:a=>a.convertLinearToSRGB(),[Ol]:function H_(a){return a.applyMatrix3(Jd).convertLinearToSRGB()}},Ms={enabled:!0,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(a){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!a},get workingColorSpace(){return Nr},set workingColorSpace(a){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(a,e,t){if(!1===this.enabled||e===t||!e||!t)return a;const n=xv[e],s=G_[t];if(void 0===n||void 0===s)throw new Error(`Unsupported color space conversion, "${e}" to "${t}".`);return s(n(a))},fromWorkingColorSpace:function(a,e){return this.convert(a,this.workingColorSpace,e)},toWorkingColorSpace:function(a,e){return this.convert(a,e,this.workingColorSpace)}};let Mc;class Mv{static getDataURL(e){if(/^data:/i.test(e.src)||"undefined"==typeof HTMLCanvasElement)return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===Mc&&(Mc=xc("canvas")),Mc.width=e.width,Mc.height=e.height;const n=Mc.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=Mc}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const t=xc("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const s=n.getImageData(0,0,e.width,e.height),l=s.data;for(let u=0;u<l.length;u++)l[u]=255*Ea(l[u]/255);return n.putImageData(s,0,0),t}if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t[n]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*Ea(t[n]/255)):Ea(t[n]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let Jr=0;class wc{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:Jr++}),this.uuid=mr(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const n={uuid:this.uuid,url:""},s=this.data;if(null!==s){let l;if(Array.isArray(s)){l=[];for(let u=0,d=s.length;u<d;u++)l.push(Kp(s[u].isDataTexture?s[u].image:s[u]))}else l=Kp(s);n.url=l}return t||(e.images[this.uuid]=n),n}}function Kp(a){return"undefined"!=typeof HTMLImageElement&&a instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&a instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&a instanceof ImageBitmap?Mv.getDataURL(a):a.data?{data:Array.from(a.data),width:a.width,height:a.height,type:a.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Jp=0,ws=(()=>{class a extends Ja{constructor(t=a.DEFAULT_IMAGE,n=a.DEFAULT_MAPPING,s=zn,l=zn,u=fi,d=gs,p=Er,g=ho,_=a.DEFAULT_ANISOTROPY,M=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Jp++}),this.uuid=mr(),this.name="",this.source=new wc(t),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=s,this.wrapT=l,this.magFilter=u,this.minFilter=d,this.anisotropy=_,this.format=p,this.internalFormat=null,this.type=g,this.offset=new ke(0,0),this.repeat=new ke(1,1),this.center=new ke(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Dn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,"string"==typeof M?this.colorSpace=M:(Kd("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=M===Wo?rn:""),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const n=void 0===t||"string"==typeof t;if(!n&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const s={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(s.userData=this.userData),n||(t.textures[this.uuid]=s),s}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Vi:t.x=t.x-Math.floor(t.x);break;case zn:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case Vi:t.y=t.y-Math.floor(t.y);break;case zn:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return Kd("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===rn?Wo:3e3}set encoding(t){Kd("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=t===Wo?rn:""}}return a.DEFAULT_IMAGE=null,a.DEFAULT_MAPPING=300,a.DEFAULT_ANISOTROPY=1,a})();class ii{constructor(e=0,t=0,n=0,s=1){ii.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,s){return this.x=e,this.y=t,this.z=n,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,s=this.z,l=this.w,u=e.elements;return this.x=u[0]*t+u[4]*n+u[8]*s+u[12]*l,this.y=u[1]*t+u[5]*n+u[9]*s+u[13]*l,this.z=u[2]*t+u[6]*n+u[10]*s+u[14]*l,this.w=u[3]*t+u[7]*n+u[11]*s+u[15]*l,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,s,l;const p=e.elements,g=p[0],_=p[4],M=p[8],w=p[1],E=p[5],D=p[9],F=p[2],P=p[6],R=p[10];if(Math.abs(_-w)<.01&&Math.abs(M-F)<.01&&Math.abs(D-P)<.01){if(Math.abs(_+w)<.1&&Math.abs(M+F)<.1&&Math.abs(D+P)<.1&&Math.abs(g+E+R-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const k=(g+1)/2,W=(E+1)/2,i=(R+1)/2,r=(_+w)/4,o=(M+F)/4,c=(D+P)/4;return k>W&&k>i?k<.01?(n=0,s=.707106781,l=.707106781):(n=Math.sqrt(k),s=r/n,l=o/n):W>i?W<.01?(n=.707106781,s=0,l=.707106781):(s=Math.sqrt(W),n=r/s,l=c/s):i<.01?(n=.707106781,s=.707106781,l=0):(l=Math.sqrt(i),n=o/l,s=c/l),this.set(n,s,l,t),this}let V=Math.sqrt((P-D)*(P-D)+(M-F)*(M-F)+(w-_)*(w-_));return Math.abs(V)<.001&&(V=1),this.x=(P-D)/V,this.y=(M-F)/V,this.z=(w-_)/V,this.w=Math.acos((g+E+R-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class W_ extends Ja{constructor(e=1,t=1,n={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new ii(0,0,e,t),this.scissorTest=!1,this.viewport=new ii(0,0,e,t);const s={width:e,height:t,depth:1};void 0!==n.encoding&&(Kd("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),n.colorSpace=n.encoding===Wo?rn:""),this.texture=new ws(s,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.internalFormat=void 0!==n.internalFormat?n.internalFormat:null,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:fi,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null,this.samples=void 0!==n.samples?n.samples:0}setSize(e,t,n=1){(this.width!==e||this.height!==t||this.depth!==n)&&(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new wc(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class bc extends W_{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}}class _u extends ws{constructor(e=null,t=1,n=1,s=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:s},this.magFilter=di,this.minFilter=di,this.wrapR=zn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Qp extends ws{constructor(e=null,t=1,n=1,s=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:s},this.magFilter=di,this.minFilter=di,this.wrapR=zn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class gr{constructor(e=0,t=0,n=0,s=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=s}static slerpFlat(e,t,n,s,l,u,d){let p=n[s+0],g=n[s+1],_=n[s+2],M=n[s+3];const w=l[u+0],E=l[u+1],D=l[u+2],F=l[u+3];if(0===d)return e[t+0]=p,e[t+1]=g,e[t+2]=_,void(e[t+3]=M);if(1===d)return e[t+0]=w,e[t+1]=E,e[t+2]=D,void(e[t+3]=F);if(M!==F||p!==w||g!==E||_!==D){let P=1-d;const R=p*w+g*E+_*D+M*F,V=R>=0?1:-1,k=1-R*R;if(k>Number.EPSILON){const i=Math.sqrt(k),r=Math.atan2(i,R*V);P=Math.sin(P*r)/i,d=Math.sin(d*r)/i}const W=d*V;if(p=p*P+w*W,g=g*P+E*W,_=_*P+D*W,M=M*P+F*W,P===1-d){const i=1/Math.sqrt(p*p+g*g+_*_+M*M);p*=i,g*=i,_*=i,M*=i}}e[t]=p,e[t+1]=g,e[t+2]=_,e[t+3]=M}static multiplyQuaternionsFlat(e,t,n,s,l,u){const d=n[s],p=n[s+1],g=n[s+2],_=n[s+3],M=l[u],w=l[u+1],E=l[u+2],D=l[u+3];return e[t]=d*D+_*M+p*E-g*w,e[t+1]=p*D+_*w+g*M-d*E,e[t+2]=g*D+_*E+d*w-p*M,e[t+3]=_*D-d*M-p*w-g*E,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,s){return this._x=e,this._y=t,this._z=n,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const n=e._x,s=e._y,l=e._z,u=e._order,d=Math.cos,p=Math.sin,g=d(n/2),_=d(s/2),M=d(l/2),w=p(n/2),E=p(s/2),D=p(l/2);switch(u){case"XYZ":this._x=w*_*M+g*E*D,this._y=g*E*M-w*_*D,this._z=g*_*D+w*E*M,this._w=g*_*M-w*E*D;break;case"YXZ":this._x=w*_*M+g*E*D,this._y=g*E*M-w*_*D,this._z=g*_*D-w*E*M,this._w=g*_*M+w*E*D;break;case"ZXY":this._x=w*_*M-g*E*D,this._y=g*E*M+w*_*D,this._z=g*_*D+w*E*M,this._w=g*_*M-w*E*D;break;case"ZYX":this._x=w*_*M-g*E*D,this._y=g*E*M+w*_*D,this._z=g*_*D-w*E*M,this._w=g*_*M+w*E*D;break;case"YZX":this._x=w*_*M+g*E*D,this._y=g*E*M+w*_*D,this._z=g*_*D-w*E*M,this._w=g*_*M-w*E*D;break;case"XZY":this._x=w*_*M-g*E*D,this._y=g*E*M-w*_*D,this._z=g*_*D+w*E*M,this._w=g*_*M+w*E*D;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+u)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,s=Math.sin(n);return this._x=e.x*s,this._y=e.y*s,this._z=e.z*s,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],s=t[4],l=t[8],u=t[1],d=t[5],p=t[9],g=t[2],_=t[6],M=t[10],w=n+d+M;if(w>0){const E=.5/Math.sqrt(w+1);this._w=.25/E,this._x=(_-p)*E,this._y=(l-g)*E,this._z=(u-s)*E}else if(n>d&&n>M){const E=2*Math.sqrt(1+n-d-M);this._w=(_-p)/E,this._x=.25*E,this._y=(s+u)/E,this._z=(l+g)/E}else if(d>M){const E=2*Math.sqrt(1+d-n-M);this._w=(l-g)/E,this._x=(s+u)/E,this._y=.25*E,this._z=(p+_)/E}else{const E=2*Math.sqrt(1+M-n-d);this._w=(u-s)/E,this._x=(l+g)/E,this._y=(p+_)/E,this._z=.25*E}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Ti(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const s=Math.min(1,t/n);return this.slerp(e,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,s=e._y,l=e._z,u=e._w,d=t._x,p=t._y,g=t._z,_=t._w;return this._x=n*_+u*d+s*g-l*p,this._y=s*_+u*p+l*d-n*g,this._z=l*_+u*g+n*p-s*d,this._w=u*_-n*d-s*p-l*g,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const n=this._x,s=this._y,l=this._z,u=this._w;let d=u*e._w+n*e._x+s*e._y+l*e._z;if(d<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,d=-d):this.copy(e),d>=1)return this._w=u,this._x=n,this._y=s,this._z=l,this;const p=1-d*d;if(p<=Number.EPSILON){const E=1-t;return this._w=E*u+t*this._w,this._x=E*n+t*this._x,this._y=E*s+t*this._y,this._z=E*l+t*this._z,this.normalize(),this._onChangeCallback(),this}const g=Math.sqrt(p),_=Math.atan2(g,d),M=Math.sin((1-t)*_)/g,w=Math.sin(t*_)/g;return this._w=u*M+this._w*w,this._x=n*M+this._x*w,this._y=s*M+this._y*w,this._z=l*M+this._z*w,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),s=2*Math.PI*Math.random(),l=2*Math.PI*Math.random();return this.set(t*Math.cos(s),n*Math.sin(l),n*Math.cos(l),t*Math.sin(s))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class K{constructor(e=0,t=0,n=0){K.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(em.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(em.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,s=this.z,l=e.elements;return this.x=l[0]*t+l[3]*n+l[6]*s,this.y=l[1]*t+l[4]*n+l[7]*s,this.z=l[2]*t+l[5]*n+l[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,s=this.z,l=e.elements,u=1/(l[3]*t+l[7]*n+l[11]*s+l[15]);return this.x=(l[0]*t+l[4]*n+l[8]*s+l[12])*u,this.y=(l[1]*t+l[5]*n+l[9]*s+l[13])*u,this.z=(l[2]*t+l[6]*n+l[10]*s+l[14])*u,this}applyQuaternion(e){const t=this.x,n=this.y,s=this.z,l=e.x,u=e.y,d=e.z,p=e.w,g=p*t+u*s-d*n,_=p*n+d*t-l*s,M=p*s+l*n-u*t,w=-l*t-u*n-d*s;return this.x=g*p+w*-l+_*-d-M*-u,this.y=_*p+w*-u+M*-l-g*-d,this.z=M*p+w*-d+g*-u-_*-l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,s=this.z,l=e.elements;return this.x=l[0]*t+l[4]*n+l[8]*s,this.y=l[1]*t+l[5]*n+l[9]*s,this.z=l[2]*t+l[6]*n+l[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,s=e.y,l=e.z,u=t.x,d=t.y,p=t.z;return this.x=s*p-l*d,this.y=l*u-n*p,this.z=n*d-s*u,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return xu.copy(this).projectOnVector(e),this.sub(xu)}reflect(e){return this.sub(xu.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Ti(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,s=this.z-e.z;return t*t+n*n+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const s=Math.sin(t)*e;return this.x=s*Math.sin(n),this.y=Math.cos(t)*e,this.z=s*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=s,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,n=Math.sqrt(1-e**2);return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const xu=new K,em=new gr;class Qa{constructor(e=new K(1/0,1/0,1/0),t=new K(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(Os.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(Os.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Os.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){if(e.updateWorldMatrix(!1,!1),void 0!==e.boundingBox)null===e.boundingBox&&e.computeBoundingBox(),Sa.copy(e.boundingBox),Sa.applyMatrix4(e.matrixWorld),this.union(Sa);else{const s=e.geometry;if(void 0!==s)if(t&&void 0!==s.attributes&&void 0!==s.attributes.position){const l=s.attributes.position;for(let u=0,d=l.count;u<d;u++)Os.fromBufferAttribute(l,u).applyMatrix4(e.matrixWorld),this.expandByPoint(Os)}else null===s.boundingBox&&s.computeBoundingBox(),Sa.copy(s.boundingBox),Sa.applyMatrix4(e.matrixWorld),this.union(Sa)}const n=e.children;for(let s=0,l=n.length;s<l;s++)this.expandByObject(n[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Os),Os.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Ah),tf.subVectors(this.max,Ah),Mu.subVectors(e.a,Ah),Th.subVectors(e.b,Ah),Ec.subVectors(e.c,Ah),Fl.subVectors(Th,Mu),Sc.subVectors(Ec,Th),Cc.subVectors(Mu,Ec);let t=[0,-Fl.z,Fl.y,0,-Sc.z,Sc.y,0,-Cc.z,Cc.y,Fl.z,0,-Fl.x,Sc.z,0,-Sc.x,Cc.z,0,-Cc.x,-Fl.y,Fl.x,0,-Sc.y,Sc.x,0,-Cc.y,Cc.x,0];return!(!Mo(t,Mu,Th,Ec,tf)||(t=[1,0,0,0,1,0,0,0,1],!Mo(t,Mu,Th,Ec,tf)))&&(nf.crossVectors(Fl,Sc),t=[nf.x,nf.y,nf.z],Mo(t,Mu,Th,Ec,tf))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Os).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(Os).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(el[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),el[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),el[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),el[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),el[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),el[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),el[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),el[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(el)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const el=[new K,new K,new K,new K,new K,new K,new K,new K],Os=new K,Sa=new Qa,Mu=new K,Th=new K,Ec=new K,Fl=new K,Sc=new K,Cc=new K,Ah=new K,tf=new K,nf=new K,wu=new K;function Mo(a,e,t,n,s){for(let l=0,u=a.length-3;l<=u;l+=3){wu.fromArray(a,l);const d=s.x*Math.abs(wu.x)+s.y*Math.abs(wu.y)+s.z*Math.abs(wu.z),p=e.dot(wu),g=t.dot(wu),_=n.dot(wu);if(Math.max(-Math.max(p,g,_),Math.min(p,g,_))>d)return!1}return!0}const j_=new Qa,Dh=new K,tm=new K;class $o{constructor(e=new K,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):j_.setFromPoints(e).getCenter(n);let s=0;for(let l=0,u=e.length;l<u;l++)s=Math.max(s,n.distanceToSquared(e[l]));return this.radius=Math.sqrt(s),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Dh.subVectors(e,this.center);const t=Dh.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),s=.5*(n-this.radius);this.center.addScaledVector(Dh,s/n),this.radius+=s}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(tm.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Dh.copy(e.center).add(tm)),this.expandByPoint(Dh.copy(e.center).sub(tm))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Hi=new K,Rh=new K,Ih=new K,tl=new K,Ur=new K,Nl=new K,Ph=new K;class bu{constructor(e=new K,t=new K(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Hi)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Hi.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Hi.copy(this.origin).addScaledVector(this.direction,t),Hi.distanceToSquared(e))}distanceSqToSegment(e,t,n,s){Rh.copy(e).add(t).multiplyScalar(.5),Ih.copy(t).sub(e).normalize(),tl.copy(this.origin).sub(Rh);const l=.5*e.distanceTo(t),u=-this.direction.dot(Ih),d=tl.dot(this.direction),p=-tl.dot(Ih),g=tl.lengthSq(),_=Math.abs(1-u*u);let M,w,E,D;if(_>0)if(M=u*p-d,w=u*d-p,D=l*_,M>=0)if(w>=-D)if(w<=D){const F=1/_;M*=F,w*=F,E=M*(M+u*w+2*d)+w*(u*M+w+2*p)+g}else w=l,M=Math.max(0,-(u*w+d)),E=-M*M+w*(w+2*p)+g;else w=-l,M=Math.max(0,-(u*w+d)),E=-M*M+w*(w+2*p)+g;else w<=-D?(M=Math.max(0,-(-u*l+d)),w=M>0?-l:Math.min(Math.max(-l,-p),l),E=-M*M+w*(w+2*p)+g):w<=D?(M=0,w=Math.min(Math.max(-l,-p),l),E=w*(w+2*p)+g):(M=Math.max(0,-(u*l+d)),w=M>0?l:Math.min(Math.max(-l,-p),l),E=-M*M+w*(w+2*p)+g);else w=u>0?-l:l,M=Math.max(0,-(u*w+d)),E=-M*M+w*(w+2*p)+g;return n&&n.copy(this.origin).addScaledVector(this.direction,M),s&&s.copy(Rh).addScaledVector(Ih,w),E}intersectSphere(e,t){Hi.subVectors(e.center,this.origin);const n=Hi.dot(this.direction),s=Hi.dot(Hi)-n*n,l=e.radius*e.radius;if(s>l)return null;const u=Math.sqrt(l-s),d=n-u,p=n+u;return p<0?null:this.at(d<0?p:d,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,s,l,u,d,p;const g=1/this.direction.x,_=1/this.direction.y,M=1/this.direction.z,w=this.origin;return g>=0?(n=(e.min.x-w.x)*g,s=(e.max.x-w.x)*g):(n=(e.max.x-w.x)*g,s=(e.min.x-w.x)*g),_>=0?(l=(e.min.y-w.y)*_,u=(e.max.y-w.y)*_):(l=(e.max.y-w.y)*_,u=(e.min.y-w.y)*_),n>u||l>s||((l>n||isNaN(n))&&(n=l),(u<s||isNaN(s))&&(s=u),M>=0?(d=(e.min.z-w.z)*M,p=(e.max.z-w.z)*M):(d=(e.max.z-w.z)*M,p=(e.min.z-w.z)*M),n>p||d>s)||((d>n||n!=n)&&(n=d),(p<s||s!=s)&&(s=p),s<0)?null:this.at(n>=0?n:s,t)}intersectsBox(e){return null!==this.intersectBox(e,Hi)}intersectTriangle(e,t,n,s,l){Ur.subVectors(t,e),Nl.subVectors(n,e),Ph.crossVectors(Ur,Nl);let d,u=this.direction.dot(Ph);if(u>0){if(s)return null;d=1}else{if(!(u<0))return null;d=-1,u=-u}tl.subVectors(this.origin,e);const p=d*this.direction.dot(Nl.crossVectors(tl,Nl));if(p<0)return null;const g=d*this.direction.dot(Ur.cross(tl));if(g<0||p+g>u)return null;const _=-d*tl.dot(Ph);return _<0?null:this.at(_/u,l)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Bt{constructor(e,t,n,s,l,u,d,p,g,_,M,w,E,D,F,P){Bt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,n,s,l,u,d,p,g,_,M,w,E,D,F,P)}set(e,t,n,s,l,u,d,p,g,_,M,w,E,D,F,P){const R=this.elements;return R[0]=e,R[4]=t,R[8]=n,R[12]=s,R[1]=l,R[5]=u,R[9]=d,R[13]=p,R[2]=g,R[6]=_,R[10]=M,R[14]=w,R[3]=E,R[7]=D,R[11]=F,R[15]=P,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Bt).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,s=1/Tc.setFromMatrixColumn(e,0).length(),l=1/Tc.setFromMatrixColumn(e,1).length(),u=1/Tc.setFromMatrixColumn(e,2).length();return t[0]=n[0]*s,t[1]=n[1]*s,t[2]=n[2]*s,t[3]=0,t[4]=n[4]*l,t[5]=n[5]*l,t[6]=n[6]*l,t[7]=0,t[8]=n[8]*u,t[9]=n[9]*u,t[10]=n[10]*u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,s=e.y,l=e.z,u=Math.cos(n),d=Math.sin(n),p=Math.cos(s),g=Math.sin(s),_=Math.cos(l),M=Math.sin(l);if("XYZ"===e.order){const w=u*_,E=u*M,D=d*_,F=d*M;t[0]=p*_,t[4]=-p*M,t[8]=g,t[1]=E+D*g,t[5]=w-F*g,t[9]=-d*p,t[2]=F-w*g,t[6]=D+E*g,t[10]=u*p}else if("YXZ"===e.order){const w=p*_,E=p*M,D=g*_,F=g*M;t[0]=w+F*d,t[4]=D*d-E,t[8]=u*g,t[1]=u*M,t[5]=u*_,t[9]=-d,t[2]=E*d-D,t[6]=F+w*d,t[10]=u*p}else if("ZXY"===e.order){const w=p*_,E=p*M,D=g*_,F=g*M;t[0]=w-F*d,t[4]=-u*M,t[8]=D+E*d,t[1]=E+D*d,t[5]=u*_,t[9]=F-w*d,t[2]=-u*g,t[6]=d,t[10]=u*p}else if("ZYX"===e.order){const w=u*_,E=u*M,D=d*_,F=d*M;t[0]=p*_,t[4]=D*g-E,t[8]=w*g+F,t[1]=p*M,t[5]=F*g+w,t[9]=E*g-D,t[2]=-g,t[6]=d*p,t[10]=u*p}else if("YZX"===e.order){const w=u*p,E=u*g,D=d*p,F=d*g;t[0]=p*_,t[4]=F-w*M,t[8]=D*M+E,t[1]=M,t[5]=u*_,t[9]=-d*_,t[2]=-g*_,t[6]=E*M+D,t[10]=w-F*M}else if("XZY"===e.order){const w=u*p,E=u*g,D=d*p,F=d*g;t[0]=p*_,t[4]=-M,t[8]=g*_,t[1]=w*M+F,t[5]=u*_,t[9]=E*M-D,t[2]=D*M-E,t[6]=d*_,t[10]=F*M+w}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(wv,e,$_)}lookAt(e,t,n){const s=this.elements;return Js.subVectors(e,t),0===Js.lengthSq()&&(Js.z=1),Js.normalize(),nl.crossVectors(n,Js),0===nl.lengthSq()&&(1===Math.abs(n.z)?Js.x+=1e-4:Js.z+=1e-4,Js.normalize(),nl.crossVectors(n,Js)),nl.normalize(),rf.crossVectors(Js,nl),s[0]=nl.x,s[4]=rf.x,s[8]=Js.x,s[1]=nl.y,s[5]=rf.y,s[9]=Js.y,s[2]=nl.z,s[6]=rf.z,s[10]=Js.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,s=t.elements,l=this.elements,u=n[0],d=n[4],p=n[8],g=n[12],_=n[1],M=n[5],w=n[9],E=n[13],D=n[2],F=n[6],P=n[10],R=n[14],V=n[3],k=n[7],W=n[11],i=n[15],r=s[0],o=s[4],c=s[8],h=s[12],f=s[1],x=s[5],b=s[9],C=s[13],L=s[2],N=s[6],G=s[10],X=s[14],Z=s[3],re=s[7],ce=s[11],ie=s[15];return l[0]=u*r+d*f+p*L+g*Z,l[4]=u*o+d*x+p*N+g*re,l[8]=u*c+d*b+p*G+g*ce,l[12]=u*h+d*C+p*X+g*ie,l[1]=_*r+M*f+w*L+E*Z,l[5]=_*o+M*x+w*N+E*re,l[9]=_*c+M*b+w*G+E*ce,l[13]=_*h+M*C+w*X+E*ie,l[2]=D*r+F*f+P*L+R*Z,l[6]=D*o+F*x+P*N+R*re,l[10]=D*c+F*b+P*G+R*ce,l[14]=D*h+F*C+P*X+R*ie,l[3]=V*r+k*f+W*L+i*Z,l[7]=V*o+k*x+W*N+i*re,l[11]=V*c+k*b+W*G+i*ce,l[15]=V*h+k*C+W*X+i*ie,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],s=e[8],l=e[12],u=e[1],d=e[5],p=e[9],g=e[13],_=e[2],M=e[6],w=e[10],E=e[14];return e[3]*(+l*p*M-s*g*M-l*d*w+n*g*w+s*d*E-n*p*E)+e[7]*(+t*p*E-t*g*w+l*u*w-s*u*E+s*g*_-l*p*_)+e[11]*(+t*g*M-t*d*E-l*u*M+n*u*E+l*d*_-n*g*_)+e[15]*(-s*d*_-t*p*M+t*d*w+s*u*M-n*u*w+n*p*_)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=t,s[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],s=e[2],l=e[3],u=e[4],d=e[5],p=e[6],g=e[7],_=e[8],M=e[9],w=e[10],E=e[11],D=e[12],F=e[13],P=e[14],R=e[15],V=M*P*g-F*w*g+F*p*E-d*P*E-M*p*R+d*w*R,k=D*w*g-_*P*g-D*p*E+u*P*E+_*p*R-u*w*R,W=_*F*g-D*M*g+D*d*E-u*F*E-_*d*R+u*M*R,i=D*M*p-_*F*p-D*d*w+u*F*w+_*d*P-u*M*P,r=t*V+n*k+s*W+l*i;if(0===r)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const o=1/r;return e[0]=V*o,e[1]=(F*w*l-M*P*l-F*s*E+n*P*E+M*s*R-n*w*R)*o,e[2]=(d*P*l-F*p*l+F*s*g-n*P*g-d*s*R+n*p*R)*o,e[3]=(M*p*l-d*w*l-M*s*g+n*w*g+d*s*E-n*p*E)*o,e[4]=k*o,e[5]=(_*P*l-D*w*l+D*s*E-t*P*E-_*s*R+t*w*R)*o,e[6]=(D*p*l-u*P*l-D*s*g+t*P*g+u*s*R-t*p*R)*o,e[7]=(u*w*l-_*p*l+_*s*g-t*w*g-u*s*E+t*p*E)*o,e[8]=W*o,e[9]=(D*M*l-_*F*l-D*n*E+t*F*E+_*n*R-t*M*R)*o,e[10]=(u*F*l-D*d*l+D*n*g-t*F*g-u*n*R+t*d*R)*o,e[11]=(_*d*l-u*M*l-_*n*g+t*M*g+u*n*E-t*d*E)*o,e[12]=i*o,e[13]=(_*F*s-D*M*s+D*n*w-t*F*w-_*n*P+t*M*P)*o,e[14]=(D*d*s-u*F*s-D*n*p+t*F*p+u*n*P-t*d*P)*o,e[15]=(u*M*s-_*d*s+_*n*p-t*M*p-u*n*w+t*d*w)*o,this}scale(e){const t=this.elements,n=e.x,s=e.y,l=e.z;return t[0]*=n,t[4]*=s,t[8]*=l,t[1]*=n,t[5]*=s,t[9]*=l,t[2]*=n,t[6]*=s,t[10]*=l,t[3]*=n,t[7]*=s,t[11]*=l,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),s=Math.sin(t),l=1-n,u=e.x,d=e.y,p=e.z,g=l*u,_=l*d;return this.set(g*u+n,g*d-s*p,g*p+s*d,0,g*d+s*p,_*d+n,_*p-s*u,0,g*p-s*d,_*p+s*u,l*p*p+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,s,l,u){return this.set(1,n,l,0,e,1,u,0,t,s,1,0,0,0,0,1),this}compose(e,t,n){const s=this.elements,l=t._x,u=t._y,d=t._z,p=t._w,g=l+l,_=u+u,M=d+d,w=l*g,E=l*_,D=l*M,F=u*_,P=u*M,R=d*M,V=p*g,k=p*_,W=p*M,i=n.x,r=n.y,o=n.z;return s[0]=(1-(F+R))*i,s[1]=(E+W)*i,s[2]=(D-k)*i,s[3]=0,s[4]=(E-W)*r,s[5]=(1-(w+R))*r,s[6]=(P+V)*r,s[7]=0,s[8]=(D+k)*o,s[9]=(P-V)*o,s[10]=(1-(w+F))*o,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,t,n){const s=this.elements;let l=Tc.set(s[0],s[1],s[2]).length();const u=Tc.set(s[4],s[5],s[6]).length(),d=Tc.set(s[8],s[9],s[10]).length();this.determinant()<0&&(l=-l),e.x=s[12],e.y=s[13],e.z=s[14],Xo.copy(this);const g=1/l,_=1/u,M=1/d;return Xo.elements[0]*=g,Xo.elements[1]*=g,Xo.elements[2]*=g,Xo.elements[4]*=_,Xo.elements[5]*=_,Xo.elements[6]*=_,Xo.elements[8]*=M,Xo.elements[9]*=M,Xo.elements[10]*=M,t.setFromRotationMatrix(Xo),n.x=l,n.y=u,n.z=d,this}makePerspective(e,t,n,s,l,u,d=xs){const p=this.elements,g=2*l/(t-e),_=2*l/(n-s),M=(t+e)/(t-e),w=(n+s)/(n-s);let E,D;if(d===xs)E=-(u+l)/(u-l),D=-2*u*l/(u-l);else{if(2001!==d)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+d);E=-u/(u-l),D=-u*l/(u-l)}return p[0]=g,p[4]=0,p[8]=M,p[12]=0,p[1]=0,p[5]=_,p[9]=w,p[13]=0,p[2]=0,p[6]=0,p[10]=E,p[14]=D,p[3]=0,p[7]=0,p[11]=-1,p[15]=0,this}makeOrthographic(e,t,n,s,l,u,d=xs){const p=this.elements,g=1/(t-e),_=1/(n-s),M=1/(u-l),w=(t+e)*g,E=(n+s)*_;let D,F;if(d===xs)D=(u+l)*M,F=-2*M;else{if(2001!==d)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+d);D=l*M,F=-1*M}return p[0]=2*g,p[4]=0,p[8]=0,p[12]=-w,p[1]=0,p[5]=2*_,p[9]=0,p[13]=-E,p[2]=0,p[6]=0,p[10]=F,p[14]=-D,p[3]=0,p[7]=0,p[11]=0,p[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let s=0;s<16;s++)if(t[s]!==n[s])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const Tc=new K,Xo=new Bt,wv=new K(0,0,0),$_=new K(1,1,1),nl=new K,rf=new K,Js=new K,sf=new Bt,of=new gr;let il=(()=>{class a{constructor(t=0,n=0,s=0,l=a.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=n,this._z=s,this._order=l}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,n,s,l=this._order){return this._x=t,this._y=n,this._z=s,this._order=l,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,n=this._order,s=!0){const l=t.elements,u=l[0],d=l[4],p=l[8],g=l[1],_=l[5],M=l[9],w=l[2],E=l[6],D=l[10];switch(n){case"XYZ":this._y=Math.asin(Ti(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(-M,D),this._z=Math.atan2(-d,u)):(this._x=Math.atan2(E,_),this._z=0);break;case"YXZ":this._x=Math.asin(-Ti(M,-1,1)),Math.abs(M)<.9999999?(this._y=Math.atan2(p,D),this._z=Math.atan2(g,_)):(this._y=Math.atan2(-w,u),this._z=0);break;case"ZXY":this._x=Math.asin(Ti(E,-1,1)),Math.abs(E)<.9999999?(this._y=Math.atan2(-w,D),this._z=Math.atan2(-d,_)):(this._y=0,this._z=Math.atan2(g,u));break;case"ZYX":this._y=Math.asin(-Ti(w,-1,1)),Math.abs(w)<.9999999?(this._x=Math.atan2(E,D),this._z=Math.atan2(g,u)):(this._x=0,this._z=Math.atan2(-d,_));break;case"YZX":this._z=Math.asin(Ti(g,-1,1)),Math.abs(g)<.9999999?(this._x=Math.atan2(-M,_),this._y=Math.atan2(-w,u)):(this._x=0,this._y=Math.atan2(p,D));break;case"XZY":this._z=Math.asin(-Ti(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(E,_),this._y=Math.atan2(p,u)):(this._x=Math.atan2(-M,D),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,!0===s&&this._onChangeCallback(),this}setFromQuaternion(t,n,s){return sf.makeRotationFromQuaternion(t),this.setFromRotationMatrix(sf,n,s)}setFromVector3(t,n=this._order){return this.set(t.x,t.y,t.z,n)}reorder(t){return of.setFromEuler(this),this.setFromQuaternion(of,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],n=0){return t[n]=this._x,t[n+1]=this._y,t[n+2]=this._z,t[n+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return a.DEFAULT_ORDER="XYZ",a})();class af{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let Lh=0;const nm=new K,Ac=new gr,qo=new Bt,Eu=new K,Su=new K,Cb=new K,Cu=new gr,lf=new K(1,0,0),im=new K(0,1,0),bv=new K(0,0,1),rm={type:"added"},Ev={type:"removed"};let Tr=(()=>{class a extends Ja{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Lh++}),this.uuid=mr(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=a.DEFAULT_UP.clone();const t=new K,n=new il,s=new gr,l=new K(1,1,1);n._onChange(function u(){s.setFromEuler(n,!1)}),s._onChange(function d(){n.setFromQuaternion(s,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:s},scale:{configurable:!0,enumerable:!0,value:l},modelViewMatrix:{value:new Bt},normalMatrix:{value:new Dn}}),this.matrix=new Bt,this.matrixWorld=new Bt,this.matrixAutoUpdate=a.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=a.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new af,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,n){this.quaternion.setFromAxisAngle(t,n)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,n){return Ac.setFromAxisAngle(t,n),this.quaternion.multiply(Ac),this}rotateOnWorldAxis(t,n){return Ac.setFromAxisAngle(t,n),this.quaternion.premultiply(Ac),this}rotateX(t){return this.rotateOnAxis(lf,t)}rotateY(t){return this.rotateOnAxis(im,t)}rotateZ(t){return this.rotateOnAxis(bv,t)}translateOnAxis(t,n){return nm.copy(t).applyQuaternion(this.quaternion),this.position.add(nm.multiplyScalar(n)),this}translateX(t){return this.translateOnAxis(lf,t)}translateY(t){return this.translateOnAxis(im,t)}translateZ(t){return this.translateOnAxis(bv,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(qo.copy(this.matrixWorld).invert())}lookAt(t,n,s){t.isVector3?Eu.copy(t):Eu.set(t,n,s);const l=this.parent;this.updateWorldMatrix(!0,!1),Su.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?qo.lookAt(Su,Eu,this.up):qo.lookAt(Eu,Su,this.up),this.quaternion.setFromRotationMatrix(qo),l&&(qo.extractRotation(l.matrixWorld),Ac.setFromRotationMatrix(qo),this.quaternion.premultiply(Ac.invert()))}add(t){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(rm)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let s=0;s<arguments.length;s++)this.remove(arguments[s]);return this}const n=this.children.indexOf(t);return-1!==n&&(t.parent=null,this.children.splice(n,1),t.dispatchEvent(Ev)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const n=this.children[t];n.parent=null,n.dispatchEvent(Ev)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),qo.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),qo.multiply(t.parent.matrixWorld)),t.applyMatrix4(qo),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,n){if(this[t]===n)return this;for(let s=0,l=this.children.length;s<l;s++){const d=this.children[s].getObjectByProperty(t,n);if(void 0!==d)return d}}getObjectsByProperty(t,n){let s=[];this[t]===n&&s.push(this);for(let l=0,u=this.children.length;l<u;l++){const d=this.children[l].getObjectsByProperty(t,n);d.length>0&&(s=s.concat(d))}return s}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Su,t,Cb),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Su,Cu,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return t.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(t){t(this);const n=this.children;for(let s=0,l=n.length;s<l;s++)n[s].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const n=this.children;for(let s=0,l=n.length;s<l;s++)n[s].traverseVisible(t)}traverseAncestors(t){const n=this.parent;null!==n&&(t(n),n.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const n=this.children;for(let s=0,l=n.length;s<l;s++){const u=n[s];(!0===u.matrixWorldAutoUpdate||!0===t)&&u.updateMatrixWorld(t)}}updateWorldMatrix(t,n){const s=this.parent;if(!0===t&&null!==s&&!0===s.matrixWorldAutoUpdate&&s.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===n){const l=this.children;for(let u=0,d=l.length;u<d;u++){const p=l[u];!0===p.matrixWorldAutoUpdate&&p.updateWorldMatrix(!1,!0)}}}toJSON(t){const n=void 0===t||"string"==typeof t,s={};n&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},s.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const l={};function u(p,g){return void 0===p[g.uuid]&&(p[g.uuid]=g.toJSON(t)),g.uuid}if(l.uuid=this.uuid,l.type=this.type,""!==this.name&&(l.name=this.name),!0===this.castShadow&&(l.castShadow=!0),!0===this.receiveShadow&&(l.receiveShadow=!0),!1===this.visible&&(l.visible=!1),!1===this.frustumCulled&&(l.frustumCulled=!1),0!==this.renderOrder&&(l.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(l.userData=this.userData),l.layers=this.layers.mask,l.matrix=this.matrix.toArray(),l.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(l.matrixAutoUpdate=!1),this.isInstancedMesh&&(l.type="InstancedMesh",l.count=this.count,l.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(l.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?l.background=this.background.toJSON():this.background.isTexture&&(l.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(l.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){l.geometry=u(t.geometries,this.geometry);const p=this.geometry.parameters;if(void 0!==p&&void 0!==p.shapes){const g=p.shapes;if(Array.isArray(g))for(let _=0,M=g.length;_<M;_++)u(t.shapes,g[_]);else u(t.shapes,g)}}if(this.isSkinnedMesh&&(l.bindMode=this.bindMode,l.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(u(t.skeletons,this.skeleton),l.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const p=[];for(let g=0,_=this.material.length;g<_;g++)p.push(u(t.materials,this.material[g]));l.material=p}else l.material=u(t.materials,this.material);if(this.children.length>0){l.children=[];for(let p=0;p<this.children.length;p++)l.children.push(this.children[p].toJSON(t).object)}if(this.animations.length>0){l.animations=[];for(let p=0;p<this.animations.length;p++)l.animations.push(u(t.animations,this.animations[p]))}if(n){const p=d(t.geometries),g=d(t.materials),_=d(t.textures),M=d(t.images),w=d(t.shapes),E=d(t.skeletons),D=d(t.animations),F=d(t.nodes);p.length>0&&(s.geometries=p),g.length>0&&(s.materials=g),_.length>0&&(s.textures=_),M.length>0&&(s.images=M),w.length>0&&(s.shapes=w),E.length>0&&(s.skeletons=E),D.length>0&&(s.animations=D),F.length>0&&(s.nodes=F)}return s.object=l,s;function d(p){const g=[];for(const _ in p){const M=p[_];delete M.metadata,g.push(M)}return g}}clone(t){return(new this.constructor).copy(this,t)}copy(t,n=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),!0===n)for(let s=0;s<t.children.length;s++)this.add(t.children[s].clone());return this}}return a.DEFAULT_UP=new K(0,1,0),a.DEFAULT_MATRIX_AUTO_UPDATE=!0,a.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,a})();const Yo=new K,rl=new K,sm=new K,sl=new K,Dc=new K,kl=new K,om=new K,Oh=new K,am=new K,lm=new K;let Fh=!1;class Fs{constructor(e=new K,t=new K,n=new K){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,s){s.subVectors(n,t),Yo.subVectors(e,t),s.cross(Yo);const l=s.lengthSq();return l>0?s.multiplyScalar(1/Math.sqrt(l)):s.set(0,0,0)}static getBarycoord(e,t,n,s,l){Yo.subVectors(s,t),rl.subVectors(n,t),sm.subVectors(e,t);const u=Yo.dot(Yo),d=Yo.dot(rl),p=Yo.dot(sm),g=rl.dot(rl),_=rl.dot(sm),M=u*g-d*d;if(0===M)return l.set(-2,-1,-1);const w=1/M,E=(g*p-d*_)*w,D=(u*_-d*p)*w;return l.set(1-E-D,D,E)}static containsPoint(e,t,n,s){return this.getBarycoord(e,t,n,s,sl),sl.x>=0&&sl.y>=0&&sl.x+sl.y<=1}static getUV(e,t,n,s,l,u,d,p){return!1===Fh&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),Fh=!0),this.getInterpolation(e,t,n,s,l,u,d,p)}static getInterpolation(e,t,n,s,l,u,d,p){return this.getBarycoord(e,t,n,s,sl),p.setScalar(0),p.addScaledVector(l,sl.x),p.addScaledVector(u,sl.y),p.addScaledVector(d,sl.z),p}static isFrontFacing(e,t,n,s){return Yo.subVectors(n,t),rl.subVectors(e,t),Yo.cross(rl).dot(s)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,s){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,t,n,s){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,s),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Yo.subVectors(this.c,this.b),rl.subVectors(this.a,this.b),.5*Yo.cross(rl).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Fs.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Fs.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,n,s,l){return!1===Fh&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),Fh=!0),Fs.getInterpolation(e,this.a,this.b,this.c,t,n,s,l)}getInterpolation(e,t,n,s,l){return Fs.getInterpolation(e,this.a,this.b,this.c,t,n,s,l)}containsPoint(e){return Fs.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Fs.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,s=this.b,l=this.c;let u,d;Dc.subVectors(s,n),kl.subVectors(l,n),Oh.subVectors(e,n);const p=Dc.dot(Oh),g=kl.dot(Oh);if(p<=0&&g<=0)return t.copy(n);am.subVectors(e,s);const _=Dc.dot(am),M=kl.dot(am);if(_>=0&&M<=_)return t.copy(s);const w=p*M-_*g;if(w<=0&&p>=0&&_<=0)return u=p/(p-_),t.copy(n).addScaledVector(Dc,u);lm.subVectors(e,l);const E=Dc.dot(lm),D=kl.dot(lm);if(D>=0&&E<=D)return t.copy(l);const F=E*g-p*D;if(F<=0&&g>=0&&D<=0)return d=g/(g-D),t.copy(n).addScaledVector(kl,d);const P=_*D-E*M;if(P<=0&&M-_>=0&&E-D>=0)return om.subVectors(l,s),d=(M-_)/(M-_+(E-D)),t.copy(s).addScaledVector(om,d);const R=1/(P+F+w);return u=F*R,d=w*R,t.copy(n).addScaledVector(Dc,u).addScaledVector(kl,d)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let Rc=0;class ol extends Ja{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Rc++}),this.uuid=mr(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=S,this.stencilZFail=S,this.stencilZPass=S,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const n=e[t];if(void 0===n){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const s=this[t];void 0!==s?s&&s.isColor?s.set(n):s&&s.isVector3&&n&&n.isVector3?s.copy(n):this[t]=n:console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function s(l){const u=[];for(const d in l){const p=l[d];delete p.metadata,u.push(p)}return u}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(n.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),0!==this.side&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaHash&&(n.alphaHash=this.alphaHash),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.forceSinglePass&&(n.forceSinglePass=this.forceSinglePass),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),t){const l=s(e.textures),u=s(e.images);l.length>0&&(n.textures=l),u.length>0&&(n.images=u)}return n}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(null!==t){const s=t.length;n=new Array(s);for(let l=0;l!==s;++l)n[l]=t[l].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}const cm={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Zo={h:0,s:0,l:0},Ic={h:0,s:0,l:0};function um(a,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?a+6*(e-a)*t:t<.5?e:t<2/3?a+6*(e-a)*(2/3-t):a}class pt{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(void 0===t&&void 0===n){const s=e;s&&s.isColor?this.copy(s):"number"==typeof s?this.setHex(s):"string"==typeof s&&this.setStyle(s)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=rn){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,Ms.toWorkingColorSpace(this,t),this}setRGB(e,t,n,s=Ms.workingColorSpace){return this.r=e,this.g=t,this.b=n,Ms.toWorkingColorSpace(this,s),this}setHSL(e,t,n,s=Ms.workingColorSpace){if(e=zi(e,1),t=Ti(t,0,1),n=Ti(n,0,1),0===t)this.r=this.g=this.b=n;else{const l=n<=.5?n*(1+t):n+t-n*t,u=2*n-l;this.r=um(u,l,e+1/3),this.g=um(u,l,e),this.b=um(u,l,e-1/3)}return Ms.toWorkingColorSpace(this,s),this}setStyle(e,t=rn){function n(l){void 0!==l&&parseFloat(l)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let s;if(s=/^(\w+)\(([^\)]*)\)/.exec(e)){let l;const d=s[2];switch(s[1]){case"rgb":case"rgba":if(l=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(d))return n(l[4]),this.setRGB(Math.min(255,parseInt(l[1],10))/255,Math.min(255,parseInt(l[2],10))/255,Math.min(255,parseInt(l[3],10))/255,t);if(l=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(d))return n(l[4]),this.setRGB(Math.min(100,parseInt(l[1],10))/100,Math.min(100,parseInt(l[2],10))/100,Math.min(100,parseInt(l[3],10))/100,t);break;case"hsl":case"hsla":if(l=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(d))return n(l[4]),this.setHSL(parseFloat(l[1])/360,parseFloat(l[2])/100,parseFloat(l[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(e)){const l=s[1],u=l.length;if(3===u)return this.setRGB(parseInt(l.charAt(0),16)/15,parseInt(l.charAt(1),16)/15,parseInt(l.charAt(2),16)/15,t);if(6===u)return this.setHex(parseInt(l,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=rn){const n=cm[e.toLowerCase()];return void 0!==n?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Ea(e.r),this.g=Ea(e.g),this.b=Ea(e.b),this}copyLinearToSRGB(e){return this.r=Ch(e.r),this.g=Ch(e.g),this.b=Ch(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=rn){return Ms.fromWorkingColorSpace(Qr.copy(this),e),65536*Math.round(Ti(255*Qr.r,0,255))+256*Math.round(Ti(255*Qr.g,0,255))+Math.round(Ti(255*Qr.b,0,255))}getHexString(e=rn){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Ms.workingColorSpace){Ms.fromWorkingColorSpace(Qr.copy(this),t);const n=Qr.r,s=Qr.g,l=Qr.b,u=Math.max(n,s,l),d=Math.min(n,s,l);let p,g;const _=(d+u)/2;if(d===u)p=0,g=0;else{const M=u-d;switch(g=_<=.5?M/(u+d):M/(2-u-d),u){case n:p=(s-l)/M+(s<l?6:0);break;case s:p=(l-n)/M+2;break;case l:p=(n-s)/M+4}p/=6}return e.h=p,e.s=g,e.l=_,e}getRGB(e,t=Ms.workingColorSpace){return Ms.fromWorkingColorSpace(Qr.copy(this),t),e.r=Qr.r,e.g=Qr.g,e.b=Qr.b,e}getStyle(e=rn){Ms.fromWorkingColorSpace(Qr.copy(this),e);const t=Qr.r,n=Qr.g,s=Qr.b;return e!==rn?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${s.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*n)},${Math.round(255*s)})`}offsetHSL(e,t,n){return this.getHSL(Zo),Zo.h+=e,Zo.s+=t,Zo.l+=n,this.setHSL(Zo.h,Zo.s,Zo.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(Zo),e.getHSL(Ic);const n=Yd(Zo.h,Ic.h,t),s=Yd(Zo.s,Ic.s,t),l=Yd(Zo.l,Ic.l,t);return this.setHSL(n,s,l),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,s=this.b,l=e.elements;return this.r=l[0]*t+l[3]*n+l[6]*s,this.g=l[1]*t+l[4]*n+l[7]*s,this.b=l[2]*t+l[5]*n+l[8]*s,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Qr=new pt;pt.NAMES=cm;class Ko extends ol{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new pt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const qi=new K,Tu=new ke;class vr{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=n,this.usage=35044,this.updateRange={offset:0,count:-1},this.gpuType=an,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let s=0,l=this.itemSize;s<l;s++)this.array[e+s]=t.array[n+s];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)Tu.fromBufferAttribute(this,t),Tu.applyMatrix3(e),this.setXY(t,Tu.x,Tu.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)qi.fromBufferAttribute(this,t),qi.applyMatrix3(e),this.setXYZ(t,qi.x,qi.y,qi.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)qi.fromBufferAttribute(this,t),qi.applyMatrix4(e),this.setXYZ(t,qi.x,qi.y,qi.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)qi.fromBufferAttribute(this,t),qi.applyNormalMatrix(e),this.setXYZ(t,qi.x,qi.y,qi.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)qi.fromBufferAttribute(this,t),qi.transformDirection(e),this.setXYZ(t,qi.x,qi.y,qi.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=Cr(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=An(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Cr(t,this.array)),t}setX(e,t){return this.normalized&&(t=An(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Cr(t,this.array)),t}setY(e,t){return this.normalized&&(t=An(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Cr(t,this.array)),t}setZ(e,t){return this.normalized&&(t=An(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Cr(t,this.array)),t}setW(e,t){return this.normalized&&(t=An(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=An(t,this.array),n=An(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,s){return e*=this.itemSize,this.normalized&&(t=An(t,this.array),n=An(n,this.array),s=An(s,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=s,this}setXYZW(e,t,n,s,l){return e*=this.itemSize,this.normalized&&(t=An(t,this.array),n=An(n,this.array),s=An(s,this.array),l=An(l,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=s,this.array[e+3]=l,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}}class hm extends vr{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class uf extends vr{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class It extends vr{constructor(e,t,n){super(new Float32Array(e),t,n)}}let Z_=0;const wo=new Bt,Cv=new Tr,Du=new K,us=new Qa,Pc=new Qa,Ar=new K;class Sn extends Ja{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Z_++}),this.uuid=mr(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(_v(e)?uf:hm)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const l=(new Dn).getNormalMatrix(e);n.applyNormalMatrix(l),n.needsUpdate=!0}const s=this.attributes.tangent;return void 0!==s&&(s.transformDirection(e),s.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return wo.makeRotationFromQuaternion(e),this.applyMatrix4(wo),this}rotateX(e){return wo.makeRotationX(e),this.applyMatrix4(wo),this}rotateY(e){return wo.makeRotationY(e),this.applyMatrix4(wo),this}rotateZ(e){return wo.makeRotationZ(e),this.applyMatrix4(wo),this}translate(e,t,n){return wo.makeTranslation(e,t,n),this.applyMatrix4(wo),this}scale(e,t,n){return wo.makeScale(e,t,n),this.applyMatrix4(wo),this}lookAt(e){return Cv.lookAt(e),Cv.updateMatrix(),this.applyMatrix4(Cv.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Du).negate(),this.translate(Du.x,Du.y,Du.z),this}setFromPoints(e){const t=[];for(let n=0,s=e.length;n<s;n++){const l=e[n];t.push(l.x,l.y,l.z||0)}return this.setAttribute("position",new It(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Qa);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new K(-1/0,-1/0,-1/0),new K(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,s=t.length;n<s;n++)us.setFromBufferAttribute(t[n]),this.morphTargetsRelative?(Ar.addVectors(this.boundingBox.min,us.min),this.boundingBox.expandByPoint(Ar),Ar.addVectors(this.boundingBox.max,us.max),this.boundingBox.expandByPoint(Ar)):(this.boundingBox.expandByPoint(us.min),this.boundingBox.expandByPoint(us.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new $o);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new K,1/0);if(e){const n=this.boundingSphere.center;if(us.setFromBufferAttribute(e),t)for(let l=0,u=t.length;l<u;l++)Pc.setFromBufferAttribute(t[l]),this.morphTargetsRelative?(Ar.addVectors(us.min,Pc.min),us.expandByPoint(Ar),Ar.addVectors(us.max,Pc.max),us.expandByPoint(Ar)):(us.expandByPoint(Pc.min),us.expandByPoint(Pc.max));us.getCenter(n);let s=0;for(let l=0,u=e.count;l<u;l++)Ar.fromBufferAttribute(e,l),s=Math.max(s,n.distanceToSquared(Ar));if(t)for(let l=0,u=t.length;l<u;l++){const d=t[l],p=this.morphTargetsRelative;for(let g=0,_=d.count;g<_;g++)Ar.fromBufferAttribute(d,g),p&&(Du.fromBufferAttribute(e,g),Ar.add(Du)),s=Math.max(s,n.distanceToSquared(Ar))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=e.array,s=t.position.array,l=t.normal.array,u=t.uv.array,d=s.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new vr(new Float32Array(4*d),4));const p=this.getAttribute("tangent").array,g=[],_=[];for(let f=0;f<d;f++)g[f]=new K,_[f]=new K;const M=new K,w=new K,E=new K,D=new ke,F=new ke,P=new ke,R=new K,V=new K;function k(f,x,b){M.fromArray(s,3*f),w.fromArray(s,3*x),E.fromArray(s,3*b),D.fromArray(u,2*f),F.fromArray(u,2*x),P.fromArray(u,2*b),w.sub(M),E.sub(M),F.sub(D),P.sub(D);const C=1/(F.x*P.y-P.x*F.y);!isFinite(C)||(R.copy(w).multiplyScalar(P.y).addScaledVector(E,-F.y).multiplyScalar(C),V.copy(E).multiplyScalar(F.x).addScaledVector(w,-P.x).multiplyScalar(C),g[f].add(R),g[x].add(R),g[b].add(R),_[f].add(V),_[x].add(V),_[b].add(V))}let W=this.groups;0===W.length&&(W=[{start:0,count:n.length}]);for(let f=0,x=W.length;f<x;++f){const b=W[f],C=b.start;for(let N=C,G=C+b.count;N<G;N+=3)k(n[N+0],n[N+1],n[N+2])}const i=new K,r=new K,o=new K,c=new K;function h(f){o.fromArray(l,3*f),c.copy(o);const x=g[f];i.copy(x),i.sub(o.multiplyScalar(o.dot(x))).normalize(),r.crossVectors(c,x);const C=r.dot(_[f])<0?-1:1;p[4*f]=i.x,p[4*f+1]=i.y,p[4*f+2]=i.z,p[4*f+3]=C}for(let f=0,x=W.length;f<x;++f){const b=W[f],C=b.start;for(let N=C,G=C+b.count;N<G;N+=3)h(n[N+0]),h(n[N+1]),h(n[N+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new vr(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let w=0,E=n.count;w<E;w++)n.setXYZ(w,0,0,0);const s=new K,l=new K,u=new K,d=new K,p=new K,g=new K,_=new K,M=new K;if(e)for(let w=0,E=e.count;w<E;w+=3){const D=e.getX(w+0),F=e.getX(w+1),P=e.getX(w+2);s.fromBufferAttribute(t,D),l.fromBufferAttribute(t,F),u.fromBufferAttribute(t,P),_.subVectors(u,l),M.subVectors(s,l),_.cross(M),d.fromBufferAttribute(n,D),p.fromBufferAttribute(n,F),g.fromBufferAttribute(n,P),d.add(_),p.add(_),g.add(_),n.setXYZ(D,d.x,d.y,d.z),n.setXYZ(F,p.x,p.y,p.z),n.setXYZ(P,g.x,g.y,g.z)}else for(let w=0,E=t.count;w<E;w+=3)s.fromBufferAttribute(t,w+0),l.fromBufferAttribute(t,w+1),u.fromBufferAttribute(t,w+2),_.subVectors(u,l),M.subVectors(s,l),_.cross(M),n.setXYZ(w+0,_.x,_.y,_.z),n.setXYZ(w+1,_.x,_.y,_.z),n.setXYZ(w+2,_.x,_.y,_.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Ar.fromBufferAttribute(e,t),Ar.normalize(),e.setXYZ(t,Ar.x,Ar.y,Ar.z)}toNonIndexed(){function e(d,p){const g=d.array,_=d.itemSize,M=d.normalized,w=new g.constructor(p.length*_);let E=0,D=0;for(let F=0,P=p.length;F<P;F++){E=d.isInterleavedBufferAttribute?p[F]*d.data.stride+d.offset:p[F]*_;for(let R=0;R<_;R++)w[D++]=g[E++]}return new vr(w,_,M)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Sn,n=this.index.array,s=this.attributes;for(const d in s){const g=e(s[d],n);t.setAttribute(d,g)}const l=this.morphAttributes;for(const d in l){const p=[],g=l[d];for(let _=0,M=g.length;_<M;_++){const E=e(g[_],n);p.push(E)}t.morphAttributes[d]=p}t.morphTargetsRelative=this.morphTargetsRelative;const u=this.groups;for(let d=0,p=u.length;d<p;d++){const g=u[d];t.addGroup(g.start,g.count,g.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const p=this.parameters;for(const g in p)void 0!==p[g]&&(e[g]=p[g]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const p in n)e.data.attributes[p]=n[p].toJSON(e.data);const s={};let l=!1;for(const p in this.morphAttributes){const g=this.morphAttributes[p],_=[];for(let M=0,w=g.length;M<w;M++)_.push(g[M].toJSON(e.data));_.length>0&&(s[p]=_,l=!0)}l&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);const u=this.groups;u.length>0&&(e.data.groups=JSON.parse(JSON.stringify(u)));const d=this.boundingSphere;return null!==d&&(e.data.boundingSphere={center:d.center.toArray(),radius:d.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone(t));const s=e.attributes;for(const g in s)this.setAttribute(g,s[g].clone(t));const l=e.morphAttributes;for(const g in l){const _=[],M=l[g];for(let w=0,E=M.length;w<E;w++)_.push(M[w].clone(t));this.morphAttributes[g]=_}this.morphTargetsRelative=e.morphTargetsRelative;const u=e.groups;for(let g=0,_=u.length;g<_;g++){const M=u[g];this.addGroup(M.start,M.count,M.materialIndex)}const d=e.boundingBox;null!==d&&(this.boundingBox=d.clone());const p=e.boundingSphere;return null!==p&&(this.boundingSphere=p.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const fm=new Bt,Qs=new bu,hf=new $o,Tv=new K,Ru=new K,Iu=new K,Pu=new K,Qo=new K,al=new K,Nh=new ke,df=new ke,ff=new ke,Av=new K,Dv=new K,Rv=new K,kh=new K,pf=new K;class Yi extends Tr{constructor(e=new Sn,t=new Ko){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const s=t[n[0]];if(void 0!==s){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let l=0,u=s.length;l<u;l++){const d=s[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[d]=l}}}}getVertexPosition(e,t){const n=this.geometry,l=n.morphAttributes.position,u=n.morphTargetsRelative;t.fromBufferAttribute(n.attributes.position,e);const d=this.morphTargetInfluences;if(l&&d){al.set(0,0,0);for(let p=0,g=l.length;p<g;p++){const _=d[p],M=l[p];0!==_&&(Qo.fromBufferAttribute(M,e),al.addScaledVector(u?Qo:Qo.sub(t),_))}t.add(al)}return t}raycast(e,t){const n=this.geometry,l=this.matrixWorld;void 0!==this.material&&(null===n.boundingSphere&&n.computeBoundingSphere(),hf.copy(n.boundingSphere),hf.applyMatrix4(l),Qs.copy(e.ray).recast(e.near),(!1!==hf.containsPoint(Qs.origin)||!(null===Qs.intersectSphere(hf,Tv)||Qs.origin.distanceToSquared(Tv)>(e.far-e.near)**2))&&(fm.copy(l).invert(),Qs.copy(e.ray).applyMatrix4(fm),(null===n.boundingBox||!1!==Qs.intersectsBox(n.boundingBox))&&this._computeIntersections(e,t,Qs)))}_computeIntersections(e,t,n){let s;const l=this.geometry,u=this.material,d=l.index,p=l.attributes.position,g=l.attributes.uv,_=l.attributes.uv1,M=l.attributes.normal,w=l.groups,E=l.drawRange;if(null!==d)if(Array.isArray(u))for(let D=0,F=w.length;D<F;D++){const P=w[D],R=u[P.materialIndex];for(let W=Math.max(P.start,E.start),i=Math.min(d.count,Math.min(P.start+P.count,E.start+E.count));W<i;W+=3)s=mf(this,R,e,n,g,_,M,d.getX(W),d.getX(W+1),d.getX(W+2)),s&&(s.faceIndex=Math.floor(W/3),s.face.materialIndex=P.materialIndex,t.push(s))}else for(let P=Math.max(0,E.start),R=Math.min(d.count,E.start+E.count);P<R;P+=3)s=mf(this,u,e,n,g,_,M,d.getX(P),d.getX(P+1),d.getX(P+2)),s&&(s.faceIndex=Math.floor(P/3),t.push(s));else if(void 0!==p)if(Array.isArray(u))for(let D=0,F=w.length;D<F;D++){const P=w[D],R=u[P.materialIndex];for(let W=Math.max(P.start,E.start),i=Math.min(p.count,Math.min(P.start+P.count,E.start+E.count));W<i;W+=3)s=mf(this,R,e,n,g,_,M,W,W+1,W+2),s&&(s.faceIndex=Math.floor(W/3),s.face.materialIndex=P.materialIndex,t.push(s))}else for(let P=Math.max(0,E.start),R=Math.min(p.count,E.start+E.count);P<R;P+=3)s=mf(this,u,e,n,g,_,M,P,P+1,P+2),s&&(s.faceIndex=Math.floor(P/3),t.push(s))}}function mf(a,e,t,n,s,l,u,d,p,g){a.getVertexPosition(d,Ru),a.getVertexPosition(p,Iu),a.getVertexPosition(g,Pu);const _=function K_(a,e,t,n,s,l,u,d){let p;if(p=1===e.side?n.intersectTriangle(u,l,s,!0,d):n.intersectTriangle(s,l,u,0===e.side,d),null===p)return null;pf.copy(d),pf.applyMatrix4(a.matrixWorld);const g=t.ray.origin.distanceTo(pf);return g<t.near||g>t.far?null:{distance:g,point:pf.clone(),object:a}}(a,e,t,n,Ru,Iu,Pu,kh);if(_){s&&(Nh.fromBufferAttribute(s,d),df.fromBufferAttribute(s,p),ff.fromBufferAttribute(s,g),_.uv=Fs.getInterpolation(kh,Ru,Iu,Pu,Nh,df,ff,new ke)),l&&(Nh.fromBufferAttribute(l,d),df.fromBufferAttribute(l,p),ff.fromBufferAttribute(l,g),_.uv1=Fs.getInterpolation(kh,Ru,Iu,Pu,Nh,df,ff,new ke),_.uv2=_.uv1),u&&(Av.fromBufferAttribute(u,d),Dv.fromBufferAttribute(u,p),Rv.fromBufferAttribute(u,g),_.normal=Fs.getInterpolation(kh,Ru,Iu,Pu,Av,Dv,Rv,new K),_.normal.dot(n.direction)>0&&_.normal.multiplyScalar(-1));const M={a:d,b:p,c:g,normal:new K,materialIndex:0};Fs.getNormal(Ru,Iu,Pu,M.normal),_.face=M}return _}class Lu extends Sn{constructor(e=1,t=1,n=1,s=1,l=1,u=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:s,heightSegments:l,depthSegments:u};const d=this;s=Math.floor(s),l=Math.floor(l),u=Math.floor(u);const p=[],g=[],_=[],M=[];let w=0,E=0;function D(F,P,R,V,k,W,i,r,o,c,h){const f=W/o,x=i/c,b=W/2,C=i/2,L=r/2,N=o+1,G=c+1;let X=0,Z=0;const re=new K;for(let ce=0;ce<G;ce++){const ie=ce*x-C;for(let de=0;de<N;de++)re[F]=(de*f-b)*V,re[P]=ie*k,re[R]=L,g.push(re.x,re.y,re.z),re[F]=0,re[P]=0,re[R]=r>0?1:-1,_.push(re.x,re.y,re.z),M.push(de/o),M.push(1-ce/c),X+=1}for(let ce=0;ce<c;ce++)for(let ie=0;ie<o;ie++){const he=w+ie+N*(ce+1),be=w+(ie+1)+N*(ce+1),Pe=w+(ie+1)+N*ce;p.push(w+ie+N*ce,he,Pe),p.push(he,be,Pe),Z+=6}d.addGroup(E,Z,h),E+=Z,w+=X}D("z","y","x",-1,-1,n,t,e,u,l,0),D("z","y","x",1,-1,n,t,-e,u,l,1),D("x","z","y",1,1,e,n,t,s,u,2),D("x","z","y",1,-1,e,n,-t,s,u,3),D("x","y","z",1,-1,e,t,n,s,l,4),D("x","y","z",-1,-1,e,t,-n,s,l,5),this.setIndex(p),this.setAttribute("position",new It(g,3)),this.setAttribute("normal",new It(_,3)),this.setAttribute("uv",new It(M,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Lu(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Ou(a){const e={};for(const t in a){e[t]={};for(const n in a[t]){const s=a[t][n];s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?s.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=s.clone():e[t][n]=Array.isArray(s)?s.slice():s}}return e}function Dr(a){const e={};for(let t=0;t<a.length;t++){const n=Ou(a[t]);for(const s in n)e[s]=n[s]}return e}function ea(a){return null===a.getRenderTarget()?a.outputColorSpace:Nr}const Uh={clone:Ou,merge:Dr};class eo extends ol{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Ou(e.uniforms),this.uniformsGroups=function Iv(a){const e=[];for(let t=0;t<a.length;t++)e.push(a[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const s in this.uniforms){const u=this.uniforms[s].value;t.uniforms[s]=u&&u.isTexture?{type:"t",value:u.toJSON(e).uuid}:u&&u.isColor?{type:"c",value:u.getHex()}:u&&u.isVector2?{type:"v2",value:u.toArray()}:u&&u.isVector3?{type:"v3",value:u.toArray()}:u&&u.isVector4?{type:"v4",value:u.toArray()}:u&&u.isMatrix3?{type:"m3",value:u.toArray()}:u&&u.isMatrix4?{type:"m4",value:u.toArray()}:{value:u}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const s in this.extensions)!0===this.extensions[s]&&(n[s]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class Ov extends Tr{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Bt,this.projectionMatrix=new Bt,this.projectionMatrixInverse=new Bt,this.coordinateSystem=xs}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class Br extends Ov{constructor(e=50,t=1,n=.1,s=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=s,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*yu*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*yo*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*yu*Math.atan(Math.tan(.5*yo*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,n,s,l,u){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=s,this.view.width=l,this.view.height=u,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*yo*this.fov)/this.zoom,n=2*t,s=this.aspect*n,l=-.5*s;const u=this.view;if(null!==this.view&&this.view.enabled){const p=u.fullWidth,g=u.fullHeight;l+=u.offsetX*s/p,t-=u.offsetY*n/g,s*=u.width/p,n*=u.height/g}const d=this.filmOffset;0!==d&&(l+=e*d/this.getFilmWidth()),this.projectionMatrix.makePerspective(l,l+s,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class pm extends Tr{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null;const s=new Br(-90,1,e,t);s.layers=this.layers,this.add(s);const l=new Br(-90,1,e,t);l.layers=this.layers,this.add(l);const u=new Br(-90,1,e,t);u.layers=this.layers,this.add(u);const d=new Br(-90,1,e,t);d.layers=this.layers,this.add(d);const p=new Br(-90,1,e,t);p.layers=this.layers,this.add(p);const g=new Br(-90,1,e,t);g.layers=this.layers,this.add(g)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,s,l,u,d,p]=t;for(const g of t)this.remove(g);if(e===xs)n.up.set(0,1,0),n.lookAt(1,0,0),s.up.set(0,1,0),s.lookAt(-1,0,0),l.up.set(0,0,-1),l.lookAt(0,1,0),u.up.set(0,0,1),u.lookAt(0,-1,0),d.up.set(0,1,0),d.lookAt(0,0,1),p.up.set(0,1,0),p.lookAt(0,0,-1);else{if(2001!==e)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);n.up.set(0,-1,0),n.lookAt(-1,0,0),s.up.set(0,-1,0),s.lookAt(1,0,0),l.up.set(0,0,1),l.lookAt(0,1,0),u.up.set(0,0,-1),u.lookAt(0,-1,0),d.up.set(0,-1,0),d.lookAt(0,0,1),p.up.set(0,-1,0),p.lookAt(0,0,-1)}for(const g of t)this.add(g),g.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const n=this.renderTarget;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,l,u,d,p,g]=this.children,_=e.getRenderTarget(),M=e.xr.enabled;e.xr.enabled=!1;const w=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,s),e.setRenderTarget(n,1),e.render(t,l),e.setRenderTarget(n,2),e.render(t,u),e.setRenderTarget(n,3),e.render(t,d),e.setRenderTarget(n,4),e.render(t,p),n.texture.generateMipmaps=w,e.setRenderTarget(n,5),e.render(t,g),e.setRenderTarget(_),e.xr.enabled=M,n.texture.needsPMREMUpdate=!0}}class Fu extends ws{constructor(e,t,n,s,l,u,d,p,g,_){super(e=void 0!==e?e:[],t=void 0!==t?t:301,n,s,l,u,d,p,g,_),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Db extends bc{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},s=[n,n,n,n,n,n];void 0!==t.encoding&&(Kd("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===Wo?rn:""),this.texture=new Fu(s,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:fi}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n_uniforms={tEquirect:{value:null}},n_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",n_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",s=new Lu(5,5,5),l=new eo({name:"CubemapFromEquirect",uniforms:Ou(n_uniforms),vertexShader:n_vertexShader,fragmentShader:n_fragmentShader,side:1,blending:0});l.uniforms.tEquirect.value=t;const u=new Yi(s,l),d=t.minFilter;return t.minFilter===gs&&(t.minFilter=fi),new pm(1,10,this).update(e,u),t.minFilter=d,u.geometry.dispose(),u.material.dispose(),this}clear(e,t,n,s){const l=e.getRenderTarget();for(let u=0;u<6;u++)e.setRenderTarget(this,u),e.clear(t,n,s);e.setRenderTarget(l)}}const Fv=new K,Nv=new K,J_=new Dn;class Vl{constructor(e=new K(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,s){return this.normal.set(e,t,n),this.constant=s,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const s=Fv.subVectors(n,t).cross(Nv.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(s,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(Fv),s=this.normal.dot(n);if(0===s)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const l=-(e.start.dot(this.normal)+this.constant)/s;return l<0||l>1?null:t.copy(e.start).addScaledVector(n,l)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||J_.getNormalMatrix(e),s=this.coplanarPoint(Fv).applyMatrix4(e),l=this.normal.applyMatrix3(n).normalize();return this.constant=-s.dot(l),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Lc=new $o,gf=new K;class vf{constructor(e=new Vl,t=new Vl,n=new Vl,s=new Vl,l=new Vl,u=new Vl){this.planes=[e,t,n,s,l,u]}set(e,t,n,s,l,u){const d=this.planes;return d[0].copy(e),d[1].copy(t),d[2].copy(n),d[3].copy(s),d[4].copy(l),d[5].copy(u),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=xs){const n=this.planes,s=e.elements,l=s[0],u=s[1],d=s[2],p=s[3],g=s[4],_=s[5],M=s[6],w=s[7],E=s[8],D=s[9],F=s[10],P=s[11],R=s[12],V=s[13],k=s[14],W=s[15];if(n[0].setComponents(p-l,w-g,P-E,W-R).normalize(),n[1].setComponents(p+l,w+g,P+E,W+R).normalize(),n[2].setComponents(p+u,w+_,P+D,W+V).normalize(),n[3].setComponents(p-u,w-_,P-D,W-V).normalize(),n[4].setComponents(p-d,w-M,P-F,W-k).normalize(),t===xs)n[5].setComponents(p+d,w+M,P+F,W+k).normalize();else{if(2001!==t)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);n[5].setComponents(d,M,F,k).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),Lc.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),Lc.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Lc)}intersectsSprite(e){return Lc.center.set(0,0,0),Lc.radius=.7071067811865476,Lc.applyMatrix4(e.matrixWorld),this.intersectsSphere(Lc)}intersectsSphere(e){const t=this.planes,n=e.center,s=-e.radius;for(let l=0;l<6;l++)if(t[l].distanceToPoint(n)<s)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const s=t[n];if(gf.x=s.normal.x>0?e.max.x:e.min.x,gf.y=s.normal.y>0?e.max.y:e.min.y,gf.z=s.normal.z>0?e.max.z:e.min.z,s.distanceToPoint(gf)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function Vh(){let a=null,e=!1,t=null,n=null;function s(l,u){t(l,u),n=a.requestAnimationFrame(s)}return{start:function(){!0!==e&&null!==t&&(n=a.requestAnimationFrame(s),e=!0)},stop:function(){a.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(l){t=l},setContext:function(l){a=l}}}function kv(a,e){const t=e.isWebGL2,n=new WeakMap;return{get:function u(g){return g.isInterleavedBufferAttribute&&(g=g.data),n.get(g)},remove:function d(g){g.isInterleavedBufferAttribute&&(g=g.data);const _=n.get(g);_&&(a.deleteBuffer(_.buffer),n.delete(g))},update:function p(g,_){if(g.isGLBufferAttribute){const w=n.get(g);return void((!w||w.version<g.version)&&n.set(g,{buffer:g.buffer,type:g.type,bytesPerElement:g.elementSize,version:g.version}))}g.isInterleavedBufferAttribute&&(g=g.data);const M=n.get(g);void 0===M?n.set(g,function s(g,_){const M=g.array,w=g.usage,E=a.createBuffer();let D;if(a.bindBuffer(_,E),a.bufferData(_,M,w),g.onUploadCallback(),M instanceof Float32Array)D=a.FLOAT;else if(M instanceof Uint16Array)if(g.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");D=a.HALF_FLOAT}else D=a.UNSIGNED_SHORT;else if(M instanceof Int16Array)D=a.SHORT;else if(M instanceof Uint32Array)D=a.UNSIGNED_INT;else if(M instanceof Int32Array)D=a.INT;else if(M instanceof Int8Array)D=a.BYTE;else if(M instanceof Uint8Array)D=a.UNSIGNED_BYTE;else{if(!(M instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+M);D=a.UNSIGNED_BYTE}return{buffer:E,type:D,bytesPerElement:M.BYTES_PER_ELEMENT,version:g.version}}(g,_)):M.version<g.version&&(function l(g,_,M){const w=_.array,E=_.updateRange;a.bindBuffer(M,g),-1===E.count?a.bufferSubData(M,0,w):(t?a.bufferSubData(M,E.offset*w.BYTES_PER_ELEMENT,w,E.offset,E.count):a.bufferSubData(M,E.offset*w.BYTES_PER_ELEMENT,w.subarray(E.offset,E.offset+E.count)),E.count=-1),_.onUploadCallback()}(M.buffer,g,_),M.version=g.version)}}}class ll extends Sn{constructor(e=1,t=1,n=1,s=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:s};const l=e/2,u=t/2,d=Math.floor(n),p=Math.floor(s),g=d+1,_=p+1,M=e/d,w=t/p,E=[],D=[],F=[],P=[];for(let R=0;R<_;R++){const V=R*w-u;for(let k=0;k<g;k++)D.push(k*M-l,-V,0),F.push(0,0,1),P.push(k/d),P.push(1-R/p)}for(let R=0;R<p;R++)for(let V=0;V<d;V++){const W=V+g*(R+1),i=V+1+g*(R+1),r=V+1+g*R;E.push(V+g*R,W,r),E.push(W,i,r)}this.setIndex(E),this.setAttribute("position",new It(D,3)),this.setAttribute("normal",new It(F,3)),this.setAttribute("uv",new It(P,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ll(e.width,e.height,e.widthSegments,e.heightSegments)}}const Rn={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tanisotropyV /= material.anisotropy;\n\tmaterial.anisotropy = saturate( material.anisotropy );\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometry.viewDir, geometry.normal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, vMapUv );\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},bt={common:{diffuse:{value:new pt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Dn},alphaMap:{value:null},alphaMapTransform:{value:new Dn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Dn}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Dn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Dn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Dn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Dn},normalScale:{value:new ke(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Dn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Dn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Dn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Dn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new pt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new pt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Dn},alphaTest:{value:0},uvTransform:{value:new Dn}},sprite:{diffuse:{value:new pt(16777215)},opacity:{value:1},center:{value:new ke(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Dn},alphaMap:{value:null},alphaMapTransform:{value:new Dn},alphaTest:{value:0}}},ul={basic:{uniforms:Dr([bt.common,bt.specularmap,bt.envmap,bt.aomap,bt.lightmap,bt.fog]),vertexShader:Rn.meshbasic_vert,fragmentShader:Rn.meshbasic_frag},lambert:{uniforms:Dr([bt.common,bt.specularmap,bt.envmap,bt.aomap,bt.lightmap,bt.emissivemap,bt.bumpmap,bt.normalmap,bt.displacementmap,bt.fog,bt.lights,{emissive:{value:new pt(0)}}]),vertexShader:Rn.meshlambert_vert,fragmentShader:Rn.meshlambert_frag},phong:{uniforms:Dr([bt.common,bt.specularmap,bt.envmap,bt.aomap,bt.lightmap,bt.emissivemap,bt.bumpmap,bt.normalmap,bt.displacementmap,bt.fog,bt.lights,{emissive:{value:new pt(0)},specular:{value:new pt(1118481)},shininess:{value:30}}]),vertexShader:Rn.meshphong_vert,fragmentShader:Rn.meshphong_frag},standard:{uniforms:Dr([bt.common,bt.envmap,bt.aomap,bt.lightmap,bt.emissivemap,bt.bumpmap,bt.normalmap,bt.displacementmap,bt.roughnessmap,bt.metalnessmap,bt.fog,bt.lights,{emissive:{value:new pt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Rn.meshphysical_vert,fragmentShader:Rn.meshphysical_frag},toon:{uniforms:Dr([bt.common,bt.aomap,bt.lightmap,bt.emissivemap,bt.bumpmap,bt.normalmap,bt.displacementmap,bt.gradientmap,bt.fog,bt.lights,{emissive:{value:new pt(0)}}]),vertexShader:Rn.meshtoon_vert,fragmentShader:Rn.meshtoon_frag},matcap:{uniforms:Dr([bt.common,bt.bumpmap,bt.normalmap,bt.displacementmap,bt.fog,{matcap:{value:null}}]),vertexShader:Rn.meshmatcap_vert,fragmentShader:Rn.meshmatcap_frag},points:{uniforms:Dr([bt.points,bt.fog]),vertexShader:Rn.points_vert,fragmentShader:Rn.points_frag},dashed:{uniforms:Dr([bt.common,bt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Rn.linedashed_vert,fragmentShader:Rn.linedashed_frag},depth:{uniforms:Dr([bt.common,bt.displacementmap]),vertexShader:Rn.depth_vert,fragmentShader:Rn.depth_frag},normal:{uniforms:Dr([bt.common,bt.bumpmap,bt.normalmap,bt.displacementmap,{opacity:{value:1}}]),vertexShader:Rn.meshnormal_vert,fragmentShader:Rn.meshnormal_frag},sprite:{uniforms:Dr([bt.sprite,bt.fog]),vertexShader:Rn.sprite_vert,fragmentShader:Rn.sprite_frag},background:{uniforms:{uvTransform:{value:new Dn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Rn.background_vert,fragmentShader:Rn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Rn.backgroundCube_vert,fragmentShader:Rn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Rn.cube_vert,fragmentShader:Rn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Rn.equirect_vert,fragmentShader:Rn.equirect_frag},distanceRGBA:{uniforms:Dr([bt.common,bt.displacementmap,{referencePosition:{value:new K},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Rn.distanceRGBA_vert,fragmentShader:Rn.distanceRGBA_frag},shadow:{uniforms:Dr([bt.lights,bt.fog,{color:{value:new pt(0)},opacity:{value:1}}]),vertexShader:Rn.shadow_vert,fragmentShader:Rn.shadow_frag}};ul.physical={uniforms:Dr([ul.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Dn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Dn},clearcoatNormalScale:{value:new ke(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Dn},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Dn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Dn},sheen:{value:0},sheenColor:{value:new pt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Dn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Dn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Dn},transmissionSamplerSize:{value:new ke},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Dn},attenuationDistance:{value:0},attenuationColor:{value:new pt(0)},specularColor:{value:new pt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Dn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Dn},anisotropyVector:{value:new ke},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Dn}}]),vertexShader:Rn.meshphysical_vert,fragmentShader:Rn.meshphysical_frag};const jh={r:0,b:0,g:0};function lE(a,e,t,n,s,l,u){const d=new pt(0);let g,_,p=!0===l?0:1,M=null,w=0,E=null;function F(P,R){P.getRGB(jh,ea(a)),n.buffers.color.setClear(jh.r,jh.g,jh.b,R,u)}return{getClearColor:function(){return d},setClearColor:function(P,R=1){d.set(P),p=R,F(d,p)},getClearAlpha:function(){return p},setClearAlpha:function(P){p=P,F(d,p)},render:function D(P,R){let V=!1,k=!0===R.isScene?R.background:null;switch(k&&k.isTexture&&(k=(R.backgroundBlurriness>0?t:e).get(k)),null===k?F(d,p):k&&k.isColor&&(F(k,1),V=!0),a.xr.getEnvironmentBlendMode()){case"opaque":V=!0;break;case"additive":n.buffers.color.setClear(0,0,0,1,u),V=!0;break;case"alpha-blend":n.buffers.color.setClear(0,0,0,0,u),V=!0}(a.autoClear||V)&&a.clear(a.autoClearColor,a.autoClearDepth,a.autoClearStencil),k&&(k.isCubeTexture||306===k.mapping)?(void 0===_&&(_=new Yi(new Lu(1,1,1),new eo({name:"BackgroundCubeMaterial",uniforms:Ou(ul.backgroundCube.uniforms),vertexShader:ul.backgroundCube.vertexShader,fragmentShader:ul.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),_.geometry.deleteAttribute("normal"),_.geometry.deleteAttribute("uv"),_.onBeforeRender=function(r,o,c){this.matrixWorld.copyPosition(c.matrixWorld)},Object.defineProperty(_.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),s.update(_)),_.material.uniforms.envMap.value=k,_.material.uniforms.flipEnvMap.value=k.isCubeTexture&&!1===k.isRenderTargetTexture?-1:1,_.material.uniforms.backgroundBlurriness.value=R.backgroundBlurriness,_.material.uniforms.backgroundIntensity.value=R.backgroundIntensity,_.material.toneMapped=k.colorSpace!==rn,(M!==k||w!==k.version||E!==a.toneMapping)&&(_.material.needsUpdate=!0,M=k,w=k.version,E=a.toneMapping),_.layers.enableAll(),P.unshift(_,_.geometry,_.material,0,0,null)):k&&k.isTexture&&(void 0===g&&(g=new Yi(new ll(2,2),new eo({name:"BackgroundMaterial",uniforms:Ou(ul.background.uniforms),vertexShader:ul.background.vertexShader,fragmentShader:ul.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),g.geometry.deleteAttribute("normal"),Object.defineProperty(g.material,"map",{get:function(){return this.uniforms.t2D.value}}),s.update(g)),g.material.uniforms.t2D.value=k,g.material.uniforms.backgroundIntensity.value=R.backgroundIntensity,g.material.toneMapped=k.colorSpace!==rn,!0===k.matrixAutoUpdate&&k.updateMatrix(),g.material.uniforms.uvTransform.value.copy(k.matrix),(M!==k||w!==k.version||E!==a.toneMapping)&&(g.material.needsUpdate=!0,M=k,w=k.version,E=a.toneMapping),g.layers.enableAll(),P.unshift(g,g.geometry,g.material,0,0,null))}}}function Yx(a,e,t,n){const s=a.getParameter(a.MAX_VERTEX_ATTRIBS),l=n.isWebGL2?null:e.get("OES_vertex_array_object"),u=n.isWebGL2||null!==l,d={},p=P(null);let g=p,_=!1;function E(L){return n.isWebGL2?a.bindVertexArray(L):l.bindVertexArrayOES(L)}function D(L){return n.isWebGL2?a.deleteVertexArray(L):l.deleteVertexArrayOES(L)}function P(L){const N=[],G=[],X=[];for(let Z=0;Z<s;Z++)N[Z]=0,G[Z]=0,X[Z]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:N,enabledAttributes:G,attributeDivisors:X,object:L,attributes:{},index:null}}function k(){const L=g.newAttributes;for(let N=0,G=L.length;N<G;N++)L[N]=0}function W(L){i(L,0)}function i(L,N){const X=g.enabledAttributes,Z=g.attributeDivisors;g.newAttributes[L]=1,0===X[L]&&(a.enableVertexAttribArray(L),X[L]=1),Z[L]!==N&&((n.isWebGL2?a:e.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](L,N),Z[L]=N)}function r(){const L=g.newAttributes,N=g.enabledAttributes;for(let G=0,X=N.length;G<X;G++)N[G]!==L[G]&&(a.disableVertexAttribArray(G),N[G]=0)}function o(L,N,G,X,Z,re,ce){!0===ce?a.vertexAttribIPointer(L,N,G,Z,re):a.vertexAttribPointer(L,N,G,X,Z,re)}function b(){C(),_=!0,g!==p&&(g=p,E(g.object))}function C(){p.geometry=null,p.program=null,p.wireframe=!1}return{setup:function M(L,N,G,X,Z){let re=!1;if(u){const ce=function F(L,N,G){const X=!0===G.wireframe;let Z=d[L.id];void 0===Z&&(Z={},d[L.id]=Z);let re=Z[N.id];void 0===re&&(re={},Z[N.id]=re);let ce=re[X];return void 0===ce&&(ce=P(function w(){return n.isWebGL2?a.createVertexArray():l.createVertexArrayOES()}()),re[X]=ce),ce}(X,G,N);g!==ce&&(g=ce,E(g.object)),re=function R(L,N,G,X){const Z=g.attributes,re=N.attributes;let ce=0;const ie=G.getAttributes();for(const de in ie)if(ie[de].location>=0){const be=Z[de];let Pe=re[de];if(void 0===Pe&&("instanceMatrix"===de&&L.instanceMatrix&&(Pe=L.instanceMatrix),"instanceColor"===de&&L.instanceColor&&(Pe=L.instanceColor)),void 0===be||be.attribute!==Pe||Pe&&be.data!==Pe.data)return!0;ce++}return g.attributesNum!==ce||g.index!==X}(L,X,G,Z),re&&function V(L,N,G,X){const Z={},re=N.attributes;let ce=0;const ie=G.getAttributes();for(const de in ie)if(ie[de].location>=0){let be=re[de];void 0===be&&("instanceMatrix"===de&&L.instanceMatrix&&(be=L.instanceMatrix),"instanceColor"===de&&L.instanceColor&&(be=L.instanceColor));const Pe={};Pe.attribute=be,be&&be.data&&(Pe.data=be.data),Z[de]=Pe,ce++}g.attributes=Z,g.attributesNum=ce,g.index=X}(L,X,G,Z)}else{const ce=!0===N.wireframe;(g.geometry!==X.id||g.program!==G.id||g.wireframe!==ce)&&(g.geometry=X.id,g.program=G.id,g.wireframe=ce,re=!0)}null!==Z&&t.update(Z,a.ELEMENT_ARRAY_BUFFER),(re||_)&&(_=!1,function c(L,N,G,X){if(!1===n.isWebGL2&&(L.isInstancedMesh||X.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;k();const Z=X.attributes,re=G.getAttributes(),ce=N.defaultAttributeValues;for(const ie in re){const de=re[ie];if(de.location>=0){let he=Z[ie];if(void 0===he&&("instanceMatrix"===ie&&L.instanceMatrix&&(he=L.instanceMatrix),"instanceColor"===ie&&L.instanceColor&&(he=L.instanceColor)),void 0!==he){const be=he.normalized,Pe=he.itemSize,ot=t.get(he);if(void 0===ot)continue;const St=ot.buffer,Pt=ot.type,Ln=ot.bytesPerElement,ri=!0===n.isWebGL2&&(Pt===a.INT||Pt===a.UNSIGNED_INT||1013===he.gpuType);if(he.isInterleavedBufferAttribute){const Qt=he.data,oe=Qt.stride,ct=he.offset;if(Qt.isInstancedInterleavedBuffer){for(let Fe=0;Fe<de.locationSize;Fe++)i(de.location+Fe,Qt.meshPerAttribute);!0!==L.isInstancedMesh&&void 0===X._maxInstanceCount&&(X._maxInstanceCount=Qt.meshPerAttribute*Qt.count)}else for(let Fe=0;Fe<de.locationSize;Fe++)W(de.location+Fe);a.bindBuffer(a.ARRAY_BUFFER,St);for(let Fe=0;Fe<de.locationSize;Fe++)o(de.location+Fe,Pe/de.locationSize,Pt,be,oe*Ln,(ct+Pe/de.locationSize*Fe)*Ln,ri)}else{if(he.isInstancedBufferAttribute){for(let Qt=0;Qt<de.locationSize;Qt++)i(de.location+Qt,he.meshPerAttribute);!0!==L.isInstancedMesh&&void 0===X._maxInstanceCount&&(X._maxInstanceCount=he.meshPerAttribute*he.count)}else for(let Qt=0;Qt<de.locationSize;Qt++)W(de.location+Qt);a.bindBuffer(a.ARRAY_BUFFER,St);for(let Qt=0;Qt<de.locationSize;Qt++)o(de.location+Qt,Pe/de.locationSize,Pt,be,Pe*Ln,Pe/de.locationSize*Qt*Ln,ri)}}else if(void 0!==ce){const be=ce[ie];if(void 0!==be)switch(be.length){case 2:a.vertexAttrib2fv(de.location,be);break;case 3:a.vertexAttrib3fv(de.location,be);break;case 4:a.vertexAttrib4fv(de.location,be);break;default:a.vertexAttrib1fv(de.location,be)}}}}r()}(L,N,G,X),null!==Z&&a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,t.get(Z).buffer))},reset:b,resetDefaultState:C,dispose:function h(){b();for(const L in d){const N=d[L];for(const G in N){const X=N[G];for(const Z in X)D(X[Z].object),delete X[Z];delete N[G]}delete d[L]}},releaseStatesOfGeometry:function f(L){if(void 0===d[L.id])return;const N=d[L.id];for(const G in N){const X=N[G];for(const Z in X)D(X[Z].object),delete X[Z];delete N[G]}delete d[L.id]},releaseStatesOfProgram:function x(L){for(const N in d){const G=d[N];if(void 0===G[L.id])continue;const X=G[L.id];for(const Z in X)D(X[Z].object),delete X[Z];delete G[L.id]}},initAttributes:k,enableAttribute:W,disableUnusedAttributes:r}}function Am(a,e,t,n){const s=n.isWebGL2;let l;this.setMode=function u(g){l=g},this.render=function d(g,_){a.drawArrays(l,g,_),t.update(_,l,1)},this.renderInstances=function p(g,_,M){if(0===M)return;let w,E;if(s)w=a,E="drawArraysInstanced";else if(w=e.get("ANGLE_instanced_arrays"),E="drawArraysInstancedANGLE",null===w)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");w[E](l,g,_,M),t.update(_,l,M)}}function ay(a,e,t){let n;function l(o){if("highp"===o){if(a.getShaderPrecisionFormat(a.VERTEX_SHADER,a.HIGH_FLOAT).precision>0&&a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.HIGH_FLOAT).precision>0)return"highp";o="mediump"}return"mediump"===o&&a.getShaderPrecisionFormat(a.VERTEX_SHADER,a.MEDIUM_FLOAT).precision>0&&a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const u="undefined"!=typeof WebGL2RenderingContext&&"WebGL2RenderingContext"===a.constructor.name;let d=void 0!==t.precision?t.precision:"highp";const p=l(d);p!==d&&(console.warn("THREE.WebGLRenderer:",d,"not supported, using",p,"instead."),d=p);const g=u||e.has("WEBGL_draw_buffers"),_=!0===t.logarithmicDepthBuffer,M=a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS),w=a.getParameter(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS),E=a.getParameter(a.MAX_TEXTURE_SIZE),D=a.getParameter(a.MAX_CUBE_MAP_TEXTURE_SIZE),F=a.getParameter(a.MAX_VERTEX_ATTRIBS),P=a.getParameter(a.MAX_VERTEX_UNIFORM_VECTORS),R=a.getParameter(a.MAX_VARYING_VECTORS),V=a.getParameter(a.MAX_FRAGMENT_UNIFORM_VECTORS),k=w>0,W=u||e.has("OES_texture_float");return{isWebGL2:u,drawBuffers:g,getMaxAnisotropy:function s(){if(void 0!==n)return n;if(!0===e.has("EXT_texture_filter_anisotropic")){const o=e.get("EXT_texture_filter_anisotropic");n=a.getParameter(o.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n},getMaxPrecision:l,precision:d,logarithmicDepthBuffer:_,maxTextures:M,maxVertexTextures:w,maxTextureSize:E,maxCubemapSize:D,maxAttributes:F,maxVertexUniforms:P,maxVaryings:R,maxFragmentUniforms:V,vertexTextures:k,floatFragmentTextures:W,floatVertexTextures:k&&W,maxSamples:u?a.getParameter(a.MAX_SAMPLES):0}}function Zx(a){const e=this;let t=null,n=0,s=!1,l=!1;const u=new Vl,d=new Dn,p={value:null,needsUpdate:!1};function _(M,w,E,D){const F=null!==M?M.length:0;let P=null;if(0!==F){if(P=p.value,!0!==D||null===P){const R=E+4*F,V=w.matrixWorldInverse;d.getNormalMatrix(V),(null===P||P.length<R)&&(P=new Float32Array(R));for(let k=0,W=E;k!==F;++k,W+=4)u.copy(M[k]).applyMatrix4(V,d),u.normal.toArray(P,W),P[W+3]=u.constant}p.value=P,p.needsUpdate=!0}return e.numPlanes=F,e.numIntersection=0,P}this.uniform=p,this.numPlanes=0,this.numIntersection=0,this.init=function(M,w){const E=0!==M.length||w||0!==n||s;return s=w,n=M.length,E},this.beginShadows=function(){l=!0,_(null)},this.endShadows=function(){l=!1},this.setGlobalState=function(M,w){t=_(M,w,0)},this.setState=function(M,w,E){const D=M.clippingPlanes,F=M.clipIntersection,P=M.clipShadows,R=a.get(M);if(!s||null===D||0===D.length||l&&!P)l?_(null):function g(){p.value!==t&&(p.value=t,p.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}();else{const V=l?0:n,k=4*V;let W=R.clippingState||null;p.value=W,W=_(D,w,k,E);for(let i=0;i!==k;++i)W[i]=t[i];R.clippingState=W,this.numIntersection=F?this.numPlanes:0,this.numPlanes+=V}}}function Kx(a){let e=new WeakMap;function t(u,d){return 303===d?u.mapping=301:304===d&&(u.mapping=302),u}function s(u){const d=u.target;d.removeEventListener("dispose",s);const p=e.get(d);void 0!==p&&(e.delete(d),p.dispose())}return{get:function n(u){if(u&&u.isTexture&&!1===u.isRenderTargetTexture){const d=u.mapping;if(303===d||304===d){if(e.has(u))return t(e.get(u).texture,u.mapping);{const p=u.image;if(p&&p.height>0){const g=new Db(p.height/2);return g.fromEquirectangularTexture(a,u),e.set(u,g),u.addEventListener("dispose",s),t(g.texture,u.mapping)}return null}}}return u},dispose:function l(){e=new WeakMap}}}class Ef extends Ov{constructor(e=-1,t=1,n=1,s=-1,l=.1,u=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=s,this.near=l,this.far=u,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,s,l,u){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=s,this.view.width=l,this.view.height=u,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,s=(this.top+this.bottom)/2;let l=n-e,u=n+e,d=s+t,p=s-t;if(null!==this.view&&this.view.enabled){const g=(this.right-this.left)/this.view.fullWidth/this.zoom,_=(this.top-this.bottom)/this.view.fullHeight/this.zoom;l+=g*this.view.offsetX,u=l+g*this.view.width,d-=_*this.view.offsetY,p=d-_*this.view.height}this.projectionMatrix.makeOrthographic(l,u,d,p,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const ly=[.125,.215,.35,.446,.526,.582],Dm=new Ef,cy=new pt;let Sf=null;const Gl=(1+Math.sqrt(5))/2,ku=1/Gl,ia=[new K(1,1,1),new K(-1,1,1),new K(1,1,-1),new K(-1,1,-1),new K(0,Gl,ku),new K(0,Gl,-ku),new K(ku,0,Gl),new K(-ku,0,Gl),new K(Gl,ku,0),new K(-Gl,ku,0)];class Cf{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,s=100){Sf=this._renderer.getRenderTarget(),this._setSize(256);const l=this._allocateTargets();return l.depthBuffer=!0,this._sceneToCubeUV(e,n,s,l),t>0&&this._blur(l,0,0,t),this._applyPMREM(l),this._cleanup(l),l}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=fy(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=dy(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Sf),e.scissorTest=!1,Rm(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(301===e.mapping||302===e.mapping?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),Sf=this._renderer.getRenderTarget();const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:fi,minFilter:fi,generateMipmaps:!1,type:Ha,format:Er,colorSpace:Nr,depthBuffer:!1},s=uy(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=uy(e,t,n);const{_lodMax:l}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function Jx(a){const e=[],t=[],n=[];let s=a;const l=a-4+1+ly.length;for(let u=0;u<l;u++){const d=Math.pow(2,s);t.push(d);let p=1/d;u>a-4?p=ly[u-a+4-1]:0===u&&(p=0),n.push(p);const g=1/(d-2),_=-g,M=1+g,w=[_,_,M,_,M,M,_,_,M,M,_,M],E=6,D=6,F=3,P=2,R=1,V=new Float32Array(F*D*E),k=new Float32Array(P*D*E),W=new Float32Array(R*D*E);for(let r=0;r<E;r++){const o=r%3*2/3-1,c=r>2?0:-1;V.set([o,c,0,o+2/3,c,0,o+2/3,c+1,0,o,c,0,o+2/3,c+1,0,o,c+1,0],F*D*r),k.set(w,P*D*r),W.set([r,r,r,r,r,r],R*D*r)}const i=new Sn;i.setAttribute("position",new vr(V,F)),i.setAttribute("uv",new vr(k,P)),i.setAttribute("faceIndex",new vr(W,R)),e.push(i),s>4&&s--}return{lodPlanes:e,sizeLods:t,sigmas:n}}(l)),this._blurMaterial=function hy(a,e,t){const n=new Float32Array(20),s=new K(0,1,0);return new eo({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${a}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:s}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(l,e,t)}return s}_compileMaterial(e){const t=new Yi(this._lodPlanes[0],e);this._renderer.compile(t,Dm)}_sceneToCubeUV(e,t,n,s){const d=new Br(90,1,t,n),p=[1,-1,1,1,1,1],g=[1,1,1,-1,-1,-1],_=this._renderer,M=_.autoClear,w=_.toneMapping;_.getClearColor(cy),_.toneMapping=0,_.autoClear=!1;const E=new Ko({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),D=new Yi(new Lu,E);let F=!1;const P=e.background;P?P.isColor&&(E.color.copy(P),e.background=null,F=!0):(E.color.copy(cy),F=!0);for(let R=0;R<6;R++){const V=R%3;0===V?(d.up.set(0,p[R],0),d.lookAt(g[R],0,0)):1===V?(d.up.set(0,0,p[R]),d.lookAt(0,g[R],0)):(d.up.set(0,p[R],0),d.lookAt(0,0,g[R]));const k=this._cubeSize;Rm(s,V*k,R>2?k:0,k,k),_.setRenderTarget(s),F&&_.render(D,d),_.render(e,d)}D.geometry.dispose(),D.material.dispose(),_.toneMapping=w,_.autoClear=M,e.background=P}_textureToCubeUV(e,t){const n=this._renderer,s=301===e.mapping||302===e.mapping;s?(null===this._cubemapMaterial&&(this._cubemapMaterial=fy()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=dy());const l=s?this._cubemapMaterial:this._equirectMaterial,u=new Yi(this._lodPlanes[0],l);l.uniforms.envMap.value=e;const p=this._cubeSize;Rm(t,0,0,3*p,2*p),n.setRenderTarget(t),n.render(u,Dm)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;for(let s=1;s<this._lodPlanes.length;s++){const l=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]);this._blur(e,s-1,s,l,ia[(s-1)%ia.length])}t.autoClear=n}_blur(e,t,n,s,l){const u=this._pingPongRenderTarget;this._halfBlur(e,u,t,n,s,"latitudinal",l),this._halfBlur(u,e,n,n,s,"longitudinal",l)}_halfBlur(e,t,n,s,l,u,d){const p=this._renderer,g=this._blurMaterial;"latitudinal"!==u&&"longitudinal"!==u&&console.error("blur direction must be either latitudinal or longitudinal!");const M=new Yi(this._lodPlanes[s],g),w=g.uniforms,E=this._sizeLods[n]-1,D=isFinite(l)?Math.PI/(2*E):2*Math.PI/39,F=l/D,P=isFinite(l)?1+Math.floor(3*F):20;P>20&&console.warn(`sigmaRadians, ${l}, is too large and will clip, as it requested ${P} samples when the maximum is set to 20`);const R=[];let V=0;for(let o=0;o<20;++o){const c=o/F,h=Math.exp(-c*c/2);R.push(h),0===o?V+=h:o<P&&(V+=2*h)}for(let o=0;o<R.length;o++)R[o]=R[o]/V;w.envMap.value=e.texture,w.samples.value=P,w.weights.value=R,w.latitudinal.value="latitudinal"===u,d&&(w.poleAxis.value=d);const{_lodMax:k}=this;w.dTheta.value=D,w.mipInt.value=k-n;const W=this._sizeLods[s];Rm(t,3*W*(s>k-4?s-k+4:0),4*(this._cubeSize-W),3*W,2*W),p.setRenderTarget(t),p.render(M,Dm)}}function uy(a,e,t){const n=new bc(a,e,t);return n.texture.mapping=306,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function Rm(a,e,t,n,s){a.viewport.set(e,t,n,s),a.scissor.set(e,t,n,s)}function dy(){return new eo({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function fy(){return new eo({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function Pm(a){let e=new WeakMap,t=null;function l(d){const p=d.target;p.removeEventListener("dispose",l);const g=e.get(p);void 0!==g&&(e.delete(p),g.dispose())}return{get:function n(d){if(d&&d.isTexture){const p=d.mapping,g=303===p||304===p,_=301===p||302===p;if(g||_){if(d.isRenderTargetTexture&&!0===d.needsPMREMUpdate){d.needsPMREMUpdate=!1;let M=e.get(d);return null===t&&(t=new Cf(a)),M=g?t.fromEquirectangular(d,M):t.fromCubemap(d,M),e.set(d,M),M.texture}if(e.has(d))return e.get(d).texture;{const M=d.image;if(g&&M&&M.height>0||_&&M&&function s(d){let p=0;for(let _=0;_<6;_++)void 0!==d[_]&&p++;return 6===p}(M)){null===t&&(t=new Cf(a));const w=g?t.fromEquirectangular(d):t.fromCubemap(d);return e.set(d,w),d.addEventListener("dispose",l),w.texture}return null}}}return d},dispose:function u(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function Qx(a){const e={};function t(n){if(void 0!==e[n])return e[n];let s;switch(n){case"WEBGL_depth_texture":s=a.getExtension("WEBGL_depth_texture")||a.getExtension("MOZ_WEBGL_depth_texture")||a.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":s=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":s=a.getExtension("WEBGL_compressed_texture_s3tc")||a.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":s=a.getExtension("WEBGL_compressed_texture_pvrtc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:s=a.getExtension(n)}return e[n]=s,s}return{has:function(n){return null!==t(n)},init:function(n){n.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(n){const s=t(n);return null===s&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),s}}}function eM(a,e,t,n){const s={},l=new WeakMap;function u(M){const w=M.target;null!==w.index&&e.remove(w.index);for(const D in w.attributes)e.remove(w.attributes[D]);for(const D in w.morphAttributes){const F=w.morphAttributes[D];for(let P=0,R=F.length;P<R;P++)e.remove(F[P])}w.removeEventListener("dispose",u),delete s[w.id];const E=l.get(w);E&&(e.remove(E),l.delete(w)),n.releaseStatesOfGeometry(w),!0===w.isInstancedBufferGeometry&&delete w._maxInstanceCount,t.memory.geometries--}function g(M){const w=[],E=M.index,D=M.attributes.position;let F=0;if(null!==E){const V=E.array;F=E.version;for(let k=0,W=V.length;k<W;k+=3){const i=V[k+0],r=V[k+1],o=V[k+2];w.push(i,r,r,o,o,i)}}else{if(void 0===D)return;F=D.version;for(let k=0,W=D.array.length/3-1;k<W;k+=3){const i=k+0,r=k+1,o=k+2;w.push(i,r,r,o,o,i)}}const P=new(_v(w)?uf:hm)(w,1);P.version=F;const R=l.get(M);R&&e.remove(R),l.set(M,P)}return{get:function d(M,w){return!0===s[w.id]||(w.addEventListener("dispose",u),s[w.id]=!0,t.memory.geometries++),w},update:function p(M){const w=M.attributes;for(const D in w)e.update(w[D],a.ARRAY_BUFFER);const E=M.morphAttributes;for(const D in E){const F=E[D];for(let P=0,R=F.length;P<R;P++)e.update(F[P],a.ARRAY_BUFFER)}},getWireframeAttribute:function _(M){const w=l.get(M);if(w){const E=M.index;null!==E&&w.version<E.version&&g(M)}else g(M);return l.get(M)}}}function Tf(a,e,t,n){const s=n.isWebGL2;let l,d,p;this.setMode=function u(w){l=w},this.setIndex=function g(w){d=w.type,p=w.bytesPerElement},this.render=function _(w,E){a.drawElements(l,E,d,w*p),t.update(E,l,1)},this.renderInstances=function M(w,E,D){if(0===D)return;let F,P;if(s)F=a,P="drawElementsInstanced";else if(F=e.get("ANGLE_instanced_arrays"),P="drawElementsInstancedANGLE",null===F)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");F[P](l,E,d,w*p,D),t.update(E,l,D)}}function Lm(a){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function s(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function n(l,u,d){switch(t.calls++,u){case a.TRIANGLES:t.triangles+=d*(l/3);break;case a.LINES:t.lines+=d*(l/2);break;case a.LINE_STRIP:t.lines+=d*(l-1);break;case a.LINE_LOOP:t.lines+=d*l;break;case a.POINTS:t.points+=d*l;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",u)}}}}function tM(a,e){return a[0]-e[0]}function Om(a,e){return Math.abs(e[1])-Math.abs(a[1])}function Fm(a,e,t){const n={},s=new Float32Array(8),l=new WeakMap,u=new ii,d=[];for(let g=0;g<8;g++)d[g]=[g,0];return{update:function p(g,_,M){const w=g.morphTargetInfluences;if(!0===e.isWebGL2){const E=_.morphAttributes.position||_.morphAttributes.normal||_.morphAttributes.color,D=void 0!==E?E.length:0;let F=l.get(_);if(void 0===F||F.count!==D){let L=function(){b.dispose(),l.delete(_),_.removeEventListener("dispose",L)};void 0!==F&&F.texture.dispose();const V=void 0!==_.morphAttributes.position,k=void 0!==_.morphAttributes.normal,W=void 0!==_.morphAttributes.color,i=_.morphAttributes.position||[],r=_.morphAttributes.normal||[],o=_.morphAttributes.color||[];let c=0;!0===V&&(c=1),!0===k&&(c=2),!0===W&&(c=3);let h=_.attributes.position.count*c,f=1;h>e.maxTextureSize&&(f=Math.ceil(h/e.maxTextureSize),h=e.maxTextureSize);const x=new Float32Array(h*f*4*D),b=new _u(x,h,f,D);b.type=an,b.needsUpdate=!0;const C=4*c;for(let N=0;N<D;N++){const G=i[N],X=r[N],Z=o[N],re=h*f*4*N;for(let ce=0;ce<G.count;ce++){const ie=ce*C;!0===V&&(u.fromBufferAttribute(G,ce),x[re+ie+0]=u.x,x[re+ie+1]=u.y,x[re+ie+2]=u.z,x[re+ie+3]=0),!0===k&&(u.fromBufferAttribute(X,ce),x[re+ie+4]=u.x,x[re+ie+5]=u.y,x[re+ie+6]=u.z,x[re+ie+7]=0),!0===W&&(u.fromBufferAttribute(Z,ce),x[re+ie+8]=u.x,x[re+ie+9]=u.y,x[re+ie+10]=u.z,x[re+ie+11]=4===Z.itemSize?u.w:1)}}F={count:D,texture:b,size:new ke(h,f)},l.set(_,F),_.addEventListener("dispose",L)}let P=0;for(let V=0;V<w.length;V++)P+=w[V];const R=_.morphTargetsRelative?1:1-P;M.getUniforms().setValue(a,"morphTargetBaseInfluence",R),M.getUniforms().setValue(a,"morphTargetInfluences",w),M.getUniforms().setValue(a,"morphTargetsTexture",F.texture,t),M.getUniforms().setValue(a,"morphTargetsTextureSize",F.size)}else{const E=void 0===w?0:w.length;let D=n[_.id];if(void 0===D||D.length!==E){D=[];for(let k=0;k<E;k++)D[k]=[k,0];n[_.id]=D}for(let k=0;k<E;k++){const W=D[k];W[0]=k,W[1]=w[k]}D.sort(Om);for(let k=0;k<8;k++)k<E&&D[k][1]?(d[k][0]=D[k][0],d[k][1]=D[k][1]):(d[k][0]=Number.MAX_SAFE_INTEGER,d[k][1]=0);d.sort(tM);const F=_.morphAttributes.position,P=_.morphAttributes.normal;let R=0;for(let k=0;k<8;k++){const W=d[k],i=W[0],r=W[1];i!==Number.MAX_SAFE_INTEGER&&r?(F&&_.getAttribute("morphTarget"+k)!==F[i]&&_.setAttribute("morphTarget"+k,F[i]),P&&_.getAttribute("morphNormal"+k)!==P[i]&&_.setAttribute("morphNormal"+k,P[i]),s[k]=r,R+=r):(F&&!0===_.hasAttribute("morphTarget"+k)&&_.deleteAttribute("morphTarget"+k),P&&!0===_.hasAttribute("morphNormal"+k)&&_.deleteAttribute("morphNormal"+k),s[k]=0)}const V=_.morphTargetsRelative?1:1-R;M.getUniforms().setValue(a,"morphTargetBaseInfluence",V),M.getUniforms().setValue(a,"morphTargetInfluences",s)}}}}function py(a,e,t,n){let s=new WeakMap;function d(p){const g=p.target;g.removeEventListener("dispose",d),t.remove(g.instanceMatrix),null!==g.instanceColor&&t.remove(g.instanceColor)}return{update:function l(p){const g=n.render.frame,M=e.get(p,p.geometry);if(s.get(M)!==g&&(e.update(M),s.set(M,g)),p.isInstancedMesh&&(!1===p.hasEventListener("dispose",d)&&p.addEventListener("dispose",d),s.get(p)!==g&&(t.update(p.instanceMatrix,a.ARRAY_BUFFER),null!==p.instanceColor&&t.update(p.instanceColor,a.ARRAY_BUFFER),s.set(p,g))),p.isSkinnedMesh){const w=p.skeleton;s.get(w)!==g&&(w.update(),s.set(w,g))}return M},dispose:function u(){s=new WeakMap}}}const nM=new ws,iM=new _u,Af=new Qp,rM=new Fu,my=[],Nm=[],km=new Float32Array(16),Um=new Float32Array(9),Bm=new Float32Array(4);function Nc(a,e,t){const n=a[0];if(n<=0||n>0)return a;const s=e*t;let l=my[s];if(void 0===l&&(l=new Float32Array(s),my[s]=l),0!==e){n.toArray(l,0);for(let u=1,d=0;u!==e;++u)d+=t,a[u].toArray(l,d)}return l}function _i(a,e){if(a.length!==e.length)return!1;for(let t=0,n=a.length;t<n;t++)if(a[t]!==e[t])return!1;return!0}function Zi(a,e){for(let t=0,n=e.length;t<n;t++)a[t]=e[t]}function Df(a,e){let t=Nm[e];void 0===t&&(t=new Int32Array(e),Nm[e]=t);for(let n=0;n!==e;++n)t[n]=a.allocateTextureUnit();return t}function sM(a,e){const t=this.cache;t[0]!==e&&(a.uniform1f(this.addr,e),t[0]=e)}function cE(a,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(a.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(_i(t,e))return;a.uniform2fv(this.addr,e),Zi(t,e)}}function Vm(a,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(a.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(a.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(_i(t,e))return;a.uniform3fv(this.addr,e),Zi(t,e)}}function gy(a,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(a.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(_i(t,e))return;a.uniform4fv(this.addr,e),Zi(t,e)}}function zm(a,e){const t=this.cache,n=e.elements;if(void 0===n){if(_i(t,e))return;a.uniformMatrix2fv(this.addr,!1,e),Zi(t,e)}else{if(_i(t,n))return;Bm.set(n),a.uniformMatrix2fv(this.addr,!1,Bm),Zi(t,n)}}function $h(a,e){const t=this.cache,n=e.elements;if(void 0===n){if(_i(t,e))return;a.uniformMatrix3fv(this.addr,!1,e),Zi(t,e)}else{if(_i(t,n))return;Um.set(n),a.uniformMatrix3fv(this.addr,!1,Um),Zi(t,n)}}function oM(a,e){const t=this.cache,n=e.elements;if(void 0===n){if(_i(t,e))return;a.uniformMatrix4fv(this.addr,!1,e),Zi(t,e)}else{if(_i(t,n))return;km.set(n),a.uniformMatrix4fv(this.addr,!1,km),Zi(t,n)}}function Hm(a,e){const t=this.cache;t[0]!==e&&(a.uniform1i(this.addr,e),t[0]=e)}function vy(a,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(a.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(_i(t,e))return;a.uniform2iv(this.addr,e),Zi(t,e)}}function yy(a,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(a.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(_i(t,e))return;a.uniform3iv(this.addr,e),Zi(t,e)}}function _y(a,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(a.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(_i(t,e))return;a.uniform4iv(this.addr,e),Zi(t,e)}}function aM(a,e){const t=this.cache;t[0]!==e&&(a.uniform1ui(this.addr,e),t[0]=e)}function Gm(a,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(a.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(_i(t,e))return;a.uniform2uiv(this.addr,e),Zi(t,e)}}function lM(a,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(a.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(_i(t,e))return;a.uniform3uiv(this.addr,e),Zi(t,e)}}function cM(a,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(a.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(_i(t,e))return;a.uniform4uiv(this.addr,e),Zi(t,e)}}function xy(a,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(a.uniform1i(this.addr,s),n[0]=s),t.setTexture2D(e||nM,s)}function Uu(a,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(a.uniform1i(this.addr,s),n[0]=s),t.setTexture3D(e||Af,s)}function My(a,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(a.uniform1i(this.addr,s),n[0]=s),t.setTextureCube(e||rM,s)}function uM(a,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(a.uniform1i(this.addr,s),n[0]=s),t.setTexture2DArray(e||iM,s)}function Bu(a,e){a.uniform1fv(this.addr,e)}function dM(a,e){const t=Nc(e,this.size,2);a.uniform2fv(this.addr,t)}function fM(a,e){const t=Nc(e,this.size,3);a.uniform3fv(this.addr,t)}function pM(a,e){const t=Nc(e,this.size,4);a.uniform4fv(this.addr,t)}function mM(a,e){const t=Nc(e,this.size,4);a.uniformMatrix2fv(this.addr,!1,t)}function Ta(a,e){const t=Nc(e,this.size,9);a.uniformMatrix3fv(this.addr,!1,t)}function Wm(a,e){const t=Nc(e,this.size,16);a.uniformMatrix4fv(this.addr,!1,t)}function wy(a,e){a.uniform1iv(this.addr,e)}function by(a,e){a.uniform2iv(this.addr,e)}function Ey(a,e){a.uniform3iv(this.addr,e)}function Sy(a,e){a.uniform4iv(this.addr,e)}function gM(a,e){a.uniform1uiv(this.addr,e)}function vM(a,e){a.uniform2uiv(this.addr,e)}function yM(a,e){a.uniform3uiv(this.addr,e)}function _M(a,e){a.uniform4uiv(this.addr,e)}function Cy(a,e,t){const n=this.cache,s=e.length,l=Df(t,s);_i(n,l)||(a.uniform1iv(this.addr,l),Zi(n,l));for(let u=0;u!==s;++u)t.setTexture2D(e[u]||nM,l[u])}function uE(a,e,t){const n=this.cache,s=e.length,l=Df(t,s);_i(n,l)||(a.uniform1iv(this.addr,l),Zi(n,l));for(let u=0;u!==s;++u)t.setTexture3D(e[u]||Af,l[u])}function Ty(a,e,t){const n=this.cache,s=e.length,l=Df(t,s);_i(n,l)||(a.uniform1iv(this.addr,l),Zi(n,l));for(let u=0;u!==s;++u)t.setTextureCube(e[u]||rM,l[u])}function xM(a,e,t){const n=this.cache,s=e.length,l=Df(t,s);_i(n,l)||(a.uniform1iv(this.addr,l),Zi(n,l));for(let u=0;u!==s;++u)t.setTexture2DArray(e[u]||iM,l[u])}class hE{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function hM(a){switch(a){case 5126:return sM;case 35664:return cE;case 35665:return Vm;case 35666:return gy;case 35674:return zm;case 35675:return $h;case 35676:return oM;case 5124:case 35670:return Hm;case 35667:case 35671:return vy;case 35668:case 35672:return yy;case 35669:case 35673:return _y;case 5125:return aM;case 36294:return Gm;case 36295:return lM;case 36296:return cM;case 35678:case 36198:case 36298:case 36306:case 35682:return xy;case 35679:case 36299:case 36307:return Uu;case 35680:case 36300:case 36308:case 36293:return My;case 36289:case 36303:case 36311:case 36292:return uM}}(t.type)}}class dE{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function MM(a){switch(a){case 5126:return Bu;case 35664:return dM;case 35665:return fM;case 35666:return pM;case 35674:return mM;case 35675:return Ta;case 35676:return Wm;case 5124:case 35670:return wy;case 35667:case 35671:return by;case 35668:case 35672:return Ey;case 35669:case 35673:return Sy;case 5125:return gM;case 36294:return vM;case 36295:return yM;case 36296:return _M;case 35678:case 36198:case 36298:case 36306:case 35682:return Cy;case 35679:case 36299:case 36307:return uE;case 35680:case 36300:case 36308:case 36293:return Ty;case 36289:case 36303:case 36311:case 36292:return xM}}(t.type)}}class jm{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const s=this.seq;for(let l=0,u=s.length;l!==u;++l){const d=s[l];d.setValue(e,t[d.id],n)}}}const $m=/(\w+)(\])?(\[|\.)?/g;function Xm(a,e){a.seq.push(e),a.map[e.id]=e}function Ay(a,e,t){const n=a.name,s=n.length;for($m.lastIndex=0;;){const l=$m.exec(n),u=$m.lastIndex;let d=l[1];const g=l[3];if("]"===l[2]&&(d|=0),void 0===g||"["===g&&u+2===s){Xm(t,void 0===g?new hE(d,a,e):new dE(d,a,e));break}{let M=t.map[d];void 0===M&&(M=new jm(d),Xm(t,M)),t=M}}}class qm{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let s=0;s<n;++s){const l=e.getActiveUniform(t,s);Ay(l,e.getUniformLocation(t,l.name),this)}}setValue(e,t,n,s){const l=this.map[t];void 0!==l&&l.setValue(e,n,s)}setOptional(e,t,n){const s=t[n];void 0!==s&&this.setValue(e,n,s)}static upload(e,t,n,s){for(let l=0,u=t.length;l!==u;++l){const d=t[l],p=n[d.id];!1!==p.needsUpdate&&d.setValue(e,p.value,s)}}static seqWithValue(e,t){const n=[];for(let s=0,l=e.length;s!==l;++s){const u=e[s];u.id in t&&n.push(u)}return n}}function Eo(a,e,t){const n=a.createShader(e);return a.shaderSource(n,t),a.compileShader(n),n}let fE=0;function Ym(a,e,t){const n=a.getShaderParameter(e,a.COMPILE_STATUS),s=a.getShaderInfoLog(e).trim();if(n&&""===s)return"";const l=/ERROR: 0:(\d+)/.exec(s);if(l){const u=parseInt(l[1]);return t.toUpperCase()+"\n\n"+s+"\n\n"+function pE(a,e){const t=a.split("\n"),n=[],s=Math.max(e-6,0),l=Math.min(e+6,t.length);for(let u=s;u<l;u++){const d=u+1;n.push(`${d===e?">":" "} ${d}: ${t[u]}`)}return n.join("\n")}(a.getShaderSource(e),u)}return s}function Ry(a,e){const t=function Dy(a){switch(a){case Nr:return["Linear","( value )"];case rn:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",a),["Linear","( value )"]}}(e);return"vec4 "+a+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function wM(a,e){let t;switch(e){case 1:t="Linear";break;case 2:t="Reinhard";break;case 3:t="OptimizedCineon";break;case 4:t="ACESFilmic";break;case 5:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+a+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function Xh(a){return""!==a}function Rf(a,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return a.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Py(a,e){return a.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const bM=/^[ \t]*#include +<([\w\d./]+)>/gm;function Km(a){return a.replace(bM,SM)}const EM=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function SM(a,e){let t=Rn[e];if(void 0===t){const n=EM.get(e);if(void 0===n)throw new Error("Can not resolve #include <"+e+">");t=Rn[n],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n)}return Km(t)}const CM=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function qh(a){return a.replace(CM,Vu)}function Vu(a,e,t,n){let s="";for(let l=parseInt(e);l<parseInt(t);l++)s+=n.replace(/\[\s*i\s*\]/g,"[ "+l+" ]").replace(/UNROLLED_LOOP_INDEX/g,l);return s}function Ly(a){let e="precision "+a.precision+" float;\nprecision "+a.precision+" int;";return"highp"===a.precision?e+="\n#define HIGH_PRECISION":"mediump"===a.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===a.precision&&(e+="\n#define LOW_PRECISION"),e}function Zh(a,e,t,n){const s=a.getContext(),l=t.defines;let u=t.vertexShader,d=t.fragmentShader;const p=function Yh(a){let e="SHADOWMAP_TYPE_BASIC";return 1===a.shadowMapType?e="SHADOWMAP_TYPE_PCF":2===a.shadowMapType?e="SHADOWMAP_TYPE_PCF_SOFT":3===a.shadowMapType&&(e="SHADOWMAP_TYPE_VSM"),e}(t),g=function TM(a){let e="ENVMAP_TYPE_CUBE";if(a.envMap)switch(a.envMapMode){case 301:case 302:e="ENVMAP_TYPE_CUBE";break;case 306:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),_=function AM(a){let e="ENVMAP_MODE_REFLECTION";return a.envMap&&302===a.envMapMode&&(e="ENVMAP_MODE_REFRACTION"),e}(t),M=function Jm(a){let e="ENVMAP_BLENDING_NONE";if(a.envMap)switch(a.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD"}return e}(t),w=function Aa(a){const e=a.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:n,maxMip:t}}(t),E=t.isWebGL2?"":function mE(a){return[a.extensionDerivatives||a.envMapCubeUVHeight||a.bumpMap||a.normalMapTangentSpace||a.clearcoatNormalMap||a.flatShading||"physical"===a.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(a.extensionFragDepth||a.logarithmicDepthBuffer)&&a.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",a.extensionDrawBuffers&&a.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(a.extensionShaderTextureLOD||a.envMap||a.transmission)&&a.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Xh).join("\n")}(t),D=function Iy(a){const e=[];for(const t in a){const n=a[t];!1!==n&&e.push("#define "+t+" "+n)}return e.join("\n")}(l),F=s.createProgram();let P,R,V=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(P=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,D].filter(Xh).join("\n"),P.length>0&&(P+="\n"),R=[E,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,D].filter(Xh).join("\n"),R.length>0&&(R+="\n")):(P=[Ly(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,D,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+_:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+p:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Xh).join("\n"),R=[E,Ly(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,D,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+g:"",t.envMap?"#define "+_:"",t.envMap?"#define "+M:"",w?"#define CUBEUV_TEXEL_WIDTH "+w.texelWidth:"",w?"#define CUBEUV_TEXEL_HEIGHT "+w.texelHeight:"",w?"#define CUBEUV_MAX_MIP "+w.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+p:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==t.toneMapping?"#define TONE_MAPPING":"",0!==t.toneMapping?Rn.tonemapping_pars_fragment:"",0!==t.toneMapping?wM("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Rn.colorspace_pars_fragment,Ry("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(Xh).join("\n")),u=Km(u),u=Rf(u,t),u=Py(u,t),d=Km(d),d=Rf(d,t),d=Py(d,t),u=qh(u),d=qh(d),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(V="#version 300 es\n",P=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+P,R=["#define varying in","300 es"===t.glslVersion?"":"layout(location = 0) out highp vec4 pc_fragColor;","300 es"===t.glslVersion?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+R);const W=V+R+d,i=Eo(s,s.VERTEX_SHADER,V+P+u),r=Eo(s,s.FRAGMENT_SHADER,W);if(s.attachShader(F,i),s.attachShader(F,r),void 0!==t.index0AttributeName?s.bindAttribLocation(F,0,t.index0AttributeName):!0===t.morphTargets&&s.bindAttribLocation(F,0,"position"),s.linkProgram(F),a.debug.checkShaderErrors){const h=s.getProgramInfoLog(F).trim(),f=s.getShaderInfoLog(i).trim(),x=s.getShaderInfoLog(r).trim();let b=!0,C=!0;if(!1===s.getProgramParameter(F,s.LINK_STATUS))if(b=!1,"function"==typeof a.debug.onShaderError)a.debug.onShaderError(s,F,i,r);else{const L=Ym(s,i,"vertex"),N=Ym(s,r,"fragment");console.error("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(F,s.VALIDATE_STATUS)+"\n\nProgram Info Log: "+h+"\n"+L+"\n"+N)}else""!==h?console.warn("THREE.WebGLProgram: Program Info Log:",h):(""===f||""===x)&&(C=!1);C&&(this.diagnostics={runnable:b,programLog:h,vertexShader:{log:f,prefix:P},fragmentShader:{log:x,prefix:R}})}let o,c;return s.deleteShader(i),s.deleteShader(r),this.getUniforms=function(){return void 0===o&&(o=new qm(s,F)),o},this.getAttributes=function(){return void 0===c&&(c=function Zm(a,e){const t={},n=a.getProgramParameter(e,a.ACTIVE_ATTRIBUTES);for(let s=0;s<n;s++){const l=a.getActiveAttrib(e,s),u=l.name;let d=1;l.type===a.FLOAT_MAT2&&(d=2),l.type===a.FLOAT_MAT3&&(d=3),l.type===a.FLOAT_MAT4&&(d=4),t[u]={type:l.type,location:a.getAttribLocation(e,u),locationSize:d}}return t}(s,F)),c},this.destroy=function(){n.releaseStatesOfProgram(this),s.deleteProgram(F),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=fE++,this.cacheKey=e,this.usedTimes=1,this.program=F,this.vertexShader=i,this.fragmentShader=r,this}let hs=0;class kc{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.fragmentShader,s=this._getShaderStage(e.vertexShader),l=this._getShaderStage(n),u=this._getShaderCacheForMaterial(e);return!1===u.has(s)&&(u.add(s),s.usedTimes++),!1===u.has(l)&&(u.add(l),l.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return void 0===n&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return void 0===n&&(n=new If(e),t.set(e,n)),n}}class If{constructor(e){this.id=hs++,this.code=e,this.usedTimes=0}}function So(a,e,t,n,s,l,u){const d=new af,p=new kc,g=[],_=s.isWebGL2,M=s.logarithmicDepthBuffer,w=s.vertexTextures;let E=s.precision;const D={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function F(h){return 0===h?"uv":`uv${h}`}return{getParameters:function P(h,f,x,b,C){const L=b.fog,N=C.geometry,X=(h.isMeshStandardMaterial?t:e).get(h.envMap||(h.isMeshStandardMaterial?b.environment:null)),Z=X&&306===X.mapping?X.image.height:null,re=D[h.type];null!==h.precision&&(E=s.getMaxPrecision(h.precision),E!==h.precision&&console.warn("THREE.WebGLProgram.getParameters:",h.precision,"not supported, using",E,"instead."));const ce=N.morphAttributes.position||N.morphAttributes.normal||N.morphAttributes.color,ie=void 0!==ce?ce.length:0;let he,be,Pe,ot,de=0;if(void 0!==N.morphAttributes.position&&(de=1),void 0!==N.morphAttributes.normal&&(de=2),void 0!==N.morphAttributes.color&&(de=3),re){const ji=ul[re];he=ji.vertexShader,be=ji.fragmentShader}else he=h.vertexShader,be=h.fragmentShader,p.update(h),Pe=p.getVertexShaderID(h),ot=p.getFragmentShaderID(h);const St=a.getRenderTarget(),Pt=!0===C.isInstancedMesh,Ln=!!h.map,Qt=!!X,oe=!!h.aoMap,ct=!!h.lightMap,Fe=!!h.bumpMap,tt=!!h.normalMap,Ge=!!h.displacementMap,Xt=!!h.emissiveMap,Ft=!!h.metalnessMap,Vt=!!h.roughnessMap,fn=h.anisotropy>0,Xn=h.clearcoat>0,Ji=h.iridescence>0,ne=h.sheen>0,Y=h.transmission>0,Ee=fn&&!!h.anisotropyMap,at=Xn&&!!h.clearcoatMap,Ye=Xn&&!!h.clearcoatNormalMap,ut=Xn&&!!h.clearcoatRoughnessMap,Jt=Ji&&!!h.iridescenceMap,dt=Ji&&!!h.iridescenceThicknessMap,Ae=ne&&!!h.sheenColorMap,le=ne&&!!h.sheenRoughnessMap,We=!!h.specularMap,Rt=!!h.specularColorMap,wt=!!h.specularIntensityMap,At=Y&&!!h.transmissionMap,wn=Y&&!!h.thicknessMap,fe=!!h.alphaMap,it=!!h.extensions,Tt=!!N.attributes.uv1,Hn=!!N.attributes.uv2,xi=!!N.attributes.uv3;let Wi=0;return h.toneMapped&&(null===St||!0===St.isXRRenderTarget)&&(Wi=a.toneMapping),{isWebGL2:_,shaderID:re,shaderType:h.type,shaderName:h.name,vertexShader:he,fragmentShader:be,defines:h.defines,customVertexShaderID:Pe,customFragmentShaderID:ot,isRawShaderMaterial:!0===h.isRawShaderMaterial,glslVersion:h.glslVersion,precision:E,instancing:Pt,instancingColor:Pt&&null!==C.instanceColor,supportsVertexTextures:w,outputColorSpace:null===St?a.outputColorSpace:!0===St.isXRRenderTarget?St.texture.colorSpace:Nr,map:Ln,matcap:!!h.matcap,envMap:Qt,envMapMode:Qt&&X.mapping,envMapCubeUVHeight:Z,aoMap:oe,lightMap:ct,bumpMap:Fe,normalMap:tt,displacementMap:w&&Ge,emissiveMap:Xt,normalMapObjectSpace:tt&&1===h.normalMapType,normalMapTangentSpace:tt&&0===h.normalMapType,metalnessMap:Ft,roughnessMap:Vt,anisotropy:fn,anisotropyMap:Ee,clearcoat:Xn,clearcoatMap:at,clearcoatNormalMap:Ye,clearcoatRoughnessMap:ut,iridescence:Ji,iridescenceMap:Jt,iridescenceThicknessMap:dt,sheen:ne,sheenColorMap:Ae,sheenRoughnessMap:le,specularMap:We,specularColorMap:Rt,specularIntensityMap:wt,transmission:Y,transmissionMap:At,thicknessMap:wn,gradientMap:!!h.gradientMap,opaque:!1===h.transparent&&1===h.blending,alphaMap:fe,alphaTest:h.alphaTest>0,alphaHash:!!h.alphaHash,combine:h.combine,mapUv:Ln&&F(h.map.channel),aoMapUv:oe&&F(h.aoMap.channel),lightMapUv:ct&&F(h.lightMap.channel),bumpMapUv:Fe&&F(h.bumpMap.channel),normalMapUv:tt&&F(h.normalMap.channel),displacementMapUv:Ge&&F(h.displacementMap.channel),emissiveMapUv:Xt&&F(h.emissiveMap.channel),metalnessMapUv:Ft&&F(h.metalnessMap.channel),roughnessMapUv:Vt&&F(h.roughnessMap.channel),anisotropyMapUv:Ee&&F(h.anisotropyMap.channel),clearcoatMapUv:at&&F(h.clearcoatMap.channel),clearcoatNormalMapUv:Ye&&F(h.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:ut&&F(h.clearcoatRoughnessMap.channel),iridescenceMapUv:Jt&&F(h.iridescenceMap.channel),iridescenceThicknessMapUv:dt&&F(h.iridescenceThicknessMap.channel),sheenColorMapUv:Ae&&F(h.sheenColorMap.channel),sheenRoughnessMapUv:le&&F(h.sheenRoughnessMap.channel),specularMapUv:We&&F(h.specularMap.channel),specularColorMapUv:Rt&&F(h.specularColorMap.channel),specularIntensityMapUv:wt&&F(h.specularIntensityMap.channel),transmissionMapUv:At&&F(h.transmissionMap.channel),thicknessMapUv:wn&&F(h.thicknessMap.channel),alphaMapUv:fe&&F(h.alphaMap.channel),vertexTangents:!!N.attributes.tangent&&(tt||fn),vertexColors:h.vertexColors,vertexAlphas:!0===h.vertexColors&&!!N.attributes.color&&4===N.attributes.color.itemSize,vertexUv1s:Tt,vertexUv2s:Hn,vertexUv3s:xi,pointsUvs:!0===C.isPoints&&!!N.attributes.uv&&(Ln||fe),fog:!!L,useFog:!0===h.fog,fogExp2:L&&L.isFogExp2,flatShading:!0===h.flatShading,sizeAttenuation:!0===h.sizeAttenuation,logarithmicDepthBuffer:M,skinning:!0===C.isSkinnedMesh,morphTargets:void 0!==N.morphAttributes.position,morphNormals:void 0!==N.morphAttributes.normal,morphColors:void 0!==N.morphAttributes.color,morphTargetsCount:ie,morphTextureStride:de,numDirLights:f.directional.length,numPointLights:f.point.length,numSpotLights:f.spot.length,numSpotLightMaps:f.spotLightMap.length,numRectAreaLights:f.rectArea.length,numHemiLights:f.hemi.length,numDirLightShadows:f.directionalShadowMap.length,numPointLightShadows:f.pointShadowMap.length,numSpotLightShadows:f.spotShadowMap.length,numSpotLightShadowsWithMaps:f.numSpotLightShadowsWithMaps,numClippingPlanes:u.numPlanes,numClipIntersection:u.numIntersection,dithering:h.dithering,shadowMapEnabled:a.shadowMap.enabled&&x.length>0,shadowMapType:a.shadowMap.type,toneMapping:Wi,useLegacyLights:a._useLegacyLights,premultipliedAlpha:h.premultipliedAlpha,doubleSided:2===h.side,flipSided:1===h.side,useDepthPacking:h.depthPacking>=0,depthPacking:h.depthPacking||0,index0AttributeName:h.index0AttributeName,extensionDerivatives:it&&!0===h.extensions.derivatives,extensionFragDepth:it&&!0===h.extensions.fragDepth,extensionDrawBuffers:it&&!0===h.extensions.drawBuffers,extensionShaderTextureLOD:it&&!0===h.extensions.shaderTextureLOD,rendererExtensionFragDepth:_||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:_||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:_||n.has("EXT_shader_texture_lod"),customProgramCacheKey:h.customProgramCacheKey()}},getProgramCacheKey:function R(h){const f=[];if(h.shaderID?f.push(h.shaderID):(f.push(h.customVertexShaderID),f.push(h.customFragmentShaderID)),void 0!==h.defines)for(const x in h.defines)f.push(x),f.push(h.defines[x]);return!1===h.isRawShaderMaterial&&(function V(h,f){h.push(f.precision),h.push(f.outputColorSpace),h.push(f.envMapMode),h.push(f.envMapCubeUVHeight),h.push(f.mapUv),h.push(f.alphaMapUv),h.push(f.lightMapUv),h.push(f.aoMapUv),h.push(f.bumpMapUv),h.push(f.normalMapUv),h.push(f.displacementMapUv),h.push(f.emissiveMapUv),h.push(f.metalnessMapUv),h.push(f.roughnessMapUv),h.push(f.anisotropyMapUv),h.push(f.clearcoatMapUv),h.push(f.clearcoatNormalMapUv),h.push(f.clearcoatRoughnessMapUv),h.push(f.iridescenceMapUv),h.push(f.iridescenceThicknessMapUv),h.push(f.sheenColorMapUv),h.push(f.sheenRoughnessMapUv),h.push(f.specularMapUv),h.push(f.specularColorMapUv),h.push(f.specularIntensityMapUv),h.push(f.transmissionMapUv),h.push(f.thicknessMapUv),h.push(f.combine),h.push(f.fogExp2),h.push(f.sizeAttenuation),h.push(f.morphTargetsCount),h.push(f.morphAttributeCount),h.push(f.numDirLights),h.push(f.numPointLights),h.push(f.numSpotLights),h.push(f.numSpotLightMaps),h.push(f.numHemiLights),h.push(f.numRectAreaLights),h.push(f.numDirLightShadows),h.push(f.numPointLightShadows),h.push(f.numSpotLightShadows),h.push(f.numSpotLightShadowsWithMaps),h.push(f.shadowMapType),h.push(f.toneMapping),h.push(f.numClippingPlanes),h.push(f.numClipIntersection),h.push(f.depthPacking)}(f,h),function k(h,f){d.disableAll(),f.isWebGL2&&d.enable(0),f.supportsVertexTextures&&d.enable(1),f.instancing&&d.enable(2),f.instancingColor&&d.enable(3),f.matcap&&d.enable(4),f.envMap&&d.enable(5),f.normalMapObjectSpace&&d.enable(6),f.normalMapTangentSpace&&d.enable(7),f.clearcoat&&d.enable(8),f.iridescence&&d.enable(9),f.alphaTest&&d.enable(10),f.vertexColors&&d.enable(11),f.vertexAlphas&&d.enable(12),f.vertexUv1s&&d.enable(13),f.vertexUv2s&&d.enable(14),f.vertexUv3s&&d.enable(15),f.vertexTangents&&d.enable(16),f.anisotropy&&d.enable(17),h.push(d.mask),d.disableAll(),f.fog&&d.enable(0),f.useFog&&d.enable(1),f.flatShading&&d.enable(2),f.logarithmicDepthBuffer&&d.enable(3),f.skinning&&d.enable(4),f.morphTargets&&d.enable(5),f.morphNormals&&d.enable(6),f.morphColors&&d.enable(7),f.premultipliedAlpha&&d.enable(8),f.shadowMapEnabled&&d.enable(9),f.useLegacyLights&&d.enable(10),f.doubleSided&&d.enable(11),f.flipSided&&d.enable(12),f.useDepthPacking&&d.enable(13),f.dithering&&d.enable(14),f.transmission&&d.enable(15),f.sheen&&d.enable(16),f.opaque&&d.enable(17),f.pointsUvs&&d.enable(18),h.push(d.mask)}(f,h),f.push(a.outputColorSpace)),f.push(h.customProgramCacheKey),f.join()},getUniforms:function W(h){const f=D[h.type];let x;return x=f?Uh.clone(ul[f].uniforms):h.uniforms,x},acquireProgram:function i(h,f){let x;for(let b=0,C=g.length;b<C;b++){const L=g[b];if(L.cacheKey===f){x=L,++x.usedTimes;break}}return void 0===x&&(x=new Zh(a,f,h,l),g.push(x)),x},releaseProgram:function r(h){if(0==--h.usedTimes){const f=g.indexOf(h);g[f]=g[g.length-1],g.pop(),h.destroy()}},releaseShaderCache:function o(h){p.remove(h)},programs:g,dispose:function c(){p.dispose()}}}function Qm(){let a=new WeakMap;return{get:function e(l){let u=a.get(l);return void 0===u&&(u={},a.set(l,u)),u},remove:function t(l){a.delete(l)},update:function n(l,u,d){a.get(l)[u]=d},dispose:function s(){a=new WeakMap}}}function zu(a,e){return a.groupOrder!==e.groupOrder?a.groupOrder-e.groupOrder:a.renderOrder!==e.renderOrder?a.renderOrder-e.renderOrder:a.material.id!==e.material.id?a.material.id-e.material.id:a.z!==e.z?a.z-e.z:a.id-e.id}function Uc(a,e){return a.groupOrder!==e.groupOrder?a.groupOrder-e.groupOrder:a.renderOrder!==e.renderOrder?a.renderOrder-e.renderOrder:a.z!==e.z?e.z-a.z:a.id-e.id}function Bc(){const a=[];let e=0;const t=[],n=[],s=[];function u(M,w,E,D,F,P){let R=a[e];return void 0===R?(R={id:M.id,object:M,geometry:w,material:E,groupOrder:D,renderOrder:M.renderOrder,z:F,group:P},a[e]=R):(R.id=M.id,R.object=M,R.geometry=w,R.material=E,R.groupOrder=D,R.renderOrder=M.renderOrder,R.z=F,R.group=P),e++,R}return{opaque:t,transmissive:n,transparent:s,init:function l(){e=0,t.length=0,n.length=0,s.length=0},push:function d(M,w,E,D,F,P){const R=u(M,w,E,D,F,P);E.transmission>0?n.push(R):!0===E.transparent?s.push(R):t.push(R)},unshift:function p(M,w,E,D,F,P){const R=u(M,w,E,D,F,P);E.transmission>0?n.unshift(R):!0===E.transparent?s.unshift(R):t.unshift(R)},finish:function _(){for(let M=e,w=a.length;M<w;M++){const E=a[M];if(null===E.id)break;E.id=null,E.object=null,E.geometry=null,E.material=null,E.group=null}},sort:function g(M,w){t.length>1&&t.sort(M||zu),n.length>1&&n.sort(w||Uc),s.length>1&&s.sort(w||Uc)}}}function Hu(){let a=new WeakMap;return{get:function e(n,s){const l=a.get(n);let u;return void 0===l?(u=new Bc,a.set(n,[u])):s>=l.length?(u=new Bc,l.push(u)):u=l[s],u},dispose:function t(){a=new WeakMap}}}function Gu(){const a={};return{get:function(e){if(void 0!==a[e.id])return a[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new K,color:new pt};break;case"SpotLight":t={position:new K,direction:new K,color:new pt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new K,color:new pt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new K,skyColor:new pt,groundColor:new pt};break;case"RectAreaLight":t={color:new pt,position:new K,halfWidth:new K,halfHeight:new K}}return a[e.id]=t,t}}}let ju=0;function $u(a,e){return(e.castShadow?2:0)-(a.castShadow?2:0)+(e.map?1:0)-(a.map?1:0)}function Xu(a,e){const t=new Gu,n=function Wu(){const a={};return{get:function(e){if(void 0!==a[e.id])return a[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ke};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ke,shadowCameraNear:1,shadowCameraFar:1e3}}return a[e.id]=t,t}}}(),s={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let _=0;_<9;_++)s.probe.push(new K);const l=new K,u=new Bt,d=new Bt;return{setup:function p(_,M){let w=0,E=0,D=0;for(let x=0;x<9;x++)s.probe[x].set(0,0,0);let F=0,P=0,R=0,V=0,k=0,W=0,i=0,r=0,o=0,c=0;_.sort($u);const h=!0===M?Math.PI:1;for(let x=0,b=_.length;x<b;x++){const C=_[x],L=C.color,N=C.intensity,G=C.distance,X=C.shadow&&C.shadow.map?C.shadow.map.texture:null;if(C.isAmbientLight)w+=L.r*N*h,E+=L.g*N*h,D+=L.b*N*h;else if(C.isLightProbe)for(let Z=0;Z<9;Z++)s.probe[Z].addScaledVector(C.sh.coefficients[Z],N);else if(C.isDirectionalLight){const Z=t.get(C);if(Z.color.copy(C.color).multiplyScalar(C.intensity*h),C.castShadow){const re=C.shadow,ce=n.get(C);ce.shadowBias=re.bias,ce.shadowNormalBias=re.normalBias,ce.shadowRadius=re.radius,ce.shadowMapSize=re.mapSize,s.directionalShadow[F]=ce,s.directionalShadowMap[F]=X,s.directionalShadowMatrix[F]=C.shadow.matrix,W++}s.directional[F]=Z,F++}else if(C.isSpotLight){const Z=t.get(C);Z.position.setFromMatrixPosition(C.matrixWorld),Z.color.copy(L).multiplyScalar(N*h),Z.distance=G,Z.coneCos=Math.cos(C.angle),Z.penumbraCos=Math.cos(C.angle*(1-C.penumbra)),Z.decay=C.decay,s.spot[R]=Z;const re=C.shadow;if(C.map&&(s.spotLightMap[o]=C.map,o++,re.updateMatrices(C),C.castShadow&&c++),s.spotLightMatrix[R]=re.matrix,C.castShadow){const ce=n.get(C);ce.shadowBias=re.bias,ce.shadowNormalBias=re.normalBias,ce.shadowRadius=re.radius,ce.shadowMapSize=re.mapSize,s.spotShadow[R]=ce,s.spotShadowMap[R]=X,r++}R++}else if(C.isRectAreaLight){const Z=t.get(C);Z.color.copy(L).multiplyScalar(N),Z.halfWidth.set(.5*C.width,0,0),Z.halfHeight.set(0,.5*C.height,0),s.rectArea[V]=Z,V++}else if(C.isPointLight){const Z=t.get(C);if(Z.color.copy(C.color).multiplyScalar(C.intensity*h),Z.distance=C.distance,Z.decay=C.decay,C.castShadow){const re=C.shadow,ce=n.get(C);ce.shadowBias=re.bias,ce.shadowNormalBias=re.normalBias,ce.shadowRadius=re.radius,ce.shadowMapSize=re.mapSize,ce.shadowCameraNear=re.camera.near,ce.shadowCameraFar=re.camera.far,s.pointShadow[P]=ce,s.pointShadowMap[P]=X,s.pointShadowMatrix[P]=C.shadow.matrix,i++}s.point[P]=Z,P++}else if(C.isHemisphereLight){const Z=t.get(C);Z.skyColor.copy(C.color).multiplyScalar(N*h),Z.groundColor.copy(C.groundColor).multiplyScalar(N*h),s.hemi[k]=Z,k++}}V>0&&(e.isWebGL2||!0===a.has("OES_texture_float_linear")?(s.rectAreaLTC1=bt.LTC_FLOAT_1,s.rectAreaLTC2=bt.LTC_FLOAT_2):!0===a.has("OES_texture_half_float_linear")?(s.rectAreaLTC1=bt.LTC_HALF_1,s.rectAreaLTC2=bt.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),s.ambient[0]=w,s.ambient[1]=E,s.ambient[2]=D;const f=s.hash;(f.directionalLength!==F||f.pointLength!==P||f.spotLength!==R||f.rectAreaLength!==V||f.hemiLength!==k||f.numDirectionalShadows!==W||f.numPointShadows!==i||f.numSpotShadows!==r||f.numSpotMaps!==o)&&(s.directional.length=F,s.spot.length=R,s.rectArea.length=V,s.point.length=P,s.hemi.length=k,s.directionalShadow.length=W,s.directionalShadowMap.length=W,s.pointShadow.length=i,s.pointShadowMap.length=i,s.spotShadow.length=r,s.spotShadowMap.length=r,s.directionalShadowMatrix.length=W,s.pointShadowMatrix.length=i,s.spotLightMatrix.length=r+o-c,s.spotLightMap.length=o,s.numSpotLightShadowsWithMaps=c,f.directionalLength=F,f.pointLength=P,f.spotLength=R,f.rectAreaLength=V,f.hemiLength=k,f.numDirectionalShadows=W,f.numPointShadows=i,f.numSpotShadows=r,f.numSpotMaps=o,s.version=ju++)},setupView:function g(_,M){let w=0,E=0,D=0,F=0,P=0;const R=M.matrixWorldInverse;for(let V=0,k=_.length;V<k;V++){const W=_[V];if(W.isDirectionalLight){const i=s.directional[w];i.direction.setFromMatrixPosition(W.matrixWorld),l.setFromMatrixPosition(W.target.matrixWorld),i.direction.sub(l),i.direction.transformDirection(R),w++}else if(W.isSpotLight){const i=s.spot[D];i.position.setFromMatrixPosition(W.matrixWorld),i.position.applyMatrix4(R),i.direction.setFromMatrixPosition(W.matrixWorld),l.setFromMatrixPosition(W.target.matrixWorld),i.direction.sub(l),i.direction.transformDirection(R),D++}else if(W.isRectAreaLight){const i=s.rectArea[F];i.position.setFromMatrixPosition(W.matrixWorld),i.position.applyMatrix4(R),d.identity(),u.copy(W.matrixWorld),u.premultiply(R),d.extractRotation(u),i.halfWidth.set(.5*W.width,0,0),i.halfHeight.set(0,.5*W.height,0),i.halfWidth.applyMatrix4(d),i.halfHeight.applyMatrix4(d),F++}else if(W.isPointLight){const i=s.point[E];i.position.setFromMatrixPosition(W.matrixWorld),i.position.applyMatrix4(R),E++}else if(W.isHemisphereLight){const i=s.hemi[P];i.direction.setFromMatrixPosition(W.matrixWorld),i.direction.transformDirection(R),P++}}},state:s}}function eg(a,e){const t=new Xu(a,e),n=[],s=[];return{init:function l(){n.length=0,s.length=0},state:{lightsArray:n,shadowsArray:s,lights:t},setupLights:function p(M){t.setup(n,M)},setupLightsView:function g(M){t.setupView(n,M)},pushLight:function u(M){n.push(M)},pushShadow:function d(M){s.push(M)}}}function Oy(a,e){let t=new WeakMap;return{get:function n(l,u=0){const d=t.get(l);let p;return void 0===d?(p=new eg(a,e),t.set(l,[p])):u>=d.length?(p=new eg(a,e),d.push(p)):p=d[u],p},dispose:function s(){t=new WeakMap}}}class tg extends ol{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class ng extends ol{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function ky(a,e,t){let n=new vf;const s=new ke,l=new ke,u=new ii,d=new tg({depthPacking:3201}),p=new ng,g={},_=t.maxTextureSize,M={0:1,1:0,2:2},w=new eo({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new ke},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),E=w.clone();E.defines.HORIZONTAL_PASS=1;const D=new Sn;D.setAttribute("position",new vr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const F=new Yi(D,w),P=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1;let R=this.type;function V(i,r){const o=e.update(F);w.defines.VSM_SAMPLES!==i.blurSamples&&(w.defines.VSM_SAMPLES=i.blurSamples,E.defines.VSM_SAMPLES=i.blurSamples,w.needsUpdate=!0,E.needsUpdate=!0),null===i.mapPass&&(i.mapPass=new bc(s.x,s.y)),w.uniforms.shadow_pass.value=i.map.texture,w.uniforms.resolution.value=i.mapSize,w.uniforms.radius.value=i.radius,a.setRenderTarget(i.mapPass),a.clear(),a.renderBufferDirect(r,null,o,w,F,null),E.uniforms.shadow_pass.value=i.mapPass.texture,E.uniforms.resolution.value=i.mapSize,E.uniforms.radius.value=i.radius,a.setRenderTarget(i.map),a.clear(),a.renderBufferDirect(r,null,o,E,F,null)}function k(i,r,o,c){let h=null;const f=!0===o.isPointLight?i.customDistanceMaterial:i.customDepthMaterial;if(void 0!==f)h=f;else if(h=!0===o.isPointLight?p:d,a.localClippingEnabled&&!0===r.clipShadows&&Array.isArray(r.clippingPlanes)&&0!==r.clippingPlanes.length||r.displacementMap&&0!==r.displacementScale||r.alphaMap&&r.alphaTest>0||r.map&&r.alphaTest>0){const x=h.uuid,b=r.uuid;let C=g[x];void 0===C&&(C={},g[x]=C);let L=C[b];void 0===L&&(L=h.clone(),C[b]=L),h=L}return h.visible=r.visible,h.wireframe=r.wireframe,h.side=3===c?null!==r.shadowSide?r.shadowSide:r.side:null!==r.shadowSide?r.shadowSide:M[r.side],h.alphaMap=r.alphaMap,h.alphaTest=r.alphaTest,h.map=r.map,h.clipShadows=r.clipShadows,h.clippingPlanes=r.clippingPlanes,h.clipIntersection=r.clipIntersection,h.displacementMap=r.displacementMap,h.displacementScale=r.displacementScale,h.displacementBias=r.displacementBias,h.wireframeLinewidth=r.wireframeLinewidth,h.linewidth=r.linewidth,!0===o.isPointLight&&!0===h.isMeshDistanceMaterial&&(a.properties.get(h).light=o),h}function W(i,r,o,c,h){if(!1===i.visible)return;if(i.layers.test(r.layers)&&(i.isMesh||i.isLine||i.isPoints)&&(i.castShadow||i.receiveShadow&&3===h)&&(!i.frustumCulled||n.intersectsObject(i))){i.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,i.matrixWorld);const b=e.update(i),C=i.material;if(Array.isArray(C)){const L=b.groups;for(let N=0,G=L.length;N<G;N++){const X=L[N],Z=C[X.materialIndex];if(Z&&Z.visible){const re=k(i,Z,c,h);a.renderBufferDirect(o,null,b,re,i,X)}}}else if(C.visible){const L=k(i,C,c,h);a.renderBufferDirect(o,null,b,L,i,null)}}const x=i.children;for(let b=0,C=x.length;b<C;b++)W(x[b],r,o,c,h)}this.render=function(i,r,o){if(!1===P.enabled||!1===P.autoUpdate&&!1===P.needsUpdate||0===i.length)return;const c=a.getRenderTarget(),h=a.getActiveCubeFace(),f=a.getActiveMipmapLevel(),x=a.state;x.setBlending(0),x.buffers.color.setClear(1,1,1,1),x.buffers.depth.setTest(!0),x.setScissorTest(!1);const b=3!==R&&3===this.type,C=3===R&&3!==this.type;for(let L=0,N=i.length;L<N;L++){const G=i[L],X=G.shadow;if(void 0===X){console.warn("THREE.WebGLShadowMap:",G,"has no shadow.");continue}if(!1===X.autoUpdate&&!1===X.needsUpdate)continue;s.copy(X.mapSize);const Z=X.getFrameExtents();if(s.multiply(Z),l.copy(X.mapSize),(s.x>_||s.y>_)&&(s.x>_&&(l.x=Math.floor(_/Z.x),s.x=l.x*Z.x,X.mapSize.x=l.x),s.y>_&&(l.y=Math.floor(_/Z.y),s.y=l.y*Z.y,X.mapSize.y=l.y)),null===X.map||!0===b||!0===C){const ce=3!==this.type?{minFilter:di,magFilter:di}:{};null!==X.map&&X.map.dispose(),X.map=new bc(s.x,s.y,ce),X.map.texture.name=G.name+".shadowMap",X.camera.updateProjectionMatrix()}a.setRenderTarget(X.map),a.clear();const re=X.getViewportCount();for(let ce=0;ce<re;ce++){const ie=X.getViewport(ce);u.set(l.x*ie.x,l.y*ie.y,l.x*ie.z,l.y*ie.w),x.viewport(u),X.updateMatrices(G,ce),n=X.getFrustum(),W(r,o,X.camera,G,this.type)}!0!==X.isPointLightShadow&&3===this.type&&V(X,o),X.needsUpdate=!1}R=this.type,P.needsUpdate=!1,a.setRenderTarget(c,h,f)}}function Uy(a,e,t){const n=t.isWebGL2,d=new function s(){let fe=!1;const Ct=new ii;let Ce=null;const it=new ii(0,0,0,0);return{setMask:function(Tt){Ce!==Tt&&!fe&&(a.colorMask(Tt,Tt,Tt,Tt),Ce=Tt)},setLocked:function(Tt){fe=Tt},setClear:function(Tt,Hn,xi,Wi,vh){!0===vh&&(Tt*=Wi,Hn*=Wi,xi*=Wi),Ct.set(Tt,Hn,xi,Wi),!1===it.equals(Ct)&&(a.clearColor(Tt,Hn,xi,Wi),it.copy(Ct))},reset:function(){fe=!1,Ce=null,it.set(-1,0,0,0)}}},p=new function l(){let fe=!1,Ct=null,Ce=null,it=null;return{setTest:function(Tt){Tt?St(a.DEPTH_TEST):Pt(a.DEPTH_TEST)},setMask:function(Tt){Ct!==Tt&&!fe&&(a.depthMask(Tt),Ct=Tt)},setFunc:function(Tt){if(Ce!==Tt){switch(Tt){case 0:a.depthFunc(a.NEVER);break;case 1:a.depthFunc(a.ALWAYS);break;case 2:a.depthFunc(a.LESS);break;case 3:default:a.depthFunc(a.LEQUAL);break;case 4:a.depthFunc(a.EQUAL);break;case 5:a.depthFunc(a.GEQUAL);break;case 6:a.depthFunc(a.GREATER);break;case 7:a.depthFunc(a.NOTEQUAL)}Ce=Tt}},setLocked:function(Tt){fe=Tt},setClear:function(Tt){it!==Tt&&(a.clearDepth(Tt),it=Tt)},reset:function(){fe=!1,Ct=null,Ce=null,it=null}}},g=new function u(){let fe=!1,Ct=null,Ce=null,it=null,Tt=null,Hn=null,xi=null,Wi=null,vh=null;return{setTest:function(ji){fe||(ji?St(a.STENCIL_TEST):Pt(a.STENCIL_TEST))},setMask:function(ji){Ct!==ji&&!fe&&(a.stencilMask(ji),Ct=ji)},setFunc:function(ji,tc,ro){(Ce!==ji||it!==tc||Tt!==ro)&&(a.stencilFunc(ji,tc,ro),Ce=ji,it=tc,Tt=ro)},setOp:function(ji,tc,ro){(Hn!==ji||xi!==tc||Wi!==ro)&&(a.stencilOp(ji,tc,ro),Hn=ji,xi=tc,Wi=ro)},setLocked:function(ji){fe=ji},setClear:function(ji){vh!==ji&&(a.clearStencil(ji),vh=ji)},reset:function(){fe=!1,Ct=null,Ce=null,it=null,Tt=null,Hn=null,xi=null,Wi=null,vh=null}}},_=new WeakMap,M=new WeakMap;let w={},E={},D=new WeakMap,F=[],P=null,R=!1,V=null,k=null,W=null,i=null,r=null,o=null,c=null,h=!1,f=null,x=null,b=null,C=null,L=null;const N=a.getParameter(a.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let G=!1,X=0;const Z=a.getParameter(a.VERSION);-1!==Z.indexOf("WebGL")?(X=parseFloat(/^WebGL (\d)/.exec(Z)[1]),G=X>=1):-1!==Z.indexOf("OpenGL ES")&&(X=parseFloat(/^OpenGL ES (\d)/.exec(Z)[1]),G=X>=2);let re=null,ce={};const ie=a.getParameter(a.SCISSOR_BOX),de=a.getParameter(a.VIEWPORT),he=(new ii).fromArray(ie),be=(new ii).fromArray(de);function Pe(fe,Ct,Ce,it){const Tt=new Uint8Array(4),Hn=a.createTexture();a.bindTexture(fe,Hn),a.texParameteri(fe,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(fe,a.TEXTURE_MAG_FILTER,a.NEAREST);for(let xi=0;xi<Ce;xi++)!n||fe!==a.TEXTURE_3D&&fe!==a.TEXTURE_2D_ARRAY?a.texImage2D(Ct+xi,0,a.RGBA,1,1,0,a.RGBA,a.UNSIGNED_BYTE,Tt):a.texImage3D(Ct,0,a.RGBA,1,1,it,0,a.RGBA,a.UNSIGNED_BYTE,Tt);return Hn}const ot={};function St(fe){!0!==w[fe]&&(a.enable(fe),w[fe]=!0)}function Pt(fe){!1!==w[fe]&&(a.disable(fe),w[fe]=!1)}ot[a.TEXTURE_2D]=Pe(a.TEXTURE_2D,a.TEXTURE_2D,1),ot[a.TEXTURE_CUBE_MAP]=Pe(a.TEXTURE_CUBE_MAP,a.TEXTURE_CUBE_MAP_POSITIVE_X,6),n&&(ot[a.TEXTURE_2D_ARRAY]=Pe(a.TEXTURE_2D_ARRAY,a.TEXTURE_2D_ARRAY,1,1),ot[a.TEXTURE_3D]=Pe(a.TEXTURE_3D,a.TEXTURE_3D,1,1)),d.setClear(0,0,0,1),p.setClear(1),g.setClear(0),St(a.DEPTH_TEST),p.setFunc(3),Ge(!1),Xt(1),St(a.CULL_FACE),Fe(0);const oe={100:a.FUNC_ADD,101:a.FUNC_SUBTRACT,102:a.FUNC_REVERSE_SUBTRACT};if(n)oe[103]=a.MIN,oe[104]=a.MAX;else{const fe=e.get("EXT_blend_minmax");null!==fe&&(oe[103]=fe.MIN_EXT,oe[104]=fe.MAX_EXT)}const ct={200:a.ZERO,201:a.ONE,202:a.SRC_COLOR,204:a.SRC_ALPHA,210:a.SRC_ALPHA_SATURATE,208:a.DST_COLOR,206:a.DST_ALPHA,203:a.ONE_MINUS_SRC_COLOR,205:a.ONE_MINUS_SRC_ALPHA,209:a.ONE_MINUS_DST_COLOR,207:a.ONE_MINUS_DST_ALPHA};function Fe(fe,Ct,Ce,it,Tt,Hn,xi,Wi){if(0!==fe){if(!1===R&&(St(a.BLEND),R=!0),5===fe)Tt=Tt||Ct,Hn=Hn||Ce,xi=xi||it,(Ct!==k||Tt!==r)&&(a.blendEquationSeparate(oe[Ct],oe[Tt]),k=Ct,r=Tt),(Ce!==W||it!==i||Hn!==o||xi!==c)&&(a.blendFuncSeparate(ct[Ce],ct[it],ct[Hn],ct[xi]),W=Ce,i=it,o=Hn,c=xi),V=fe,h=!1;else if(fe!==V||Wi!==h){if((100!==k||100!==r)&&(a.blendEquation(a.FUNC_ADD),k=100,r=100),Wi)switch(fe){case 1:a.blendFuncSeparate(a.ONE,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA);break;case 2:a.blendFunc(a.ONE,a.ONE);break;case 3:a.blendFuncSeparate(a.ZERO,a.ONE_MINUS_SRC_COLOR,a.ZERO,a.ONE);break;case 4:a.blendFuncSeparate(a.ZERO,a.SRC_COLOR,a.ZERO,a.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",fe)}else switch(fe){case 1:a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA);break;case 2:a.blendFunc(a.SRC_ALPHA,a.ONE);break;case 3:a.blendFuncSeparate(a.ZERO,a.ONE_MINUS_SRC_COLOR,a.ZERO,a.ONE);break;case 4:a.blendFunc(a.ZERO,a.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",fe)}W=null,i=null,o=null,c=null,V=fe,h=Wi}}else!0===R&&(Pt(a.BLEND),R=!1)}function Ge(fe){f!==fe&&(a.frontFace(fe?a.CW:a.CCW),f=fe)}function Xt(fe){0!==fe?(St(a.CULL_FACE),fe!==x&&a.cullFace(1===fe?a.BACK:2===fe?a.FRONT:a.FRONT_AND_BACK)):Pt(a.CULL_FACE),x=fe}function Vt(fe,Ct,Ce){fe?(St(a.POLYGON_OFFSET_FILL),(C!==Ct||L!==Ce)&&(a.polygonOffset(Ct,Ce),C=Ct,L=Ce)):Pt(a.POLYGON_OFFSET_FILL)}return{buffers:{color:d,depth:p,stencil:g},enable:St,disable:Pt,bindFramebuffer:function Ln(fe,Ct){return E[fe]!==Ct&&(a.bindFramebuffer(fe,Ct),E[fe]=Ct,n&&(fe===a.DRAW_FRAMEBUFFER&&(E[a.FRAMEBUFFER]=Ct),fe===a.FRAMEBUFFER&&(E[a.DRAW_FRAMEBUFFER]=Ct)),!0)},drawBuffers:function ri(fe,Ct){let Ce=F,it=!1;if(fe)if(Ce=D.get(Ct),void 0===Ce&&(Ce=[],D.set(Ct,Ce)),fe.isWebGLMultipleRenderTargets){const Tt=fe.texture;if(Ce.length!==Tt.length||Ce[0]!==a.COLOR_ATTACHMENT0){for(let Hn=0,xi=Tt.length;Hn<xi;Hn++)Ce[Hn]=a.COLOR_ATTACHMENT0+Hn;Ce.length=Tt.length,it=!0}}else Ce[0]!==a.COLOR_ATTACHMENT0&&(Ce[0]=a.COLOR_ATTACHMENT0,it=!0);else Ce[0]!==a.BACK&&(Ce[0]=a.BACK,it=!0);it&&(t.isWebGL2?a.drawBuffers(Ce):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Ce))},useProgram:function Qt(fe){return P!==fe&&(a.useProgram(fe),P=fe,!0)},setBlending:Fe,setMaterial:function tt(fe,Ct){2===fe.side?Pt(a.CULL_FACE):St(a.CULL_FACE);let Ce=1===fe.side;Ct&&(Ce=!Ce),Ge(Ce),1===fe.blending&&!1===fe.transparent?Fe(0):Fe(fe.blending,fe.blendEquation,fe.blendSrc,fe.blendDst,fe.blendEquationAlpha,fe.blendSrcAlpha,fe.blendDstAlpha,fe.premultipliedAlpha),p.setFunc(fe.depthFunc),p.setTest(fe.depthTest),p.setMask(fe.depthWrite),d.setMask(fe.colorWrite);const it=fe.stencilWrite;g.setTest(it),it&&(g.setMask(fe.stencilWriteMask),g.setFunc(fe.stencilFunc,fe.stencilRef,fe.stencilFuncMask),g.setOp(fe.stencilFail,fe.stencilZFail,fe.stencilZPass)),Vt(fe.polygonOffset,fe.polygonOffsetFactor,fe.polygonOffsetUnits),!0===fe.alphaToCoverage?St(a.SAMPLE_ALPHA_TO_COVERAGE):Pt(a.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:Ge,setCullFace:Xt,setLineWidth:function Ft(fe){fe!==b&&(G&&a.lineWidth(fe),b=fe)},setPolygonOffset:Vt,setScissorTest:function fn(fe){fe?St(a.SCISSOR_TEST):Pt(a.SCISSOR_TEST)},activeTexture:function Xn(fe){void 0===fe&&(fe=a.TEXTURE0+N-1),re!==fe&&(a.activeTexture(fe),re=fe)},bindTexture:function Ji(fe,Ct,Ce){void 0===Ce&&(Ce=null===re?a.TEXTURE0+N-1:re);let it=ce[Ce];void 0===it&&(it={type:void 0,texture:void 0},ce[Ce]=it),(it.type!==fe||it.texture!==Ct)&&(re!==Ce&&(a.activeTexture(Ce),re=Ce),a.bindTexture(fe,Ct||ot[fe]),it.type=fe,it.texture=Ct)},unbindTexture:function ne(){const fe=ce[re];void 0!==fe&&void 0!==fe.type&&(a.bindTexture(fe.type,null),fe.type=void 0,fe.texture=void 0)},compressedTexImage2D:function Y(){try{a.compressedTexImage2D.apply(a,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}},compressedTexImage3D:function Ee(){try{a.compressedTexImage3D.apply(a,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}},texImage2D:function le(){try{a.texImage2D.apply(a,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}},texImage3D:function We(){try{a.texImage3D.apply(a,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}},updateUBOMapping:function At(fe,Ct){let Ce=M.get(Ct);void 0===Ce&&(Ce=new WeakMap,M.set(Ct,Ce));let it=Ce.get(fe);void 0===it&&(it=a.getUniformBlockIndex(Ct,fe.name),Ce.set(fe,it))},uniformBlockBinding:function wn(fe,Ct){const it=M.get(Ct).get(fe);_.get(Ct)!==it&&(a.uniformBlockBinding(Ct,it,fe.__bindingPointIndex),_.set(Ct,it))},texStorage2D:function dt(){try{a.texStorage2D.apply(a,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}},texStorage3D:function Ae(){try{a.texStorage3D.apply(a,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}},texSubImage2D:function at(){try{a.texSubImage2D.apply(a,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}},texSubImage3D:function Ye(){try{a.texSubImage3D.apply(a,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}},compressedTexSubImage2D:function ut(){try{a.compressedTexSubImage2D.apply(a,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}},compressedTexSubImage3D:function Jt(){try{a.compressedTexSubImage3D.apply(a,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}},scissor:function Rt(fe){!1===he.equals(fe)&&(a.scissor(fe.x,fe.y,fe.z,fe.w),he.copy(fe))},viewport:function wt(fe){!1===be.equals(fe)&&(a.viewport(fe.x,fe.y,fe.z,fe.w),be.copy(fe))},reset:function ei(){a.disable(a.BLEND),a.disable(a.CULL_FACE),a.disable(a.DEPTH_TEST),a.disable(a.POLYGON_OFFSET_FILL),a.disable(a.SCISSOR_TEST),a.disable(a.STENCIL_TEST),a.disable(a.SAMPLE_ALPHA_TO_COVERAGE),a.blendEquation(a.FUNC_ADD),a.blendFunc(a.ONE,a.ZERO),a.blendFuncSeparate(a.ONE,a.ZERO,a.ONE,a.ZERO),a.colorMask(!0,!0,!0,!0),a.clearColor(0,0,0,0),a.depthMask(!0),a.depthFunc(a.LESS),a.clearDepth(1),a.stencilMask(4294967295),a.stencilFunc(a.ALWAYS,0,4294967295),a.stencilOp(a.KEEP,a.KEEP,a.KEEP),a.clearStencil(0),a.cullFace(a.BACK),a.frontFace(a.CCW),a.polygonOffset(0,0),a.activeTexture(a.TEXTURE0),a.bindFramebuffer(a.FRAMEBUFFER,null),!0===n&&(a.bindFramebuffer(a.DRAW_FRAMEBUFFER,null),a.bindFramebuffer(a.READ_FRAMEBUFFER,null)),a.useProgram(null),a.lineWidth(1),a.scissor(0,0,a.canvas.width,a.canvas.height),a.viewport(0,0,a.canvas.width,a.canvas.height),w={},re=null,ce={},E={},D=new WeakMap,F=[],P=null,R=!1,V=null,k=null,W=null,i=null,r=null,o=null,c=null,h=!1,f=null,x=null,b=null,C=null,L=null,he.set(0,0,a.canvas.width,a.canvas.height),be.set(0,0,a.canvas.width,a.canvas.height),d.reset(),p.reset(),g.reset()}}}function By(a,e,t,n,s,l,u){const d=s.isWebGL2,p=s.maxTextures,g=s.maxCubemapSize,_=s.maxTextureSize,M=s.maxSamples,w=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,E="undefined"!=typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),D=new WeakMap;let F;const P=new WeakMap;let R=!1;try{R="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(ne){}function V(ne,Y){return R?new OffscreenCanvas(ne,Y):xc("canvas")}function k(ne,Y,Ee,at){let Ye=1;if((ne.width>at||ne.height>at)&&(Ye=at/Math.max(ne.width,ne.height)),Ye<1||!0===Y){if("undefined"!=typeof HTMLImageElement&&ne instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&ne instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&ne instanceof ImageBitmap){const ut=Y?cs:Math.floor,Jt=ut(Ye*ne.width),dt=ut(Ye*ne.height);void 0===F&&(F=V(Jt,dt));const Ae=Ee?V(Jt,dt):F;return Ae.width=Jt,Ae.height=dt,Ae.getContext("2d").drawImage(ne,0,0,Jt,dt),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+ne.width+"x"+ne.height+") to ("+Jt+"x"+dt+")."),Ae}return"data"in ne&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+ne.width+"x"+ne.height+")."),ne}return ne}function W(ne){return yv(ne.width)&&yv(ne.height)}function r(ne,Y){return ne.generateMipmaps&&Y&&ne.minFilter!==di&&ne.minFilter!==fi}function o(ne){a.generateMipmap(ne)}function c(ne,Y,Ee,at,Ye=!1){if(!1===d)return Y;if(null!==ne){if(void 0!==a[ne])return a[ne];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+ne+"'")}let ut=Y;return Y===a.RED&&(Ee===a.FLOAT&&(ut=a.R32F),Ee===a.HALF_FLOAT&&(ut=a.R16F),Ee===a.UNSIGNED_BYTE&&(ut=a.R8)),Y===a.RED_INTEGER&&(Ee===a.UNSIGNED_BYTE&&(ut=a.R8UI),Ee===a.UNSIGNED_SHORT&&(ut=a.R16UI),Ee===a.UNSIGNED_INT&&(ut=a.R32UI),Ee===a.BYTE&&(ut=a.R8I),Ee===a.SHORT&&(ut=a.R16I),Ee===a.INT&&(ut=a.R32I)),Y===a.RG&&(Ee===a.FLOAT&&(ut=a.RG32F),Ee===a.HALF_FLOAT&&(ut=a.RG16F),Ee===a.UNSIGNED_BYTE&&(ut=a.RG8)),Y===a.RGBA&&(Ee===a.FLOAT&&(ut=a.RGBA32F),Ee===a.HALF_FLOAT&&(ut=a.RGBA16F),Ee===a.UNSIGNED_BYTE&&(ut=at===rn&&!1===Ye?a.SRGB8_ALPHA8:a.RGBA8),Ee===a.UNSIGNED_SHORT_4_4_4_4&&(ut=a.RGBA4),Ee===a.UNSIGNED_SHORT_5_5_5_1&&(ut=a.RGB5_A1)),(ut===a.R16F||ut===a.R32F||ut===a.RG16F||ut===a.RG32F||ut===a.RGBA16F||ut===a.RGBA32F)&&e.get("EXT_color_buffer_float"),ut}function h(ne,Y,Ee){return!0===r(ne,Ee)||ne.isFramebufferTexture&&ne.minFilter!==di&&ne.minFilter!==fi?Math.log2(Math.max(Y.width,Y.height))+1:void 0!==ne.mipmaps&&ne.mipmaps.length>0?ne.mipmaps.length:ne.isCompressedTexture&&Array.isArray(ne.image)?Y.mipmaps.length:1}function f(ne){return ne===di||1004===ne||1005===ne?a.NEAREST:a.LINEAR}function x(ne){const Y=ne.target;Y.removeEventListener("dispose",x),function C(ne){const Y=n.get(ne);if(void 0===Y.__webglInit)return;const Ee=ne.source,at=P.get(Ee);if(at){const Ye=at[Y.__cacheKey];Ye.usedTimes--,0===Ye.usedTimes&&L(ne),0===Object.keys(at).length&&P.delete(Ee)}n.remove(ne)}(Y),Y.isVideoTexture&&D.delete(Y)}function b(ne){const Y=ne.target;Y.removeEventListener("dispose",b),function N(ne){const Y=ne.texture,Ee=n.get(ne),at=n.get(Y);if(void 0!==at.__webglTexture&&(a.deleteTexture(at.__webglTexture),u.memory.textures--),ne.depthTexture&&ne.depthTexture.dispose(),ne.isWebGLCubeRenderTarget)for(let Ye=0;Ye<6;Ye++){if(Array.isArray(Ee.__webglFramebuffer[Ye]))for(let ut=0;ut<Ee.__webglFramebuffer[Ye].length;ut++)a.deleteFramebuffer(Ee.__webglFramebuffer[Ye][ut]);else a.deleteFramebuffer(Ee.__webglFramebuffer[Ye]);Ee.__webglDepthbuffer&&a.deleteRenderbuffer(Ee.__webglDepthbuffer[Ye])}else{if(Array.isArray(Ee.__webglFramebuffer))for(let Ye=0;Ye<Ee.__webglFramebuffer.length;Ye++)a.deleteFramebuffer(Ee.__webglFramebuffer[Ye]);else a.deleteFramebuffer(Ee.__webglFramebuffer);if(Ee.__webglDepthbuffer&&a.deleteRenderbuffer(Ee.__webglDepthbuffer),Ee.__webglMultisampledFramebuffer&&a.deleteFramebuffer(Ee.__webglMultisampledFramebuffer),Ee.__webglColorRenderbuffer)for(let Ye=0;Ye<Ee.__webglColorRenderbuffer.length;Ye++)Ee.__webglColorRenderbuffer[Ye]&&a.deleteRenderbuffer(Ee.__webglColorRenderbuffer[Ye]);Ee.__webglDepthRenderbuffer&&a.deleteRenderbuffer(Ee.__webglDepthRenderbuffer)}if(ne.isWebGLMultipleRenderTargets)for(let Ye=0,ut=Y.length;Ye<ut;Ye++){const Jt=n.get(Y[Ye]);Jt.__webglTexture&&(a.deleteTexture(Jt.__webglTexture),u.memory.textures--),n.remove(Y[Ye])}n.remove(Y),n.remove(ne)}(Y)}function L(ne){const Y=n.get(ne);a.deleteTexture(Y.__webglTexture),delete P.get(ne.source)[Y.__cacheKey],u.memory.textures--}let G=0;function ce(ne,Y){const Ee=n.get(ne);if(ne.isVideoTexture&&function Xn(ne){const Y=u.render.frame;D.get(ne)!==Y&&(D.set(ne,Y),ne.update())}(ne),!1===ne.isRenderTargetTexture&&ne.version>0&&Ee.__version!==ne.version){const at=ne.image;if(null===at)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==at.complete)return void Ln(Ee,ne,Y);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(a.TEXTURE_2D,Ee.__webglTexture,a.TEXTURE0+Y)}const be={[Vi]:a.REPEAT,[zn]:a.CLAMP_TO_EDGE,1002:a.MIRRORED_REPEAT},Pe={[di]:a.NEAREST,1004:a.NEAREST_MIPMAP_NEAREST,1005:a.NEAREST_MIPMAP_LINEAR,[fi]:a.LINEAR,1007:a.LINEAR_MIPMAP_NEAREST,[gs]:a.LINEAR_MIPMAP_LINEAR},ot={512:a.NEVER,519:a.ALWAYS,513:a.LESS,515:a.LEQUAL,514:a.EQUAL,518:a.GEQUAL,516:a.GREATER,517:a.NOTEQUAL};function St(ne,Y,Ee){if(Ee?(a.texParameteri(ne,a.TEXTURE_WRAP_S,be[Y.wrapS]),a.texParameteri(ne,a.TEXTURE_WRAP_T,be[Y.wrapT]),(ne===a.TEXTURE_3D||ne===a.TEXTURE_2D_ARRAY)&&a.texParameteri(ne,a.TEXTURE_WRAP_R,be[Y.wrapR]),a.texParameteri(ne,a.TEXTURE_MAG_FILTER,Pe[Y.magFilter]),a.texParameteri(ne,a.TEXTURE_MIN_FILTER,Pe[Y.minFilter])):(a.texParameteri(ne,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(ne,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),(ne===a.TEXTURE_3D||ne===a.TEXTURE_2D_ARRAY)&&a.texParameteri(ne,a.TEXTURE_WRAP_R,a.CLAMP_TO_EDGE),(Y.wrapS!==zn||Y.wrapT!==zn)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),a.texParameteri(ne,a.TEXTURE_MAG_FILTER,f(Y.magFilter)),a.texParameteri(ne,a.TEXTURE_MIN_FILTER,f(Y.minFilter)),Y.minFilter!==di&&Y.minFilter!==fi&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),Y.compareFunction&&(a.texParameteri(ne,a.TEXTURE_COMPARE_MODE,a.COMPARE_REF_TO_TEXTURE),a.texParameteri(ne,a.TEXTURE_COMPARE_FUNC,ot[Y.compareFunction])),!0===e.has("EXT_texture_filter_anisotropic")){const at=e.get("EXT_texture_filter_anisotropic");if(Y.magFilter===di||1005!==Y.minFilter&&Y.minFilter!==gs||Y.type===an&&!1===e.has("OES_texture_float_linear")||!1===d&&Y.type===Ha&&!1===e.has("OES_texture_half_float_linear"))return;(Y.anisotropy>1||n.get(Y).__currentAnisotropy)&&(a.texParameterf(ne,at.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Y.anisotropy,s.getMaxAnisotropy())),n.get(Y).__currentAnisotropy=Y.anisotropy)}}function Pt(ne,Y){let Ee=!1;void 0===ne.__webglInit&&(ne.__webglInit=!0,Y.addEventListener("dispose",x));const at=Y.source;let Ye=P.get(at);void 0===Ye&&(Ye={},P.set(at,Ye));const ut=function re(ne){const Y=[];return Y.push(ne.wrapS),Y.push(ne.wrapT),Y.push(ne.wrapR||0),Y.push(ne.magFilter),Y.push(ne.minFilter),Y.push(ne.anisotropy),Y.push(ne.internalFormat),Y.push(ne.format),Y.push(ne.type),Y.push(ne.generateMipmaps),Y.push(ne.premultiplyAlpha),Y.push(ne.flipY),Y.push(ne.unpackAlignment),Y.push(ne.colorSpace),Y.join()}(Y);if(ut!==ne.__cacheKey){void 0===Ye[ut]&&(Ye[ut]={texture:a.createTexture(),usedTimes:0},u.memory.textures++,Ee=!0),Ye[ut].usedTimes++;const Jt=Ye[ne.__cacheKey];void 0!==Jt&&(Ye[ne.__cacheKey].usedTimes--,0===Jt.usedTimes&&L(Y)),ne.__cacheKey=ut,ne.__webglTexture=Ye[ut].texture}return Ee}function Ln(ne,Y,Ee){let at=a.TEXTURE_2D;(Y.isDataArrayTexture||Y.isCompressedArrayTexture)&&(at=a.TEXTURE_2D_ARRAY),Y.isData3DTexture&&(at=a.TEXTURE_3D);const Ye=Pt(ne,Y),ut=Y.source;t.bindTexture(at,ne.__webglTexture,a.TEXTURE0+Ee);const Jt=n.get(ut);if(ut.version!==Jt.__version||!0===Ye){t.activeTexture(a.TEXTURE0+Ee),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,Y.flipY),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Y.premultiplyAlpha),a.pixelStorei(a.UNPACK_ALIGNMENT,Y.unpackAlignment),a.pixelStorei(a.UNPACK_COLORSPACE_CONVERSION_WEBGL,a.NONE);const dt=function i(ne){return!d&&(ne.wrapS!==zn||ne.wrapT!==zn||ne.minFilter!==di&&ne.minFilter!==fi)}(Y)&&!1===W(Y.image);let Ae=k(Y.image,dt,!1,_);Ae=Ji(Y,Ae);const le=W(Ae)||d,We=l.convert(Y.format,Y.colorSpace);let At,Rt=l.convert(Y.type),wt=c(Y.internalFormat,We,Rt,Y.colorSpace);St(at,Y,le);const wn=Y.mipmaps,ei=d&&!0!==Y.isVideoTexture,fe=void 0===Jt.__version||!0===Ye,Ct=h(Y,Ae,le);if(Y.isDepthTexture)wt=a.DEPTH_COMPONENT,d?wt=Y.type===an?a.DEPTH_COMPONENT32F:Y.type===Ue?a.DEPTH_COMPONENT24:Y.type===vs?a.DEPTH24_STENCIL8:a.DEPTH_COMPONENT16:Y.type===an&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),Y.format===mo&&wt===a.DEPTH_COMPONENT&&1012!==Y.type&&Y.type!==Ue&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),Y.type=Ue,Rt=l.convert(Y.type)),Y.format===ya&&wt===a.DEPTH_COMPONENT&&(wt=a.DEPTH_STENCIL,Y.type!==vs&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),Y.type=vs,Rt=l.convert(Y.type))),fe&&(ei?t.texStorage2D(a.TEXTURE_2D,1,wt,Ae.width,Ae.height):t.texImage2D(a.TEXTURE_2D,0,wt,Ae.width,Ae.height,0,We,Rt,null));else if(Y.isDataTexture)if(wn.length>0&&le){ei&&fe&&t.texStorage2D(a.TEXTURE_2D,Ct,wt,wn[0].width,wn[0].height);for(let Ce=0,it=wn.length;Ce<it;Ce++)At=wn[Ce],ei?t.texSubImage2D(a.TEXTURE_2D,Ce,0,0,At.width,At.height,We,Rt,At.data):t.texImage2D(a.TEXTURE_2D,Ce,wt,At.width,At.height,0,We,Rt,At.data);Y.generateMipmaps=!1}else ei?(fe&&t.texStorage2D(a.TEXTURE_2D,Ct,wt,Ae.width,Ae.height),t.texSubImage2D(a.TEXTURE_2D,0,0,0,Ae.width,Ae.height,We,Rt,Ae.data)):t.texImage2D(a.TEXTURE_2D,0,wt,Ae.width,Ae.height,0,We,Rt,Ae.data);else if(Y.isCompressedTexture)if(Y.isCompressedArrayTexture){ei&&fe&&t.texStorage3D(a.TEXTURE_2D_ARRAY,Ct,wt,wn[0].width,wn[0].height,Ae.depth);for(let Ce=0,it=wn.length;Ce<it;Ce++)At=wn[Ce],Y.format!==Er?null!==We?ei?t.compressedTexSubImage3D(a.TEXTURE_2D_ARRAY,Ce,0,0,0,At.width,At.height,Ae.depth,We,At.data,0,0):t.compressedTexImage3D(a.TEXTURE_2D_ARRAY,Ce,wt,At.width,At.height,Ae.depth,0,At.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ei?t.texSubImage3D(a.TEXTURE_2D_ARRAY,Ce,0,0,0,At.width,At.height,Ae.depth,We,Rt,At.data):t.texImage3D(a.TEXTURE_2D_ARRAY,Ce,wt,At.width,At.height,Ae.depth,0,We,Rt,At.data)}else{ei&&fe&&t.texStorage2D(a.TEXTURE_2D,Ct,wt,wn[0].width,wn[0].height);for(let Ce=0,it=wn.length;Ce<it;Ce++)At=wn[Ce],Y.format!==Er?null!==We?ei?t.compressedTexSubImage2D(a.TEXTURE_2D,Ce,0,0,At.width,At.height,We,At.data):t.compressedTexImage2D(a.TEXTURE_2D,Ce,wt,At.width,At.height,0,At.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ei?t.texSubImage2D(a.TEXTURE_2D,Ce,0,0,At.width,At.height,We,Rt,At.data):t.texImage2D(a.TEXTURE_2D,Ce,wt,At.width,At.height,0,We,Rt,At.data)}else if(Y.isDataArrayTexture)ei?(fe&&t.texStorage3D(a.TEXTURE_2D_ARRAY,Ct,wt,Ae.width,Ae.height,Ae.depth),t.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,0,Ae.width,Ae.height,Ae.depth,We,Rt,Ae.data)):t.texImage3D(a.TEXTURE_2D_ARRAY,0,wt,Ae.width,Ae.height,Ae.depth,0,We,Rt,Ae.data);else if(Y.isData3DTexture)ei?(fe&&t.texStorage3D(a.TEXTURE_3D,Ct,wt,Ae.width,Ae.height,Ae.depth),t.texSubImage3D(a.TEXTURE_3D,0,0,0,0,Ae.width,Ae.height,Ae.depth,We,Rt,Ae.data)):t.texImage3D(a.TEXTURE_3D,0,wt,Ae.width,Ae.height,Ae.depth,0,We,Rt,Ae.data);else if(Y.isFramebufferTexture){if(fe)if(ei)t.texStorage2D(a.TEXTURE_2D,Ct,wt,Ae.width,Ae.height);else{let Ce=Ae.width,it=Ae.height;for(let Tt=0;Tt<Ct;Tt++)t.texImage2D(a.TEXTURE_2D,Tt,wt,Ce,it,0,We,Rt,null),Ce>>=1,it>>=1}}else if(wn.length>0&&le){ei&&fe&&t.texStorage2D(a.TEXTURE_2D,Ct,wt,wn[0].width,wn[0].height);for(let Ce=0,it=wn.length;Ce<it;Ce++)At=wn[Ce],ei?t.texSubImage2D(a.TEXTURE_2D,Ce,0,0,We,Rt,At):t.texImage2D(a.TEXTURE_2D,Ce,wt,We,Rt,At);Y.generateMipmaps=!1}else ei?(fe&&t.texStorage2D(a.TEXTURE_2D,Ct,wt,Ae.width,Ae.height),t.texSubImage2D(a.TEXTURE_2D,0,0,0,We,Rt,Ae)):t.texImage2D(a.TEXTURE_2D,0,wt,We,Rt,Ae);r(Y,le)&&o(at),Jt.__version=ut.version,Y.onUpdate&&Y.onUpdate(Y)}ne.__version=Y.version}function Qt(ne,Y,Ee,at,Ye,ut){const Jt=l.convert(Ee.format,Ee.colorSpace),dt=l.convert(Ee.type),Ae=c(Ee.internalFormat,Jt,dt,Ee.colorSpace);if(!n.get(Y).__hasExternalTextures){const We=Math.max(1,Y.width>>ut),Rt=Math.max(1,Y.height>>ut);Ye===a.TEXTURE_3D||Ye===a.TEXTURE_2D_ARRAY?t.texImage3D(Ye,ut,Ae,We,Rt,Y.depth,0,Jt,dt,null):t.texImage2D(Ye,ut,Ae,We,Rt,0,Jt,dt,null)}t.bindFramebuffer(a.FRAMEBUFFER,ne),fn(Y)?w.framebufferTexture2DMultisampleEXT(a.FRAMEBUFFER,at,Ye,n.get(Ee).__webglTexture,0,Vt(Y)):(Ye===a.TEXTURE_2D||Ye>=a.TEXTURE_CUBE_MAP_POSITIVE_X&&Ye<=a.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&a.framebufferTexture2D(a.FRAMEBUFFER,at,Ye,n.get(Ee).__webglTexture,ut),t.bindFramebuffer(a.FRAMEBUFFER,null)}function oe(ne,Y,Ee){if(a.bindRenderbuffer(a.RENDERBUFFER,ne),Y.depthBuffer&&!Y.stencilBuffer){let at=a.DEPTH_COMPONENT16;if(Ee||fn(Y)){const Ye=Y.depthTexture;Ye&&Ye.isDepthTexture&&(Ye.type===an?at=a.DEPTH_COMPONENT32F:Ye.type===Ue&&(at=a.DEPTH_COMPONENT24));const ut=Vt(Y);fn(Y)?w.renderbufferStorageMultisampleEXT(a.RENDERBUFFER,ut,at,Y.width,Y.height):a.renderbufferStorageMultisample(a.RENDERBUFFER,ut,at,Y.width,Y.height)}else a.renderbufferStorage(a.RENDERBUFFER,at,Y.width,Y.height);a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,ne)}else if(Y.depthBuffer&&Y.stencilBuffer){const at=Vt(Y);Ee&&!1===fn(Y)?a.renderbufferStorageMultisample(a.RENDERBUFFER,at,a.DEPTH24_STENCIL8,Y.width,Y.height):fn(Y)?w.renderbufferStorageMultisampleEXT(a.RENDERBUFFER,at,a.DEPTH24_STENCIL8,Y.width,Y.height):a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_STENCIL,Y.width,Y.height),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,ne)}else{const at=!0===Y.isWebGLMultipleRenderTargets?Y.texture:[Y.texture];for(let Ye=0;Ye<at.length;Ye++){const ut=at[Ye],Jt=l.convert(ut.format,ut.colorSpace),dt=l.convert(ut.type),Ae=c(ut.internalFormat,Jt,dt,ut.colorSpace),le=Vt(Y);Ee&&!1===fn(Y)?a.renderbufferStorageMultisample(a.RENDERBUFFER,le,Ae,Y.width,Y.height):fn(Y)?w.renderbufferStorageMultisampleEXT(a.RENDERBUFFER,le,Ae,Y.width,Y.height):a.renderbufferStorage(a.RENDERBUFFER,Ae,Y.width,Y.height)}}a.bindRenderbuffer(a.RENDERBUFFER,null)}function Fe(ne){const Y=n.get(ne),Ee=!0===ne.isWebGLCubeRenderTarget;if(ne.depthTexture&&!Y.__autoAllocateDepthBuffer){if(Ee)throw new Error("target.depthTexture not supported in Cube render targets");!function ct(ne,Y){if(Y&&Y.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(a.FRAMEBUFFER,ne),!Y.depthTexture||!Y.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(Y.depthTexture).__webglTexture||Y.depthTexture.image.width!==Y.width||Y.depthTexture.image.height!==Y.height)&&(Y.depthTexture.image.width=Y.width,Y.depthTexture.image.height=Y.height,Y.depthTexture.needsUpdate=!0),ce(Y.depthTexture,0);const at=n.get(Y.depthTexture).__webglTexture,Ye=Vt(Y);if(Y.depthTexture.format===mo)fn(Y)?w.framebufferTexture2DMultisampleEXT(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.TEXTURE_2D,at,0,Ye):a.framebufferTexture2D(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.TEXTURE_2D,at,0);else{if(Y.depthTexture.format!==ya)throw new Error("Unknown depthTexture format");fn(Y)?w.framebufferTexture2DMultisampleEXT(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.TEXTURE_2D,at,0,Ye):a.framebufferTexture2D(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.TEXTURE_2D,at,0)}}(Y.__webglFramebuffer,ne)}else if(Ee){Y.__webglDepthbuffer=[];for(let at=0;at<6;at++)t.bindFramebuffer(a.FRAMEBUFFER,Y.__webglFramebuffer[at]),Y.__webglDepthbuffer[at]=a.createRenderbuffer(),oe(Y.__webglDepthbuffer[at],ne,!1)}else t.bindFramebuffer(a.FRAMEBUFFER,Y.__webglFramebuffer),Y.__webglDepthbuffer=a.createRenderbuffer(),oe(Y.__webglDepthbuffer,ne,!1);t.bindFramebuffer(a.FRAMEBUFFER,null)}function Vt(ne){return Math.min(M,ne.samples)}function fn(ne){const Y=n.get(ne);return d&&ne.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==Y.__useRenderToTexture}function Ji(ne,Y){const Ee=ne.colorSpace,at=ne.format,Ye=ne.type;return!0===ne.isCompressedTexture||1035===ne.format||Ee!==Nr&&""!==Ee&&(Ee===rn?!1===d?!0===e.has("EXT_sRGB")&&at===Er?(ne.format=1035,ne.minFilter=fi,ne.generateMipmaps=!1):Y=Mv.sRGBToLinear(Y):(at!==Er||Ye!==ho)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Ee)),Y}this.allocateTextureUnit=function Z(){const ne=G;return ne>=p&&console.warn("THREE.WebGLTextures: Trying to use "+ne+" texture units while this GPU supports only "+p),G+=1,ne},this.resetTextureUnits=function X(){G=0},this.setTexture2D=ce,this.setTexture2DArray=function ie(ne,Y){const Ee=n.get(ne);ne.version>0&&Ee.__version!==ne.version?Ln(Ee,ne,Y):t.bindTexture(a.TEXTURE_2D_ARRAY,Ee.__webglTexture,a.TEXTURE0+Y)},this.setTexture3D=function de(ne,Y){const Ee=n.get(ne);ne.version>0&&Ee.__version!==ne.version?Ln(Ee,ne,Y):t.bindTexture(a.TEXTURE_3D,Ee.__webglTexture,a.TEXTURE0+Y)},this.setTextureCube=function he(ne,Y){const Ee=n.get(ne);ne.version>0&&Ee.__version!==ne.version?function ri(ne,Y,Ee){if(6!==Y.image.length)return;const at=Pt(ne,Y),Ye=Y.source;t.bindTexture(a.TEXTURE_CUBE_MAP,ne.__webglTexture,a.TEXTURE0+Ee);const ut=n.get(Ye);if(Ye.version!==ut.__version||!0===at){t.activeTexture(a.TEXTURE0+Ee),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,Y.flipY),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Y.premultiplyAlpha),a.pixelStorei(a.UNPACK_ALIGNMENT,Y.unpackAlignment),a.pixelStorei(a.UNPACK_COLORSPACE_CONVERSION_WEBGL,a.NONE);const Jt=Y.isCompressedTexture||Y.image[0].isCompressedTexture,dt=Y.image[0]&&Y.image[0].isDataTexture,Ae=[];for(let Ce=0;Ce<6;Ce++)Ae[Ce]=Jt||dt?dt?Y.image[Ce].image:Y.image[Ce]:k(Y.image[Ce],!1,!0,g),Ae[Ce]=Ji(Y,Ae[Ce]);const le=Ae[0],We=W(le)||d,Rt=l.convert(Y.format,Y.colorSpace),wt=l.convert(Y.type),At=c(Y.internalFormat,Rt,wt,Y.colorSpace),wn=d&&!0!==Y.isVideoTexture,ei=void 0===ut.__version||!0===at;let Ct,fe=h(Y,le,We);if(St(a.TEXTURE_CUBE_MAP,Y,We),Jt){wn&&ei&&t.texStorage2D(a.TEXTURE_CUBE_MAP,fe,At,le.width,le.height);for(let Ce=0;Ce<6;Ce++){Ct=Ae[Ce].mipmaps;for(let it=0;it<Ct.length;it++){const Tt=Ct[it];Y.format!==Er?null!==Rt?wn?t.compressedTexSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,it,0,0,Tt.width,Tt.height,Rt,Tt.data):t.compressedTexImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,it,At,Tt.width,Tt.height,0,Tt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):wn?t.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,it,0,0,Tt.width,Tt.height,Rt,wt,Tt.data):t.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,it,At,Tt.width,Tt.height,0,Rt,wt,Tt.data)}}}else{Ct=Y.mipmaps,wn&&ei&&(Ct.length>0&&fe++,t.texStorage2D(a.TEXTURE_CUBE_MAP,fe,At,Ae[0].width,Ae[0].height));for(let Ce=0;Ce<6;Ce++)if(dt){wn?t.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,0,0,0,Ae[Ce].width,Ae[Ce].height,Rt,wt,Ae[Ce].data):t.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,0,At,Ae[Ce].width,Ae[Ce].height,0,Rt,wt,Ae[Ce].data);for(let it=0;it<Ct.length;it++){const Hn=Ct[it].image[Ce].image;wn?t.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,it+1,0,0,Hn.width,Hn.height,Rt,wt,Hn.data):t.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,it+1,At,Hn.width,Hn.height,0,Rt,wt,Hn.data)}}else{wn?t.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,0,0,0,Rt,wt,Ae[Ce]):t.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,0,At,Rt,wt,Ae[Ce]);for(let it=0;it<Ct.length;it++){const Tt=Ct[it];wn?t.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,it+1,0,0,Rt,wt,Tt.image[Ce]):t.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,it+1,At,Rt,wt,Tt.image[Ce])}}}r(Y,We)&&o(a.TEXTURE_CUBE_MAP),ut.__version=Ye.version,Y.onUpdate&&Y.onUpdate(Y)}ne.__version=Y.version}(Ee,ne,Y):t.bindTexture(a.TEXTURE_CUBE_MAP,Ee.__webglTexture,a.TEXTURE0+Y)},this.rebindTextures=function tt(ne,Y,Ee){const at=n.get(ne);void 0!==Y&&Qt(at.__webglFramebuffer,ne,ne.texture,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,0),void 0!==Ee&&Fe(ne)},this.setupRenderTarget=function Ge(ne){const Y=ne.texture,Ee=n.get(ne),at=n.get(Y);ne.addEventListener("dispose",b),!0!==ne.isWebGLMultipleRenderTargets&&(void 0===at.__webglTexture&&(at.__webglTexture=a.createTexture()),at.__version=Y.version,u.memory.textures++);const Ye=!0===ne.isWebGLCubeRenderTarget,ut=!0===ne.isWebGLMultipleRenderTargets,Jt=W(ne)||d;if(Ye){Ee.__webglFramebuffer=[];for(let dt=0;dt<6;dt++)if(d&&Y.mipmaps&&Y.mipmaps.length>0){Ee.__webglFramebuffer[dt]=[];for(let Ae=0;Ae<Y.mipmaps.length;Ae++)Ee.__webglFramebuffer[dt][Ae]=a.createFramebuffer()}else Ee.__webglFramebuffer[dt]=a.createFramebuffer()}else{if(d&&Y.mipmaps&&Y.mipmaps.length>0){Ee.__webglFramebuffer=[];for(let dt=0;dt<Y.mipmaps.length;dt++)Ee.__webglFramebuffer[dt]=a.createFramebuffer()}else Ee.__webglFramebuffer=a.createFramebuffer();if(ut)if(s.drawBuffers){const dt=ne.texture;for(let Ae=0,le=dt.length;Ae<le;Ae++){const We=n.get(dt[Ae]);void 0===We.__webglTexture&&(We.__webglTexture=a.createTexture(),u.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(d&&ne.samples>0&&!1===fn(ne)){const dt=ut?Y:[Y];Ee.__webglMultisampledFramebuffer=a.createFramebuffer(),Ee.__webglColorRenderbuffer=[],t.bindFramebuffer(a.FRAMEBUFFER,Ee.__webglMultisampledFramebuffer);for(let Ae=0;Ae<dt.length;Ae++){const le=dt[Ae];Ee.__webglColorRenderbuffer[Ae]=a.createRenderbuffer(),a.bindRenderbuffer(a.RENDERBUFFER,Ee.__webglColorRenderbuffer[Ae]);const We=l.convert(le.format,le.colorSpace),Rt=l.convert(le.type),wt=c(le.internalFormat,We,Rt,le.colorSpace,!0===ne.isXRRenderTarget),At=Vt(ne);a.renderbufferStorageMultisample(a.RENDERBUFFER,At,wt,ne.width,ne.height),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0+Ae,a.RENDERBUFFER,Ee.__webglColorRenderbuffer[Ae])}a.bindRenderbuffer(a.RENDERBUFFER,null),ne.depthBuffer&&(Ee.__webglDepthRenderbuffer=a.createRenderbuffer(),oe(Ee.__webglDepthRenderbuffer,ne,!0)),t.bindFramebuffer(a.FRAMEBUFFER,null)}}if(Ye){t.bindTexture(a.TEXTURE_CUBE_MAP,at.__webglTexture),St(a.TEXTURE_CUBE_MAP,Y,Jt);for(let dt=0;dt<6;dt++)if(d&&Y.mipmaps&&Y.mipmaps.length>0)for(let Ae=0;Ae<Y.mipmaps.length;Ae++)Qt(Ee.__webglFramebuffer[dt][Ae],ne,Y,a.COLOR_ATTACHMENT0,a.TEXTURE_CUBE_MAP_POSITIVE_X+dt,Ae);else Qt(Ee.__webglFramebuffer[dt],ne,Y,a.COLOR_ATTACHMENT0,a.TEXTURE_CUBE_MAP_POSITIVE_X+dt,0);r(Y,Jt)&&o(a.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(ut){const dt=ne.texture;for(let Ae=0,le=dt.length;Ae<le;Ae++){const We=dt[Ae],Rt=n.get(We);t.bindTexture(a.TEXTURE_2D,Rt.__webglTexture),St(a.TEXTURE_2D,We,Jt),Qt(Ee.__webglFramebuffer,ne,We,a.COLOR_ATTACHMENT0+Ae,a.TEXTURE_2D,0),r(We,Jt)&&o(a.TEXTURE_2D)}t.unbindTexture()}else{let dt=a.TEXTURE_2D;if((ne.isWebGL3DRenderTarget||ne.isWebGLArrayRenderTarget)&&(d?dt=ne.isWebGL3DRenderTarget?a.TEXTURE_3D:a.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(dt,at.__webglTexture),St(dt,Y,Jt),d&&Y.mipmaps&&Y.mipmaps.length>0)for(let Ae=0;Ae<Y.mipmaps.length;Ae++)Qt(Ee.__webglFramebuffer[Ae],ne,Y,a.COLOR_ATTACHMENT0,dt,Ae);else Qt(Ee.__webglFramebuffer,ne,Y,a.COLOR_ATTACHMENT0,dt,0);r(Y,Jt)&&o(dt),t.unbindTexture()}ne.depthBuffer&&Fe(ne)},this.updateRenderTargetMipmap=function Xt(ne){const Y=W(ne)||d,Ee=!0===ne.isWebGLMultipleRenderTargets?ne.texture:[ne.texture];for(let at=0,Ye=Ee.length;at<Ye;at++){const ut=Ee[at];if(r(ut,Y)){const Jt=ne.isWebGLCubeRenderTarget?a.TEXTURE_CUBE_MAP:a.TEXTURE_2D,dt=n.get(ut).__webglTexture;t.bindTexture(Jt,dt),o(Jt),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function Ft(ne){if(d&&ne.samples>0&&!1===fn(ne)){const Y=ne.isWebGLMultipleRenderTargets?ne.texture:[ne.texture],Ee=ne.width,at=ne.height;let Ye=a.COLOR_BUFFER_BIT;const ut=[],Jt=ne.stencilBuffer?a.DEPTH_STENCIL_ATTACHMENT:a.DEPTH_ATTACHMENT,dt=n.get(ne),Ae=!0===ne.isWebGLMultipleRenderTargets;if(Ae)for(let le=0;le<Y.length;le++)t.bindFramebuffer(a.FRAMEBUFFER,dt.__webglMultisampledFramebuffer),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0+le,a.RENDERBUFFER,null),t.bindFramebuffer(a.FRAMEBUFFER,dt.__webglFramebuffer),a.framebufferTexture2D(a.DRAW_FRAMEBUFFER,a.COLOR_ATTACHMENT0+le,a.TEXTURE_2D,null,0);t.bindFramebuffer(a.READ_FRAMEBUFFER,dt.__webglMultisampledFramebuffer),t.bindFramebuffer(a.DRAW_FRAMEBUFFER,dt.__webglFramebuffer);for(let le=0;le<Y.length;le++){ut.push(a.COLOR_ATTACHMENT0+le),ne.depthBuffer&&ut.push(Jt);const We=void 0!==dt.__ignoreDepthValues&&dt.__ignoreDepthValues;if(!1===We&&(ne.depthBuffer&&(Ye|=a.DEPTH_BUFFER_BIT),ne.stencilBuffer&&(Ye|=a.STENCIL_BUFFER_BIT)),Ae&&a.framebufferRenderbuffer(a.READ_FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.RENDERBUFFER,dt.__webglColorRenderbuffer[le]),!0===We&&(a.invalidateFramebuffer(a.READ_FRAMEBUFFER,[Jt]),a.invalidateFramebuffer(a.DRAW_FRAMEBUFFER,[Jt])),Ae){const Rt=n.get(Y[le]).__webglTexture;a.framebufferTexture2D(a.DRAW_FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,Rt,0)}a.blitFramebuffer(0,0,Ee,at,0,0,Ee,at,Ye,a.NEAREST),E&&a.invalidateFramebuffer(a.READ_FRAMEBUFFER,ut)}if(t.bindFramebuffer(a.READ_FRAMEBUFFER,null),t.bindFramebuffer(a.DRAW_FRAMEBUFFER,null),Ae)for(let le=0;le<Y.length;le++){t.bindFramebuffer(a.FRAMEBUFFER,dt.__webglMultisampledFramebuffer),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0+le,a.RENDERBUFFER,dt.__webglColorRenderbuffer[le]);const We=n.get(Y[le]).__webglTexture;t.bindFramebuffer(a.FRAMEBUFFER,dt.__webglFramebuffer),a.framebufferTexture2D(a.DRAW_FRAMEBUFFER,a.COLOR_ATTACHMENT0+le,a.TEXTURE_2D,We,0)}t.bindFramebuffer(a.DRAW_FRAMEBUFFER,dt.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=Fe,this.setupFrameBufferTexture=Qt,this.useMultisampledRTT=fn}function DM(a,e,t){const n=t.isWebGL2;return{convert:function s(l,u=""){let d;if(l===ho)return a.UNSIGNED_BYTE;if(1017===l)return a.UNSIGNED_SHORT_4_4_4_4;if(1018===l)return a.UNSIGNED_SHORT_5_5_5_1;if(1010===l)return a.BYTE;if(1011===l)return a.SHORT;if(1012===l)return a.UNSIGNED_SHORT;if(1013===l)return a.INT;if(l===Ue)return a.UNSIGNED_INT;if(l===an)return a.FLOAT;if(l===Ha)return n?a.HALF_FLOAT:(d=e.get("OES_texture_half_float"),null!==d?d.HALF_FLOAT_OES:null);if(1021===l)return a.ALPHA;if(l===Er)return a.RGBA;if(1024===l)return a.LUMINANCE;if(1025===l)return a.LUMINANCE_ALPHA;if(l===mo)return a.DEPTH_COMPONENT;if(l===ya)return a.DEPTH_STENCIL;if(1035===l)return d=e.get("EXT_sRGB"),null!==d?d.SRGB_ALPHA_EXT:null;if(1028===l)return a.RED;if(1029===l)return a.RED_INTEGER;if(1030===l)return a.RG;if(1031===l)return a.RG_INTEGER;if(1033===l)return a.RGBA_INTEGER;if(33776===l||33777===l||33778===l||33779===l)if(u===rn){if(d=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===d)return null;if(33776===l)return d.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===l)return d.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===l)return d.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===l)return d.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(d=e.get("WEBGL_compressed_texture_s3tc"),null===d)return null;if(33776===l)return d.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===l)return d.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===l)return d.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===l)return d.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===l||35841===l||35842===l||35843===l){if(d=e.get("WEBGL_compressed_texture_pvrtc"),null===d)return null;if(35840===l)return d.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===l)return d.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===l)return d.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===l)return d.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===l)return d=e.get("WEBGL_compressed_texture_etc1"),null!==d?d.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===l||37496===l){if(d=e.get("WEBGL_compressed_texture_etc"),null===d)return null;if(37492===l)return u===rn?d.COMPRESSED_SRGB8_ETC2:d.COMPRESSED_RGB8_ETC2;if(37496===l)return u===rn?d.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:d.COMPRESSED_RGBA8_ETC2_EAC}if(37808===l||37809===l||37810===l||37811===l||37812===l||37813===l||37814===l||37815===l||37816===l||37817===l||37818===l||37819===l||37820===l||37821===l){if(d=e.get("WEBGL_compressed_texture_astc"),null===d)return null;if(37808===l)return u===rn?d.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:d.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===l)return u===rn?d.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:d.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===l)return u===rn?d.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:d.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===l)return u===rn?d.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:d.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===l)return u===rn?d.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:d.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===l)return u===rn?d.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:d.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===l)return u===rn?d.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:d.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===l)return u===rn?d.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:d.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===l)return u===rn?d.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:d.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===l)return u===rn?d.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:d.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===l)return u===rn?d.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:d.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===l)return u===rn?d.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:d.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===l)return u===rn?d.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:d.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===l)return u===rn?d.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:d.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===l){if(d=e.get("EXT_texture_compression_bptc"),null===d)return null;if(36492===l)return u===rn?d.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:d.COMPRESSED_RGBA_BPTC_UNORM_EXT}if(36283===l||36284===l||36285===l||36286===l){if(d=e.get("EXT_texture_compression_rgtc"),null===d)return null;if(36492===l)return d.COMPRESSED_RED_RGTC1_EXT;if(36284===l)return d.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===l)return d.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===l)return d.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return l===vs?n?a.UNSIGNED_INT_24_8:(d=e.get("WEBGL_depth_texture"),null!==d?d.UNSIGNED_INT_24_8_WEBGL:null):void 0!==a[l]?a[l]:null}}}class Vy extends Br{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Vc extends Tr{constructor(){super(),this.isGroup=!0,this.type="Group"}}const RM={type:"move"};class Pf{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Vc,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Vc,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new K,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new K),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Vc,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new K,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new K),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,n){let s=null,l=null,u=null;const d=this._targetRay,p=this._grip,g=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(g&&e.hand){u=!0;for(const F of e.hand.values()){const P=t.getJointPose(F,n),R=this._getHandJoint(g,F);null!==P&&(R.matrix.fromArray(P.transform.matrix),R.matrix.decompose(R.position,R.rotation,R.scale),R.matrixWorldNeedsUpdate=!0,R.jointRadius=P.radius),R.visible=null!==P}const w=g.joints["index-finger-tip"].position.distanceTo(g.joints["thumb-tip"].position),E=.02,D=.005;g.inputState.pinching&&w>E+D?(g.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!g.inputState.pinching&&w<=E-D&&(g.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==p&&e.gripSpace&&(l=t.getPose(e.gripSpace,n),null!==l&&(p.matrix.fromArray(l.transform.matrix),p.matrix.decompose(p.position,p.rotation,p.scale),p.matrixWorldNeedsUpdate=!0,l.linearVelocity?(p.hasLinearVelocity=!0,p.linearVelocity.copy(l.linearVelocity)):p.hasLinearVelocity=!1,l.angularVelocity?(p.hasAngularVelocity=!0,p.angularVelocity.copy(l.angularVelocity)):p.hasAngularVelocity=!1));null!==d&&(s=t.getPose(e.targetRaySpace,n),null===s&&null!==l&&(s=l),null!==s&&(d.matrix.fromArray(s.transform.matrix),d.matrix.decompose(d.position,d.rotation,d.scale),d.matrixWorldNeedsUpdate=!0,s.linearVelocity?(d.hasLinearVelocity=!0,d.linearVelocity.copy(s.linearVelocity)):d.hasLinearVelocity=!1,s.angularVelocity?(d.hasAngularVelocity=!0,d.angularVelocity.copy(s.angularVelocity)):d.hasAngularVelocity=!1,this.dispatchEvent(RM)))}return null!==d&&(d.visible=null!==s),null!==p&&(p.visible=null!==l),null!==g&&(g.visible=null!==u),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const n=new Vc;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class IM extends ws{constructor(e,t,n,s,l,u,d,p,g,_){if((_=void 0!==_?_:mo)!==mo&&_!==ya)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&_===mo&&(n=Ue),void 0===n&&_===ya&&(n=vs),super(null,s,l,u,d,p,_,n,g),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==d?d:di,this.minFilter=void 0!==p?p:di,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}class PM extends Ja{constructor(e,t){super();const n=this;let s=null,l=1,u=null,d="local-floor",p=1,g=null,_=null,M=null,w=null,E=null,D=null;const F=t.getContextAttributes();let P=null,R=null;const V=[],k=[],W=new Br;W.layers.enable(1),W.viewport=new ii;const i=new Br;i.layers.enable(2),i.viewport=new ii;const r=[W,i],o=new Vy;o.layers.enable(1),o.layers.enable(2);let c=null,h=null;function f(ie){const de=k.indexOf(ie.inputSource);if(-1===de)return;const he=V[de];void 0!==he&&(he.update(ie.inputSource,ie.frame,g||u),he.dispatchEvent({type:ie.type,data:ie.inputSource}))}function x(){s.removeEventListener("select",f),s.removeEventListener("selectstart",f),s.removeEventListener("selectend",f),s.removeEventListener("squeeze",f),s.removeEventListener("squeezestart",f),s.removeEventListener("squeezeend",f),s.removeEventListener("end",x),s.removeEventListener("inputsourceschange",b);for(let ie=0;ie<V.length;ie++){const de=k[ie];null!==de&&(k[ie]=null,V[ie].disconnect(de))}c=null,h=null,e.setRenderTarget(P),E=null,w=null,M=null,s=null,R=null,ce.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function b(ie){for(let de=0;de<ie.removed.length;de++){const he=ie.removed[de],be=k.indexOf(he);be>=0&&(k[be]=null,V[be].disconnect(he))}for(let de=0;de<ie.added.length;de++){const he=ie.added[de];let be=k.indexOf(he);if(-1===be){for(let ot=0;ot<V.length;ot++){if(ot>=k.length){k.push(he),be=ot;break}if(null===k[ot]){k[ot]=he,be=ot;break}}if(-1===be)break}const Pe=V[be];Pe&&Pe.connect(he)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(ie){let de=V[ie];return void 0===de&&(de=new Pf,V[ie]=de),de.getTargetRaySpace()},this.getControllerGrip=function(ie){let de=V[ie];return void 0===de&&(de=new Pf,V[ie]=de),de.getGripSpace()},this.getHand=function(ie){let de=V[ie];return void 0===de&&(de=new Pf,V[ie]=de),de.getHandSpace()},this.setFramebufferScaleFactor=function(ie){l=ie,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ie){d=ie,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return g||u},this.setReferenceSpace=function(ie){g=ie},this.getBaseLayer=function(){return null!==w?w:E},this.getBinding=function(){return M},this.getFrame=function(){return D},this.getSession=function(){return s},this.setSession=function(){var ie=function fa(a){return function(){var e=this,t=arguments;return new Promise(function(n,s){var l=a.apply(e,t);function u(p){$n(l,n,s,u,d,"next",p)}function d(p){$n(l,n,s,u,d,"throw",p)}u(void 0)})}}(function*(de){if(s=de,null!==s){if(P=e.getRenderTarget(),s.addEventListener("select",f),s.addEventListener("selectstart",f),s.addEventListener("selectend",f),s.addEventListener("squeeze",f),s.addEventListener("squeezestart",f),s.addEventListener("squeezeend",f),s.addEventListener("end",x),s.addEventListener("inputsourceschange",b),!0!==F.xrCompatible&&(yield t.makeXRCompatible()),void 0===s.renderState.layers||!1===e.capabilities.isWebGL2)E=new XRWebGLLayer(s,t,{antialias:void 0!==s.renderState.layers||F.antialias,alpha:!0,depth:F.depth,stencil:F.stencil,framebufferScaleFactor:l}),s.updateRenderState({baseLayer:E}),R=new bc(E.framebufferWidth,E.framebufferHeight,{format:Er,type:ho,colorSpace:e.outputColorSpace,stencilBuffer:F.stencil});else{let he=null,be=null,Pe=null;F.depth&&(Pe=F.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,he=F.stencil?ya:mo,be=F.stencil?vs:Ue);const ot={colorFormat:t.RGBA8,depthFormat:Pe,scaleFactor:l};M=new XRWebGLBinding(s,t),w=M.createProjectionLayer(ot),s.updateRenderState({layers:[w]}),R=new bc(w.textureWidth,w.textureHeight,{format:Er,type:ho,depthTexture:new IM(w.textureWidth,w.textureHeight,be,void 0,void 0,void 0,void 0,void 0,void 0,he),stencilBuffer:F.stencil,colorSpace:e.outputColorSpace,samples:F.antialias?4:0}),e.properties.get(R).__ignoreDepthValues=w.ignoreDepthValues}R.isXRRenderTarget=!0,this.setFoveation(p),g=null,u=yield s.requestReferenceSpace(d),ce.setContext(s),ce.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}});return function(de){return ie.apply(this,arguments)}}(),this.getEnvironmentBlendMode=function(){if(null!==s)return s.environmentBlendMode};const C=new K,L=new K;function G(ie,de){null===de?ie.matrixWorld.copy(ie.matrix):ie.matrixWorld.multiplyMatrices(de.matrixWorld,ie.matrix),ie.matrixWorldInverse.copy(ie.matrixWorld).invert()}this.updateCamera=function(ie){if(null===s)return;o.near=i.near=W.near=ie.near,o.far=i.far=W.far=ie.far,(c!==o.near||h!==o.far)&&(s.updateRenderState({depthNear:o.near,depthFar:o.far}),c=o.near,h=o.far);const de=ie.parent,he=o.cameras;G(o,de);for(let be=0;be<he.length;be++)G(he[be],de);2===he.length?function N(ie,de,he){C.setFromMatrixPosition(de.matrixWorld),L.setFromMatrixPosition(he.matrixWorld);const be=C.distanceTo(L),Pe=de.projectionMatrix.elements,ot=he.projectionMatrix.elements,St=Pe[14]/(Pe[10]-1),Pt=Pe[14]/(Pe[10]+1),Ln=(Pe[9]+1)/Pe[5],ri=(Pe[9]-1)/Pe[5],Qt=(Pe[8]-1)/Pe[0],oe=(ot[8]+1)/ot[0],ct=St*Qt,Fe=St*oe,tt=be/(-Qt+oe),Ge=tt*-Qt;de.matrixWorld.decompose(ie.position,ie.quaternion,ie.scale),ie.translateX(Ge),ie.translateZ(tt),ie.matrixWorld.compose(ie.position,ie.quaternion,ie.scale),ie.matrixWorldInverse.copy(ie.matrixWorld).invert();const Xt=St+tt,Ft=Pt+tt;ie.projectionMatrix.makePerspective(ct-Ge,Fe+(be-Ge),Ln*Pt/Ft*Xt,ri*Pt/Ft*Xt,Xt,Ft),ie.projectionMatrixInverse.copy(ie.projectionMatrix).invert()}(o,W,i):o.projectionMatrix.copy(W.projectionMatrix),function X(ie,de,he){null===he?ie.matrix.copy(de.matrixWorld):(ie.matrix.copy(he.matrixWorld),ie.matrix.invert(),ie.matrix.multiply(de.matrixWorld)),ie.matrix.decompose(ie.position,ie.quaternion,ie.scale),ie.updateMatrixWorld(!0);const be=ie.children;for(let Pe=0,ot=be.length;Pe<ot;Pe++)be[Pe].updateMatrixWorld(!0);ie.projectionMatrix.copy(de.projectionMatrix),ie.projectionMatrixInverse.copy(de.projectionMatrixInverse),ie.isPerspectiveCamera&&(ie.fov=2*yu*Math.atan(1/ie.projectionMatrix.elements[5]),ie.zoom=1)}(ie,o,de)},this.getCamera=function(){return o},this.getFoveation=function(){if(null!==w||null!==E)return p},this.setFoveation=function(ie){p=ie,null!==w&&(w.fixedFoveation=ie),null!==E&&void 0!==E.fixedFoveation&&(E.fixedFoveation=ie)};let Z=null;const ce=new Vh;ce.setAnimationLoop(function re(ie,de){if(_=de.getViewerPose(g||u),D=de,null!==_){const he=_.views;null!==E&&(e.setRenderTargetFramebuffer(R,E.framebuffer),e.setRenderTarget(R));let be=!1;he.length!==o.cameras.length&&(o.cameras.length=0,be=!0);for(let Pe=0;Pe<he.length;Pe++){const ot=he[Pe];let St=null;if(null!==E)St=E.getViewport(ot);else{const Ln=M.getViewSubImage(w,ot);St=Ln.viewport,0===Pe&&(e.setRenderTargetTextures(R,Ln.colorTexture,w.ignoreDepthValues?void 0:Ln.depthStencilTexture),e.setRenderTarget(R))}let Pt=r[Pe];void 0===Pt&&(Pt=new Br,Pt.layers.enable(Pe),Pt.viewport=new ii,r[Pe]=Pt),Pt.matrix.fromArray(ot.transform.matrix),Pt.matrix.decompose(Pt.position,Pt.quaternion,Pt.scale),Pt.projectionMatrix.fromArray(ot.projectionMatrix),Pt.projectionMatrixInverse.copy(Pt.projectionMatrix).invert(),Pt.viewport.set(St.x,St.y,St.width,St.height),0===Pe&&(o.matrix.copy(Pt.matrix),o.matrix.decompose(o.position,o.quaternion,o.scale)),!0===be&&o.cameras.push(Pt)}}for(let he=0;he<V.length;he++){const be=k[he],Pe=V[he];null!==be&&void 0!==Pe&&Pe.update(be,de,g||u)}Z&&Z(ie,de),de.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:de}),D=null}),this.setAnimationLoop=function(ie){Z=ie},this.dispose=function(){}}}function zy(a,e){function t(P,R){!0===P.matrixAutoUpdate&&P.updateMatrix(),R.value.copy(P.matrix)}function l(P,R){P.opacity.value=R.opacity,R.color&&P.diffuse.value.copy(R.color),R.emissive&&P.emissive.value.copy(R.emissive).multiplyScalar(R.emissiveIntensity),R.map&&(P.map.value=R.map,t(R.map,P.mapTransform)),R.alphaMap&&(P.alphaMap.value=R.alphaMap,t(R.alphaMap,P.alphaMapTransform)),R.bumpMap&&(P.bumpMap.value=R.bumpMap,t(R.bumpMap,P.bumpMapTransform),P.bumpScale.value=R.bumpScale,1===R.side&&(P.bumpScale.value*=-1)),R.normalMap&&(P.normalMap.value=R.normalMap,t(R.normalMap,P.normalMapTransform),P.normalScale.value.copy(R.normalScale),1===R.side&&P.normalScale.value.negate()),R.displacementMap&&(P.displacementMap.value=R.displacementMap,t(R.displacementMap,P.displacementMapTransform),P.displacementScale.value=R.displacementScale,P.displacementBias.value=R.displacementBias),R.emissiveMap&&(P.emissiveMap.value=R.emissiveMap,t(R.emissiveMap,P.emissiveMapTransform)),R.specularMap&&(P.specularMap.value=R.specularMap,t(R.specularMap,P.specularMapTransform)),R.alphaTest>0&&(P.alphaTest.value=R.alphaTest);const V=e.get(R).envMap;if(V&&(P.envMap.value=V,P.flipEnvMap.value=V.isCubeTexture&&!1===V.isRenderTargetTexture?-1:1,P.reflectivity.value=R.reflectivity,P.ior.value=R.ior,P.refractionRatio.value=R.refractionRatio),R.lightMap){P.lightMap.value=R.lightMap;const k=!0===a._useLegacyLights?Math.PI:1;P.lightMapIntensity.value=R.lightMapIntensity*k,t(R.lightMap,P.lightMapTransform)}R.aoMap&&(P.aoMap.value=R.aoMap,P.aoMapIntensity.value=R.aoMapIntensity,t(R.aoMap,P.aoMapTransform))}return{refreshFogUniforms:function n(P,R){R.color.getRGB(P.fogColor.value,ea(a)),R.isFog?(P.fogNear.value=R.near,P.fogFar.value=R.far):R.isFogExp2&&(P.fogDensity.value=R.density)},refreshMaterialUniforms:function s(P,R,V,k,W){R.isMeshBasicMaterial||R.isMeshLambertMaterial?l(P,R):R.isMeshToonMaterial?(l(P,R),function M(P,R){R.gradientMap&&(P.gradientMap.value=R.gradientMap)}(P,R)):R.isMeshPhongMaterial?(l(P,R),function _(P,R){P.specular.value.copy(R.specular),P.shininess.value=Math.max(R.shininess,1e-4)}(P,R)):R.isMeshStandardMaterial?(l(P,R),function w(P,R){P.metalness.value=R.metalness,R.metalnessMap&&(P.metalnessMap.value=R.metalnessMap,t(R.metalnessMap,P.metalnessMapTransform)),P.roughness.value=R.roughness,R.roughnessMap&&(P.roughnessMap.value=R.roughnessMap,t(R.roughnessMap,P.roughnessMapTransform)),e.get(R).envMap&&(P.envMapIntensity.value=R.envMapIntensity)}(P,R),R.isMeshPhysicalMaterial&&function E(P,R,V){P.ior.value=R.ior,R.sheen>0&&(P.sheenColor.value.copy(R.sheenColor).multiplyScalar(R.sheen),P.sheenRoughness.value=R.sheenRoughness,R.sheenColorMap&&(P.sheenColorMap.value=R.sheenColorMap,t(R.sheenColorMap,P.sheenColorMapTransform)),R.sheenRoughnessMap&&(P.sheenRoughnessMap.value=R.sheenRoughnessMap,t(R.sheenRoughnessMap,P.sheenRoughnessMapTransform))),R.clearcoat>0&&(P.clearcoat.value=R.clearcoat,P.clearcoatRoughness.value=R.clearcoatRoughness,R.clearcoatMap&&(P.clearcoatMap.value=R.clearcoatMap,t(R.clearcoatMap,P.clearcoatMapTransform)),R.clearcoatRoughnessMap&&(P.clearcoatRoughnessMap.value=R.clearcoatRoughnessMap,t(R.clearcoatRoughnessMap,P.clearcoatRoughnessMapTransform)),R.clearcoatNormalMap&&(P.clearcoatNormalMap.value=R.clearcoatNormalMap,t(R.clearcoatNormalMap,P.clearcoatNormalMapTransform),P.clearcoatNormalScale.value.copy(R.clearcoatNormalScale),1===R.side&&P.clearcoatNormalScale.value.negate())),R.iridescence>0&&(P.iridescence.value=R.iridescence,P.iridescenceIOR.value=R.iridescenceIOR,P.iridescenceThicknessMinimum.value=R.iridescenceThicknessRange[0],P.iridescenceThicknessMaximum.value=R.iridescenceThicknessRange[1],R.iridescenceMap&&(P.iridescenceMap.value=R.iridescenceMap,t(R.iridescenceMap,P.iridescenceMapTransform)),R.iridescenceThicknessMap&&(P.iridescenceThicknessMap.value=R.iridescenceThicknessMap,t(R.iridescenceThicknessMap,P.iridescenceThicknessMapTransform))),R.transmission>0&&(P.transmission.value=R.transmission,P.transmissionSamplerMap.value=V.texture,P.transmissionSamplerSize.value.set(V.width,V.height),R.transmissionMap&&(P.transmissionMap.value=R.transmissionMap,t(R.transmissionMap,P.transmissionMapTransform)),P.thickness.value=R.thickness,R.thicknessMap&&(P.thicknessMap.value=R.thicknessMap,t(R.thicknessMap,P.thicknessMapTransform)),P.attenuationDistance.value=R.attenuationDistance,P.attenuationColor.value.copy(R.attenuationColor)),R.anisotropy>0&&(P.anisotropyVector.value.set(R.anisotropy*Math.cos(R.anisotropyRotation),R.anisotropy*Math.sin(R.anisotropyRotation)),R.anisotropyMap&&(P.anisotropyMap.value=R.anisotropyMap,t(R.anisotropyMap,P.anisotropyMapTransform))),P.specularIntensity.value=R.specularIntensity,P.specularColor.value.copy(R.specularColor),R.specularColorMap&&(P.specularColorMap.value=R.specularColorMap,t(R.specularColorMap,P.specularColorMapTransform)),R.specularIntensityMap&&(P.specularIntensityMap.value=R.specularIntensityMap,t(R.specularIntensityMap,P.specularIntensityMapTransform))}(P,R,W)):R.isMeshMatcapMaterial?(l(P,R),function D(P,R){R.matcap&&(P.matcap.value=R.matcap)}(P,R)):R.isMeshDepthMaterial?l(P,R):R.isMeshDistanceMaterial?(l(P,R),function F(P,R){const V=e.get(R).light;P.referencePosition.value.setFromMatrixPosition(V.matrixWorld),P.nearDistance.value=V.shadow.camera.near,P.farDistance.value=V.shadow.camera.far}(P,R)):R.isMeshNormalMaterial?l(P,R):R.isLineBasicMaterial?(function u(P,R){P.diffuse.value.copy(R.color),P.opacity.value=R.opacity,R.map&&(P.map.value=R.map,t(R.map,P.mapTransform))}(P,R),R.isLineDashedMaterial&&function d(P,R){P.dashSize.value=R.dashSize,P.totalSize.value=R.dashSize+R.gapSize,P.scale.value=R.scale}(P,R)):R.isPointsMaterial?function p(P,R,V,k){P.diffuse.value.copy(R.color),P.opacity.value=R.opacity,P.size.value=R.size*V,P.scale.value=.5*k,R.map&&(P.map.value=R.map,t(R.map,P.uvTransform)),R.alphaMap&&(P.alphaMap.value=R.alphaMap,t(R.alphaMap,P.alphaMapTransform)),R.alphaTest>0&&(P.alphaTest.value=R.alphaTest)}(P,R,V,k):R.isSpriteMaterial?function g(P,R){P.diffuse.value.copy(R.color),P.opacity.value=R.opacity,P.rotation.value=R.rotation,R.map&&(P.map.value=R.map,t(R.map,P.mapTransform)),R.alphaMap&&(P.alphaMap.value=R.alphaMap,t(R.alphaMap,P.alphaMapTransform)),R.alphaTest>0&&(P.alphaTest.value=R.alphaTest)}(P,R):R.isShadowMaterial?(P.color.value.copy(R.color),P.opacity.value=R.opacity):R.isShaderMaterial&&(R.uniformsNeedUpdate=!1)}}}function LM(a,e,t,n){let s={},l={},u=[];const d=t.isWebGL2?a.getParameter(a.MAX_UNIFORM_BUFFER_BINDINGS):0;function E(V,k,W){const i=V.value;if(void 0===W[k]){if("number"==typeof i)W[k]=i;else{const r=Array.isArray(i)?i:[i],o=[];for(let c=0;c<r.length;c++)o.push(r[c].clone());W[k]=o}return!0}if("number"==typeof i){if(W[k]!==i)return W[k]=i,!0}else{const r=Array.isArray(W[k])?W[k]:[W[k]],o=Array.isArray(i)?i:[i];for(let c=0;c<r.length;c++){const h=r[c];if(!1===h.equals(o[c]))return h.copy(o[c]),!0}}return!1}function F(V){const k={boundary:0,storage:0};return"number"==typeof V?(k.boundary=4,k.storage=4):V.isVector2?(k.boundary=8,k.storage=8):V.isVector3||V.isColor?(k.boundary=16,k.storage=12):V.isVector4?(k.boundary=16,k.storage=16):V.isMatrix3?(k.boundary=48,k.storage=48):V.isMatrix4?(k.boundary=64,k.storage=64):V.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",V),k}function P(V){const k=V.target;k.removeEventListener("dispose",P);const W=u.indexOf(k.__bindingPointIndex);u.splice(W,1),a.deleteBuffer(s[k.id]),delete s[k.id],delete l[k.id]}return{bind:function p(V,k){n.uniformBlockBinding(V,k.program)},update:function g(V,k){let W=s[V.id];void 0===W&&(function D(V){const k=V.uniforms;let W=0;let r=0;for(let o=0,c=k.length;o<c;o++){const h=k[o],f={boundary:0,storage:0},x=Array.isArray(h.value)?h.value:[h.value];for(let b=0,C=x.length;b<C;b++){const N=F(x[b]);f.boundary+=N.boundary,f.storage+=N.storage}if(h.__data=new Float32Array(f.storage/Float32Array.BYTES_PER_ELEMENT),h.__offset=W,o>0){r=W%16;const b=16-r;0!==r&&b-f.boundary<0&&(W+=16-r,h.__offset=W)}W+=f.storage}r=W%16,r>0&&(W+=16-r),V.__size=W,V.__cache={}}(V),W=function _(V){const k=function M(){for(let V=0;V<d;V++)if(-1===u.indexOf(V))return u.push(V),V;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();V.__bindingPointIndex=k;const W=a.createBuffer(),i=V.__size,r=V.usage;return a.bindBuffer(a.UNIFORM_BUFFER,W),a.bufferData(a.UNIFORM_BUFFER,i,r),a.bindBuffer(a.UNIFORM_BUFFER,null),a.bindBufferBase(a.UNIFORM_BUFFER,k,W),W}(V),s[V.id]=W,V.addEventListener("dispose",P)),n.updateUBOMapping(V,k.program);const r=e.render.frame;l[V.id]!==r&&(function w(V){const W=V.uniforms,i=V.__cache;a.bindBuffer(a.UNIFORM_BUFFER,s[V.id]);for(let r=0,o=W.length;r<o;r++){const c=W[r];if(!0===E(c,r,i)){const h=c.__offset,f=Array.isArray(c.value)?c.value:[c.value];let x=0;for(let b=0;b<f.length;b++){const C=f[b],L=F(C);"number"==typeof C?(c.__data[0]=C,a.bufferSubData(a.UNIFORM_BUFFER,h+x,c.__data)):C.isMatrix3?(c.__data[0]=C.elements[0],c.__data[1]=C.elements[1],c.__data[2]=C.elements[2],c.__data[3]=C.elements[0],c.__data[4]=C.elements[3],c.__data[5]=C.elements[4],c.__data[6]=C.elements[5],c.__data[7]=C.elements[0],c.__data[8]=C.elements[6],c.__data[9]=C.elements[7],c.__data[10]=C.elements[8],c.__data[11]=C.elements[0]):(C.toArray(c.__data,x),x+=L.storage/Float32Array.BYTES_PER_ELEMENT)}a.bufferSubData(a.UNIFORM_BUFFER,h,c.__data)}}a.bindBuffer(a.UNIFORM_BUFFER,null)}(V),l[V.id]=r)},dispose:function R(){for(const V in s)a.deleteBuffer(s[V]);u=[],s={},l={}}}}function Hy(){const a=xc("canvas");return a.style.display="block",a}class ig{constructor(e={}){const{canvas:t=Hy(),context:n=null,depth:s=!0,stencil:l=!0,alpha:u=!1,antialias:d=!1,premultipliedAlpha:p=!0,preserveDrawingBuffer:g=!1,powerPreference:_="default",failIfMajorPerformanceCaveat:M=!1}=e;let w;this.isWebGLRenderer=!0,w=null!==n?n.getContextAttributes().alpha:u;const E=new Uint32Array(4),D=new Int32Array(4);let F=null,P=null;const R=[],V=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputColorSpace=rn,this._useLegacyLights=!1,this.toneMapping=0,this.toneMappingExposure=1;const k=this;let W=!1,i=0,r=0,o=null,c=-1,h=null;const f=new ii,x=new ii;let b=null;const C=new pt(0);let L=0,N=t.width,G=t.height,X=1,Z=null,re=null;const ce=new ii(0,0,N,G),ie=new ii(0,0,N,G);let de=!1;const he=new vf;let be=!1,Pe=!1,ot=null;const St=new Bt,Pt=new ke,Ln=new K,ri={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Qt(){return null===o?X:1}let Fe,tt,Ge,Xt,Ft,Vt,fn,Xn,Ji,ne,Y,Ee,at,Ye,ut,Jt,dt,Ae,le,We,Rt,wt,At,wn,oe=n;function ct(ee,_e){for(let Oe=0;Oe<ee.length;Oe++){const Le=t.getContext(ee[Oe],_e);if(null!==Le)return Le}return null}try{const ee={alpha:!0,depth:s,stencil:l,antialias:d,premultipliedAlpha:p,preserveDrawingBuffer:g,powerPreference:_,failIfMajorPerformanceCaveat:M};if("setAttribute"in t&&t.setAttribute("data-engine","three.js r155"),t.addEventListener("webglcontextlost",Ct,!1),t.addEventListener("webglcontextrestored",Ce,!1),t.addEventListener("webglcontextcreationerror",it,!1),null===oe){const _e=["webgl2","webgl","experimental-webgl"];if(!0===k.isWebGL1Renderer&&_e.shift(),oe=ct(_e,ee),null===oe)throw ct(_e)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}"undefined"!=typeof WebGLRenderingContext&&oe instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),void 0===oe.getShaderPrecisionFormat&&(oe.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(ee){throw console.error("THREE.WebGLRenderer: "+ee.message),ee}function ei(){Fe=new Qx(oe),tt=new ay(oe,Fe,e),Fe.init(tt),wt=new DM(oe,Fe,tt),Ge=new Uy(oe,Fe,tt),Xt=new Lm(oe),Ft=new Qm,Vt=new By(oe,Fe,Ge,Ft,tt,wt,Xt),fn=new Kx(k),Xn=new Pm(k),Ji=new kv(oe,tt),At=new Yx(oe,Fe,Ji,tt),ne=new eM(oe,Ji,Xt,At),Y=new py(oe,ne,Ji,Xt),le=new Fm(oe,tt,Vt),Jt=new Zx(Ft),Ee=new So(k,fn,Xn,Fe,tt,At,Jt),at=new zy(k,Ft),Ye=new Hu,ut=new Oy(Fe,tt),Ae=new lE(k,fn,Xn,Ge,Y,w,p),dt=new ky(k,Y,tt),wn=new LM(oe,Xt,tt,Ge),We=new Am(oe,Fe,Xt,tt),Rt=new Tf(oe,Fe,Xt,tt),Xt.programs=Ee.programs,k.capabilities=tt,k.extensions=Fe,k.properties=Ft,k.renderLists=Ye,k.shadowMap=dt,k.state=Ge,k.info=Xt}ei();const fe=new PM(k,oe);function Ct(ee){ee.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),W=!0}function Ce(){console.log("THREE.WebGLRenderer: Context Restored."),W=!1;const ee=Xt.autoReset,_e=dt.enabled,Oe=dt.autoUpdate,ve=dt.needsUpdate,Le=dt.type;ei(),Xt.autoReset=ee,dt.enabled=_e,dt.autoUpdate=Oe,dt.needsUpdate=ve,dt.type=Le}function it(ee){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",ee.statusMessage)}function Tt(ee){const _e=ee.target;_e.removeEventListener("dispose",Tt),function Hn(ee){(function xi(ee){const _e=Ft.get(ee).programs;void 0!==_e&&(_e.forEach(function(Oe){Ee.releaseProgram(Oe)}),ee.isShaderMaterial&&Ee.releaseShaderCache(ee))})(ee),Ft.remove(ee)}(_e)}this.xr=fe,this.getContext=function(){return oe},this.getContextAttributes=function(){return oe.getContextAttributes()},this.forceContextLoss=function(){const ee=Fe.get("WEBGL_lose_context");ee&&ee.loseContext()},this.forceContextRestore=function(){const ee=Fe.get("WEBGL_lose_context");ee&&ee.restoreContext()},this.getPixelRatio=function(){return X},this.setPixelRatio=function(ee){void 0!==ee&&(X=ee,this.setSize(N,G,!1))},this.getSize=function(ee){return ee.set(N,G)},this.setSize=function(ee,_e,Oe=!0){fe.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(N=ee,G=_e,t.width=Math.floor(ee*X),t.height=Math.floor(_e*X),!0===Oe&&(t.style.width=ee+"px",t.style.height=_e+"px"),this.setViewport(0,0,ee,_e))},this.getDrawingBufferSize=function(ee){return ee.set(N*X,G*X).floor()},this.setDrawingBufferSize=function(ee,_e,Oe){N=ee,G=_e,X=Oe,t.width=Math.floor(ee*Oe),t.height=Math.floor(_e*Oe),this.setViewport(0,0,ee,_e)},this.getCurrentViewport=function(ee){return ee.copy(f)},this.getViewport=function(ee){return ee.copy(ce)},this.setViewport=function(ee,_e,Oe,ve){ee.isVector4?ce.set(ee.x,ee.y,ee.z,ee.w):ce.set(ee,_e,Oe,ve),Ge.viewport(f.copy(ce).multiplyScalar(X).floor())},this.getScissor=function(ee){return ee.copy(ie)},this.setScissor=function(ee,_e,Oe,ve){ee.isVector4?ie.set(ee.x,ee.y,ee.z,ee.w):ie.set(ee,_e,Oe,ve),Ge.scissor(x.copy(ie).multiplyScalar(X).floor())},this.getScissorTest=function(){return de},this.setScissorTest=function(ee){Ge.setScissorTest(de=ee)},this.setOpaqueSort=function(ee){Z=ee},this.setTransparentSort=function(ee){re=ee},this.getClearColor=function(ee){return ee.copy(Ae.getClearColor())},this.setClearColor=function(){Ae.setClearColor.apply(Ae,arguments)},this.getClearAlpha=function(){return Ae.getClearAlpha()},this.setClearAlpha=function(){Ae.setClearAlpha.apply(Ae,arguments)},this.clear=function(ee=!0,_e=!0,Oe=!0){let ve=0;if(ee){let Le=!1;if(null!==o){const Ht=o.texture.format;Le=1033===Ht||1031===Ht||1029===Ht}if(Le){const Ht=o.texture.type,hn=Ht===ho||Ht===Ue||1012===Ht||Ht===vs||1017===Ht||1018===Ht,vn=Ae.getClearColor(),yn=Ae.getClearAlpha(),qn=vn.r,gn=vn.g,On=vn.b;hn?(E[0]=qn,E[1]=gn,E[2]=On,E[3]=yn,oe.clearBufferuiv(oe.COLOR,0,E)):(D[0]=qn,D[1]=gn,D[2]=On,D[3]=yn,oe.clearBufferiv(oe.COLOR,0,D))}else ve|=oe.COLOR_BUFFER_BIT}_e&&(ve|=oe.DEPTH_BUFFER_BIT),Oe&&(ve|=oe.STENCIL_BUFFER_BIT),oe.clear(ve)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Ct,!1),t.removeEventListener("webglcontextrestored",Ce,!1),t.removeEventListener("webglcontextcreationerror",it,!1),Ye.dispose(),ut.dispose(),Ft.dispose(),fn.dispose(),Xn.dispose(),Y.dispose(),At.dispose(),wn.dispose(),Ee.dispose(),fe.dispose(),fe.removeEventListener("sessionstart",ji),fe.removeEventListener("sessionend",tc),ot&&(ot.dispose(),ot=null),ro.stop()},this.renderBufferDirect=function(ee,_e,Oe,ve,Le,Ht){null===_e&&(_e=ri);const hn=Le.isMesh&&Le.matrixWorld.determinant()<0,vn=function NS(ee,_e,Oe,ve,Le){!0!==_e.isScene&&(_e=ri),Vt.resetTextureUnits();const Ht=_e.fog,vn=null===o?k.outputColorSpace:!0===o.isXRRenderTarget?o.texture.colorSpace:Nr,yn=(ve.isMeshStandardMaterial?Xn:fn).get(ve.envMap||(ve.isMeshStandardMaterial?_e.environment:null)),qn=!0===ve.vertexColors&&!!Oe.attributes.color&&4===Oe.attributes.color.itemSize,gn=!!Oe.attributes.tangent&&(!!ve.normalMap||ve.anisotropy>0),On=!!Oe.morphAttributes.position,_r=!!Oe.morphAttributes.normal,Rr=!!Oe.morphAttributes.color;let Na=0;ve.toneMapped&&(null===o||!0===o.isXRRenderTarget)&&(Na=k.toneMapping);const lu=Oe.morphAttributes.position||Oe.morphAttributes.normal||Oe.morphAttributes.color,Vr=void 0!==lu?lu.length:0,Jn=Ft.get(ve),_b=P.state.lights;!0!==be||!0!==Pe&&ee===h||Jt.setState(ve,ee,ee===h&&ve.id===c);let zr=!1;ve.version===Jn.__version?(Jn.needsLights&&Jn.lightsStateVersion!==_b.state.version||Jn.outputColorSpace!==vn||Le.isInstancedMesh&&!1===Jn.instancing||!Le.isInstancedMesh&&!0===Jn.instancing||Le.isSkinnedMesh&&!1===Jn.skinning||!Le.isSkinnedMesh&&!0===Jn.skinning||Le.isInstancedMesh&&!0===Jn.instancingColor&&null===Le.instanceColor||Le.isInstancedMesh&&!1===Jn.instancingColor&&null!==Le.instanceColor||Jn.envMap!==yn||!0===ve.fog&&Jn.fog!==Ht||void 0!==Jn.numClippingPlanes&&(Jn.numClippingPlanes!==Jt.numPlanes||Jn.numIntersection!==Jt.numIntersection)||Jn.vertexAlphas!==qn||Jn.vertexTangents!==gn||Jn.morphTargets!==On||Jn.morphNormals!==_r||Jn.morphColors!==Rr||Jn.toneMapping!==Na||!0===tt.isWebGL2&&Jn.morphTargetsCount!==Vr)&&(zr=!0):(zr=!0,Jn.__version=ve.version);let Hd=Jn.currentProgram;!0===zr&&(Hd=F_(ve,_e,Le));let gS=!1,mv=!1,xb=!1;const so=Hd.getUniforms(),Gd=Jn.uniforms;if(Ge.useProgram(Hd.program)&&(gS=!0,mv=!0,xb=!0),ve.id!==c&&(c=ve.id,mv=!0),gS||h!==ee){if(so.setValue(oe,"projectionMatrix",ee.projectionMatrix),tt.logarithmicDepthBuffer&&so.setValue(oe,"logDepthBufFC",2/(Math.log(ee.far+1)/Math.LN2)),h!==ee&&(h=ee,mv=!0,xb=!0),ve.isShaderMaterial||ve.isMeshPhongMaterial||ve.isMeshToonMaterial||ve.isMeshStandardMaterial||ve.envMap){const ua=so.map.cameraPosition;void 0!==ua&&ua.setValue(oe,Ln.setFromMatrixPosition(ee.matrixWorld))}(ve.isMeshPhongMaterial||ve.isMeshToonMaterial||ve.isMeshLambertMaterial||ve.isMeshBasicMaterial||ve.isMeshStandardMaterial||ve.isShaderMaterial)&&so.setValue(oe,"isOrthographic",!0===ee.isOrthographicCamera),(ve.isMeshPhongMaterial||ve.isMeshToonMaterial||ve.isMeshLambertMaterial||ve.isMeshBasicMaterial||ve.isMeshStandardMaterial||ve.isShaderMaterial||ve.isShadowMaterial||Le.isSkinnedMesh)&&so.setValue(oe,"viewMatrix",ee.matrixWorldInverse)}if(Le.isSkinnedMesh){so.setOptional(oe,Le,"bindMatrix"),so.setOptional(oe,Le,"bindMatrixInverse");const ua=Le.skeleton;ua&&(tt.floatVertexTextures?(null===ua.boneTexture&&ua.computeBoneTexture(),so.setValue(oe,"boneTexture",ua.boneTexture,Vt),so.setValue(oe,"boneTextureSize",ua.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const Mb=Oe.morphAttributes;if((void 0!==Mb.position||void 0!==Mb.normal||void 0!==Mb.color&&!0===tt.isWebGL2)&&le.update(Le,Oe,Hd),(mv||Jn.receiveShadow!==Le.receiveShadow)&&(Jn.receiveShadow=Le.receiveShadow,so.setValue(oe,"receiveShadow",Le.receiveShadow)),ve.isMeshGouraudMaterial&&null!==ve.envMap&&(Gd.envMap.value=yn,Gd.flipEnvMap.value=yn.isCubeTexture&&!1===yn.isRenderTargetTexture?-1:1),mv&&(so.setValue(oe,"toneMappingExposure",k.toneMappingExposure),Jn.needsLights&&function kS(ee,_e){ee.ambientLightColor.needsUpdate=_e,ee.lightProbe.needsUpdate=_e,ee.directionalLights.needsUpdate=_e,ee.directionalLightShadows.needsUpdate=_e,ee.pointLights.needsUpdate=_e,ee.pointLightShadows.needsUpdate=_e,ee.spotLights.needsUpdate=_e,ee.spotLightShadows.needsUpdate=_e,ee.rectAreaLights.needsUpdate=_e,ee.hemisphereLights.needsUpdate=_e}(Gd,xb),Ht&&!0===ve.fog&&at.refreshFogUniforms(Gd,Ht),at.refreshMaterialUniforms(Gd,ve,X,G,ot),qm.upload(oe,Jn.uniformsList,Gd,Vt)),ve.isShaderMaterial&&!0===ve.uniformsNeedUpdate&&(qm.upload(oe,Jn.uniformsList,Gd,Vt),ve.uniformsNeedUpdate=!1),ve.isSpriteMaterial&&so.setValue(oe,"center",Le.center),so.setValue(oe,"modelViewMatrix",Le.modelViewMatrix),so.setValue(oe,"normalMatrix",Le.normalMatrix),so.setValue(oe,"modelMatrix",Le.matrixWorld),ve.isShaderMaterial||ve.isRawShaderMaterial){const ua=ve.uniformsGroups;for(let wb=0,BS=ua.length;wb<BS;wb++)if(tt.isWebGL2){const vS=ua[wb];wn.update(vS,Hd),wn.bind(vS,Hd)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Hd}(ee,_e,Oe,ve,Le);Ge.setMaterial(ve,hn);let yn=Oe.index,qn=1;if(!0===ve.wireframe){if(yn=ne.getWireframeAttribute(Oe),void 0===yn)return;qn=2}const gn=Oe.drawRange,On=Oe.attributes.position;let _r=gn.start*qn,Rr=(gn.start+gn.count)*qn;null!==Ht&&(_r=Math.max(_r,Ht.start*qn),Rr=Math.min(Rr,(Ht.start+Ht.count)*qn)),null!==yn?(_r=Math.max(_r,0),Rr=Math.min(Rr,yn.count)):null!=On&&(_r=Math.max(_r,0),Rr=Math.min(Rr,On.count));const Na=Rr-_r;if(Na<0||Na===1/0)return;At.setup(Le,ve,vn,Oe,yn);let lu,Vr=We;if(null!==yn&&(lu=Ji.get(yn),Vr=Rt,Vr.setIndex(lu)),Le.isMesh)!0===ve.wireframe?(Ge.setLineWidth(ve.wireframeLinewidth*Qt()),Vr.setMode(oe.LINES)):Vr.setMode(oe.TRIANGLES);else if(Le.isLine){let Jn=ve.linewidth;void 0===Jn&&(Jn=1),Ge.setLineWidth(Jn*Qt()),Vr.setMode(Le.isLineSegments?oe.LINES:Le.isLineLoop?oe.LINE_LOOP:oe.LINE_STRIP)}else Le.isPoints?Vr.setMode(oe.POINTS):Le.isSprite&&Vr.setMode(oe.TRIANGLES);if(Le.isInstancedMesh)Vr.renderInstances(_r,Na,Le.count);else if(Oe.isInstancedBufferGeometry){const _b=Math.min(Oe.instanceCount,void 0!==Oe._maxInstanceCount?Oe._maxInstanceCount:1/0);Vr.renderInstances(_r,Na,_b)}else Vr.render(_r,Na)},this.compile=function(ee,_e){function Oe(ve,Le,Ht){!0===ve.transparent&&2===ve.side&&!1===ve.forceSinglePass?(ve.side=1,ve.needsUpdate=!0,F_(ve,Le,Ht),ve.side=0,ve.needsUpdate=!0,F_(ve,Le,Ht),ve.side=2):F_(ve,Le,Ht)}P=ut.get(ee),P.init(),V.push(P),ee.traverseVisible(function(ve){ve.isLight&&ve.layers.test(_e.layers)&&(P.pushLight(ve),ve.castShadow&&P.pushShadow(ve))}),P.setupLights(k._useLegacyLights),ee.traverse(function(ve){const Le=ve.material;if(Le)if(Array.isArray(Le))for(let Ht=0;Ht<Le.length;Ht++)Oe(Le[Ht],ee,ve);else Oe(Le,ee,ve)}),V.pop(),P=null};let Wi=null;function ji(){ro.stop()}function tc(){ro.start()}const ro=new Vh;function dS(ee,_e,Oe,ve){if(!1===ee.visible)return;if(ee.layers.test(_e.layers))if(ee.isGroup)Oe=ee.renderOrder;else if(ee.isLOD)!0===ee.autoUpdate&&ee.update(_e);else if(ee.isLight)P.pushLight(ee),ee.castShadow&&P.pushShadow(ee);else if(ee.isSprite){if(!ee.frustumCulled||he.intersectsSprite(ee)){ve&&Ln.setFromMatrixPosition(ee.matrixWorld).applyMatrix4(St);const hn=Y.update(ee),vn=ee.material;vn.visible&&F.push(ee,hn,vn,Oe,Ln.z,null)}}else if((ee.isMesh||ee.isLine||ee.isPoints)&&(!ee.frustumCulled||he.intersectsObject(ee))){const hn=Y.update(ee),vn=ee.material;if(ve&&(void 0!==ee.boundingSphere?(null===ee.boundingSphere&&ee.computeBoundingSphere(),Ln.copy(ee.boundingSphere.center)):(null===hn.boundingSphere&&hn.computeBoundingSphere(),Ln.copy(hn.boundingSphere.center)),Ln.applyMatrix4(ee.matrixWorld).applyMatrix4(St)),Array.isArray(vn)){const yn=hn.groups;for(let qn=0,gn=yn.length;qn<gn;qn++){const On=yn[qn],_r=vn[On.materialIndex];_r&&_r.visible&&F.push(ee,hn,_r,Oe,Ln.z,On)}}else vn.visible&&F.push(ee,hn,vn,Oe,Ln.z,null)}const Ht=ee.children;for(let hn=0,vn=Ht.length;hn<vn;hn++)dS(Ht[hn],_e,Oe,ve)}function fS(ee,_e,Oe,ve){const Le=ee.opaque,Ht=ee.transmissive,hn=ee.transparent;P.setupLightsView(Oe),!0===be&&Jt.setGlobalState(k.clippingPlanes,Oe),Ht.length>0&&function FS(ee,_e,Oe,ve){const Le=tt.isWebGL2;null===ot&&(ot=new bc(1,1,{generateMipmaps:!0,type:Fe.has("EXT_color_buffer_half_float")?Ha:ho,minFilter:gs,samples:Le?4:0})),k.getDrawingBufferSize(Pt),Le?ot.setSize(Pt.x,Pt.y):ot.setSize(cs(Pt.x),cs(Pt.y));const Ht=k.getRenderTarget();k.setRenderTarget(ot),k.getClearColor(C),L=k.getClearAlpha(),L<1&&k.setClearColor(16777215,.5),k.clear();const hn=k.toneMapping;k.toneMapping=0,O_(ee,Oe,ve),Vt.updateMultisampleRenderTarget(ot),Vt.updateRenderTargetMipmap(ot);let vn=!1;for(let yn=0,qn=_e.length;yn<qn;yn++){const gn=_e[yn],On=gn.object,_r=gn.geometry,Rr=gn.material,Na=gn.group;if(2===Rr.side&&On.layers.test(ve.layers)){const lu=Rr.side;Rr.side=1,Rr.needsUpdate=!0,pS(On,Oe,ve,_r,Rr,Na),Rr.side=lu,Rr.needsUpdate=!0,vn=!0}}!0===vn&&(Vt.updateMultisampleRenderTarget(ot),Vt.updateRenderTargetMipmap(ot)),k.setRenderTarget(Ht),k.setClearColor(C,L),k.toneMapping=hn}(Le,Ht,_e,Oe),ve&&Ge.viewport(f.copy(ve)),Le.length>0&&O_(Le,_e,Oe),Ht.length>0&&O_(Ht,_e,Oe),hn.length>0&&O_(hn,_e,Oe),Ge.buffers.depth.setTest(!0),Ge.buffers.depth.setMask(!0),Ge.buffers.color.setMask(!0),Ge.setPolygonOffset(!1)}function O_(ee,_e,Oe){const ve=!0===_e.isScene?_e.overrideMaterial:null;for(let Le=0,Ht=ee.length;Le<Ht;Le++){const hn=ee[Le],vn=hn.object,yn=hn.geometry,qn=null===ve?hn.material:ve,gn=hn.group;vn.layers.test(Oe.layers)&&pS(vn,_e,Oe,yn,qn,gn)}}function pS(ee,_e,Oe,ve,Le,Ht){ee.onBeforeRender(k,_e,Oe,ve,Le,Ht),ee.modelViewMatrix.multiplyMatrices(Oe.matrixWorldInverse,ee.matrixWorld),ee.normalMatrix.getNormalMatrix(ee.modelViewMatrix),Le.onBeforeRender(k,_e,Oe,ve,ee,Ht),!0===Le.transparent&&2===Le.side&&!1===Le.forceSinglePass?(Le.side=1,Le.needsUpdate=!0,k.renderBufferDirect(Oe,_e,ve,Le,ee,Ht),Le.side=0,Le.needsUpdate=!0,k.renderBufferDirect(Oe,_e,ve,Le,ee,Ht),Le.side=2):k.renderBufferDirect(Oe,_e,ve,Le,ee,Ht),ee.onAfterRender(k,_e,Oe,ve,Le,Ht)}function F_(ee,_e,Oe){!0!==_e.isScene&&(_e=ri);const ve=Ft.get(ee),Le=P.state.lights,hn=Le.state.version,vn=Ee.getParameters(ee,Le.state,P.state.shadowsArray,_e,Oe),yn=Ee.getProgramCacheKey(vn);let qn=ve.programs;ve.environment=ee.isMeshStandardMaterial?_e.environment:null,ve.fog=_e.fog,ve.envMap=(ee.isMeshStandardMaterial?Xn:fn).get(ee.envMap||ve.environment),void 0===qn&&(ee.addEventListener("dispose",Tt),qn=new Map,ve.programs=qn);let gn=qn.get(yn);if(void 0!==gn){if(ve.currentProgram===gn&&ve.lightsStateVersion===hn)return mS(ee,vn),gn}else vn.uniforms=Ee.getUniforms(ee),ee.onBuild(Oe,vn,k),ee.onBeforeCompile(vn,k),gn=Ee.acquireProgram(vn,yn),qn.set(yn,gn),ve.uniforms=vn.uniforms;const On=ve.uniforms;(!ee.isShaderMaterial&&!ee.isRawShaderMaterial||!0===ee.clipping)&&(On.clippingPlanes=Jt.uniform),mS(ee,vn),ve.needsLights=function US(ee){return ee.isMeshLambertMaterial||ee.isMeshToonMaterial||ee.isMeshPhongMaterial||ee.isMeshStandardMaterial||ee.isShadowMaterial||ee.isShaderMaterial&&!0===ee.lights}(ee),ve.lightsStateVersion=hn,ve.needsLights&&(On.ambientLightColor.value=Le.state.ambient,On.lightProbe.value=Le.state.probe,On.directionalLights.value=Le.state.directional,On.directionalLightShadows.value=Le.state.directionalShadow,On.spotLights.value=Le.state.spot,On.spotLightShadows.value=Le.state.spotShadow,On.rectAreaLights.value=Le.state.rectArea,On.ltc_1.value=Le.state.rectAreaLTC1,On.ltc_2.value=Le.state.rectAreaLTC2,On.pointLights.value=Le.state.point,On.pointLightShadows.value=Le.state.pointShadow,On.hemisphereLights.value=Le.state.hemi,On.directionalShadowMap.value=Le.state.directionalShadowMap,On.directionalShadowMatrix.value=Le.state.directionalShadowMatrix,On.spotShadowMap.value=Le.state.spotShadowMap,On.spotLightMatrix.value=Le.state.spotLightMatrix,On.spotLightMap.value=Le.state.spotLightMap,On.pointShadowMap.value=Le.state.pointShadowMap,On.pointShadowMatrix.value=Le.state.pointShadowMatrix);const _r=gn.getUniforms(),Rr=qm.seqWithValue(_r.seq,On);return ve.currentProgram=gn,ve.uniformsList=Rr,gn}function mS(ee,_e){const Oe=Ft.get(ee);Oe.outputColorSpace=_e.outputColorSpace,Oe.instancing=_e.instancing,Oe.instancingColor=_e.instancingColor,Oe.skinning=_e.skinning,Oe.morphTargets=_e.morphTargets,Oe.morphNormals=_e.morphNormals,Oe.morphColors=_e.morphColors,Oe.morphTargetsCount=_e.morphTargetsCount,Oe.numClippingPlanes=_e.numClippingPlanes,Oe.numIntersection=_e.numClipIntersection,Oe.vertexAlphas=_e.vertexAlphas,Oe.vertexTangents=_e.vertexTangents,Oe.toneMapping=_e.toneMapping}ro.setAnimationLoop(function vh(ee){Wi&&Wi(ee)}),"undefined"!=typeof self&&ro.setContext(self),this.setAnimationLoop=function(ee){Wi=ee,fe.setAnimationLoop(ee),null===ee?ro.stop():ro.start()},fe.addEventListener("sessionstart",ji),fe.addEventListener("sessionend",tc),this.render=function(ee,_e){if(void 0===_e||!0===_e.isCamera){if(!0!==W){if(!0===ee.matrixWorldAutoUpdate&&ee.updateMatrixWorld(),null===_e.parent&&!0===_e.matrixWorldAutoUpdate&&_e.updateMatrixWorld(),!0===fe.enabled&&!0===fe.isPresenting&&(!0===fe.cameraAutoUpdate&&fe.updateCamera(_e),_e=fe.getCamera()),!0===ee.isScene&&ee.onBeforeRender(k,ee,_e,o),P=ut.get(ee,V.length),P.init(),V.push(P),St.multiplyMatrices(_e.projectionMatrix,_e.matrixWorldInverse),he.setFromProjectionMatrix(St),Pe=this.localClippingEnabled,be=Jt.init(this.clippingPlanes,Pe),F=Ye.get(ee,R.length),F.init(),R.push(F),dS(ee,_e,0,k.sortObjects),F.finish(),!0===k.sortObjects&&F.sort(Z,re),this.info.render.frame++,!0===be&&Jt.beginShadows(),dt.render(P.state.shadowsArray,ee,_e),!0===be&&Jt.endShadows(),!0===this.info.autoReset&&this.info.reset(),Ae.render(F,ee),P.setupLights(k._useLegacyLights),_e.isArrayCamera){const ve=_e.cameras;for(let Le=0,Ht=ve.length;Le<Ht;Le++){const hn=ve[Le];fS(F,ee,hn,hn.viewport)}}else fS(F,ee,_e);null!==o&&(Vt.updateMultisampleRenderTarget(o),Vt.updateRenderTargetMipmap(o)),!0===ee.isScene&&ee.onAfterRender(k,ee,_e),At.resetDefaultState(),c=-1,h=null,V.pop(),P=V.length>0?V[V.length-1]:null,R.pop(),F=R.length>0?R[R.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return i},this.getActiveMipmapLevel=function(){return r},this.getRenderTarget=function(){return o},this.setRenderTargetTextures=function(ee,_e,Oe){Ft.get(ee.texture).__webglTexture=_e,Ft.get(ee.depthTexture).__webglTexture=Oe;const ve=Ft.get(ee);ve.__hasExternalTextures=!0,ve.__hasExternalTextures&&(ve.__autoAllocateDepthBuffer=void 0===Oe,ve.__autoAllocateDepthBuffer||!0===Fe.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),ve.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(ee,_e){const Oe=Ft.get(ee);Oe.__webglFramebuffer=_e,Oe.__useDefaultFramebuffer=void 0===_e},this.setRenderTarget=function(ee,_e=0,Oe=0){o=ee,i=_e,r=Oe;let ve=!0,Le=null,Ht=!1,hn=!1;if(ee){const yn=Ft.get(ee);void 0!==yn.__useDefaultFramebuffer?(Ge.bindFramebuffer(oe.FRAMEBUFFER,null),ve=!1):void 0===yn.__webglFramebuffer?Vt.setupRenderTarget(ee):yn.__hasExternalTextures&&Vt.rebindTextures(ee,Ft.get(ee.texture).__webglTexture,Ft.get(ee.depthTexture).__webglTexture);const qn=ee.texture;(qn.isData3DTexture||qn.isDataArrayTexture||qn.isCompressedArrayTexture)&&(hn=!0);const gn=Ft.get(ee).__webglFramebuffer;ee.isWebGLCubeRenderTarget?(Le=Array.isArray(gn[_e])?gn[_e][Oe]:gn[_e],Ht=!0):Le=tt.isWebGL2&&ee.samples>0&&!1===Vt.useMultisampledRTT(ee)?Ft.get(ee).__webglMultisampledFramebuffer:Array.isArray(gn)?gn[Oe]:gn,f.copy(ee.viewport),x.copy(ee.scissor),b=ee.scissorTest}else f.copy(ce).multiplyScalar(X).floor(),x.copy(ie).multiplyScalar(X).floor(),b=de;if(Ge.bindFramebuffer(oe.FRAMEBUFFER,Le)&&tt.drawBuffers&&ve&&Ge.drawBuffers(ee,Le),Ge.viewport(f),Ge.scissor(x),Ge.setScissorTest(b),Ht){const yn=Ft.get(ee.texture);oe.framebufferTexture2D(oe.FRAMEBUFFER,oe.COLOR_ATTACHMENT0,oe.TEXTURE_CUBE_MAP_POSITIVE_X+_e,yn.__webglTexture,Oe)}else if(hn){const yn=Ft.get(ee.texture);oe.framebufferTextureLayer(oe.FRAMEBUFFER,oe.COLOR_ATTACHMENT0,yn.__webglTexture,Oe||0,_e||0)}c=-1},this.readRenderTargetPixels=function(ee,_e,Oe,ve,Le,Ht,hn){if(!ee||!ee.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let vn=Ft.get(ee).__webglFramebuffer;if(ee.isWebGLCubeRenderTarget&&void 0!==hn&&(vn=vn[hn]),vn){Ge.bindFramebuffer(oe.FRAMEBUFFER,vn);try{const yn=ee.texture,qn=yn.format,gn=yn.type;if(qn!==Er&&wt.convert(qn)!==oe.getParameter(oe.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const On=gn===Ha&&(Fe.has("EXT_color_buffer_half_float")||tt.isWebGL2&&Fe.has("EXT_color_buffer_float"));if(!(gn===ho||wt.convert(gn)===oe.getParameter(oe.IMPLEMENTATION_COLOR_READ_TYPE)||gn===an&&(tt.isWebGL2||Fe.has("OES_texture_float")||Fe.has("WEBGL_color_buffer_float"))||On))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");_e>=0&&_e<=ee.width-ve&&Oe>=0&&Oe<=ee.height-Le&&oe.readPixels(_e,Oe,ve,Le,wt.convert(qn),wt.convert(gn),Ht)}finally{const yn=null!==o?Ft.get(o).__webglFramebuffer:null;Ge.bindFramebuffer(oe.FRAMEBUFFER,yn)}}},this.copyFramebufferToTexture=function(ee,_e,Oe=0){const ve=Math.pow(2,-Oe),Le=Math.floor(_e.image.width*ve),Ht=Math.floor(_e.image.height*ve);Vt.setTexture2D(_e,0),oe.copyTexSubImage2D(oe.TEXTURE_2D,Oe,0,0,ee.x,ee.y,Le,Ht),Ge.unbindTexture()},this.copyTextureToTexture=function(ee,_e,Oe,ve=0){const Le=_e.image.width,Ht=_e.image.height,hn=wt.convert(Oe.format),vn=wt.convert(Oe.type);Vt.setTexture2D(Oe,0),oe.pixelStorei(oe.UNPACK_FLIP_Y_WEBGL,Oe.flipY),oe.pixelStorei(oe.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Oe.premultiplyAlpha),oe.pixelStorei(oe.UNPACK_ALIGNMENT,Oe.unpackAlignment),_e.isDataTexture?oe.texSubImage2D(oe.TEXTURE_2D,ve,ee.x,ee.y,Le,Ht,hn,vn,_e.image.data):_e.isCompressedTexture?oe.compressedTexSubImage2D(oe.TEXTURE_2D,ve,ee.x,ee.y,_e.mipmaps[0].width,_e.mipmaps[0].height,hn,_e.mipmaps[0].data):oe.texSubImage2D(oe.TEXTURE_2D,ve,ee.x,ee.y,hn,vn,_e.image),0===ve&&Oe.generateMipmaps&&oe.generateMipmap(oe.TEXTURE_2D),Ge.unbindTexture()},this.copyTextureToTexture3D=function(ee,_e,Oe,ve,Le=0){if(k.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const Ht=ee.max.x-ee.min.x+1,hn=ee.max.y-ee.min.y+1,vn=ee.max.z-ee.min.z+1,yn=wt.convert(ve.format),qn=wt.convert(ve.type);let gn;if(ve.isData3DTexture)Vt.setTexture3D(ve,0),gn=oe.TEXTURE_3D;else{if(!ve.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");Vt.setTexture2DArray(ve,0),gn=oe.TEXTURE_2D_ARRAY}oe.pixelStorei(oe.UNPACK_FLIP_Y_WEBGL,ve.flipY),oe.pixelStorei(oe.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ve.premultiplyAlpha),oe.pixelStorei(oe.UNPACK_ALIGNMENT,ve.unpackAlignment);const On=oe.getParameter(oe.UNPACK_ROW_LENGTH),_r=oe.getParameter(oe.UNPACK_IMAGE_HEIGHT),Rr=oe.getParameter(oe.UNPACK_SKIP_PIXELS),Na=oe.getParameter(oe.UNPACK_SKIP_ROWS),lu=oe.getParameter(oe.UNPACK_SKIP_IMAGES),Vr=Oe.isCompressedTexture?Oe.mipmaps[0]:Oe.image;oe.pixelStorei(oe.UNPACK_ROW_LENGTH,Vr.width),oe.pixelStorei(oe.UNPACK_IMAGE_HEIGHT,Vr.height),oe.pixelStorei(oe.UNPACK_SKIP_PIXELS,ee.min.x),oe.pixelStorei(oe.UNPACK_SKIP_ROWS,ee.min.y),oe.pixelStorei(oe.UNPACK_SKIP_IMAGES,ee.min.z),Oe.isDataTexture||Oe.isData3DTexture?oe.texSubImage3D(gn,Le,_e.x,_e.y,_e.z,Ht,hn,vn,yn,qn,Vr.data):Oe.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),oe.compressedTexSubImage3D(gn,Le,_e.x,_e.y,_e.z,Ht,hn,vn,yn,Vr.data)):oe.texSubImage3D(gn,Le,_e.x,_e.y,_e.z,Ht,hn,vn,yn,qn,Vr),oe.pixelStorei(oe.UNPACK_ROW_LENGTH,On),oe.pixelStorei(oe.UNPACK_IMAGE_HEIGHT,_r),oe.pixelStorei(oe.UNPACK_SKIP_PIXELS,Rr),oe.pixelStorei(oe.UNPACK_SKIP_ROWS,Na),oe.pixelStorei(oe.UNPACK_SKIP_IMAGES,lu),0===Le&&ve.generateMipmaps&&oe.generateMipmap(gn),Ge.unbindTexture()},this.initTexture=function(ee){ee.isCubeTexture?Vt.setTextureCube(ee,0):ee.isData3DTexture?Vt.setTexture3D(ee,0):ee.isDataArrayTexture||ee.isCompressedArrayTexture?Vt.setTexture2DArray(ee,0):Vt.setTexture2D(ee,0),Ge.unbindTexture()},this.resetState=function(){i=0,r=0,o=null,Ge.reset(),At.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return xs}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(e){console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===rn?Wo:3e3}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===Wo?rn:Nr}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}(class OM extends ig{}).prototype.isWebGL1Renderer=!0;class Kh extends Tr{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}}const ag=new K,$y=new ii,lg=new ii,Xy=new K,Nf=new Bt,od=new K,ad=new $o,qy=new Bt,Yy=new bu;class Yu extends Yi{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Bt,this.bindMatrixInverse=new Bt,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;null===this.boundingBox&&(this.boundingBox=new Qa),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)od.fromBufferAttribute(t,n),this.applyBoneTransform(n,od),this.boundingBox.expandByPoint(od)}computeBoundingSphere(){const e=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new $o),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)od.fromBufferAttribute(t,n),this.applyBoneTransform(n,od),this.boundingSphere.expandByPoint(od)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const s=this.matrixWorld;void 0!==this.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),ad.copy(this.boundingSphere),ad.applyMatrix4(s),!1!==e.ray.intersectsSphere(ad)&&(qy.copy(s).invert(),Yy.copy(e.ray).applyMatrix4(qy),(null===this.boundingBox||!1!==Yy.intersectsBox(this.boundingBox))&&this._computeIntersections(e,t,Yy)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new ii,t=this.geometry.attributes.skinWeight;for(let n=0,s=t.count;n<s;n++){e.fromBufferAttribute(t,n);const l=1/e.manhattanLength();l!==1/0?e.multiplyScalar(l):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton,s=this.geometry;$y.fromBufferAttribute(s.attributes.skinIndex,e),lg.fromBufferAttribute(s.attributes.skinWeight,e),ag.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let l=0;l<4;l++){const u=lg.getComponent(l);if(0!==u){const d=$y.getComponent(l);Nf.multiplyMatrices(n.bones[d].matrixWorld,n.boneInverses[d]),t.addScaledVector(Xy.copy(ag).applyMatrix4(Nf),u)}}return t.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,t){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,t)}}class ld extends Tr{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Hc extends ws{constructor(e=null,t=1,n=1,s,l,u,d,p,g=di,_=di,M,w){super(null,u,d,p,g,_,s,l,M,w),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const kf=new Bt,UM=new Bt;class Gc{constructor(e=[],t=[]){this.uuid=mr(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,s=this.bones.length;n<s;n++)this.boneInverses.push(new Bt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new Bt;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,s=this.boneTexture;for(let l=0,u=e.length;l<u;l++)kf.multiplyMatrices(e[l]?e[l].matrixWorld:UM,t[l]),kf.toArray(n,16*l);null!==s&&(s.needsUpdate=!0)}clone(){return new Gc(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=qp(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new Hc(t,e,e,Er,an);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const s=this.bones[t];if(s.name===e)return s}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,s=e.bones.length;n<s;n++){const l=e.bones[n];let u=t[l];void 0===u&&(console.warn("THREE.Skeleton: No bone found with UUID:",l),u=new ld),this.bones.push(u),this.boneInverses.push((new Bt).fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let s=0,l=t.length;s<l;s++)e.bones.push(t[s].uuid),e.boneInverses.push(n[s].toArray());return e}}class Es extends ol{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new pt(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const hg=new K,Vf=new K,dg=new Bt,fg=new bu,cd=new $o;class Wc extends Tr{constructor(e=new Sn,t=new Es){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[0];for(let s=1,l=t.count;s<l;s++)hg.fromBufferAttribute(t,s-1),Vf.fromBufferAttribute(t,s),n[s]=n[s-1],n[s]+=hg.distanceTo(Vf);e.setAttribute("lineDistance",new It(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,s=this.matrixWorld,l=e.params.Line.threshold,u=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),cd.copy(n.boundingSphere),cd.applyMatrix4(s),cd.radius+=l,!1===e.ray.intersectsSphere(cd))return;dg.copy(s).invert(),fg.copy(e.ray).applyMatrix4(dg);const d=l/((this.scale.x+this.scale.y+this.scale.z)/3),p=d*d,g=new K,_=new K,M=new K,w=new K,E=this.isLineSegments?2:1,D=n.index,P=n.attributes.position;if(null!==D)for(let k=Math.max(0,u.start),W=Math.min(D.count,u.start+u.count)-1;k<W;k+=E){const i=D.getX(k),r=D.getX(k+1);if(g.fromBufferAttribute(P,i),_.fromBufferAttribute(P,r),fg.distanceSqToSegment(g,_,w,M)>p)continue;w.applyMatrix4(this.matrixWorld);const c=e.ray.origin.distanceTo(w);c<e.near||c>e.far||t.push({distance:c,point:M.clone().applyMatrix4(this.matrixWorld),index:k,face:null,faceIndex:null,object:this})}else for(let k=Math.max(0,u.start),W=Math.min(P.count,u.start+u.count)-1;k<W;k+=E){if(g.fromBufferAttribute(P,k),_.fromBufferAttribute(P,k+1),fg.distanceSqToSegment(g,_,w,M)>p)continue;w.applyMatrix4(this.matrixWorld);const r=e.ray.origin.distanceTo(w);r<e.near||r>e.far||t.push({distance:r,point:M.clone().applyMatrix4(this.matrixWorld),index:k,face:null,faceIndex:null,object:this})}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const s=t[n[0]];if(void 0!==s){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let l=0,u=s.length;l<u;l++){const d=s[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[d]=l}}}}}const zf=new K,pg=new K;class Hf extends Wc{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[];for(let s=0,l=t.count;s<l;s+=2)zf.fromBufferAttribute(t,s),pg.fromBufferAttribute(t,s+1),n[s]=0===s?0:n[s-1],n[s+1]=n[s]+zf.distanceTo(pg);e.setAttribute("lineDistance",new It(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}const Zf=new K,md=new K,Kf=new K,qc=new Fs;class r0 extends Sn{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},null!==e){const s=Math.pow(10,4),l=Math.cos(yo*t),u=e.getIndex(),d=e.getAttribute("position"),p=u?u.count:d.count,g=[0,0,0],_=["a","b","c"],M=new Array(3),w={},E=[];for(let D=0;D<p;D+=3){u?(g[0]=u.getX(D),g[1]=u.getX(D+1),g[2]=u.getX(D+2)):(g[0]=D,g[1]=D+1,g[2]=D+2);const{a:F,b:P,c:R}=qc;if(F.fromBufferAttribute(d,g[0]),P.fromBufferAttribute(d,g[1]),R.fromBufferAttribute(d,g[2]),qc.getNormal(Kf),M[0]=`${Math.round(F.x*s)},${Math.round(F.y*s)},${Math.round(F.z*s)}`,M[1]=`${Math.round(P.x*s)},${Math.round(P.y*s)},${Math.round(P.z*s)}`,M[2]=`${Math.round(R.x*s)},${Math.round(R.y*s)},${Math.round(R.z*s)}`,M[0]!==M[1]&&M[1]!==M[2]&&M[2]!==M[0])for(let V=0;V<3;V++){const k=(V+1)%3,W=M[V],i=M[k],r=qc[_[V]],o=qc[_[k]],c=`${W}_${i}`,h=`${i}_${W}`;h in w&&w[h]?(Kf.dot(w[h].normal)<=l&&(E.push(r.x,r.y,r.z),E.push(o.x,o.y,o.z)),w[h]=null):c in w||(w[c]={index0:g[V],index1:g[k],normal:Kf.clone()})}}for(const D in w)if(w[D]){const{index0:F,index1:P}=w[D];Zf.fromBufferAttribute(d,F),md.fromBufferAttribute(d,P),E.push(Zf.x,Zf.y,Zf.z),E.push(md.x,md.y,md.z)}this.setAttribute("position",new It(E,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class Ao extends Sn{constructor(e=1,t=32,n=16,s=0,l=2*Math.PI,u=0,d=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:s,phiLength:l,thetaStart:u,thetaLength:d},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const p=Math.min(u+d,Math.PI);let g=0;const _=[],M=new K,w=new K,E=[],D=[],F=[],P=[];for(let R=0;R<=n;R++){const V=[],k=R/n;let W=0;0===R&&0===u?W=.5/t:R===n&&p===Math.PI&&(W=-.5/t);for(let i=0;i<=t;i++){const r=i/t;M.x=-e*Math.cos(s+r*l)*Math.sin(u+k*d),M.y=e*Math.cos(u+k*d),M.z=e*Math.sin(s+r*l)*Math.sin(u+k*d),D.push(M.x,M.y,M.z),w.copy(M).normalize(),F.push(w.x,w.y,w.z),P.push(r+W,1-k),V.push(g++)}_.push(V)}for(let R=0;R<n;R++)for(let V=0;V<t;V++){const k=_[R][V+1],W=_[R][V],i=_[R+1][V],r=_[R+1][V+1];(0!==R||u>0)&&E.push(k,W,r),(R!==n-1||p<Math.PI)&&E.push(W,i,r)}this.setIndex(E),this.setAttribute("position",new It(D,3)),this.setAttribute("normal",new It(F,3)),this.setAttribute("uv",new It(P,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ao(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class ap extends ol{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new pt(16777215),this.specular=new pt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new pt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ke(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Ai extends ol{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new pt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new pt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ke(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}function Do(a,e,t){return up(a)?new a.constructor(a.subarray(e,void 0!==t?t:a.length)):a.slice(e,t)}function Zc(a,e,t){return!a||!t&&a.constructor===e?a:"number"==typeof e.BYTES_PER_ELEMENT?new e(a):Array.prototype.slice.call(a)}function up(a){return ArrayBuffer.isView(a)&&!(a instanceof DataView)}function Ag(a){const t=a.length,n=new Array(t);for(let s=0;s!==t;++s)n[s]=s;return n.sort(function e(s,l){return a[s]-a[l]}),n}function hp(a,e,t){const n=a.length,s=new a.constructor(n);for(let l=0,u=0;u!==n;++l){const d=t[l]*e;for(let p=0;p!==e;++p)s[u++]=a[d+p]}return s}function dp(a,e,t,n){let s=1,l=a[0];for(;void 0!==l&&void 0===l[n];)l=a[s++];if(void 0===l)return;let u=l[n];if(void 0!==u)if(Array.isArray(u))do{u=l[n],void 0!==u&&(e.push(l.time),t.push.apply(t,u)),l=a[s++]}while(void 0!==l);else if(void 0!==u.toArray)do{u=l[n],void 0!==u&&(e.push(l.time),u.toArray(t,t.length)),l=a[s++]}while(void 0!==l);else do{u=l[n],void 0!==u&&(e.push(l.time),t.push(u)),l=a[s++]}while(void 0!==l)}class $l{constructor(e,t,n,s){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==s?s:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,s=t[n],l=t[n-1];e:{t:{let u;n:{i:if(!(e<s)){for(let d=n+2;;){if(void 0===s){if(e<l)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===d)break;if(l=s,s=t[++n],e<s)break t}u=t.length;break n}if(e>=l)break e;{const d=t[1];e<d&&(n=2,l=d);for(let p=n-2;;){if(void 0===l)return this._cachedIndex=0,this.copySampleValue_(0);if(n===p)break;if(s=l,l=t[--n-1],e>=l)break t}u=n,n=0}}for(;n<u;){const d=n+u>>>1;e<t[d]?u=d:n=d+1}if(s=t[n],l=t[n-1],void 0===l)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===s)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,l,s)}return this.interpolate_(n,l,e,s)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,s=this.valueSize,l=e*s;for(let u=0;u!==s;++u)t[u]=n[l+u];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class cw extends $l{constructor(e,t,n,s){super(e,t,n,s),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,n){const s=this.parameterPositions;let l=e-2,u=e+1,d=s[l],p=s[u];if(void 0===d)switch(this.getSettings_().endingStart){case 2401:l=e,d=2*t-n;break;case 2402:l=s.length-2,d=t+s[l]-s[l+1];break;default:l=e,d=n}if(void 0===p)switch(this.getSettings_().endingEnd){case 2401:u=e,p=2*n-t;break;case 2402:u=1,p=n+s[1]-s[0];break;default:u=e-1,p=t}const g=.5*(n-t),_=this.valueSize;this._weightPrev=g/(t-d),this._weightNext=g/(p-n),this._offsetPrev=l*_,this._offsetNext=u*_}interpolate_(e,t,n,s){const l=this.resultBuffer,u=this.sampleValues,d=this.valueSize,p=e*d,g=p-d,_=this._offsetPrev,M=this._offsetNext,w=this._weightPrev,E=this._weightNext,D=(n-t)/(s-t),F=D*D,P=F*D,R=-w*P+2*w*F-w*D,V=(1+w)*P+(-1.5-2*w)*F+(-.5+w)*D+1,k=(-1-E)*P+(1.5+E)*F+.5*D,W=E*P-E*F;for(let i=0;i!==d;++i)l[i]=R*u[_+i]+V*u[g+i]+k*u[p+i]+W*u[M+i];return l}}class b0 extends $l{constructor(e,t,n,s){super(e,t,n,s)}interpolate_(e,t,n,s){const l=this.resultBuffer,u=this.sampleValues,d=this.valueSize,p=e*d,g=p-d,_=(n-t)/(s-t),M=1-_;for(let w=0;w!==d;++w)l[w]=u[g+w]*M+u[p+w]*_;return l}}class uw extends $l{constructor(e,t,n,s){super(e,t,n,s)}interpolate_(e){return this.copySampleValue_(e-1)}}class to{constructor(e,t,n,s){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Zc(t,this.TimeBufferType),this.values=Zc(n,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:Zc(e.times,Array),values:Zc(e.values,Array)};const s=e.getInterpolation();s!==e.DefaultInterpolation&&(n.interpolation=s)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new uw(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new b0(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new cw(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case 2300:t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let n=0,s=t.length;n!==s;++n)t[n]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let n=0,s=t.length;n!==s;++n)t[n]*=e}return this}trim(e,t){const n=this.times,s=n.length;let l=0,u=s-1;for(;l!==s&&n[l]<e;)++l;for(;-1!==u&&n[u]>t;)--u;if(++u,0!==l||u!==s){l>=u&&(u=Math.max(u,1),l=u-1);const d=this.getValueSize();this.times=Do(n,l,u),this.values=Do(this.values,l*d,u*d)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,s=this.values,l=n.length;0===l&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let u=null;for(let d=0;d!==l;d++){const p=n[d];if("number"==typeof p&&isNaN(p)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,d,p),e=!1;break}if(null!==u&&u>p){console.error("THREE.KeyframeTrack: Out of order keys.",this,d,p,u),e=!1;break}u=p}if(void 0!==s&&up(s))for(let d=0,p=s.length;d!==p;++d){const g=s[d];if(isNaN(g)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,d,g),e=!1;break}}return e}optimize(){const e=Do(this.times),t=Do(this.values),n=this.getValueSize(),s=2302===this.getInterpolation(),l=e.length-1;let u=1;for(let d=1;d<l;++d){let p=!1;const g=e[d];if(g!==e[d+1]&&(1!==d||g!==e[0]))if(s)p=!0;else{const M=d*n,w=M-n,E=M+n;for(let D=0;D!==n;++D){const F=t[M+D];if(F!==t[w+D]||F!==t[E+D]){p=!0;break}}}if(p){if(d!==u){e[u]=e[d];const M=d*n,w=u*n;for(let E=0;E!==n;++E)t[w+E]=t[M+E]}++u}}if(l>0){e[u]=e[l];for(let d=l*n,p=u*n,g=0;g!==n;++g)t[p+g]=t[d+g];++u}return u!==e.length?(this.times=Do(e,0,u),this.values=Do(t,0,u*n)):(this.times=e,this.values=t),this}clone(){const e=Do(this.times,0),t=Do(this.values,0),s=new(0,this.constructor)(this.name,e,t);return s.createInterpolant=this.createInterpolant,s}}to.prototype.TimeBufferType=Float32Array,to.prototype.ValueBufferType=Float32Array,to.prototype.DefaultInterpolation=2301;class Kc extends to{}Kc.prototype.ValueTypeName="bool",Kc.prototype.ValueBufferType=Array,Kc.prototype.DefaultInterpolation=2300,Kc.prototype.InterpolantFactoryMethodLinear=void 0,Kc.prototype.InterpolantFactoryMethodSmooth=void 0;class Dg extends to{}Dg.prototype.ValueTypeName="color";class ih extends to{}ih.prototype.ValueTypeName="number";class hw extends $l{constructor(e,t,n,s){super(e,t,n,s)}interpolate_(e,t,n,s){const l=this.resultBuffer,u=this.sampleValues,d=this.valueSize,p=(n-t)/(s-t);let g=e*d;for(let _=g+d;g!==_;g+=4)gr.slerpFlat(l,0,u,g-d,u,g,p);return l}}class Pa extends to{InterpolantFactoryMethodLinear(e){return new hw(this.times,this.values,this.getValueSize(),e)}}Pa.prototype.ValueTypeName="quaternion",Pa.prototype.DefaultInterpolation=2301,Pa.prototype.InterpolantFactoryMethodSmooth=void 0;class La extends to{}La.prototype.ValueTypeName="string",La.prototype.ValueBufferType=Array,La.prototype.DefaultInterpolation=2300,La.prototype.InterpolantFactoryMethodLinear=void 0,La.prototype.InterpolantFactoryMethodSmooth=void 0;class _d extends to{}_d.prototype.ValueTypeName="vector";class xd{constructor(e,t=-1,n,s=2500){this.name=e,this.tracks=n,this.duration=t,this.blendMode=s,this.uuid=mr(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,s=1/(e.fps||1);for(let u=0,d=n.length;u!==d;++u)t.push(E0(n[u]).scale(s));const l=new this(e.name,e.duration,t,e.blendMode);return l.uuid=e.uuid,l}static toJSON(e){const t=[],n=e.tracks,s={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let l=0,u=n.length;l!==u;++l)t.push(to.toJSON(n[l]));return s}static CreateFromMorphTargetSequence(e,t,n,s){const l=t.length,u=[];for(let d=0;d<l;d++){let p=[],g=[];p.push((d+l-1)%l,d,(d+1)%l),g.push(0,1,0);const _=Ag(p);p=hp(p,1,_),g=hp(g,1,_),!s&&0===p[0]&&(p.push(l),g.push(g[0])),u.push(new ih(".morphTargetInfluences["+t[d].name+"]",p,g).scale(1/n))}return new this(e,-1,u)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const s=e;n=s.geometry&&s.geometry.animations||s.animations}for(let s=0;s<n.length;s++)if(n[s].name===t)return n[s];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const s={},l=/^([\w-]*?)([\d]+)$/;for(let d=0,p=e.length;d<p;d++){const g=e[d],_=g.name.match(l);if(_&&_.length>1){const M=_[1];let w=s[M];w||(s[M]=w=[]),w.push(g)}}const u=[];for(const d in s)u.push(this.CreateFromMorphTargetSequence(d,s[d],t,n));return u}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(M,w,E,D,F){if(0!==E.length){const P=[],R=[];dp(E,P,R,D),0!==P.length&&F.push(new M(w,P,R))}},s=[],l=e.name||"default",u=e.fps||30,d=e.blendMode;let p=e.length||-1;const g=e.hierarchy||[];for(let M=0;M<g.length;M++){const w=g[M].keys;if(w&&0!==w.length)if(w[0].morphTargets){const E={};let D;for(D=0;D<w.length;D++)if(w[D].morphTargets)for(let F=0;F<w[D].morphTargets.length;F++)E[w[D].morphTargets[F]]=-1;for(const F in E){const P=[],R=[];for(let V=0;V!==w[D].morphTargets.length;++V){const k=w[D];P.push(k.time),R.push(k.morphTarget===F?1:0)}s.push(new ih(".morphTargetInfluence["+F+"]",P,R))}p=E.length*u}else{const E=".bones["+t[M].name+"]";n(_d,E+".position",w,"pos",s),n(Pa,E+".quaternion",w,"rot",s),n(_d,E+".scale",w,"scl",s)}}return 0===s.length?null:new this(l,p,s,d)}resetDuration(){let t=0;for(let n=0,s=this.tracks.length;n!==s;++n){const l=this.tracks[n];t=Math.max(t,l.times[l.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function E0(a){if(void 0===a.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function dw(a){switch(a.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return ih;case"vector":case"vector2":case"vector3":case"vector4":return _d;case"color":return Dg;case"quaternion":return Pa;case"bool":case"boolean":return Kc;case"string":return La}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+a)}(a.type);if(void 0===a.times){const t=[],n=[];dp(a.keys,t,n,"value"),a.times=t,a.values=n}return void 0!==e.parse?e.parse(a):new e(a.name,a.times,a.values,a.interpolation)}const Jc={enabled:!1,files:{},add:function(a,e){!1!==this.enabled&&(this.files[a]=e)},get:function(a){if(!1!==this.enabled)return this.files[a]},remove:function(a){delete this.files[a]},clear:function(){this.files={}}};class Rg{constructor(e,t,n){const s=this;let p,l=!1,u=0,d=0;const g=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(_){d++,!1===l&&void 0!==s.onStart&&s.onStart(_,u,d),l=!0},this.itemEnd=function(_){u++,void 0!==s.onProgress&&s.onProgress(_,u,d),u===d&&(l=!1,void 0!==s.onLoad&&s.onLoad())},this.itemError=function(_){void 0!==s.onError&&s.onError(_)},this.resolveURL=function(_){return p?p(_):_},this.setURLModifier=function(_){return p=_,this},this.addHandler=function(_,M){return g.push(_,M),this},this.removeHandler=function(_){const M=g.indexOf(_);return-1!==M&&g.splice(M,2),this},this.getHandler=function(_){for(let M=0,w=g.length;M<w;M+=2){const E=g[M],D=g[M+1];if(E.global&&(E.lastIndex=0),E.test(_))return D}return null}}}const fw=new Rg;let Qc=(()=>{class a{constructor(t){this.manager=void 0!==t?t:fw,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,n){const s=this;return new Promise(function(l,u){s.load(t,l,n,u)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}return a.DEFAULT_MATERIAL_NAME="__DEFAULT",a})();const fl={};class pw extends Error{constructor(e,t){super(e),this.response=t}}class Xl extends Qc{constructor(e){super(e)}load(e,t,n,s){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const l=Jc.get(e);if(void 0!==l)return this.manager.itemStart(e),setTimeout(()=>{t&&t(l),this.manager.itemEnd(e)},0),l;if(void 0!==fl[e])return void fl[e].push({onLoad:t,onProgress:n,onError:s});fl[e]=[],fl[e].push({onLoad:t,onProgress:n,onError:s});const u=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),d=this.mimeType,p=this.responseType;fetch(u).then(g=>{if(200===g.status||0===g.status){if(0===g.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"==typeof ReadableStream||void 0===g.body||void 0===g.body.getReader)return g;const _=fl[e],M=g.body.getReader(),w=g.headers.get("Content-Length")||g.headers.get("X-File-Size"),E=w?parseInt(w):0,D=0!==E;let F=0;const P=new ReadableStream({start(R){!function V(){M.read().then(({done:k,value:W})=>{if(k)R.close();else{F+=W.byteLength;const i=new ProgressEvent("progress",{lengthComputable:D,loaded:F,total:E});for(let r=0,o=_.length;r<o;r++){const c=_[r];c.onProgress&&c.onProgress(i)}R.enqueue(W),V()}})}()}});return new Response(P)}throw new pw(`fetch for "${g.url}" responded with ${g.status}: ${g.statusText}`,g)}).then(g=>{switch(p){case"arraybuffer":return g.arrayBuffer();case"blob":return g.blob();case"document":return g.text().then(_=>(new DOMParser).parseFromString(_,d));case"json":return g.json();default:if(void 0===d)return g.text();{const M=/charset="?([^;"\s]*)"?/i.exec(d),w=M&&M[1]?M[1].toLowerCase():void 0,E=new TextDecoder(w);return g.arrayBuffer().then(D=>E.decode(D))}}}).then(g=>{Jc.add(e,g);const _=fl[e];delete fl[e];for(let M=0,w=_.length;M<w;M++){const E=_[M];E.onLoad&&E.onLoad(g)}}).catch(g=>{const _=fl[e];if(void 0===_)throw this.manager.itemError(e),g;delete fl[e];for(let M=0,w=_.length;M<w;M++){const E=_[M];E.onError&&E.onError(g)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Ig extends Qc{constructor(e){super(e)}load(e,t,n,s){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const l=this,u=Jc.get(e);if(void 0!==u)return l.manager.itemStart(e),setTimeout(function(){t&&t(u),l.manager.itemEnd(e)},0),u;const d=xc("img");function p(){_(),Jc.add(e,this),t&&t(this),l.manager.itemEnd(e)}function g(M){_(),s&&s(M),l.manager.itemError(e),l.manager.itemEnd(e)}function _(){d.removeEventListener("load",p,!1),d.removeEventListener("error",g,!1)}return d.addEventListener("load",p,!1),d.addEventListener("error",g,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(d.crossOrigin=this.crossOrigin),l.manager.itemStart(e),d.src=e,d}}class S0 extends Qc{constructor(e){super(e)}load(e,t,n,s){const l=new ws,u=new Ig(this.manager);return u.setCrossOrigin(this.crossOrigin),u.setPath(this.path),u.load(e,function(d){l.image=d,l.needsUpdate=!0,void 0!==t&&t(l)},n,s),l}}class fp extends Tr{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new pt(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}const eu=new Bt,T0=new K,A0=new K;class Lg{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new ke(512,512),this.map=null,this.mapPass=null,this.matrix=new Bt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new vf,this._frameExtents=new ke(1,1),this._viewportCount=1,this._viewports=[new ii(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;T0.setFromMatrixPosition(e.matrixWorld),t.position.copy(T0),A0.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(A0),t.updateMatrixWorld(),eu.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(eu),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(eu)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class gw extends Lg{constructor(){super(new Br(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,n=2*yu*e.angle*this.focus,s=this.mapSize.width/this.mapSize.height,l=e.distance||t.far;(n!==t.fov||s!==t.aspect||l!==t.far)&&(t.fov=n,t.aspect=s,t.far=l,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class D0 extends fp{constructor(e,t,n=0,s=Math.PI/3,l=0,u=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Tr.DEFAULT_UP),this.updateMatrix(),this.target=new Tr,this.distance=n,this.angle=s,this.penumbra=l,this.decay=u,this.map=null,this.shadow=new gw}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const Og=new Bt,Md=new K,Fg=new K;class rh extends Lg{constructor(){super(new Br(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new ke(4,2),this._viewportCount=6,this._viewports=[new ii(2,1,1,1),new ii(0,1,1,1),new ii(3,1,1,1),new ii(1,1,1,1),new ii(3,0,1,1),new ii(1,0,1,1)],this._cubeDirections=[new K(1,0,0),new K(-1,0,0),new K(0,0,1),new K(0,0,-1),new K(0,1,0),new K(0,-1,0)],this._cubeUps=[new K(0,1,0),new K(0,1,0),new K(0,1,0),new K(0,1,0),new K(0,0,1),new K(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,s=this.matrix,l=e.distance||n.far;l!==n.far&&(n.far=l,n.updateProjectionMatrix()),Md.setFromMatrixPosition(e.matrixWorld),n.position.copy(Md),Fg.copy(n.position),Fg.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(Fg),n.updateMatrixWorld(),s.makeTranslation(-Md.x,-Md.y,-Md.z),Og.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Og)}}class Ng extends fp{constructor(e,t,n=0,s=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=s,this.shadow=new rh}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class R0 extends Lg{constructor(){super(new Ef(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class pp extends fp{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Tr.DEFAULT_UP),this.updateMatrix(),this.target=new Tr,this.shadow=new R0}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class kg extends fp{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class Bg{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Vg(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=Vg();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function Vg(){return("undefined"==typeof performance?Date:performance).now()}const Hg="\\[\\]\\.:\\/",z0=new RegExp("["+Hg+"]","g"),Gg="[^"+Hg+"]",H0="[^"+Hg.replace("\\.","")+"]",vp=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",Gg)+/(WCOD+)?/.source.replace("WCOD",H0)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Gg)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Gg)+"$"),ww=["material","materials","bones","map"];class sh{constructor(e,t,n){const s=n||Qn.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,s)}getValue(e,t){this.bind();const s=this._bindings[this._targetGroup.nCachedObjects_];void 0!==s&&s.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let s=this._targetGroup.nCachedObjects_,l=n.length;s!==l;++s)n[s].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}let Qn=(()=>{class a{constructor(t,n,s){this.path=n,this.parsedPath=s||a.parseTrackName(n),this.node=a.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,n,s){return t&&t.isAnimationObjectGroup?new a.Composite(t,n,s):new a(t,n,s)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(z0,"")}static parseTrackName(t){const n=vp.exec(t);if(null===n)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const s={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},l=s.nodeName&&s.nodeName.lastIndexOf(".");if(void 0!==l&&-1!==l){const u=s.nodeName.substring(l+1);-1!==ww.indexOf(u)&&(s.nodeName=s.nodeName.substring(0,l),s.objectName=u)}if(null===s.propertyName||0===s.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return s}static findNode(t,n){if(void 0===n||""===n||"."===n||-1===n||n===t.name||n===t.uuid)return t;if(t.skeleton){const s=t.skeleton.getBoneByName(n);if(void 0!==s)return s}if(t.children){const s=function(u){for(let d=0;d<u.length;d++){const p=u[d];if(p.name===n||p.uuid===n)return p;const g=s(p.children);if(g)return g}return null},l=s(t.children);if(l)return l}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,n){t[n]=this.targetObject[this.propertyName]}_getValue_array(t,n){const s=this.resolvedProperty;for(let l=0,u=s.length;l!==u;++l)t[n++]=s[l]}_getValue_arrayElement(t,n){t[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,n){this.resolvedProperty.toArray(t,n)}_setValue_direct(t,n){this.targetObject[this.propertyName]=t[n]}_setValue_direct_setNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,n){const s=this.resolvedProperty;for(let l=0,u=s.length;l!==u;++l)s[l]=t[n++]}_setValue_array_setNeedsUpdate(t,n){const s=this.resolvedProperty;for(let l=0,u=s.length;l!==u;++l)s[l]=t[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,n){const s=this.resolvedProperty;for(let l=0,u=s.length;l!==u;++l)s[l]=t[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,n){this.resolvedProperty[this.propertyIndex]=t[n]}_setValue_arrayElement_setNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,n){this.resolvedProperty.fromArray(t,n)}_setValue_fromArray_setNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,n){this.bind(),this.getValue(t,n)}_setValue_unbound(t,n){this.bind(),this.setValue(t,n)}bind(){let t=this.node;const n=this.parsedPath,s=n.objectName,l=n.propertyName;let u=n.propertyIndex;if(t||(t=a.findNode(this.rootNode,n.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(s){let _=n.objectIndex;switch(s){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let M=0;M<t.length;M++)if(t[M].name===_){_=M;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[s])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[s]}if(void 0!==_){if(void 0===t[_])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[_]}}const d=t[l];if(void 0===d)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n.nodeName+"."+l+" but it wasn't found.",t);let p=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?p=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(p=this.Versioning.MatrixWorldNeedsUpdate);let g=this.BindingType.Direct;if(void 0!==u){if("morphTargetInfluences"===l){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[u]&&(u=t.morphTargetDictionary[u])}g=this.BindingType.ArrayElement,this.resolvedProperty=d,this.propertyIndex=u}else void 0!==d.fromArray&&void 0!==d.toArray?(g=this.BindingType.HasFromToArray,this.resolvedProperty=d):Array.isArray(d)?(g=this.BindingType.EntireArray,this.resolvedProperty=d):this.propertyName=l;this.getValue=this.GetterByBindingType[g],this.setValue=this.SetterByBindingTypeAndVersioning[g][p]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return a.Composite=sh,a})();Qn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Qn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Qn.prototype.GetterByBindingType=[Qn.prototype._getValue_direct,Qn.prototype._getValue_array,Qn.prototype._getValue_arrayElement,Qn.prototype._getValue_toArray],Qn.prototype.SetterByBindingTypeAndVersioning=[[Qn.prototype._setValue_direct,Qn.prototype._setValue_direct_setNeedsUpdate,Qn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Qn.prototype._setValue_array,Qn.prototype._setValue_array_setNeedsUpdate,Qn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Qn.prototype._setValue_arrayElement,Qn.prototype._setValue_arrayElement_setNeedsUpdate,Qn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Qn.prototype._setValue_fromArray,Qn.prototype._setValue_fromArray_setNeedsUpdate,Qn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1);class X0{constructor(e=1,t=0,n=0){return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Ti(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}const Z0=new K,_p=new K,K0=new K;class J0 extends Tr{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",void 0===t&&(t=1);let s=new Sn;s.setAttribute("position",new It([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const l=new Es({fog:!1,toneMapped:!1});this.lightPlane=new Wc(s,l),this.add(this.lightPlane),s=new Sn,s.setAttribute("position",new It([0,0,0,0,0,1],3)),this.targetLine=new Wc(s,l),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),Z0.setFromMatrixPosition(this.light.matrixWorld),_p.setFromMatrixPosition(this.light.target.matrixWorld),K0.subVectors(_p,Z0),this.lightPlane.lookAt(_p),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(_p),this.targetLine.scale.z=K0.length()}}class Xg extends Hf{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],s=new Sn;s.setAttribute("position",new It(t,3)),s.setAttribute("color",new It([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(s,new Es({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,n){const s=new pt,l=this.geometry.attributes.color.array;return s.set(e),s.toArray(l,0),s.toArray(l,3),s.set(t),s.toArray(l,6),s.toArray(l,9),s.set(n),s.toArray(l,12),s.toArray(l,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"155"}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="155");let Ow=(()=>{class a{constructor(t){this.markdownService=t,this.title="star",this.domWidth=window.innerWidth-20,this.domHeight=window.innerHeight-20,this.vertexShader="\n        //vertexShader\n        varying vec2 vUv;\n        uniform float uTime;\n        void main() {\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n          vUv = uv;\n        }",this.fragmentShader="\n        //fragmentShader\n        #define PI 3.1415926535897932384626433832795\n        varying vec2 vUv;\n        vec2 rotate(vec2 uv, float rotation, vec2 mid) {\n          return vec2(\n            cos(rotation) * (uv.x - mid.x) + sin(rotation) * (uv.y - mid.y) + mid.x,\n            cos(rotation) * (uv.y - mid.y) - sin(rotation) * (uv.x - mid.x) + mid.y\n          );\n        }\n        uniform float uTime;\n        void main() {\n            vec2 rotatedUv = rotate(vUv, PI*0.25, vec2(0.5));\n            float animation = mix(0.001, 0.01, (sin(uTime) + 1.0) * 0.5);\n            float strength = animation / distance(vec2(rotatedUv.x,(rotatedUv.y - 0.5)*5.0 + 0.5), vec2(0.5));\n            strength *= animation / distance(vec2(rotatedUv.y,(rotatedUv.x - 0.5)*5.0 + 0.5), vec2(0.5));\n            vec3 adjustedColor = vec3(0.5, 0.7, 0.9);\n            gl_FragColor = vec4(vec3(adjustedColor * strength ), 1.0);\n        }",this.myValue="print('hello-world')"}ngOnInit(){this.init(),console.log(this.markdownService.compile("I am using __markdown__."))}init(){var t;const n=new Br(70,this.domWidth/this.domHeight,.01,10);n.position.z=1;const s=new Kh,l=new ll(6,6,1),u=new eo({uniforms:{uOpacity:{value:50},uTime:{value:.1}},vertexShader:this.vertexShader,fragmentShader:this.fragmentShader,side:2}),d=new Yi(l,u);s.add(d);const p=new ig({antialias:!0});p.setClearColor(new pt(16777215)),p.setSize(this.domWidth,this.domHeight),p.setAnimationLoop(function _(M){u.uniforms.uTime.value+=.02,p.render(s,n)}),null===(t=document.getElementById("star-container"))||void 0===t||t.appendChild(p.domElement)}onLoad(){}}return a.\u0275fac=function(t){return new(t||a)(I.Y36(Lr))},a.\u0275cmp=I.Xpm({type:a,selectors:[["app-star"]],decls:8,vars:8,consts:[[1,"flex-box"],["id","star-container"],[1,"terminal"],[2,"overflow","auto"],[3,"data"]],template:function(t,n){1&t&&(I.TgZ(0,"div",0),I._UZ(1,"div",1),I.qZA(),I.TgZ(2,"div",2)(3,"div",3),I._UZ(4,"markdown",4),I.ALo(5,"language"),I._UZ(6,"markdown",4),I.ALo(7,"language"),I.qZA()()),2&t&&(I.xp6(4),I.Q6J("data",I.xi3(5,2,n.vertexShader,"c")),I.xp6(2),I.Q6J("data",I.xi3(7,5,n.fragmentShader,"c")))},directives:[Ds],pipes:[vi],styles:[""]}),a})();const qg={type:"change"},Yg={type:"start"},Q0={type:"end"},Ep=new bu,ah=new Vl,Fw=Math.cos(70*xo_DEG2RAD);class Zg extends Ja{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new K,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:0,MIDDLE:1,RIGHT:2},this.touches={ONE:0,TWO:2},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return d.phi},this.getAzimuthalAngle=function(){return d.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(le){le.addEventListener("keydown",Y),this._domElementKeyEvents=le},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",Y),this._domElementKeyEvents=null},this.saveState=function(){n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=function(){n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(qg),n.update(),l=s.NONE},this.update=function(){const le=new K,We=(new gr).setFromUnitVectors(e.up,new K(0,1,0)),Rt=We.clone().invert(),wt=new K,At=new gr,wn=new K,ei=2*Math.PI;return function(){const Ct=n.object.position;le.copy(Ct).sub(n.target),le.applyQuaternion(We),d.setFromVector3(le),n.autoRotate&&l===s.NONE&&x(function h(){return 2*Math.PI/60/60*n.autoRotateSpeed}()),n.enableDamping?(d.theta+=p.theta*n.dampingFactor,d.phi+=p.phi*n.dampingFactor):(d.theta+=p.theta,d.phi+=p.phi);let Ce=n.minAzimuthAngle,it=n.maxAzimuthAngle;isFinite(Ce)&&isFinite(it)&&(Ce<-Math.PI?Ce+=ei:Ce>Math.PI&&(Ce-=ei),it<-Math.PI?it+=ei:it>Math.PI&&(it-=ei),d.theta=Ce<=it?Math.max(Ce,Math.min(it,d.theta)):d.theta>(Ce+it)/2?Math.max(Ce,d.theta):Math.min(it,d.theta)),d.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,d.phi)),d.makeSafe(),!0===n.enableDamping?n.target.addScaledVector(_,n.dampingFactor):n.target.add(_),d.radius=re(n.zoomToCursor&&r||n.object.isOrthographicCamera?d.radius:d.radius*g),le.setFromSpherical(d),le.applyQuaternion(Rt),Ct.copy(n.target).add(le),n.object.lookAt(n.target),!0===n.enableDamping?(p.theta*=1-n.dampingFactor,p.phi*=1-n.dampingFactor,_.multiplyScalar(1-n.dampingFactor)):(p.set(0,0,0),_.set(0,0,0));let Tt=!1;if(n.zoomToCursor&&r){let Hn=null;if(n.object.isPerspectiveCamera){const xi=le.length();Hn=re(xi*g),n.object.position.addScaledVector(W,xi-Hn),n.object.updateMatrixWorld()}else if(n.object.isOrthographicCamera){const xi=new K(i.x,i.y,0);xi.unproject(n.object),n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/g)),n.object.updateProjectionMatrix(),Tt=!0;const Wi=new K(i.x,i.y,0);Wi.unproject(n.object),n.object.position.sub(Wi).add(xi),n.object.updateMatrixWorld(),Hn=le.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),n.zoomToCursor=!1;null!==Hn&&(this.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(Hn).add(n.object.position):(Ep.origin.copy(n.object.position),Ep.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(Ep.direction))<Fw?e.lookAt(n.target):(ah.setFromNormalAndCoplanarPoint(n.object.up,n.target),Ep.intersectPlane(ah,n.target))))}else n.object.isOrthographicCamera&&(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/g)),n.object.updateProjectionMatrix(),Tt=!0);return g=1,r=!1,!!(Tt||wt.distanceToSquared(n.object.position)>u||8*(1-At.dot(n.object.quaternion))>u||wn.distanceToSquared(n.target)>0)&&(n.dispatchEvent(qg),wt.copy(n.object.position),At.copy(n.object.quaternion),wn.copy(n.target),Tt=!1,!0)}}(),this.dispose=function(){n.domElement.removeEventListener("contextmenu",Ye),n.domElement.removeEventListener("pointerdown",Ft),n.domElement.removeEventListener("pointercancel",fn),n.domElement.removeEventListener("wheel",ne),n.domElement.removeEventListener("pointermove",Vt),n.domElement.removeEventListener("pointerup",fn),null!==n._domElementKeyEvents&&(n._domElementKeyEvents.removeEventListener("keydown",Y),n._domElementKeyEvents=null)};const n=this,s={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let l=s.NONE;const u=1e-6,d=new X0,p=new X0;let g=1;const _=new K,M=new ke,w=new ke,E=new ke,D=new ke,F=new ke,P=new ke,R=new ke,V=new ke,k=new ke,W=new K,i=new ke;let r=!1;const o=[],c={};function f(){return Math.pow(.95,n.zoomSpeed)}function x(le){p.theta-=le}function b(le){p.phi-=le}const C=function(){const le=new K;return function(Rt,wt){le.setFromMatrixColumn(wt,0),le.multiplyScalar(-Rt),_.add(le)}}(),L=function(){const le=new K;return function(Rt,wt){!0===n.screenSpacePanning?le.setFromMatrixColumn(wt,1):(le.setFromMatrixColumn(wt,0),le.crossVectors(n.object.up,le)),le.multiplyScalar(Rt),_.add(le)}}(),N=function(){const le=new K;return function(Rt,wt){const At=n.domElement;if(n.object.isPerspectiveCamera){le.copy(n.object.position).sub(n.target);let ei=le.length();ei*=Math.tan(n.object.fov/2*Math.PI/180),C(2*Rt*ei/At.clientHeight,n.object.matrix),L(2*wt*ei/At.clientHeight,n.object.matrix)}else n.object.isOrthographicCamera?(C(Rt*(n.object.right-n.object.left)/n.object.zoom/At.clientWidth,n.object.matrix),L(wt*(n.object.top-n.object.bottom)/n.object.zoom/At.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}}();function G(le){n.object.isPerspectiveCamera||n.object.isOrthographicCamera?g/=le:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function X(le){n.object.isPerspectiveCamera||n.object.isOrthographicCamera?g*=le:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function Z(le){if(!n.zoomToCursor)return;r=!0;const We=n.domElement.getBoundingClientRect(),wt=le.clientY-We.top,wn=We.height;i.x=(le.clientX-We.left)/We.width*2-1,i.y=-wt/wn*2+1,W.set(i.x,i.y,1).unproject(e).sub(e.position).normalize()}function re(le){return Math.max(n.minDistance,Math.min(n.maxDistance,le))}function ce(le){M.set(le.clientX,le.clientY)}function de(le){D.set(le.clientX,le.clientY)}function Pt(){1===o.length?M.set(o[0].pageX,o[0].pageY):M.set(.5*(o[0].pageX+o[1].pageX),.5*(o[0].pageY+o[1].pageY))}function Ln(){1===o.length?D.set(o[0].pageX,o[0].pageY):D.set(.5*(o[0].pageX+o[1].pageX),.5*(o[0].pageY+o[1].pageY))}function ri(){const le=o[0].pageX-o[1].pageX,We=o[0].pageY-o[1].pageY,Rt=Math.sqrt(le*le+We*We);R.set(0,Rt)}function ct(le){if(1==o.length)w.set(le.pageX,le.pageY);else{const Rt=Ae(le);w.set(.5*(le.pageX+Rt.x),.5*(le.pageY+Rt.y))}E.subVectors(w,M).multiplyScalar(n.rotateSpeed);const We=n.domElement;x(2*Math.PI*E.x/We.clientHeight),b(2*Math.PI*E.y/We.clientHeight),M.copy(w)}function Fe(le){if(1===o.length)F.set(le.pageX,le.pageY);else{const We=Ae(le);F.set(.5*(le.pageX+We.x),.5*(le.pageY+We.y))}P.subVectors(F,D).multiplyScalar(n.panSpeed),N(P.x,P.y),D.copy(F)}function tt(le){const We=Ae(le),Rt=le.pageX-We.x,wt=le.pageY-We.y,At=Math.sqrt(Rt*Rt+wt*wt);V.set(0,At),k.set(0,Math.pow(V.y/R.y,n.zoomSpeed)),G(k.y),R.copy(V)}function Ft(le){!1!==n.enabled&&(0===o.length&&(n.domElement.setPointerCapture(le.pointerId),n.domElement.addEventListener("pointermove",Vt),n.domElement.addEventListener("pointerup",fn)),function ut(le){o.push(le)}(le),"touch"===le.pointerType?function Ee(le){switch(dt(le),o.length){case 1:switch(n.touches.ONE){case 0:if(!1===n.enableRotate)return;Pt(),l=s.TOUCH_ROTATE;break;case 1:if(!1===n.enablePan)return;Ln(),l=s.TOUCH_PAN;break;default:l=s.NONE}break;case 2:switch(n.touches.TWO){case 2:if(!1===n.enableZoom&&!1===n.enablePan)return;(function Qt(){n.enableZoom&&ri(),n.enablePan&&Ln()})(),l=s.TOUCH_DOLLY_PAN;break;case 3:if(!1===n.enableZoom&&!1===n.enableRotate)return;(function oe(){n.enableZoom&&ri(),n.enableRotate&&Pt()})(),l=s.TOUCH_DOLLY_ROTATE;break;default:l=s.NONE}break;default:l=s.NONE}l!==s.NONE&&n.dispatchEvent(Yg)}(le):function Xn(le){let We;switch(le.button){case 0:We=n.mouseButtons.LEFT;break;case 1:We=n.mouseButtons.MIDDLE;break;case 2:We=n.mouseButtons.RIGHT;break;default:We=-1}switch(We){case 1:if(!1===n.enableZoom)return;(function ie(le){Z(le),R.set(le.clientX,le.clientY)})(le),l=s.DOLLY;break;case 0:if(le.ctrlKey||le.metaKey||le.shiftKey){if(!1===n.enablePan)return;de(le),l=s.PAN}else{if(!1===n.enableRotate)return;ce(le),l=s.ROTATE}break;case 2:if(le.ctrlKey||le.metaKey||le.shiftKey){if(!1===n.enableRotate)return;ce(le),l=s.ROTATE}else{if(!1===n.enablePan)return;de(le),l=s.PAN}break;default:l=s.NONE}l!==s.NONE&&n.dispatchEvent(Yg)}(le))}function Vt(le){!1!==n.enabled&&("touch"===le.pointerType?function at(le){switch(dt(le),l){case s.TOUCH_ROTATE:if(!1===n.enableRotate)return;ct(le),n.update();break;case s.TOUCH_PAN:if(!1===n.enablePan)return;Fe(le),n.update();break;case s.TOUCH_DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;(function Ge(le){n.enableZoom&&tt(le),n.enablePan&&Fe(le)})(le),n.update();break;case s.TOUCH_DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;(function Xt(le){n.enableZoom&&tt(le),n.enableRotate&&ct(le)})(le),n.update();break;default:l=s.NONE}}(le):function Ji(le){switch(l){case s.ROTATE:if(!1===n.enableRotate)return;!function he(le){w.set(le.clientX,le.clientY),E.subVectors(w,M).multiplyScalar(n.rotateSpeed);const We=n.domElement;x(2*Math.PI*E.x/We.clientHeight),b(2*Math.PI*E.y/We.clientHeight),M.copy(w),n.update()}(le);break;case s.DOLLY:if(!1===n.enableZoom)return;!function be(le){V.set(le.clientX,le.clientY),k.subVectors(V,R),k.y>0?G(f()):k.y<0&&X(f()),R.copy(V),n.update()}(le);break;case s.PAN:if(!1===n.enablePan)return;!function Pe(le){F.set(le.clientX,le.clientY),P.subVectors(F,D).multiplyScalar(n.panSpeed),N(P.x,P.y),D.copy(F),n.update()}(le)}}(le))}function fn(le){(function Jt(le){delete c[le.pointerId];for(let We=0;We<o.length;We++)if(o[We].pointerId==le.pointerId)return void o.splice(We,1)})(le),0===o.length&&(n.domElement.releasePointerCapture(le.pointerId),n.domElement.removeEventListener("pointermove",Vt),n.domElement.removeEventListener("pointerup",fn)),n.dispatchEvent(Q0),l=s.NONE}function ne(le){!1===n.enabled||!1===n.enableZoom||l!==s.NONE||(le.preventDefault(),n.dispatchEvent(Yg),function ot(le){Z(le),le.deltaY<0?X(f()):le.deltaY>0&&G(f()),n.update()}(le),n.dispatchEvent(Q0))}function Y(le){!1===n.enabled||!1===n.enablePan||function St(le){let We=!1;switch(le.code){case n.keys.UP:le.ctrlKey||le.metaKey||le.shiftKey?b(2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):N(0,n.keyPanSpeed),We=!0;break;case n.keys.BOTTOM:le.ctrlKey||le.metaKey||le.shiftKey?b(-2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):N(0,-n.keyPanSpeed),We=!0;break;case n.keys.LEFT:le.ctrlKey||le.metaKey||le.shiftKey?x(2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):N(n.keyPanSpeed,0),We=!0;break;case n.keys.RIGHT:le.ctrlKey||le.metaKey||le.shiftKey?x(-2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):N(-n.keyPanSpeed,0),We=!0}We&&(le.preventDefault(),n.update())}(le)}function Ye(le){!1!==n.enabled&&le.preventDefault()}function dt(le){let We=c[le.pointerId];void 0===We&&(We=new ke,c[le.pointerId]=We),We.set(le.pageX,le.pageY)}function Ae(le){return c[(le.pointerId===o[0].pointerId?o[1]:o[0]).pointerId]}n.domElement.addEventListener("contextmenu",Ye),n.domElement.addEventListener("pointerdown",Ft),n.domElement.addEventListener("pointercancel",fn),n.domElement.addEventListener("wheel",ne,{passive:!1}),this.update()}}let no=(()=>{class a{constructor(){this.domWidth=window.innerWidth,this.domHeight=window.innerHeight}init(){return this.scene=new Kh,this.renderer=new ig({antialias:!0}),this.camera=new Br,this.clock=new Bg,this.orbit_controls=new Zg(this.camera,this.renderer.domElement),this._initScene(),this._initCamera(),this._initRenderer(),this._initResponsiveResize(),this.renderer.setAnimationLoop(()=>{this.renderer.render(this.scene,this.camera)}),{scene:this.scene,camera:this.camera,renderer:this.renderer,orbit_controls:this.orbit_controls,clock:this.clock}}_initScene(){this.scene.background=new pt(0)}_initCamera(){this.camera.fov=55,this.camera.aspect=this.domWidth/this.domHeight,this.camera.near=.1,this.camera.far=1e3,this.camera.position.set(3,3,3),this.camera.updateProjectionMatrix()}_initRenderer(){this.renderer.shadowMap.enabled=!0,this.renderer.outputColorSpace=rn,this.renderer.toneMapping=4,this.renderer.setSize(this.domWidth,this.domHeight)}_initResponsiveResize(){window.addEventListener("resize",()=>{this.camera.aspect=this.domWidth/this.domHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.domWidth,this.domHeight),this.renderer.setPixelRatio(window.devicePixelRatio)})}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275prov=I.Yz7({token:a,factory:a.\u0275fac}),a})(),Nw=(()=>{class a{constructor(t){this.threeService=t,this.vertexShader="\n                          //vertexShader\n                          precision lowp float;\n                          varying vec2 vUv;\n                          varying vec3 vPosition;\n                          uniform float uTime;\n                          varying vec3 vNormal;\n                          void main() {\n                            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n                            vUv = uv;\n                            vPosition = position;\n                            vNormal = normalize(normalMatrix * normal);\n                        }",this.fragmentShader="\n                        //fragmentShader\n                        precision lowp float;\n                        uniform vec3 scanColor;\n                        varying vec2 vUv;\n                        uniform float uTime;\n                        uniform vec3 uSize;\n                        varying vec3 vPosition;\n                        varying vec3 vNormal;\n                        void main() {\n                          \n                          float y = (vPosition.y / uSize.y) + 0.5;\n                          float color = sin(-vUv.y + uTime * 0.3);\n                          color = mod(color, 1.0);\n                          color = step(0.02, color);\n                          if(y < 0.01 || y > 0.99) \n                          color = 1.0;\n                          float alpha = 1.0 - sin(vUv.y) * 0.7;\n\n                          vec3 lightDirection = normalize(vec3(0.9, 1.0, 0.8)); // \u5149\u6e90\u65b9\u5411\n                          float lightIntensity = max(dot(vNormal, lightDirection), 0.0); // \u5149\u7167\u5f3a\u5ea6\n                          vec3 lightColor = vec3(1.0, 1.0, 1.0); // \u5149\u6e90\u989c\u8272\n\n                          vec3 finalColor = vec3(color, 1.0, color) * lightColor * lightIntensity;\n                          gl_FragColor = vec4(finalColor, alpha);\n                          \n                        }\n                      "}ngOnInit(){const{scene:t,camera:n,renderer:s,orbit_controls:l,clock:u}=this.threeService.init();this.scene=t,this.camera=n,this.renderer=s,this.orbit_controls=l,this.clock=u,this.updaetScene(),this.renderer.render(this.scene,this.camera),this.orbit_controls.update()}updaetScene(){var t;const n=new Xg(30);this.scene.add(n);const s=new ll(5,5),l=new Ai({color:16777215,side:2}),u=new Yi(s,l);u.rotation.x=-.5*Math.PI,u.position.set(0,0,0),u.receiveShadow=!0;for(let g=0;g<18;g++){const M=Number(1*Math.random()).toFixed(2),w=new Lu(1*Math.random(),Number(M),1*Math.random());w.computeBoundingBox();const{max:E,min:D}=w.boundingBox,F=new K(E.x-D.x,E.y-D.y,E.z-D.z),P=new eo({uniforms:{uOpacity:{value:50},uTime:{value:.1},uSize:{value:F},scanColor:{value:new pt(65280)}},vertexShader:this.vertexShader,fragmentShader:this.fragmentShader}),R=new Yi(w,P);R.position.set(2*Math.random(),Number(M)/2,2*Math.random()),R.castShadow=!0,R.name="box",this.scene.add(R)}const d=new pp(16777215),p=new J0(d,.2);d.position.set(-3,2,-1),d.target=u,d.castShadow=!0,this.renderer.shadowMap.enabled=!0,this.scene.add(u,d,p),null===(t=document.getElementById("cube-container"))||void 0===t||t.appendChild(this.renderer.domElement),this.renderer.setAnimationLoop(this.animation.bind(this))}animation(){this.scene.traverse(function(t){"box"===t.name&&(t.material.uniforms.uTime.value+=.02)}),this.renderer.render(this.scene,this.camera)}}return a.\u0275fac=function(t){return new(t||a)(I.Y36(no))},a.\u0275cmp=I.Xpm({type:a,selectors:[["app-cube"]],decls:8,vars:8,consts:[[1,"flex-box"],["id","cube-container"],[1,"terminal"],[2,"overflow","auto"],[3,"data"]],template:function(t,n){1&t&&(I.TgZ(0,"div",0),I._UZ(1,"div",1),I.qZA(),I.TgZ(2,"div",2)(3,"div",3),I._UZ(4,"markdown",4),I.ALo(5,"language"),I._UZ(6,"markdown",4),I.ALo(7,"language"),I.qZA()()),2&t&&(I.xp6(4),I.Q6J("data",I.xi3(5,2,n.vertexShader,"c")),I.xp6(2),I.Q6J("data",I.xi3(7,5,n.fragmentShader,"c")))},directives:[Ds],pipes:[vi],styles:[""]}),a})();var su=function(a){return URL.createObjectURL(new Blob([a],{type:"text/javascript"}))};try{URL.revokeObjectURL(su(""))}catch(a){su=function(e){return"data:application/javascript;charset=UTF-8,"+encodeURI(e)}}var gi=Uint8Array,ar=Uint16Array,oa=Uint32Array,lh=new gi([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),ch=new gi([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),uh=new gi([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Kg=function(a,e){for(var t=new ar(31),n=0;n<31;++n)t[n]=e+=1<<a[n-1];var s=new oa(t[30]);for(n=1;n<30;++n)for(var l=t[n];l<t[n+1];++l)s[l]=l-t[n]<<5|n;return[t,s]},Cp=Kg(lh,2),Tp=Cp[0],Ap=Cp[1];Tp[28]=258,Ap[258]=28;for(var Uw=Kg(ch,0)[0],ou=new ar(32768),Si=0;Si<32768;++Si){var Oa=(43690&Si)>>>1|(21845&Si)<<1;ou[Si]=((65280&(Oa=(61680&(Oa=(52428&Oa)>>>2|(13107&Oa)<<2))>>>4|(3855&Oa)<<4))>>>8|(255&Oa)<<8)>>>1}var Ro=function(a,e,t){for(var n=a.length,s=0,l=new ar(e);s<n;++s)++l[a[s]-1];var d,u=new ar(e);for(s=0;s<e;++s)u[s]=u[s-1]+l[s-1]<<1;if(t){d=new ar(1<<e);var p=15-e;for(s=0;s<n;++s)if(a[s])for(var g=s<<4|a[s],_=e-a[s],M=u[a[s]-1]++<<_,w=M|(1<<_)-1;M<=w;++M)d[ou[M]>>>p]=g}else for(d=new ar(n),s=0;s<n;++s)a[s]&&(d[s]=ou[u[a[s]-1]++]>>>15-a[s]);return d},Yl=new gi(288);for(Si=0;Si<144;++Si)Yl[Si]=8;for(Si=144;Si<256;++Si)Yl[Si]=9;for(Si=256;Si<280;++Si)Yl[Si]=7;for(Si=280;Si<288;++Si)Yl[Si]=8;var Ad=new gi(32);for(Si=0;Si<32;++Si)Ad[Si]=5;var i_=Ro(Yl,9,1),Dp=Ro(Ad,5,1),Dd=function(a){for(var e=a[0],t=1;t<a.length;++t)a[t]>e&&(e=a[t]);return e},Io=function(a,e,t){var n=e/8|0;return(a[n]|a[n+1]<<8)>>(7&e)&t},Rd=function(a,e){var t=e/8|0;return(a[t]|a[t+1]<<8|a[t+2]<<16)>>(7&e)},hh=function(a){return(a/8|0)+(7&a&&1)},Id=function(a,e,t){var n=a.length;if(!n||t&&!t.l&&n<5)return e||new gi(0);var s=!e||t,l=!t||t.i;t||(t={}),e||(e=new gi(3*n));var u=function(ot){var St=e.length;if(ot>St){var Pt=new gi(Math.max(2*St,ot));Pt.set(e),e=Pt}},d=t.f||0,p=t.p||0,g=t.b||0,_=t.l,M=t.d,w=t.m,E=t.n,D=8*n;do{if(!_){t.f=d=Io(a,p,1);var F=Io(a,p+1,3);if(p+=3,!F){var R=a[(P=hh(p)+4)-4]|a[P-3]<<8,V=P+R;if(V>n){if(l)throw"unexpected EOF";break}s&&u(g+R),e.set(a.subarray(P,V),g),t.b=g+=R,t.p=p=8*V;continue}if(1==F)_=i_,M=Dp,w=9,E=5;else{if(2!=F)throw"invalid block type";var k=Io(a,p,31)+257,W=Io(a,p+10,15)+4,i=k+Io(a,p+5,31)+1;p+=14;for(var r=new gi(i),o=new gi(19),c=0;c<W;++c)o[uh[c]]=Io(a,p+3*c,7);p+=3*W;var h=Dd(o),f=(1<<h)-1,x=Ro(o,h,1);for(c=0;c<i;){var P,b=x[Io(a,p,f)];if(p+=15&b,(P=b>>>4)<16)r[c++]=P;else{var C=0,L=0;for(16==P?(L=3+Io(a,p,3),p+=2,C=r[c-1]):17==P?(L=3+Io(a,p,7),p+=3):18==P&&(L=11+Io(a,p,127),p+=7);L--;)r[c++]=C}}var N=r.subarray(0,k),G=r.subarray(k);w=Dd(N),E=Dd(G),_=Ro(N,w,1),M=Ro(G,E,1)}if(p>D){if(l)throw"unexpected EOF";break}}s&&u(g+131072);for(var X=(1<<w)-1,Z=(1<<E)-1,re=p;;re=p){var ce=(C=_[Rd(a,p)&X])>>>4;if((p+=15&C)>D){if(l)throw"unexpected EOF";break}if(!C)throw"invalid length/literal";if(ce<256)e[g++]=ce;else{if(256==ce){re=p,_=null;break}var ie=ce-254;ce>264&&(ie=Io(a,p,(1<<(de=lh[c=ce-257]))-1)+Tp[c],p+=de);var he=M[Rd(a,p)&Z],be=he>>>4;if(!he)throw"invalid distance";if(p+=15&he,G=Uw[be],be>3){var de=ch[be];G+=Rd(a,p)&(1<<de)-1,p+=de}if(p>D){if(l)throw"unexpected EOF";break}s&&u(g+131072);for(var Pe=g+ie;g<Pe;g+=4)e[g]=e[g-G],e[g+1]=e[g+1-G],e[g+2]=e[g+2-G],e[g+3]=e[g+3-G];g=Pe}}t.l=_,t.p=re,t.b=g,_&&(d=1,t.m=w,t.d=M,t.n=E)}while(!d);return g==e.length?e:function(a,e,t){(null==e||e<0)&&(e=0),(null==t||t>a.length)&&(t=a.length);var n=new(a instanceof ar?ar:a instanceof oa?oa:gi)(t-e);return n.set(a.subarray(e,t)),n}(e,0,g)},Kl=new gi(0);var Ud="undefined"!=typeof TextDecoder&&new TextDecoder;try{Ud.decode(Kl,{stream:!0})}catch(a){}function Fa(a,e,t){const n=t.length-a-1;if(e>=t[n])return n-1;if(e<=t[a])return a;let s=a,l=n,u=Math.floor((s+l)/2);for(;e<t[u]||e>=t[u+1];)e<t[u]?l=u:s=u,u=Math.floor((s+l)/2);return u}function ib(a,e){let t=1;for(let s=2;s<=a;++s)t*=s;let n=1;for(let s=2;s<=e;++s)n*=s;for(let s=2;s<=a-e;++s)n*=s;return t/n}class ab extends class ra{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,s=this.getPoint(0),l=0;t.push(0);for(let u=1;u<=e;u++)n=this.getPoint(u/e),l+=n.distanceTo(s),t.push(l),s=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const n=this.getLengths();let s=0;const l=n.length;let u;u=t||e*n[l-1];let g,d=0,p=l-1;for(;d<=p;)if(s=Math.floor(d+(p-d)/2),g=n[s]-u,g<0)d=s+1;else{if(!(g>0)){p=s;break}p=s-1}if(s=p,n[s]===u)return s/(l-1);const _=n[s];return(s+(u-_)/(n[s+1]-_))/(l-1)}getTangent(e,t){let s=e-1e-4,l=e+1e-4;s<0&&(s=0),l>1&&(l=1);const u=this.getPoint(s),d=this.getPoint(l),p=t||(u.isVector2?new ke:new K);return p.copy(d).sub(u).normalize(),p}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){const n=new K,s=[],l=[],u=[],d=new K,p=new Bt;for(let E=0;E<=e;E++)s[E]=this.getTangentAt(E/e,new K);l[0]=new K,u[0]=new K;let g=Number.MAX_VALUE;const _=Math.abs(s[0].x),M=Math.abs(s[0].y),w=Math.abs(s[0].z);_<=g&&(g=_,n.set(1,0,0)),M<=g&&(g=M,n.set(0,1,0)),w<=g&&n.set(0,0,1),d.crossVectors(s[0],n).normalize(),l[0].crossVectors(s[0],d),u[0].crossVectors(s[0],l[0]);for(let E=1;E<=e;E++){if(l[E]=l[E-1].clone(),u[E]=u[E-1].clone(),d.crossVectors(s[E-1],s[E]),d.length()>Number.EPSILON){d.normalize();const D=Math.acos(Ti(s[E-1].dot(s[E]),-1,1));l[E].applyMatrix4(p.makeRotationAxis(d,D))}u[E].crossVectors(s[E],l[E])}if(!0===t){let E=Math.acos(Ti(l[0].dot(l[e]),-1,1));E/=e,s[0].dot(d.crossVectors(l[0],l[e]))>0&&(E=-E);for(let D=1;D<=e;D++)l[D].applyMatrix4(p.makeRotationAxis(s[D],E*D)),u[D].crossVectors(s[D],l[D])}return{tangents:s,normals:l,binormals:u}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}{constructor(e,t,n,s,l){super(),this.degree=e,this.knots=t,this.controlPoints=[],this.startKnot=s||0,this.endKnot=l||this.knots.length-1;for(let u=0;u<n.length;++u){const d=n[u];this.controlPoints[u]=new ii(d.x,d.y,d.z,d.w)}}getPoint(e,t=new K){const n=t,l=function M_(a,e,t,n){const s=Fa(a,n,e),l=function Vp(a,e,t,n){const s=[],l=[],u=[];s[0]=1;for(let d=1;d<=t;++d){l[d]=e-n[a+1-d],u[d]=n[a+d]-e;let p=0;for(let g=0;g<d;++g){const _=u[g+1],M=l[d-g],w=s[g]/(_+M);s[g]=p+_*w,p=M*w}s[d]=p}return s}(s,n,a,e),u=new ii(0,0,0,0);for(let d=0;d<=a;++d){const p=t[s-a+d],g=l[d],_=p.w*g;u.x+=p.x*_,u.y+=p.y*_,u.z+=p.z*_,u.w+=p.w*g}return u}(this.degree,this.knots,this.controlPoints,this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]));return 1!==l.w&&l.divideScalar(l.w),n.set(l.x,l.y,l.z)}getTangent(e,t=new K){const n=t,l=function sb(a,e,t,n,s){const l=function nS(a,e,t,n,s){const l=s<a?s:a,u=[],d=Fa(a,n,e),p=function nb(a,e,t,n,s){const l=[];for(let M=0;M<=t;++M)l[M]=0;const u=[];for(let M=0;M<=n;++M)u[M]=l.slice(0);const d=[];for(let M=0;M<=t;++M)d[M]=l.slice(0);d[0][0]=1;const p=l.slice(0),g=l.slice(0);for(let M=1;M<=t;++M){p[M]=e-s[a+1-M],g[M]=s[a+M]-e;let w=0;for(let E=0;E<M;++E){const D=g[E+1],F=p[M-E];d[M][E]=D+F;const P=d[E][M-1]/d[M][E];d[E][M]=w+D*P,w=F*P}d[M][M]=w}for(let M=0;M<=t;++M)u[0][M]=d[M][t];for(let M=0;M<=t;++M){let w=0,E=1;const D=[];for(let F=0;F<=t;++F)D[F]=l.slice(0);D[0][0]=1;for(let F=1;F<=n;++F){let P=0;const R=M-F,V=t-F;M>=F&&(D[E][0]=D[w][0]/d[V+1][R],P=D[E][0]*d[R][V]);const W=M-1<=V?F-1:t-M;for(let r=R>=-1?1:-R;r<=W;++r)D[E][r]=(D[w][r]-D[w][r-1])/d[V+1][R+r],P+=D[E][r]*d[R+r][V];M<=V&&(D[E][F]=-D[w][F-1]/d[V+1][M],P+=D[E][F]*d[M][V]),u[F][M]=P;const i=w;w=E,E=i}}let _=t;for(let M=1;M<=n;++M){for(let w=0;w<=t;++w)u[M][w]*=_;_*=t-M}return u}(d,n,a,l,e),g=[];for(let _=0;_<t.length;++_){const M=t[_].clone(),w=M.w;M.x*=w,M.y*=w,M.z*=w,g[_]=M}for(let _=0;_<=l;++_){const M=g[d-a].clone().multiplyScalar(p[_][0]);for(let w=1;w<=a;++w)M.add(g[d-a+w].clone().multiplyScalar(p[_][w]));u[_]=M}for(let _=l+1;_<=s+1;++_)u[_]=new ii(0,0,0);return u}(a,e,t,n,s);return function rb(a){const e=a.length,t=[],n=[];for(let l=0;l<e;++l){const u=a[l];t[l]=new K(u.x,u.y,u.z),n[l]=u.w}const s=[];for(let l=0;l<e;++l){const u=t[l].clone();for(let d=1;d<=l;++d)u.sub(s[l-d].clone().multiplyScalar(ib(l,d)*n[d]));s[l]=u.divideScalar(n[0])}return s}(l)}(this.degree,this.knots,this.controlPoints,this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),1);return n.copy(l[1]).normalize(),n}}let Un,yr,ds;class w_ extends Qc{constructor(e){super(e)}load(e,t,n,s){const l=this,u=""===l.path?class Ug{static decodeText(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);let t="";for(let n=0,s=e.length;n<s;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch(n){return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}.extractUrlBase(e):l.path,d=new Xl(this.manager);d.setPath(l.path),d.setResponseType("arraybuffer"),d.setRequestHeader(l.requestHeader),d.setWithCredentials(l.withCredentials),d.load(e,function(p){try{t(l.parse(p,u))}catch(g){s?s(g):console.error(g),l.manager.itemError(e)}},n,s)}parse(e,t){if(function S_(a){const e="Kaydara FBX Binary  \0";return a.byteLength>=e.length&&e===db(a,0,e.length)}(e))Un=(new cv).parse(e);else{const s=db(e);if(!function C_(a){const e=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let t=0;function n(s){const l=a[s-1];return a=a.slice(t+s),t++,l}for(let s=0;s<e.length;++s)if(n(1)===e[s])return!1;return!0}(s))throw new Error("THREE.FBXLoader: Unknown format.");if(ub(s)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+ub(s));Un=(new lv).parse(s)}const n=new S0(this.manager).setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin);return new lb(n,this.manager).parse(Un)}}class lb{constructor(e,t){this.textureLoader=e,this.manager=t}parse(){yr=this.parseConnections();const e=this.parseImages(),t=this.parseTextures(e),n=this.parseMaterials(t),s=this.parseDeformers(),l=(new cb).parse(s);return this.parseScene(s,l,n),ds}parseConnections(){const e=new Map;return"Connections"in Un&&Un.Connections.connections.forEach(function(n){const s=n[0],l=n[1],u=n[2];e.has(s)||e.set(s,{parents:[],children:[]});const d={ID:l,relationship:u};e.get(s).parents.push(d),e.has(l)||e.set(l,{parents:[],children:[]});const p={ID:s,relationship:u};e.get(l).children.push(p)}),e}parseImages(){const e={},t={};if("Video"in Un.Objects){const n=Un.Objects.Video;for(const s in n){const l=n[s];if(e[parseInt(s)]=l.RelativeFilename||l.Filename,"Content"in l){const d=l.Content instanceof ArrayBuffer&&l.Content.byteLength>0,p="string"==typeof l.Content&&""!==l.Content;if(d||p){const g=this.parseImage(n[s]);t[l.RelativeFilename||l.Filename]=g}}}}for(const n in e){const s=e[n];e[n]=void 0!==t[s]?t[s]:e[n].split("\\").pop()}return e}parseImage(e){const t=e.Content,n=e.RelativeFilename||e.Filename,s=n.slice(n.lastIndexOf(".")+1).toLowerCase();let l;switch(s){case"bmp":l="image/bmp";break;case"jpg":case"jpeg":l="image/jpeg";break;case"png":l="image/png";break;case"tif":l="image/tiff";break;case"tga":null===this.manager.getHandler(".tga")&&console.warn("FBXLoader: TGA loader not found, skipping ",n),l="image/tga";break;default:return void console.warn('FBXLoader: Image type "'+s+'" is not supported.')}if("string"==typeof t)return"data:"+l+";base64,"+t;{const u=new Uint8Array(t);return window.URL.createObjectURL(new Blob([u],{type:l}))}}parseTextures(e){const t=new Map;if("Texture"in Un.Objects){const n=Un.Objects.Texture;for(const s in n){const l=this.parseTexture(n[s],e);t.set(parseInt(s),l)}}return t}parseTexture(e,t){const n=this.loadTexture(e,t);n.ID=e.id,n.name=e.attrName;const s=e.WrapModeU,l=e.WrapModeV,d=void 0!==l?l.value:0;if(n.wrapS=0===(void 0!==s?s.value:0)?Vi:zn,n.wrapT=0===d?Vi:zn,"Scaling"in e){const p=e.Scaling.value;n.repeat.x=p[0],n.repeat.y=p[1]}if("Translation"in e){const p=e.Translation.value;n.offset.x=p[0],n.offset.y=p[1]}return n}loadTexture(e,t){let n;const s=this.textureLoader.path,l=yr.get(e.id).children;let u;void 0!==l&&l.length>0&&void 0!==t[l[0].ID]&&(n=t[l[0].ID],(0===n.indexOf("blob:")||0===n.indexOf("data:"))&&this.textureLoader.setPath(void 0));const d=e.FileName.slice(-3).toLowerCase();if("tga"===d){const p=this.manager.getHandler(".tga");null===p?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",e.RelativeFilename),u=new ws):(p.setPath(this.textureLoader.path),u=p.load(n))}else"psd"===d?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",e.RelativeFilename),u=new ws):u=this.textureLoader.load(n);return this.textureLoader.setPath(s),u}parseMaterials(e){const t=new Map;if("Material"in Un.Objects){const n=Un.Objects.Material;for(const s in n){const l=this.parseMaterial(n[s],e);null!==l&&t.set(parseInt(s),l)}}return t}parseMaterial(e,t){const n=e.id,s=e.attrName;let l=e.ShadingModel;if("object"==typeof l&&(l=l.value),!yr.has(n))return null;const u=this.parseParameters(e,t,n);let d;switch(l.toLowerCase()){case"phong":d=new ap;break;case"lambert":d=new Ai;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',l),d=new ap}return d.setValues(u),d.name=s,d}parseParameters(e,t,n){const s={};e.BumpFactor&&(s.bumpScale=e.BumpFactor.value),e.Diffuse?s.color=(new pt).fromArray(e.Diffuse.value).convertSRGBToLinear():e.DiffuseColor&&("Color"===e.DiffuseColor.type||"ColorRGB"===e.DiffuseColor.type)&&(s.color=(new pt).fromArray(e.DiffuseColor.value).convertSRGBToLinear()),e.DisplacementFactor&&(s.displacementScale=e.DisplacementFactor.value),e.Emissive?s.emissive=(new pt).fromArray(e.Emissive.value).convertSRGBToLinear():e.EmissiveColor&&("Color"===e.EmissiveColor.type||"ColorRGB"===e.EmissiveColor.type)&&(s.emissive=(new pt).fromArray(e.EmissiveColor.value).convertSRGBToLinear()),e.EmissiveFactor&&(s.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),e.Opacity&&(s.opacity=parseFloat(e.Opacity.value)),s.opacity<1&&(s.transparent=!0),e.ReflectionFactor&&(s.reflectivity=e.ReflectionFactor.value),e.Shininess&&(s.shininess=e.Shininess.value),e.Specular?s.specular=(new pt).fromArray(e.Specular.value).convertSRGBToLinear():e.SpecularColor&&"Color"===e.SpecularColor.type&&(s.specular=(new pt).fromArray(e.SpecularColor.value).convertSRGBToLinear());const l=this;return yr.get(n).children.forEach(function(u){const d=u.relationship;switch(d){case"Bump":s.bumpMap=l.getTexture(t,u.ID);break;case"Maya|TEX_ao_map":s.aoMap=l.getTexture(t,u.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":s.map=l.getTexture(t,u.ID),void 0!==s.map&&(s.map.colorSpace=rn);break;case"DisplacementColor":s.displacementMap=l.getTexture(t,u.ID);break;case"EmissiveColor":s.emissiveMap=l.getTexture(t,u.ID),void 0!==s.emissiveMap&&(s.emissiveMap.colorSpace=rn);break;case"NormalMap":case"Maya|TEX_normal_map":s.normalMap=l.getTexture(t,u.ID);break;case"ReflectionColor":s.envMap=l.getTexture(t,u.ID),void 0!==s.envMap&&(s.envMap.mapping=303,s.envMap.colorSpace=rn);break;case"SpecularColor":s.specularMap=l.getTexture(t,u.ID),void 0!==s.specularMap&&(s.specularMap.colorSpace=rn);break;case"TransparentColor":case"TransparencyFactor":s.alphaMap=l.getTexture(t,u.ID),s.transparent=!0;break;default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",d)}}),s}getTexture(e,t){return"LayeredTexture"in Un.Objects&&t in Un.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),t=yr.get(t).children[0].ID),e.get(t)}parseDeformers(){const e={},t={};if("Deformer"in Un.Objects){const n=Un.Objects.Deformer;for(const s in n){const l=n[s],u=yr.get(parseInt(s));if("Skin"===l.attrType){const d=this.parseSkeleton(u,n);d.ID=s,u.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),d.geometryID=u.parents[0].ID,e[s]=d}else if("BlendShape"===l.attrType){const d={id:s};d.rawTargets=this.parseMorphTargets(u,n),d.id=s,u.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),t[s]=d}}}return{skeletons:e,morphTargets:t}}parseSkeleton(e,t){const n=[];return e.children.forEach(function(s){const l=t[s.ID];if("Cluster"!==l.attrType)return;const u={ID:s.ID,indices:[],weights:[],transformLink:(new Bt).fromArray(l.TransformLink.a)};"Indexes"in l&&(u.indices=l.Indexes.a,u.weights=l.Weights.a),n.push(u)}),{rawBones:n,bones:[]}}parseMorphTargets(e,t){const n=[];for(let s=0;s<e.children.length;s++){const l=e.children[s],u=t[l.ID],d={name:u.attrName,initialWeight:u.DeformPercent,id:u.id,fullWeights:u.FullWeights.a};if("BlendShapeChannel"!==u.attrType)return;d.geoID=yr.get(parseInt(l.ID)).children.filter(function(p){return void 0===p.relationship})[0].ID,n.push(d)}return n}parseScene(e,t,n){ds=new Vc;const s=this.parseModels(e.skeletons,t,n),l=Un.Objects.Model,u=this;s.forEach(function(p){u.setLookAtProperties(p,l[p.ID]),yr.get(p.ID).parents.forEach(function(M){const w=s.get(M.ID);void 0!==w&&w.add(p)}),null===p.parent&&ds.add(p)}),this.bindSkeleton(e.skeletons,t,s),this.createAmbientLight(),ds.traverse(function(p){if(p.userData.transformData){p.parent&&(p.userData.transformData.parentMatrix=p.parent.matrix,p.userData.transformData.parentMatrixWorld=p.parent.matrixWorld);const g=T_(p.userData.transformData);p.applyMatrix4(g),p.updateWorldMatrix()}});const d=(new b_).parse();1===ds.children.length&&ds.children[0].isGroup&&(ds.children[0].animations=d,ds=ds.children[0]),ds.animations=d}parseModels(e,t,n){const s=new Map,l=Un.Objects.Model;for(const u in l){const d=parseInt(u),p=l[u],g=yr.get(d);let _=this.buildSkeleton(g,e,d,p.attrName);if(!_){switch(p.attrType){case"Camera":_=this.createCamera(g);break;case"Light":_=this.createLight(g);break;case"Mesh":_=this.createMesh(g,t,n);break;case"NurbsCurve":_=this.createCurve(g,t);break;case"LimbNode":case"Root":_=new ld;break;default:_=new Vc}_.name=p.attrName?Qn.sanitizeNodeName(p.attrName):"",_.ID=d}this.getTransformData(_,p),s.set(d,_)}return s}buildSkeleton(e,t,n,s){let l=null;return e.parents.forEach(function(u){for(const d in t){const p=t[d];p.rawBones.forEach(function(g,_){if(g.ID===u.ID){const M=l;l=new ld,l.matrixWorld.copy(g.transformLink),l.name=s?Qn.sanitizeNodeName(s):"",l.ID=n,p.bones[_]=l,null!==M&&l.add(M)}})}}),l}createCamera(e){let t,n;if(e.children.forEach(function(s){const l=Un.Objects.NodeAttribute[s.ID];void 0!==l&&(n=l)}),void 0===n)t=new Tr;else{let s=0;void 0!==n.CameraProjectionType&&1===n.CameraProjectionType.value&&(s=1);let l=1;void 0!==n.NearPlane&&(l=n.NearPlane.value/1e3);let u=1e3;void 0!==n.FarPlane&&(u=n.FarPlane.value/1e3);let d=window.innerWidth,p=window.innerHeight;void 0!==n.AspectWidth&&void 0!==n.AspectHeight&&(d=n.AspectWidth.value,p=n.AspectHeight.value);const g=d/p;let _=45;void 0!==n.FieldOfView&&(_=n.FieldOfView.value);const M=n.FocalLength?n.FocalLength.value:null;switch(s){case 0:t=new Br(_,g,l,u),null!==M&&t.setFocalLength(M);break;case 1:t=new Ef(-d/2,d/2,p/2,-p/2,l,u);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+s+"."),t=new Tr}}return t}createLight(e){let t,n;if(e.children.forEach(function(s){const l=Un.Objects.NodeAttribute[s.ID];void 0!==l&&(n=l)}),void 0===n)t=new Tr;else{let s;s=void 0===n.LightType?0:n.LightType.value;let l=16777215;void 0!==n.Color&&(l=(new pt).fromArray(n.Color.value).convertSRGBToLinear());let u=void 0===n.Intensity?1:n.Intensity.value/100;void 0!==n.CastLightOnObject&&0===n.CastLightOnObject.value&&(u=0);let d=0;void 0!==n.FarAttenuationEnd&&(d=void 0!==n.EnableFarAttenuation&&0===n.EnableFarAttenuation.value?0:n.FarAttenuationEnd.value);const p=1;switch(s){case 0:t=new Ng(l,u,d,p);break;case 1:t=new pp(l,u);break;case 2:let g=Math.PI/3;void 0!==n.InnerAngle&&(g=xo_degToRad(n.InnerAngle.value));let _=0;void 0!==n.OuterAngle&&(_=xo_degToRad(n.OuterAngle.value),_=Math.max(_,1)),t=new D0(l,u,d,g,_,p);break;default:console.warn("THREE.FBXLoader: Unknown light type "+n.LightType.value+", defaulting to a PointLight."),t=new Ng(l,u)}void 0!==n.CastShadows&&1===n.CastShadows.value&&(t.castShadow=!0)}return t}createMesh(e,t,n){let s,l=null,u=null;const d=[];return e.children.forEach(function(p){t.has(p.ID)&&(l=t.get(p.ID)),n.has(p.ID)&&d.push(n.get(p.ID))}),d.length>1?u=d:d.length>0?u=d[0]:(u=new ap({name:Qc.DEFAULT_MATERIAL_NAME,color:13421772}),d.push(u)),"color"in l.attributes&&d.forEach(function(p){p.vertexColors=!0}),l.FBX_Deformer?(s=new Yu(l,u),s.normalizeSkinWeights()):s=new Yi(l,u),s}createCurve(e,t){const n=e.children.reduce(function(l,u){return t.has(u.ID)&&(l=t.get(u.ID)),l},null),s=new Es({name:Qc.DEFAULT_MATERIAL_NAME,color:3342591,linewidth:1});return new Wc(n,s)}getTransformData(e,t){const n={};"InheritType"in t&&(n.inheritType=parseInt(t.InheritType.value)),n.eulerOrder="RotationOrder"in t?A_(t.RotationOrder.value):"ZYX","Lcl_Translation"in t&&(n.translation=t.Lcl_Translation.value),"PreRotation"in t&&(n.preRotation=t.PreRotation.value),"Lcl_Rotation"in t&&(n.rotation=t.Lcl_Rotation.value),"PostRotation"in t&&(n.postRotation=t.PostRotation.value),"Lcl_Scaling"in t&&(n.scale=t.Lcl_Scaling.value),"ScalingOffset"in t&&(n.scalingOffset=t.ScalingOffset.value),"ScalingPivot"in t&&(n.scalingPivot=t.ScalingPivot.value),"RotationOffset"in t&&(n.rotationOffset=t.RotationOffset.value),"RotationPivot"in t&&(n.rotationPivot=t.RotationPivot.value),e.userData.transformData=n}setLookAtProperties(e,t){"LookAtProperty"in t&&yr.get(e.ID).children.forEach(function(s){if("LookAtProperty"===s.relationship){const l=Un.Objects.Model[s.ID];if("Lcl_Translation"in l){const u=l.Lcl_Translation.value;void 0!==e.target?(e.target.position.fromArray(u),ds.add(e.target)):e.lookAt((new K).fromArray(u))}}})}bindSkeleton(e,t,n){const s=this.parsePoseNodes();for(const l in e){const u=e[l];yr.get(parseInt(u.ID)).parents.forEach(function(p){t.has(p.ID)&&yr.get(p.ID).parents.forEach(function(M){n.has(M.ID)&&n.get(M.ID).bind(new Gc(u.bones),s[M.ID])})})}}parsePoseNodes(){const e={};if("Pose"in Un.Objects){const t=Un.Objects.Pose;for(const n in t)if("BindPose"===t[n].attrType&&t[n].NbPoseNodes>0){const s=t[n].PoseNode;Array.isArray(s)?s.forEach(function(l){e[l.Node]=(new Bt).fromArray(l.Matrix.a)}):e[s.Node]=(new Bt).fromArray(s.Matrix.a)}}return e}createAmbientLight(){if("GlobalSettings"in Un&&"AmbientColor"in Un.GlobalSettings){const e=Un.GlobalSettings.AmbientColor.value,t=e[0],n=e[1],s=e[2];if(0!==t||0!==n||0!==s){const l=new pt(t,n,s).convertSRGBToLinear();ds.add(new kg(l,1))}}}}class cb{constructor(){this.negativeMaterialIndices=!1}parse(e){const t=new Map;if("Geometry"in Un.Objects){const n=Un.Objects.Geometry;for(const s in n){const l=yr.get(parseInt(s)),u=this.parseGeometry(l,n[s],e);t.set(parseInt(s),u)}}return!0===this.negativeMaterialIndices&&console.warn("THREE.FBXLoader: The FBX file contains invalid (negative) material indices. The asset might not render as expected."),t}parseGeometry(e,t,n){switch(t.attrType){case"Mesh":return this.parseMeshGeometry(e,t,n);case"NurbsCurve":return this.parseNurbsGeometry(t)}}parseMeshGeometry(e,t,n){const s=n.skeletons,l=[],u=e.parents.map(function(M){return Un.Objects.Model[M.ID]});if(0===u.length)return;const d=e.children.reduce(function(M,w){return void 0!==s[w.ID]&&(M=s[w.ID]),M},null);e.children.forEach(function(M){void 0!==n.morphTargets[M.ID]&&l.push(n.morphTargets[M.ID])});const p=u[0],g={};"RotationOrder"in p&&(g.eulerOrder=A_(p.RotationOrder.value)),"InheritType"in p&&(g.inheritType=parseInt(p.InheritType.value)),"GeometricTranslation"in p&&(g.translation=p.GeometricTranslation.value),"GeometricRotation"in p&&(g.rotation=p.GeometricRotation.value),"GeometricScaling"in p&&(g.scale=p.GeometricScaling.value);const _=T_(g);return this.genGeometry(t,d,l,_)}genGeometry(e,t,n,s){const l=new Sn;e.attrName&&(l.name=e.attrName);const u=this.parseGeoNode(e,t),d=this.genBuffers(u),p=new It(d.vertex,3);if(p.applyMatrix4(s),l.setAttribute("position",p),d.colors.length>0&&l.setAttribute("color",new It(d.colors,3)),t&&(l.setAttribute("skinIndex",new hm(d.weightsIndices,4)),l.setAttribute("skinWeight",new It(d.vertexWeights,4)),l.FBX_Deformer=t),d.normal.length>0){const g=(new Dn).getNormalMatrix(s),_=new It(d.normal,3);_.applyNormalMatrix(g),l.setAttribute("normal",_)}if(d.uvs.forEach(function(g,_){l.setAttribute(0===_?"uv":`uv${_}`,new It(d.uvs[_],2))}),u.material&&"AllSame"!==u.material.mappingType){let g=d.materialIndex[0],_=0;if(d.materialIndex.forEach(function(M,w){M!==g&&(l.addGroup(_,w-_,g),g=M,_=w)}),l.groups.length>0){const M=l.groups[l.groups.length-1],w=M.start+M.count;w!==d.materialIndex.length&&l.addGroup(w,d.materialIndex.length-w,g)}0===l.groups.length&&l.addGroup(0,d.materialIndex.length,d.materialIndex[0])}return this.addMorphTargets(l,e,n,s),l}parseGeoNode(e,t){const n={};if(n.vertexPositions=void 0!==e.Vertices?e.Vertices.a:[],n.vertexIndices=void 0!==e.PolygonVertexIndex?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(n.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(n.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(n.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){n.uv=[];let s=0;for(;e.LayerElementUV[s];)e.LayerElementUV[s].UV&&n.uv.push(this.parseUVs(e.LayerElementUV[s])),s++}return n.weightTable={},null!==t&&(n.skeleton=t,t.rawBones.forEach(function(s,l){s.indices.forEach(function(u,d){void 0===n.weightTable[u]&&(n.weightTable[u]=[]),n.weightTable[u].push({id:l,weight:s.weights[d]})})})),n}genBuffers(e){const t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let n=0,s=0,l=!1,u=[],d=[],p=[],g=[],_=[],M=[];const w=this;return e.vertexIndices.forEach(function(E,D){let F,P=!1;E<0&&(E^=-1,P=!0);let R=[],V=[];if(u.push(3*E,3*E+1,3*E+2),e.color){const k=hv(D,n,E,e.color);p.push(k[0],k[1],k[2])}if(e.skeleton){if(void 0!==e.weightTable[E]&&e.weightTable[E].forEach(function(k){V.push(k.weight),R.push(k.id)}),V.length>4){l||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),l=!0);const k=[0,0,0,0],W=[0,0,0,0];V.forEach(function(i,r){let o=i,c=R[r];W.forEach(function(h,f,x){if(o>h){x[f]=o,o=h;const b=k[f];k[f]=c,c=b}})}),R=k,V=W}for(;V.length<4;)V.push(0),R.push(0);for(let k=0;k<4;++k)_.push(V[k]),M.push(R[k])}if(e.normal){const k=hv(D,n,E,e.normal);d.push(k[0],k[1],k[2])}e.material&&"AllSame"!==e.material.mappingType&&(F=hv(D,n,E,e.material)[0],F<0&&(w.negativeMaterialIndices=!0,F=0)),e.uv&&e.uv.forEach(function(k,W){const i=hv(D,n,E,k);void 0===g[W]&&(g[W]=[]),g[W].push(i[0]),g[W].push(i[1])}),s++,P&&(s>4&&console.warn("THREE.FBXLoader: Polygons with more than four sides are not supported. Make sure to triangulate the geometry during export."),w.genFace(t,e,u,F,d,p,g,_,M,s),n++,s=0,u=[],d=[],p=[],g=[],_=[],M=[])}),t}genFace(e,t,n,s,l,u,d,p,g,_){for(let M=2;M<_;M++)e.vertex.push(t.vertexPositions[n[0]]),e.vertex.push(t.vertexPositions[n[1]]),e.vertex.push(t.vertexPositions[n[2]]),e.vertex.push(t.vertexPositions[n[3*(M-1)]]),e.vertex.push(t.vertexPositions[n[3*(M-1)+1]]),e.vertex.push(t.vertexPositions[n[3*(M-1)+2]]),e.vertex.push(t.vertexPositions[n[3*M]]),e.vertex.push(t.vertexPositions[n[3*M+1]]),e.vertex.push(t.vertexPositions[n[3*M+2]]),t.skeleton&&(e.vertexWeights.push(p[0]),e.vertexWeights.push(p[1]),e.vertexWeights.push(p[2]),e.vertexWeights.push(p[3]),e.vertexWeights.push(p[4*(M-1)]),e.vertexWeights.push(p[4*(M-1)+1]),e.vertexWeights.push(p[4*(M-1)+2]),e.vertexWeights.push(p[4*(M-1)+3]),e.vertexWeights.push(p[4*M]),e.vertexWeights.push(p[4*M+1]),e.vertexWeights.push(p[4*M+2]),e.vertexWeights.push(p[4*M+3]),e.weightsIndices.push(g[0]),e.weightsIndices.push(g[1]),e.weightsIndices.push(g[2]),e.weightsIndices.push(g[3]),e.weightsIndices.push(g[4*(M-1)]),e.weightsIndices.push(g[4*(M-1)+1]),e.weightsIndices.push(g[4*(M-1)+2]),e.weightsIndices.push(g[4*(M-1)+3]),e.weightsIndices.push(g[4*M]),e.weightsIndices.push(g[4*M+1]),e.weightsIndices.push(g[4*M+2]),e.weightsIndices.push(g[4*M+3])),t.color&&(e.colors.push(u[0]),e.colors.push(u[1]),e.colors.push(u[2]),e.colors.push(u[3*(M-1)]),e.colors.push(u[3*(M-1)+1]),e.colors.push(u[3*(M-1)+2]),e.colors.push(u[3*M]),e.colors.push(u[3*M+1]),e.colors.push(u[3*M+2])),t.material&&"AllSame"!==t.material.mappingType&&(e.materialIndex.push(s),e.materialIndex.push(s),e.materialIndex.push(s)),t.normal&&(e.normal.push(l[0]),e.normal.push(l[1]),e.normal.push(l[2]),e.normal.push(l[3*(M-1)]),e.normal.push(l[3*(M-1)+1]),e.normal.push(l[3*(M-1)+2]),e.normal.push(l[3*M]),e.normal.push(l[3*M+1]),e.normal.push(l[3*M+2])),t.uv&&t.uv.forEach(function(w,E){void 0===e.uvs[E]&&(e.uvs[E]=[]),e.uvs[E].push(d[E][0]),e.uvs[E].push(d[E][1]),e.uvs[E].push(d[E][2*(M-1)]),e.uvs[E].push(d[E][2*(M-1)+1]),e.uvs[E].push(d[E][2*M]),e.uvs[E].push(d[E][2*M+1])})}addMorphTargets(e,t,n,s){if(0===n.length)return;e.morphTargetsRelative=!0,e.morphAttributes.position=[];const l=this;n.forEach(function(u){u.rawTargets.forEach(function(d){const p=Un.Objects.Geometry[d.geoID];void 0!==p&&l.genMorphGeometry(e,t,p,s,d.name)})})}genMorphGeometry(e,t,n,s,l){const u=void 0!==t.PolygonVertexIndex?t.PolygonVertexIndex.a:[],d=void 0!==n.Vertices?n.Vertices.a:[],p=void 0!==n.Indexes?n.Indexes.a:[],_=new Float32Array(3*e.attributes.position.count);for(let D=0;D<p.length;D++){const F=3*p[D];_[F]=d[3*D],_[F+1]=d[3*D+1],_[F+2]=d[3*D+2]}const w=this.genBuffers({vertexIndices:u,vertexPositions:_}),E=new It(w.vertex,3);E.name=l||n.attrName,E.applyMatrix4(s),e.morphAttributes.position.push(E)}parseNormals(e){const n=e.ReferenceInformationType;let l=[];return"IndexToDirect"===n&&("NormalIndex"in e?l=e.NormalIndex.a:"NormalsIndex"in e&&(l=e.NormalsIndex.a)),{dataSize:3,buffer:e.Normals.a,indices:l,mappingType:e.MappingInformationType,referenceType:n}}parseUVs(e){const n=e.ReferenceInformationType;let l=[];return"IndexToDirect"===n&&(l=e.UVIndex.a),{dataSize:2,buffer:e.UV.a,indices:l,mappingType:e.MappingInformationType,referenceType:n}}parseVertexColors(e){const t=e.MappingInformationType,n=e.ReferenceInformationType,s=e.Colors.a;let l=[];"IndexToDirect"===n&&(l=e.ColorIndex.a);for(let u=0,d=new pt;u<s.length;u+=4)d.fromArray(s,u).convertSRGBToLinear().toArray(s,u);return{dataSize:4,buffer:s,indices:l,mappingType:t,referenceType:n}}parseMaterialIndices(e){const t=e.MappingInformationType,n=e.ReferenceInformationType;if("NoMappingInformation"===t)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:n};const s=e.Materials.a,l=[];for(let u=0;u<s.length;++u)l.push(u);return{dataSize:1,buffer:s,indices:l,mappingType:t,referenceType:n}}parseNurbsGeometry(e){const t=parseInt(e.Order);if(isNaN(t))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new Sn;const n=t-1,s=e.KnotVector.a,l=[],u=e.Points.a;for(let M=0,w=u.length;M<w;M+=4)l.push((new ii).fromArray(u,M));let d,p;if("Closed"===e.Form)l.push(l[0]);else if("Periodic"===e.Form){d=n,p=s.length-1-d;for(let M=0;M<n;++M)l.push(l[M])}const _=new ab(n,s,l,d,p).getPoints(12*l.length);return(new Sn).setFromPoints(_)}}class b_{parse(){const e=[],t=this.parseClips();if(void 0!==t)for(const n in t){const l=this.addClip(t[n]);e.push(l)}return e}parseClips(){if(void 0===Un.Objects.AnimationCurve)return;const e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);const t=this.parseAnimationLayers(e);return this.parseAnimStacks(t)}parseAnimationCurveNodes(){const e=Un.Objects.AnimationCurveNode,t=new Map;for(const n in e){const s=e[n];if(null!==s.attrName.match(/S|R|T|DeformPercent/)){const l={id:s.id,attr:s.attrName,curves:{}};t.set(l.id,l)}}return t}parseAnimationCurves(e){const t=Un.Objects.AnimationCurve;for(const n in t){const s={id:t[n].id,times:t[n].KeyTime.a.map(hb),values:t[n].KeyValueFloat.a},l=yr.get(s.id);if(void 0!==l){const u=l.parents[0].ID,d=l.parents[0].relationship;d.match(/X/)?e.get(u).curves.x=s:d.match(/Y/)?e.get(u).curves.y=s:d.match(/Z/)?e.get(u).curves.z=s:d.match(/DeformPercent/)&&e.has(u)&&(e.get(u).curves.morph=s)}}}parseAnimationLayers(e){const t=Un.Objects.AnimationLayer,n=new Map;for(const s in t){const l=[],u=yr.get(parseInt(s));void 0!==u&&(u.children.forEach(function(p,g){if(e.has(p.ID)){const _=e.get(p.ID);if(void 0!==_.curves.x||void 0!==_.curves.y||void 0!==_.curves.z){if(void 0===l[g]){const M=yr.get(p.ID).parents.filter(function(w){return void 0!==w.relationship})[0].ID;if(void 0!==M){const w=Un.Objects.Model[M.toString()];if(void 0===w)return void console.warn("THREE.FBXLoader: Encountered a unused curve.",p);const E={modelName:w.attrName?Qn.sanitizeNodeName(w.attrName):"",ID:w.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};ds.traverse(function(D){D.ID===w.id&&(E.transform=D.matrix,D.userData.transformData&&(E.eulerOrder=D.userData.transformData.eulerOrder))}),E.transform||(E.transform=new Bt),"PreRotation"in w&&(E.preRotation=w.PreRotation.value),"PostRotation"in w&&(E.postRotation=w.PostRotation.value),l[g]=E}}l[g]&&(l[g][_.attr]=_)}else if(void 0!==_.curves.morph){if(void 0===l[g]){const M=yr.get(p.ID).parents.filter(function(R){return void 0!==R.relationship})[0].ID,w=yr.get(M).parents[0].ID,E=yr.get(w).parents[0].ID,D=yr.get(E).parents[0].ID,F=Un.Objects.Model[D],P={modelName:F.attrName?Qn.sanitizeNodeName(F.attrName):"",morphName:Un.Objects.Deformer[M].attrName};l[g]=P}l[g][_.attr]=_}}}),n.set(parseInt(s),l))}return n}parseAnimStacks(e){const t=Un.Objects.AnimationStack,n={};for(const s in t){const l=yr.get(parseInt(s)).children;l.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const u=e.get(l[0].ID);n[s]={name:t[s].attrName,layer:u}}return n}addClip(e){let t=[];const n=this;return e.layer.forEach(function(s){t=t.concat(n.generateTracks(s))}),new xd(e.name,-1,t)}generateTracks(e){const t=[];let n=new K,s=new gr,l=new K;if(e.transform&&e.transform.decompose(n,s,l),n=n.toArray(),s=(new il).setFromQuaternion(s,e.eulerOrder).toArray(),l=l.toArray(),void 0!==e.T&&Object.keys(e.T.curves).length>0){const u=this.generateVectorTrack(e.modelName,e.T.curves,n,"position");void 0!==u&&t.push(u)}if(void 0!==e.R&&Object.keys(e.R.curves).length>0){const u=this.generateRotationTrack(e.modelName,e.R.curves,s,e.preRotation,e.postRotation,e.eulerOrder);void 0!==u&&t.push(u)}if(void 0!==e.S&&Object.keys(e.S.curves).length>0){const u=this.generateVectorTrack(e.modelName,e.S.curves,l,"scale");void 0!==u&&t.push(u)}if(void 0!==e.DeformPercent){const u=this.generateMorphTrack(e);void 0!==u&&t.push(u)}return t}generateVectorTrack(e,t,n,s){const l=this.getTimesForAllAxes(t),u=this.getKeyframeTrackValues(l,t,n);return new _d(e+"."+s,l,u)}generateRotationTrack(e,t,n,s,l,u){void 0!==t.x&&(this.interpolateRotations(t.x),t.x.values=t.x.values.map(xo_degToRad)),void 0!==t.y&&(this.interpolateRotations(t.y),t.y.values=t.y.values.map(xo_degToRad)),void 0!==t.z&&(this.interpolateRotations(t.z),t.z.values=t.z.values.map(xo_degToRad));const d=this.getTimesForAllAxes(t),p=this.getKeyframeTrackValues(d,t,n);void 0!==s&&((s=s.map(xo_degToRad)).push(u),s=(new il).fromArray(s),s=(new gr).setFromEuler(s)),void 0!==l&&((l=l.map(xo_degToRad)).push(u),l=(new il).fromArray(l),l=(new gr).setFromEuler(l).invert());const g=new gr,_=new il,M=[];for(let w=0;w<p.length;w+=3)_.set(p[w],p[w+1],p[w+2],u),g.setFromEuler(_),void 0!==s&&g.premultiply(s),void 0!==l&&g.multiply(l),g.toArray(M,w/3*4);return new Pa(e+".quaternion",d,M)}generateMorphTrack(e){const t=e.DeformPercent.curves.morph,n=t.values.map(function(l){return l/100}),s=ds.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new ih(e.modelName+".morphTargetInfluences["+s+"]",t.times,n)}getTimesForAllAxes(e){let t=[];if(void 0!==e.x&&(t=t.concat(e.x.times)),void 0!==e.y&&(t=t.concat(e.y.times)),void 0!==e.z&&(t=t.concat(e.z.times)),t=t.sort(function(n,s){return n-s}),t.length>1){let n=1,s=t[0];for(let l=1;l<t.length;l++){const u=t[l];u!==s&&(t[n]=u,s=u,n++)}t=t.slice(0,n)}return t}getKeyframeTrackValues(e,t,n){const s=n,l=[];let u=-1,d=-1,p=-1;return e.forEach(function(g){if(t.x&&(u=t.x.times.indexOf(g)),t.y&&(d=t.y.times.indexOf(g)),t.z&&(p=t.z.times.indexOf(g)),-1!==u){const _=t.x.values[u];l.push(_),s[0]=_}else l.push(s[0]);if(-1!==d){const _=t.y.values[d];l.push(_),s[1]=_}else l.push(s[1]);if(-1!==p){const _=t.z.values[p];l.push(_),s[2]=_}else l.push(s[2])}),l}interpolateRotations(e){for(let t=1;t<e.values.length;t++){const n=e.values[t-1],s=e.values[t]-n,l=Math.abs(s);if(l>=180){const u=l/180,d=s/u;let p=n+d;const g=e.times[t-1],M=(e.times[t]-g)/u;let w=g+M;const E=[],D=[];for(;w<e.times[t];)E.push(w),w+=M,D.push(p),p+=d;e.times=fb(e.times,t,E),e.values=fb(e.values,t,D)}}}}class lv{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(e){this.nodeStack.push(e),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(e,t){this.currentProp=e,this.currentPropName=t}parse(e){this.currentIndent=0,this.allNodes=new E_,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const t=this,n=e.split(/[\r\n]+/);return n.forEach(function(s,l){const u=s.match(/^[\s\t]*;/),d=s.match(/^[\s\t]*$/);if(u||d)return;const p=s.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),g=s.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),_=s.match("^\\t{"+(t.currentIndent-1)+"}}");p?t.parseNodeBegin(s,p):g?t.parseNodeProperty(s,g,n[++l]):_?t.popStack():s.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(s)}),this.allNodes}parseNodeBegin(e,t){const n=t[1].trim().replace(/^"/,"").replace(/"$/,""),s=t[2].split(",").map(function(p){return p.trim().replace(/^"/,"").replace(/"$/,"")}),l={name:n},u=this.parseNodeAttr(s),d=this.getCurrentNode();0===this.currentIndent?this.allNodes.add(n,l):n in d?("PoseNode"===n?d.PoseNode.push(l):void 0!==d[n].id&&(d[n]={},d[n][d[n].id]=d[n]),""!==u.id&&(d[n][u.id]=l)):"number"==typeof u.id?(d[n]={},d[n][u.id]=l):"Properties70"!==n&&(d[n]="PoseNode"===n?[l]:l),"number"==typeof u.id&&(l.id=u.id),""!==u.name&&(l.attrName=u.name),""!==u.type&&(l.attrType=u.type),this.pushStack(l)}parseNodeAttr(e){let t=e[0];""!==e[0]&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));let n="",s="";return e.length>1&&(n=e[1].replace(/^(\w+)::/,""),s=e[2]),{id:t,name:n,type:s}}parseNodeProperty(e,t,n){let s=t[1].replace(/^"/,"").replace(/"$/,"").trim(),l=t[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===s&&","===l&&(l=n.replace(/"/g,"").replace(/,$/,"").trim());const u=this.getCurrentNode();if("Properties70"!==u.name){if("C"===s){const p=l.split(",").slice(1),g=parseInt(p[0]),_=parseInt(p[1]);let M=l.split(",").slice(3);M=M.map(function(w){return w.trim().replace(/^"/,"")}),s="connections",l=[g,_],function rS(a,e){for(let t=0,n=a.length,s=e.length;t<s;t++,n++)a[n]=e[t]}(l,M),void 0===u[s]&&(u[s]=[])}"Node"===s&&(u.id=l),s in u&&Array.isArray(u[s])?u[s].push(l):"a"!==s?u[s]=l:u.a=l,this.setCurrentProp(u,s),"a"===s&&","!==l.slice(-1)&&(u.a=D_(l))}else this.parseNodeSpecialProperty(e,s,l)}parseNodePropertyContinued(e){const t=this.getCurrentNode();t.a+=e,","!==e.slice(-1)&&(t.a=D_(t.a))}parseNodeSpecialProperty(e,t,n){const s=n.split('",').map(function(_){return _.trim().replace(/^\"/,"").replace(/\s/,"_")}),l=s[0],u=s[1],d=s[2],p=s[3];let g=s[4];switch(u){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":g=parseFloat(g);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":g=D_(g)}this.getPrevNode()[l]={type:u,type2:d,flag:p,value:g},this.setCurrentProp(this.getPrevNode(),l)}}class cv{parse(e){const t=new uv(e);t.skip(23);const n=t.getUint32();if(n<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+n);const s=new E_;for(;!this.endOfContent(t);){const l=this.parseNode(t,n);null!==l&&s.add(l.name,l)}return s}endOfContent(e){return e.size()%16==0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()}parseNode(e,t){const n={},s=t>=7500?e.getUint64():e.getUint32(),l=t>=7500?e.getUint64():e.getUint32();t>=7500?e.getUint64():e.getUint32();const u=e.getUint8(),d=e.getString(u);if(0===s)return null;const p=[];for(let w=0;w<l;w++)p.push(this.parseProperty(e));const g=p.length>0?p[0]:"",_=p.length>1?p[1]:"",M=p.length>2?p[2]:"";for(n.singleProperty=1===l&&e.getOffset()===s;s>e.getOffset();){const w=this.parseNode(e,t);null!==w&&this.parseSubNode(d,n,w)}return n.propertyList=p,"number"==typeof g&&(n.id=g),""!==_&&(n.attrName=_),""!==M&&(n.attrType=M),""!==d&&(n.name=d),n}parseSubNode(e,t,n){if(!0===n.singleProperty){const s=n.propertyList[0];Array.isArray(s)?(t[n.name]=n,n.a=s):t[n.name]=s}else if("Connections"===e&&"C"===n.name){const s=[];n.propertyList.forEach(function(l,u){0!==u&&s.push(l)}),void 0===t.connections&&(t.connections=[]),t.connections.push(s)}else if("Properties70"===n.name)Object.keys(n).forEach(function(l){t[l]=n[l]});else if("Properties70"===e&&"P"===n.name){let s=n.propertyList[0],l=n.propertyList[1];const u=n.propertyList[2],d=n.propertyList[3];let p;0===s.indexOf("Lcl ")&&(s=s.replace("Lcl ","Lcl_")),0===l.indexOf("Lcl ")&&(l=l.replace("Lcl ","Lcl_")),p="Color"===l||"ColorRGB"===l||"Vector"===l||"Vector3D"===l||0===l.indexOf("Lcl_")?[n.propertyList[4],n.propertyList[5],n.propertyList[6]]:n.propertyList[4],t[s]={type:l,type2:u,flag:d,value:p}}else void 0===t[n.name]?"number"==typeof n.id?(t[n.name]={},t[n.name][n.id]=n):t[n.name]=n:"PoseNode"===n.name?(Array.isArray(t[n.name])||(t[n.name]=[t[n.name]]),t[n.name].push(n)):void 0===t[n.name][n.id]&&(t[n.name][n.id]=n)}parseProperty(e){const t=e.getString(1);let n;switch(t){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":return n=e.getUint32(),e.getArrayBuffer(n);case"S":return n=e.getUint32(),e.getString(n);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const s=e.getUint32(),l=e.getUint32(),u=e.getUint32();if(0===l)switch(t){case"b":case"c":return e.getBooleanArray(s);case"d":return e.getFloat64Array(s);case"f":return e.getFloat32Array(s);case"i":return e.getInt32Array(s);case"l":return e.getInt64Array(s)}const d=function ph(a,e){return Id((function(a){if(8!=(15&a[0])||a[0]>>>4>7||(a[0]<<8|a[1])%31)throw"invalid zlib data";if(32&a[1])throw"invalid zlib data: preset dictionaries not supported"}(a),a.subarray(2,-4)),e)}(new Uint8Array(e.getArrayBuffer(u))),p=new uv(d.buffer);switch(t){case"b":case"c":return p.getBooleanArray(s);case"d":return p.getFloat64Array(s);case"f":return p.getFloat32Array(s);case"i":return p.getInt32Array(s);case"l":return p.getInt64Array(s)}break;default:throw new Error("THREE.FBXLoader: Unknown property type "+t)}}}class uv{constructor(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=void 0===t||t,this._textDecoder=new TextDecoder}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(e){this.offset+=e}getBoolean(){return 1==(1&this.getUint8())}getBooleanArray(e){const t=[];for(let n=0;n<e;n++)t.push(this.getBoolean());return t}getUint8(){const e=this.dv.getUint8(this.offset);return this.offset+=1,e}getInt16(){const e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}getInt32(){const e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}getInt32Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getInt32());return t}getUint32(){const e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}getInt64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),2147483648&t?(t=4294967295&~t,e=4294967295&~e,4294967295===e&&(t=t+1&4294967295),e=e+1&4294967295,-(4294967296*t+e)):4294967296*t+e}getInt64Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getInt64());return t}getUint64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),4294967296*t+e}getFloat32(){const e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}getFloat32Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getFloat32());return t}getFloat64(){const e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}getFloat64Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getFloat64());return t}getArrayBuffer(e){const t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}getString(e){const t=this.offset;let n=new Uint8Array(this.dv.buffer,t,e);this.skip(e);const s=n.indexOf(0);return s>=0&&(n=new Uint8Array(this.dv.buffer,t,s)),this._textDecoder.decode(n)}}class E_{add(e,t){this[e]=t}}function ub(a){const t=a.match(/FBXVersion: (\d+)/);if(t)return parseInt(t[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function hb(a){return a/46186158e3}const iS=[];function hv(a,e,t,n){let s;switch(n.mappingType){case"ByPolygonVertex":s=a;break;case"ByPolygon":s=e;break;case"ByVertice":s=t;break;case"AllSame":s=n.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+n.mappingType)}"IndexToDirect"===n.referenceType&&(s=n.indices[s]);const l=s*n.dataSize;return function sS(a,e,t,n){for(let s=t,l=0;s<n;s++,l++)a[l]=e[s];return a}(iS,n.buffer,l,l+n.dataSize)}const zp=new il,mh=new K;function T_(a){const e=new Bt,t=new Bt,n=new Bt,s=new Bt,l=new Bt,u=new Bt,d=new Bt,p=new Bt,g=new Bt,_=new Bt,M=new Bt,w=new Bt,E=a.inheritType?a.inheritType:0;if(a.translation&&e.setPosition(mh.fromArray(a.translation)),a.preRotation){const f=a.preRotation.map(xo_degToRad);f.push(a.eulerOrder||il.DEFAULT_ORDER),t.makeRotationFromEuler(zp.fromArray(f))}if(a.rotation){const f=a.rotation.map(xo_degToRad);f.push(a.eulerOrder||il.DEFAULT_ORDER),n.makeRotationFromEuler(zp.fromArray(f))}if(a.postRotation){const f=a.postRotation.map(xo_degToRad);f.push(a.eulerOrder||il.DEFAULT_ORDER),s.makeRotationFromEuler(zp.fromArray(f)),s.invert()}a.scale&&l.scale(mh.fromArray(a.scale)),a.scalingOffset&&d.setPosition(mh.fromArray(a.scalingOffset)),a.scalingPivot&&u.setPosition(mh.fromArray(a.scalingPivot)),a.rotationOffset&&p.setPosition(mh.fromArray(a.rotationOffset)),a.rotationPivot&&g.setPosition(mh.fromArray(a.rotationPivot)),a.parentMatrixWorld&&(M.copy(a.parentMatrix),_.copy(a.parentMatrixWorld));const D=t.clone().multiply(n).multiply(s),F=new Bt;F.extractRotation(_);const P=new Bt;P.copyPosition(_);const R=P.clone().invert().multiply(_),V=F.clone().invert().multiply(R),k=l,W=new Bt;if(0===E)W.copy(F).multiply(D).multiply(V).multiply(k);else if(1===E)W.copy(F).multiply(V).multiply(D).multiply(k);else{const x=(new Bt).scale((new K).setFromMatrixScale(M)).clone().invert(),b=V.clone().multiply(x);W.copy(F).multiply(D).multiply(b).multiply(k)}const i=g.clone().invert(),r=u.clone().invert();let o=e.clone().multiply(p).multiply(g).multiply(t).multiply(n).multiply(s).multiply(i).multiply(d).multiply(u).multiply(l).multiply(r);const c=(new Bt).copyPosition(o),h=_.clone().multiply(c);return w.copyPosition(h),o=w.clone().multiply(W),o.premultiply(_.invert()),o}function A_(a){const e=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return 6===(a=a||0)?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),e[0]):e[a]}function D_(a){return a.split(",").map(function(t){return parseFloat(t)})}function db(a,e,t){return void 0===e&&(e=0),void 0===t&&(t=a.byteLength),(new TextDecoder).decode(new Uint8Array(a,e,t))}function fb(a,e,t){return a.slice(0,e).concat(t).concat(a.slice(e))}const R_="CITY_UNTRIANGULATED";let Hp=(()=>{class a{constructor(t){this.threeService=t,this.vertexShader="\n                          //vertexShader\n                          precision lowp float;\n                          varying vec2 vUv;\n                          varying vec3 vPosition;\n                          uniform float uTime;\n                          varying vec3 vNormal;\n                          void main() {\n                            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n                            vUv = uv;\n                            vPosition = position;\n                            vNormal = normalize(normalMatrix * normal);\n                        }",this.fragmentShader="\n                        //fragmentShader\n                        #define PI 3.1415926535897932384626433832795\n                        precision lowp float;\n                        uniform vec3 scanColor;\n                        varying vec2 vUv;\n                        uniform float uTime;\n                        uniform vec3 uSize;\n                        varying vec3 vPosition;\n                        varying vec3 vNormal;\n                        void main() {\n                          float dTime = mod(uTime * 25.0, uSize.z); \n                          vec3 distColor = vec3(0.5, 0.5, 0.5);\n                            float topY = vPosition.z + 10.0;\n                            if (dTime > vPosition.z && dTime < topY) {\n                                \n                                float dIndex = sin((topY - dTime) / 10.0 * PI);\n\n                                distColor = mix(distColor, scanColor,  dIndex); \n                            }\n                          \n                          gl_FragColor = vec4(vec3(distColor), 1.0);\n                          \n                        }\n                      "}ngOnInit(){const{scene:t,camera:n,renderer:s,orbit_controls:l,clock:u}=this.threeService.init();this.scene=t,this.camera=n,this.renderer=s,this.orbit_controls=l,this.clock=u,this.updaetScene(),this.renderer.render(this.scene,this.camera),this.orbit_controls.update()}updaetScene(){var t;const n=new Xg(2e3);this.scene.add(n);const s=new ll(5,5),l=new Ai({color:16777215,side:2}),u=new Yi(s,l);u.rotation.x=-.5*Math.PI,u.position.set(0,0,0),u.receiveShadow=!0;const d=new pp(16777215);new J0(d,.2),d.position.set(1e3,1e3,1e3),d.target=u,d.castShadow=!0,this.renderer.shadowMap.enabled=!0,this.scene.add(d);const g=new w_;this.camera.far=1e4,this.camera.position.set(800,400,800),this.camera.updateProjectionMatrix(),g.load("assets/model/shanghai.FBX",_=>{this.scene.add(_),_.traverse(M=>{M.name===R_&&(this.setMaterial(M),this.aroundLine(M))})}),null===(t=document.getElementById("shanghai-container"))||void 0===t||t.appendChild(this.renderer.domElement),this.renderer.setAnimationLoop(this.animation.bind(this))}setMaterial(t){t.geometry.computeBoundingBox(),t.geometry.computeBoundingSphere();const{geometry:n}=t,{max:u,min:d}=n.boundingBox,p=new K(u.x-d.x,u.y-d.y,u.z-d.z);t.material=new eo({uniforms:{uOpacity:{value:1},uTime:{value:.1},uSize:{value:p},scanColor:{value:new pt(65280)}},vertexShader:this.vertexShader,fragmentShader:this.fragmentShader})}aroundLine(t){const n=new r0(t.geometry),s=new K;t.getWorldPosition(s);const{max:l,min:u}=t.geometry.boundingBox,d=new K(l.x-u.x,l.y-u.y,l.z-u.z),p=this.lineMaterial({max:l,min:u,size:d}),g=new Hf(n,p);g.name="aroundLine",g.scale.copy(t.scale),g.rotation.copy(t.rotation),g.position.copy(s),this.scene.add(g)}lineMaterial({max:t,min:n}){return this.lineShaderMaterial||(this.lineShaderMaterial=new eo({transparent:!0,uniforms:{uColor:{value:new pt("#ffffff")},uActive:{value:new pt("#000000")},uTime:{value:.1},uOpacity:{value:.6},uMax:{value:t},uMin:{value:n},uRange:{value:200},uSpeed:{value:.2},uStartTime:{value:.1}},vertexShader:"\n                    #define PI 3.14159265359\n\n                    uniform mediump float uStartTime;\n                    uniform mediump float uTime;\n                    uniform mediump float uRange;\n                    uniform mediump float uSpeed;\n                \n                    uniform vec3 uColor;\n                    uniform vec3 uActive;\n                    uniform vec3 uMin;\n                    uniform vec3 uMax;\n                \n                    varying vec3 vColor;\n                \n                    float lerp(float x, float y, float t) {\n                        return (1.0 - t) * x + t * y;\n                    }\n                    void main() { \n                        if (uStartTime >= 0.99) {\n                            float iTime = mod(uTime * uSpeed - uStartTime, 1.0);\n                            float rangeY = lerp(uMin.y, uMax.y, iTime);\n                            if (rangeY < position.y && rangeY > position.y - uRange) {\n                                float index = 1.0 - sin((position.y - rangeY) / uRange * PI);\n                                float r = lerp(uActive.r, uColor.r, index);\n                                float g = lerp(uActive.g, uColor.g, index);\n                                float b = lerp(uActive.b, uColor.b, index);\n                \n                                vColor = vec3(r, g, b);\n                                // vColor = vec3(0.0, 0.0, 0.0);\n                            } else {\n                                vColor = uColor;\n                            }\n                        }\n                        vec3 vPosition = vec3(position.x, position.y, position.z * uStartTime);\n                        gl_Position = projectionMatrix * modelViewMatrix * vec4(vPosition, 1.0);\n                    } \n      ",fragmentShader:"\n                    precision mediump float;\n\n                    float distanceTo(vec2 src, vec2 dst) {\n                        float dx = src.x - dst.x;\n                        float dy = src.y - dst.y;\n                        float dv = dx * dx + dy * dy;\n                        return sqrt(dv);\n                    } \n                    \n                    float lerp(float x, float y, float t) {\n                        return (1.0 - t) * x + t * y;\n                    }\n                    \n                    #define PI 3.14159265359\n                    #define PI2 6.28318530718\n                    uniform float uTime;\n                    uniform float uOpacity;\n                    uniform float uStartTime;\n\n                    varying vec3 vColor; \n\n                    void main() {\n\n                        gl_FragColor = vec4(vColor, uOpacity * uStartTime);\n                    }\n      "})),this.lineShaderMaterial}animation(){this.scene.traverse(function(t){t.name===R_&&(t.material.uniforms.uTime.value+=.02),"aroundLine"===t.name&&t.material.uniforms.uStartTime.value<1&&(t.material.uniforms.uStartTime.value+=.02)}),this.renderer.render(this.scene,this.camera)}}return a.\u0275fac=function(t){return new(t||a)(I.Y36(no))},a.\u0275cmp=I.Xpm({type:a,selectors:[["app-shanghai"]],decls:2,vars:0,consts:[[1,"flex-box"],["id","shanghai-container"]],template:function(t,n){1&t&&(I.TgZ(0,"div",0),I._UZ(1,"div",1),I.qZA())},styles:[""]}),a})();var Vd,gh={Linear:{None:function(a){return a}},Quadratic:{In:function(a){return a*a},Out:function(a){return a*(2-a)},InOut:function(a){return(a*=2)<1?.5*a*a:-.5*(--a*(a-2)-1)}},Cubic:{In:function(a){return a*a*a},Out:function(a){return--a*a*a+1},InOut:function(a){return(a*=2)<1?.5*a*a*a:.5*((a-=2)*a*a+2)}},Quartic:{In:function(a){return a*a*a*a},Out:function(a){return 1- --a*a*a*a},InOut:function(a){return(a*=2)<1?.5*a*a*a*a:-.5*((a-=2)*a*a*a-2)}},Quintic:{In:function(a){return a*a*a*a*a},Out:function(a){return--a*a*a*a*a+1},InOut:function(a){return(a*=2)<1?.5*a*a*a*a*a:.5*((a-=2)*a*a*a*a+2)}},Sinusoidal:{In:function(a){return 1-Math.cos(a*Math.PI/2)},Out:function(a){return Math.sin(a*Math.PI/2)},InOut:function(a){return.5*(1-Math.cos(Math.PI*a))}},Exponential:{In:function(a){return 0===a?0:Math.pow(1024,a-1)},Out:function(a){return 1===a?1:1-Math.pow(2,-10*a)},InOut:function(a){return 0===a?0:1===a?1:(a*=2)<1?.5*Math.pow(1024,a-1):.5*(2-Math.pow(2,-10*(a-1)))}},Circular:{In:function(a){return 1-Math.sqrt(1-a*a)},Out:function(a){return Math.sqrt(1- --a*a)},InOut:function(a){return(a*=2)<1?-.5*(Math.sqrt(1-a*a)-1):.5*(Math.sqrt(1-(a-=2)*a)+1)}},Elastic:{In:function(a){return 0===a?0:1===a?1:-Math.pow(2,10*(a-1))*Math.sin(5*(a-1.1)*Math.PI)},Out:function(a){return 0===a?0:1===a?1:Math.pow(2,-10*a)*Math.sin(5*(a-.1)*Math.PI)+1},InOut:function(a){return 0===a?0:1===a?1:(a*=2)<1?-.5*Math.pow(2,10*(a-1))*Math.sin(5*(a-1.1)*Math.PI):.5*Math.pow(2,-10*(a-1))*Math.sin(5*(a-1.1)*Math.PI)+1}},Back:{In:function(a){var e=1.70158;return a*a*((e+1)*a-e)},Out:function(a){var e=1.70158;return--a*a*((e+1)*a+e)+1},InOut:function(a){var e=2.5949095;return(a*=2)<1?a*a*((e+1)*a-e)*.5:.5*((a-=2)*a*((e+1)*a+e)+2)}},Bounce:{In:function(a){return 1-gh.Bounce.Out(1-a)},Out:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375},InOut:function(a){return a<.5?.5*gh.Bounce.In(2*a):.5*gh.Bounce.Out(2*a-1)+.5}}};Vd="undefined"==typeof self&&"undefined"!=typeof process&&process.hrtime?function(){var a=process.hrtime();return 1e3*a[0]+a[1]/1e6}:"undefined"!=typeof self&&void 0!==self.performance&&void 0!==self.performance.now?self.performance.now.bind(self.performance):void 0!==Date.now?Date.now:function(){return(new Date).getTime()};var a,Ql=Vd,ec=function(){function a(){this._tweens={},this._tweensAddedDuringUpdate={}}return a.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(t){return e._tweens[t]})},a.prototype.removeAll=function(){this._tweens={}},a.prototype.add=function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},a.prototype.remove=function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},a.prototype.update=function(e,t){void 0===e&&(e=Ql()),void 0===t&&(t=!1);var n=Object.keys(this._tweens);if(0===n.length)return!1;for(;n.length>0;){this._tweensAddedDuringUpdate={};for(var s=0;s<n.length;s++){var l=this._tweens[n[s]];l&&!1===l.update(e,!t)&&!t&&delete this._tweens[n[s]]}n=Object.keys(this._tweensAddedDuringUpdate)}return!0},a}(),au={Linear:function(a,e){var t=a.length-1,n=t*e,s=Math.floor(n),l=au.Utils.Linear;return e<0?l(a[0],a[1],n):e>1?l(a[t],a[t-1],t-n):l(a[s],a[s+1>t?t:s+1],n-s)},Bezier:function(a,e){for(var t=0,n=a.length-1,s=Math.pow,l=au.Utils.Bernstein,u=0;u<=n;u++)t+=s(1-e,n-u)*s(e,u)*a[u]*l(n,u);return t},CatmullRom:function(a,e){var t=a.length-1,n=t*e,s=Math.floor(n),l=au.Utils.CatmullRom;return a[0]===a[t]?(e<0&&(s=Math.floor(n=t*(1+e))),l(a[(s-1+t)%t],a[s],a[(s+1)%t],a[(s+2)%t],n-s)):e<0?a[0]-(l(a[0],a[0],a[1],a[1],-n)-a[0]):e>1?a[t]-(l(a[t],a[t],a[t-1],a[t-1],n-t)-a[t]):l(a[s?s-1:0],a[s],a[t<s+1?t:s+1],a[t<s+2?t:s+2],n-s)},Utils:{Linear:function(a,e,t){return(e-a)*t+a},Bernstein:function(a,e){var t=au.Utils.Factorial;return t(a)/t(e)/t(a-e)},Factorial:(a=[1],function(e){var t=1;if(a[e])return a[e];for(var n=e;n>1;n--)t*=n;return a[e]=t,t}),CatmullRom:function(a,e,t,n,s){var l=.5*(t-a),u=.5*(n-e),d=s*s;return(2*e-2*t+l+u)*(s*d)+(-3*e+3*t-2*l-u)*d+l*s+e}}},zd=function(){function a(){}return a.nextId=function(){return a._nextId++},a._nextId=0,a}(),Gp=new ec,I_=function(){function a(e,t){void 0===t&&(t=Gp),this._object=e,this._group=t,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=gh.Linear.None,this._interpolationFunction=au.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._id=zd.nextId(),this._isChainStopped=!1,this._goToEnd=!1}return a.prototype.getId=function(){return this._id},a.prototype.isPlaying=function(){return this._isPlaying},a.prototype.isPaused=function(){return this._isPaused},a.prototype.to=function(e,t){return this._valuesEnd=Object.create(e),void 0!==t&&(this._duration=t),this},a.prototype.duration=function(e){return this._duration=e,this},a.prototype.start=function(e){if(this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var t in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(t),this._valuesStart[t]=this._valuesStartRepeat[t];return this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=void 0!==e?"string"==typeof e?Ql()+parseFloat(e):e:Ql(),this._startTime+=this._delayTime,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat),this},a.prototype._setupProperties=function(e,t,n,s){for(var l in n){var u=e[l],d=Array.isArray(u),p=d?"array":typeof u,g=!d&&Array.isArray(n[l]);if("undefined"!==p&&"function"!==p){if(g){var _=n[l];if(0===_.length)continue;_=_.map(this._handleRelativeValue.bind(this,u)),n[l]=[u].concat(_)}if("object"!==p&&!d||!u||g)void 0===t[l]&&(t[l]=u),d||(t[l]*=1),s[l]=g?n[l].slice().reverse():t[l]||0;else{for(var M in t[l]=d?[]:{},u)t[l][M]=u[M];s[l]=d?[]:{},this._setupProperties(u,t[l],n[l],s[l])}}}},a.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},a.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},a.prototype.pause=function(e){return void 0===e&&(e=Ql()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=e,this._group&&this._group.remove(this)),this},a.prototype.resume=function(e){return void 0===e&&(e=Ql()),this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this):this},a.prototype.stopChainedTweens=function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this},a.prototype.group=function(e){return this._group=e,this},a.prototype.delay=function(e){return this._delayTime=e,this},a.prototype.repeat=function(e){return this._initialRepeat=e,this._repeat=e,this},a.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},a.prototype.yoyo=function(e){return this._yoyo=e,this},a.prototype.easing=function(e){return this._easingFunction=e,this},a.prototype.interpolation=function(e){return this._interpolationFunction=e,this},a.prototype.chain=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._chainedTweens=e,this},a.prototype.onStart=function(e){return this._onStartCallback=e,this},a.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},a.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},a.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},a.prototype.onStop=function(e){return this._onStopCallback=e,this},a.prototype.update=function(e,t){if(void 0===e&&(e=Ql()),void 0===t&&(t=!0),this._isPaused)return!0;var n,s;if(!this._goToEnd&&!this._isPlaying){if(e>this._startTime+this._duration)return!1;t&&this.start(e)}if(this._goToEnd=!1,e<this._startTime)return!0;!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),s=(e-this._startTime)/this._duration;var u=this._easingFunction(s=0===this._duration||s>1?1:s);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,u),this._onUpdateCallback&&this._onUpdateCallback(this._object,s),1===s){if(this._repeat>0){for(n in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat)!this._yoyo&&"string"==typeof this._valuesEnd[n]&&(this._valuesStartRepeat[n]=this._valuesStartRepeat[n]+parseFloat(this._valuesEnd[n])),this._yoyo&&this._swapEndStartRepeatValues(n),this._valuesStart[n]=this._valuesStartRepeat[n];return this._yoyo&&(this._reversed=!this._reversed),this._startTime=void 0!==this._repeatDelayTime?e+this._repeatDelayTime:e+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),!0}this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var d=0,p=this._chainedTweens.length;d<p;d++)this._chainedTweens[d].start(this._startTime+this._duration);return this._isPlaying=!1,!1}return!0},a.prototype._updateProperties=function(e,t,n,s){for(var l in n)if(void 0!==t[l]){var u=t[l]||0,d=n[l],p=Array.isArray(e[l]),g=Array.isArray(d);!p&&g?e[l]=this._interpolationFunction(d,s):"object"==typeof d&&d?this._updateProperties(e[l],u,d,s):"number"==typeof(d=this._handleRelativeValue(u,d))&&(e[l]=u+(d-u)*s)}},a.prototype._handleRelativeValue=function(e,t){return"string"!=typeof t?t:"+"===t.charAt(0)||"-"===t.charAt(0)?e+parseFloat(t):parseFloat(t)},a.prototype._swapEndStartRepeatValues=function(e){var t=this._valuesStartRepeat[e],n=this._valuesEnd[e];this._valuesStartRepeat[e]="string"==typeof n?this._valuesStartRepeat[e]+parseFloat(n):this._valuesEnd[e],this._valuesEnd[e]=t},a}(),io=Gp,pv=(io.getAll.bind(io),io.removeAll.bind(io),io.add.bind(io),io.remove.bind(io),io.update.bind(io));function pb(a,e){if(1&a){const t=I.EpF();I.TgZ(0,"span",3),I.NdJ("click",function(){const l=I.CHM(t).$implicit;return I.oxw().handleSwitchButtonClick(l)}),I.TgZ(1,"b",4),I._uU(2),I.qZA(),I._UZ(3,"i",5),I.qZA()}if(2&a){const t=e.$implicit;I.xp6(2),I.Oqu(t.name)}}const P_=[{name:"\u5ba2\u5385",key:"living",position:new K(0,0,0),target:new K(0,0,5)},{name:"\u5367\u5ba4",key:"bed",position:new K(-32,0,0),target:new K(0,0,5)},{name:"\u4e66\u623f",key:"book",position:new K(32,0,0),target:new K(32,6,8)}],L_=[{path:"",component:ki,children:[{path:"star",component:Ow},{path:"cube",component:Nw},{path:"shanghai",component:Hp},{path:"room",component:(()=>{class a{constructor(t){this.threeService=t,this.rooms=P_}ngOnInit(){const{scene:t,camera:n,renderer:s,orbit_controls:l,clock:u}=this.threeService.init();this.scene=t,this.camera=n,this.renderer=s,this.orbit_controls=l,this.clock=u,this.updaetScene(),this.renderer.render(this.scene,this.camera),this.orbit_controls.update(),window.addEventListener("resize",()=>{this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,2)),this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix()})}updaetScene(){var t;const n=new S0,s=new Ao(16,50,50),l=new Ko({map:n.load("assets/map/map_living_room.jpg"),side:1}),u=new Yi(s,l);u.position.set(0,0,0),u.rotation.y=Math.PI/2,this.scene.add(u);const d=new Ao(16,50,50),p=new Ko({map:n.load("assets/map/map_bed_room.jpg"),side:1}),g=new Yi(d,p);g.position.set(-32,0,0),g.rotation.y=3*Math.PI/5,this.scene.add(g);const _=new Ao(16,50,50),M=new Ko({map:n.load("assets/map/map_study_room.jpg"),side:1}),w=new Yi(_,M);w.position.set(32,0,0),w.rotation.y=4*Math.PI/5,this.scene.add(w),this.camera.position.x=-5,this.camera.lookAt(new K(1,0,0)),this.orbit_controls.enablePan=!1,this.orbit_controls.maxDistance=10,this.camera.updateProjectionMatrix(),null===(t=document.getElementById("room-sphere"))||void 0===t||t.appendChild(this.renderer.domElement),this.renderer.setAnimationLoop(this.animation.bind(this))}animation(){this.orbit_controls&&this.orbit_controls.update(),pv(),this.renderer.render(this.scene,this.camera)}handleSwitchButtonClick(t){const{x:n,y:s,z:l}=t.position,u=new K(n,s,2),d=new K(n,s,l);((a,e,t,n,s=2e3,l)=>{const u=new I_({x1:a.position.x,y1:a.position.y,z1:a.position.z,x2:e.target.x,y2:e.target.y,z2:e.target.z});u.to({x1:t.x,y1:t.y,z1:t.z,x2:n.x,y2:n.y,z2:n.z},s),u.onUpdate(function(d){a.position.x=d.x1,a.position.y=d.y1,a.position.z=d.z1,e.target.x=d.x2,e.target.y=d.y2,e.target.z=d.z2,e.update()}),u.onComplete(function(){e.enabled=!0,e.update(),l()}),u.easing(gh.Cubic.InOut),u.start()})(this.camera,this.orbit_controls,u,d,1600,()=>{console.log(this.orbit_controls.target)}),this.orbit_controls.update()}}return a.\u0275fac=function(t){return new(t||a)(I.Y36(no))},a.\u0275cmp=I.Xpm({type:a,selectors:[["app-room"]],decls:3,vars:1,consts:[[1,"switch"],["class","button",3,"click",4,"ngFor","ngForOf"],["id","room-sphere"],[1,"button",3,"click"],[1,"text"],[1,"icon"]],template:function(t,n){1&t&&(I.TgZ(0,"div",0),I.YNc(1,pb,4,1,"span",1),I.qZA(),I._UZ(2,"div",2)),2&t&&(I.xp6(1),I.Q6J("ngForOf",n.rooms))},directives:[j.sg],styles:[".switch[_ngcontent-%COMP%]{position:fixed;right:.5rem;top:40%;z-index:11;animation:slideInRight 1s .3s;animation-fill-mode:both}.switch[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{display:block;background:rgba(27,25,24,.5);border-radius:.5rem;display:flex;align-items:center;padding:.5rem .3rem .5rem 1rem;-webkit-backdrop-filter:blur(4px);-moz-backdrop-filter:blur(4px);backdrop-filter:blur(4px);cursor:pointer;transition:all .25s ease-in-out}.switch[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{color:#fff;font-size:1rem;font-weight:600}.switch[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:not(last-child){margin-bottom:2rem}.switch[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{display:inline-block;height:30px;width:1rem;background-size:100% 100%;transform:rotate(180deg);margin-left:8px}.switch[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:hover{background:rgba(27,25,24,.2);box-shadow:1px 1px 2px #0003}"]}),a})()}]}];let vb=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=I.oAB({type:a}),a.\u0275inj=I.cJS({imports:[[Ps.Bz.forChild(L_)],Ps.Bz]}),a})(),yb=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=I.oAB({type:a}),a.\u0275inj=I.cJS({providers:[no],imports:[[j.ez,vb,Mr,Is.forRoot({loader:$i})]]}),a})()},8830:(zt,Be,Q)=>{var j=Q(2313),I=Q(1223),Me=Q(6324),ze={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0},Ie={duration:1e3,delay:0,endDelay:0,easing:"easeOutElastic(1, .5)",round:0},xt=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],Ke={CSS:{},springs:{}};function mt(S,T,m){return Math.min(Math.max(S,T),m)}function Et(S,T){return S.indexOf(T)>-1}function je(S,T){return S.apply(null,T)}var me={arr:function(S){return Array.isArray(S)},obj:function(S){return Et(Object.prototype.toString.call(S),"Object")},pth:function(S){return me.obj(S)&&S.hasOwnProperty("totalLength")},svg:function(S){return S instanceof SVGElement},inp:function(S){return S instanceof HTMLInputElement},dom:function(S){return S.nodeType||me.svg(S)},str:function(S){return"string"==typeof S},fnc:function(S){return"function"==typeof S},und:function(S){return void 0===S},nil:function(S){return me.und(S)||null===S},hex:function(S){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(S)},rgb:function(S){return/^rgb/.test(S)},hsl:function(S){return/^hsl/.test(S)},col:function(S){return me.hex(S)||me.rgb(S)||me.hsl(S)},key:function(S){return!ze.hasOwnProperty(S)&&!Ie.hasOwnProperty(S)&&"targets"!==S&&"keyframes"!==S}};function Je(S){var T=/\(([^)]+)\)/.exec(S);return T?T[1].split(",").map(function(m){return parseFloat(m)}):[]}function _n(S,T){var m=Je(S),v=mt(me.und(m[0])?1:m[0],.1,100),y=mt(me.und(m[1])?100:m[1],.1,100),A=mt(me.und(m[2])?10:m[2],.1,100),O=mt(me.und(m[3])?0:m[3],.1,100),z=Math.sqrt(y/v),H=A/(2*Math.sqrt(y*v)),J=H<1?z*Math.sqrt(1-H*H):0,Se=H<1?(H*z-O)/J:-O+z;function et(Ot){var Dt=T?T*Ot/1e3:Ot;return Dt=H<1?Math.exp(-Dt*H*z)*(1*Math.cos(J*Dt)+Se*Math.sin(J*Dt)):(1+Se*Dt)*Math.exp(-Dt*z),0===Ot||1===Ot?Ot:1-Dt}return T?et:function lt(){var Ot=Ke.springs[S];if(Ot)return Ot;for(var Dt=1/6,Mn=0,ni=0;;)if(1===et(Mn+=Dt)){if(++ni>=16)break}else ni=0;var Xi=Mn*Dt*1e3;return Ke.springs[S]=Xi,Xi}}function $e(S){return void 0===S&&(S=10),function(T){return Math.ceil(mt(T,1e-6,1)*S)*(1/S)}}var S,T,In=function(){var T=.1;function m(ae,Se){return 1-3*Se+3*ae}function v(ae,Se){return 3*Se-6*ae}function y(ae){return 3*ae}function A(ae,Se,et){return((m(Se,et)*ae+v(Se,et))*ae+y(Se))*ae}function O(ae,Se,et){return 3*m(Se,et)*ae*ae+2*v(Se,et)*ae+y(Se)}return function J(ae,Se,et,lt){if(0<=ae&&ae<=1&&0<=et&&et<=1){var Ot=new Float32Array(11);if(ae!==Se||et!==lt)for(var Dt=0;Dt<11;++Dt)Ot[Dt]=A(Dt*T,ae,et);return function(ni){return ae===Se&&et===lt||0===ni||1===ni?ni:A(function Mn(ni){for(var Xi=0,ln=1;10!==ln&&Ot[ln]<=ni;++ln)Xi+=T;--ln;var Kr=Xi+(ni-Ot[ln])/(Ot[ln+1]-Ot[ln])*T,bi=O(Kr,ae,et);return bi>=.001?function H(ae,Se,et,lt){for(var Ot=0;Ot<4;++Ot){var Dt=O(Se,et,lt);if(0===Dt)return Se;Se-=(A(Se,et,lt)-ae)/Dt}return Se}(ni,Kr,ae,et):0===bi?Kr:function z(ae,Se,et,lt,Ot){var Dt,Mn,ni=0;do{(Dt=A(Mn=Se+(et-Se)/2,lt,Ot)-ae)>0?et=Mn:Se=Mn}while(Math.abs(Dt)>1e-7&&++ni<10);return Mn}(ni,Xi,Xi+T,ae,et)}(ni),Se,lt)}}}}(),Ve=(S={linear:function(){return function(v){return v}}},T={Sine:function(){return function(v){return 1-Math.cos(v*Math.PI/2)}},Circ:function(){return function(v){return 1-Math.sqrt(1-v*v)}},Back:function(){return function(v){return v*v*(3*v-2)}},Bounce:function(){return function(v){for(var y,A=4;v<((y=Math.pow(2,--A))-1)/11;);return 1/Math.pow(4,3-A)-7.5625*Math.pow((3*y-2)/22-v,2)}},Elastic:function(v,y){void 0===v&&(v=1),void 0===y&&(y=.5);var A=mt(v,1,10),O=mt(y,.1,2);return function(z){return 0===z||1===z?z:-A*Math.pow(2,10*(z-1))*Math.sin((z-1-O/(2*Math.PI)*Math.asin(1/A))*(2*Math.PI)/O)}}},["Quad","Cubic","Quart","Quint","Expo"].forEach(function(v,y){T[v]=function(){return function(A){return Math.pow(A,y+2)}}}),Object.keys(T).forEach(function(v){var y=T[v];S["easeIn"+v]=y,S["easeOut"+v]=function(A,O){return function(z){return 1-y(A,O)(1-z)}},S["easeInOut"+v]=function(A,O){return function(z){return z<.5?y(A,O)(2*z)/2:1-y(A,O)(-2*z+2)/2}},S["easeOutIn"+v]=function(A,O){return function(z){return z<.5?(1-y(A,O)(1-2*z))/2:(y(A,O)(2*z-1)+1)/2}}}),S);function Yt(S,T){if(me.fnc(S))return S;var m=S.split("(")[0],v=Ve[m],y=Je(S);switch(m){case"spring":return _n(S,T);case"cubicBezier":return je(In,y);case"steps":return je($e,y);default:return je(v,y)}}function Cn(S){try{return document.querySelectorAll(S)}catch(m){return}}function pn(S,T){for(var m=S.length,v=arguments.length>=2?arguments[1]:void 0,y=[],A=0;A<m;A++)if(A in S){var O=S[A];T.call(v,O,A,S)&&y.push(O)}return y}function gt(S){return S.reduce(function(T,m){return T.concat(me.arr(m)?gt(m):m)},[])}function vt(S){return me.arr(S)?S:(me.str(S)&&(S=Cn(S)||S),S instanceof NodeList||S instanceof HTMLCollection?[].slice.call(S):[S])}function Ze(S,T){return S.some(function(m){return m===T})}function Qe(S){var T={};for(var m in S)T[m]=S[m];return T}function bn(S,T){var m=Qe(S);for(var v in S)m[v]=T.hasOwnProperty(v)?T[v]:S[v];return m}function Ne(S,T){var m=Qe(S);for(var v in T)m[v]=me.und(S[v])?T[v]:S[v];return m}function ft(S){var T=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(S);if(T)return T[1]}function Nt(S,T){return me.fnc(S)?S(T.target,T.id,T.total):S}function Qi(S,T){return S.getAttribute(T)}function Ut(S,T,m){if(Ze([m,"deg","rad","turn"],ft(T)))return T;var y=Ke.CSS[T+m];if(!me.und(y))return y;var O=document.createElement(S.tagName),z=S.parentNode&&S.parentNode!==document?S.parentNode:document.body;z.appendChild(O),O.style.position="absolute",O.style.width=100+m;var H=100/O.offsetWidth;z.removeChild(O);var J=H*parseFloat(T);return Ke.CSS[T+m]=J,J}function ht(S,T,m){if(T in S.style){var v=T.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),y=S.style[T]||getComputedStyle(S).getPropertyValue(v)||"0";return m?Ut(S,y,m):y}}function ye(S,T){return me.dom(S)&&!me.inp(S)&&(!me.nil(Qi(S,T))||me.svg(S)&&S[T])?"attribute":me.dom(S)&&Ze(xt,T)?"transform":me.dom(S)&&"transform"!==T&&ht(S,T)?"css":null!=S[T]?"object":void 0}function xe(S){if(me.dom(S)){for(var y,T=S.style.transform||"",m=/(\w+)\(([^)]*)\)/g,v=new Map;y=m.exec(T);)v.set(y[1],y[2]);return v}}function Re(S,T,m,v){switch(ye(S,T)){case"transform":return function De(S,T,m,v){var y=Et(T,"scale")?1:0+function Kt(S){return Et(S,"translate")||"perspective"===S?"px":Et(S,"rotate")||Et(S,"skew")?"deg":void 0}(T),A=xe(S).get(T)||y;return m&&(m.transforms.list.set(T,A),m.transforms.last=T),v?Ut(S,A,v):A}(S,T,v,m);case"css":return ht(S,T,m);case"attribute":return Qi(S,T);default:return S[T]||0}}function rt(S,T){var m=/^(\*=|\+=|-=)/.exec(S);if(!m)return S;var v=ft(S)||0,y=parseFloat(T),A=parseFloat(S.replace(m[0],""));switch(m[0][0]){case"+":return y+A+v;case"-":return y-A+v;case"*":return y*A+v}}function Xe(S,T){if(me.col(S))return function En(S){return me.rgb(S)?function yt(S){var T=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(S);return T?"rgba("+T[1]+",1)":S}(S):me.hex(S)?function Gt(S){var m=S.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(z,H,J,ae){return H+H+J+J+ae+ae}),v=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(m);return"rgba("+parseInt(v[1],16)+","+parseInt(v[2],16)+","+parseInt(v[3],16)+",1)"}(S):me.hsl(S)?function Zt(S){var z,H,J,T=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(S)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(S),m=parseInt(T[1],10)/360,v=parseInt(T[2],10)/100,y=parseInt(T[3],10)/100,A=T[4]||1;function O(et,lt,Ot){return Ot<0&&(Ot+=1),Ot>1&&(Ot-=1),Ot<1/6?et+6*(lt-et)*Ot:Ot<.5?lt:Ot<2/3?et+(lt-et)*(2/3-Ot)*6:et}if(0==v)z=H=J=y;else{var ae=y<.5?y*(1+v):y+v-y*v,Se=2*y-ae;z=O(Se,ae,m+1/3),H=O(Se,ae,m),J=O(Se,ae,m-1/3)}return"rgba("+255*z+","+255*H+","+255*J+","+A+")"}(S):void 0}(S);if(/\s/g.test(S))return S;var m=ft(S),v=m?S.substr(0,S.length-m.length):S;return T?v+T:v}function Lt(S,T){return Math.sqrt(Math.pow(T.x-S.x,2)+Math.pow(T.y-S.y,2))}function _t(S){for(var v,T=S.points,m=0,y=0;y<T.numberOfItems;y++){var A=T.getItem(y);y>0&&(m+=Lt(v,A)),v=A}return m}function Gn(S){if(S.getTotalLength)return S.getTotalLength();switch(S.tagName.toLowerCase()){case"circle":return function cn(S){return 2*Math.PI*Qi(S,"r")}(S);case"rect":return function Wt(S){return 2*Qi(S,"width")+2*Qi(S,"height")}(S);case"line":return function qe(S){return Lt({x:Qi(S,"x1"),y:Qi(S,"y1")},{x:Qi(S,"x2"),y:Qi(S,"y2")})}(S);case"polyline":return _t(S);case"polygon":return function ti(S){var T=S.points;return _t(S)+Lt(T.getItem(T.numberOfItems-1),T.getItem(0))}(S)}}function Fi(S,T){var m=T||{},v=m.el||function lr(S){for(var T=S.parentNode;me.svg(T)&&me.svg(T.parentNode);)T=T.parentNode;return T}(S),y=v.getBoundingClientRect(),A=Qi(v,"viewBox"),O=y.width,z=y.height,H=m.viewBox||(A?A.split(" "):[0,0,O,z]);return{el:v,viewBox:H,x:H[0]/1,y:H[1]/1,w:O,h:z,vW:H[2],vH:H[3]}}function fs(S,T,m){function v(ae){return void 0===ae&&(ae=0),S.el.getPointAtLength(T+ae>=1?T+ae:0)}var y=Fi(S.el,S.svg),A=v(),O=v(-1),z=v(1),H=m?1:y.w/y.vW,J=m?1:y.h/y.vH;switch(S.property){case"x":return(A.x-y.x)*H;case"y":return(A.y-y.y)*J;case"angle":return 180*Math.atan2(z.y-O.y,z.x-O.x)/Math.PI}}function nc(S,T){var m=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,v=Xe(me.pth(S)?S.totalLength:S,T)+"";return{original:v,numbers:v.match(m)?v.match(m).map(Number):[0],strings:me.str(S)||T?v.split(m):[]}}function Ci(S){return pn(S?gt(me.arr(S)?S.map(vt):vt(S)):[],function(m,v,y){return y.indexOf(m)===v})}function ks(S){var T=Ci(S);return T.map(function(m,v){return{target:m,id:v,total:T.length,transforms:{list:xe(m)}}})}function oo(S,T){var m=Qe(T);if(/^spring/.test(m.easing)&&(m.duration=_n(m.easing)),me.arr(S)){var v=S.length;2!==v||me.obj(S[0])?me.fnc(T.duration)||(m.duration=T.duration/v):S={value:S}}var A=me.arr(S)?S:[S];return A.map(function(O,z){var H=me.obj(O)&&!me.pth(O)?O:{value:O};return me.und(H.delay)&&(H.delay=z?0:T.delay),me.und(H.endDelay)&&(H.endDelay=z===A.length-1?T.endDelay:0),H}).map(function(O){return Ne(O,m)})}var cr={css:function(S,T,m){return S.style[T]=m},attribute:function(S,T,m){return S.setAttribute(T,m)},object:function(S,T,m){return S[T]=m},transform:function(S,T,m,v,y){if(v.list.set(T,m),T===v.last||y){var A="";v.list.forEach(function(O,z){A+=z+"("+O+") "}),S.style.transform=A}}};function Bn(S,T){ks(S).forEach(function(v){for(var y in T){var A=Nt(T[y],v),O=v.target,z=ft(A),H=Re(O,y,z,v),ae=rt(Xe(A,z||ft(H)),H),Se=ye(O,y);cr[Se](O,y,ae,v.transforms,!0)}})}function nt(S,T){return pn(gt(S.map(function(m){return T.map(function(v){return function kt(S,T){var m=ye(S.target,T.name);if(m){var v=function jt(S,T){var m;return S.tweens.map(function(v){var y=function yl(S,T){var m={};for(var v in S){var y=Nt(S[v],T);me.arr(y)&&1===(y=y.map(function(A){return Nt(A,T)})).length&&(y=y[0]),m[v]=y}return m.duration=parseFloat(m.duration),m.delay=parseFloat(m.delay),m}(v,T),A=y.value,O=me.arr(A)?A[1]:A,z=ft(O),H=Re(T.target,S.name,z,T),J=m?m.to.original:H,ae=me.arr(A)?A[0]:J,Se=ft(ae)||ft(H),et=z||Se;return me.und(O)&&(O=J),y.from=nc(ae,et),y.to=nc(rt(O,ae),et),y.start=m?m.end:0,y.end=y.start+y.delay+y.duration+y.endDelay,y.easing=Yt(y.easing,y.duration),y.isPath=me.pth(A),y.isPathTargetInsideSVG=y.isPath&&me.svg(T.target),y.isColor=me.col(y.from.original),y.isColor&&(y.round=1),m=y,y})}(T,S),y=v[v.length-1];return{type:m,property:T.name,animatable:S,tweens:v,duration:y.end,delay:v[0].delay,endDelay:y.endDelay}}}(m,v)})})),function(m){return!me.und(m)})}function da(S,T){var m=S.length,v=function(A){return A.timelineOffset?A.timelineOffset:0},y={};return y.duration=m?Math.max.apply(Math,S.map(function(A){return v(A)+A.duration})):T.duration,y.delay=m?Math.min.apply(Math,S.map(function(A){return v(A)+A.delay})):T.delay,y.endDelay=m?y.duration-Math.max.apply(Math,S.map(function(A){return v(A)+A.duration-A.endDelay})):T.endDelay,y}var Di=0,Ni=[],Mi=function(){var S;function m(y){for(var A=Ni.length,O=0;O<A;){var z=Ni[O];z.paused?(Ni.splice(O,1),A--):(z.tick(y),O++)}S=O>0?requestAnimationFrame(m):void 0}return"undefined"!=typeof document&&document.addEventListener("visibilitychange",function v(){!on.suspendWhenDocumentHidden||(is()?S=cancelAnimationFrame(S):(Ni.forEach(function(y){return y._onDocumentVisibility()}),Mi()))}),function T(){!S&&(!is()||!on.suspendWhenDocumentHidden)&&Ni.length>0&&(S=requestAnimationFrame(m))}}();function is(){return!!document&&document.hidden}function on(S){void 0===S&&(S={});var y,T=0,m=0,v=0,A=0,O=null;function z(ln){var un=window.Promise&&new Promise(function(Sr){return O=Sr});return ln.finished=un,un}var H=function pi(S){var T=bn(ze,S),m=bn(Ie,S),v=function ha(S,T){var m=[],v=T.keyframes;for(var y in v&&(T=Ne(function ao(S){for(var T=pn(gt(S.map(function(A){return Object.keys(A)})),function(A){return me.key(A)}).reduce(function(A,O){return A.indexOf(O)<0&&A.push(O),A},[]),m={},v=function(A){var O=T[A];m[O]=S.map(function(z){var H={};for(var J in z)me.key(J)?J==O&&(H.value=z[J]):H[J]=z[J];return H})},y=0;y<T.length;y++)v(y);return m}(v),T)),T)me.key(y)&&m.push({name:y,tweens:oo(T[y],S)});return m}(m,S),y=ks(S.targets),A=nt(y,v),O=da(A,m),z=Di;return Di++,Ne(T,{id:z,children:[],animatables:y,animations:A,duration:O.duration,delay:O.delay,endDelay:O.endDelay})}(S);function ae(){var ln=H.direction;"alternate"!==ln&&(H.direction="normal"!==ln?"normal":"reverse"),H.reversed=!H.reversed,y.forEach(function(un){return un.reversed=H.reversed})}function Se(ln){return H.reversed?H.duration-ln:ln}function et(){T=0,m=Se(H.currentTime)*(1/on.speed)}function lt(ln,un){un&&un.seek(ln-un.timelineOffset)}function Dt(ln){for(var un=0,Sr=H.animations,Kr=Sr.length;un<Kr;){var bi=Sr[un],vc=bi.animatable,Ma=bi.tweens,vo=Ma.length-1,Ei=Ma[vo];vo&&(Ei=pn(Ma,function(zi){return ln<zi.end})[0]||Ei);for(var wa=mt(ln-Ei.start-Ei.delay,0,Ei.duration)/Ei.duration,jo=isNaN(wa)?1:Ei.easing(wa),yc=Ei.to.strings,Za=Ei.round,$p=[],Xd=Ei.to.numbers.length,li=void 0,xs=0;xs<Xd;xs++){var Ka=void 0,Ja=Ei.to.numbers[xs],kr=Ei.from.numbers[xs]||0;Ka=Ei.isPath?fs(Ei.value,jo*Ja,Ei.isPathTargetInsideSVG):kr+jo*(Ja-kr),Za&&(Ei.isColor&&xs>2||(Ka=Math.round(Ka*Za)/Za)),$p.push(Ka)}var qd=yc.length;if(qd){li=yc[0];for(var yo=0;yo<qd;yo++){var mr=yc[yo+1],Ti=$p[yo];isNaN(Ti)||(li+=mr?Ti+mr:Ti+" ")}}else li=$p[0];cr[bi.type](vc.target,bi.property,li,vc.transforms),bi.currentValue=li,un++}}function Mn(ln){H[ln]&&!H.passThrough&&H[ln](H)}function Xi(ln){var un=H.duration,Sr=H.delay,Kr=un-H.endDelay,bi=Se(ln);H.progress=mt(bi/un*100,0,100),H.reversePlayback=bi<H.currentTime,y&&function Ot(ln){if(H.reversePlayback)for(var Sr=A;Sr--;)lt(ln,y[Sr]);else for(var un=0;un<A;un++)lt(ln,y[un])}(bi),!H.began&&H.currentTime>0&&(H.began=!0,Mn("begin")),!H.loopBegan&&H.currentTime>0&&(H.loopBegan=!0,Mn("loopBegin")),bi<=Sr&&0!==H.currentTime&&Dt(0),(bi>=Kr&&H.currentTime!==un||!un)&&Dt(un),bi>Sr&&bi<Kr?(H.changeBegan||(H.changeBegan=!0,H.changeCompleted=!1,Mn("changeBegin")),Mn("change"),Dt(bi)):H.changeBegan&&(H.changeCompleted=!0,H.changeBegan=!1,Mn("changeComplete")),H.currentTime=mt(bi,0,un),H.began&&Mn("update"),ln>=un&&(m=0,function ni(){H.remaining&&!0!==H.remaining&&H.remaining--}(),H.remaining?(T=v,Mn("loopComplete"),H.loopBegan=!1,"alternate"===H.direction&&ae()):(H.paused=!0,H.completed||(H.completed=!0,Mn("loopComplete"),Mn("complete"),!H.passThrough&&"Promise"in window&&(O(),z(H)))))}return z(H),H.reset=function(){var ln=H.direction;H.passThrough=!1,H.currentTime=0,H.progress=0,H.paused=!0,H.began=!1,H.loopBegan=!1,H.changeBegan=!1,H.completed=!1,H.changeCompleted=!1,H.reversePlayback=!1,H.reversed="reverse"===ln,H.remaining=H.loop;for(var un=A=(y=H.children).length;un--;)H.children[un].reset();(H.reversed&&!0!==H.loop||"alternate"===ln&&1===H.loop)&&H.remaining++,Dt(H.reversed?H.duration:0)},H._onDocumentVisibility=et,H.set=function(ln,un){return Bn(ln,un),H},H.tick=function(ln){v=ln,T||(T=v),Xi((v+(m-T))*on.speed)},H.seek=function(ln){Xi(Se(ln))},H.pause=function(){H.paused=!0,et()},H.play=function(){!H.paused||(H.completed&&H.reset(),H.paused=!1,Ni.push(H),et(),Mi())},H.reverse=function(){ae(),H.completed=!H.reversed,et()},H.restart=function(){H.reset(),H.play()},H.remove=function(ln){Vn(Ci(ln),H)},H.reset(),H.autoplay&&H.play(),H}function Ir(S,T){for(var m=T.length;m--;)Ze(S,T[m].animatable.target)&&T.splice(m,1)}function Vn(S,T){var m=T.animations,v=T.children;Ir(S,m);for(var y=v.length;y--;){var A=v[y],O=A.animations;Ir(S,O),!O.length&&!A.children.length&&v.splice(y,1)}!m.length&&!v.length&&T.pause()}on.version="3.2.1",on.speed=1,on.suspendWhenDocumentHidden=!0,on.running=Ni,on.remove=function ka(S){for(var T=Ci(S),m=Ni.length;m--;)Vn(T,Ni[m])},on.get=Re,on.set=Bn,on.convertPx=Ut,on.path=function Hr(S,T){var m=me.str(S)?Cn(S)[0]:S,v=T||100;return function(y){return{property:y,el:m,svg:Fi(m),totalLength:Gn(m)*(v/100)}}},on.setDashoffset=function Wn(S){var T=Gn(S);return S.setAttribute("stroke-dasharray",T),T},on.stagger=function jn(S,T){void 0===T&&(T={});var m=T.direction||"normal",v=T.easing?Yt(T.easing):null,y=T.grid,A=T.axis,O=T.from||0,z="first"===O,H="center"===O,J="last"===O,ae=me.arr(S),Se=parseFloat(ae?S[0]:S),et=ae?parseFloat(S[1]):0,lt=ft(ae?S[1]:S)||0,Ot=T.start||0+(ae?Se:0),Dt=[],Mn=0;return function(ni,Xi,ln){if(z&&(O=0),H&&(O=(ln-1)/2),J&&(O=ln-1),!Dt.length){for(var un=0;un<ln;un++){if(y){var Sr=H?(y[0]-1)/2:O%y[0],Kr=H?(y[1]-1)/2:Math.floor(O/y[0]),Ma=Sr-un%y[0],vo=Kr-Math.floor(un/y[0]),Ei=Math.sqrt(Ma*Ma+vo*vo);"x"===A&&(Ei=-Ma),"y"===A&&(Ei=-vo),Dt.push(Ei)}else Dt.push(Math.abs(O-un));Mn=Math.max.apply(Math,Dt)}v&&(Dt=Dt.map(function(jo){return v(jo/Mn)*Mn})),"reverse"===m&&(Dt=Dt.map(function(jo){return A?jo<0?-1*jo:-jo:Math.abs(Mn-jo)}))}return Ot+(ae?(et-Se)/Mn:Se)*(Math.round(100*Dt[Xi])/100)+lt}},on.timeline=function cu(S){void 0===S&&(S={});var T=on(S);return T.duration=0,T.add=function(m,v){var y=Ni.indexOf(T),A=T.children;function O(et){et.passThrough=!0}y>-1&&Ni.splice(y,1);for(var z=0;z<A.length;z++)O(A[z]);var H=Ne(m,bn(Ie,S));H.targets=H.targets||S.targets;var J=T.duration;H.autoplay=!1,H.direction=T.direction,H.timelineOffset=me.und(v)?J:rt(v,J),O(T),T.seek(H.timelineOffset);var ae=on(H);O(ae),A.push(ae);var Se=da(A,S);return T.delay=Se.delay,T.endDelay=Se.endDelay,T.duration=Se.duration,T.seek(0),T.reset(),T.autoplay&&T.play(),T},T},on.easing=Yt,on.penner=Ve,on.random=function(S,T){return Math.floor(Math.random()*(T-S+1))+S};const ci=on,Fn=[{path:"",redirectTo:"index",pathMatch:"full"},{path:"index",component:(()=>{class S{constructor(m){this.router=m}ngOnInit(){ci({targets:".twitter",translateX:100,direction:"alternate",easing:"easeInOutQuad"})}}return S.\u0275fac=function(m){return new(m||S)(I.Y36(Me.F0))},S.\u0275cmp=I.Xpm({type:S,selectors:[["app-index"]],decls:83,vars:0,consts:[["role","banner",1,"toolbar"],["aria-label","Angular on YouTube","target","_blank","rel","noopener","href","https://youtube.com","title","YouTube"],["id","youtube-logo","height","24","width","24","data-name","Logo","xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","#fff"],["d","M0 0h24v24H0V0z","fill","none"],["d","M21.58 7.19c-.23-.86-.91-1.54-1.77-1.77C18.25 5 12 5 12 5s-6.25 0-7.81.42c-.86.23-1.54.91-1.77 1.77C2 8.75 2 12 2 12s0 3.25.42 4.81c.23.86.91 1.54 1.77 1.77C5.75 19 12 19 12 19s6.25 0 7.81-.42c.86-.23 1.54-.91 1.77-1.77C22 15.25 22 12 22 12s0-3.25-.42-4.81zM10 15V9l5.2 3-5.2 3z"],["aria-label","Angular on twitter","target","_blank","rel","noopener","href","https://twitter.com","title","Twitter",1,"twitter"],["id","twitter-logo","height","24","data-name","Logo","xmlns","http://www.w3.org/2000/svg","viewBox","0 0 400 400"],["width","400","height","400","fill","none"],["d","M153.62,301.59c94.34,0,145.94-78.16,145.94-145.94,0-2.22,0-4.43-.15-6.63A104.36,104.36,0,0,0,325,122.47a102.38,102.38,0,0,1-29.46,8.07,51.47,51.47,0,0,0,22.55-28.37,102.79,102.79,0,0,1-32.57,12.45,51.34,51.34,0,0,0-87.41,46.78A145.62,145.62,0,0,1,92.4,107.81a51.33,51.33,0,0,0,15.88,68.47A50.91,50.91,0,0,1,85,169.86c0,.21,0,.43,0,.65a51.31,51.31,0,0,0,41.15,50.28,51.21,51.21,0,0,1-23.16.88,51.35,51.35,0,0,0,47.92,35.62,102.92,102.92,0,0,1-63.7,22A104.41,104.41,0,0,1,75,278.55a145.21,145.21,0,0,0,78.62,23","fill","#fff"],[1,"spacer"],[1,"tips"],["role","main",1,"content"],[1,"card","highlight-card","card-small"],["id","rocket-smoke","xmlns","http://www.w3.org/2000/svg","width","516.119","height","1083.632","viewBox","0 0 516.119 1083.632"],["id","Path_40","data-name","Path 40","d","M644.6,141S143.02,215.537,147.049,870.207s342.774,201.755,342.774,201.755S404.659,847.213,388.815,762.2c-27.116-145.51-11.551-384.124,271.9-609.1C671.15,139.365,644.6,141,644.6,141Z","transform","translate(-147.025 -140.939)","fill","#f5f5f5"],[1,"card-container"],["rel","noopener","routerLink","/shader/room",1,"card"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24",1,"material-icons"],["d","M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"],["d","M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"],["target","_blank","rel","noopener","href","https://angular.io/tutorial",1,"card"],["d","M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82zM12 3L1 9l11 6 9-4.91V17h2V9L12 3z"],["target","_blank","rel","noopener","href","https://material.angular.io",1,"card"],["xmlns","http://www.w3.org/2000/svg","width","21.813","height","23.453","viewBox","0 0 21.813 23.453",2,"margin-right","8px"],["d","M4099.584,972.736h0l-10.882,3.9,1.637,14.4,9.245,5.153,9.245-5.153,1.686-14.4Z","transform","translate(-4088.702 -972.736)","fill","#808080"],["d","M4181.516,972.736v23.453l9.245-5.153,1.686-14.4Z","transform","translate(-4170.633 -972.736)","fill","#808080"],["d","M4137.529,1076.127l-7.7-3.723,4.417-2.721,7.753,3.723Z","transform","translate(-4125.003 -1058.315)","fill","#ffe0b2"],["d","M4137.529,1051.705l-7.7-3.723,4.417-2.721,7.753,3.723Z","transform","translate(-4125.003 -1036.757)","fill","#fff3e0"],["d","M4137.529,1027.283l-7.7-3.723,4.417-2.721,7.753,3.723Z","transform","translate(-4125.003 -1015.199)","fill","#fff"],["target","_blank","rel","noopener","href","https://blog.angular.io/",1,"card"],["d","M13.5.67s.74 2.65.74 4.8c0 2.06-1.35 3.73-3.41 3.73-2.07 0-3.63-1.67-3.63-3.73l.03-.36C5.21 7.51 4 10.62 4 14c0 4.42 3.58 8 8 8s8-3.58 8-8C20 8.61 17.41 3.8 13.5.67zM11.71 19c-1.78 0-3.22-1.4-3.22-3.14 0-1.62 1.05-2.76 2.81-3.12 1.77-.36 3.6-1.21 4.62-2.58.39 1.29.59 2.65.59 4.04 0 2.65-2.15 4.8-4.8 4.8z"],["target","_blank","rel","noopener","href","https://angular.io/devtools/",1,"card"],["xmlns","http://www.w3.org/2000/svg","enable-background","new 0 0 24 24","height","24px","viewBox","0 0 24 24","width","24px","fill","#000000",1,"material-icons"],["fill","none","height","24","width","24"],["d","M14.73,13.31C15.52,12.24,16,10.93,16,9.5C16,5.91,13.09,3,9.5,3S3,5.91,3,9.5C3,13.09,5.91,16,9.5,16 c1.43,0,2.74-0.48,3.81-1.27L19.59,21L21,19.59L14.73,13.31z M9.5,14C7.01,14,5,11.99,5,9.5S7.01,5,9.5,5S14,7.01,14,9.5 S11.99,14,9.5,14z"],["points","10.29,8.44 9.5,6 8.71,8.44 6.25,8.44 8.26,10.03 7.49,12.5 9.5,10.97 11.51,12.5 10.74,10.03 12.75,8.44"],["href","https://github.com/February3O","target","_blank","rel","noopener"],[1,"github-star-badge"],["d","M0 0h24v24H0z","fill","none"],["d","M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"],["d","M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z","fill","#1976d2"],["id","clouds","xmlns","http://www.w3.org/2000/svg","width","2611.084","height","485.677","viewBox","0 0 2611.084 485.677"],["id","Path_39","data-name","Path 39","d","M2379.709,863.793c10-93-77-171-168-149-52-114-225-105-264,15-75,3-140,59-152,133-30,2.83-66.725,9.829-93.5,26.25-26.771-16.421-63.5-23.42-93.5-26.25-12-74-77-130-152-133-39-120-212-129-264-15-54.084-13.075-106.753,9.173-138.488,48.9-31.734-39.726-84.4-61.974-138.487-48.9-52-114-225-105-264,15a162.027,162.027,0,0,0-103.147,43.044c-30.633-45.365-87.1-72.091-145.206-58.044-52-114-225-105-264,15-75,3-140,59-152,133-53,5-127,23-130,83-2,42,35,72,70,86,49,20,106,18,157,5a165.625,165.625,0,0,0,120,0c47,94,178,113,251,33,61.112,8.015,113.854-5.72,150.492-29.764a165.62,165.62,0,0,0,110.861-3.236c47,94,178,113,251,33,31.385,4.116,60.563,2.495,86.487-3.311,25.924,5.806,55.1,7.427,86.488,3.311,73,80,204,61,251-33a165.625,165.625,0,0,0,120,0c51,13,108,15,157-5a147.188,147.188,0,0,0,33.5-18.694,147.217,147.217,0,0,0,33.5,18.694c49,20,106,18,157,5a165.625,165.625,0,0,0,120,0c47,94,178,113,251,33C2446.709,1093.793,2554.709,922.793,2379.709,863.793Z","transform","translate(142.69 -634.312)","fill","#eee"]],template:function(m,v){1&m&&(I.TgZ(0,"div",0)(1,"a",1),I.O4$(),I.TgZ(2,"svg",2),I._UZ(3,"path",3)(4,"path",4),I.qZA()(),I.kcU(),I.TgZ(5,"a",5),I.O4$(),I.TgZ(6,"svg",6),I._UZ(7,"rect",7)(8,"path",8),I.qZA()(),I.kcU(),I._UZ(9,"div",9),I.TgZ(10,"span",10),I._uU(11,"Welcome"),I.qZA()(),I.TgZ(12,"div",11)(13,"div",12)(14,"span"),I._uU(15,"hello world!"),I.qZA(),I.O4$(),I.TgZ(16,"svg",13)(17,"title"),I._uU(18,"Rocket Ship Smoke"),I.qZA(),I._UZ(19,"path",14),I.qZA()(),I.kcU(),I.TgZ(20,"div",15)(21,"a",16),I.O4$(),I.TgZ(22,"svg",17),I._UZ(23,"path",18),I.qZA(),I.kcU(),I.TgZ(24,"span"),I._uU(25,"Shader"),I.qZA(),I.O4$(),I.TgZ(26,"svg",17),I._UZ(27,"path",19),I.qZA()(),I.kcU(),I.TgZ(28,"a",20),I.O4$(),I.TgZ(29,"svg",17),I._UZ(30,"path",21),I.qZA(),I.kcU(),I.TgZ(31,"span"),I._uU(32,"Learn"),I.qZA(),I.O4$(),I.TgZ(33,"svg",17),I._UZ(34,"path",19),I.qZA()(),I.kcU(),I.TgZ(35,"a",22),I.O4$(),I.TgZ(36,"svg",23),I._UZ(37,"path",24)(38,"path",25)(39,"path",26)(40,"path",27)(41,"path",28),I.qZA(),I.kcU(),I.TgZ(42,"span"),I._uU(43,"Material"),I.qZA(),I.O4$(),I.TgZ(44,"svg",17),I._UZ(45,"path",19),I.qZA()(),I.kcU(),I.TgZ(46,"a",29),I.O4$(),I.TgZ(47,"svg",17),I._UZ(48,"path",30),I.qZA(),I.kcU(),I.TgZ(49,"span"),I._uU(50,"Blog"),I.qZA(),I.O4$(),I.TgZ(51,"svg",17),I._UZ(52,"path",19),I.qZA()(),I.kcU(),I.TgZ(53,"a",31),I.O4$(),I.TgZ(54,"svg",32)(55,"g"),I._UZ(56,"rect",33),I.qZA(),I.TgZ(57,"g")(58,"g"),I._UZ(59,"path",34)(60,"polygon",35),I.qZA()()(),I.kcU(),I.TgZ(61,"span"),I._uU(62,"DevTools"),I.qZA(),I.O4$(),I.TgZ(63,"svg",17),I._UZ(64,"path",19),I.qZA()()(),I.kcU(),I._UZ(65,"div",15)(66,"div",15),I.TgZ(67,"footer"),I._uU(68," GitHub?\xa0 "),I.TgZ(69,"a",36)(70,"div",37),I.O4$(),I.TgZ(71,"svg",17),I._UZ(72,"path",38)(73,"path",39),I.qZA(),I._uU(74," Star "),I.qZA()(),I.kcU(),I.TgZ(75,"a",36),I.O4$(),I.TgZ(76,"svg",17),I._UZ(77,"path",40)(78,"path",38),I.qZA()()(),I.TgZ(79,"svg",41)(80,"title"),I._uU(81,"Gray Clouds Background"),I.qZA(),I._UZ(82,"path",42),I.qZA()())},directives:[Me.yS],styles:["",""]}),S})()},{path:"shader",loadChildren:()=>Promise.resolve().then(Q.bind(Q,9678)).then(S=>S.ShaderModule)}];let ps=(()=>{class S{}return S.\u0275fac=function(m){return new(m||S)},S.\u0275mod=I.oAB({type:S}),S.\u0275inj=I.cJS({imports:[[Me.Bz.forRoot(Fn,{useHash:!0})],Me.Bz]}),S})(),Gr=(()=>{class S{constructor(){this.title="docs"}ngOnInit(){}}return S.\u0275fac=function(m){return new(m||S)},S.\u0275cmp=I.Xpm({type:S,selectors:[["app-root"]],decls:1,vars:0,template:function(m,v){1&m&&I._UZ(0,"router-outlet")},directives:[Me.lC],styles:[""]}),S})();var rs=Q(9678),Ss=Q(9808);Q(2076),Q(8306),Q(4742),Q(8421),Q(7669),Q(5403),Q(3268),Q(1810),Q(4004);let nr=(()=>{class S{}return S.\u0275fac=function(m){return new(m||S)},S.\u0275mod=I.oAB({type:S}),S.\u0275inj=I.cJS({}),S})(),Ya=(()=>{class S{}return S.\u0275fac=function(m){return new(m||S)},S.\u0275mod=I.oAB({type:S}),S.\u0275inj=I.cJS({imports:[[nr]]}),S})(),go=(()=>{class S{}return S.\u0275fac=function(m){return new(m||S)},S.\u0275mod=I.oAB({type:S}),S.\u0275inj=I.cJS({imports:[Ya]}),S})(),Ol=(()=>{class S{}return S.\u0275fac=function(m){return new(m||S)},S.\u0275mod=I.oAB({type:S,bootstrap:[Gr]}),S.\u0275inj=I.cJS({providers:[],imports:[[j.b2,Ss.ez,go,ps,rs.ShaderModule]]}),S})();(0,I.G48)(),j.q6().bootstrapModule(Ol).catch(S=>console.error(S))},8306:(zt,Be,Q)=>{Q.d(Be,{y:()=>je});var j=Q(2961),I=Q(727),Me=Q(8822),ze=Q(4671);var Ke=Q(2416),mt=Q(576),Et=Q(2806);let je=(()=>{class $e{constructor(Ve){Ve&&(this._subscribe=Ve)}lift(Ve){const Yt=new $e;return Yt.source=this,Yt.operator=Ve,Yt}subscribe(Ve,Yt,Cn){const pn=function _n($e){return $e&&$e instanceof j.Lv||function Je($e){return $e&&(0,mt.m)($e.next)&&(0,mt.m)($e.error)&&(0,mt.m)($e.complete)}($e)&&(0,I.Nn)($e)}(Ve)?Ve:new j.Hp(Ve,Yt,Cn);return(0,Et.x)(()=>{const{operator:gt,source:vt}=this;pn.add(gt?gt.call(pn,vt):vt?this._subscribe(pn):this._trySubscribe(pn))}),pn}_trySubscribe(Ve){try{return this._subscribe(Ve)}catch(Yt){Ve.error(Yt)}}forEach(Ve,Yt){return new(Yt=me(Yt))((Cn,pn)=>{const gt=new j.Hp({next:vt=>{try{Ve(vt)}catch(Ze){pn(Ze),gt.unsubscribe()}},error:pn,complete:Cn});this.subscribe(gt)})}_subscribe(Ve){var Yt;return null===(Yt=this.source)||void 0===Yt?void 0:Yt.subscribe(Ve)}[Me.L](){return this}pipe(...Ve){return function xt($e){return 0===$e.length?ze.y:1===$e.length?$e[0]:function(Ve){return $e.reduce((Yt,Cn)=>Cn(Yt),Ve)}}(Ve)(this)}toPromise(Ve){return new(Ve=me(Ve))((Yt,Cn)=>{let pn;this.subscribe(gt=>pn=gt,gt=>Cn(gt),()=>Yt(pn))})}}return $e.create=In=>new $e(In),$e})();function me($e){var In;return null!==(In=null!=$e?$e:Ke.v.Promise)&&void 0!==In?In:Promise}},7579:(zt,Be,Q)=>{Q.d(Be,{x:()=>Ke});var j=Q(8306),I=Q(727);const ze=(0,Q(3888).d)(Et=>function(){Et(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Ie=Q(8737),xt=Q(2806);let Ke=(()=>{class Et extends j.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(me){const Je=new mt(this,this);return Je.operator=me,Je}_throwIfClosed(){if(this.closed)throw new ze}next(me){(0,xt.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const Je of this.currentObservers)Je.next(me)}})}error(me){(0,xt.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=me;const{observers:Je}=this;for(;Je.length;)Je.shift().error(me)}})}complete(){(0,xt.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:me}=this;for(;me.length;)me.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var me;return(null===(me=this.observers)||void 0===me?void 0:me.length)>0}_trySubscribe(me){return this._throwIfClosed(),super._trySubscribe(me)}_subscribe(me){return this._throwIfClosed(),this._checkFinalizedStatuses(me),this._innerSubscribe(me)}_innerSubscribe(me){const{hasError:Je,isStopped:_n,observers:$e}=this;return Je||_n?I.Lc:(this.currentObservers=null,$e.push(me),new I.w0(()=>{this.currentObservers=null,(0,Ie.P)($e,me)}))}_checkFinalizedStatuses(me){const{hasError:Je,thrownError:_n,isStopped:$e}=this;Je?me.error(_n):$e&&me.complete()}asObservable(){const me=new j.y;return me.source=this,me}}return Et.create=(je,me)=>new mt(je,me),Et})();class mt extends Ke{constructor(je,me){super(),this.destination=je,this.source=me}next(je){var me,Je;null===(Je=null===(me=this.destination)||void 0===me?void 0:me.next)||void 0===Je||Je.call(me,je)}error(je){var me,Je;null===(Je=null===(me=this.destination)||void 0===me?void 0:me.error)||void 0===Je||Je.call(me,je)}complete(){var je,me;null===(me=null===(je=this.destination)||void 0===je?void 0:je.complete)||void 0===me||me.call(je)}_subscribe(je){var me,Je;return null!==(Je=null===(me=this.source)||void 0===me?void 0:me.subscribe(je))&&void 0!==Je?Je:I.Lc}}},2961:(zt,Be,Q)=>{Q.d(Be,{Hp:()=>Ve,Lv:()=>Je});var j=Q(576),I=Q(727),Me=Q(2416),ze=Q(7849);function Ie(){}const xt=Et("C",void 0,void 0);function Et(vt,Ze,Qe){return{kind:vt,value:Ze,error:Qe}}var je=Q(3410),me=Q(2806);class Je extends I.w0{constructor(Ze){super(),this.isStopped=!1,Ze?(this.destination=Ze,(0,I.Nn)(Ze)&&Ze.add(this)):this.destination=gt}static create(Ze,Qe,bn){return new Ve(Ze,Qe,bn)}next(Ze){this.isStopped?pn(function mt(vt){return Et("N",vt,void 0)}(Ze),this):this._next(Ze)}error(Ze){this.isStopped?pn(function Ke(vt){return Et("E",void 0,vt)}(Ze),this):(this.isStopped=!0,this._error(Ze))}complete(){this.isStopped?pn(xt,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(Ze){this.destination.next(Ze)}_error(Ze){try{this.destination.error(Ze)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const _n=Function.prototype.bind;function $e(vt,Ze){return _n.call(vt,Ze)}class In{constructor(Ze){this.partialObserver=Ze}next(Ze){const{partialObserver:Qe}=this;if(Qe.next)try{Qe.next(Ze)}catch(bn){Yt(bn)}}error(Ze){const{partialObserver:Qe}=this;if(Qe.error)try{Qe.error(Ze)}catch(bn){Yt(bn)}else Yt(Ze)}complete(){const{partialObserver:Ze}=this;if(Ze.complete)try{Ze.complete()}catch(Qe){Yt(Qe)}}}class Ve extends Je{constructor(Ze,Qe,bn){let Ne;if(super(),(0,j.m)(Ze)||!Ze)Ne={next:null!=Ze?Ze:void 0,error:null!=Qe?Qe:void 0,complete:null!=bn?bn:void 0};else{let yt;this&&Me.v.useDeprecatedNextContext?(yt=Object.create(Ze),yt.unsubscribe=()=>this.unsubscribe(),Ne={next:Ze.next&&$e(Ze.next,yt),error:Ze.error&&$e(Ze.error,yt),complete:Ze.complete&&$e(Ze.complete,yt)}):Ne=Ze}this.destination=new In(Ne)}}function Yt(vt){Me.v.useDeprecatedSynchronousErrorHandling?(0,me.O)(vt):(0,ze.h)(vt)}function pn(vt,Ze){const{onStoppedNotification:Qe}=Me.v;Qe&&je.z.setTimeout(()=>Qe(vt,Ze))}const gt={closed:!0,next:Ie,error:function Cn(vt){throw vt},complete:Ie}},727:(zt,Be,Q)=>{Q.d(Be,{Lc:()=>xt,w0:()=>Ie,Nn:()=>Ke});var j=Q(576);const Me=(0,Q(3888).d)(Et=>function(me){Et(this),this.message=me?`${me.length} errors occurred during unsubscription:\n${me.map((Je,_n)=>`${_n+1}) ${Je.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=me});var ze=Q(8737);class Ie{constructor(je){this.initialTeardown=je,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let je;if(!this.closed){this.closed=!0;const{_parentage:me}=this;if(me)if(this._parentage=null,Array.isArray(me))for(const $e of me)$e.remove(this);else me.remove(this);const{initialTeardown:Je}=this;if((0,j.m)(Je))try{Je()}catch($e){je=$e instanceof Me?$e.errors:[$e]}const{_finalizers:_n}=this;if(_n){this._finalizers=null;for(const $e of _n)try{mt($e)}catch(In){je=null!=je?je:[],In instanceof Me?je=[...je,...In.errors]:je.push(In)}}if(je)throw new Me(je)}}add(je){var me;if(je&&je!==this)if(this.closed)mt(je);else{if(je instanceof Ie){if(je.closed||je._hasParent(this))return;je._addParent(this)}(this._finalizers=null!==(me=this._finalizers)&&void 0!==me?me:[]).push(je)}}_hasParent(je){const{_parentage:me}=this;return me===je||Array.isArray(me)&&me.includes(je)}_addParent(je){const{_parentage:me}=this;this._parentage=Array.isArray(me)?(me.push(je),me):me?[me,je]:je}_removeParent(je){const{_parentage:me}=this;me===je?this._parentage=null:Array.isArray(me)&&(0,ze.P)(me,je)}remove(je){const{_finalizers:me}=this;me&&(0,ze.P)(me,je),je instanceof Ie&&je._removeParent(this)}}Ie.EMPTY=(()=>{const Et=new Ie;return Et.closed=!0,Et})();const xt=Ie.EMPTY;function Ke(Et){return Et instanceof Ie||Et&&"closed"in Et&&(0,j.m)(Et.remove)&&(0,j.m)(Et.add)&&(0,j.m)(Et.unsubscribe)}function mt(Et){(0,j.m)(Et)?Et():Et.unsubscribe()}},2416:(zt,Be,Q)=>{Q.d(Be,{v:()=>j});const j={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},515:(zt,Be,Q)=>{Q.d(Be,{E:()=>I});const I=new(Q(8306).y)(Ie=>Ie.complete())},2076:(zt,Be,Q)=>{Q.d(Be,{D:()=>bn});var j=Q(8421),I=Q(9672),Me=Q(4482),ze=Q(5403);function Ie(Ne,yt=0){return(0,Me.e)((Gt,Zt)=>{Gt.subscribe((0,ze.x)(Zt,En=>(0,I.f)(Zt,Ne,()=>Zt.next(En),yt),()=>(0,I.f)(Zt,Ne,()=>Zt.complete(),yt),En=>(0,I.f)(Zt,Ne,()=>Zt.error(En),yt)))})}function xt(Ne,yt=0){return(0,Me.e)((Gt,Zt)=>{Zt.add(Ne.schedule(()=>Gt.subscribe(Zt),yt))})}var Et=Q(8306),me=Q(2202),Je=Q(576);function $e(Ne,yt){if(!Ne)throw new Error("Iterable cannot be null");return new Et.y(Gt=>{(0,I.f)(Gt,yt,()=>{const Zt=Ne[Symbol.asyncIterator]();(0,I.f)(Gt,yt,()=>{Zt.next().then(En=>{En.done?Gt.complete():Gt.next(En.value)})},0,!0)})})}var In=Q(3670),Ve=Q(8239),Yt=Q(1144),Cn=Q(6495),pn=Q(2206),gt=Q(4532),vt=Q(3260);function bn(Ne,yt){return yt?function Qe(Ne,yt){if(null!=Ne){if((0,In.c)(Ne))return function Ke(Ne,yt){return(0,j.Xf)(Ne).pipe(xt(yt),Ie(yt))}(Ne,yt);if((0,Yt.z)(Ne))return function je(Ne,yt){return new Et.y(Gt=>{let Zt=0;return yt.schedule(function(){Zt===Ne.length?Gt.complete():(Gt.next(Ne[Zt++]),Gt.closed||this.schedule())})})}(Ne,yt);if((0,Ve.t)(Ne))return function mt(Ne,yt){return(0,j.Xf)(Ne).pipe(xt(yt),Ie(yt))}(Ne,yt);if((0,pn.D)(Ne))return $e(Ne,yt);if((0,Cn.T)(Ne))return function _n(Ne,yt){return new Et.y(Gt=>{let Zt;return(0,I.f)(Gt,yt,()=>{Zt=Ne[me.h](),(0,I.f)(Gt,yt,()=>{let En,ft;try{({value:En,done:ft}=Zt.next())}catch(Kt){return void Gt.error(Kt)}ft?Gt.complete():Gt.next(En)},0,!0)}),()=>(0,Je.m)(null==Zt?void 0:Zt.return)&&Zt.return()})}(Ne,yt);if((0,vt.L)(Ne))return function Ze(Ne,yt){return $e((0,vt.Q)(Ne),yt)}(Ne,yt)}throw(0,gt.z)(Ne)}(Ne,yt):(0,j.Xf)(Ne)}},8421:(zt,Be,Q)=>{Q.d(Be,{Xf:()=>_n});var j=Q(7582),I=Q(1144),Me=Q(8239),ze=Q(8306),Ie=Q(3670),xt=Q(2206),Ke=Q(4532),mt=Q(6495),Et=Q(3260),je=Q(576),me=Q(7849),Je=Q(8822);function _n(vt){if(vt instanceof ze.y)return vt;if(null!=vt){if((0,Ie.c)(vt))return function $e(vt){return new ze.y(Ze=>{const Qe=vt[Je.L]();if((0,je.m)(Qe.subscribe))return Qe.subscribe(Ze);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(vt);if((0,I.z)(vt))return function In(vt){return new ze.y(Ze=>{for(let Qe=0;Qe<vt.length&&!Ze.closed;Qe++)Ze.next(vt[Qe]);Ze.complete()})}(vt);if((0,Me.t)(vt))return function Ve(vt){return new ze.y(Ze=>{vt.then(Qe=>{Ze.closed||(Ze.next(Qe),Ze.complete())},Qe=>Ze.error(Qe)).then(null,me.h)})}(vt);if((0,xt.D)(vt))return Cn(vt);if((0,mt.T)(vt))return function Yt(vt){return new ze.y(Ze=>{for(const Qe of vt)if(Ze.next(Qe),Ze.closed)return;Ze.complete()})}(vt);if((0,Et.L)(vt))return function pn(vt){return Cn((0,Et.Q)(vt))}(vt)}throw(0,Ke.z)(vt)}function Cn(vt){return new ze.y(Ze=>{(function gt(vt,Ze){var Qe,bn,Ne,yt;return(0,j.mG)(this,void 0,void 0,function*(){try{for(Qe=(0,j.KL)(vt);!(bn=yield Qe.next()).done;)if(Ze.next(bn.value),Ze.closed)return}catch(Gt){Ne={error:Gt}}finally{try{bn&&!bn.done&&(yt=Qe.return)&&(yield yt.call(Qe))}finally{if(Ne)throw Ne.error}}Ze.complete()})})(vt,Ze).catch(Qe=>Ze.error(Qe))})}},9646:(zt,Be,Q)=>{Q.d(Be,{of:()=>Me});var j=Q(7669),I=Q(2076);function Me(...ze){const Ie=(0,j.yG)(ze);return(0,I.D)(ze,Ie)}},5403:(zt,Be,Q)=>{Q.d(Be,{x:()=>I});var j=Q(2961);function I(ze,Ie,xt,Ke,mt){return new Me(ze,Ie,xt,Ke,mt)}class Me extends j.Lv{constructor(Ie,xt,Ke,mt,Et,je){super(Ie),this.onFinalize=Et,this.shouldUnsubscribe=je,this._next=xt?function(me){try{xt(me)}catch(Je){Ie.error(Je)}}:super._next,this._error=mt?function(me){try{mt(me)}catch(Je){Ie.error(Je)}finally{this.unsubscribe()}}:super._error,this._complete=Ke?function(){try{Ke()}catch(me){Ie.error(me)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var Ie;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:xt}=this;super.unsubscribe(),!xt&&(null===(Ie=this.onFinalize)||void 0===Ie||Ie.call(this))}}}},4351:(zt,Be,Q)=>{Q.d(Be,{b:()=>Me});var j=Q(5577),I=Q(576);function Me(ze,Ie){return(0,I.m)(Ie)?(0,j.z)(ze,Ie,1):(0,j.z)(ze,1)}},6590:(zt,Be,Q)=>{Q.d(Be,{d:()=>Me});var j=Q(4482),I=Q(5403);function Me(ze){return(0,j.e)((Ie,xt)=>{let Ke=!1;Ie.subscribe((0,I.x)(xt,mt=>{Ke=!0,xt.next(mt)},()=>{Ke||xt.next(ze),xt.complete()}))})}},9300:(zt,Be,Q)=>{Q.d(Be,{h:()=>Me});var j=Q(4482),I=Q(5403);function Me(ze,Ie){return(0,j.e)((xt,Ke)=>{let mt=0;xt.subscribe((0,I.x)(Ke,Et=>ze.call(Ie,Et,mt++)&&Ke.next(Et)))})}},590:(zt,Be,Q)=>{Q.d(Be,{P:()=>Ke});var j=Q(6805),I=Q(9300),Me=Q(5698),ze=Q(6590),Ie=Q(8068),xt=Q(4671);function Ke(mt,Et){const je=arguments.length>=2;return me=>me.pipe(mt?(0,I.h)((Je,_n)=>mt(Je,_n,me)):xt.y,(0,Me.q)(1),je?(0,ze.d)(Et):(0,Ie.T)(()=>new j.K))}},4004:(zt,Be,Q)=>{Q.d(Be,{U:()=>Me});var j=Q(4482),I=Q(5403);function Me(ze,Ie){return(0,j.e)((xt,Ke)=>{let mt=0;xt.subscribe((0,I.x)(Ke,Et=>{Ke.next(ze.call(Ie,Et,mt++))}))})}},8189:(zt,Be,Q)=>{Q.d(Be,{J:()=>Me});var j=Q(5577),I=Q(4671);function Me(ze=1/0){return(0,j.z)(I.y,ze)}},5577:(zt,Be,Q)=>{Q.d(Be,{z:()=>mt});var j=Q(4004),I=Q(8421),Me=Q(4482),ze=Q(9672),Ie=Q(5403),Ke=Q(576);function mt(Et,je,me=1/0){return(0,Ke.m)(je)?mt((Je,_n)=>(0,j.U)(($e,In)=>je(Je,$e,_n,In))((0,I.Xf)(Et(Je,_n))),me):("number"==typeof je&&(me=je),(0,Me.e)((Je,_n)=>function xt(Et,je,me,Je,_n,$e,In,Ve){const Yt=[];let Cn=0,pn=0,gt=!1;const vt=()=>{gt&&!Yt.length&&!Cn&&je.complete()},Ze=bn=>Cn<Je?Qe(bn):Yt.push(bn),Qe=bn=>{$e&&je.next(bn),Cn++;let Ne=!1;(0,I.Xf)(me(bn,pn++)).subscribe((0,Ie.x)(je,yt=>{null==_n||_n(yt),$e?Ze(yt):je.next(yt)},()=>{Ne=!0},void 0,()=>{if(Ne)try{for(Cn--;Yt.length&&Cn<Je;){const yt=Yt.shift();In?(0,ze.f)(je,In,()=>Qe(yt)):Qe(yt)}vt()}catch(yt){je.error(yt)}}))};return Et.subscribe((0,Ie.x)(je,Ze,()=>{gt=!0,vt()})),()=>{null==Ve||Ve()}}(Je,_n,Et,me)))}},5698:(zt,Be,Q)=>{Q.d(Be,{q:()=>ze});var j=Q(515),I=Q(4482),Me=Q(5403);function ze(Ie){return Ie<=0?()=>j.E:(0,I.e)((xt,Ke)=>{let mt=0;xt.subscribe((0,Me.x)(Ke,Et=>{++mt<=Ie&&(Ke.next(Et),Ie<=mt&&Ke.complete())}))})}},8068:(zt,Be,Q)=>{Q.d(Be,{T:()=>ze});var j=Q(6805),I=Q(4482),Me=Q(5403);function ze(xt=Ie){return(0,I.e)((Ke,mt)=>{let Et=!1;Ke.subscribe((0,Me.x)(mt,je=>{Et=!0,mt.next(je)},()=>Et?mt.complete():mt.error(xt())))})}function Ie(){return new j.K}},3410:(zt,Be,Q)=>{Q.d(Be,{z:()=>j});const j={setTimeout(I,Me,...ze){const{delegate:Ie}=j;return(null==Ie?void 0:Ie.setTimeout)?Ie.setTimeout(I,Me,...ze):setTimeout(I,Me,...ze)},clearTimeout(I){const{delegate:Me}=j;return((null==Me?void 0:Me.clearTimeout)||clearTimeout)(I)},delegate:void 0}},2202:(zt,Be,Q)=>{Q.d(Be,{h:()=>I});const I=function j(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(zt,Be,Q)=>{Q.d(Be,{L:()=>j});const j="function"==typeof Symbol&&Symbol.observable||"@@observable"},6805:(zt,Be,Q)=>{Q.d(Be,{K:()=>I});const I=(0,Q(3888).d)(Me=>function(){Me(this),this.name="EmptyError",this.message="no elements in sequence"})},7669:(zt,Be,Q)=>{Q.d(Be,{_6:()=>xt,jO:()=>ze,yG:()=>Ie});var j=Q(576);function Me(Ke){return Ke[Ke.length-1]}function ze(Ke){return(0,j.m)(Me(Ke))?Ke.pop():void 0}function Ie(Ke){return function I(Ke){return Ke&&(0,j.m)(Ke.schedule)}(Me(Ke))?Ke.pop():void 0}function xt(Ke,mt){return"number"==typeof Me(Ke)?Ke.pop():mt}},4742:(zt,Be,Q)=>{Q.d(Be,{D:()=>Ie});const{isArray:j}=Array,{getPrototypeOf:I,prototype:Me,keys:ze}=Object;function Ie(Ke){if(1===Ke.length){const mt=Ke[0];if(j(mt))return{args:mt,keys:null};if(function xt(Ke){return Ke&&"object"==typeof Ke&&I(Ke)===Me}(mt)){const Et=ze(mt);return{args:Et.map(je=>mt[je]),keys:Et}}}return{args:Ke,keys:null}}},8737:(zt,Be,Q)=>{function j(I,Me){if(I){const ze=I.indexOf(Me);0<=ze&&I.splice(ze,1)}}Q.d(Be,{P:()=>j})},3888:(zt,Be,Q)=>{function j(I){const ze=I(Ie=>{Error.call(Ie),Ie.stack=(new Error).stack});return ze.prototype=Object.create(Error.prototype),ze.prototype.constructor=ze,ze}Q.d(Be,{d:()=>j})},1810:(zt,Be,Q)=>{function j(I,Me){return I.reduce((ze,Ie,xt)=>(ze[Ie]=Me[xt],ze),{})}Q.d(Be,{n:()=>j})},2806:(zt,Be,Q)=>{Q.d(Be,{O:()=>ze,x:()=>Me});var j=Q(2416);let I=null;function Me(Ie){if(j.v.useDeprecatedSynchronousErrorHandling){const xt=!I;if(xt&&(I={errorThrown:!1,error:null}),Ie(),xt){const{errorThrown:Ke,error:mt}=I;if(I=null,Ke)throw mt}}else Ie()}function ze(Ie){j.v.useDeprecatedSynchronousErrorHandling&&I&&(I.errorThrown=!0,I.error=Ie)}},9672:(zt,Be,Q)=>{function j(I,Me,ze,Ie=0,xt=!1){const Ke=Me.schedule(function(){ze(),xt?I.add(this.schedule(null,Ie)):this.unsubscribe()},Ie);if(I.add(Ke),!xt)return Ke}Q.d(Be,{f:()=>j})},4671:(zt,Be,Q)=>{function j(I){return I}Q.d(Be,{y:()=>j})},1144:(zt,Be,Q)=>{Q.d(Be,{z:()=>j});const j=I=>I&&"number"==typeof I.length&&"function"!=typeof I},2206:(zt,Be,Q)=>{Q.d(Be,{D:()=>I});var j=Q(576);function I(Me){return Symbol.asyncIterator&&(0,j.m)(null==Me?void 0:Me[Symbol.asyncIterator])}},576:(zt,Be,Q)=>{function j(I){return"function"==typeof I}Q.d(Be,{m:()=>j})},3670:(zt,Be,Q)=>{Q.d(Be,{c:()=>Me});var j=Q(8822),I=Q(576);function Me(ze){return(0,I.m)(ze[j.L])}},6495:(zt,Be,Q)=>{Q.d(Be,{T:()=>Me});var j=Q(2202),I=Q(576);function Me(ze){return(0,I.m)(null==ze?void 0:ze[j.h])}},8239:(zt,Be,Q)=>{Q.d(Be,{t:()=>I});var j=Q(576);function I(Me){return(0,j.m)(null==Me?void 0:Me.then)}},3260:(zt,Be,Q)=>{Q.d(Be,{L:()=>ze,Q:()=>Me});var j=Q(7582),I=Q(576);function Me(Ie){return(0,j.FC)(this,arguments,function*(){const Ke=Ie.getReader();try{for(;;){const{value:mt,done:Et}=yield(0,j.qq)(Ke.read());if(Et)return yield(0,j.qq)(void 0);yield yield(0,j.qq)(mt)}}finally{Ke.releaseLock()}})}function ze(Ie){return(0,I.m)(null==Ie?void 0:Ie.getReader)}},4482:(zt,Be,Q)=>{Q.d(Be,{A:()=>I,e:()=>Me});var j=Q(576);function I(ze){return(0,j.m)(null==ze?void 0:ze.lift)}function Me(ze){return Ie=>{if(I(Ie))return Ie.lift(function(xt){try{return ze(xt,this)}catch(Ke){this.error(Ke)}});throw new TypeError("Unable to lift unknown Observable type")}}},3268:(zt,Be,Q)=>{Q.d(Be,{Z:()=>ze});var j=Q(4004);const{isArray:I}=Array;function ze(Ie){return(0,j.U)(xt=>function Me(Ie,xt){return I(xt)?Ie(...xt):Ie(xt)}(Ie,xt))}},7849:(zt,Be,Q)=>{Q.d(Be,{h:()=>Me});var j=Q(2416),I=Q(3410);function Me(ze){I.z.setTimeout(()=>{const{onUnhandledError:Ie}=j.v;if(!Ie)throw ze;Ie(ze)})}},4532:(zt,Be,Q)=>{function j(I){return new TypeError(`You provided ${null!==I&&"object"==typeof I?"an invalid object":`'${I}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}Q.d(Be,{z:()=>j})},9808:(zt,Be,Q)=>{Q.d(Be,{Do:()=>vt,EM:()=>wl,HT:()=>Ie,JF:()=>El,K0:()=>Ke,Mx:()=>dr,NF:()=>xl,S$:()=>Yt,V_:()=>je,Ye:()=>Ze,b0:()=>gt,bD:()=>Xr,ez:()=>_l,lw:()=>mt,mr:()=>pn,q:()=>Me,sg:()=>oi,w_:()=>xt});var j=Q(1223);let I=null;function Me(){return I}function Ie(U){I||(I=U)}class xt{}const Ke=new j.OlP("DocumentToken");let mt=(()=>{class U{historyGo(B){throw new Error("Not implemented")}}return U.\u0275fac=function(B){return new(B||U)},U.\u0275prov=j.Yz7({token:U,factory:function(){return function Et(){return(0,j.LFG)(me)}()},providedIn:"platform"}),U})();const je=new j.OlP("Location Initialized");let me=(()=>{class U extends mt{constructor(B){super(),this._doc=B,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Me().getBaseHref(this._doc)}onPopState(B){const q=Me().getGlobalEventTarget(this._doc,"window");return q.addEventListener("popstate",B,!1),()=>q.removeEventListener("popstate",B)}onHashChange(B){const q=Me().getGlobalEventTarget(this._doc,"window");return q.addEventListener("hashchange",B,!1),()=>q.removeEventListener("hashchange",B)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(B){this.location.pathname=B}pushState(B,q,se){Je()?this._history.pushState(B,q,se):this.location.hash=se}replaceState(B,q,se){Je()?this._history.replaceState(B,q,se):this.location.hash=se}forward(){this._history.forward()}back(){this._history.back()}historyGo(B=0){this._history.go(B)}getState(){return this._history.state}}return U.\u0275fac=function(B){return new(B||U)(j.LFG(Ke))},U.\u0275prov=j.Yz7({token:U,factory:function(){return function _n(){return new me((0,j.LFG)(Ke))}()},providedIn:"platform"}),U})();function Je(){return!!window.history.pushState}function $e(U,$){if(0==U.length)return $;if(0==$.length)return U;let B=0;return U.endsWith("/")&&B++,$.startsWith("/")&&B++,2==B?U+$.substring(1):1==B?U+$:U+"/"+$}function In(U){const $=U.match(/#|\?|$/),B=$&&$.index||U.length;return U.slice(0,B-("/"===U[B-1]?1:0))+U.slice(B)}function Ve(U){return U&&"?"!==U[0]?"?"+U:U}let Yt=(()=>{class U{historyGo(B){throw new Error("Not implemented")}}return U.\u0275fac=function(B){return new(B||U)},U.\u0275prov=j.Yz7({token:U,factory:function(){return function Cn(U){const $=(0,j.LFG)(Ke).location;return new gt((0,j.LFG)(mt),$&&$.origin||"")}()},providedIn:"root"}),U})();const pn=new j.OlP("appBaseHref");let gt=(()=>{class U extends Yt{constructor(B,q){if(super(),this._platformLocation=B,this._removeListenerFns=[],null==q&&(q=this._platformLocation.getBaseHrefFromDOM()),null==q)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=q}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(B){this._removeListenerFns.push(this._platformLocation.onPopState(B),this._platformLocation.onHashChange(B))}getBaseHref(){return this._baseHref}prepareExternalUrl(B){return $e(this._baseHref,B)}path(B=!1){const q=this._platformLocation.pathname+Ve(this._platformLocation.search),se=this._platformLocation.hash;return se&&B?`${q}${se}`:q}pushState(B,q,se,Te){const He=this.prepareExternalUrl(se+Ve(Te));this._platformLocation.pushState(B,q,He)}replaceState(B,q,se,Te){const He=this.prepareExternalUrl(se+Ve(Te));this._platformLocation.replaceState(B,q,He)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(B=0){var q,se;null===(se=(q=this._platformLocation).historyGo)||void 0===se||se.call(q,B)}}return U.\u0275fac=function(B){return new(B||U)(j.LFG(mt),j.LFG(pn,8))},U.\u0275prov=j.Yz7({token:U,factory:U.\u0275fac}),U})(),vt=(()=>{class U extends Yt{constructor(B,q){super(),this._platformLocation=B,this._baseHref="",this._removeListenerFns=[],null!=q&&(this._baseHref=q)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(B){this._removeListenerFns.push(this._platformLocation.onPopState(B),this._platformLocation.onHashChange(B))}getBaseHref(){return this._baseHref}path(B=!1){let q=this._platformLocation.hash;return null==q&&(q="#"),q.length>0?q.substring(1):q}prepareExternalUrl(B){const q=$e(this._baseHref,B);return q.length>0?"#"+q:q}pushState(B,q,se,Te){let He=this.prepareExternalUrl(se+Ve(Te));0==He.length&&(He=this._platformLocation.pathname),this._platformLocation.pushState(B,q,He)}replaceState(B,q,se,Te){let He=this.prepareExternalUrl(se+Ve(Te));0==He.length&&(He=this._platformLocation.pathname),this._platformLocation.replaceState(B,q,He)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(B=0){var q,se;null===(se=(q=this._platformLocation).historyGo)||void 0===se||se.call(q,B)}}return U.\u0275fac=function(B){return new(B||U)(j.LFG(mt),j.LFG(pn,8))},U.\u0275prov=j.Yz7({token:U,factory:U.\u0275fac}),U})(),Ze=(()=>{class U{constructor(B,q){this._subject=new j.vpe,this._urlChangeListeners=[],this._platformStrategy=B;const se=this._platformStrategy.getBaseHref();this._platformLocation=q,this._baseHref=In(Ne(se)),this._platformStrategy.onPopState(Te=>{this._subject.emit({url:this.path(!0),pop:!0,state:Te.state,type:Te.type})})}path(B=!1){return this.normalize(this._platformStrategy.path(B))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(B,q=""){return this.path()==this.normalize(B+Ve(q))}normalize(B){return U.stripTrailingSlash(function bn(U,$){return U&&$.startsWith(U)?$.substring(U.length):$}(this._baseHref,Ne(B)))}prepareExternalUrl(B){return B&&"/"!==B[0]&&(B="/"+B),this._platformStrategy.prepareExternalUrl(B)}go(B,q="",se=null){this._platformStrategy.pushState(se,"",B,q),this._notifyUrlChangeListeners(this.prepareExternalUrl(B+Ve(q)),se)}replaceState(B,q="",se=null){this._platformStrategy.replaceState(se,"",B,q),this._notifyUrlChangeListeners(this.prepareExternalUrl(B+Ve(q)),se)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(B=0){var q,se;null===(se=(q=this._platformStrategy).historyGo)||void 0===se||se.call(q,B)}onUrlChange(B){this._urlChangeListeners.push(B),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(q=>{this._notifyUrlChangeListeners(q.url,q.state)}))}_notifyUrlChangeListeners(B="",q){this._urlChangeListeners.forEach(se=>se(B,q))}subscribe(B,q,se){return this._subject.subscribe({next:B,error:q,complete:se})}}return U.normalizeQueryParams=Ve,U.joinWithSlash=$e,U.stripTrailingSlash=In,U.\u0275fac=function(B){return new(B||U)(j.LFG(Yt),j.LFG(mt))},U.\u0275prov=j.Yz7({token:U,factory:function(){return function Qe(){return new Ze((0,j.LFG)(Yt),(0,j.LFG)(mt))}()},providedIn:"root"}),U})();function Ne(U){return U.replace(/\/index.html$/,"")}function dr(U,$){$=encodeURIComponent($);for(const B of U.split(";")){const q=B.indexOf("="),[se,Te]=-1==q?[B,""]:[B.slice(0,q),B.slice(q+1)];if(se.trim()===$)return decodeURIComponent(Te)}return null}class Pr{constructor($,B,q,se){this.$implicit=$,this.ngForOf=B,this.index=q,this.count=se}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let oi=(()=>{class U{constructor(B,q,se){this._viewContainer=B,this._template=q,this._differs=se,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(B){this._ngForOf=B,this._ngForOfDirty=!0}set ngForTrackBy(B){this._trackByFn=B}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(B){B&&(this._template=B)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const B=this._ngForOf;!this._differ&&B&&(this._differ=this._differs.find(B).create(this.ngForTrackBy))}if(this._differ){const B=this._differ.diff(this._ngForOf);B&&this._applyChanges(B)}}_applyChanges(B){const q=this._viewContainer;B.forEachOperation((se,Te,He)=>{if(null==se.previousIndex)q.createEmbeddedView(this._template,new Pr(se.item,this._ngForOf,-1,-1),null===He?void 0:He);else if(null==He)q.remove(null===Te?void 0:Te);else if(null!==Te){const st=q.get(Te);q.move(st,He),jr(st,se)}});for(let se=0,Te=q.length;se<Te;se++){const st=q.get(se).context;st.index=se,st.count=Te,st.ngForOf=this._ngForOf}B.forEachIdentityChange(se=>{jr(q.get(se.currentIndex),se)})}static ngTemplateContextGuard(B,q){return!0}}return U.\u0275fac=function(B){return new(B||U)(j.Y36(j.s_b),j.Y36(j.Rgc),j.Y36(j.ZZ4))},U.\u0275dir=j.lG2({type:U,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),U})();function jr(U,$){U.context.$implicit=$.item}let _l=(()=>{class U{}return U.\u0275fac=function(B){return new(B||U)},U.\u0275mod=j.oAB({type:U}),U.\u0275inj=j.cJS({}),U})();const Xr="browser";function xl(U){return U===Xr}let wl=(()=>{class U{}return U.\u0275prov=(0,j.Yz7)({token:U,providedIn:"root",factory:()=>new Hs((0,j.LFG)(Ke),window)}),U})();class Hs{constructor($,B){this.document=$,this.window=B,this.offset=()=>[0,0]}setOffset($){this.offset=Array.isArray($)?()=>$:$}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition($){this.supportsScrolling()&&this.window.scrollTo($[0],$[1])}scrollToAnchor($){if(!this.supportsScrolling())return;const B=function Fr(U,$){const B=U.getElementById($)||U.getElementsByName($)[0];if(B)return B;if("function"==typeof U.createTreeWalker&&U.body&&(U.body.createShadowRoot||U.body.attachShadow)){const q=U.createTreeWalker(U.body,NodeFilter.SHOW_ELEMENT);let se=q.currentNode;for(;se;){const Te=se.shadowRoot;if(Te){const He=Te.getElementById($)||Te.querySelector(`[name="${$}"]`);if(He)return He}se=q.nextNode()}}return null}(this.document,$);B&&(this.scrollToElement(B),B.focus())}setHistoryScrollRestoration($){if(this.supportScrollRestoration()){const B=this.window.history;B&&B.scrollRestoration&&(B.scrollRestoration=$)}}scrollToElement($){const B=$.getBoundingClientRect(),q=B.left+this.window.pageXOffset,se=B.top+this.window.pageYOffset,Te=this.offset();this.window.scrollTo(q-Te[0],se-Te[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const $=Gs(this.window.history)||Gs(Object.getPrototypeOf(this.window.history));return!(!$||!$.writable&&!$.set)}catch($){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch($){return!1}}}function Gs(U){return Object.getOwnPropertyDescriptor(U,"scrollRestoration")}class El{}},1223:(zt,Be,Q)=>{Q.d(Be,{deG:()=>xs,tb:()=>Yw,AFp:()=>$w,ip1:()=>jw,CZH:()=>Up,hGG:()=>_,z2F:()=>lv,sBO:()=>mh,Sil:()=>Kw,_Vd:()=>vp,EJc:()=>Zw,SBq:()=>Qn,qLn:()=>yf,vpe:()=>no,tBr:()=>_u,XFs:()=>jt,OlP:()=>li,zs3:()=>Ta,ZZ4:()=>e,aQg:()=>s,soG:()=>Ud,YKP:()=>yp,h0i:()=>gl,PXZ:()=>rb,R0b:()=>Ns,FiY:()=>Qd,Lbi:()=>XE,g9A:()=>qw,Qsj:()=>LE,FYo:()=>W0,JOm:()=>Mo,q3G:()=>rr,tp0:()=>ef,Rgc:()=>su,dDg:()=>tb,GfV:()=>Ew,s_b:()=>oa,ifc:()=>is,eFA:()=>ob,G48:()=>hb,Gpc:()=>pn,_c5:()=>g,VLi:()=>tS,c2e:()=>ov,zSh:()=>zm,wAp:()=>tn,vHH:()=>Qe,EiD:()=>kv,mCW:()=>Dr,qzn:()=>al,JVY:()=>df,pB0:()=>Rv,eBb:()=>Av,L6k:()=>ff,LAX:()=>Dv,cg1:()=>yd,kL8:()=>sp,yhl:()=>Nh,dqk:()=>jn,sIi:()=>Yh,CqO:()=>hg,QGY:()=>ug,F4k:()=>Es,RDi:()=>se,AaK:()=>Ve,z3N:()=>Qo,qOj:()=>Zm,TTD:()=>uo,_Bn:()=>z0,xp6:()=>jv,uIk:()=>Qm,ekj:()=>jf,Suo:()=>Rd,Xpm:()=>ue,lG2:()=>Wr,Yz7:()=>Wn,cJS:()=>Fi,oAB:()=>xn,Yjl:()=>hr,Y36:()=>Yu,_UZ:()=>jl,qZA:()=>Wl,TgZ:()=>Gc,EpF:()=>Ku,n5z:()=>bi,LFG:()=>Jr,$8M:()=>Ma,$Z:()=>ld,NdJ:()=>Vf,CRH:()=>hh,kcU:()=>Il,O4$:()=>xa,oxw:()=>pg,ALo:()=>Xg,xi3:()=>qg,Hsn:()=>mg,F$t:()=>Zy,Q6J:()=>Hc,iGM:()=>Dd,CHM:()=>Ha,LSH:()=>mm,YNc:()=>Vy,_uU:()=>s0,Oqu:()=>Jf});var j=Q(7579),I=Q(727),Me=Q(8306),ze=Q(8189),Ie=Q(8421),xt=Q(515),Ke=Q(7669),mt=Q(2076),je=Q(2961),me=Q(4482);function _n(i,r,...o){if(!0===r)return void i();if(!1===r)return;const c=new je.Hp({next:()=>{c.unsubscribe(),i()}});return r(...o).subscribe(c)}function $e(i){for(let r in i)if(i[r]===$e)return r;throw Error("Could not find renamed property on target object.")}function In(i,r){for(const o in r)r.hasOwnProperty(o)&&!i.hasOwnProperty(o)&&(i[o]=r[o])}function Ve(i){if("string"==typeof i)return i;if(Array.isArray(i))return"["+i.map(Ve).join(", ")+"]";if(null==i)return""+i;if(i.overriddenName)return`${i.overriddenName}`;if(i.name)return`${i.name}`;const r=i.toString();if(null==r)return""+r;const o=r.indexOf("\n");return-1===o?r:r.substring(0,o)}function Yt(i,r){return null==i||""===i?null===r?"":r:null==r||""===r?i:i+" "+r}const Cn=$e({__forward_ref__:$e});function pn(i){return i.__forward_ref__=pn,i.toString=function(){return Ve(this())},i}function gt(i){return vt(i)?i():i}function vt(i){return"function"==typeof i&&i.hasOwnProperty(Cn)&&i.__forward_ref__===pn}class Qe extends Error{constructor(r,o){super(function bn(i,r){return`NG0${Math.abs(i)}${r?": "+r:""}`}(r,o)),this.code=r}}function Ne(i){return"string"==typeof i?i:null==i?"":String(i)}function yt(i){return"function"==typeof i?i.name||i.toString():"object"==typeof i&&null!=i&&"function"==typeof i.type?i.type.name||i.type.toString():Ne(i)}function ft(i,r){const o=r?` in ${r}`:"";throw new Qe(-201,`No provider for ${yt(i)} found${o}`)}function Wt(i,r){null==i&&function qe(i,r,o,c){throw new Error(`ASSERTION ERROR: ${i}`+(null==c?"":` [Expected=> ${o} ${c} ${r} <=Actual]`))}(r,i,null,"!=")}function Wn(i){return{token:i.token,providedIn:i.providedIn||null,factory:i.factory,value:void 0}}function Fi(i){return{providers:i.providers||[],imports:i.imports||[]}}function Hr(i){return fs(i,oo)||fs(i,ha)}function fs(i,r){return i.hasOwnProperty(r)?i[r]:null}function ks(i){return i&&(i.hasOwnProperty(ao)||i.hasOwnProperty(yl))?i[ao]:null}const oo=$e({\u0275prov:$e}),ao=$e({\u0275inj:$e}),ha=$e({ngInjectableDef:$e}),yl=$e({ngInjectorDef:$e});var jt=(()=>((jt=jt||{})[jt.Default=0]="Default",jt[jt.Host=1]="Host",jt[jt.Self=2]="Self",jt[jt.SkipSelf=4]="SkipSelf",jt[jt.Optional=8]="Optional",jt))();let cr;function kt(i){const r=cr;return cr=i,r}function nt(i,r,o){const c=Hr(i);return c&&"root"==c.providedIn?void 0===c.value?c.value=c.factory():c.value:o&jt.Optional?null:void 0!==r?r:void ft(Ve(i),"Injector")}function Di(i){return{toString:i}.toString()}var pi=(()=>((pi=pi||{})[pi.OnPush=0]="OnPush",pi[pi.Default=1]="Default",pi))(),is=(()=>{return(i=is||(is={}))[i.Emulated=0]="Emulated",i[i.None=2]="None",i[i.ShadowDom=3]="ShadowDom",is;var i})();const on="undefined"!=typeof globalThis&&globalThis,Ir="undefined"!=typeof window&&window,Vn="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,jn=on||"undefined"!=typeof global&&global||Ir||Vn,Tn={},Fn=[],ps=$e({\u0275cmp:$e}),Gr=$e({\u0275dir:$e}),rs=$e({\u0275pipe:$e}),Ss=$e({\u0275mod:$e}),$i=$e({\u0275fac:$e}),Us=$e({__NG_ELEMENT_ID__:$e});let ge=0;function ue(i){return Di(()=>{const o={},c={type:i.type,providersResolver:null,decls:i.decls,vars:i.vars,factory:null,template:i.template||null,consts:i.consts||null,ngContentSelectors:i.ngContentSelectors,hostBindings:i.hostBindings||null,hostVars:i.hostVars||0,hostAttrs:i.hostAttrs||null,contentQueries:i.contentQueries||null,declaredInputs:o,inputs:null,outputs:null,exportAs:i.exportAs||null,onPush:i.changeDetection===pi.OnPush,directiveDefs:null,pipeDefs:null,selectors:i.selectors||Fn,viewQuery:i.viewQuery||null,features:i.features||null,data:i.data||{},encapsulation:i.encapsulation||is.Emulated,id:"c",styles:i.styles||Fn,_:null,setInput:null,schemas:i.schemas||null,tView:null},h=i.directives,f=i.features,x=i.pipes;return c.id+=ge++,c.inputs=ur(i.inputs,o),c.outputs=ur(i.outputs),f&&f.forEach(b=>b(c)),c.directiveDefs=h?()=>("function"==typeof h?h():h).map(pe):null,c.pipeDefs=x?()=>("function"==typeof x?x():x).map(we):null,c})}function pe(i){return Ri(i)||function xr(i){return i[Gr]||null}(i)}function we(i){return function er(i){return i[rs]||null}(i)}const $t={};function xn(i){return Di(()=>{const r={type:i.type,bootstrap:i.bootstrap||Fn,declarations:i.declarations||Fn,imports:i.imports||Fn,exports:i.exports||Fn,transitiveCompileScopes:null,schemas:i.schemas||null,id:i.id||null};return null!=i.id&&($t[i.id]=i.type),r})}function ur(i,r){if(null==i)return Tn;const o={};for(const c in i)if(i.hasOwnProperty(c)){let h=i[c],f=h;Array.isArray(h)&&(f=h[1],h=h[0]),o[h]=c,r&&(r[h]=f)}return o}const Wr=ue;function hr(i){return{type:i.type,name:i.name,factory:null,pure:!1!==i.pure,onDestroy:i.type.prototype.ngOnDestroy||null}}function Ri(i){return i[ps]||null}function tr(i,r){const o=i[Ss]||null;if(!o&&!0===r)throw new Error(`Type ${Ve(i)} does not have '\u0275mod' property.`);return o}function Pi(i){return Array.isArray(i)&&"object"==typeof i[1]}function Nn(i){return Array.isArray(i)&&!0===i[1]}function pa(i){return 0!=(8&i.flags)}function ss(i){return 2==(2&i.flags)}function Fo(i){return 1==(1&i.flags)}function Ui(i){return null!==i.template}function fr(i){return 0!=(512&i[2])}function Or(i,r){return i.hasOwnProperty($i)?i[$i]:null}class qr{constructor(r,o,c){this.previousValue=r,this.currentValue=o,this.firstChange=c}isFirstChange(){return this.firstChange}}function uo(){return xl}function xl(i){return i.type.prototype.ngOnChanges&&(i.setInput=za),Ml}function Ml(){const i=Uo(this),r=null==i?void 0:i.current;if(r){const o=i.previous;if(o===Tn)i.previous=r;else for(let c in r)o[c]=r[c];i.current=null,this.ngOnChanges(r)}}function za(i,r,o,c){const h=Uo(i)||function wl(i,r){return i[ko]=r}(i,{previous:Tn,current:null}),f=h.current||(h.current={}),x=h.previous,b=this.declaredInputs[o],C=x[b];f[b]=new qr(C&&C.currentValue,r,x===Tn),i[c]=r}uo.ngInherit=!0;const ko="__ngSimpleChanges__";function Uo(i){return i[ko]||null}const U="math";let q;function se(i){q=i}function st(i){return!!i.listen}const Yn={createRenderer:(i,r)=>function Te(){return void 0!==q?q:"undefined"!=typeof document?document:void 0}()};function en(i){for(;Array.isArray(i);)i=i[0];return i}function kn(i,r){return en(r[i])}function Pn(i,r){return en(r[i.index])}function Vi(i,r){return i.data[r]}function ai(i,r){const o=r[i];return Pi(o)?o:o[0]}function di(i){return 4==(4&i[2])}function ms(i){return 128==(128&i[2])}function as(i,r){return null==r?null:i[r]}function du(i){i[18]=0}function fi(i,r){i[5]+=r;let o=i,c=i[3];for(;null!==c&&(1===r&&1===o[5]||-1===r&&0===o[5]);)c[5]+=r,o=c,c=c[3]}const nn={lFrame:dc(null),bindingsEnabled:!0};function Sl(){return nn.bindingsEnabled}function Ue(){return nn.lFrame.lView}function an(){return nn.lFrame.tView}function Ha(i){return nn.lFrame.contextLView=i,i[8]}function Li(){let i=Cl();for(;null!==i&&64===i.type;)i=i.parent;return i}function Cl(){return nn.lFrame.currentTNode}function ys(i,r){const o=nn.lFrame;o.currentTNode=i,o.isParent=r}function Er(){return nn.lFrame.isParent}function ac(){nn.lFrame.isParent=!1}function Bo(){return nn.lFrame.bindingIndex++}function Wa(i,r){const o=nn.lFrame;o.bindingIndex=o.bindingRootIndex=i,Vo(r)}function Vo(i){nn.lFrame.currentDirectiveIndex=i}function ja(){return nn.lFrame.currentQueryIndex}function hc(i){nn.lFrame.currentQueryIndex=i}function Dl(i){const r=i[1];return 2===r.type?r.declTNode:1===r.type?i[6]:null}function $a(i,r,o){if(o&jt.SkipSelf){let h=r,f=i;for(;!(h=h.parent,null!==h||o&jt.Host||(h=Dl(f),null===h||(f=f[15],10&h.type))););if(null===h)return!1;r=h,i=f}const c=nn.lFrame=_a();return c.currentTNode=r,c.lView=i,!0}function Xa(i){const r=_a(),o=i[1];nn.lFrame=r,r.currentTNode=o.firstChild,r.lView=i,r.tView=o,r.contextLView=i,r.bindingIndex=o.bindingStartIndex,r.inI18n=!1}function _a(){const i=nn.lFrame,r=null===i?null:i.child;return null===r?dc(i):r}function dc(i){const r={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:i,child:null,inI18n:!1};return null!==i&&(i.child=r),r}function Rl(){const i=nn.lFrame;return nn.lFrame=i.parent,i.currentTNode=null,i.lView=null,i}const fc=Rl;function js(){const i=Rl();i.isParent=!0,i.tView=null,i.selectedIndex=-1,i.contextLView=null,i.elementDepthCount=0,i.currentDirectiveIndex=-1,i.currentNamespace=null,i.bindingRootIndex=-1,i.bindingIndex=-1,i.currentQueryIndex=0}function ir(){return nn.lFrame.selectedIndex}function $s(i){nn.lFrame.selectedIndex=i}function yi(){const i=nn.lFrame;return Vi(i.tView,i.selectedIndex)}function xa(){nn.lFrame.currentNamespace="svg"}function Il(){!function pr(){nn.lFrame.currentNamespace=null}()}function zo(i,r){for(let o=r.directiveStart,c=r.directiveEnd;o<c;o++){const f=i.data[o].type.prototype,{ngAfterContentInit:x,ngAfterContentChecked:b,ngAfterViewInit:C,ngAfterViewChecked:L,ngOnDestroy:N}=f;x&&(i.contentHooks||(i.contentHooks=[])).push(-o,x),b&&((i.contentHooks||(i.contentHooks=[])).push(o,b),(i.contentCheckHooks||(i.contentCheckHooks=[])).push(o,b)),C&&(i.viewHooks||(i.viewHooks=[])).push(-o,C),L&&((i.viewHooks||(i.viewHooks=[])).push(o,L),(i.viewCheckHooks||(i.viewCheckHooks=[])).push(o,L)),null!=N&&(i.destroyHooks||(i.destroyHooks=[])).push(o,N)}}function qs(i,r,o){gu(i,r,3,o)}function Ys(i,r,o,c){(3&i[2])===o&&gu(i,r,o,c)}function Pl(i,r){let o=i[2];(3&o)===r&&(o&=2047,o+=1,i[2]=o)}function gu(i,r,o,c){const f=null!=c?c:-1,x=r.length-1;let b=0;for(let C=void 0!==c?65535&i[18]:0;C<x;C++)if("number"==typeof r[C+1]){if(b=r[C],null!=c&&b>=c)break}else r[C]<0&&(i[18]+=65536),(b<f||-1==f)&&(qa(i,o,r,C),i[18]=(4294901760&i[18])+C+2),C++}function qa(i,r,o,c){const h=o[c]<0,f=o[c+1],b=i[h?-o[c]:o[c]];if(h){if(i[2]>>11<i[18]>>16&&(3&i[2])===r){i[2]+=2048;try{f.call(b)}finally{}}}else try{f.call(b)}finally{}}class Zs{constructor(r,o,c){this.factory=r,this.resolving=!1,this.canSeeViewProviders=o,this.injectImpl=c}}function Ll(i,r,o){const c=st(i);let h=0;for(;h<o.length;){const f=o[h];if("number"==typeof f){if(0!==f)break;h++;const x=o[h++],b=o[h++],C=o[h++];c?i.setAttribute(r,b,C,x):r.setAttributeNS(x,b,C)}else{const x=f,b=o[++h];vu(x)?c&&i.setProperty(r,x,b):c?i.setAttribute(r,x,b):r.setAttribute(x,b),h++}}return h}function Wo(i){return 3===i||4===i||6===i}function vu(i){return 64===i.charCodeAt(0)}function Ya(i,r){if(null!==r&&0!==r.length)if(null===i||0===i.length)i=r.slice();else{let o=-1;for(let c=0;c<r.length;c++){const h=r[c];"number"==typeof h?o=h:0===o||go(i,o,h,null,-1===o||2===o?r[++c]:null)}}return i}function go(i,r,o,c,h){let f=0,x=i.length;if(-1===r)x=-1;else for(;f<i.length;){const b=i[f++];if("number"==typeof b){if(b===r){x=-1;break}if(b>r){x=f-1;break}}}for(;f<i.length;){const b=i[f];if("number"==typeof b)break;if(b===o){if(null===c)return void(null!==h&&(i[f+1]=h));if(c===i[f+1])return void(i[f+2]=h)}f++,null!==c&&f++,null!==h&&f++}-1!==x&&(i.splice(x,0,r),f=x+1),i.splice(f++,0,o),null!==c&&i.splice(f++,0,c),null!==h&&i.splice(f++,0,h)}function wh(i){return-1!==i}function _s(i){return 32767&i}function Nr(i,r){let o=function rn(i){return i>>16}(i),c=r;for(;o>0;)c=c[15],o--;return c}let Ol=!0;function gc(i){const r=Ol;return Ol=i,r}let v=0;function A(i,r){const o=z(i,r);if(-1!==o)return o;const c=r[1];c.firstCreatePass&&(i.injectorIndex=r.length,O(c.data,i),O(r,null),O(c.blueprint,null));const h=H(i,r),f=i.injectorIndex;if(wh(h)){const x=_s(h),b=Nr(h,r),C=b[1].data;for(let L=0;L<8;L++)r[f+L]=b[x+L]|C[x+L]}return r[f+8]=h,f}function O(i,r){i.push(0,0,0,0,0,0,0,0,r)}function z(i,r){return-1===i.injectorIndex||i.parent&&i.parent.injectorIndex===i.injectorIndex||null===r[i.injectorIndex+8]?-1:i.injectorIndex}function H(i,r){if(i.parent&&-1!==i.parent.injectorIndex)return i.parent.injectorIndex;let o=0,c=null,h=r;for(;null!==h;){const f=h[1],x=f.type;if(c=2===x?f.declTNode:1===x?h[6]:null,null===c)return-1;if(o++,h=h[15],-1!==c.injectorIndex)return c.injectorIndex|o<<16}return-1}function J(i,r,o){!function y(i,r,o){let c;"string"==typeof o?c=o.charCodeAt(0)||0:o.hasOwnProperty(Us)&&(c=o[Us]),null==c&&(c=o[Us]=v++);const h=255&c;r.data[i+(h>>5)]|=1<<h}(i,r,o)}function Se(i,r,o){if(o&jt.Optional)return i;ft(r,"NodeInjector")}function et(i,r,o,c){if(o&jt.Optional&&void 0===c&&(c=null),0==(o&(jt.Self|jt.Host))){const h=i[9],f=kt(void 0);try{return h?h.get(r,c,o&jt.Optional):nt(r,c,o&jt.Optional)}finally{kt(f)}}return Se(c,r,o)}function lt(i,r,o,c=jt.Default,h){if(null!==i){const f=function ln(i){if("string"==typeof i)return i.charCodeAt(0)||0;const r=i.hasOwnProperty(Us)?i[Us]:void 0;return"number"==typeof r?r>=0?255&r:Dt:r}(o);if("function"==typeof f){if(!$a(r,i,c))return c&jt.Host?Se(h,o,c):et(r,o,c,h);try{const x=f(c);if(null!=x||c&jt.Optional)return x;ft(o)}finally{fc()}}else if("number"==typeof f){let x=null,b=z(i,r),C=-1,L=c&jt.Host?r[16][6]:null;for((-1===b||c&jt.SkipSelf)&&(C=-1===b?H(i,r):r[b+8],-1!==C&&Sr(c,!1)?(x=r[1],b=_s(C),r=Nr(C,r)):b=-1);-1!==b;){const N=r[1];if(un(f,b,N.data)){const G=Mn(b,r,o,x,c,L);if(G!==Ot)return G}C=r[b+8],-1!==C&&Sr(c,r[1].data[b+8]===L)&&un(f,b,r)?(x=N,b=_s(C),r=Nr(C,r)):b=-1}}}return et(r,o,c,h)}const Ot={};function Dt(){return new Kr(Li(),Ue())}function Mn(i,r,o,c,h,f){const x=r[1],b=x.data[i+8],N=ni(b,x,o,null==c?ss(b)&&Ol:c!=x&&0!=(3&b.type),h&jt.Host&&f===b);return null!==N?Xi(r,x,N,b):Ot}function ni(i,r,o,c,h){const f=i.providerIndexes,x=r.data,b=1048575&f,C=i.directiveStart,N=f>>20,X=h?b+N:i.directiveEnd;for(let Z=c?b:b+N;Z<X;Z++){const re=x[Z];if(Z<C&&o===re||Z>=C&&re.type===o)return Z}if(h){const Z=x[C];if(Z&&Ui(Z)&&Z.type===o)return C}return null}function Xi(i,r,o,c){let h=i[o];const f=r.data;if(function Ho(i){return i instanceof Zs}(h)){const x=h;x.resolving&&function Gt(i,r){const o=r?`. Dependency path: ${r.join(" > ")} > ${i}`:"";throw new Qe(-200,`Circular dependency in DI detected for ${i}${o}`)}(yt(f[o]));const b=gc(x.canSeeViewProviders);x.resolving=!0;const C=x.injectImpl?kt(x.injectImpl):null;$a(i,c,jt.Default);try{h=i[o]=x.factory(void 0,f,i,c),r.firstCreatePass&&o>=c.directiveStart&&function Xs(i,r,o){const{ngOnChanges:c,ngOnInit:h,ngDoCheck:f}=r.type.prototype;if(c){const x=xl(r);(o.preOrderHooks||(o.preOrderHooks=[])).push(i,x),(o.preOrderCheckHooks||(o.preOrderCheckHooks=[])).push(i,x)}h&&(o.preOrderHooks||(o.preOrderHooks=[])).push(0-i,h),f&&((o.preOrderHooks||(o.preOrderHooks=[])).push(i,f),(o.preOrderCheckHooks||(o.preOrderCheckHooks=[])).push(i,f))}(o,f[o],r)}finally{null!==C&&kt(C),gc(b),x.resolving=!1,fc()}}return h}function un(i,r,o){return!!(o[r+(i>>5)]&1<<i)}function Sr(i,r){return!(i&jt.Self||i&jt.Host&&r)}class Kr{constructor(r,o){this._tNode=r,this._lView=o}get(r,o,c){return lt(this._tNode,this._lView,r,c,o)}}function bi(i){return Di(()=>{const r=i.prototype.constructor,o=r[$i]||vc(r),c=Object.prototype;let h=Object.getPrototypeOf(i.prototype).constructor;for(;h&&h!==c;){const f=h[$i]||vc(h);if(f&&f!==o)return f;h=Object.getPrototypeOf(h)}return f=>new f})}function vc(i){return vt(i)?()=>{const r=vc(gt(i));return r&&r()}:Or(i)}function Ma(i){return function ae(i,r){if("class"===r)return i.classes;if("style"===r)return i.styles;const o=i.attrs;if(o){const c=o.length;let h=0;for(;h<c;){const f=o[h];if(Wo(f))break;if(0===f)h+=2;else if("number"==typeof f)for(h++;h<c&&"string"==typeof o[h];)h++;else{if(f===r)return o[h+1];h+=2}}}return null}(Li(),i)}const Ei="__parameters__";function Za(i,r,o){return Di(()=>{const c=function yc(i){return function(...o){if(i){const c=i(...o);for(const h in c)this[h]=c[h]}}}(r);function h(...f){if(this instanceof h)return c.apply(this,f),this;const x=new h(...f);return b.annotation=x,b;function b(C,L,N){const G=C.hasOwnProperty(Ei)?C[Ei]:Object.defineProperty(C,Ei,{value:[]})[Ei];for(;G.length<=N;)G.push(null);return(G[N]=G[N]||[]).push(x),C}}return o&&(h.prototype=Object.create(o.prototype)),h.prototype.ngMetadataName=i,h.annotationCls=h,h})}class li{constructor(r,o){this._desc=r,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof o?this.__NG_ELEMENT_ID__=o:void 0!==o&&(this.\u0275prov=Wn({token:this,providedIn:o.providedIn||"root",factory:o.factory}))}toString(){return`InjectionToken ${this._desc}`}}const xs=new li("AnalyzeForEntryComponents");function _o(i,r){void 0===r&&(r=i);for(let o=0;o<i.length;o++){let c=i[o];Array.isArray(c)?(r===i&&(r=i.slice(0,o)),_o(c,r)):r!==i&&r.push(c)}return r}function ba(i,r){i.forEach(o=>Array.isArray(o)?ba(o,r):r(o))}function gv(i,r,o){r>=i.length?i.push(o):i.splice(r,0,o)}function Zd(i,r){return r>=i.length-1?i.pop():i.splice(r,1)[0]}function Eh(i,r){const o=[];for(let c=0;c<i;c++)o.push(r);return o}function cs(i,r,o){let c=Cr(i,r);return c>=0?i[1|c]=o:(c=~c,function U_(i,r,o,c){let h=i.length;if(h==r)i.push(o,c);else if(1===h)i.push(c,i[0]),i[0]=o;else{for(h--,i.push(i[h-1],i[h]);h>r;)i[h]=i[h-2],h--;i[r]=o,i[r+1]=c}}(i,c,r,o)),c}function Yp(i,r){const o=Cr(i,r);if(o>=0)return i[1|o]}function Cr(i,r){return function xo(i,r,o){let c=0,h=i.length>>o;for(;h!==c;){const f=c+(h-c>>1),x=i[f<<o];if(r===x)return f<<o;x>r?h=f:c=f+1}return~(h<<o)}(i,r,1)}const Ea={},Ch="__NG_DI_FLAG__",Jd="ngTempTokenPath",z_=/\n/gm,xv="__source",G_=$e({provide:String,useValue:$e});let Ms;function Mc(i){const r=Ms;return Ms=i,r}function Mv(i,r=jt.Default){if(void 0===Ms)throw new Qe(203,"");return null===Ms?nt(i,void 0,r):Ms.get(i,r&jt.Optional?null:void 0,r)}function Jr(i,r=jt.Default){return(function Bn(){return cr}()||Mv)(gt(i),r)}const Kp=Jr;function Jp(i){const r=[];for(let o=0;o<i.length;o++){const c=gt(i[o]);if(Array.isArray(c)){if(0===c.length)throw new Qe(900,"");let h,f=jt.Default;for(let x=0;x<c.length;x++){const b=c[x],C=ii(b);"number"==typeof C?-1===C?h=b.token:f|=C:h=b}r.push(Jr(h,f))}else r.push(Jr(c))}return r}function ws(i,r){return i[Ch]=r,i.prototype[Ch]=r,i}function ii(i){return i[Ch]}const _u=ws(Za("Inject",i=>({token:i})),-1),Qd=ws(Za("Optional"),8),ef=ws(Za("SkipSelf"),4);var Mo=(()=>((Mo=Mo||{})[Mo.Important=1]="Important",Mo[Mo.DashCase=2]="DashCase",Mo))();const tl="__ngContext__";function Ur(i,r){i[tl]=r}function Ph(i){const r=function Nl(i){return i[tl]||null}(i);return r?Array.isArray(r)?r:r.lView:null}function of(i,r){return undefined(i,r)}function Lh(i){const r=i[3];return Nn(r)?r[3]:r}function qo(i){return Su(i[13])}function Eu(i){return Su(i[4])}function Su(i){for(;null!==i&&!Nn(i);)i=i[4];return i}function Cu(i,r,o,c,h){if(null!=c){let f,x=!1;Nn(c)?f=c:Pi(c)&&(x=!0,c=c[0]);const b=en(c);0===i&&null!==o?null==h?ol(r,o,b):Rc(r,o,b,h||null,!0):1===i&&null!==o?Rc(r,o,b,h||null,!0):2===i?function Tu(i,r,o){const c=Ic(i,r);c&&function Zo(i,r,o,c){st(i)?i.removeChild(r,o,c):r.removeChild(o)}(i,c,r,o)}(r,b,x):3===i&&r.destroyNode(b),null!=f&&function Ab(i,r,o,c,h){const f=o[7];f!==en(o)&&Cu(r,i,c,f,h);for(let b=10;b<o.length;b++){const C=o[b];cf(C[1],C,i,r,c,f)}}(r,i,f,o,h)}}function rm(i,r,o){if(st(i))return i.createElement(r,o);{const c=null!==o?function B(i){const r=i.toLowerCase();return"svg"===r?"http://www.w3.org/2000/svg":r===U?"http://www.w3.org/1998/MathML/":null}(o):null;return null===c?i.createElement(r):i.createElementNS(c,r)}}function Dc(i,r){const o=i[9],c=o.indexOf(r),h=r[3];1024&r[2]&&(r[2]&=-1025,fi(h,-1)),o.splice(c,1)}function kl(i,r){if(i.length<=10)return;const o=10+r,c=i[o];if(c){const h=c[17];null!==h&&h!==i&&Dc(h,c),r>0&&(i[o-1][4]=c[4]);const f=Zd(i,10+r);!function Ev(i,r){cf(i,r,r[11],2,null,null),r[0]=null,r[6]=null}(c[1],c);const x=f[19];null!==x&&x.detachView(f[1]),c[3]=null,c[4]=null,c[2]&=-129}return c}function om(i,r){if(!(256&r[2])){const o=r[11];st(o)&&o.destroyNode&&cf(i,r,o,3,null,null),function rl(i){let r=i[13];if(!r)return Oh(i[1],i);for(;r;){let o=null;if(Pi(r))o=r[13];else{const c=r[10];c&&(o=c)}if(!o){for(;r&&!r[4]&&r!==i;)Pi(r)&&Oh(r[1],r),r=r[3];null===r&&(r=i),Pi(r)&&Oh(r[1],r),o=r&&r[4]}r=o}}(r)}}function Oh(i,r){if(!(256&r[2])){r[2]&=-129,r[2]|=256,function lm(i,r){let o;if(null!=i&&null!=(o=i.destroyHooks))for(let c=0;c<o.length;c+=2){const h=r[o[c]];if(!(h instanceof Zs)){const f=o[c+1];if(Array.isArray(f))for(let x=0;x<f.length;x+=2){const b=h[f[x]],C=f[x+1];try{C.call(b)}finally{}}else try{f.call(h)}finally{}}}}(i,r),function am(i,r){const o=i.cleanup,c=r[7];let h=-1;if(null!==o)for(let f=0;f<o.length-1;f+=2)if("string"==typeof o[f]){const x=o[f+1],b="function"==typeof x?x(r):en(r[x]),C=c[h=o[f+2]],L=o[f+3];"boolean"==typeof L?b.removeEventListener(o[f],C,L):L>=0?c[h=L]():c[h=-L].unsubscribe(),f+=2}else{const x=c[h=o[f+1]];o[f].call(x)}if(null!==c){for(let f=h+1;f<c.length;f++)c[f]();r[7]=null}}(i,r),1===r[1].type&&st(r[11])&&r[11].destroy();const o=r[17];if(null!==o&&Nn(r[3])){o!==r[3]&&Dc(o,r);const c=r[19];null!==c&&c.detachView(i)}}}function Fh(i,r,o){return function Fs(i,r,o){let c=r;for(;null!==c&&40&c.type;)c=(r=c).parent;if(null===c)return o[0];if(2&c.flags){const h=i.data[c.directiveStart].encapsulation;if(h===is.None||h===is.Emulated)return null}return Pn(c,o)}(i,r.parent,o)}function Rc(i,r,o,c,h){st(i)?i.insertBefore(r,o,c,h):r.insertBefore(o,c,h)}function ol(i,r,o){st(i)?i.appendChild(r,o):r.appendChild(o)}function cm(i,r,o,c,h){null!==c?Rc(i,r,o,c,h):ol(i,r,o)}function Ic(i,r){return st(i)?i.parentNode(r):r.parentNode}function pt(i,r,o){return Ko(i,r,o)}let dm,Ko=function Qr(i,r,o){return 40&i.type?Pn(i,o):null};function es(i,r,o,c){const h=Fh(i,c,r),f=r[11],b=pt(c.parent||r[6],c,r);if(null!=h)if(Array.isArray(o))for(let C=0;C<o.length;C++)cm(f,h,o[C],b,!1);else cm(f,h,o,b,!1)}function Ul(i,r){if(null!==r){const o=r.type;if(3&o)return Pn(r,i);if(4&o)return qi(-1,i[r.index]);if(8&o){const c=r.child;if(null!==c)return Ul(i,c);{const h=i[r.index];return Nn(h)?qi(-1,h):en(h)}}if(32&o)return of(r,i)()||en(i[r.index]);{const c=X_(i,r);return null!==c?Array.isArray(c)?c[0]:Ul(Lh(i[16]),c):Ul(i,r.next)}}return null}function X_(i,r){return null!==r?i[16][6].projection[r.projection]:null}function qi(i,r){const o=10+i+1;if(o<r.length){const c=r[o],h=c[1].firstChild;if(null!==h)return Ul(c,h)}return r[7]}function vr(i,r,o,c,h,f,x){for(;null!=o;){const b=c[o.index],C=o.type;if(x&&0===r&&(b&&Ur(en(b),c),o.flags|=4),64!=(64&o.flags))if(8&C)vr(i,r,o.child,c,h,f,!1),Cu(r,i,h,b,f);else if(32&C){const L=of(o,c);let N;for(;N=L();)Cu(r,i,h,N,f);Cu(r,i,h,b,f)}else 16&C?q_(i,r,c,o,h,f):Cu(r,i,h,b,f);o=x?o.projectionNext:o.next}}function cf(i,r,o,c,h,f){vr(o,c,i.firstChild,r,h,f,!1)}function q_(i,r,o,c,h,f){const x=o[16],C=x[6].projection[c.projection];if(Array.isArray(C))for(let L=0;L<C.length;L++)Cu(r,i,h,C[L],f);else vr(i,r,C,x[3],h,f,!0)}function Y_(i,r,o){st(i)?i.setAttribute(r,"style",o):r.style.cssText=o}function uf(i,r,o){st(i)?""===o?i.removeAttribute(r,"class"):i.setAttribute(r,"class",o):r.className=o}function Au(i){var r;return(null===(r=function It(){if(void 0===dm&&(dm=null,jn.trustedTypes))try{dm=jn.trustedTypes.createPolicy("angular",{createHTML:i=>i,createScript:i=>i,createScriptURL:i=>i})}catch(i){}return dm}())||void 0===r?void 0:r.createHTML(i))||i}class Qs{constructor(r){this.changingThisBreaksApplicationSecurity=r}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class hf extends Qs{getTypeName(){return"HTML"}}class Tv extends Qs{getTypeName(){return"Style"}}class Ru extends Qs{getTypeName(){return"Script"}}class Iu extends Qs{getTypeName(){return"URL"}}class Pu extends Qs{getTypeName(){return"ResourceURL"}}function Qo(i){return i instanceof Qs?i.changingThisBreaksApplicationSecurity:i}function al(i,r){const o=Nh(i);if(null!=o&&o!==r){if("ResourceURL"===o&&"URL"===r)return!0;throw new Error(`Required a safe ${r}, got a ${o} (see https://g.co/ng/security#xss)`)}return o===r}function Nh(i){return i instanceof Qs&&i.getTypeName()||null}function df(i){return new hf(i)}function ff(i){return new Tv(i)}function Av(i){return new Ru(i)}function Dv(i){return new Iu(i)}function Rv(i){return new Pu(i)}class pf{constructor(r){this.inertDocumentHelper=r}getInertBodyElement(r){r="<body><remove></remove>"+r;try{const o=(new window.DOMParser).parseFromString(Au(r),"text/html").body;return null===o?this.inertDocumentHelper.getInertBodyElement(r):(o.removeChild(o.firstChild),o)}catch(o){return null}}}class Yi{constructor(r){if(this.defaultDoc=r,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const o=this.inertDocument.createElement("html");this.inertDocument.appendChild(o);const c=this.inertDocument.createElement("body");o.appendChild(c)}}getInertBodyElement(r){const o=this.inertDocument.createElement("template");if("content"in o)return o.innerHTML=Au(r),o;const c=this.inertDocument.createElement("body");return c.innerHTML=Au(r),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(c),c}stripCustomNsAttrs(r){const o=r.attributes;for(let h=o.length-1;0<h;h--){const x=o.item(h).name;("xmlns:ns1"===x||0===x.indexOf("ns1:"))&&r.removeAttribute(x)}let c=r.firstChild;for(;c;)c.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(c),c=c.nextSibling}}const mf=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,Ou=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Dr(i){return(i=String(i)).match(mf)||i.match(Ou)?i:"unsafe:"+i}function ea(i){const r={};for(const o of i.split(","))r[o]=!0;return r}function Uh(...i){const r={};for(const o of i)for(const c in o)o.hasOwnProperty(c)&&(r[c]=!0);return r}const Pv=ea("area,br,col,hr,img,wbr"),Lv=ea("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),eo=ea("rp,rt"),Bl=Uh(Pv,Uh(Lv,ea("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Uh(eo,ea("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Uh(eo,Lv)),pm=ea("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Fu=ea("srcset"),Nv=Uh(pm,Fu,ea("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),ea("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),J_=ea("script,style,template");class Vl{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(r){let o=r.firstChild,c=!0;for(;o;)if(o.nodeType===Node.ELEMENT_NODE?c=this.startElement(o):o.nodeType===Node.TEXT_NODE?this.chars(o.nodeValue):this.sanitizedSomething=!0,c&&o.firstChild)o=o.firstChild;else for(;o;){o.nodeType===Node.ELEMENT_NODE&&this.endElement(o);let h=this.checkClobberedElement(o,o.nextSibling);if(h){o=h;break}o=this.checkClobberedElement(o,o.parentNode)}return this.buf.join("")}startElement(r){const o=r.nodeName.toLowerCase();if(!Bl.hasOwnProperty(o))return this.sanitizedSomething=!0,!J_.hasOwnProperty(o);this.buf.push("<"),this.buf.push(o);const c=r.attributes;for(let h=0;h<c.length;h++){const f=c.item(h),x=f.name,b=x.toLowerCase();if(!Nv.hasOwnProperty(b)){this.sanitizedSomething=!0;continue}let C=f.value;pm[b]&&(C=Dr(C)),Fu[b]&&(i=C,C=(i=String(i)).split(",").map(r=>Dr(r.trim())).join(", ")),this.buf.push(" ",x,'="',vf(C),'"')}var i;return this.buf.push(">"),!0}endElement(r){const o=r.nodeName.toLowerCase();Bl.hasOwnProperty(o)&&!Pv.hasOwnProperty(o)&&(this.buf.push("</"),this.buf.push(o),this.buf.push(">"))}chars(r){this.buf.push(vf(r))}checkClobberedElement(r,o){if(o&&(r.compareDocumentPosition(o)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${r.outerHTML}`);return o}}const Lc=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,gf=/([^\#-~ |!])/g;function vf(i){return i.replace(/&/g,"&amp;").replace(Lc,function(r){return"&#"+(1024*(r.charCodeAt(0)-55296)+(r.charCodeAt(1)-56320)+65536)+";"}).replace(gf,function(r){return"&#"+r.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Vh;function kv(i,r){let o=null;try{Vh=Vh||function kh(i){const r=new Yi(i);return function K_(){try{return!!(new window.DOMParser).parseFromString(Au(""),"text/html")}catch(i){return!1}}()?new pf(r):r}(i);let c=r?String(r):"";o=Vh.getInertBodyElement(c);let h=5,f=c;do{if(0===h)throw new Error("Failed to sanitize html because the input is unstable");h--,c=f,f=o.innerHTML,o=Vh.getInertBodyElement(c)}while(c!==f);return Au((new Vl).sanitizeChildren(ll(o)||o))}finally{if(o){const c=ll(o)||o;for(;c.firstChild;)c.removeChild(c.firstChild)}}}function ll(i){return"content"in i&&function Q_(i){return i.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===i.nodeName}(i)?i.content:null}var rr=(()=>((rr=rr||{})[rr.NONE=0]="NONE",rr[rr.HTML=1]="HTML",rr[rr.STYLE=2]="STYLE",rr[rr.SCRIPT=3]="SCRIPT",rr[rr.URL=4]="URL",rr[rr.RESOURCE_URL=5]="RESOURCE_URL",rr))();function mm(i){const r=function zh(){const i=Ue();return i&&i[12]}();return r?r.sanitize(rr.URL,i)||"":al(i,"URL")?Qo(i):Dr(Ne(i))}function vm(i){return i.ngOriginalError}function ux(i,...r){i.error(...r)}class yf{constructor(){this._console=console}handleError(r){const o=this._findOriginalError(r),c=function cx(i){return i&&i.ngErrorLogger||ux}(r);c(this._console,"ERROR",r),o&&c(this._console,"ORIGINAL ERROR",o)}_findOriginalError(r){let o=r&&vm(r);for(;o&&vm(o);)o=vm(o);return o||null}}const vx=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(jn))();function Ca(i){return i instanceof Function?i():i}function Vv(i,r,o){let c=i.length;for(;;){const h=i.indexOf(r,o);if(-1===h)return h;if(0===h||i.charCodeAt(h-1)<=32){const f=r.length;if(h+f===c||i.charCodeAt(h+f)<=32)return h}o=h+1}}const zv="ng-template";function Mx(i,r,o){let c=0;for(;c<i.length;){let h=i[c++];if(o&&"class"===h){if(h=i[c],-1!==Vv(h.toLowerCase(),r,0))return!0}else if(1===h){for(;c<i.length&&"string"==typeof(h=i[c++]);)if(h.toLowerCase()===r)return!0;return!1}}return!1}function Hv(i){return 4===i.type&&i.value!==zv}function wx(i,r,o){return r===(4!==i.type||o?i.value:zv)}function bx(i,r,o){let c=4;const h=i.attrs||[],f=function Cx(i){for(let r=0;r<i.length;r++)if(Wo(i[r]))return r;return i.length}(h);let x=!1;for(let b=0;b<r.length;b++){const C=r[b];if("number"!=typeof C){if(!x)if(4&c){if(c=2|1&c,""!==C&&!wx(i,C,o)||""===C&&1===r.length){if(ta(c))return!1;x=!0}}else{const L=8&c?C:r[++b];if(8&c&&null!==i.attrs){if(!Mx(i.attrs,L,o)){if(ta(c))return!1;x=!0}continue}const G=Ex(8&c?"class":C,h,Hv(i),o);if(-1===G){if(ta(c))return!1;x=!0;continue}if(""!==L){let X;X=G>f?"":h[G+1].toLowerCase();const Z=8&c?X:null;if(Z&&-1!==Vv(Z,L,0)||2&c&&L!==X){if(ta(c))return!1;x=!0}}}}else{if(!x&&!ta(c)&&!ta(C))return!1;if(x&&ta(C))continue;x=!1,c=C|1&c}}return ta(c)||x}function ta(i){return 0==(1&i)}function Ex(i,r,o,c){if(null===r)return-1;let h=0;if(c||!o){let f=!1;for(;h<r.length;){const x=r[h];if(x===i)return h;if(3===x||6===x)f=!0;else{if(1===x||2===x){let b=r[++h];for(;"string"==typeof b;)b=r[++h];continue}if(4===x)break;if(0===x){h+=4;continue}}h+=f?1:2}return-1}return function Tx(i,r){let o=i.indexOf(4);if(o>-1)for(o++;o<i.length;){const c=i[o];if("number"==typeof c)return-1;if(c===r)return o;o++}return-1}(r,i)}function Gv(i,r,o=!1){for(let c=0;c<r.length;c++)if(bx(i,r[c],o))return!0;return!1}function Ax(i,r){e:for(let o=0;o<r.length;o++){const c=r[o];if(i.length===c.length){for(let h=0;h<i.length;h++)if(i[h]!==c[h])continue e;return!0}}return!1}function Wv(i,r){return i?":not("+r.trim()+")":r}function Dx(i){let r=i[0],o=1,c=2,h="",f=!1;for(;o<i.length;){let x=i[o];if("string"==typeof x)if(2&c){const b=i[++o];h+="["+x+(b.length>0?'="'+b+'"':"")+"]"}else 8&c?h+="."+x:4&c&&(h+=" "+x);else""!==h&&!ta(x)&&(r+=Wv(f,h),h=""),c=x,f=f||!ta(c);o++}return""!==h&&(r+=Wv(f,h)),r}const mn={};function jv(i){$v(an(),Ue(),ir()+i,!1)}function $v(i,r,o,c){if(!c)if(3==(3&r[2])){const f=i.preOrderCheckHooks;null!==f&&qs(r,f,o)}else{const f=i.preOrderHooks;null!==f&&Ys(r,f,0,o)}$s(o)}function _f(i,r){return i<<17|r<<2}function na(i){return i>>17&32767}function ym(i){return 2|i}function cl(i){return(131068&i)>>2}function _m(i,r){return-131069&i|r<<2}function xm(i){return 1|i}function zx(i,r){const o=i.contentQueries;if(null!==o)for(let c=0;c<o.length;c+=2){const h=o[c],f=o[c+1];if(-1!==f){const x=i.data[f];hc(h),x.contentQueries(2,r[f],f)}}}function wf(i,r,o,c,h,f,x,b,C,L){const N=r.blueprint.slice();return N[0]=h,N[2]=140|c,du(N),N[3]=N[15]=i,N[8]=o,N[10]=x||i&&i[10],N[11]=b||i&&i[11],N[12]=C||i&&i[12]||null,N[9]=L||i&&i[9]||null,N[6]=f,N[16]=2==r.type?i[16]:N,N}function Hh(i,r,o,c,h){let f=i.data[r];if(null===f)f=function ry(i,r,o,c,h){const f=Cl(),x=Er(),C=i.data[r]=function rE(i,r,o,c,h,f){return{type:o,index:c,insertBeforeIndex:null,injectorIndex:r?r.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:h,attrs:f,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:r,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,x?f:f&&f.parent,o,r,c,h);return null===i.firstChild&&(i.firstChild=C),null!==f&&(x?null==f.child&&null!==C.parent&&(f.child=C):null===f.next&&(f.next=C)),C}(i,r,o,c,h),function cc(){return nn.lFrame.inI18n}()&&(f.flags|=64);else if(64&f.type){f.type=o,f.value=c,f.attrs=h;const x=function vs(){const i=nn.lFrame,r=i.currentTNode;return i.isParent?r:r.parent}();f.injectorIndex=null===x?-1:x.injectorIndex}return ys(f,!0),f}function Gh(i,r,o,c){if(0===o)return-1;const h=r.length;for(let f=0;f<o;f++)r.push(c),i.blueprint.push(c),i.data.push(null);return h}function bf(i,r,o){Xa(r);try{const c=i.viewQuery;null!==c&&Af(1,c,o);const h=i.template;null!==h&&Hx(i,r,h,1,o),i.firstCreatePass&&(i.firstCreatePass=!1),i.staticContentQueries&&zx(i,r),i.staticViewQueries&&Af(2,i.viewQuery,o);const f=i.components;null!==f&&function tE(i,r){for(let o=0;o<r.length;o++)Qx(i,r[o])}(r,f)}catch(c){throw i.firstCreatePass&&(i.incompleteFirstPass=!0,i.firstCreatePass=!1),c}finally{r[2]&=-5,js()}}function Wh(i,r,o,c){const h=r[2];if(256!=(256&h)){Xa(r);try{du(r),function Tl(i){return nn.lFrame.bindingIndex=i}(i.bindingStartIndex),null!==o&&Hx(i,r,o,2,c);const x=3==(3&h);if(x){const L=i.preOrderCheckHooks;null!==L&&qs(r,L,null)}else{const L=i.preOrderHooks;null!==L&&Ys(r,L,0,null),Pl(r,0)}if(function fy(i){for(let r=qo(i);null!==r;r=Eu(r)){if(!r[2])continue;const o=r[9];for(let c=0;c<o.length;c++){const h=o[c],f=h[3];0==(1024&h[2])&&fi(f,1),h[2]|=1024}}}(r),function dy(i){for(let r=qo(i);null!==r;r=Eu(r))for(let o=10;o<r.length;o++){const c=r[o],h=c[1];ms(c)&&Wh(h,c,h.template,c[8])}}(r),null!==i.contentQueries&&zx(i,r),x){const L=i.contentCheckHooks;null!==L&&qs(r,L)}else{const L=i.contentHooks;null!==L&&Ys(r,L,1),Pl(r,1)}!function Qb(i,r){const o=i.hostBindingOpCodes;if(null!==o)try{for(let c=0;c<o.length;c++){const h=o[c];if(h<0)$s(~h);else{const f=h,x=o[++c],b=o[++c];Wa(x,f),b(2,r[f])}}}finally{$s(-1)}}(i,r);const b=i.components;null!==b&&function eE(i,r){for(let o=0;o<r.length;o++)Im(i,r[o])}(r,b);const C=i.viewQuery;if(null!==C&&Af(2,C,c),x){const L=i.viewCheckHooks;null!==L&&qs(r,L)}else{const L=i.viewHooks;null!==L&&Ys(r,L,2),Pl(r,2)}!0===i.firstUpdatePass&&(i.firstUpdatePass=!1),r[2]&=-73,1024&r[2]&&(r[2]&=-1025,fi(r[3],-1))}finally{js()}}}function nE(i,r,o,c){const h=r[10],x=di(r);try{!x&&h.begin&&h.begin(),x&&bf(i,r,c),Wh(i,r,o,c)}finally{!x&&h.end&&h.end()}}function Hx(i,r,o,c,h){const f=ir(),x=2&c;try{$s(-1),x&&r.length>20&&$v(i,r,20,!1),o(c,h)}finally{$s(f)}}function sy(i,r,o){!Sl()||(function Kx(i,r,o,c){const h=o.directiveStart,f=o.directiveEnd;i.firstCreatePass||A(o,r),Ur(c,r);const x=o.initialInputs;for(let b=h;b<f;b++){const C=i.data[b],L=Ui(C);L&&ku(r,o,C);const N=Xi(r,i,b,o);Ur(N,r),null!==x&&Jx(0,b-h,N,C,0,x),L&&(ai(o.index,r)[8]=N)}}(i,r,o,Pn(o,r)),128==(128&o.flags)&&function Ef(i,r,o){const c=o.directiveStart,h=o.directiveEnd,x=o.index,b=function uc(){return nn.lFrame.currentDirectiveIndex}();try{$s(x);for(let C=c;C<h;C++){const L=i.data[C],N=r[C];Vo(C),(null!==L.hostBindings||0!==L.hostVars||null!==L.hostAttrs)&&Fc(L,N)}}finally{$s(-1),Vo(b)}}(i,r,o))}function oy(i,r,o=Pn){const c=r.localNames;if(null!==c){let h=r.index+1;for(let f=0;f<c.length;f+=2){const x=c[f+1],b=-1===x?o(r,i):i[x];i[h++]=b}}}function Wx(i){const r=i.tView;return null===r||r.incompleteFirstPass?i.tView=Tm(1,null,i.template,i.decls,i.vars,i.directiveDefs,i.pipeDefs,i.viewQuery,i.schemas,i.consts):r}function Tm(i,r,o,c,h,f,x,b,C,L){const N=20+c,G=N+h,X=function iE(i,r){const o=[];for(let c=0;c<r;c++)o.push(c<i?null:mn);return o}(N,G),Z="function"==typeof L?L():L;return X[1]={type:i,blueprint:X,template:o,queries:null,viewQuery:b,declTNode:r,data:X.slice().fill(null,N),bindingStartIndex:N,expandoStartIndex:G,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof f?f():f,pipeRegistry:"function"==typeof x?x():x,firstChild:null,schemas:C,consts:Z,incompleteFirstPass:!1}}function Xx(i,r,o,c){const h=Nm(r);null===o?h.push(c):(h.push(o),i.firstCreatePass&&km(i).push(c,h.length-1))}function qx(i,r,o){for(let c in i)if(i.hasOwnProperty(c)){const h=i[c];(o=null===o?{}:o).hasOwnProperty(c)?o[c].push(r,h):o[c]=[r,h]}return o}function Am(i,r,o,c){let h=!1;if(Sl()){const f=function ly(i,r,o){const c=i.directiveRegistry;let h=null;if(c)for(let f=0;f<c.length;f++){const x=c[f];Gv(o,x.selectors,!1)&&(h||(h=[]),J(A(o,r),i,x.type),Ui(x)?(Hl(i,o),h.unshift(x)):h.push(x))}return h}(i,r,o),x=null===c?null:{"":-1};if(null!==f){h=!0,Sf(o,i.data.length,f.length);for(let N=0;N<f.length;N++){const G=f[N];G.providersResolver&&G.providersResolver(G)}let b=!1,C=!1,L=Gh(i,r,f.length,null);for(let N=0;N<f.length;N++){const G=f[N];o.mergedAttrs=Ya(o.mergedAttrs,G.hostAttrs),Gl(i,o,r,L,G),cy(L,G,x),null!==G.contentQueries&&(o.flags|=8),(null!==G.hostBindings||null!==G.hostAttrs||0!==G.hostVars)&&(o.flags|=128);const X=G.type.prototype;!b&&(X.ngOnChanges||X.ngOnInit||X.ngDoCheck)&&((i.preOrderHooks||(i.preOrderHooks=[])).push(o.index),b=!0),!C&&(X.ngOnChanges||X.ngDoCheck)&&((i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(o.index),C=!0),L++}!function sE(i,r){const c=r.directiveEnd,h=i.data,f=r.attrs,x=[];let b=null,C=null;for(let L=r.directiveStart;L<c;L++){const N=h[L],G=N.inputs,X=null===f||Hv(r)?null:uy(G,f);x.push(X),b=qx(G,L,b),C=qx(N.outputs,L,C)}null!==b&&(b.hasOwnProperty("class")&&(r.flags|=16),b.hasOwnProperty("style")&&(r.flags|=32)),r.initialInputs=x,r.inputs=b,r.outputs=C}(i,o)}x&&function Dm(i,r,o){if(r){const c=i.localNames=[];for(let h=0;h<r.length;h+=2){const f=o[r[h+1]];if(null==f)throw new Qe(-301,!1);c.push(r[h],f)}}}(o,c,x)}return o.mergedAttrs=Ya(o.mergedAttrs,o.attrs),h}function ay(i,r,o,c,h,f){const x=f.hostBindings;if(x){let b=i.hostBindingOpCodes;null===b&&(b=i.hostBindingOpCodes=[]);const C=~r.index;(function Zx(i){let r=i.length;for(;r>0;){const o=i[--r];if("number"==typeof o&&o<0)return o}return 0})(b)!=C&&b.push(C),b.push(c,h,x)}}function Fc(i,r){null!==i.hostBindings&&i.hostBindings(1,r)}function Hl(i,r){r.flags|=2,(i.components||(i.components=[])).push(r.index)}function cy(i,r,o){if(o){if(r.exportAs)for(let c=0;c<r.exportAs.length;c++)o[r.exportAs[c]]=i;Ui(r)&&(o[""]=i)}}function Sf(i,r,o){i.flags|=1,i.directiveStart=r,i.directiveEnd=r+o,i.providerIndexes=r}function Gl(i,r,o,c,h){i.data[c]=h;const f=h.factory||(h.factory=Or(h.type)),x=new Zs(f,Ui(h),null);i.blueprint[c]=x,o[c]=x,ay(i,r,0,c,Gh(i,o,h.hostVars,mn),h)}function ku(i,r,o){const c=Pn(r,i),h=Wx(o),f=i[10],x=Tf(i,wf(i,h,null,o.onPush?64:16,c,r,f,f.createRenderer(c,o),null,null));i[r.index]=x}function ia(i,r,o,c,h,f){const x=Pn(i,r);!function Cf(i,r,o,c,h,f,x){if(null==f)st(i)?i.removeAttribute(r,h,o):r.removeAttribute(h);else{const b=null==x?Ne(f):x(f,c||"",h);st(i)?i.setAttribute(r,h,b,o):o?r.setAttributeNS(o,h,b):r.setAttribute(h,b)}}(r[11],x,f,i.value,o,c,h)}function Jx(i,r,o,c,h,f){const x=f[r];if(null!==x){const b=c.setInput;for(let C=0;C<x.length;){const L=x[C++],N=x[C++],G=x[C++];null!==b?c.setInput(o,G,L,N):o[N]=G}}}function uy(i,r){let o=null,c=0;for(;c<r.length;){const h=r[c];if(0!==h)if(5!==h){if("number"==typeof h)break;i.hasOwnProperty(h)&&(null===o&&(o=[]),o.push(h,i[h],r[c+1])),c+=2}else c+=2;else c+=4}return o}function hy(i,r,o,c){return new Array(i,!0,!1,r,null,0,c,o,null,null)}function Im(i,r){const o=ai(r,i);if(ms(o)){const c=o[1];80&o[2]?Wh(c,o,c.template,o[8]):o[5]>0&&Pm(o)}}function Pm(i){for(let c=qo(i);null!==c;c=Eu(c))for(let h=10;h<c.length;h++){const f=c[h];if(1024&f[2]){const x=f[1];Wh(x,f,x.template,f[8])}else f[5]>0&&Pm(f)}const o=i[1].components;if(null!==o)for(let c=0;c<o.length;c++){const h=ai(o[c],i);ms(h)&&h[5]>0&&Pm(h)}}function Qx(i,r){const o=ai(r,i),c=o[1];(function eM(i,r){for(let o=r.length;o<i.blueprint.length;o++)r.push(i.blueprint[o])})(c,o),bf(c,o,o[8])}function Tf(i,r){return i[13]?i[14][4]=r:i[13]=r,i[14]=r,r}function Lm(i){for(;i;){i[2]|=64;const r=Lh(i);if(fr(i)&&!r)return i;i=r}return null}function py(i){!function Om(i){for(let r=0;r<i.components.length;r++){const o=i.components[r],c=Ph(o),h=c[1];nE(h,c,h.template,o)}}(i[8])}function Af(i,r,o){hc(0),r(i,o)}const my=(()=>Promise.resolve(null))();function Nm(i){return i[7]||(i[7]=[])}function km(i){return i.cleanup||(i.cleanup=[])}function Bm(i,r){const o=i[9],c=o?o.get(yf,null):null;c&&c.handleError(r)}function Nc(i,r,o,c,h){for(let f=0;f<o.length;){const x=o[f++],b=o[f++],C=r[x],L=i.data[x];null!==L.setInput?L.setInput(C,h,c,b):C[b]=h}}function _i(i,r,o){const c=kn(r,i);!function im(i,r,o){st(i)?i.setValue(r,o):r.textContent=o}(i[11],c,o)}function Zi(i,r,o){let c=o?i.styles:null,h=o?i.classes:null,f=0;if(null!==r)for(let x=0;x<r.length;x++){const b=r[x];"number"==typeof b?f=b:1==f?h=Yt(h,b):2==f&&(c=Yt(c,b+": "+r[++x]+";"))}o?i.styles=c:i.stylesWithoutHost=c,o?i.classes=h:i.classesWithoutHost=h}const Vm=new li("INJECTOR",-1);class gy{get(r,o=Ea){if(o===Ea){const c=new Error(`NullInjectorError: No provider for ${Ve(r)}!`);throw c.name="NullInjectorError",c}return o}}const zm=new li("Set Injector scope."),$h={},oM={};let Hm;function vy(){return void 0===Hm&&(Hm=new gy),Hm}function yy(i,r=null,o=null,c){const h=_y(i,r,o,c);return h._resolveInjectorDefTypes(),h}function _y(i,r=null,o=null,c){return new aM(i,o,r||vy(),c)}class aM{constructor(r,o,c,h=null){this.parent=c,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const f=[];o&&ba(o,b=>this.processProvider(b,r,o)),ba([r],b=>this.processInjectorType(b,[],f)),this.records.set(Vm,Uu(void 0,this));const x=this.records.get(zm);this.scope=null!=x?x.value:null,this.source=h||("object"==typeof r?null:Ve(r))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(r=>r.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(r,o=Ea,c=jt.Default){this.assertNotDestroyed();const h=Mc(this),f=kt(void 0);try{if(!(c&jt.SkipSelf)){let b=this.records.get(r);if(void 0===b){const C=function mM(i){return"function"==typeof i||"object"==typeof i&&i instanceof li}(r)&&Hr(r);b=C&&this.injectableDefInScope(C)?Uu(Gm(r),$h):null,this.records.set(r,b)}if(null!=b)return this.hydrate(r,b)}return(c&jt.Self?vy():this.parent).get(r,o=c&jt.Optional&&o===Ea?null:o)}catch(x){if("NullInjectorError"===x.name){if((x[Jd]=x[Jd]||[]).unshift(Ve(r)),h)throw x;return function W_(i,r,o,c){const h=i[Jd];throw r[xv]&&h.unshift(r[xv]),i.message=function bc(i,r,o,c=null){i=i&&"\n"===i.charAt(0)&&"\u0275"==i.charAt(1)?i.substr(2):i;let h=Ve(r);if(Array.isArray(r))h=r.map(Ve).join(" -> ");else if("object"==typeof r){let f=[];for(let x in r)if(r.hasOwnProperty(x)){let b=r[x];f.push(x+":"+("string"==typeof b?JSON.stringify(b):Ve(b)))}h=`{${f.join(", ")}}`}return`${o}${c?"("+c+")":""}[${h}]: ${i.replace(z_,"\n  ")}`}("\n"+i.message,h,o,c),i.ngTokenPath=h,i[Jd]=null,i}(x,r,"R3InjectorError",this.source)}throw x}finally{kt(f),Mc(h)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(r=>this.get(r))}toString(){const r=[];return this.records.forEach((c,h)=>r.push(Ve(h))),`R3Injector[${r.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Qe(205,!1)}processInjectorType(r,o,c){if(!(r=gt(r)))return!1;let h=ks(r);const f=null==h&&r.ngModule||void 0,x=void 0===f?r:f,b=-1!==c.indexOf(x);if(void 0!==f&&(h=ks(f)),null==h)return!1;if(null!=h.imports&&!b){let N;c.push(x);try{ba(h.imports,G=>{this.processInjectorType(G,o,c)&&(void 0===N&&(N=[]),N.push(G))})}finally{}if(void 0!==N)for(let G=0;G<N.length;G++){const{ngModule:X,providers:Z}=N[G];ba(Z,re=>this.processProvider(re,X,Z||Fn))}}this.injectorDefTypes.add(x);const C=Or(x)||(()=>new x);this.records.set(x,Uu(C,$h));const L=h.providers;if(null!=L&&!b){const N=r;ba(L,G=>this.processProvider(G,N,L))}return void 0!==f&&void 0!==r.providers}processProvider(r,o,c){let h=Bu(r=gt(r))?r:gt(r&&r.provide);const f=function cM(i,r,o){return My(i)?Uu(void 0,i.useValue):Uu(xy(i),$h)}(r);if(Bu(r)||!0!==r.multi)this.records.get(h);else{let x=this.records.get(h);x||(x=Uu(void 0,$h,!0),x.factory=()=>Jp(x.multi),this.records.set(h,x)),h=r,x.multi.push(r)}this.records.set(h,f)}hydrate(r,o){return o.value===$h&&(o.value=oM,o.value=o.factory()),"object"==typeof o.value&&o.value&&function pM(i){return null!==i&&"object"==typeof i&&"function"==typeof i.ngOnDestroy}(o.value)&&this.onDestroy.add(o.value),o.value}injectableDefInScope(r){if(!r.providedIn)return!1;const o=gt(r.providedIn);return"string"==typeof o?"any"===o||o===this.scope:this.injectorDefTypes.has(o)}}function Gm(i){const r=Hr(i),o=null!==r?r.factory:Or(i);if(null!==o)return o;if(i instanceof li)throw new Qe(204,!1);if(i instanceof Function)return function lM(i){const r=i.length;if(r>0)throw Eh(r,"?"),new Qe(204,!1);const o=function nc(i){const r=i&&(i[oo]||i[ha]);if(r){const o=function Ci(i){if(i.hasOwnProperty("name"))return i.name;const r=(""+i).match(/^function\s*([^\s(]+)/);return null===r?"":r[1]}(i);return console.warn(`DEPRECATED: DI is instantiating a token "${o}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${o}" class.`),r}return null}(i);return null!==o?()=>o.factory(i):()=>new i}(i);throw new Qe(204,!1)}function xy(i,r,o){let c;if(Bu(i)){const h=gt(i);return Or(h)||Gm(h)}if(My(i))c=()=>gt(i.useValue);else if(function hM(i){return!(!i||!i.useFactory)}(i))c=()=>i.useFactory(...Jp(i.deps||[]));else if(function uM(i){return!(!i||!i.useExisting)}(i))c=()=>Jr(gt(i.useExisting));else{const h=gt(i&&(i.useClass||i.provide));if(!function fM(i){return!!i.deps}(i))return Or(h)||Gm(h);c=()=>new h(...Jp(i.deps))}return c}function Uu(i,r,o=!1){return{factory:i,value:r,multi:o?[]:void 0}}function My(i){return null!==i&&"object"==typeof i&&G_ in i}function Bu(i){return"function"==typeof i}let Ta=(()=>{class i{static create(o,c){var h;if(Array.isArray(o))return yy({name:""},c,o,"");{const f=null!==(h=o.name)&&void 0!==h?h:"";return yy({name:f},o.parent,o.providers,f)}}}return i.THROW_IF_NOT_FOUND=Ea,i.NULL=new gy,i.\u0275prov=Wn({token:i,providedIn:"any",factory:()=>Jr(Vm)}),i.__NG_ELEMENT_ID__=-1,i})();function wM(i,r){zo(Ph(i)[1],Li())}function Zm(i){let r=function Iy(i){return Object.getPrototypeOf(i.prototype).constructor}(i.type),o=!0;const c=[i];for(;r;){let h;if(Ui(i))h=r.\u0275cmp||r.\u0275dir;else{if(r.\u0275cmp)throw new Qe(903,"");h=r.\u0275dir}if(h){if(o){c.push(h);const x=i;x.inputs=Rf(i.inputs),x.declaredInputs=Rf(i.declaredInputs),x.outputs=Rf(i.outputs);const b=h.hostBindings;b&&Km(i,b);const C=h.viewQuery,L=h.contentQueries;if(C&&Py(i,C),L&&bM(i,L),In(i.inputs,h.inputs),In(i.declaredInputs,h.declaredInputs),In(i.outputs,h.outputs),Ui(h)&&h.data.animation){const N=i.data;N.animation=(N.animation||[]).concat(h.data.animation)}}const f=h.features;if(f)for(let x=0;x<f.length;x++){const b=f[x];b&&b.ngInherit&&b(i),b===Zm&&(o=!1)}}r=Object.getPrototypeOf(r)}!function Xh(i){let r=0,o=null;for(let c=i.length-1;c>=0;c--){const h=i[c];h.hostVars=r+=h.hostVars,h.hostAttrs=Ya(h.hostAttrs,o=Ya(o,h.hostAttrs))}}(c)}function Rf(i){return i===Tn?{}:i===Fn?[]:i}function Py(i,r){const o=i.viewQuery;i.viewQuery=o?(c,h)=>{r(c,h),o(c,h)}:r}function bM(i,r){const o=i.contentQueries;i.contentQueries=o?(c,h,f)=>{r(c,h,f),o(c,h,f)}:r}function Km(i,r){const o=i.hostBindings;i.hostBindings=o?(c,h)=>{r(c,h),o(c,h)}:r}let qh=null;function Vu(){if(!qh){const i=jn.Symbol;if(i&&i.iterator)qh=i.iterator;else{const r=Object.getOwnPropertyNames(Map.prototype);for(let o=0;o<r.length;++o){const c=r[o];"entries"!==c&&"size"!==c&&Map.prototype[c]===Map.prototype.entries&&(qh=c)}}}return qh}function Yh(i){return!!Jm(i)&&(Array.isArray(i)||!(i instanceof Map)&&Vu()in i)}function Jm(i){return null!==i&&("function"==typeof i||"object"==typeof i)}function hs(i,r,o){return!Object.is(i[r],o)&&(i[r]=o,!0)}function Qm(i,r,o,c){const h=Ue();return hs(h,Bo(),r)&&(an(),ia(yi(),h,i,r,o,c)),Qm}function Vy(i,r,o,c,h,f,x,b){const C=Ue(),L=an(),N=i+20,G=L.firstCreatePass?function DM(i,r,o,c,h,f,x,b,C){const L=r.consts,N=Hh(r,i,4,x||null,as(L,b));Am(r,o,N,as(L,C)),zo(r,N);const G=N.tViews=Tm(2,N,c,h,f,r.directiveRegistry,r.pipeRegistry,null,r.schemas,L);return null!==r.queries&&(r.queries.template(r,N),G.queries=r.queries.embeddedTView(N)),N}(N,L,C,r,o,c,h,f,x):L.data[N];ys(G,!1);const X=C[11].createComment("");es(L,C,X,G),Ur(X,C),Tf(C,C[N]=hy(X,C,X,G)),Fo(G)&&sy(L,C,G),null!=x&&oy(C,G,b)}function Yu(i,r=jt.Default){const o=Ue();return null===o?Jr(i,r):lt(Li(),o,gt(i),r)}function ld(){throw new Error("invalid")}function Hc(i,r,o){const c=Ue();return hs(c,Bo(),r)&&function bo(i,r,o,c,h,f,x,b){const C=Pn(r,o);let N,L=r.inputs;!b&&null!=L&&(N=L[c])?(Nc(i,o,N,c,h),ss(r)&&function aE(i,r){const o=ai(r,i);16&o[2]||(o[2]|=64)}(o,r.index)):3&r.type&&(c=function oE(i){return"class"===i?"className":"for"===i?"htmlFor":"formaction"===i?"formAction":"innerHtml"===i?"innerHTML":"readonly"===i?"readOnly":"tabindex"===i?"tabIndex":i}(c),h=null!=x?x(h,r.value||"",c):h,st(f)?f.setProperty(C,c,h):vu(c)||(C.setProperty?C.setProperty(c,h):C[c]=h))}(an(),yi(),c,i,r,c[11],o,!1),Hc}function kf(i,r,o,c,h){const x=h?"class":"style";Nc(i,o,r.inputs[x],x,c)}function Gc(i,r,o,c){const h=Ue(),f=an(),x=20+i,b=h[11],C=h[x]=rm(b,r,function mu(){return nn.lFrame.currentNamespace}()),L=f.firstCreatePass?function UM(i,r,o,c,h,f,x){const b=r.consts,L=Hh(r,i,2,h,as(b,f));return Am(r,o,L,as(b,x)),null!==L.attrs&&Zi(L,L.attrs,!1),null!==L.mergedAttrs&&Zi(L,L.mergedAttrs,!0),null!==r.queries&&r.queries.elementStart(r,L),L}(x,f,h,0,r,o,c):f.data[x];ys(L,!0);const N=L.mergedAttrs;null!==N&&Ll(b,C,N);const G=L.classes;null!==G&&uf(b,C,G);const X=L.styles;return null!==X&&Y_(b,C,X),64!=(64&L.flags)&&es(f,h,C,L),0===function Wd(){return nn.lFrame.elementDepthCount}()&&Ur(C,h),function ho(){nn.lFrame.elementDepthCount++}(),Fo(L)&&(sy(f,h,L),function Gx(i,r,o){if(pa(r)){const h=r.directiveEnd;for(let f=r.directiveStart;f<h;f++){const x=i.data[f];x.contentQueries&&x.contentQueries(1,o[f],f)}}}(f,L,h)),null!==c&&oy(h,L),Gc}function Wl(){let i=Li();Er()?ac():(i=i.parent,ys(i,!1));const r=i;!function fo(){nn.lFrame.elementDepthCount--}();const o=an();return o.firstCreatePass&&(zo(o,i),pa(i)&&o.queries.elementEnd(i)),null!=r.classesWithoutHost&&function mc(i){return 0!=(16&i.flags)}(r)&&kf(o,r,Ue(),r.classesWithoutHost,!0),null!=r.stylesWithoutHost&&function Mh(i){return 0!=(32&i.flags)}(r)&&kf(o,r,Ue(),r.stylesWithoutHost,!1),Wl}function jl(i,r,o,c){return Gc(i,r,o,c),Wl(),jl}function Ku(){return Ue()}function ug(i){return!!i&&"function"==typeof i.then}function Es(i){return!!i&&"function"==typeof i.subscribe}const hg=Es;function Vf(i,r,o,c){const h=Ue(),f=an(),x=Li();return function cd(i,r,o,c,h,f,x,b){const C=Fo(c),N=i.firstCreatePass&&km(i),G=r[8],X=Nm(r);let Z=!0;if(3&c.type||b){const ie=Pn(c,r),de=b?b(ie):ie,he=X.length,be=b?Pe=>b(en(Pe[c.index])):c.index;if(st(o)){let Pe=null;if(!b&&C&&(Pe=function fg(i,r,o,c){const h=i.cleanup;if(null!=h)for(let f=0;f<h.length-1;f+=2){const x=h[f];if(x===o&&h[f+1]===c){const b=r[7],C=h[f+2];return b.length>C?b[C]:null}"string"==typeof x&&(f+=2)}return null}(i,r,h,c.index)),null!==Pe)(Pe.__ngLastListenerFn__||Pe).__ngNextListenerFn__=f,Pe.__ngLastListenerFn__=f,Z=!1;else{f=zf(c,r,G,f,!1);const ot=o.listen(de,h,f);X.push(f,ot),N&&N.push(h,be,he,he+1)}}else f=zf(c,r,G,f,!0),de.addEventListener(h,f,x),X.push(f),N&&N.push(h,be,he,x)}else f=zf(c,r,G,f,!1);const re=c.outputs;let ce;if(Z&&null!==re&&(ce=re[h])){const ie=ce.length;if(ie)for(let de=0;de<ie;de+=2){const St=r[ce[de]][ce[de+1]].subscribe(f),Pt=X.length;X.push(f,St),N&&N.push(h,c.index,Pt,-(Pt+1))}}}(f,h,h[11],x,i,r,!!o,c),Vf}function Wc(i,r,o,c){try{return!1!==o(c)}catch(h){return Bm(i,h),!1}}function zf(i,r,o,c,h){return function f(x){if(x===Function)return c;const b=2&i.flags?ai(i.index,r):r;0==(32&r[2])&&Lm(b);let C=Wc(r,0,c,x),L=f.__ngNextListenerFn__;for(;L;)C=Wc(r,0,L,x)&&C,L=L.__ngNextListenerFn__;return h&&!1===C&&(x.preventDefault(),x.returnValue=!1),C}}function pg(i=1){return function pc(i){return(nn.lFrame.contextLView=function fu(i,r){for(;i>0;)r=r[15],i--;return r}(i,nn.lFrame.contextLView))[8]}(i)}function Hf(i,r){let o=null;const c=function Sx(i){const r=i.attrs;if(null!=r){const o=r.indexOf(5);if(0==(1&o))return r[o+1]}return null}(i);for(let h=0;h<r.length;h++){const f=r[h];if("*"!==f){if(null===c?Gv(i,f,!0):Ax(c,f))return h}else o=h}return o}function Zy(i){const r=Ue()[16][6];if(!r.projection){const c=r.projection=Eh(i?i.length:1,null),h=c.slice();let f=r.child;for(;null!==f;){const x=i?Hf(f,i):0;null!==x&&(h[x]?h[x].projectionNext=f:c[x]=f,h[x]=f),f=f.next}}}function mg(i,r=0,o){const c=Ue(),h=an(),f=Hh(h,20+i,16,null,o||null);null===f.projection&&(f.projection=r),ac(),64!=(64&f.flags)&&function Tb(i,r,o){q_(r[11],0,r,o,Fh(i,o,r),pt(o.parent||r[6],o,r))}(h,c,f)}function Gf(i,r,o,c,h){const f=i[o+1],x=null===r;let b=c?na(f):cl(f),C=!1;for(;0!==b&&(!1===C||x);){const N=i[b+1];GM(i[b],r)&&(C=!0,i[b+1]=c?xm(N):ym(N)),b=c?na(N):cl(N)}C&&(i[o+1]=c?ym(f):xm(f))}function GM(i,r){return null===i||null==r||(Array.isArray(i)?i[1]:i)===r||!(!Array.isArray(i)||"string"!=typeof r)&&Cr(i,r)>=0}function jf(i,r){return function Co(i,r,o,c){const h=Ue(),f=an(),x=function Yr(i){const r=nn.lFrame,o=r.bindingIndex;return r.bindingIndex=r.bindingIndex+i,o}(2);f.firstUpdatePass&&function n0(i,r,o,c){const h=i.data;if(null===h[o+1]){const f=h[ir()],x=function $f(i,r){return r>=i.expandoStartIndex}(i,o);(function Yc(i,r){return 0!=(i.flags&(r?16:32))})(f,c)&&null===r&&!x&&(r=!1),r=function Xf(i,r,o,c){const h=function Al(i){const r=nn.lFrame.currentDirectiveIndex;return-1===r?null:i[r]}(i);let f=c?r.residualClasses:r.residualStyles;if(null===h)0===(c?r.classBindings:r.styleBindings)&&(o=$c(o=jc(null,i,r,o,c),r.attrs,c),f=null);else{const x=r.directiveStylingLast;if(-1===x||i[x]!==h)if(o=jc(h,i,r,o,c),null===f){let C=function qf(i,r,o){const c=o?r.classBindings:r.styleBindings;if(0!==cl(c))return i[na(c)]}(i,r,c);void 0!==C&&Array.isArray(C)&&(C=jc(null,i,r,C[1],c),C=$c(C,r.attrs,c),function wg(i,r,o,c){i[na(o?r.classBindings:r.styleBindings)]=c}(i,r,c,C))}else f=function bg(i,r,o){let c;const h=r.directiveEnd;for(let f=1+r.directiveStylingLast;f<h;f++)c=$c(c,i[f].hostAttrs,o);return $c(c,r.attrs,o)}(i,r,c)}return void 0!==f&&(c?r.residualClasses=f:r.residualStyles=f),o}(h,f,r,c),function gE(i,r,o,c,h,f){let x=f?r.classBindings:r.styleBindings,b=na(x),C=cl(x);i[c]=o;let N,L=!1;if(Array.isArray(o)){const G=o;N=G[1],(null===N||Cr(G,N)>0)&&(L=!0)}else N=o;if(h)if(0!==C){const X=na(i[b+1]);i[c+1]=_f(X,b),0!==X&&(i[X+1]=_m(i[X+1],c)),i[b+1]=function Px(i,r){return 131071&i|r<<17}(i[b+1],c)}else i[c+1]=_f(b,0),0!==b&&(i[b+1]=_m(i[b+1],c)),b=c;else i[c+1]=_f(C,0),0===b?b=c:i[C+1]=_m(i[C+1],c),C=c;L&&(i[c+1]=ym(i[c+1])),Gf(i,N,c,!0),Gf(i,N,c,!1),function ra(i,r,o,c,h){const f=h?i.residualClasses:i.residualStyles;null!=f&&"string"==typeof r&&Cr(f,r)>=0&&(o[c+1]=xm(o[c+1]))}(r,N,i,c,f),x=_f(b,C),f?r.classBindings=x:r.styleBindings=x}(h,f,r,o,x,c)}}(f,i,x,c),r!==mn&&hs(h,x,r)&&function md(i,r,o,c,h,f,x,b){if(!(3&r.type))return;const C=i.data,L=C[b+1];qc(function Yv(i){return 1==(1&i)}(L)?Kf(C,r,o,h,cl(L),x):void 0)||(qc(f)||function qv(i){return 2==(2&i)}(L)&&(f=Kf(C,null,o,h,b,x)),function hm(i,r,o,c,h){const f=st(i);if(r)h?f?i.addClass(o,c):o.classList.add(c):f?i.removeClass(o,c):o.classList.remove(c);else{let x=-1===c.indexOf("-")?void 0:Mo.DashCase;if(null==h)f?i.removeStyle(o,c,x):o.style.removeProperty(c);else{const b="string"==typeof h&&h.endsWith("!important");b&&(h=h.slice(0,-10),x|=Mo.Important),f?i.setStyle(o,c,h,x):o.style.setProperty(c,h,b?"important":"")}}}(c,x,kn(ir(),o),h,f))}(f,f.data[ir()],h,h[11],i,h[x+1]=function r0(i,r){return null==i||("string"==typeof r?i+=r:"object"==typeof i&&(i=Ve(Qo(i)))),i}(r,o),c,x)}(i,r,null,!0),jf}function jc(i,r,o,c,h){let f=null;const x=o.directiveEnd;let b=o.directiveStylingLast;for(-1===b?b=o.directiveStart:b++;b<x&&(f=r[b],c=$c(c,f.hostAttrs,h),f!==i);)b++;return null!==i&&(o.directiveStylingLast=b),c}function $c(i,r,o){const c=o?1:2;let h=-1;if(null!==r)for(let f=0;f<r.length;f++){const x=r[f];"number"==typeof x?h=x:h===c&&(Array.isArray(i)||(i=void 0===i?[]:["",i]),cs(i,x,!!o||r[++f]))}return void 0===i?null:i}function Kf(i,r,o,c,h,f){const x=null===r;let b;for(;h>0;){const C=i[h],L=Array.isArray(C),N=L?C[1]:C,G=null===N;let X=o[h+1];X===mn&&(X=G?Fn:void 0);let Z=G?Yp(X,c):N===c?X:void 0;if(L&&!qc(Z)&&(Z=Yp(C,c)),qc(Z)&&(b=Z,x))return b;const re=i[h+1];h=x?na(re):cl(re)}if(null!==r){let C=f?r.residualClasses:r.residualStyles;null!=C&&(b=Yp(C,c))}return b}function qc(i){return void 0!==i}function s0(i,r=""){const o=Ue(),c=an(),h=i+20,f=c.firstCreatePass?Hh(c,h,1,r,null):c.data[h],x=o[h]=function lf(i,r){return st(i)?i.createText(r):i.createTextNode(r)}(o[11],r);es(c,o,x,f),ys(f,!1)}function Jf(i){return hl("",i,""),Jf}function hl(i,r,o){const c=Ue(),h=function Uc(i,r,o,c){return hs(i,Bo(),o)?r+Ne(o)+c:mn}(c,i,r,o);return h!==mn&&_i(c,ir(),h),hl}const dl=void 0;var nw=["en",[["a","p"],["AM","PM"],dl],[["AM","PM"],dl,dl],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],dl,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],dl,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",dl,"{1} 'at' {0}",dl],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function Tg(i){const o=Math.floor(Math.abs(i)),c=i.toString().replace(/^[^.]*\.?/,"").length;return 1===o&&0===c?1:5}];let Ao={};function yd(i){const r=function rw(i){return i.toLowerCase().replace(/_/g,"-")}(i);let o=M0(r);if(o)return o;const c=r.split("-")[0];if(o=M0(c),o)return o;if("en"===c)return nw;throw new Error(`Missing locale data for the locale "${i}".`)}function sp(i){return yd(i)[tn.PluralCase]}function M0(i){return i in Ao||(Ao[i]=jn.ng&&jn.ng.common&&jn.ng.common.locales&&jn.ng.common.locales[i]),Ao[i]}var tn=(()=>((tn=tn||{})[tn.LocaleId=0]="LocaleId",tn[tn.DayPeriodsFormat=1]="DayPeriodsFormat",tn[tn.DayPeriodsStandalone=2]="DayPeriodsStandalone",tn[tn.DaysFormat=3]="DaysFormat",tn[tn.DaysStandalone=4]="DaysStandalone",tn[tn.MonthsFormat=5]="MonthsFormat",tn[tn.MonthsStandalone=6]="MonthsStandalone",tn[tn.Eras=7]="Eras",tn[tn.FirstDayOfWeek=8]="FirstDayOfWeek",tn[tn.WeekendRange=9]="WeekendRange",tn[tn.DateFormat=10]="DateFormat",tn[tn.TimeFormat=11]="TimeFormat",tn[tn.DateTimeFormat=12]="DateTimeFormat",tn[tn.NumberSymbols=13]="NumberSymbols",tn[tn.NumberFormats=14]="NumberFormats",tn[tn.CurrencyCode=15]="CurrencyCode",tn[tn.CurrencySymbol=16]="CurrencySymbol",tn[tn.CurrencyName=17]="CurrencyName",tn[tn.Currencies=18]="Currencies",tn[tn.Directionality=19]="Directionality",tn[tn.PluralCase=20]="PluralCase",tn[tn.ExtraData=21]="ExtraData",tn))();const op="en-US";let w0=op;function pl(i,r,o,c,h){if(i=gt(i),Array.isArray(i))for(let f=0;f<i.length;f++)pl(i[f],r,o,c,h);else{const f=an(),x=Ue();let b=Bu(i)?i:gt(i.provide),C=xy(i);const L=Li(),N=1048575&L.providerIndexes,G=L.directiveStart,X=L.providerIndexes>>20;if(Bu(i)||!i.multi){const Z=new Zs(C,h,Yu),re=ml(b,r,h?N:N+X,G);-1===re?(J(A(L,x),f,b),gp(f,i,r.length),r.push(b),L.directiveStart++,L.directiveEnd++,h&&(L.providerIndexes+=1048576),o.push(Z),x.push(Z)):(o[re]=Z,x[re]=Z)}else{const Z=ml(b,r,N+X,G),re=ml(b,r,N,N+X),ce=Z>=0&&o[Z],ie=re>=0&&o[re];if(h&&!ie||!h&&!ce){J(A(L,x),f,b);const de=function Hg(i,r,o,c,h){const f=new Zs(i,o,Yu);return f.multi=[],f.index=r,f.componentProviders=0,V0(f,h,c&&!o),f}(h?DE:AE,o.length,h,c,C);!h&&ie&&(o[re].providerFactory=de),gp(f,i,r.length,0),r.push(b),L.directiveStart++,L.directiveEnd++,h&&(L.providerIndexes+=1048576),o.push(de),x.push(de)}else gp(f,i,Z>-1?Z:re,V0(o[h?re:Z],C,!h&&c));!h&&c&&ie&&o[re].componentProviders++}}}function gp(i,r,o,c){const h=Bu(r),f=function dM(i){return!!i.useClass}(r);if(h||f){const C=(f?gt(r.useClass):r).prototype.ngOnDestroy;if(C){const L=i.destroyHooks||(i.destroyHooks=[]);if(!h&&r.multi){const N=L.indexOf(o);-1===N?L.push(o,[c,C]):L[N+1].push(c,C)}else L.push(o,C)}}}function V0(i,r,o){return o&&i.componentProviders++,i.multi.push(r)-1}function ml(i,r,o,c){for(let h=o;h<c;h++)if(r[h]===i)return h;return-1}function AE(i,r,o,c){return zg(this.multi,[])}function DE(i,r,o,c){const h=this.multi;let f;if(this.providerFactory){const x=this.providerFactory.componentProviders,b=Xi(o,o[1],this.providerFactory.index,c);f=b.slice(0,x),zg(h,f);for(let C=x;C<b.length;C++)f.push(b[C])}else f=[],zg(h,f);return f}function zg(i,r){for(let o=0;o<i.length;o++)r.push((0,i[o])());return r}function z0(i,r=[]){return o=>{o.providersResolver=(c,h)=>function TE(i,r,o){const c=an();if(c.firstCreatePass){const h=Ui(i);pl(o,c.data,c.blueprint,h,!0),pl(r,c.data,c.blueprint,h,!1)}}(c,h?h(i):i,r)}}class H0{}class Mw{resolveComponentFactory(r){throw function xw(i){const r=Error(`No component factory found for ${Ve(i)}. Did you add it to @NgModule.entryComponents?`);return r.ngComponent=i,r}(r)}}let vp=(()=>{class i{}return i.NULL=new Mw,i})();function ww(){return sh(Li(),Ue())}function sh(i,r){return new Qn(Pn(i,r))}let Qn=(()=>{class i{constructor(o){this.nativeElement=o}}return i.__NG_ELEMENT_ID__=ww,i})();function IE(i){return i instanceof Qn?i.nativeElement:i}class W0{}let LE=(()=>{class i{}return i.__NG_ELEMENT_ID__=()=>function bw(){const i=Ue(),o=ai(Li().index,i);return function j0(i){return i[11]}(Pi(o)?o:i)}(),i})(),OE=(()=>{class i{}return i.\u0275prov=Wn({token:i,providedIn:"root",factory:()=>null}),i})();class Ew{constructor(r){this.full=r,this.major=r.split(".")[0],this.minor=r.split(".")[1],this.patch=r.split(".").slice(2).join(".")}}const FE=new Ew("13.3.12"),$0={};function Ed(i,r,o,c,h=!1){for(;null!==o;){const f=r[o.index];if(null!==f&&c.push(en(f)),Nn(f))for(let b=10;b<f.length;b++){const C=f[b],L=C[1].firstChild;null!==L&&Ed(C[1],C,L,c)}const x=o.type;if(8&x)Ed(i,r,o.child,c);else if(32&x){const b=of(o,r);let C;for(;C=b();)c.push(C)}else if(16&x){const b=X_(r,o);if(Array.isArray(b))c.push(...b);else{const C=Lh(r[16]);Ed(C[1],C,b,c,!0)}}o=h?o.projectionNext:o.next}return c}class ru{constructor(r,o){this._lView=r,this._cdRefInjectingView=o,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const r=this._lView,o=r[1];return Ed(o,r,o.firstChild,[])}get context(){return this._lView[8]}set context(r){this._lView[8]=r}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const r=this._lView[3];if(Nn(r)){const o=r[8],c=o?o.indexOf(this):-1;c>-1&&(kl(r,c),Zd(o,c))}this._attachedToViewContainer=!1}om(this._lView[1],this._lView)}onDestroy(r){Xx(this._lView[1],this._lView,null,r)}markForCheck(){Lm(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){!function Fm(i,r,o){const c=r[10];c.begin&&c.begin();try{Wh(i,r,i.template,o)}catch(h){throw Bm(r,h),h}finally{c.end&&c.end()}}(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Qe(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Yo(i,r){cf(i,r,r[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(r){if(this._attachedToViewContainer)throw new Qe(902,"");this._appRef=r}}class X0 extends ru{constructor(r){super(r),this._view=r}detectChanges(){py(this._view)}checkNoChanges(){}get context(){return null}}class Sw extends vp{constructor(r){super(),this.ngModule=r}resolveComponentFactory(r){const o=Ri(r);return new oh(o,this.ngModule)}}function Wg(i){const r=[];for(let o in i)i.hasOwnProperty(o)&&r.push({propName:i[o],templateName:o});return r}class oh extends H0{constructor(r,o){super(),this.componentDef=r,this.ngModule=o,this.componentType=r.type,this.selector=function Rx(i){return i.map(Dx).join(",")}(r.selectors),this.ngContentSelectors=r.ngContentSelectors?r.ngContentSelectors:[],this.isBoundToModule=!!o}get inputs(){return Wg(this.componentDef.inputs)}get outputs(){return Wg(this.componentDef.outputs)}create(r,o,c,h){const f=(h=h||this.ngModule)?function q0(i,r){return{get:(o,c,h)=>{const f=i.get(o,$0,h);return f!==$0||c===$0?f:r.get(o,c,h)}}}(r,h.injector):r,x=f.get(W0,Yn),b=f.get(OE,null),C=x.createRenderer(null,this.componentDef),L=this.componentDef.selectors[0][0]||"div",N=c?function $x(i,r,o){if(st(i))return i.selectRootElement(r,o===is.ShadowDom);let c="string"==typeof r?i.querySelector(r):r;return c.textContent="",c}(C,c,this.componentDef.encapsulation):rm(x.createRenderer(null,this.componentDef),L,function NE(i){const r=i.toLowerCase();return"svg"===r?"svg":"math"===r?U:null}(L)),G=this.componentDef.onPush?576:528,X=function Ry(i,r){return{components:[],scheduler:i||vx,clean:my,playerHandler:r||null,flags:0}}(),Z=Tm(0,null,null,1,0,null,null,null,null,null),re=wf(null,Z,X,G,null,null,x,C,b,f);let ce,ie;Xa(re);try{const de=function Dy(i,r,o,c,h,f){const x=o[1];o[20]=i;const C=Hh(x,20,2,"#host",null),L=C.mergedAttrs=r.hostAttrs;null!==L&&(Zi(C,L,!0),null!==i&&(Ll(h,i,L),null!==C.classes&&uf(h,i,C.classes),null!==C.styles&&Y_(h,i,C.styles)));const N=c.createRenderer(i,r),G=wf(o,Wx(r),null,r.onPush?64:16,o[20],C,c,N,f||null,null);return x.firstCreatePass&&(J(A(C,o),x,r.type),Hl(x,C),Sf(C,o.length,1)),Tf(o,G),o[20]=G}(N,this.componentDef,re,x,C);if(N)if(c)Ll(C,N,["ng-version",FE.full]);else{const{attrs:he,classes:be}=function Ix(i){const r=[],o=[];let c=1,h=2;for(;c<i.length;){let f=i[c];if("string"==typeof f)2===h?""!==f&&r.push(f,i[++c]):8===h&&o.push(f);else{if(!ta(h))break;h=f}c++}return{attrs:r,classes:o}}(this.componentDef.selectors[0]);he&&Ll(C,N,he),be&&be.length>0&&uf(C,N,be.join(" "))}if(ie=Vi(Z,20),void 0!==o){const he=ie.projection=[];for(let be=0;be<this.ngContentSelectors.length;be++){const Pe=o[be];he.push(null!=Pe?Array.from(Pe):null)}}ce=function Ym(i,r,o,c,h){const f=o[1],x=function Yx(i,r,o){const c=Li();i.firstCreatePass&&(o.providersResolver&&o.providersResolver(o),Gl(i,c,r,Gh(i,r,1,null),o));const h=Xi(r,i,c.directiveStart,c);Ur(h,r);const f=Pn(c,r);return f&&Ur(f,r),h}(f,o,r);if(c.components.push(x),i[8]=x,h&&h.forEach(C=>C(x,r)),r.contentQueries){const C=Li();r.contentQueries(1,x,C.directiveStart)}const b=Li();return!f.firstCreatePass||null===r.hostBindings&&null===r.hostAttrs||($s(b.index),ay(o[1],b,0,b.directiveStart,b.directiveEnd,r),Fc(r,x)),x}(de,this.componentDef,re,X,[wM]),bf(Z,re,null)}finally{js()}return new UE(this.componentType,ce,sh(ie,re),re,ie)}}class UE extends class Gg{}{constructor(r,o,c,h,f){super(),this.location=c,this._rootLView=h,this._tNode=f,this.instance=o,this.hostView=this.changeDetectorRef=new X0(h),this.componentType=r}get injector(){return new Kr(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(r){this.hostView.onDestroy(r)}}class gl{}class yp{}const Sd=new Map;class Iw extends gl{constructor(r,o){super(),this._parent=o,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new Sw(this);const c=tr(r);this._bootstrapComponents=Ca(c.bootstrap),this._r3Injector=_y(r,o,[{provide:gl,useValue:this},{provide:vp,useValue:this.componentFactoryResolver}],Ve(r)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(r)}get(r,o=Ta.THROW_IF_NOT_FOUND,c=jt.Default){return r===Ta||r===gl||r===Vm?this:this._r3Injector.get(r,o,c)}destroy(){const r=this._r3Injector;!r.destroyed&&r.destroy(),this.destroyCbs.forEach(o=>o()),this.destroyCbs=null}onDestroy(r){this.destroyCbs.push(r)}}class Y0 extends yp{constructor(r){super(),this.moduleType=r,null!==tr(r)&&function Dw(i){const r=new Set;!function o(c){const h=tr(c,!0),f=h.id;null!==f&&(function Aw(i,r,o){if(r&&r!==o)throw new Error(`Duplicate module registered for ${i} - ${Ve(r)} vs ${Ve(r.name)}`)}(f,Sd.get(f),c),Sd.set(f,c));const x=Ca(h.imports);for(const b of x)r.has(b)||(r.add(b),o(b))}(i)}(r)}create(r){return new Iw(this.moduleType,r)}}function $g(i,r,o,c,h,f,x){const b=r+o;return function kc(i,r,o,c){const h=hs(i,r,o);return hs(i,r+1,c)||h}(i,b,h,f)?function Aa(i,r,o){return i[r]=o}(i,b+2,x?c.call(x,h,f):c(h,f)):function wp(i,r){const o=i[r];return o===mn?void 0:o}(i,b+2)}function Xg(i,r){const o=an();let c;const h=i+20;o.firstCreatePass?(c=function zE(i,r){if(r)for(let o=r.length-1;o>=0;o--){const c=r[o];if(i===c.name)return c}}(r,o.pipeRegistry),o.data[h]=c,c.onDestroy&&(o.destroyHooks||(o.destroyHooks=[])).push(h,c.onDestroy)):c=o.data[h];const f=c.factory||(c.factory=Or(c.type)),x=kt(Yu);try{const b=gc(!1),C=f();return gc(b),function Vc(i,r,o,c){o>=i.data.length&&(i.data[o]=null,i.blueprint[o]=null),r[o]=c}(o,Ue(),h,C),C}finally{kt(x)}}function qg(i,r,o,c){const h=i+20,f=Ue(),x=function zn(i,r){return i[r]}(f,h);return function ah(i,r){return i[1].data[r].pure}(f,h)?$g(f,function nr(){const i=nn.lFrame;let r=i.bindingRootIndex;return-1===r&&(r=i.bindingRootIndex=i.tView.bindingStartIndex),r}(),r,x.transform,o,c,x):x.transform(o,c)}function Zg(i){return r=>{setTimeout(i,void 0,r)}}const no=class Fw extends j.x{constructor(r=!1){super(),this.__isAsync=r}emit(r){super.next(r)}subscribe(r,o,c){var h,f,x;let b=r,C=o||(()=>null),L=c;if(r&&"object"==typeof r){const G=r;b=null===(h=G.next)||void 0===h?void 0:h.bind(G),C=null===(f=G.error)||void 0===f?void 0:f.bind(G),L=null===(x=G.complete)||void 0===x?void 0:x.bind(G)}this.__isAsync&&(C=Zg(C),b&&(b=Zg(b)),L&&(L=Zg(L)));const N=super.subscribe({next:b,error:C,complete:L});return r instanceof I.w0&&r.add(N),N}};function Nw(){return this._results[Vu()]()}class Sp{constructor(r=!1){this._emitDistinctChangesOnly=r,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const o=Vu(),c=Sp.prototype;c[o]||(c[o]=Nw)}get changes(){return this._changes||(this._changes=new no)}get(r){return this._results[r]}map(r){return this._results.map(r)}filter(r){return this._results.filter(r)}find(r){return this._results.find(r)}reduce(r,o){return this._results.reduce(r,o)}forEach(r){this._results.forEach(r)}some(r){return this._results.some(r)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(r,o){const c=this;c.dirty=!1;const h=_o(r);(this._changesDetected=!function N_(i,r,o){if(i.length!==r.length)return!1;for(let c=0;c<i.length;c++){let h=i[c],f=r[c];if(o&&(h=o(h),f=o(f)),f!==h)return!1}return!0}(c._results,h,o))&&(c._results=h,c.length=h.length,c.last=h[this.length-1],c.first=h[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let su=(()=>{class i{}return i.__NG_ELEMENT_ID__=gi,i})();const e_=su,kw=class extends e_{constructor(r,o,c){super(),this._declarationLView=r,this._declarationTContainer=o,this.elementRef=c}createEmbeddedView(r){const o=this._declarationTContainer.tViews,c=wf(this._declarationLView,o,r,16,null,o.declTNode,null,null,null,null);c[17]=this._declarationLView[this._declarationTContainer.index];const f=this._declarationLView[19];return null!==f&&(c[19]=f.createEmbeddedView(o)),bf(o,c,r),new ru(c)}};function gi(){return ar(Li(),Ue())}function ar(i,r){return 4&i.type?new kw(r,i,sh(i,r)):null}let oa=(()=>{class i{}return i.__NG_ELEMENT_ID__=lh,i})();function lh(){return Tp(Li(),Ue())}const ch=oa,uh=class extends ch{constructor(r,o,c){super(),this._lContainer=r,this._hostTNode=o,this._hostLView=c}get element(){return sh(this._hostTNode,this._hostLView)}get injector(){return new Kr(this._hostTNode,this._hostLView)}get parentInjector(){const r=H(this._hostTNode,this._hostLView);if(wh(r)){const o=Nr(r,this._hostLView),c=_s(r);return new Kr(o[1].data[c+8],o)}return new Kr(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(r){const o=Kg(this._lContainer);return null!==o&&o[r]||null}get length(){return this._lContainer.length-10}createEmbeddedView(r,o,c){const h=r.createEmbeddedView(o||{});return this.insert(h,c),h}createComponent(r,o,c,h,f){const x=r&&!function bh(i){return"function"==typeof i}(r);let b;if(x)b=o;else{const G=o||{};b=G.index,c=G.injector,h=G.projectableNodes,f=G.ngModuleRef}const C=x?r:new oh(Ri(r)),L=c||this.parentInjector;if(!f&&null==C.ngModule){const X=(x?L:this.parentInjector).get(gl,null);X&&(f=X)}const N=C.create(L,h,void 0,f);return this.insert(N.hostView,b),N}insert(r,o){const c=r._lView,h=c[1];if(function sc(i){return Nn(i[3])}(c)){const N=this.indexOf(r);if(-1!==N)this.detach(N);else{const G=c[3],X=new uh(G,G[6],G[3]);X.detach(X.indexOf(r))}}const f=this._adjustIndex(o),x=this._lContainer;!function sm(i,r,o,c){const h=10+c,f=o.length;c>0&&(o[h-1][4]=r),c<f-10?(r[4]=o[h],gv(o,10+c,r)):(o.push(r),r[4]=null),r[3]=o;const x=r[17];null!==x&&o!==x&&function sl(i,r){const o=i[9];r[16]!==r[3][3][16]&&(i[2]=!0),null===o?i[9]=[r]:o.push(r)}(x,r);const b=r[19];null!==b&&b.insertView(i),r[2]|=128}(h,c,x,f);const b=qi(f,x),C=c[11],L=Ic(C,x[7]);return null!==L&&function Tr(i,r,o,c,h,f){c[0]=h,c[6]=r,cf(i,c,o,1,h,f)}(h,x[6],C,c,L,b),r.attachToViewContainerRef(),gv(Cp(x),f,r),r}move(r,o){return this.insert(r,o)}indexOf(r){const o=Kg(this._lContainer);return null!==o?o.indexOf(r):-1}remove(r){const o=this._adjustIndex(r,-1),c=kl(this._lContainer,o);c&&(Zd(Cp(this._lContainer),o),om(c[1],c))}detach(r){const o=this._adjustIndex(r,-1),c=kl(this._lContainer,o);return c&&null!=Zd(Cp(this._lContainer),o)?new ru(c):null}_adjustIndex(r,o=0){return null==r?this.length+o:r}};function Kg(i){return i[8]}function Cp(i){return i[8]||(i[8]=[])}function Tp(i,r){let o;const c=r[i.index];if(Nn(c))o=c;else{let h;if(8&i.type)h=en(c);else{const f=r[11];h=f.createComment("");const x=Pn(i,r);Rc(f,Ic(f,x),h,function um(i,r){return st(i)?i.nextSibling(r):r.nextSibling}(f,x),!1)}r[i.index]=o=hy(c,r,h,i),Tf(r,o)}return new uh(o,i,r)}class Td{constructor(r){this.queryList=r,this.matches=null}clone(){return new Td(this.queryList)}setDirty(){this.queryList.setDirty()}}class ou{constructor(r=[]){this.queries=r}createEmbeddedView(r){const o=r.queries;if(null!==o){const c=null!==r.contentQueries?r.contentQueries[0]:o.length,h=[];for(let f=0;f<c;f++){const x=o.getByIndex(f);h.push(this.queries[x.indexInDeclarationView].clone())}return new ou(h)}return null}insertView(r){this.dirtyQueriesWithMatches(r)}detachView(r){this.dirtyQueriesWithMatches(r)}dirtyQueriesWithMatches(r){for(let o=0;o<this.queries.length;o++)null!==Pd(r,o).matches&&this.queries[o].setDirty()}}class Si{constructor(r,o,c=null){this.predicate=r,this.flags=o,this.read=c}}class Oa{constructor(r=[]){this.queries=r}elementStart(r,o){for(let c=0;c<this.queries.length;c++)this.queries[c].elementStart(r,o)}elementEnd(r){for(let o=0;o<this.queries.length;o++)this.queries[o].elementEnd(r)}embeddedTView(r){let o=null;for(let c=0;c<this.length;c++){const h=null!==o?o.length:0,f=this.getByIndex(c).embeddedTView(r,h);f&&(f.indexInDeclarationView=c,null!==o?o.push(f):o=[f])}return null!==o?new Oa(o):null}template(r,o){for(let c=0;c<this.queries.length;c++)this.queries[c].template(r,o)}getByIndex(r){return this.queries[r]}get length(){return this.queries.length}track(r){this.queries.push(r)}}class Ro{constructor(r,o=-1){this.metadata=r,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=o}elementStart(r,o){this.isApplyingToNode(o)&&this.matchTNode(r,o)}elementEnd(r){this._declarationNodeIndex===r.index&&(this._appliesToNextNode=!1)}template(r,o){this.elementStart(r,o)}embeddedTView(r,o){return this.isApplyingToNode(r)?(this.crossesNgTemplate=!0,this.addMatch(-r.index,o),new Ro(this.metadata)):null}isApplyingToNode(r){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const o=this._declarationNodeIndex;let c=r.parent;for(;null!==c&&8&c.type&&c.index!==o;)c=c.parent;return o===(null!==c?c.index:-1)}return this._appliesToNextNode}matchTNode(r,o){const c=this.metadata.predicate;if(Array.isArray(c))for(let h=0;h<c.length;h++){const f=c[h];this.matchTNodeWithReadOption(r,o,Yl(o,f)),this.matchTNodeWithReadOption(r,o,ni(o,r,f,!1,!1))}else c===su?4&o.type&&this.matchTNodeWithReadOption(r,o,-1):this.matchTNodeWithReadOption(r,o,ni(o,r,c,!1,!1))}matchTNodeWithReadOption(r,o,c){if(null!==c){const h=this.metadata.read;if(null!==h)if(h===Qn||h===oa||h===su&&4&o.type)this.addMatch(o.index,-2);else{const f=ni(o,r,h,!1,!1);null!==f&&this.addMatch(o.index,f)}else this.addMatch(o.index,c)}}addMatch(r,o){null===this.matches?this.matches=[r,o]:this.matches.push(r,o)}}function Yl(i,r){const o=i.localNames;if(null!==o)for(let c=0;c<o.length;c+=2)if(o[c]===r)return o[c+1];return null}function n_(i,r,o,c){return-1===o?function Ad(i,r){return 11&i.type?sh(i,r):4&i.type?ar(i,r):null}(r,i):-2===o?function i_(i,r,o){return o===Qn?sh(r,i):o===su?ar(r,i):o===oa?Tp(r,i):void 0}(i,r,c):Xi(i,i[1],o,r)}function Jg(i,r,o,c){const h=r[19].queries[c];if(null===h.matches){const f=i.data,x=o.matches,b=[];for(let C=0;C<x.length;C+=2){const L=x[C];b.push(L<0?null:n_(r,f[L],x[C+1],o.metadata.read))}h.matches=b}return h.matches}function Dp(i,r,o,c){const h=i.queries.getByIndex(o),f=h.matches;if(null!==f){const x=Jg(i,r,h,o);for(let b=0;b<f.length;b+=2){const C=f[b];if(C>0)c.push(x[b/2]);else{const L=f[b+1],N=r[-C];for(let G=10;G<N.length;G++){const X=N[G];X[17]===X[3]&&Dp(X[1],X,L,c)}if(null!==N[9]){const G=N[9];for(let X=0;X<G.length;X++){const Z=G[X];Dp(Z[1],Z,L,c)}}}}}return c}function Dd(i){const r=Ue(),o=an(),c=ja();hc(c+1);const h=Pd(o,c);if(i.dirty&&di(r)===(2==(2&h.metadata.flags))){if(null===h.matches)i.reset([]);else{const f=h.crossesNgTemplate?Dp(o,r,c,[]):Jg(o,r,h,c);i.reset(f,IE),i.notifyOnChanges()}return!0}return!1}function Rd(i,r,o,c){const h=an();if(h.firstCreatePass){const f=Li();(function aa(i,r,o){null===i.queries&&(i.queries=new Oa),i.queries.track(new Ro(r,o))})(h,new Si(r,o,c),f.index),function dh(i,r){const o=i.contentQueries||(i.contentQueries=[]);r!==(o.length?o[o.length-1]:-1)&&o.push(i.queries.length-1,r)}(h,i),2==(2&o)&&(h.staticContentQueries=!0)}!function Id(i,r,o){const c=new Sp(4==(4&o));Xx(i,r,c,c.destroy),null===r[19]&&(r[19]=new ou),r[19].queries.push(new Td(c))}(h,Ue(),o)}function hh(){return function Zl(i,r){return i[19].queries[r].queryList}(Ue(),ja())}function Pd(i,r){return i.queries.getByIndex(r)}function sv(...i){}const jw=new li("Application Initializer");let Up=(()=>{class i{constructor(o){this.appInits=o,this.resolve=sv,this.reject=sv,this.initialized=!1,this.done=!1,this.donePromise=new Promise((c,h)=>{this.resolve=c,this.reject=h})}runInitializers(){if(this.initialized)return;const o=[],c=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let h=0;h<this.appInits.length;h++){const f=this.appInits[h]();if(ug(f))o.push(f);else if(hg(f)){const x=new Promise((b,C)=>{f.subscribe({complete:b,error:C})});o.push(x)}}Promise.all(o).then(()=>{c()}).catch(h=>{this.reject(h)}),0===o.length&&c(),this.initialized=!0}}return i.\u0275fac=function(o){return new(o||i)(Jr(jw,8))},i.\u0275prov=Wn({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const $w=new li("AppId",{providedIn:"root",factory:function Xw(){return`${ph()}${ph()}${ph()}`}});function ph(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const qw=new li("Platform Initializer"),XE=new li("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),Yw=new li("appBootstrapListener");let ov=(()=>{class i{log(o){console.log(o)}warn(o){console.warn(o)}}return i.\u0275fac=function(o){return new(o||i)},i.\u0275prov=Wn({token:i,factory:i.\u0275fac,providedIn:"platform"}),i})();const Ud=new li("LocaleId",{providedIn:"root",factory:()=>Kp(Ud,jt.Optional|jt.SkipSelf)||function m_(){return"undefined"!=typeof $localize&&$localize.locale||op}()}),Zw=new li("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});class Bp{constructor(r,o){this.ngModuleFactory=r,this.componentFactories=o}}let Kw=(()=>{class i{compileModuleSync(o){return new Y0(o)}compileModuleAsync(o){return Promise.resolve(this.compileModuleSync(o))}compileModuleAndAllComponentsSync(o){const c=this.compileModuleSync(o),f=Ca(tr(o).declarations).reduce((x,b)=>{const C=Ri(b);return C&&x.push(new oh(C)),x},[]);return new Bp(c,f)}compileModuleAndAllComponentsAsync(o){return Promise.resolve(this.compileModuleAndAllComponentsSync(o))}clearCache(){}clearCacheFor(o){}getModuleId(o){}}return i.\u0275fac=function(o){return new(o||i)},i.\u0275prov=Wn({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const g_=(()=>Promise.resolve(0))();function av(i){"undefined"==typeof Zone?g_.then(()=>{i&&i.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",i)}class Ns{constructor({enableLongStackTrace:r=!1,shouldCoalesceEventChangeDetection:o=!1,shouldCoalesceRunChangeDetection:c=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new no(!1),this.onMicrotaskEmpty=new no(!1),this.onStable=new no(!1),this.onError=new no(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const h=this;h._nesting=0,h._outer=h._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(h._inner=h._inner.fork(new Zone.TaskTrackingZoneSpec)),r&&Zone.longStackTraceZoneSpec&&(h._inner=h._inner.fork(Zone.longStackTraceZoneSpec)),h.shouldCoalesceEventChangeDetection=!c&&o,h.shouldCoalesceRunChangeDetection=c,h.lastRequestAnimationFrameId=-1,h.nativeRequestAnimationFrame=function Bd(){let i=jn.requestAnimationFrame,r=jn.cancelAnimationFrame;if("undefined"!=typeof Zone&&i&&r){const o=i[Zone.__symbol__("OriginalDelegate")];o&&(i=o);const c=r[Zone.__symbol__("OriginalDelegate")];c&&(r=c)}return{nativeRequestAnimationFrame:i,nativeCancelAnimationFrame:r}}().nativeRequestAnimationFrame,function KE(i){const r=()=>{!function ZE(i){i.isCheckStableRunning||-1!==i.lastRequestAnimationFrameId||(i.lastRequestAnimationFrameId=i.nativeRequestAnimationFrame.call(jn,()=>{i.fakeTopEventTask||(i.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{i.lastRequestAnimationFrameId=-1,__(i),i.isCheckStableRunning=!0,y_(i),i.isCheckStableRunning=!1},void 0,()=>{},()=>{})),i.fakeTopEventTask.invoke()}),__(i))}(i)};i._inner=i._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(o,c,h,f,x,b)=>{try{return Qw(i),o.invokeTask(h,f,x,b)}finally{(i.shouldCoalesceEventChangeDetection&&"eventTask"===f.type||i.shouldCoalesceRunChangeDetection)&&r(),eb(i)}},onInvoke:(o,c,h,f,x,b,C)=>{try{return Qw(i),o.invoke(h,f,x,b,C)}finally{i.shouldCoalesceRunChangeDetection&&r(),eb(i)}},onHasTask:(o,c,h,f)=>{o.hasTask(h,f),c===h&&("microTask"==f.change?(i._hasPendingMicrotasks=f.microTask,__(i),y_(i)):"macroTask"==f.change&&(i.hasPendingMacrotasks=f.macroTask))},onHandleError:(o,c,h,f)=>(o.handleError(h,f),i.runOutsideAngular(()=>i.onError.emit(f)),!1)})}(h)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Ns.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(Ns.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(r,o,c){return this._inner.run(r,o,c)}runTask(r,o,c,h){const f=this._inner,x=f.scheduleEventTask("NgZoneEvent: "+h,r,v_,sv,sv);try{return f.runTask(x,o,c)}finally{f.cancelTask(x)}}runGuarded(r,o,c){return this._inner.runGuarded(r,o,c)}runOutsideAngular(r){return this._outer.run(r)}}const v_={};function y_(i){if(0==i._nesting&&!i.hasPendingMicrotasks&&!i.isStable)try{i._nesting++,i.onMicrotaskEmpty.emit(null)}finally{if(i._nesting--,!i.hasPendingMicrotasks)try{i.runOutsideAngular(()=>i.onStable.emit(null))}finally{i.isStable=!0}}}function __(i){i.hasPendingMicrotasks=!!(i._hasPendingMicrotasks||(i.shouldCoalesceEventChangeDetection||i.shouldCoalesceRunChangeDetection)&&-1!==i.lastRequestAnimationFrameId)}function Qw(i){i._nesting++,i.isStable&&(i.isStable=!1,i.onUnstable.emit(null))}function eb(i){i._nesting--,y_(i)}class JE{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new no,this.onMicrotaskEmpty=new no,this.onStable=new no,this.onError=new no}run(r,o,c){return r.apply(o,c)}runGuarded(r,o,c){return r.apply(o,c)}runOutsideAngular(r){return r()}runTask(r,o,c,h){return r.apply(o,c)}}let tb=(()=>{class i{constructor(o){this._ngZone=o,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),o.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Ns.assertNotInAngularZone(),av(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())av(()=>{for(;0!==this._callbacks.length;){let o=this._callbacks.pop();clearTimeout(o.timeoutId),o.doneCb(this._didWork)}this._didWork=!1});else{let o=this.getPendingTasks();this._callbacks=this._callbacks.filter(c=>!c.updateCb||!c.updateCb(o)||(clearTimeout(c.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(o=>({source:o.source,creationLocation:o.creationLocation,data:o.data})):[]}addCallback(o,c,h){let f=-1;c&&c>0&&(f=setTimeout(()=>{this._callbacks=this._callbacks.filter(x=>x.timeoutId!==f),o(this._didWork,this.getPendingTasks())},c)),this._callbacks.push({doneCb:o,timeoutId:f,updateCb:h})}whenStable(o,c,h){if(h&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(o,c,h),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(o,c,h){return[]}}return i.\u0275fac=function(o){return new(o||i)(Jr(Ns))},i.\u0275prov=Wn({token:i,factory:i.\u0275fac}),i})(),QE=(()=>{class i{constructor(){this._applications=new Map,x_.addToWindow(this)}registerApplication(o,c){this._applications.set(o,c)}unregisterApplication(o){this._applications.delete(o)}unregisterAllApplications(){this._applications.clear()}getTestability(o){return this._applications.get(o)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(o,c=!0){return x_.findTestabilityInTree(this,o,c)}}return i.\u0275fac=function(o){return new(o||i)},i.\u0275prov=Wn({token:i,factory:i.\u0275fac,providedIn:"platform"}),i})();class eS{addToWindow(r){}findTestabilityInTree(r,o,c){return null}}function tS(i){x_=i}let x_=new eS,Fa=null;const Vp=new li("AllowMultipleToken"),M_=new li("PlatformOnDestroy");class rb{constructor(r,o){this.name=r,this.token=o}}function ob(i,r,o=[]){const c=`Platform: ${r}`,h=new li(c);return(f=[])=>{let x=ds();if(!x||x.injector.get(Vp,!1)){const b=[...o,...f,{provide:h,useValue:!0}];i?i(b):function sb(i){if(Fa&&!Fa.get(Vp,!1))throw new Qe(400,"");Fa=i;const r=i.get(w_),o=i.get(qw,null);o&&o.forEach(c=>c())}(function Un(i=[],r){return Ta.create({name:r,providers:[{provide:zm,useValue:"platform"},{provide:M_,useValue:()=>Fa=null},...i]})}(b,c))}return function ab(i){const r=ds();if(!r)throw new Qe(401,"");return r}()}}function ds(){var i;return null!==(i=null==Fa?void 0:Fa.get(w_))&&void 0!==i?i:null}let w_=(()=>{class i{constructor(o){this._injector=o,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(o,c){const b=function lb(i,r){let o;return o="noop"===i?new JE:("zone.js"===i?void 0:i)||new Ns({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==r?void 0:r.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==r?void 0:r.ngZoneRunCoalescing)}),o}(c?c.ngZone:void 0,{ngZoneEventCoalescing:c&&c.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:c&&c.ngZoneRunCoalescing||!1}),C=[{provide:Ns,useValue:b}];return b.run(()=>{const L=Ta.create({providers:C,parent:this.injector,name:o.moduleType.name}),N=o.create(L),G=N.injector.get(yf,null);if(!G)throw new Qe(402,"");return b.runOutsideAngular(()=>{const X=b.onError.subscribe({next:Z=>{G.handleError(Z)}});N.onDestroy(()=>{cv(this._modules,N),X.unsubscribe()})}),function cb(i,r,o){try{const c=o();return ug(c)?c.catch(h=>{throw r.runOutsideAngular(()=>i.handleError(h)),h}):c}catch(c){throw r.runOutsideAngular(()=>i.handleError(c)),c}}(G,b,()=>{const X=N.injector.get(Up);return X.runInitializers(),X.donePromise.then(()=>(function Do(i){Wt(i,"Expected localeId to be defined"),"string"==typeof i&&(w0=i.toLowerCase().replace(/_/g,"-"))}(N.injector.get(Ud,op)||op),this._moduleDoBootstrap(N),N))})})}bootstrapModule(o,c=[]){const h=b_({},c);return function nb(i,r,o){const c=new Y0(o);return Promise.resolve(c)}(0,0,o).then(f=>this.bootstrapModuleFactory(f,h))}_moduleDoBootstrap(o){const c=o.injector.get(lv);if(o._bootstrapComponents.length>0)o._bootstrapComponents.forEach(h=>c.bootstrap(h));else{if(!o.instance.ngDoBootstrap)throw new Qe(403,"");o.instance.ngDoBootstrap(c)}this._modules.push(o)}onDestroy(o){this._destroyListeners.push(o)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Qe(404,"");this._modules.slice().forEach(c=>c.destroy()),this._destroyListeners.forEach(c=>c());const o=this._injector.get(M_,null);null==o||o(),this._destroyed=!0}get destroyed(){return this._destroyed}}return i.\u0275fac=function(o){return new(o||i)(Jr(Ta))},i.\u0275prov=Wn({token:i,factory:i.\u0275fac,providedIn:"platform"}),i})();function b_(i,r){return Array.isArray(r)?r.reduce(b_,i):Object.assign(Object.assign({},i),r)}let lv=(()=>{class i{constructor(o,c,h,f){this._zone=o,this._injector=c,this._exceptionHandler=h,this._initStatus=f,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const x=new Me.y(C=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{C.next(this._stable),C.complete()})}),b=new Me.y(C=>{let L;this._zone.runOutsideAngular(()=>{L=this._zone.onStable.subscribe(()=>{Ns.assertNotInAngularZone(),av(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,C.next(!0))})})});const N=this._zone.onUnstable.subscribe(()=>{Ns.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{C.next(!1)}))});return()=>{L.unsubscribe(),N.unsubscribe()}});this.isStable=function Et(...i){const r=(0,Ke.yG)(i),o=(0,Ke._6)(i,1/0),c=i;return c.length?1===c.length?(0,Ie.Xf)(c[0]):(0,ze.J)(o)((0,mt.D)(c,r)):xt.E}(x,b.pipe(function Je(i={}){const{connector:r=(()=>new j.x),resetOnError:o=!0,resetOnComplete:c=!0,resetOnRefCountZero:h=!0}=i;return f=>{let x,b,C,L=0,N=!1,G=!1;const X=()=>{null==b||b.unsubscribe(),b=void 0},Z=()=>{X(),x=C=void 0,N=G=!1},re=()=>{const ce=x;Z(),null==ce||ce.unsubscribe()};return(0,me.e)((ce,ie)=>{L++,!G&&!N&&X();const de=C=null!=C?C:r();ie.add(()=>{L--,0===L&&!G&&!N&&(b=_n(re,h))}),de.subscribe(ie),!x&&L>0&&(x=new je.Hp({next:he=>de.next(he),error:he=>{G=!0,X(),b=_n(Z,o,he),de.error(he)},complete:()=>{N=!0,X(),b=_n(Z,c),de.complete()}}),(0,Ie.Xf)(ce).subscribe(x))})(f)}}()))}bootstrap(o,c){if(!this._initStatus.done)throw new Qe(405,"");let h;h=o instanceof H0?o:this._injector.get(vp).resolveComponentFactory(o),this.componentTypes.push(h.componentType);const f=function ib(i){return i.isBoundToModule}(h)?void 0:this._injector.get(gl),b=h.create(Ta.NULL,[],c||h.selector,f),C=b.location.nativeElement,L=b.injector.get(tb,null),N=L&&b.injector.get(QE);return L&&N&&N.registerApplication(C,L),b.onDestroy(()=>{this.detachView(b.hostView),cv(this.components,b),N&&N.unregisterApplication(C)}),this._loadComponent(b),b}tick(){if(this._runningTick)throw new Qe(101,"");try{this._runningTick=!0;for(let o of this._views)o.detectChanges()}catch(o){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(o))}finally{this._runningTick=!1}}attachView(o){const c=o;this._views.push(c),c.attachToAppRef(this)}detachView(o){const c=o;cv(this._views,c),c.detachFromAppRef()}_loadComponent(o){this.attachView(o.hostView),this.tick(),this.components.push(o),this._injector.get(Yw,[]).concat(this._bootstrapListeners).forEach(h=>h(o))}ngOnDestroy(){this._views.slice().forEach(o=>o.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return i.\u0275fac=function(o){return new(o||i)(Jr(Ns),Jr(Ta),Jr(yf),Jr(Up))},i.\u0275prov=Wn({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function cv(i,r){const o=i.indexOf(r);o>-1&&i.splice(o,1)}let S_=!0;function hb(){S_=!1}let mh=(()=>{class i{}return i.__NG_ELEMENT_ID__=T_,i})();function T_(i){return function A_(i,r,o){if(ss(i)&&!o){const c=ai(i.index,r);return new ru(c,c)}return 47&i.type?new ru(r[16],r):null}(Li(),Ue(),16==(16&i))}class pv{constructor(){}supports(r){return Yh(r)}create(r){return new hS(r)}}const uS=(i,r)=>r;class hS{constructor(r){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=r||uS}forEachItem(r){let o;for(o=this._itHead;null!==o;o=o._next)r(o)}forEachOperation(r){let o=this._itHead,c=this._removalsHead,h=0,f=null;for(;o||c;){const x=!c||o&&o.currentIndex<gb(c,h,f)?o:c,b=gb(x,h,f),C=x.currentIndex;if(x===c)h--,c=c._nextRemoved;else if(o=o._next,null==x.previousIndex)h++;else{f||(f=[]);const L=b-h,N=C-h;if(L!=N){for(let X=0;X<L;X++){const Z=X<f.length?f[X]:f[X]=0,re=Z+X;N<=re&&re<L&&(f[X]=Z+1)}f[x.previousIndex]=N-L}}b!==C&&r(x,b,C)}}forEachPreviousItem(r){let o;for(o=this._previousItHead;null!==o;o=o._nextPrevious)r(o)}forEachAddedItem(r){let o;for(o=this._additionsHead;null!==o;o=o._nextAdded)r(o)}forEachMovedItem(r){let o;for(o=this._movesHead;null!==o;o=o._nextMoved)r(o)}forEachRemovedItem(r){let o;for(o=this._removalsHead;null!==o;o=o._nextRemoved)r(o)}forEachIdentityChange(r){let o;for(o=this._identityChangesHead;null!==o;o=o._nextIdentityChange)r(o)}diff(r){if(null==r&&(r=[]),!Yh(r))throw new Qe(900,"");return this.check(r)?this:null}onDestroy(){}check(r){this._reset();let h,f,x,o=this._itHead,c=!1;if(Array.isArray(r)){this.length=r.length;for(let b=0;b<this.length;b++)f=r[b],x=this._trackByFn(b,f),null!==o&&Object.is(o.trackById,x)?(c&&(o=this._verifyReinsertion(o,f,x,b)),Object.is(o.item,f)||this._addIdentityChange(o,f)):(o=this._mismatch(o,f,x,b),c=!0),o=o._next}else h=0,function AM(i,r){if(Array.isArray(i))for(let o=0;o<i.length;o++)r(i[o]);else{const o=i[Vu()]();let c;for(;!(c=o.next()).done;)r(c.value)}}(r,b=>{x=this._trackByFn(h,b),null!==o&&Object.is(o.trackById,x)?(c&&(o=this._verifyReinsertion(o,b,x,h)),Object.is(o.item,b)||this._addIdentityChange(o,b)):(o=this._mismatch(o,b,x,h),c=!0),o=o._next,h++}),this.length=h;return this._truncate(o),this.collection=r,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let r;for(r=this._previousItHead=this._itHead;null!==r;r=r._next)r._nextPrevious=r._next;for(r=this._additionsHead;null!==r;r=r._nextAdded)r.previousIndex=r.currentIndex;for(this._additionsHead=this._additionsTail=null,r=this._movesHead;null!==r;r=r._nextMoved)r.previousIndex=r.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(r,o,c,h){let f;return null===r?f=this._itTail:(f=r._prev,this._remove(r)),null!==(r=null===this._unlinkedRecords?null:this._unlinkedRecords.get(c,null))?(Object.is(r.item,o)||this._addIdentityChange(r,o),this._reinsertAfter(r,f,h)):null!==(r=null===this._linkedRecords?null:this._linkedRecords.get(c,h))?(Object.is(r.item,o)||this._addIdentityChange(r,o),this._moveAfter(r,f,h)):r=this._addAfter(new pb(o,c),f,h),r}_verifyReinsertion(r,o,c,h){let f=null===this._unlinkedRecords?null:this._unlinkedRecords.get(c,null);return null!==f?r=this._reinsertAfter(f,r._prev,h):r.currentIndex!=h&&(r.currentIndex=h,this._addToMoves(r,h)),r}_truncate(r){for(;null!==r;){const o=r._next;this._addToRemovals(this._unlink(r)),r=o}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(r,o,c){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(r);const h=r._prevRemoved,f=r._nextRemoved;return null===h?this._removalsHead=f:h._nextRemoved=f,null===f?this._removalsTail=h:f._prevRemoved=h,this._insertAfter(r,o,c),this._addToMoves(r,c),r}_moveAfter(r,o,c){return this._unlink(r),this._insertAfter(r,o,c),this._addToMoves(r,c),r}_addAfter(r,o,c){return this._insertAfter(r,o,c),this._additionsTail=null===this._additionsTail?this._additionsHead=r:this._additionsTail._nextAdded=r,r}_insertAfter(r,o,c){const h=null===o?this._itHead:o._next;return r._next=h,r._prev=o,null===h?this._itTail=r:h._prev=r,null===o?this._itHead=r:o._next=r,null===this._linkedRecords&&(this._linkedRecords=new P_),this._linkedRecords.put(r),r.currentIndex=c,r}_remove(r){return this._addToRemovals(this._unlink(r))}_unlink(r){null!==this._linkedRecords&&this._linkedRecords.remove(r);const o=r._prev,c=r._next;return null===o?this._itHead=c:o._next=c,null===c?this._itTail=o:c._prev=o,r}_addToMoves(r,o){return r.previousIndex===o||(this._movesTail=null===this._movesTail?this._movesHead=r:this._movesTail._nextMoved=r),r}_addToRemovals(r){return null===this._unlinkedRecords&&(this._unlinkedRecords=new P_),this._unlinkedRecords.put(r),r.currentIndex=null,r._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=r,r._prevRemoved=null):(r._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=r),r}_addIdentityChange(r,o){return r.item=o,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=r:this._identityChangesTail._nextIdentityChange=r,r}}class pb{constructor(r,o){this.item=r,this.trackById=o,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class mb{constructor(){this._head=null,this._tail=null}add(r){null===this._head?(this._head=this._tail=r,r._nextDup=null,r._prevDup=null):(this._tail._nextDup=r,r._prevDup=this._tail,r._nextDup=null,this._tail=r)}get(r,o){let c;for(c=this._head;null!==c;c=c._nextDup)if((null===o||o<=c.currentIndex)&&Object.is(c.trackById,r))return c;return null}remove(r){const o=r._prevDup,c=r._nextDup;return null===o?this._head=c:o._nextDup=c,null===c?this._tail=o:c._prevDup=o,null===this._head}}class P_{constructor(){this.map=new Map}put(r){const o=r.trackById;let c=this.map.get(o);c||(c=new mb,this.map.set(o,c)),c.add(r)}get(r,o){const h=this.map.get(r);return h?h.get(r,o):null}remove(r){const o=r.trackById;return this.map.get(o).remove(r)&&this.map.delete(o),r}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function gb(i,r,o){const c=i.previousIndex;if(null===c)return c;let h=0;return o&&c<o.length&&(h=o[c]),c+r+h}class L_{constructor(){}supports(r){return r instanceof Map||Jm(r)}create(){return new vb}}class vb{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(r){let o;for(o=this._mapHead;null!==o;o=o._next)r(o)}forEachPreviousItem(r){let o;for(o=this._previousMapHead;null!==o;o=o._nextPrevious)r(o)}forEachChangedItem(r){let o;for(o=this._changesHead;null!==o;o=o._nextChanged)r(o)}forEachAddedItem(r){let o;for(o=this._additionsHead;null!==o;o=o._nextAdded)r(o)}forEachRemovedItem(r){let o;for(o=this._removalsHead;null!==o;o=o._nextRemoved)r(o)}diff(r){if(r){if(!(r instanceof Map||Jm(r)))throw new Qe(900,"")}else r=new Map;return this.check(r)?this:null}onDestroy(){}check(r){this._reset();let o=this._mapHead;if(this._appendAfter=null,this._forEach(r,(c,h)=>{if(o&&o.key===h)this._maybeAddToChanges(o,c),this._appendAfter=o,o=o._next;else{const f=this._getOrCreateRecordForKey(h,c);o=this._insertBeforeOrAppend(o,f)}}),o){o._prev&&(o._prev._next=null),this._removalsHead=o;for(let c=o;null!==c;c=c._nextRemoved)c===this._mapHead&&(this._mapHead=null),this._records.delete(c.key),c._nextRemoved=c._next,c.previousValue=c.currentValue,c.currentValue=null,c._prev=null,c._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(r,o){if(r){const c=r._prev;return o._next=r,o._prev=c,r._prev=o,c&&(c._next=o),r===this._mapHead&&(this._mapHead=o),this._appendAfter=r,r}return this._appendAfter?(this._appendAfter._next=o,o._prev=this._appendAfter):this._mapHead=o,this._appendAfter=o,null}_getOrCreateRecordForKey(r,o){if(this._records.has(r)){const h=this._records.get(r);this._maybeAddToChanges(h,o);const f=h._prev,x=h._next;return f&&(f._next=x),x&&(x._prev=f),h._next=null,h._prev=null,h}const c=new yb(r);return this._records.set(r,c),c.currentValue=o,this._addToAdditions(c),c}_reset(){if(this.isDirty){let r;for(this._previousMapHead=this._mapHead,r=this._previousMapHead;null!==r;r=r._next)r._nextPrevious=r._next;for(r=this._changesHead;null!==r;r=r._nextChanged)r.previousValue=r.currentValue;for(r=this._additionsHead;null!=r;r=r._nextAdded)r.previousValue=r.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(r,o){Object.is(o,r.currentValue)||(r.previousValue=r.currentValue,r.currentValue=o,this._addToChanges(r))}_addToAdditions(r){null===this._additionsHead?this._additionsHead=this._additionsTail=r:(this._additionsTail._nextAdded=r,this._additionsTail=r)}_addToChanges(r){null===this._changesHead?this._changesHead=this._changesTail=r:(this._changesTail._nextChanged=r,this._changesTail=r)}_forEach(r,o){r instanceof Map?r.forEach(o):Object.keys(r).forEach(c=>o(r[c],c))}}class yb{constructor(r){this.key=r,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function a(){return new e([new pv])}let e=(()=>{class i{constructor(o){this.factories=o}static create(o,c){if(null!=c){const h=c.factories.slice();o=o.concat(h)}return new i(o)}static extend(o){return{provide:i,useFactory:c=>i.create(o,c||a()),deps:[[i,new ef,new Qd]]}}find(o){const c=this.factories.find(h=>h.supports(o));if(null!=c)return c;throw new Qe(901,"")}}return i.\u0275prov=Wn({token:i,providedIn:"root",factory:a}),i})();function n(){return new s([new L_])}let s=(()=>{class i{constructor(o){this.factories=o}static create(o,c){if(c){const h=c.factories.slice();o=o.concat(h)}return new i(o)}static extend(o){return{provide:i,useFactory:c=>i.create(o,c||n()),deps:[[i,new ef,new Qd]]}}find(o){const c=this.factories.find(f=>f.supports(o));if(c)return c;throw new Qe(901,"")}}return i.\u0275prov=Wn({token:i,providedIn:"root",factory:n}),i})();const g=ob(null,"core",[]);let _=(()=>{class i{constructor(o){}}return i.\u0275fac=function(o){return new(o||i)(Jr(lv))},i.\u0275mod=xn({type:i}),i.\u0275inj=Fi({}),i})()},2313:(zt,Be,Q)=>{Q.d(Be,{H7:()=>rs,b2:()=>Fi,q6:()=>Wn});var j=Q(9808),I=Q(1223);class Me extends j.w_{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class ze extends Me{static makeCurrent(){(0,j.HT)(new ze)}onAndCancel(ue,te,pe){return ue.addEventListener(te,pe,!1),()=>{ue.removeEventListener(te,pe,!1)}}dispatchEvent(ue,te){ue.dispatchEvent(te)}remove(ue){ue.parentNode&&ue.parentNode.removeChild(ue)}createElement(ue,te){return(te=te||this.getDefaultDocument()).createElement(ue)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(ue){return ue.nodeType===Node.ELEMENT_NODE}isShadowRoot(ue){return ue instanceof DocumentFragment}getGlobalEventTarget(ue,te){return"window"===te?window:"document"===te?ue:"body"===te?ue.body:null}getBaseHref(ue){const te=function xt(){return Ie=Ie||document.querySelector("base"),Ie?Ie.getAttribute("href"):null}();return null==te?null:function mt(ge){Ke=Ke||document.createElement("a"),Ke.setAttribute("href",ge);const ue=Ke.pathname;return"/"===ue.charAt(0)?ue:`/${ue}`}(te)}resetBaseElement(){Ie=null}getUserAgent(){return window.navigator.userAgent}getCookie(ue){return(0,j.Mx)(document.cookie,ue)}}let Ke,Ie=null;const Et=new I.OlP("TRANSITION_ID"),me=[{provide:I.ip1,useFactory:function je(ge,ue,te){return()=>{te.get(I.CZH).donePromise.then(()=>{const pe=(0,j.q)(),we=ue.querySelectorAll(`style[ng-transition="${ge}"]`);for(let $t=0;$t<we.length;$t++)pe.remove(we[$t])})}},deps:[Et,j.K0,I.zs3],multi:!0}];class Je{static init(){(0,I.VLi)(new Je)}addToWindow(ue){I.dqk.getAngularTestability=(pe,we=!0)=>{const $t=ue.findTestabilityInTree(pe,we);if(null==$t)throw new Error("Could not find testability for element.");return $t},I.dqk.getAllAngularTestabilities=()=>ue.getAllTestabilities(),I.dqk.getAllAngularRootElements=()=>ue.getAllRootElements(),I.dqk.frameworkStabilizers||(I.dqk.frameworkStabilizers=[]),I.dqk.frameworkStabilizers.push(pe=>{const we=I.dqk.getAllAngularTestabilities();let $t=we.length,xn=!1;const ui=function(ur){xn=xn||ur,$t--,0==$t&&pe(xn)};we.forEach(function(ur){ur.whenStable(ui)})})}findTestabilityInTree(ue,te,pe){if(null==te)return null;const we=ue.getTestability(te);return null!=we?we:pe?(0,j.q)().isShadowRoot(te)?this.findTestabilityInTree(ue,te.host,!0):this.findTestabilityInTree(ue,te.parentElement,!0):null}}let _n=(()=>{class ge{build(){return new XMLHttpRequest}}return ge.\u0275fac=function(te){return new(te||ge)},ge.\u0275prov=I.Yz7({token:ge,factory:ge.\u0275fac}),ge})();const $e=new I.OlP("EventManagerPlugins");let In=(()=>{class ge{constructor(te,pe){this._zone=pe,this._eventNameToPlugin=new Map,te.forEach(we=>we.manager=this),this._plugins=te.slice().reverse()}addEventListener(te,pe,we){return this._findPluginFor(pe).addEventListener(te,pe,we)}addGlobalEventListener(te,pe,we){return this._findPluginFor(pe).addGlobalEventListener(te,pe,we)}getZone(){return this._zone}_findPluginFor(te){const pe=this._eventNameToPlugin.get(te);if(pe)return pe;const we=this._plugins;for(let $t=0;$t<we.length;$t++){const xn=we[$t];if(xn.supports(te))return this._eventNameToPlugin.set(te,xn),xn}throw new Error(`No event manager plugin found for event ${te}`)}}return ge.\u0275fac=function(te){return new(te||ge)(I.LFG($e),I.LFG(I.R0b))},ge.\u0275prov=I.Yz7({token:ge,factory:ge.\u0275fac}),ge})();class Ve{constructor(ue){this._doc=ue}addGlobalEventListener(ue,te,pe){const we=(0,j.q)().getGlobalEventTarget(this._doc,ue);if(!we)throw new Error(`Unsupported event target ${we} for event ${te}`);return this.addEventListener(we,te,pe)}}let Yt=(()=>{class ge{constructor(){this._stylesSet=new Set}addStyles(te){const pe=new Set;te.forEach(we=>{this._stylesSet.has(we)||(this._stylesSet.add(we),pe.add(we))}),this.onStylesAdded(pe)}onStylesAdded(te){}getAllStyles(){return Array.from(this._stylesSet)}}return ge.\u0275fac=function(te){return new(te||ge)},ge.\u0275prov=I.Yz7({token:ge,factory:ge.\u0275fac}),ge})(),Cn=(()=>{class ge extends Yt{constructor(te){super(),this._doc=te,this._hostNodes=new Map,this._hostNodes.set(te.head,[])}_addStylesToHost(te,pe,we){te.forEach($t=>{const xn=this._doc.createElement("style");xn.textContent=$t,we.push(pe.appendChild(xn))})}addHost(te){const pe=[];this._addStylesToHost(this._stylesSet,te,pe),this._hostNodes.set(te,pe)}removeHost(te){const pe=this._hostNodes.get(te);pe&&pe.forEach(pn),this._hostNodes.delete(te)}onStylesAdded(te){this._hostNodes.forEach((pe,we)=>{this._addStylesToHost(te,we,pe)})}ngOnDestroy(){this._hostNodes.forEach(te=>te.forEach(pn))}}return ge.\u0275fac=function(te){return new(te||ge)(I.LFG(j.K0))},ge.\u0275prov=I.Yz7({token:ge,factory:ge.\u0275fac}),ge})();function pn(ge){(0,j.q)().remove(ge)}const gt={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},vt=/%COMP%/g;function Zt(ge,ue,te){for(let pe=0;pe<ue.length;pe++){let we=ue[pe];Array.isArray(we)?Zt(ge,we,te):(we=we.replace(vt,ge),te.push(we))}return te}function En(ge){return ue=>{if("__ngUnwrap__"===ue)return ge;!1===ge(ue)&&(ue.preventDefault(),ue.returnValue=!1)}}let Kt=(()=>{class ge{constructor(te,pe,we){this.eventManager=te,this.sharedStylesHost=pe,this.appId=we,this.rendererByCompId=new Map,this.defaultRenderer=new Nt(te)}createRenderer(te,pe){if(!te||!pe)return this.defaultRenderer;switch(pe.encapsulation){case I.ifc.Emulated:{let we=this.rendererByCompId.get(pe.id);return we||(we=new ht(this.eventManager,this.sharedStylesHost,pe,this.appId),this.rendererByCompId.set(pe.id,we)),we.applyToHost(te),we}case 1:case I.ifc.ShadowDom:return new ye(this.eventManager,this.sharedStylesHost,te,pe);default:if(!this.rendererByCompId.has(pe.id)){const we=Zt(pe.id,pe.styles,[]);this.sharedStylesHost.addStyles(we),this.rendererByCompId.set(pe.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return ge.\u0275fac=function(te){return new(te||ge)(I.LFG(In),I.LFG(Cn),I.LFG(I.AFp))},ge.\u0275prov=I.Yz7({token:ge,factory:ge.\u0275fac}),ge})();class Nt{constructor(ue){this.eventManager=ue,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(ue,te){return te?document.createElementNS(gt[te]||te,ue):document.createElement(ue)}createComment(ue){return document.createComment(ue)}createText(ue){return document.createTextNode(ue)}appendChild(ue,te){ue.appendChild(te)}insertBefore(ue,te,pe){ue&&ue.insertBefore(te,pe)}removeChild(ue,te){ue&&ue.removeChild(te)}selectRootElement(ue,te){let pe="string"==typeof ue?document.querySelector(ue):ue;if(!pe)throw new Error(`The selector "${ue}" did not match any elements`);return te||(pe.textContent=""),pe}parentNode(ue){return ue.parentNode}nextSibling(ue){return ue.nextSibling}setAttribute(ue,te,pe,we){if(we){te=we+":"+te;const $t=gt[we];$t?ue.setAttributeNS($t,te,pe):ue.setAttribute(te,pe)}else ue.setAttribute(te,pe)}removeAttribute(ue,te,pe){if(pe){const we=gt[pe];we?ue.removeAttributeNS(we,te):ue.removeAttribute(`${pe}:${te}`)}else ue.removeAttribute(te)}addClass(ue,te){ue.classList.add(te)}removeClass(ue,te){ue.classList.remove(te)}setStyle(ue,te,pe,we){we&(I.JOm.DashCase|I.JOm.Important)?ue.style.setProperty(te,pe,we&I.JOm.Important?"important":""):ue.style[te]=pe}removeStyle(ue,te,pe){pe&I.JOm.DashCase?ue.style.removeProperty(te):ue.style[te]=""}setProperty(ue,te,pe){ue[te]=pe}setValue(ue,te){ue.nodeValue=te}listen(ue,te,pe){return"string"==typeof ue?this.eventManager.addGlobalEventListener(ue,te,En(pe)):this.eventManager.addEventListener(ue,te,En(pe))}}class ht extends Nt{constructor(ue,te,pe,we){super(ue),this.component=pe;const $t=Zt(we+"-"+pe.id,pe.styles,[]);te.addStyles($t),this.contentAttr=function yt(ge){return"_ngcontent-%COMP%".replace(vt,ge)}(we+"-"+pe.id),this.hostAttr=function Gt(ge){return"_nghost-%COMP%".replace(vt,ge)}(we+"-"+pe.id)}applyToHost(ue){super.setAttribute(ue,this.hostAttr,"")}createElement(ue,te){const pe=super.createElement(ue,te);return super.setAttribute(pe,this.contentAttr,""),pe}}class ye extends Nt{constructor(ue,te,pe,we){super(ue),this.sharedStylesHost=te,this.hostEl=pe,this.shadowRoot=pe.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const $t=Zt(we.id,we.styles,[]);for(let xn=0;xn<$t.length;xn++){const ui=document.createElement("style");ui.textContent=$t[xn],this.shadowRoot.appendChild(ui)}}nodeOrShadowRoot(ue){return ue===this.hostEl?this.shadowRoot:ue}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(ue,te){return super.appendChild(this.nodeOrShadowRoot(ue),te)}insertBefore(ue,te,pe){return super.insertBefore(this.nodeOrShadowRoot(ue),te,pe)}removeChild(ue,te){return super.removeChild(this.nodeOrShadowRoot(ue),te)}parentNode(ue){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(ue)))}}let xe=(()=>{class ge extends Ve{constructor(te){super(te)}supports(te){return!0}addEventListener(te,pe,we){return te.addEventListener(pe,we,!1),()=>this.removeEventListener(te,pe,we)}removeEventListener(te,pe,we){return te.removeEventListener(pe,we)}}return ge.\u0275fac=function(te){return new(te||ge)(I.LFG(j.K0))},ge.\u0275prov=I.Yz7({token:ge,factory:ge.\u0275fac}),ge})();const De=["alt","control","meta","shift"],rt={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Xe={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Lt={alt:ge=>ge.altKey,control:ge=>ge.ctrlKey,meta:ge=>ge.metaKey,shift:ge=>ge.shiftKey};let cn=(()=>{class ge extends Ve{constructor(te){super(te)}supports(te){return null!=ge.parseEventName(te)}addEventListener(te,pe,we){const $t=ge.parseEventName(pe),xn=ge.eventCallback($t.fullKey,we,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>(0,j.q)().onAndCancel(te,$t.domEventName,xn))}static parseEventName(te){const pe=te.toLowerCase().split("."),we=pe.shift();if(0===pe.length||"keydown"!==we&&"keyup"!==we)return null;const $t=ge._normalizeKey(pe.pop());let xn="";if(De.forEach(ur=>{const Wr=pe.indexOf(ur);Wr>-1&&(pe.splice(Wr,1),xn+=ur+".")}),xn+=$t,0!=pe.length||0===$t.length)return null;const ui={};return ui.domEventName=we,ui.fullKey=xn,ui}static getEventFullKey(te){let pe="",we=function Wt(ge){let ue=ge.key;if(null==ue){if(ue=ge.keyIdentifier,null==ue)return"Unidentified";ue.startsWith("U+")&&(ue=String.fromCharCode(parseInt(ue.substring(2),16)),3===ge.location&&Xe.hasOwnProperty(ue)&&(ue=Xe[ue]))}return rt[ue]||ue}(te);return we=we.toLowerCase()," "===we?we="space":"."===we&&(we="dot"),De.forEach($t=>{$t!=we&&Lt[$t](te)&&(pe+=$t+".")}),pe+=we,pe}static eventCallback(te,pe,we){return $t=>{ge.getEventFullKey($t)===te&&we.runGuarded(()=>pe($t))}}static _normalizeKey(te){return"esc"===te?"escape":te}}return ge.\u0275fac=function(te){return new(te||ge)(I.LFG(j.K0))},ge.\u0275prov=I.Yz7({token:ge,factory:ge.\u0275fac}),ge})();const Wn=(0,I.eFA)(I._c5,"browser",[{provide:I.Lbi,useValue:j.bD},{provide:I.g9A,useValue:function qe(){ze.makeCurrent(),Je.init()},multi:!0},{provide:j.K0,useFactory:function ti(){return(0,I.RDi)(document),document},deps:[]}]),lr=[{provide:I.zSh,useValue:"root"},{provide:I.qLn,useFactory:function _t(){return new I.qLn},deps:[]},{provide:$e,useClass:xe,multi:!0,deps:[j.K0,I.R0b,I.Lbi]},{provide:$e,useClass:cn,multi:!0,deps:[j.K0]},{provide:Kt,useClass:Kt,deps:[In,Cn,I.AFp]},{provide:I.FYo,useExisting:Kt},{provide:Yt,useExisting:Cn},{provide:Cn,useClass:Cn,deps:[j.K0]},{provide:I.dDg,useClass:I.dDg,deps:[I.R0b]},{provide:In,useClass:In,deps:[$e,I.R0b]},{provide:j.JF,useClass:_n,deps:[]}];let Fi=(()=>{class ge{constructor(te){if(te)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(te){return{ngModule:ge,providers:[{provide:I.AFp,useValue:te.appId},{provide:Et,useExisting:I.AFp},me]}}}return ge.\u0275fac=function(te){return new(te||ge)(I.LFG(ge,12))},ge.\u0275mod=I.oAB({type:ge}),ge.\u0275inj=I.cJS({providers:lr,imports:[j.ez,I.hGG]}),ge})();"undefined"!=typeof window&&window;let rs=(()=>{class ge{}return ge.\u0275fac=function(te){return new(te||ge)},ge.\u0275prov=I.Yz7({token:ge,factory:function(te){let pe=null;return pe=te?new(te||ge):I.LFG($i),pe},providedIn:"root"}),ge})(),$i=(()=>{class ge extends rs{constructor(te){super(),this._doc=te}sanitize(te,pe){if(null==pe)return null;switch(te){case I.q3G.NONE:return pe;case I.q3G.HTML:return(0,I.qzn)(pe,"HTML")?(0,I.z3N)(pe):(0,I.EiD)(this._doc,String(pe)).toString();case I.q3G.STYLE:return(0,I.qzn)(pe,"Style")?(0,I.z3N)(pe):pe;case I.q3G.SCRIPT:if((0,I.qzn)(pe,"Script"))return(0,I.z3N)(pe);throw new Error("unsafe value used in a script context");case I.q3G.URL:return(0,I.yhl)(pe),(0,I.qzn)(pe,"URL")?(0,I.z3N)(pe):(0,I.mCW)(String(pe));case I.q3G.RESOURCE_URL:if((0,I.qzn)(pe,"ResourceURL"))return(0,I.z3N)(pe);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${te} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(te){return(0,I.JVY)(te)}bypassSecurityTrustStyle(te){return(0,I.L6k)(te)}bypassSecurityTrustScript(te){return(0,I.eBb)(te)}bypassSecurityTrustUrl(te){return(0,I.LAX)(te)}bypassSecurityTrustResourceUrl(te){return(0,I.pB0)(te)}}return ge.\u0275fac=function(te){return new(te||ge)(I.LFG(j.K0))},ge.\u0275prov=I.Yz7({token:ge,factory:function(te){let pe=null;return pe=te?new te:function Ss(ge){return new $i(ge.get(j.K0))}(I.LFG(I.zs3)),pe},providedIn:"root"}),ge})()},6324:(zt,Be,Q)=>{Q.d(Be,{F0:()=>pr,yS:()=>qs,Bz:()=>$d,lC:()=>Gs});var j=Q(1223),I=Q(2076),Me=Q(9646),ze=Q(7579);class Ie extends ze.x{constructor(v){super(),this._value=v}get value(){return this.getValue()}_subscribe(v){const y=super._subscribe(v);return!y.closed&&v.next(this._value),y}getValue(){const{hasError:v,thrownError:y,_value:A}=this;if(v)throw y;return this._throwIfClosed(),A}next(v){super.next(this._value=v)}}var xt=Q(8306),Ke=Q(4742),mt=Q(4671),Et=Q(3268),je=Q(7669),me=Q(1810),Je=Q(5403),_n=Q(9672);function Ve(m,v,y){m?(0,_n.f)(y,m,v):v()}var Yt=Q(576);function Cn(m,v){const y=(0,Yt.m)(m)?m:()=>m,A=O=>O.error(y());return new xt.y(v?O=>v.schedule(A,0,O):A)}var pn=Q(6805),gt=Q(8189);function Ze(...m){return function vt(){return(0,gt.J)(1)}()((0,I.D)(m,(0,je.yG)(m)))}var Qe=Q(8421);function bn(m){return new xt.y(v=>{(0,Qe.Xf)(m()).subscribe(v)})}var Ne=Q(515),yt=Q(727),Gt=Q(4482);function Zt(){return(0,Gt.e)((m,v)=>{let y=null;m._refCount++;const A=(0,Je.x)(v,void 0,void 0,void 0,()=>{if(!m||m._refCount<=0||0<--m._refCount)return void(y=null);const O=m._connection,z=y;y=null,O&&(!z||O===z)&&O.unsubscribe(),v.unsubscribe()});m.subscribe(A),A.closed||(y=m.connect())})}class En extends xt.y{constructor(v,y){super(),this.source=v,this.subjectFactory=y,this._subject=null,this._refCount=0,this._connection=null,(0,Gt.A)(v)&&(this.lift=v.lift)}_subscribe(v){return this.getSubject().subscribe(v)}getSubject(){const v=this._subject;return(!v||v.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:v}=this;this._subject=this._connection=null,null==v||v.unsubscribe()}connect(){let v=this._connection;if(!v){v=this._connection=new yt.w0;const y=this.getSubject();v.add(this.source.subscribe((0,Je.x)(y,void 0,()=>{this._teardown(),y.complete()},A=>{this._teardown(),y.error(A)},()=>this._teardown()))),v.closed&&(this._connection=null,v=yt.w0.EMPTY)}return v}refCount(){return Zt()(this)}}var ft=Q(4004);function Kt(m,v){return(0,Gt.e)((y,A)=>{let O=null,z=0,H=!1;const J=()=>H&&!O&&A.complete();y.subscribe((0,Je.x)(A,ae=>{null==O||O.unsubscribe();let Se=0;const et=z++;(0,Qe.Xf)(m(ae,et)).subscribe(O=(0,Je.x)(A,lt=>A.next(v?v(ae,lt,et,Se++):lt),()=>{O=null,J()}))},()=>{H=!0,J()}))})}var Nt=Q(5698);function Ut(m,v,y,A,O){return(z,H)=>{let J=y,ae=v,Se=0;z.subscribe((0,Je.x)(H,et=>{const lt=Se++;ae=J?m(ae,et,lt):(J=!0,et),A&&H.next(ae)},O&&(()=>{J&&H.next(ae),H.complete()})))}}function ht(m,v){return(0,Gt.e)(Ut(m,v,arguments.length>=2,!0))}var ye=Q(9300);function xe(m){return(0,Gt.e)((v,y)=>{let z,A=null,O=!1;A=v.subscribe((0,Je.x)(y,void 0,void 0,H=>{z=(0,Qe.Xf)(m(H,xe(m)(v))),A?(A.unsubscribe(),A=null,z.subscribe(y)):O=!0})),O&&(A.unsubscribe(),A=null,z.subscribe(y))})}var De=Q(4351);function Re(m){return m<=0?()=>Ne.E:(0,Gt.e)((v,y)=>{let A=[];v.subscribe((0,Je.x)(y,O=>{A.push(O),m<A.length&&A.shift()},()=>{for(const O of A)y.next(O);y.complete()},void 0,()=>{A=null}))})}var rt=Q(8068),Xe=Q(6590),cn=Q(590),Wt=Q(5577);function qe(m,v,y){const A=(0,Yt.m)(m)||v||y?{next:m,error:v,complete:y}:m;return A?(0,Gt.e)((O,z)=>{var H;null===(H=A.subscribe)||void 0===H||H.call(A);let J=!0;O.subscribe((0,Je.x)(z,ae=>{var Se;null===(Se=A.next)||void 0===Se||Se.call(A,ae),z.next(ae)},()=>{var ae;J=!1,null===(ae=A.complete)||void 0===ae||ae.call(A),z.complete()},ae=>{var Se;J=!1,null===(Se=A.error)||void 0===Se||Se.call(A,ae),z.error(ae)},()=>{var ae,Se;J&&(null===(ae=A.unsubscribe)||void 0===ae||ae.call(A)),null===(Se=A.finalize)||void 0===Se||Se.call(A)}))}):mt.y}var ti=Q(9808);class Gn{constructor(v,y){this.id=v,this.url=y}}class Wn extends Gn{constructor(v,y,A="imperative",O=null){super(v,y),this.navigationTrigger=A,this.restoredState=O}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class lr extends Gn{constructor(v,y,A){super(v,y),this.urlAfterRedirects=A}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Fi extends Gn{constructor(v,y,A){super(v,y),this.reason=A}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Hr extends Gn{constructor(v,y,A){super(v,y),this.error=A}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class fs extends Gn{constructor(v,y,A,O){super(v,y),this.urlAfterRedirects=A,this.state=O}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class nc extends Gn{constructor(v,y,A,O){super(v,y),this.urlAfterRedirects=A,this.state=O}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ci extends Gn{constructor(v,y,A,O,z){super(v,y),this.urlAfterRedirects=A,this.state=O,this.shouldActivate=z}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class ks extends Gn{constructor(v,y,A,O){super(v,y),this.urlAfterRedirects=A,this.state=O}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class oo extends Gn{constructor(v,y,A,O){super(v,y),this.urlAfterRedirects=A,this.state=O}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class ao{constructor(v){this.route=v}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class ha{constructor(v){this.route=v}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class yl{constructor(v){this.snapshot=v}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class jt{constructor(v){this.snapshot=v}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class cr{constructor(v){this.snapshot=v}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Bn{constructor(v){this.snapshot=v}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class kt{constructor(v,y,A){this.routerEvent=v,this.position=y,this.anchor=A}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const nt="primary";class da{constructor(v){this.params=v||{}}has(v){return Object.prototype.hasOwnProperty.call(this.params,v)}get(v){if(this.has(v)){const y=this.params[v];return Array.isArray(y)?y[0]:y}return null}getAll(v){if(this.has(v)){const y=this.params[v];return Array.isArray(y)?y:[y]}return[]}get keys(){return Object.keys(this.params)}}function Di(m){return new da(m)}const pi="ngNavigationCancelingError";function Ni(m){const v=Error("NavigationCancelingError: "+m);return v[pi]=!0,v}function is(m,v,y){const A=y.path.split("/");if(A.length>m.length||"full"===y.pathMatch&&(v.hasChildren()||A.length<m.length))return null;const O={};for(let z=0;z<A.length;z++){const H=A[z],J=m[z];if(H.startsWith(":"))O[H.substring(1)]=J;else if(H!==J.path)return null}return{consumed:m.slice(0,A.length),posParams:O}}function Ir(m,v){const y=m?Object.keys(m):void 0,A=v?Object.keys(v):void 0;if(!y||!A||y.length!=A.length)return!1;let O;for(let z=0;z<y.length;z++)if(O=y[z],!Vn(m[O],v[O]))return!1;return!0}function Vn(m,v){if(Array.isArray(m)&&Array.isArray(v)){if(m.length!==v.length)return!1;const y=[...m].sort(),A=[...v].sort();return y.every((O,z)=>A[z]===O)}return m===v}function ka(m){return Array.prototype.concat.apply([],m)}function jn(m){return m.length>0?m[m.length-1]:null}function ci(m,v){for(const y in m)m.hasOwnProperty(y)&&v(m[y],y)}function Tn(m){return(0,j.CqO)(m)?m:(0,j.QGY)(m)?(0,I.D)(Promise.resolve(m)):(0,Me.of)(m)}const ps={exact:function $i(m,v,y){if(!ui(m.segments,v.segments)||!te(m.segments,v.segments,y)||m.numberOfChildren!==v.numberOfChildren)return!1;for(const A in v.children)if(!m.children[A]||!$i(m.children[A],v.children[A],y))return!1;return!0},subset:ge},Gr={exact:function Ss(m,v){return Ir(m,v)},subset:function Us(m,v){return Object.keys(v).length<=Object.keys(m).length&&Object.keys(v).every(y=>Vn(m[y],v[y]))},ignored:()=>!0};function rs(m,v,y){return ps[y.paths](m.root,v.root,y.matrixParams)&&Gr[y.queryParams](m.queryParams,v.queryParams)&&!("exact"===y.fragment&&m.fragment!==v.fragment)}function ge(m,v,y){return ue(m,v,v.segments,y)}function ue(m,v,y,A){if(m.segments.length>y.length){const O=m.segments.slice(0,y.length);return!(!ui(O,y)||v.hasChildren()||!te(O,y,A))}if(m.segments.length===y.length){if(!ui(m.segments,y)||!te(m.segments,y,A))return!1;for(const O in v.children)if(!m.children[O]||!ge(m.children[O],v.children[O],A))return!1;return!0}{const O=y.slice(0,m.segments.length),z=y.slice(m.segments.length);return!!(ui(m.segments,O)&&te(m.segments,O,A)&&m.children[nt])&&ue(m.children[nt],v,z,A)}}function te(m,v,y){return v.every((A,O)=>Gr[y](m[O].parameters,A.parameters))}class pe{constructor(v,y,A){this.root=v,this.queryParams=y,this.fragment=A}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Di(this.queryParams)),this._queryParamMap}toString(){return Ri.serialize(this)}}class we{constructor(v,y){this.segments=v,this.children=y,this.parent=null,ci(y,(A,O)=>A.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return xr(this)}}class $t{constructor(v,y){this.path=v,this.parameters=y}get parameterMap(){return this._parameterMap||(this._parameterMap=Di(this.parameters)),this._parameterMap}toString(){return hi(this)}}function ui(m,v){return m.length===v.length&&m.every((y,A)=>y.path===v[A].path)}class Wr{}class hr{parse(v){const y=new Pr(v);return new pe(y.parseRootSegment(),y.parseQueryParams(),y.parseFragment())}serialize(v){const y=`/${er(v.root,!0)}`,A=function Mr(m){const v=Object.keys(m).map(y=>{const A=m[y];return Array.isArray(A)?A.map(O=>`${Cs(y)}=${Cs(O)}`).join("&"):`${Cs(y)}=${Cs(A)}`}).filter(y=>!!y);return v.length?`?${v.join("&")}`:""}(v.queryParams);return`${y}${A}${"string"==typeof v.fragment?`#${function Lo(m){return encodeURI(m)}(v.fragment)}`:""}`}}const Ri=new hr;function xr(m){return m.segments.map(v=>hi(v)).join("/")}function er(m,v){if(!m.hasChildren())return xr(m);if(v){const y=m.children[nt]?er(m.children[nt],!1):"",A=[];return ci(m.children,(O,z)=>{z!==nt&&A.push(`${z}:${er(O,!1)}`)}),A.length>0?`${y}(${A.join("//")})`:y}{const y=function ur(m,v){let y=[];return ci(m.children,(A,O)=>{O===nt&&(y=y.concat(v(A,O)))}),ci(m.children,(A,O)=>{O!==nt&&(y=y.concat(v(A,O)))}),y}(m,(A,O)=>O===nt?[er(m.children[nt],!1)]:[`${O}:${er(A,!1)}`]);return 1===Object.keys(m.children).length&&null!=m.children[nt]?`${xr(m)}/${y[0]}`:`${xr(m)}/(${y.join("//")})`}}function tr(m){return encodeURIComponent(m).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Cs(m){return tr(m).replace(/%3B/gi,";")}function Ii(m){return tr(m).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Ts(m){return decodeURIComponent(m)}function mi(m){return Ts(m.replace(/\+/g,"%20"))}function hi(m){return`${Ii(m.path)}${function Ua(m){return Object.keys(m).map(v=>`;${Ii(v)}=${Ii(m[v])}`).join("")}(m.parameters)}`}const Mt=/^[^\/()?;=#]+/;function dn(m){const v=m.match(Mt);return v?v[0]:""}const si=/^[^=?&#]+/,Bs=/^[^&#]+/;class Pr{constructor(v){this.url=v,this.remaining=v}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new we([],{}):new we([],this.parseChildren())}parseQueryParams(){const v={};if(this.consumeOptional("?"))do{this.parseQueryParam(v)}while(this.consumeOptional("&"));return v}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const v=[];for(this.peekStartsWith("(")||v.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),v.push(this.parseSegment());let y={};this.peekStartsWith("/(")&&(this.capture("/"),y=this.parseParens(!0));let A={};return this.peekStartsWith("(")&&(A=this.parseParens(!1)),(v.length>0||Object.keys(y).length>0)&&(A[nt]=new we(v,y)),A}parseSegment(){const v=dn(this.remaining);if(""===v&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(v),new $t(Ts(v),this.parseMatrixParams())}parseMatrixParams(){const v={};for(;this.consumeOptional(";");)this.parseParam(v);return v}parseParam(v){const y=dn(this.remaining);if(!y)return;this.capture(y);let A="";if(this.consumeOptional("=")){const O=dn(this.remaining);O&&(A=O,this.capture(A))}v[Ts(y)]=Ts(A)}parseQueryParam(v){const y=function dr(m){const v=m.match(si);return v?v[0]:""}(this.remaining);if(!y)return;this.capture(y);let A="";if(this.consumeOptional("=")){const H=function vi(m){const v=m.match(Bs);return v?v[0]:""}(this.remaining);H&&(A=H,this.capture(A))}const O=mi(y),z=mi(A);if(v.hasOwnProperty(O)){let H=v[O];Array.isArray(H)||(H=[H],v[O]=H),H.push(z)}else v[O]=z}parseParens(v){const y={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const A=dn(this.remaining),O=this.remaining[A.length];if("/"!==O&&")"!==O&&";"!==O)throw new Error(`Cannot parse url '${this.url}'`);let z;A.indexOf(":")>-1?(z=A.substr(0,A.indexOf(":")),this.capture(z),this.capture(":")):v&&(z=nt);const H=this.parseChildren();y[z]=1===Object.keys(H).length?H[nt]:new we([],H),this.consumeOptional("//")}return y}peekStartsWith(v){return this.remaining.startsWith(v)}consumeOptional(v){return!!this.peekStartsWith(v)&&(this.remaining=this.remaining.substring(v.length),!0)}capture(v){if(!this.consumeOptional(v))throw new Error(`Expected "${v}".`)}}class oi{constructor(v){this._root=v}get root(){return this._root.value}parent(v){const y=this.pathFromRoot(v);return y.length>1?y[y.length-2]:null}children(v){const y=jr(v,this._root);return y?y.children.map(A=>A.value):[]}firstChild(v){const y=jr(v,this._root);return y&&y.children.length>0?y.children[0].value:null}siblings(v){const y=As(v,this._root);return y.length<2?[]:y[y.length-2].children.map(O=>O.value).filter(O=>O!==v)}pathFromRoot(v){return As(v,this._root).map(y=>y.value)}}function jr(m,v){if(m===v.value)return v;for(const y of v.children){const A=jr(m,y);if(A)return A}return null}function As(m,v){if(m===v.value)return[v];for(const y of v.children){const A=As(m,y);if(A.length)return A.unshift(v),A}return[]}class qt{constructor(v,y){this.value=v,this.children=y}toString(){return`TreeNode(${this.value})`}}function $r(m){const v={};return m&&m.children.forEach(y=>v[y.value.outlet]=y),v}class Lr extends oi{constructor(v,y){super(v),this.snapshot=y,fa(this,v)}toString(){return this.snapshot.toString()}}function Ds(m,v){const y=function Rs(m,v){const H=new ki([],{},{},"",{},nt,v,null,m.root,-1,{});return new $n("",new qt(H,[]))}(m,v),A=new Ie([new $t("",{})]),O=new Ie({}),z=new Ie({}),H=new Ie({}),J=new Ie(""),ae=new wi(A,O,H,J,z,nt,v,y.root);return ae.snapshot=y.root,new Lr(new qt(ae,[]),y)}class wi{constructor(v,y,A,O,z,H,J,ae){this.url=v,this.params=y,this.queryParams=A,this.fragment=O,this.data=z,this.outlet=H,this.component=J,this._futureSnapshot=ae}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,ft.U)(v=>Di(v)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,ft.U)(v=>Di(v)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Is(m,v="emptyOnly"){const y=m.pathFromRoot;let A=0;if("always"!==v)for(A=y.length-1;A>=1;){const O=y[A],z=y[A-1];if(O.routeConfig&&""===O.routeConfig.path)A--;else{if(z.component)break;A--}}return function Ps(m){return m.reduce((v,y)=>({params:Object.assign(Object.assign({},v.params),y.params),data:Object.assign(Object.assign({},v.data),y.data),resolve:Object.assign(Object.assign({},v.resolve),y._resolvedData)}),{params:{},data:{},resolve:{}})}(y.slice(A))}class ki{constructor(v,y,A,O,z,H,J,ae,Se,et,lt){this.url=v,this.params=y,this.queryParams=A,this.fragment=O,this.data=z,this.outlet=H,this.component=J,this.routeConfig=ae,this._urlSegment=Se,this._lastPathIndex=et,this._resolve=lt}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Di(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Di(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(A=>A.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class $n extends oi{constructor(v,y){super(y),this.url=v,fa(this,y)}toString(){return Oo(this._root)}}function fa(m,v){v.value._routerState=m,v.children.forEach(y=>fa(m,y))}function Oo(m){const v=m.children.length>0?` { ${m.children.map(Oo).join(", ")} } `:"";return`${m.value}${v}`}function Pi(m){if(m.snapshot){const v=m.snapshot,y=m._futureSnapshot;m.snapshot=y,Ir(v.queryParams,y.queryParams)||m.queryParams.next(y.queryParams),v.fragment!==y.fragment&&m.fragment.next(y.fragment),Ir(v.params,y.params)||m.params.next(y.params),function on(m,v){if(m.length!==v.length)return!1;for(let y=0;y<m.length;++y)if(!Ir(m[y],v[y]))return!1;return!0}(v.url,y.url)||m.url.next(y.url),Ir(v.data,y.data)||m.data.next(y.data)}else m.snapshot=m._futureSnapshot,m.data.next(m._futureSnapshot.data)}function Nn(m,v){const y=Ir(m.params,v.params)&&function xn(m,v){return ui(m,v)&&m.every((y,A)=>Ir(y.parameters,v[A].parameters))}(m.url,v.url);return y&&!(!m.parent!=!v.parent)&&(!m.parent||Nn(m.parent,v.parent))}function ss(m,v,y){if(y&&m.shouldReuseRoute(v.value,y.value.snapshot)){const A=y.value;A._futureSnapshot=v.value;const O=function Fo(m,v,y){return v.children.map(A=>{for(const O of y.children)if(m.shouldReuseRoute(A.value,O.value.snapshot))return ss(m,A,O);return ss(m,A)})}(m,v,y);return new qt(A,O)}{if(m.shouldAttach(v.value)){const z=m.retrieve(v.value);if(null!==z){const H=z.route;return H.value._futureSnapshot=v.value,H.children=v.children.map(J=>ss(m,J)),H}}const A=function Ui(m){return new wi(new Ie(m.url),new Ie(m.params),new Ie(m.queryParams),new Ie(m.fragment),new Ie(m.data),m.outlet,m.component,m)}(v.value),O=v.children.map(z=>ss(m,z));return new qt(A,O)}}function No(m){return"object"==typeof m&&null!=m&&!m.outlets&&!m.segmentPath}function ma(m){return"object"==typeof m&&null!=m&&m.outlets}function os(m,v,y,A,O){let z={};if(A&&ci(A,(J,ae)=>{z[ae]=Array.isArray(J)?J.map(Se=>`${Se}`):`${J}`}),m===v)return new pe(y,z,O);const H=Ls(m,v,y);return new pe(H,z,O)}function Ls(m,v,y){const A={};return ci(m.children,(O,z)=>{A[z]=O===v?y:Ls(O,v,y)}),new we(m.segments,A)}class Bi{constructor(v,y,A){if(this.isAbsolute=v,this.numberOfDoubleDots=y,this.commands=A,v&&A.length>0&&No(A[0]))throw new Error("Root segment cannot have matrix parameters");const O=A.find(ma);if(O&&O!==jn(A))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class ga{constructor(v,y,A){this.segmentGroup=v,this.processChildren=y,this.index=A}}function rc(m,v,y){if(m||(m=new we([],{})),0===m.segments.length&&m.hasChildren())return Ba(m,v,y);const A=function uu(m,v,y){let A=0,O=v;const z={match:!1,pathIndex:0,commandIndex:0};for(;O<m.segments.length;){if(A>=y.length)return z;const H=m.segments[O],J=y[A];if(ma(J))break;const ae=`${J}`,Se=A<y.length-1?y[A+1]:null;if(O>0&&void 0===ae)break;if(ae&&Se&&"object"==typeof Se&&void 0===Se.outlets){if(!va(ae,Se,H))return z;A+=2}else{if(!va(ae,{},H))return z;A++}O++}return{match:!0,pathIndex:O,commandIndex:A}}(m,v,y),O=y.slice(A.commandIndex);if(A.match&&A.pathIndex<m.segments.length){const z=new we(m.segments.slice(0,A.pathIndex),{});return z.children[nt]=new we(m.segments.slice(A.pathIndex),m.children),Ba(z,0,O)}return A.match&&0===O.length?new we(m.segments,{}):A.match&&!m.hasChildren()?lo(m,v,y):A.match?Ba(m,0,O):lo(m,v,y)}function Ba(m,v,y){if(0===y.length)return new we(m.segments,{});{const A=function ic(m){return ma(m[0])?m[0].outlets:{[nt]:m}}(y),O={};return ci(A,(z,H)=>{"string"==typeof z&&(z=[z]),null!==z&&(O[H]=rc(m.children[H],v,z))}),ci(m.children,(z,H)=>{void 0===A[H]&&(O[H]=z)}),new we(m.segments,O)}}function lo(m,v,y){const A=m.segments.slice(0,v);let O=0;for(;O<y.length;){const z=y[O];if(ma(z)){const ae=yh(z.outlets);return new we(A,ae)}if(0===O&&No(y[0])){A.push(new $t(m.segments[v].path,hu(y[0]))),O++;continue}const H=ma(z)?z.outlets[nt]:`${z}`,J=O<y.length-1?y[O+1]:null;H&&J&&No(J)?(A.push(new $t(H,hu(J))),O+=2):(A.push(new $t(H,{})),O++)}return new we(A,{})}function yh(m){const v={};return ci(m,(y,A)=>{"string"==typeof y&&(y=[y]),null!==y&&(v[A]=lo(new we([],{}),0,y))}),v}function hu(m){const v={};return ci(m,(y,A)=>v[A]=`${y}`),v}function va(m,v,y){return m==y.path&&Ir(v,y.parameters)}class Va{constructor(v,y,A,O){this.routeReuseStrategy=v,this.futureState=y,this.currState=A,this.forwardEvent=O}activate(v){const y=this.futureState._root,A=this.currState?this.currState._root:null;this.deactivateChildRoutes(y,A,v),Pi(this.futureState.root),this.activateChildRoutes(y,A,v)}deactivateChildRoutes(v,y,A){const O=$r(y);v.children.forEach(z=>{const H=z.value.outlet;this.deactivateRoutes(z,O[H],A),delete O[H]}),ci(O,(z,H)=>{this.deactivateRouteAndItsChildren(z,A)})}deactivateRoutes(v,y,A){const O=v.value,z=y?y.value:null;if(O===z)if(O.component){const H=A.getContext(O.outlet);H&&this.deactivateChildRoutes(v,y,H.children)}else this.deactivateChildRoutes(v,y,A);else z&&this.deactivateRouteAndItsChildren(y,A)}deactivateRouteAndItsChildren(v,y){v.value.component&&this.routeReuseStrategy.shouldDetach(v.value.snapshot)?this.detachAndStoreRouteSubtree(v,y):this.deactivateRouteAndOutlet(v,y)}detachAndStoreRouteSubtree(v,y){const A=y.getContext(v.value.outlet),O=A&&v.value.component?A.children:y,z=$r(v);for(const H of Object.keys(z))this.deactivateRouteAndItsChildren(z[H],O);if(A&&A.outlet){const H=A.outlet.detach(),J=A.children.onOutletDeactivated();this.routeReuseStrategy.store(v.value.snapshot,{componentRef:H,route:v,contexts:J})}}deactivateRouteAndOutlet(v,y){const A=y.getContext(v.value.outlet),O=A&&v.value.component?A.children:y,z=$r(v);for(const H of Object.keys(z))this.deactivateRouteAndItsChildren(z[H],O);A&&A.outlet&&(A.outlet.deactivate(),A.children.onOutletDeactivated(),A.attachRef=null,A.resolver=null,A.route=null)}activateChildRoutes(v,y,A){const O=$r(y);v.children.forEach(z=>{this.activateRoutes(z,O[z.value.outlet],A),this.forwardEvent(new Bn(z.value.snapshot))}),v.children.length&&this.forwardEvent(new jt(v.value.snapshot))}activateRoutes(v,y,A){const O=v.value,z=y?y.value:null;if(Pi(O),O===z)if(O.component){const H=A.getOrCreateContext(O.outlet);this.activateChildRoutes(v,y,H.children)}else this.activateChildRoutes(v,y,A);else if(O.component){const H=A.getOrCreateContext(O.outlet);if(this.routeReuseStrategy.shouldAttach(O.snapshot)){const J=this.routeReuseStrategy.retrieve(O.snapshot);this.routeReuseStrategy.store(O.snapshot,null),H.children.onOutletReAttached(J.contexts),H.attachRef=J.componentRef,H.route=J.route.value,H.outlet&&H.outlet.attach(J.componentRef,J.route.value),Pi(J.route.value),this.activateChildRoutes(v,null,H.children)}else{const J=function _h(m){for(let v=m.parent;v;v=v.parent){const y=v.routeConfig;if(y&&y._loadedConfig)return y._loadedConfig;if(y&&y.component)return null}return null}(O.snapshot),ae=J?J.module.componentFactoryResolver:null;H.attachRef=null,H.route=O,H.resolver=ae,H.outlet&&H.outlet.activateWith(O,ae),this.activateChildRoutes(v,null,H.children)}}else this.activateChildRoutes(v,null,A)}}class _l{constructor(v,y){this.routes=v,this.module=y}}function Xr(m){return"function"==typeof m}function qr(m){return m instanceof pe}const ko=Symbol("INITIAL_VALUE");function Uo(){return Kt(m=>function $e(...m){const v=(0,je.yG)(m),y=(0,je.jO)(m),{args:A,keys:O}=(0,Ke.D)(m);if(0===A.length)return(0,I.D)([],v);const z=new xt.y(function In(m,v,y=mt.y){return A=>{Ve(v,()=>{const{length:O}=m,z=new Array(O);let H=O,J=O;for(let ae=0;ae<O;ae++)Ve(v,()=>{const Se=(0,I.D)(m[ae],v);let et=!1;Se.subscribe((0,Je.x)(A,lt=>{z[ae]=lt,et||(et=!0,J--),J||A.next(y(z.slice()))},()=>{--H||A.complete()}))},A)},A)}}(A,v,O?H=>(0,me.n)(O,H):mt.y));return y?z.pipe((0,Et.Z)(y)):z}(m.map(v=>v.pipe((0,Nt.q)(1),function Qi(...m){const v=(0,je.yG)(m);return(0,Gt.e)((y,A)=>{(v?Ze(m,y,v):Ze(m,y)).subscribe(A)})}(ko)))).pipe(ht((v,y)=>{let A=!1;return y.reduce((O,z,H)=>O!==ko?O:(z===ko&&(A=!0),A||!1!==z&&H!==y.length-1&&!qr(z)?O:z),v)},ko),(0,ye.h)(v=>v!==ko),(0,ft.U)(v=>qr(v)?v:!0===v),(0,Nt.q)(1)))}class wl{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new Hs,this.attachRef=null}}class Hs{constructor(){this.contexts=new Map}onChildOutletCreated(v,y){const A=this.getOrCreateContext(v);A.outlet=y,this.contexts.set(v,A)}onChildOutletDestroyed(v){const y=this.getContext(v);y&&(y.outlet=null,y.attachRef=null)}onOutletDeactivated(){const v=this.contexts;return this.contexts=new Map,v}onOutletReAttached(v){this.contexts=v}getOrCreateContext(v){let y=this.getContext(v);return y||(y=new wl,this.contexts.set(v,y)),y}getContext(v){return this.contexts.get(v)||null}}let Gs=(()=>{class m{constructor(y,A,O,z,H){this.parentContexts=y,this.location=A,this.resolver=O,this.changeDetector=H,this.activated=null,this._activatedRoute=null,this.activateEvents=new j.vpe,this.deactivateEvents=new j.vpe,this.attachEvents=new j.vpe,this.detachEvents=new j.vpe,this.name=z||nt,y.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const y=this.parentContexts.getContext(this.name);y&&y.route&&(y.attachRef?this.attach(y.attachRef,y.route):this.activateWith(y.route,y.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const y=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(y.instance),y}attach(y,A){this.activated=y,this._activatedRoute=A,this.location.insert(y.hostView),this.attachEvents.emit(y.instance)}deactivate(){if(this.activated){const y=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(y)}}activateWith(y,A){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=y;const H=(A=A||this.resolver).resolveComponentFactory(y._futureSnapshot.routeConfig.component),J=this.parentContexts.getOrCreateContext(this.name).children,ae=new Fr(y,J,this.location.injector);this.activated=this.location.createComponent(H,this.location.length,ae),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return m.\u0275fac=function(y){return new(y||m)(j.Y36(Hs),j.Y36(j.s_b),j.Y36(j._Vd),j.$8M("name"),j.Y36(j.sBO))},m.\u0275dir=j.lG2({type:m,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),m})();class Fr{constructor(v,y,A){this.route=v,this.childContexts=y,this.parent=A}get(v,y){return v===wi?this.route:v===Hs?this.childContexts:this.parent.get(v,y)}}let bl=(()=>{class m{}return m.\u0275fac=function(y){return new(y||m)},m.\u0275cmp=j.Xpm({type:m,selectors:[["ng-component"]],decls:1,vars:0,template:function(y,A){1&y&&j._UZ(0,"router-outlet")},directives:[Gs],encapsulation:2}),m})();function El(m,v=""){for(let y=0;y<m.length;y++){const A=m[y];U(A,$(v,A))}}function U(m,v){m.children&&El(m.children,v)}function $(m,v){return v?m||v.path?m&&!v.path?`${m}/`:!m&&v.path?v.path:`${m}/${v.path}`:"":m}function B(m){const v=m.children&&m.children.map(B),y=v?Object.assign(Object.assign({},m),{children:v}):Object.assign({},m);return!y.component&&(v||y.loadChildren)&&y.outlet&&y.outlet!==nt&&(y.component=bl),y}function q(m){return m.outlet||nt}function se(m,v){const y=m.filter(A=>q(A)===v);return y.push(...m.filter(A=>q(A)!==v)),y}const Te={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function He(m,v,y){var A;if(""===v.path)return"full"===v.pathMatch&&(m.hasChildren()||y.length>0)?Object.assign({},Te):{matched:!0,consumedSegments:[],remainingSegments:y,parameters:{},positionalParamSegments:{}};const z=(v.matcher||is)(y,m,v);if(!z)return Object.assign({},Te);const H={};ci(z.posParams,(ae,Se)=>{H[Se]=ae.path});const J=z.consumed.length>0?Object.assign(Object.assign({},H),z.consumed[z.consumed.length-1].parameters):H;return{matched:!0,consumedSegments:z.consumed,remainingSegments:y.slice(z.consumed.length),parameters:J,positionalParamSegments:null!==(A=z.posParams)&&void 0!==A?A:{}}}function st(m,v,y,A,O="corrected"){if(y.length>0&&function en(m,v,y){return y.some(A=>Kn(m,v,A)&&q(A)!==nt)}(m,y,A)){const H=new we(v,function Zn(m,v,y,A){const O={};O[nt]=A,A._sourceSegment=m,A._segmentIndexShift=v.length;for(const z of y)if(""===z.path&&q(z)!==nt){const H=new we([],{});H._sourceSegment=m,H._segmentIndexShift=v.length,O[q(z)]=H}return O}(m,v,A,new we(y,m.children)));return H._sourceSegment=m,H._segmentIndexShift=v.length,{segmentGroup:H,slicedSegments:[]}}if(0===y.length&&function sn(m,v,y){return y.some(A=>Kn(m,v,A))}(m,y,A)){const H=new we(m.segments,function Yn(m,v,y,A,O,z){const H={};for(const J of A)if(Kn(m,y,J)&&!O[q(J)]){const ae=new we([],{});ae._sourceSegment=m,ae._segmentIndexShift="legacy"===z?m.segments.length:v.length,H[q(J)]=ae}return Object.assign(Object.assign({},O),H)}(m,v,y,A,m.children,O));return H._sourceSegment=m,H._segmentIndexShift=v.length,{segmentGroup:H,slicedSegments:y}}const z=new we(m.segments,m.children);return z._sourceSegment=m,z._segmentIndexShift=v.length,{segmentGroup:z,slicedSegments:y}}function Kn(m,v,y){return(!(m.hasChildren()||v.length>0)||"full"!==y.pathMatch)&&""===y.path}function kn(m,v,y,A){return!!(q(m)===A||A!==nt&&Kn(v,y,m))&&("**"===m.path||He(v,m,y).matched)}function Pn(m,v,y){return 0===v.length&&!m.children[y]}class br{constructor(v){this.segmentGroup=v||null}}class Vi{constructor(v){this.urlTree=v}}function zn(m){return Cn(new br(m))}function ai(m){return Cn(new Vi(m))}class as{constructor(v,y,A,O,z){this.configLoader=y,this.urlSerializer=A,this.urlTree=O,this.config=z,this.allowRedirects=!0,this.ngModule=v.get(j.h0i)}apply(){const v=st(this.urlTree.root,[],[],this.config).segmentGroup,y=new we(v.segments,v.children);return this.expandSegmentGroup(this.ngModule,this.config,y,nt).pipe((0,ft.U)(z=>this.createUrlTree(fi(z),this.urlTree.queryParams,this.urlTree.fragment))).pipe(xe(z=>{if(z instanceof Vi)return this.allowRedirects=!1,this.match(z.urlTree);throw z instanceof br?this.noMatchError(z):z}))}match(v){return this.expandSegmentGroup(this.ngModule,this.config,v.root,nt).pipe((0,ft.U)(O=>this.createUrlTree(fi(O),v.queryParams,v.fragment))).pipe(xe(O=>{throw O instanceof br?this.noMatchError(O):O}))}noMatchError(v){return new Error(`Cannot match any routes. URL Segment: '${v.segmentGroup}'`)}createUrlTree(v,y,A){const O=v.segments.length>0?new we([],{[nt]:v}):v;return new pe(O,y,A)}expandSegmentGroup(v,y,A,O){return 0===A.segments.length&&A.hasChildren()?this.expandChildren(v,y,A).pipe((0,ft.U)(z=>new we([],z))):this.expandSegment(v,A,y,A.segments,O,!0)}expandChildren(v,y,A){const O=[];for(const z of Object.keys(A.children))"primary"===z?O.unshift(z):O.push(z);return(0,I.D)(O).pipe((0,De.b)(z=>{const H=A.children[z],J=se(y,z);return this.expandSegmentGroup(v,J,H,z).pipe((0,ft.U)(ae=>({segment:ae,outlet:z})))}),ht((z,H)=>(z[H.outlet]=H.segment,z),{}),function Lt(m,v){const y=arguments.length>=2;return A=>A.pipe(m?(0,ye.h)((O,z)=>m(O,z,A)):mt.y,Re(1),y?(0,Xe.d)(v):(0,rt.T)(()=>new pn.K))}())}expandSegment(v,y,A,O,z,H){return(0,I.D)(A).pipe((0,De.b)(J=>this.expandSegmentAgainstRoute(v,y,A,J,O,z,H).pipe(xe(Se=>{if(Se instanceof br)return(0,Me.of)(null);throw Se}))),(0,cn.P)(J=>!!J),xe((J,ae)=>{if(J instanceof pn.K||"EmptyError"===J.name)return Pn(y,O,z)?(0,Me.of)(new we([],{})):zn(y);throw J}))}expandSegmentAgainstRoute(v,y,A,O,z,H,J){return kn(O,y,z,H)?void 0===O.redirectTo?this.matchSegmentAgainstRoute(v,y,O,z,H):J&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(v,y,A,O,z,H):zn(y):zn(y)}expandSegmentAgainstRouteUsingRedirect(v,y,A,O,z,H){return"**"===O.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(v,A,O,H):this.expandRegularSegmentAgainstRouteUsingRedirect(v,y,A,O,z,H)}expandWildCardWithParamsAgainstRouteUsingRedirect(v,y,A,O){const z=this.applyRedirectCommands([],A.redirectTo,{});return A.redirectTo.startsWith("/")?ai(z):this.lineralizeSegments(A,z).pipe((0,Wt.z)(H=>{const J=new we(H,{});return this.expandSegment(v,J,y,H,O,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(v,y,A,O,z,H){const{matched:J,consumedSegments:ae,remainingSegments:Se,positionalParamSegments:et}=He(y,O,z);if(!J)return zn(y);const lt=this.applyRedirectCommands(ae,O.redirectTo,et);return O.redirectTo.startsWith("/")?ai(lt):this.lineralizeSegments(O,lt).pipe((0,Wt.z)(Ot=>this.expandSegment(v,y,A,Ot.concat(Se),H,!1)))}matchSegmentAgainstRoute(v,y,A,O,z){if("**"===A.path)return A.loadChildren?(A._loadedConfig?(0,Me.of)(A._loadedConfig):this.configLoader.load(v.injector,A)).pipe((0,ft.U)(lt=>(A._loadedConfig=lt,new we(O,{})))):(0,Me.of)(new we(O,{}));const{matched:H,consumedSegments:J,remainingSegments:ae}=He(y,A,O);return H?this.getChildConfig(v,A,O).pipe((0,Wt.z)(et=>{const lt=et.module,Ot=et.routes,{segmentGroup:Dt,slicedSegments:Mn}=st(y,J,ae,Ot),ni=new we(Dt.segments,Dt.children);if(0===Mn.length&&ni.hasChildren())return this.expandChildren(lt,Ot,ni).pipe((0,ft.U)(Sr=>new we(J,Sr)));if(0===Ot.length&&0===Mn.length)return(0,Me.of)(new we(J,{}));const Xi=q(A)===z;return this.expandSegment(lt,ni,Ot,Mn,Xi?nt:z,!0).pipe((0,ft.U)(un=>new we(J.concat(un.segments),un.children)))})):zn(y)}getChildConfig(v,y,A){return y.children?(0,Me.of)(new _l(y.children,v)):y.loadChildren?void 0!==y._loadedConfig?(0,Me.of)(y._loadedConfig):this.runCanLoadGuards(v.injector,y,A).pipe((0,Wt.z)(O=>O?this.configLoader.load(v.injector,y).pipe((0,ft.U)(z=>(y._loadedConfig=z,z))):function ms(m){return Cn(Ni(`Cannot load children because the guard of the route "path: '${m.path}'" returned false`))}(y))):(0,Me.of)(new _l([],v))}runCanLoadGuards(v,y,A){const O=y.canLoad;if(!O||0===O.length)return(0,Me.of)(!0);const z=O.map(H=>{const J=v.get(H);let ae;if(function uo(m){return m&&Xr(m.canLoad)}(J))ae=J.canLoad(y,A);else{if(!Xr(J))throw new Error("Invalid CanLoad guard");ae=J(y,A)}return Tn(ae)});return(0,Me.of)(z).pipe(Uo(),qe(H=>{if(!qr(H))return;const J=Ni(`Redirecting to "${this.urlSerializer.serialize(H)}"`);throw J.url=H,J}),(0,ft.U)(H=>!0===H))}lineralizeSegments(v,y){let A=[],O=y.root;for(;;){if(A=A.concat(O.segments),0===O.numberOfChildren)return(0,Me.of)(A);if(O.numberOfChildren>1||!O.children[nt])return Cn(new Error(`Only absolute redirects can have named outlets. redirectTo: '${v.redirectTo}'`));O=O.children[nt]}}applyRedirectCommands(v,y,A){return this.applyRedirectCreatreUrlTree(y,this.urlSerializer.parse(y),v,A)}applyRedirectCreatreUrlTree(v,y,A,O){const z=this.createSegmentGroup(v,y.root,A,O);return new pe(z,this.createQueryParams(y.queryParams,this.urlTree.queryParams),y.fragment)}createQueryParams(v,y){const A={};return ci(v,(O,z)=>{if("string"==typeof O&&O.startsWith(":")){const J=O.substring(1);A[z]=y[J]}else A[z]=O}),A}createSegmentGroup(v,y,A,O){const z=this.createSegments(v,y.segments,A,O);let H={};return ci(y.children,(J,ae)=>{H[ae]=this.createSegmentGroup(v,J,A,O)}),new we(z,H)}createSegments(v,y,A,O){return y.map(z=>z.path.startsWith(":")?this.findPosParam(v,z,O):this.findOrReturn(z,A))}findPosParam(v,y,A){const O=A[y.path.substring(1)];if(!O)throw new Error(`Cannot redirect to '${v}'. Cannot find '${y.path}'.`);return O}findOrReturn(v,y){let A=0;for(const O of y){if(O.path===v.path)return y.splice(A),O;A++}return v}}function fi(m){const v={};for(const A of Object.keys(m.children)){const z=fi(m.children[A]);(z.segments.length>0||z.hasChildren())&&(v[A]=z)}return function du(m){if(1===m.numberOfChildren&&m.children[nt]){const v=m.children[nt];return new we(m.segments.concat(v.segments),v.children)}return m}(new we(m.segments,v))}class oc{constructor(v){this.path=v,this.route=this.path[this.path.length-1]}}class gs{constructor(v,y){this.component=v,this.route=y}}function Wd(m,v,y){const A=m._root;return po(A,v?v._root:null,y,[A.value])}function fo(m,v,y){const A=function Sl(m){if(!m)return null;for(let v=m.parent;v;v=v.parent){const y=v.routeConfig;if(y&&y._loadedConfig)return y._loadedConfig}return null}(v);return(A?A.module.injector:y).get(m)}function po(m,v,y,A,O={canDeactivateChecks:[],canActivateChecks:[]}){const z=$r(v);return m.children.forEach(H=>{(function xh(m,v,y,A,O={canDeactivateChecks:[],canActivateChecks:[]}){const z=m.value,H=v?v.value:null,J=y?y.getContext(m.value.outlet):null;if(H&&z.routeConfig===H.routeConfig){const ae=function Ue(m,v,y){if("function"==typeof y)return y(m,v);switch(y){case"pathParamsChange":return!ui(m.url,v.url);case"pathParamsOrQueryParamsChange":return!ui(m.url,v.url)||!Ir(m.queryParams,v.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Nn(m,v)||!Ir(m.queryParams,v.queryParams);default:return!Nn(m,v)}}(H,z,z.routeConfig.runGuardsAndResolvers);ae?O.canActivateChecks.push(new oc(A)):(z.data=H.data,z._resolvedData=H._resolvedData),po(m,v,z.component?J?J.children:null:y,A,O),ae&&J&&J.outlet&&J.outlet.isActivated&&O.canDeactivateChecks.push(new gs(J.outlet.component,H))}else H&&an(v,J,O),O.canActivateChecks.push(new oc(A)),po(m,null,z.component?J?J.children:null:y,A,O)})(H,z[H.value.outlet],y,A.concat([H.value]),O),delete z[H.value.outlet]}),ci(z,(H,J)=>an(H,y.getContext(J),O)),O}function an(m,v,y){const A=$r(m),O=m.value;ci(A,(z,H)=>{an(z,O.component?v?v.children.getContext(H):null:v,y)}),y.canDeactivateChecks.push(new gs(O.component&&v&&v.outlet&&v.outlet.isActivated?v.outlet.component:null,O))}class mo{}function ya(m){return new xt.y(v=>v.error(m))}class nr{constructor(v,y,A,O,z,H){this.rootComponentType=v,this.config=y,this.urlTree=A,this.url=O,this.paramsInheritanceStrategy=z,this.relativeLinkResolution=H}recognize(){const v=st(this.urlTree.root,[],[],this.config.filter(H=>void 0===H.redirectTo),this.relativeLinkResolution).segmentGroup,y=this.processSegmentGroup(this.config,v,nt);if(null===y)return null;const A=new ki([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},nt,this.rootComponentType,null,this.urlTree.root,-1,{}),O=new qt(A,y),z=new $n(this.url,O);return this.inheritParamsAndData(z._root),z}inheritParamsAndData(v){const y=v.value,A=Is(y,this.paramsInheritanceStrategy);y.params=Object.freeze(A.params),y.data=Object.freeze(A.data),v.children.forEach(O=>this.inheritParamsAndData(O))}processSegmentGroup(v,y,A){return 0===y.segments.length&&y.hasChildren()?this.processChildren(v,y):this.processSegment(v,y,y.segments,A)}processChildren(v,y){const A=[];for(const z of Object.keys(y.children)){const H=y.children[z],J=se(v,z),ae=this.processSegmentGroup(J,H,z);if(null===ae)return null;A.push(...ae)}const O=Yr(A);return function Ws(m){m.sort((v,y)=>v.value.outlet===nt?-1:y.value.outlet===nt?1:v.value.outlet.localeCompare(y.value.outlet))}(O),O}processSegment(v,y,A,O){for(const z of v){const H=this.processSegmentAgainstRoute(z,y,A,O);if(null!==H)return H}return Pn(y,A,O)?[]:null}processSegmentAgainstRoute(v,y,A,O){if(v.redirectTo||!kn(v,y,A,O))return null;let z,H=[],J=[];if("**"===v.path){const Dt=A.length>0?jn(A).parameters:{};z=new ki(A,Dt,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,uc(v),q(v),v.component,v,Ga(y),Wa(y)+A.length,Vo(v))}else{const Dt=He(y,v,A);if(!Dt.matched)return null;H=Dt.consumedSegments,J=Dt.remainingSegments,z=new ki(H,Dt.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,uc(v),q(v),v.component,v,Ga(y),Wa(y)+H.length,Vo(v))}const ae=function Tl(m){return m.children?m.children:m.loadChildren?m._loadedConfig.routes:[]}(v),{segmentGroup:Se,slicedSegments:et}=st(y,H,J,ae.filter(Dt=>void 0===Dt.redirectTo),this.relativeLinkResolution);if(0===et.length&&Se.hasChildren()){const Dt=this.processChildren(ae,Se);return null===Dt?null:[new qt(z,Dt)]}if(0===ae.length&&0===et.length)return[new qt(z,[])];const lt=q(v)===O,Ot=this.processSegment(ae,Se,et,lt?nt:O);return null===Ot?null:[new qt(z,Ot)]}}function Bo(m){const v=m.value.routeConfig;return v&&""===v.path&&void 0===v.redirectTo}function Yr(m){const v=[],y=new Set;for(const A of m){if(!Bo(A)){v.push(A);continue}const O=v.find(z=>A.value.routeConfig===z.value.routeConfig);void 0!==O?(O.children.push(...A.children),y.add(O)):v.push(A)}for(const A of y){const O=Yr(A.children);v.push(new qt(A.value,O))}return v.filter(A=>!y.has(A))}function Ga(m){let v=m;for(;v._sourceSegment;)v=v._sourceSegment;return v}function Wa(m){let v=m,y=v._segmentIndexShift?v._segmentIndexShift:0;for(;v._sourceSegment;)v=v._sourceSegment,y+=v._segmentIndexShift?v._segmentIndexShift:0;return y-1}function uc(m){return m.data||{}}function Vo(m){return m.resolve||{}}function $a(m){return[...Object.keys(m),...Object.getOwnPropertySymbols(m)]}function _a(m){return Kt(v=>{const y=m(v);return y?(0,I.D)(y).pipe((0,ft.U)(()=>v)):(0,Me.of)(v)})}class fc extends class Rl{shouldDetach(v){return!1}store(v,y){}shouldAttach(v){return!1}retrieve(v){return null}shouldReuseRoute(v,y){return v.routeConfig===y.routeConfig}}{}const js=new j.OlP("ROUTES");class pc{constructor(v,y,A,O){this.injector=v,this.compiler=y,this.onLoadStartListener=A,this.onLoadEndListener=O}load(v,y){if(y._loader$)return y._loader$;this.onLoadStartListener&&this.onLoadStartListener(y);const O=this.loadModuleFactory(y.loadChildren).pipe((0,ft.U)(z=>{this.onLoadEndListener&&this.onLoadEndListener(y);const H=z.create(v);return new _l(ka(H.injector.get(js,void 0,j.XFs.Self|j.XFs.Optional)).map(B),H)}),xe(z=>{throw y._loader$=void 0,z}));return y._loader$=new En(O,()=>new ze.x).pipe(Zt()),y._loader$}loadModuleFactory(v){return Tn(v()).pipe((0,Wt.z)(y=>y instanceof j.YKP?(0,Me.of)(y):(0,I.D)(this.compiler.compileModuleAsync(y))))}}class ir{shouldProcessUrl(v){return!0}extract(v){return v}merge(v,y){return v}}function $s(m){throw m}function yi(m,v,y){return v.parse("/")}function xa(m,v){return(0,Me.of)(null)}const pu={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Il={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let pr=(()=>{class m{constructor(y,A,O,z,H,J,ae){this.rootComponentType=y,this.urlSerializer=A,this.rootContexts=O,this.location=z,this.config=ae,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new ze.x,this.errorHandler=$s,this.malformedUriErrorHandler=yi,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:xa,afterPreactivation:xa},this.urlHandlingStrategy=new ir,this.routeReuseStrategy=new fc,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=H.get(j.h0i),this.console=H.get(j.c2e);const lt=H.get(j.R0b);this.isNgZoneEnabled=lt instanceof j.R0b&&j.R0b.isInAngularZone(),this.resetConfig(ae),this.currentUrlTree=function Fn(){return new pe(new we([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new pc(H,J,Ot=>this.triggerEvent(new ao(Ot)),Ot=>this.triggerEvent(new ha(Ot))),this.routerState=Ds(this.currentUrlTree,this.rootComponentType),this.transitions=new Ie({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var y;return null===(y=this.location.getState())||void 0===y?void 0:y.\u0275routerPageId}setupNavigations(y){const A=this.events;return y.pipe((0,ye.h)(O=>0!==O.id),(0,ft.U)(O=>Object.assign(Object.assign({},O),{extractedUrl:this.urlHandlingStrategy.extract(O.rawUrl)})),Kt(O=>{let z=!1,H=!1;return(0,Me.of)(O).pipe(qe(J=>{this.currentNavigation={id:J.id,initialUrl:J.currentRawUrl,extractedUrl:J.extractedUrl,trigger:J.source,extras:J.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),Kt(J=>{const ae=this.browserUrlTree.toString(),Se=!this.navigated||J.extractedUrl.toString()!==ae||ae!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||Se)&&this.urlHandlingStrategy.shouldProcessUrl(J.rawUrl))return Xs(J.source)&&(this.browserUrlTree=J.extractedUrl),(0,Me.of)(J).pipe(Kt(lt=>{const Ot=this.transitions.getValue();return A.next(new Wn(lt.id,this.serializeUrl(lt.extractedUrl),lt.source,lt.restoredState)),Ot!==this.transitions.getValue()?Ne.E:Promise.resolve(lt)}),function nn(m,v,y,A){return Kt(O=>function sc(m,v,y,A,O){return new as(m,v,y,A,O).apply()}(m,v,y,O.extractedUrl,A).pipe((0,ft.U)(z=>Object.assign(Object.assign({},O),{urlAfterRedirects:z}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),qe(lt=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:lt.urlAfterRedirects})}),function Al(m,v,y,A,O){return(0,Wt.z)(z=>function lc(m,v,y,A,O="emptyOnly",z="legacy"){try{const H=new nr(m,v,y,A,O,z).recognize();return null===H?ya(new mo):(0,Me.of)(H)}catch(H){return ya(H)}}(m,v,z.urlAfterRedirects,y(z.urlAfterRedirects),A,O).pipe((0,ft.U)(H=>Object.assign(Object.assign({},z),{targetSnapshot:H}))))}(this.rootComponentType,this.config,lt=>this.serializeUrl(lt),this.paramsInheritanceStrategy,this.relativeLinkResolution),qe(lt=>{if("eager"===this.urlUpdateStrategy){if(!lt.extras.skipLocationChange){const Dt=this.urlHandlingStrategy.merge(lt.urlAfterRedirects,lt.rawUrl);this.setBrowserUrl(Dt,lt)}this.browserUrlTree=lt.urlAfterRedirects}const Ot=new fs(lt.id,this.serializeUrl(lt.extractedUrl),this.serializeUrl(lt.urlAfterRedirects),lt.targetSnapshot);A.next(Ot)}));if(Se&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:Ot,extractedUrl:Dt,source:Mn,restoredState:ni,extras:Xi}=J,ln=new Wn(Ot,this.serializeUrl(Dt),Mn,ni);A.next(ln);const un=Ds(Dt,this.rootComponentType).snapshot;return(0,Me.of)(Object.assign(Object.assign({},J),{targetSnapshot:un,urlAfterRedirects:Dt,extras:Object.assign(Object.assign({},Xi),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=J.rawUrl,J.resolve(null),Ne.E}),_a(J=>{const{targetSnapshot:ae,id:Se,extractedUrl:et,rawUrl:lt,extras:{skipLocationChange:Ot,replaceUrl:Dt}}=J;return this.hooks.beforePreactivation(ae,{navigationId:Se,appliedUrlTree:et,rawUrlTree:lt,skipLocationChange:!!Ot,replaceUrl:!!Dt})}),qe(J=>{const ae=new nc(J.id,this.serializeUrl(J.extractedUrl),this.serializeUrl(J.urlAfterRedirects),J.targetSnapshot);this.triggerEvent(ae)}),(0,ft.U)(J=>Object.assign(Object.assign({},J),{guards:Wd(J.targetSnapshot,J.currentSnapshot,this.rootContexts)})),function Ha(m,v){return(0,Wt.z)(y=>{const{targetSnapshot:A,currentSnapshot:O,guards:{canActivateChecks:z,canDeactivateChecks:H}}=y;return 0===H.length&&0===z.length?(0,Me.of)(Object.assign(Object.assign({},y),{guardsResult:!0})):function Li(m,v,y,A){return(0,I.D)(m).pipe((0,Wt.z)(O=>function jd(m,v,y,A,O){const z=v&&v.routeConfig?v.routeConfig.canDeactivate:null;if(!z||0===z.length)return(0,Me.of)(!0);const H=z.map(J=>{const ae=fo(J,v,O);let Se;if(function za(m){return m&&Xr(m.canDeactivate)}(ae))Se=Tn(ae.canDeactivate(m,v,y,A));else{if(!Xr(ae))throw new Error("Invalid CanDeactivate guard");Se=Tn(ae(m,v,y,A))}return Se.pipe((0,cn.P)())});return(0,Me.of)(H).pipe(Uo())}(O.component,O.route,y,v,A)),(0,cn.P)(O=>!0!==O,!0))}(H,A,O,m).pipe((0,Wt.z)(J=>J&&function Or(m){return"boolean"==typeof m}(J)?function Cl(m,v,y,A){return(0,I.D)(v).pipe((0,De.b)(O=>Ze(function ys(m,v){return null!==m&&v&&v(new yl(m)),(0,Me.of)(!0)}(O.route.parent,A),function vs(m,v){return null!==m&&v&&v(new cr(m)),(0,Me.of)(!0)}(O.route,A),function ac(m,v,y){const A=v[v.length-1],z=v.slice(0,v.length-1).reverse().map(H=>function ho(m){const v=m.routeConfig?m.routeConfig.canActivateChild:null;return v&&0!==v.length?{node:m,guards:v}:null}(H)).filter(H=>null!==H).map(H=>bn(()=>{const J=H.guards.map(ae=>{const Se=fo(ae,H.node,y);let et;if(function Ml(m){return m&&Xr(m.canActivateChild)}(Se))et=Tn(Se.canActivateChild(A,m));else{if(!Xr(Se))throw new Error("Invalid CanActivateChild guard");et=Tn(Se(A,m))}return et.pipe((0,cn.P)())});return(0,Me.of)(J).pipe(Uo())}));return(0,Me.of)(z).pipe(Uo())}(m,O.path,y),function Er(m,v,y){const A=v.routeConfig?v.routeConfig.canActivate:null;if(!A||0===A.length)return(0,Me.of)(!0);const O=A.map(z=>bn(()=>{const H=fo(z,v,y);let J;if(function xl(m){return m&&Xr(m.canActivate)}(H))J=Tn(H.canActivate(v,m));else{if(!Xr(H))throw new Error("Invalid CanActivate guard");J=Tn(H(v,m))}return J.pipe((0,cn.P)())}));return(0,Me.of)(O).pipe(Uo())}(m,O.route,y))),(0,cn.P)(O=>!0!==O,!0))}(A,z,m,v):(0,Me.of)(J)),(0,ft.U)(J=>Object.assign(Object.assign({},y),{guardsResult:J})))})}(this.ngModule.injector,J=>this.triggerEvent(J)),qe(J=>{if(qr(J.guardsResult)){const Se=Ni(`Redirecting to "${this.serializeUrl(J.guardsResult)}"`);throw Se.url=J.guardsResult,Se}const ae=new Ci(J.id,this.serializeUrl(J.extractedUrl),this.serializeUrl(J.urlAfterRedirects),J.targetSnapshot,!!J.guardsResult);this.triggerEvent(ae)}),(0,ye.h)(J=>!!J.guardsResult||(this.restoreHistory(J),this.cancelNavigationTransition(J,""),!1)),_a(J=>{if(J.guards.canActivateChecks.length)return(0,Me.of)(J).pipe(qe(ae=>{const Se=new ks(ae.id,this.serializeUrl(ae.extractedUrl),this.serializeUrl(ae.urlAfterRedirects),ae.targetSnapshot);this.triggerEvent(Se)}),Kt(ae=>{let Se=!1;return(0,Me.of)(ae).pipe(function ja(m,v){return(0,Wt.z)(y=>{const{targetSnapshot:A,guards:{canActivateChecks:O}}=y;if(!O.length)return(0,Me.of)(y);let z=0;return(0,I.D)(O).pipe((0,De.b)(H=>function hc(m,v,y,A){return function Dl(m,v,y,A){const O=$a(m);if(0===O.length)return(0,Me.of)({});const z={};return(0,I.D)(O).pipe((0,Wt.z)(H=>function Xa(m,v,y,A){const O=fo(m,v,A);return Tn(O.resolve?O.resolve(v,y):O(v,y))}(m[H],v,y,A).pipe(qe(J=>{z[H]=J}))),Re(1),(0,Wt.z)(()=>$a(z).length===O.length?(0,Me.of)(z):Ne.E))}(m._resolve,m,v,A).pipe((0,ft.U)(z=>(m._resolvedData=z,m.data=Object.assign(Object.assign({},m.data),Is(m,y).resolve),null)))}(H.route,A,m,v)),qe(()=>z++),Re(1),(0,Wt.z)(H=>z===O.length?(0,Me.of)(y):Ne.E))})}(this.paramsInheritanceStrategy,this.ngModule.injector),qe({next:()=>Se=!0,complete:()=>{Se||(this.restoreHistory(ae),this.cancelNavigationTransition(ae,"At least one route resolver didn't emit any value."))}}))}),qe(ae=>{const Se=new oo(ae.id,this.serializeUrl(ae.extractedUrl),this.serializeUrl(ae.urlAfterRedirects),ae.targetSnapshot);this.triggerEvent(Se)}))}),_a(J=>{const{targetSnapshot:ae,id:Se,extractedUrl:et,rawUrl:lt,extras:{skipLocationChange:Ot,replaceUrl:Dt}}=J;return this.hooks.afterPreactivation(ae,{navigationId:Se,appliedUrlTree:et,rawUrlTree:lt,skipLocationChange:!!Ot,replaceUrl:!!Dt})}),(0,ft.U)(J=>{const ae=function pa(m,v,y){const A=ss(m,v._root,y?y._root:void 0);return new Lr(A,v)}(this.routeReuseStrategy,J.targetSnapshot,J.currentRouterState);return Object.assign(Object.assign({},J),{targetRouterState:ae})}),qe(J=>{this.currentUrlTree=J.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(J.urlAfterRedirects,J.rawUrl),this.routerState=J.targetRouterState,"deferred"===this.urlUpdateStrategy&&(J.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,J),this.browserUrlTree=J.urlAfterRedirects)}),((m,v,y)=>(0,ft.U)(A=>(new Va(v,A.targetRouterState,A.currentRouterState,y).activate(m),A)))(this.rootContexts,this.routeReuseStrategy,J=>this.triggerEvent(J)),qe({next(){z=!0},complete(){z=!0}}),function _t(m){return(0,Gt.e)((v,y)=>{try{v.subscribe(y)}finally{y.add(m)}})}(()=>{var J;z||H||this.cancelNavigationTransition(O,`Navigation ID ${O.id} is not equal to the current navigation id ${this.navigationId}`),(null===(J=this.currentNavigation)||void 0===J?void 0:J.id)===O.id&&(this.currentNavigation=null)}),xe(J=>{if(H=!0,function Mi(m){return m&&m[pi]}(J)){const ae=qr(J.url);ae||(this.navigated=!0,this.restoreHistory(O,!0));const Se=new Fi(O.id,this.serializeUrl(O.extractedUrl),J.message);A.next(Se),ae?setTimeout(()=>{const et=this.urlHandlingStrategy.merge(J.url,this.rawUrlTree),lt={skipLocationChange:O.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||Xs(O.source)};this.scheduleNavigation(et,"imperative",null,lt,{resolve:O.resolve,reject:O.reject,promise:O.promise})},0):O.resolve(!1)}else{this.restoreHistory(O,!0);const ae=new Hr(O.id,this.serializeUrl(O.extractedUrl),J);A.next(ae);try{O.resolve(this.errorHandler(J))}catch(Se){O.reject(Se)}}return Ne.E}))}))}resetRootComponentType(y){this.rootComponentType=y,this.routerState.root.component=this.rootComponentType}setTransition(y){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),y))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(y=>{const A="popstate"===y.type?"popstate":"hashchange";"popstate"===A&&setTimeout(()=>{var O;const z={replaceUrl:!0},H=(null===(O=y.state)||void 0===O?void 0:O.navigationId)?y.state:null;if(H){const ae=Object.assign({},H);delete ae.navigationId,delete ae.\u0275routerPageId,0!==Object.keys(ae).length&&(z.state=ae)}const J=this.parseUrl(y.url);this.scheduleNavigation(J,A,H,z)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(y){this.events.next(y)}resetConfig(y){El(y),this.config=y.map(B),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(y,A={}){const{relativeTo:O,queryParams:z,fragment:H,queryParamsHandling:J,preserveFragment:ae}=A,Se=O||this.routerState.root,et=ae?this.currentUrlTree.fragment:H;let lt=null;switch(J){case"merge":lt=Object.assign(Object.assign({},this.currentUrlTree.queryParams),z);break;case"preserve":lt=this.currentUrlTree.queryParams;break;default:lt=z||null}return null!==lt&&(lt=this.removeEmptyProps(lt)),function fr(m,v,y,A,O){if(0===y.length)return os(v.root,v.root,v.root,A,O);const z=function wr(m){if("string"==typeof m[0]&&1===m.length&&"/"===m[0])return new Bi(!0,0,m);let v=0,y=!1;const A=m.reduce((O,z,H)=>{if("object"==typeof z&&null!=z){if(z.outlets){const J={};return ci(z.outlets,(ae,Se)=>{J[Se]="string"==typeof ae?ae.split("/"):ae}),[...O,{outlets:J}]}if(z.segmentPath)return[...O,z.segmentPath]}return"string"!=typeof z?[...O,z]:0===H?(z.split("/").forEach((J,ae)=>{0==ae&&"."===J||(0==ae&&""===J?y=!0:".."===J?v++:""!=J&&O.push(J))}),O):[...O,z]},[]);return new Bi(y,v,A)}(y);if(z.toRoot())return os(v.root,v.root,new we([],{}),A,O);const H=function Vs(m,v,y){if(m.isAbsolute)return new ga(v.root,!0,0);if(-1===y.snapshot._lastPathIndex){const z=y.snapshot._urlSegment;return new ga(z,z===v.root,0)}const A=No(m.commands[0])?0:1;return function zs(m,v,y){let A=m,O=v,z=y;for(;z>O;){if(z-=O,A=A.parent,!A)throw new Error("Invalid number of '../'");O=A.segments.length}return new ga(A,!1,O-z)}(y.snapshot._urlSegment,y.snapshot._lastPathIndex+A,m.numberOfDoubleDots)}(z,v,m),J=H.processChildren?Ba(H.segmentGroup,H.index,z.commands):rc(H.segmentGroup,H.index,z.commands);return os(v.root,H.segmentGroup,J,A,O)}(Se,this.currentUrlTree,y,lt,null!=et?et:null)}navigateByUrl(y,A={skipLocationChange:!1}){const O=qr(y)?y:this.parseUrl(y),z=this.urlHandlingStrategy.merge(O,this.rawUrlTree);return this.scheduleNavigation(z,"imperative",null,A)}navigate(y,A={skipLocationChange:!1}){return function mu(m){for(let v=0;v<m.length;v++){const y=m[v];if(null==y)throw new Error(`The requested path contains ${y} segment at index ${v}`)}}(y),this.navigateByUrl(this.createUrlTree(y,A),A)}serializeUrl(y){return this.urlSerializer.serialize(y)}parseUrl(y){let A;try{A=this.urlSerializer.parse(y)}catch(O){A=this.malformedUriErrorHandler(O,this.urlSerializer,y)}return A}isActive(y,A){let O;if(O=!0===A?Object.assign({},pu):!1===A?Object.assign({},Il):A,qr(y))return rs(this.currentUrlTree,y,O);const z=this.parseUrl(y);return rs(this.currentUrlTree,z,O)}removeEmptyProps(y){return Object.keys(y).reduce((A,O)=>{const z=y[O];return null!=z&&(A[O]=z),A},{})}processNavigations(){this.navigations.subscribe(y=>{this.navigated=!0,this.lastSuccessfulId=y.id,this.currentPageId=y.targetPageId,this.events.next(new lr(y.id,this.serializeUrl(y.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,y.resolve(!0)},y=>{this.console.warn(`Unhandled Navigation Error: ${y}`)})}scheduleNavigation(y,A,O,z,H){var J,ae;if(this.disposed)return Promise.resolve(!1);let Se,et,lt;H?(Se=H.resolve,et=H.reject,lt=H.promise):lt=new Promise((Mn,ni)=>{Se=Mn,et=ni});const Ot=++this.navigationId;let Dt;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(O=this.location.getState()),Dt=O&&O.\u0275routerPageId?O.\u0275routerPageId:z.replaceUrl||z.skipLocationChange?null!==(J=this.browserPageId)&&void 0!==J?J:0:(null!==(ae=this.browserPageId)&&void 0!==ae?ae:0)+1):Dt=0,this.setTransition({id:Ot,targetPageId:Dt,source:A,restoredState:O,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:y,extras:z,resolve:Se,reject:et,promise:lt,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),lt.catch(Mn=>Promise.reject(Mn))}setBrowserUrl(y,A){const O=this.urlSerializer.serialize(y),z=Object.assign(Object.assign({},A.extras.state),this.generateNgRouterState(A.id,A.targetPageId));this.location.isCurrentPathEqualTo(O)||A.extras.replaceUrl?this.location.replaceState(O,"",z):this.location.go(O,"",z)}restoreHistory(y,A=!1){var O,z;if("computed"===this.canceledNavigationResolution){const H=this.currentPageId-y.targetPageId;"popstate"!==y.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(O=this.currentNavigation)||void 0===O?void 0:O.finalUrl)||0===H?this.currentUrlTree===(null===(z=this.currentNavigation)||void 0===z?void 0:z.finalUrl)&&0===H&&(this.resetState(y),this.browserUrlTree=y.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(H)}else"replace"===this.canceledNavigationResolution&&(A&&this.resetState(y),this.resetUrlToCurrentUrlTree())}resetState(y){this.routerState=y.currentRouterState,this.currentUrlTree=y.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,y.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(y,A){const O=new Fi(y.id,this.serializeUrl(y.extractedUrl),A);this.triggerEvent(O),y.resolve(!1)}generateNgRouterState(y,A){return"computed"===this.canceledNavigationResolution?{navigationId:y,\u0275routerPageId:A}:{navigationId:y}}}return m.\u0275fac=function(y){j.$Z()},m.\u0275prov=j.Yz7({token:m,factory:m.\u0275fac}),m})();function Xs(m){return"imperative"!==m}let qs=(()=>{class m{constructor(y,A,O){this.router=y,this.route=A,this.locationStrategy=O,this.commands=null,this.href=null,this.onChanges=new ze.x,this.subscription=y.events.subscribe(z=>{z instanceof lr&&this.updateTargetUrlAndHref()})}set routerLink(y){this.commands=null!=y?Array.isArray(y)?y:[y]:null}ngOnChanges(y){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(y,A,O,z,H){if(0!==y||A||O||z||H||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)return!0;const J={skipLocationChange:Ys(this.skipLocationChange),replaceUrl:Ys(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,J),!1}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:Ys(this.preserveFragment)})}}return m.\u0275fac=function(y){return new(y||m)(j.Y36(pr),j.Y36(wi),j.Y36(ti.S$))},m.\u0275dir=j.lG2({type:m,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(y,A){1&y&&j.NdJ("click",function(z){return A.onClick(z.button,z.ctrlKey,z.shiftKey,z.altKey,z.metaKey)}),2&y&&j.uIk("target",A.target)("href",A.href,j.LSH)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[j.TTD]}),m})();function Ys(m){return""===m||!!m}class qa{}class Zs{preload(v,y){return(0,Me.of)(null)}}let Ho=(()=>{class m{constructor(y,A,O,z){this.router=y,this.injector=O,this.preloadingStrategy=z,this.loader=new pc(O,A,ae=>y.triggerEvent(new ao(ae)),ae=>y.triggerEvent(new ha(ae)))}setUpPreloading(){this.subscription=this.router.events.pipe((0,ye.h)(y=>y instanceof lr),(0,De.b)(()=>this.preload())).subscribe(()=>{})}preload(){const y=this.injector.get(j.h0i);return this.processRoutes(y,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(y,A){const O=[];for(const z of A)if(z.loadChildren&&!z.canLoad&&z._loadedConfig){const H=z._loadedConfig;O.push(this.processRoutes(H.module,H.routes))}else z.loadChildren&&!z.canLoad?O.push(this.preloadConfig(y,z)):z.children&&O.push(this.processRoutes(y,z.children));return(0,I.D)(O).pipe((0,gt.J)(),(0,ft.U)(z=>{}))}preloadConfig(y,A){return this.preloadingStrategy.preload(A,()=>(A._loadedConfig?(0,Me.of)(A._loadedConfig):this.loader.load(y.injector,A)).pipe((0,Wt.z)(z=>(A._loadedConfig=z,this.processRoutes(z.module,z.routes)))))}}return m.\u0275fac=function(y){return new(y||m)(j.LFG(pr),j.LFG(j.Sil),j.LFG(j.zs3),j.LFG(qa))},m.\u0275prov=j.Yz7({token:m,factory:m.\u0275fac}),m})(),Ks=(()=>{class m{constructor(y,A,O={}){this.router=y,this.viewportScroller=A,this.options=O,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},O.scrollPositionRestoration=O.scrollPositionRestoration||"disabled",O.anchorScrolling=O.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(y=>{y instanceof Wn?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=y.navigationTrigger,this.restoredId=y.restoredState?y.restoredState.navigationId:0):y instanceof lr&&(this.lastId=y.id,this.scheduleScrollEvent(y,this.router.parseUrl(y.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(y=>{y instanceof kt&&(y.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(y.position):y.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(y.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(y,A){this.router.triggerEvent(new kt(y,"popstate"===this.lastSource?this.store[this.restoredId]:null,A))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return m.\u0275fac=function(y){j.$Z()},m.\u0275prov=j.Yz7({token:m,factory:m.\u0275fac}),m})();const ls=new j.OlP("ROUTER_CONFIGURATION"),mc=new j.OlP("ROUTER_FORROOT_GUARD"),Mh=[ti.Ye,{provide:Wr,useClass:hr},{provide:pr,useFactory:function go(m,v,y,A,O,z,H={},J,ae){const Se=new pr(null,m,v,y,A,O,ka(z));return J&&(Se.urlHandlingStrategy=J),ae&&(Se.routeReuseStrategy=ae),function wh(m,v){m.errorHandler&&(v.errorHandler=m.errorHandler),m.malformedUriErrorHandler&&(v.malformedUriErrorHandler=m.malformedUriErrorHandler),m.onSameUrlNavigation&&(v.onSameUrlNavigation=m.onSameUrlNavigation),m.paramsInheritanceStrategy&&(v.paramsInheritanceStrategy=m.paramsInheritanceStrategy),m.relativeLinkResolution&&(v.relativeLinkResolution=m.relativeLinkResolution),m.urlUpdateStrategy&&(v.urlUpdateStrategy=m.urlUpdateStrategy),m.canceledNavigationResolution&&(v.canceledNavigationResolution=m.canceledNavigationResolution)}(H,Se),H.enableTracing&&Se.events.subscribe(et=>{var lt,Ot;null===(lt=console.group)||void 0===lt||lt.call(console,`Router Event: ${et.constructor.name}`),console.log(et.toString()),console.log(et),null===(Ot=console.groupEnd)||void 0===Ot||Ot.call(console)}),Se},deps:[Wr,Hs,ti.Ye,j.zs3,j.Sil,js,ls,[class fu{},new j.FiY],[class dc{},new j.FiY]]},Hs,{provide:wi,useFactory:function _s(m){return m.routerState.root},deps:[pr]},Ho,Zs,class Zr{preload(v,y){return y().pipe(xe(()=>(0,Me.of)(null)))}},{provide:ls,useValue:{enableTracing:!1}}];function jp(){return new j.PXZ("Router",pr)}let $d=(()=>{class m{constructor(y,A){}static forRoot(y,A){return{ngModule:m,providers:[Mh,Ya(y),{provide:mc,useFactory:vu,deps:[[pr,new j.FiY,new j.tp0]]},{provide:ls,useValue:A||{}},{provide:ti.S$,useFactory:Wo,deps:[ti.lw,[new j.tBr(ti.mr),new j.FiY],ls]},{provide:Ks,useFactory:Ll,deps:[pr,ti.EM,ls]},{provide:qa,useExisting:A&&A.preloadingStrategy?A.preloadingStrategy:Zs},{provide:j.PXZ,multi:!0,useFactory:jp},[rn,{provide:j.ip1,multi:!0,useFactory:Nr,deps:[rn]},{provide:gc,useFactory:Ol,deps:[rn]},{provide:j.tb,multi:!0,useExisting:gc}]]}}static forChild(y){return{ngModule:m,providers:[Ya(y)]}}}return m.\u0275fac=function(y){return new(y||m)(j.LFG(mc,8),j.LFG(pr,8))},m.\u0275mod=j.oAB({type:m}),m.\u0275inj=j.cJS({}),m})();function Ll(m,v,y){return y.scrollOffset&&v.setOffset(y.scrollOffset),new Ks(m,v,y)}function Wo(m,v,y={}){return y.useHash?new ti.Do(m,v):new ti.b0(m,v)}function vu(m){return"guarded"}function Ya(m){return[{provide:j.deG,multi:!0,useValue:m},{provide:js,multi:!0,useValue:m}]}let rn=(()=>{class m{constructor(y){this.injector=y,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new ze.x}appInitializer(){return this.injector.get(ti.V_,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let A=null;const O=new Promise(J=>A=J),z=this.injector.get(pr),H=this.injector.get(ls);return"disabled"===H.initialNavigation?(z.setUpLocationChangeListener(),A(!0)):"enabled"===H.initialNavigation||"enabledBlocking"===H.initialNavigation?(z.hooks.afterPreactivation=()=>this.initNavigation?(0,Me.of)(null):(this.initNavigation=!0,A(!0),this.resultOfPreactivationDone),z.initialNavigation()):A(!0),O})}bootstrapListener(y){const A=this.injector.get(ls),O=this.injector.get(Ho),z=this.injector.get(Ks),H=this.injector.get(pr),J=this.injector.get(j.z2F);y===J.components[0]&&(("enabledNonBlocking"===A.initialNavigation||void 0===A.initialNavigation)&&H.initialNavigation(),O.setUpPreloading(),z.init(),H.resetRootComponentType(J.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return m.\u0275fac=function(y){return new(y||m)(j.LFG(j.zs3))},m.\u0275prov=j.Yz7({token:m,factory:m.\u0275fac}),m})();function Nr(m){return m.appInitializer.bind(m)}function Ol(m){return m.bootstrapListener.bind(m)}const gc=new j.OlP("Router Initializer")},7582:(zt,Be,Q)=>{function Je(ye,xe,De,Re){return new(De||(De=Promise))(function(Xe,Lt){function cn(_t){try{qe(Re.next(_t))}catch(ti){Lt(ti)}}function Wt(_t){try{qe(Re.throw(_t))}catch(ti){Lt(ti)}}function qe(_t){_t.done?Xe(_t.value):function rt(Xe){return Xe instanceof De?Xe:new De(function(Lt){Lt(Xe)})}(_t.value).then(cn,Wt)}qe((Re=Re.apply(ye,xe||[])).next())})}function vt(ye){return this instanceof vt?(this.v=ye,this):new vt(ye)}function Ze(ye,xe,De){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var rt,Re=De.apply(ye,xe||[]),Xe=[];return rt={},Lt("next"),Lt("throw"),Lt("return"),rt[Symbol.asyncIterator]=function(){return this},rt;function Lt(Gn){Re[Gn]&&(rt[Gn]=function(Wn){return new Promise(function(lr,Fi){Xe.push([Gn,Wn,lr,Fi])>1||cn(Gn,Wn)})})}function cn(Gn,Wn){try{!function Wt(Gn){Gn.value instanceof vt?Promise.resolve(Gn.value.v).then(qe,_t):ti(Xe[0][2],Gn)}(Re[Gn](Wn))}catch(lr){ti(Xe[0][3],lr)}}function qe(Gn){cn("next",Gn)}function _t(Gn){cn("throw",Gn)}function ti(Gn,Wn){Gn(Wn),Xe.shift(),Xe.length&&cn(Xe[0][0],Xe[0][1])}}function bn(ye){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var De,xe=ye[Symbol.asyncIterator];return xe?xe.call(ye):(ye=function Ve(ye){var xe="function"==typeof Symbol&&Symbol.iterator,De=xe&&ye[xe],Re=0;if(De)return De.call(ye);if(ye&&"number"==typeof ye.length)return{next:function(){return ye&&Re>=ye.length&&(ye=void 0),{value:ye&&ye[Re++],done:!ye}}};throw new TypeError(xe?"Object is not iterable.":"Symbol.iterator is not defined.")}(ye),De={},Re("next"),Re("throw"),Re("return"),De[Symbol.asyncIterator]=function(){return this},De);function Re(Xe){De[Xe]=ye[Xe]&&function(Lt){return new Promise(function(cn,Wt){!function rt(Xe,Lt,cn,Wt){Promise.resolve(Wt).then(function(qe){Xe({value:qe,done:cn})},Lt)}(cn,Wt,(Lt=ye[Xe](Lt)).done,Lt.value)})}}}Q.d(Be,{FC:()=>Ze,KL:()=>bn,mG:()=>Je,qq:()=>vt}),"function"==typeof SuppressedError&&SuppressedError}},zt=>{zt(zt.s=8830)}]);